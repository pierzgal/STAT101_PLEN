<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Podstawy Statystyki i Demografii – Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter2.html" rel="next">
<link href="./chapter1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ffd282cb318059e0bcb130885a47f5dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rozdzial1.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Podstawy Statystyki i Demografii</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations of Statistics and Demography</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Podstawy Statystyki i Demografii</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference: The Logic of Statistical Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#wprowadzenie" id="toc-wprowadzenie" class="nav-link active" data-scroll-target="#wprowadzenie"><span class="header-section-number">2.1</span> Wprowadzenie</a>
  <ul class="collapse">
  <li><a href="#statystyka-opisowa-descriptive-statistics" id="toc-statystyka-opisowa-descriptive-statistics" class="nav-link" data-scroll-target="#statystyka-opisowa-descriptive-statistics">Statystyka opisowa (Descriptive Statistics)</a></li>
  <li><a href="#wnioskowanie-statystyczne-inferential-statistics" id="toc-wnioskowanie-statystyczne-inferential-statistics" class="nav-link" data-scroll-target="#wnioskowanie-statystyczne-inferential-statistics">Wnioskowanie statystyczne (Inferential Statistics)</a></li>
  <li><a href="#myślenie-statystyczne-wprowadzenie" id="toc-myślenie-statystyczne-wprowadzenie" class="nav-link" data-scroll-target="#myślenie-statystyczne-wprowadzenie">Myślenie Statystyczne: Wprowadzenie</a></li>
  <li><a href="#współczesne-sondaże" id="toc-współczesne-sondaże" class="nav-link" data-scroll-target="#współczesne-sondaże">Współczesne sondaże</a></li>
  </ul></li>
  <li><a href="#dane-i-rozkłady" id="toc-dane-i-rozkłady" class="nav-link" data-scroll-target="#dane-i-rozkłady"><span class="header-section-number">2.2</span> Dane i rozkłady</a>
  <ul class="collapse">
  <li><a href="#typy-danych" id="toc-typy-danych" class="nav-link" data-scroll-target="#typy-danych">Typy danych</a></li>
  <li><a href="#rozkład-danych" id="toc-rozkład-danych" class="nav-link" data-scroll-target="#rozkład-danych">Rozkład danych</a></li>
  <li><a href="#rozkład-częstości" id="toc-rozkład-częstości" class="nav-link" data-scroll-target="#rozkład-częstości">Rozkład częstości</a></li>
  </ul></li>
  <li><a href="#populacje-i-próby" id="toc-populacje-i-próby" class="nav-link" data-scroll-target="#populacje-i-próby"><span class="header-section-number">2.3</span> Populacje i próby</a>
  <ul class="collapse">
  <li><a href="#populacja-population" id="toc-populacja-population" class="nav-link" data-scroll-target="#populacja-population">Populacja (Population)</a></li>
  <li><a href="#próba-sample" id="toc-próba-sample" class="nav-link" data-scroll-target="#próba-sample">Próba (Sample)</a></li>
  </ul></li>
  <li><a href="#zmienne-i-skale-pomiarowe" id="toc-zmienne-i-skale-pomiarowe" class="nav-link" data-scroll-target="#zmienne-i-skale-pomiarowe"><span class="header-section-number">2.4</span> Zmienne i skale pomiarowe</a>
  <ul class="collapse">
  <li><a href="#pomiar-przekształcanie-pojęć-w-liczby" id="toc-pomiar-przekształcanie-pojęć-w-liczby" class="nav-link" data-scroll-target="#pomiar-przekształcanie-pojęć-w-liczby">Pomiar: przekształcanie pojęć w liczby</a></li>
  <li><a href="#typy-zmiennych" id="toc-typy-zmiennych" class="nav-link" data-scroll-target="#typy-zmiennych">Typy zmiennych</a></li>
  <li><a href="#skale-pomiarowe" id="toc-skale-pomiarowe" class="nav-link" data-scroll-target="#skale-pomiarowe">Skale pomiarowe</a></li>
  </ul></li>
  <li><a href="#parametry-statystyki-i-estymacja" id="toc-parametry-statystyki-i-estymacja" class="nav-link" data-scroll-target="#parametry-statystyki-i-estymacja"><span class="header-section-number">2.5</span> Parametry, statystyki i estymacja</a>
  <ul class="collapse">
  <li><a href="#parametr" id="toc-parametr" class="nav-link" data-scroll-target="#parametr">Parametr</a></li>
  <li><a href="#statystyka" id="toc-statystyka" class="nav-link" data-scroll-target="#statystyka">Statystyka</a></li>
  <li><a href="#relacja-między-parametrami-a-statystykami" id="toc-relacja-między-parametrami-a-statystykami" class="nav-link" data-scroll-target="#relacja-między-parametrami-a-statystykami">Relacja między parametrami a statystykami</a></li>
  <li><a href="#estymator" id="toc-estymator" class="nav-link" data-scroll-target="#estymator">Estymator</a></li>
  <li><a href="#estimand" id="toc-estimand" class="nav-link" data-scroll-target="#estimand">Estimand</a></li>
  <li><a href="#oszacowanie-estimate" id="toc-oszacowanie-estimate" class="nav-link" data-scroll-target="#oszacowanie-estimate">Oszacowanie (Estimate)</a></li>
  </ul></li>
  <li><a href="#błąd-statystyczny-i-niepewność" id="toc-błąd-statystyczny-i-niepewność" class="nav-link" data-scroll-target="#błąd-statystyczny-i-niepewność"><span class="header-section-number">2.6</span> Błąd Statystyczny i Niepewność</a>
  <ul class="collapse">
  <li><a href="#sec-intro" id="toc-sec-intro" class="nav-link" data-scroll-target="#sec-intro">Wprowadzenie: Dlaczego Niepewność Ma Znaczenie</a></li>
  <li><a href="#sec-error-types" id="toc-sec-error-types" class="nav-link" data-scroll-target="#sec-error-types">Typy Błędów</a></li>
  <li><a href="#sec-measures" id="toc-sec-measures" class="nav-link" data-scroll-target="#sec-measures">Kwantyfikowanie Niepewności</a></li>
  <li><a href="#sec-polling" id="toc-sec-polling" class="nav-link" data-scroll-target="#sec-polling">Praktyczne Zastosowanie: Sondaże Opinii</a></li>
  <li><a href="#sec-viz" id="toc-sec-viz" class="nav-link" data-scroll-target="#sec-viz">Wizualizacja: Zmienność Próbkowania</a></li>
  <li><a href="#sec-misconceptions" id="toc-sec-misconceptions" class="nav-link" data-scroll-target="#sec-misconceptions">Częste Błędne Przekonania</a></li>
  <li><a href="#sec-summary" id="toc-sec-summary" class="nav-link" data-scroll-target="#sec-summary">Kluczowe Wnioski</a></li>
  </ul></li>
  <li><a href="#próbkowanie-i-metody-próbkowania" id="toc-próbkowanie-i-metody-próbkowania" class="nav-link" data-scroll-target="#próbkowanie-i-metody-próbkowania"><span class="header-section-number">2.7</span> Próbkowanie i metody próbkowania</a>
  <ul class="collapse">
  <li><a href="#operat-losowania-sampling-frame" id="toc-operat-losowania-sampling-frame" class="nav-link" data-scroll-target="#operat-losowania-sampling-frame">Operat losowania (Sampling Frame)</a></li>
  <li><a href="#metody-próbkowania-probabilistycznego" id="toc-metody-próbkowania-probabilistycznego" class="nav-link" data-scroll-target="#metody-próbkowania-probabilistycznego">Metody próbkowania probabilistycznego</a></li>
  <li><a href="#metody-próbkowania-nieprobabilistycznego" id="toc-metody-próbkowania-nieprobabilistycznego" class="nav-link" data-scroll-target="#metody-próbkowania-nieprobabilistycznego">Metody próbkowania nieprobabilistycznego</a></li>
  </ul></li>
  <li><a href="#pojęcia-prawdopodobieństwa-w-analizie-statystycznej" id="toc-pojęcia-prawdopodobieństwa-w-analizie-statystycznej" class="nav-link" data-scroll-target="#pojęcia-prawdopodobieństwa-w-analizie-statystycznej"><span class="header-section-number">2.8</span> Pojęcia prawdopodobieństwa w analizie statystycznej</a>
  <ul class="collapse">
  <li><a href="#podstawowe-prawdopodobieństwo" id="toc-podstawowe-prawdopodobieństwo" class="nav-link" data-scroll-target="#podstawowe-prawdopodobieństwo">Podstawowe prawdopodobieństwo</a></li>
  <li><a href="#prawdopodobieństwo-warunkowe" id="toc-prawdopodobieństwo-warunkowe" class="nav-link" data-scroll-target="#prawdopodobieństwo-warunkowe">Prawdopodobieństwo warunkowe</a></li>
  <li><a href="#niezależność" id="toc-niezależność" class="nav-link" data-scroll-target="#niezależność">Niezależność</a></li>
  <li><a href="#prawo-wielkich-liczb" id="toc-prawo-wielkich-liczb" class="nav-link" data-scroll-target="#prawo-wielkich-liczb">Prawo wielkich liczb</a></li>
  <li><a href="#wizualizacja-prawa-wielkich-liczb-rzuty-monetą" id="toc-wizualizacja-prawa-wielkich-liczb-rzuty-monetą" class="nav-link" data-scroll-target="#wizualizacja-prawa-wielkich-liczb-rzuty-monetą">Wizualizacja Prawa wielkich liczb: rzuty monetą</a></li>
  <li><a href="#sformułowanie-matematyczne" id="toc-sformułowanie-matematyczne" class="nav-link" data-scroll-target="#sformułowanie-matematyczne">Sformułowanie matematyczne</a></li>
  <li><a href="#przykłady-w-różnych-kontekstach" id="toc-przykłady-w-różnych-kontekstach" class="nav-link" data-scroll-target="#przykłady-w-różnych-kontekstach">Przykłady w różnych kontekstach</a></li>
  <li><a href="#dlaczego-to-ma-znaczenie-dla-statystyki" id="toc-dlaczego-to-ma-znaczenie-dla-statystyki" class="nav-link" data-scroll-target="#dlaczego-to-ma-znaczenie-dla-statystyki">Dlaczego to ma znaczenie dla statystyki</a></li>
  <li><a href="#centralne-twierdzenie-graniczne" id="toc-centralne-twierdzenie-graniczne" class="nav-link" data-scroll-target="#centralne-twierdzenie-graniczne">Centralne Twierdzenie Graniczne</a></li>
  </ul></li>
  <li><a href="#istotność-statystyczna-wprowadzenie" id="toc-istotność-statystyczna-wprowadzenie" class="nav-link" data-scroll-target="#istotność-statystyczna-wprowadzenie"><span class="header-section-number">2.10</span> Istotność Statystyczna: Wprowadzenie</a>
  <ul class="collapse">
  <li><a href="#analogia-do-sali-sądowej" id="toc-analogia-do-sali-sądowej" class="nav-link" data-scroll-target="#analogia-do-sali-sądowej">Analogia do Sali Sądowej</a></li>
  <li><a href="#brak-efektu-domniemanie-niewinności" id="toc-brak-efektu-domniemanie-niewinności" class="nav-link" data-scroll-target="#brak-efektu-domniemanie-niewinności">Brak efektu (“Domniemanie niewinności”)</a></li>
  </ul></li>
  <li><a href="#wartość-p-p-value-twój-miernik-zaskoczenia" id="toc-wartość-p-p-value-twój-miernik-zaskoczenia" class="nav-link" data-scroll-target="#wartość-p-p-value-twój-miernik-zaskoczenia"><span class="header-section-number">2.11</span> Wartość p (p-value): Twój “Miernik Zaskoczenia”</a>
  <ul class="collapse">
  <li><a href="#trzy-sposoby-myślenia-o-wartościach-p" id="toc-trzy-sposoby-myślenia-o-wartościach-p" class="nav-link" data-scroll-target="#trzy-sposoby-myślenia-o-wartościach-p">Trzy Sposoby Myślenia o Wartościach p</a></li>
  </ul></li>
  <li><a href="#błąd-rozumowania-prokuratorskiego-ostrzeżenie" id="toc-błąd-rozumowania-prokuratorskiego-ostrzeżenie" class="nav-link" data-scroll-target="#błąd-rozumowania-prokuratorskiego-ostrzeżenie"><span class="header-section-number">2.12</span> Błąd Rozumowania Prokuratorskiego: Ostrzeżenie</a>
  <ul class="collapse">
  <li><a href="#wyjaśnienie-błędu" id="toc-wyjaśnienie-błędu" class="nav-link" data-scroll-target="#wyjaśnienie-błędu">Wyjaśnienie błędu</a></li>
  <li><a href="#dlaczego-to-ważne-prosty-przykład-testu-medycznego" id="toc-dlaczego-to-ważne-prosty-przykład-testu-medycznego" class="nav-link" data-scroll-target="#dlaczego-to-ważne-prosty-przykład-testu-medycznego">Dlaczego to ważne: Prosty przykład testu medycznego</a></li>
  <li><a href="#analogia-do-badań-naukowych" id="toc-analogia-do-badań-naukowych" class="nav-link" data-scroll-target="#analogia-do-badań-naukowych">Analogia do badań naukowych</a></li>
  </ul></li>
  <li><a href="#wprowadzenie-do-analizy-regresji-modelowanie-relacji-między-zmiennymi" id="toc-wprowadzenie-do-analizy-regresji-modelowanie-relacji-między-zmiennymi" class="nav-link" data-scroll-target="#wprowadzenie-do-analizy-regresji-modelowanie-relacji-między-zmiennymi"><span class="header-section-number">2.13</span> Wprowadzenie do analizy regresji: Modelowanie relacji między zmiennymi</a>
  <ul class="collapse">
  <li><a href="#czym-jest-analiza-regresji" id="toc-czym-jest-analiza-regresji" class="nav-link" data-scroll-target="#czym-jest-analiza-regresji">Czym jest analiza regresji?</a></li>
  <li><a href="#zmienne-i-zmienność" id="toc-zmienne-i-zmienność" class="nav-link" data-scroll-target="#zmienne-i-zmienność">Zmienne i Zmienność</a></li>
  <li><a href="#podstawowa-idea-rysowanie-najlepszej-linii-przez-punkty" id="toc-podstawowa-idea-rysowanie-najlepszej-linii-przez-punkty" class="nav-link" data-scroll-target="#podstawowa-idea-rysowanie-najlepszej-linii-przez-punkty">Podstawowa idea: Rysowanie najlepszej linii przez punkty</a></li>
  <li><a href="#zrozumienie-relacji-vs.-dowodzenie-przyczynowości" id="toc-zrozumienie-relacji-vs.-dowodzenie-przyczynowości" class="nav-link" data-scroll-target="#zrozumienie-relacji-vs.-dowodzenie-przyczynowości">Zrozumienie relacji vs.&nbsp;dowodzenie przyczynowości</a></li>
  <li><a href="#regresja-wieloraka-multiple-regression-kontrolowanie-innych-czynników" id="toc-regresja-wieloraka-multiple-regression-kontrolowanie-innych-czynników" class="nav-link" data-scroll-target="#regresja-wieloraka-multiple-regression-kontrolowanie-innych-czynników">Regresja wieloraka (Multiple Regression): Kontrolowanie innych czynników</a></li>
  <li><a href="#typy-zmiennych-w-regresji" id="toc-typy-zmiennych-w-regresji" class="nav-link" data-scroll-target="#typy-zmiennych-w-regresji">Typy zmiennych w regresji</a></li>
  <li><a href="#różne-typy-regresji-dla-różnych-wyników" id="toc-różne-typy-regresji-dla-różnych-wyników" class="nav-link" data-scroll-target="#różne-typy-regresji-dla-różnych-wyników">Różne typy regresji dla różnych wyników</a></li>
  <li><a href="#interpretacja-wyników-regresji" id="toc-interpretacja-wyników-regresji" class="nav-link" data-scroll-target="#interpretacja-wyników-regresji">Interpretacja wyników regresji</a></li>
  <li><a href="#zastosowania-w-demografii" id="toc-zastosowania-w-demografii" class="nav-link" data-scroll-target="#zastosowania-w-demografii">Zastosowania w demografii</a></li>
  <li><a href="#powszechne-pułapki-i-jak-ich-unikać" id="toc-powszechne-pułapki-i-jak-ich-unikać" class="nav-link" data-scroll-target="#powszechne-pułapki-i-jak-ich-unikać">Powszechne pułapki i jak ich unikać</a></li>
  <li><a href="#intuicje" id="toc-intuicje" class="nav-link" data-scroll-target="#intuicje">Intuicje</a></li>
  <li><a href="#regresja-w-praktyce-kompletny-przykład" id="toc-regresja-w-praktyce-kompletny-przykład" class="nav-link" data-scroll-target="#regresja-w-praktyce-kompletny-przykład">Regresja w praktyce: Kompletny przykład</a></li>
  </ul></li>
  <li><a href="#jakość-i-źródła-danych" id="toc-jakość-i-źródła-danych" class="nav-link" data-scroll-target="#jakość-i-źródła-danych"><span class="header-section-number">2.14</span> Jakość i źródła danych</a>
  <ul class="collapse">
  <li><a href="#wymiary-jakości-danych" id="toc-wymiary-jakości-danych" class="nav-link" data-scroll-target="#wymiary-jakości-danych">Wymiary jakości danych</a></li>
  <li><a href="#powszechne-źródła-danych-w-demografii" id="toc-powszechne-źródła-danych-w-demografii" class="nav-link" data-scroll-target="#powszechne-źródła-danych-w-demografii">Powszechne źródła danych w demografii</a></li>
  <li><a href="#problemy-jakości-danych-specyficzne-dla-demografii" id="toc-problemy-jakości-danych-specyficzne-dla-demografii" class="nav-link" data-scroll-target="#problemy-jakości-danych-specyficzne-dla-demografii">Problemy jakości danych specyficzne dla demografii</a></li>
  </ul></li>
  <li><a href="#względy-etyczne-w-demografii-statystycznej" id="toc-względy-etyczne-w-demografii-statystycznej" class="nav-link" data-scroll-target="#względy-etyczne-w-demografii-statystycznej"><span class="header-section-number">2.15</span> Względy etyczne w demografii statystycznej</a>
  <ul class="collapse">
  <li><a href="#świadoma-zgoda" id="toc-świadoma-zgoda" class="nav-link" data-scroll-target="#świadoma-zgoda">Świadoma zgoda</a></li>
  <li><a href="#poufność-i-prywatność" id="toc-poufność-i-prywatność" class="nav-link" data-scroll-target="#poufność-i-prywatność">Poufność i prywatność</a></li>
  <li><a href="#reprezentacja-i-uczciwość" id="toc-reprezentacja-i-uczciwość" class="nav-link" data-scroll-target="#reprezentacja-i-uczciwość">Reprezentacja i uczciwość</a></li>
  <li><a href="#niewłaściwe-użycie-statystyk" id="toc-niewłaściwe-użycie-statystyk" class="nav-link" data-scroll-target="#niewłaściwe-użycie-statystyk">Niewłaściwe użycie statystyk</a></li>
  <li><a href="#odpowiedzialne-raportowanie" id="toc-odpowiedzialne-raportowanie" class="nav-link" data-scroll-target="#odpowiedzialne-raportowanie">Odpowiedzialne raportowanie</a></li>
  </ul></li>
  <li><a href="#powszechne-nieporozumienia-w-statystyce" id="toc-powszechne-nieporozumienia-w-statystyce" class="nav-link" data-scroll-target="#powszechne-nieporozumienia-w-statystyce"><span class="header-section-number">2.16</span> Powszechne nieporozumienia w statystyce</a>
  <ul class="collapse">
  <li><a href="#nieporozumienie-1-statystyki-mogą-udowodnić-wszystko" id="toc-nieporozumienie-1-statystyki-mogą-udowodnić-wszystko" class="nav-link" data-scroll-target="#nieporozumienie-1-statystyki-mogą-udowodnić-wszystko">Nieporozumienie 1: „Statystyki mogą udowodnić wszystko”</a></li>
  <li><a href="#nieporozumienie-2-większe-próby-są-zawsze-lepsze" id="toc-nieporozumienie-2-większe-próby-są-zawsze-lepsze" class="nav-link" data-scroll-target="#nieporozumienie-2-większe-próby-są-zawsze-lepsze">Nieporozumienie 2: „Większe próby są zawsze lepsze”</a></li>
  <li><a href="#nieporozumienie-3-istotność-statystyczna-praktyczne-znaczenie" id="toc-nieporozumienie-3-istotność-statystyczna-praktyczne-znaczenie" class="nav-link" data-scroll-target="#nieporozumienie-3-istotność-statystyczna-praktyczne-znaczenie">Nieporozumienie 3: “Istotność statystyczna = Praktyczne znaczenie”</a></li>
  <li><a href="#nieporozumienie-4-korelacja-implikuje-przyczynowość" id="toc-nieporozumienie-4-korelacja-implikuje-przyczynowość" class="nav-link" data-scroll-target="#nieporozumienie-4-korelacja-implikuje-przyczynowość">Nieporozumienie 4: “Korelacja implikuje przyczynowość”</a></li>
  <li><a href="#nieporozumienie-5-losowy-oznacza-przypadkowy" id="toc-nieporozumienie-5-losowy-oznacza-przypadkowy" class="nav-link" data-scroll-target="#nieporozumienie-5-losowy-oznacza-przypadkowy">Nieporozumienie 5: “Losowy oznacza przypadkowy”</a></li>
  <li><a href="#nieporozumienie-6-średnia-reprezentuje-wszystkich" id="toc-nieporozumienie-6-średnia-reprezentuje-wszystkich" class="nav-link" data-scroll-target="#nieporozumienie-6-średnia-reprezentuje-wszystkich">Nieporozumienie 6: “Średnia reprezentuje wszystkich”</a></li>
  <li><a href="#nieporozumienie-7-przeszłe-wzorce-gwarantują-przyszłe-wyniki" id="toc-nieporozumienie-7-przeszłe-wzorce-gwarantują-przyszłe-wyniki" class="nav-link" data-scroll-target="#nieporozumienie-7-przeszłe-wzorce-gwarantują-przyszłe-wyniki">Nieporozumienie 7: “Przeszłe wzorce gwarantują przyszłe wyniki”</a></li>
  </ul></li>
  <li><a href="#zastosowania-w-demografii-1" id="toc-zastosowania-w-demografii-1" class="nav-link" data-scroll-target="#zastosowania-w-demografii-1"><span class="header-section-number">2.17</span> Zastosowania w demografii</a>
  <ul class="collapse">
  <li><a href="#szacowanie-i-projekcja-populacji" id="toc-szacowanie-i-projekcja-populacji" class="nav-link" data-scroll-target="#szacowanie-i-projekcja-populacji">Szacowanie i projekcja populacji</a></li>
  <li><a href="#obliczanie-wskaźników-demograficznych" id="toc-obliczanie-wskaźników-demograficznych" class="nav-link" data-scroll-target="#obliczanie-wskaźników-demograficznych">Obliczanie wskaźników demograficznych</a></li>
  <li><a href="#analiza-tablic-trwania-życia" id="toc-analiza-tablic-trwania-życia" class="nav-link" data-scroll-target="#analiza-tablic-trwania-życia">Analiza tablic trwania życia</a></li>
  <li><a href="#analiza-płodności-1" id="toc-analiza-płodności-1" class="nav-link" data-scroll-target="#analiza-płodności-1">Analiza płodności</a></li>
  <li><a href="#analiza-migracji" id="toc-analiza-migracji" class="nav-link" data-scroll-target="#analiza-migracji">Analiza migracji</a></li>
  <li><a href="#metryki-zdrowia-populacji" id="toc-metryki-zdrowia-populacji" class="nav-link" data-scroll-target="#metryki-zdrowia-populacji">Metryki zdrowia populacji</a></li>
  </ul></li>
  <li><a href="#oprogramowanie-i-narzędzia" id="toc-oprogramowanie-i-narzędzia" class="nav-link" data-scroll-target="#oprogramowanie-i-narzędzia"><span class="header-section-number">2.18</span> Oprogramowanie i narzędzia</a>
  <ul class="collapse">
  <li><a href="#pakiety-oprogramowania-statystycznego" id="toc-pakiety-oprogramowania-statystycznego" class="nav-link" data-scroll-target="#pakiety-oprogramowania-statystycznego">Pakiety oprogramowania statystycznego</a></li>
  </ul></li>
  <li><a href="#zakończenie" id="toc-zakończenie" class="nav-link" data-scroll-target="#zakończenie"><span class="header-section-number">2.19</span> Zakończenie</a>
  <ul class="collapse">
  <li><a href="#podsumowanie-kluczowych-terminów" id="toc-podsumowanie-kluczowych-terminów" class="nav-link" data-scroll-target="#podsumowanie-kluczowych-terminów">Podsumowanie kluczowych terminów</a></li>
  </ul></li>
  <li><a href="#załącznik-a-visualizations-for-statistics-demography" id="toc-załącznik-a-visualizations-for-statistics-demography" class="nav-link" data-scroll-target="#załącznik-a-visualizations-for-statistics-demography"><span class="header-section-number">2.20</span> Załącznik A: Visualizations for Statistics &amp; Demography</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Podstawy Statystyki i Demografii</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<hr>
<section id="wprowadzenie" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="wprowadzenie"><span class="header-section-number">2.1</span> Wprowadzenie</h2>
<blockquote class="blockquote">
<p><strong>Statystyka</strong> to nauka o uczeniu się z danych w warunkach niepewności.</p>
</blockquote>
<p>Statystyka jest sposobem poznawania świata na podstawie danych. Uczy nas, jak mądrze zbierać dane, dostrzegać wzorce, szacować parametry (cechy) populacyjne i dokonywać prognoz — określając, jak bardzo możemy się mylić.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Statystyka</strong> to nauka o zbieraniu, organizowaniu, analizowaniu, interpretowaniu i prezentowaniu danych. Obejmuje zarówno metody pracy z danymi, jak i teoretyczne podstawy uzasadniające te metody. Ale statystyka to coś więcej niż tylko liczby i wzory — to sposób myślenia o niepewności i zmienności w otaczającym nas świecie.</p>
</div>
</div>
<p>Wyobraź sobie, że chcesz poznać średni wiek przy pierwszym małżeństwie w danym kraju. Nie możesz zapytać każdej pojedynczej osoby, kiedy po raz pierwszy wstąpiła w związek małżeński (jeśli w ogóle).</p>
<p>Statystyka dostarcza narzędzi do:</p>
<ul>
<li>Wyboru reprezentatywnej grupy osób do badania</li>
<li>Obliczenia podsumowań opisowych na podstawie ich odpowiedzi</li>
<li>Oszacowania prawdopodobnej średniej dla całej populacji</li>
<li>Określenia, jak pewni możemy być naszego oszacowania</li>
<li>Sprawdzenia, czy średni wiek zmienia się w czasie</li>
</ul>
<hr>
<blockquote class="blockquote">
<p><strong>Demografia</strong> to nauka zajmująca się badaniem ludności, koncentrująca się na jej wielkości, strukturze, rozmieszczeniu i zmianach zachodzących w czasie. To zasadniczo analiza statystyczna populacji - kim są ludzie, gdzie mieszkają, ilu ich jest i jak te charakterystyki ewoluują.</p>
</blockquote>
<hr>
<p><strong>Statystyka i demografia to powiązane ze sobą dyscypliny</strong>, które dostarczają narzędzi do zrozumienia populacji, ich charakterystyk i wzorców wyłaniających się z danych.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Procent vs punkty procentowe (pp)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Gdy w mediach słyszysz, że „bezrobocie <strong>spadło o 2</strong>”, czy chodzi o <strong>2 punkty procentowe (pp)</strong>, czy <strong>2 procent</strong>?</p>
<p>To <strong>nie to samo</strong>:</p>
<ul>
<li><strong>2 pp (zmiana absolutna):</strong> np. 10% → <strong>8%</strong> (−2 pp).</li>
<li><strong>2% (zmiana względna):</strong> mnożymy starą stopę przez 0,98; np. 10% → <strong>9,8%</strong> (−0,2 pp).</li>
</ul>
<p><strong>Zawsze pytaj:</strong></p>
<ol type="1">
<li>Jaka jest <strong>wartość bazowa</strong> (wcześniejsza stopa)?</li>
<li>Czy to zmiana <strong>absolutna (pp)</strong>, czy <strong>względna (%)</strong>?</li>
<li>Czy różnica może wynikać z <strong>błędu losowego / błędu próby</strong>?</li>
<li><strong>Jak mierzono bezrobocie</strong> (badanie ankietowe vs dane administracyjne), <strong>kiedy</strong> i <strong>kogo uwzględniono</strong>?</li>
</ol>
<p><strong>Prosta zasada</strong></p>
<ul>
<li>Używaj <strong>punktów procentowych (pp)</strong>, gdy porównujesz <strong>stopy/procenty</strong> wprost (bezrobocie, frekwencja).</li>
<li>Używaj <strong>procentów (%)</strong> dla <strong>zmian względnych</strong> (względem wartości wyjściowej).</li>
</ul>
<p><strong>Mała ściąga</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Stopa początkowa</th>
<th>„Spadek <strong>o 2%</strong>” (względny)</th>
<th>„Spadek <strong>o 2 pp</strong>” (absolutny)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6%</td>
<td>6% × 0,98 = <strong>5,88%</strong> (−0,12 pp)</td>
<td><strong>4%</strong></td>
</tr>
<tr class="even">
<td>8%</td>
<td>8% × 0,98 = <strong>7,84%</strong> (−0,16 pp)</td>
<td><strong>6%</strong></td>
</tr>
<tr class="odd">
<td>10%</td>
<td>10% × 0,98 = <strong>9,8%</strong> (−0,2 pp)</td>
<td><strong>8%</strong></td>
</tr>
</tbody>
</table>
<p><strong>Uwaga:</strong> <strong>2%</strong> ≠ <strong>2 punkty procentowe (pp)</strong>.</p>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zaokrąglenia i notacja naukowa w statystyce
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Zasada główna:</strong> O ile nie podano inaczej, <strong>części ułamkowe</strong> liczb dziesiętnych zaokrąglaj do <strong>co najmniej 2 cyfr znaczących</strong>. W statystyce często pracujemy z długimi częściami ułamkowymi i bardzo małymi liczbami — w obliczeniach, nie zaokrąglaj nadmiernie w krokach pośrednich, zaokrąglaj <strong>na końcu</strong> obliczeń.</p>
<section id="zaokrąglanie-w-kontekście-statystycznym" class="level3">
<h3 class="anchored" data-anchor-id="zaokrąglanie-w-kontekście-statystycznym">Zaokrąglanie w kontekście statystycznym</h3>
<p><strong>Część ułamkowa</strong> to cyfry po przecinku dziesiętnym. W statystyce szczególnie ważne jest zachowanie odpowiedniej precyzji:</p>
<p><strong>Statystyki opisowe:</strong></p>
<ul>
<li>Średnia: <span class="math inline">\bar{x} = 15.847693... \rightarrow 15.85</span></li>
<li>Odchylenie standardowe: <span class="math inline">s = 2.7488... \rightarrow 2.75</span></li>
<li>Współczynnik korelacji: <span class="math inline">r = 0.78432... \rightarrow 0.78</span></li>
</ul>
<p><strong>Bardzo małe liczby (p-wartości, prawdopodobieństwa):</strong></p>
<ul>
<li><span class="math inline">p = 0.000347... \rightarrow 0.00035</span> lub <span class="math inline">3.5 \times 10^{-4}</span></li>
<li><span class="math inline">P(X &gt; 2) = 0.0000891... \rightarrow 0.000089</span> lub <span class="math inline">8.9 \times 10^{-5}</span></li>
</ul>
</section>
<section id="cyfry-znaczące-w-części-ułamkowej" class="level3">
<h3 class="anchored" data-anchor-id="cyfry-znaczące-w-części-ułamkowej">Cyfry znaczące w części ułamkowej</h3>
<p>W części ułamkowej cyfry znaczące to wszystkie cyfry oprócz zer wiodących:</p>
<ul>
<li><span class="math inline">.78432</span> ma 5 cyfr znaczących → zaokrąglamy do <span class="math inline">.78</span> (2 c.z.)</li>
<li><span class="math inline">.000347</span> ma 3 cyfry znaczące → zaokrąglamy do <span class="math inline">.00035</span> (2 c.z.)</li>
<li><span class="math inline">.050600</span> ma 4 cyfry znaczące → zaokrąglamy do <span class="math inline">.051</span> (2 c.z.)</li>
</ul>
</section>
<section id="zasady-zaokrąglania-w-statystyce" class="level3">
<h3 class="anchored" data-anchor-id="zasady-zaokrąglania-w-statystyce">Zasady zaokrąglania w statystyce</h3>
<ol type="1">
<li><strong>Zaokrąglaj tylko część ułamkową</strong> do co najmniej 2 cyfr znaczących</li>
<li><strong>Część całkowita</strong> pozostaje niezmieniona</li>
<li><strong>W długich obliczeniach</strong> zachowuj 3-4 cyfry w części ułamkowej do ostatniego kroku</li>
<li><strong>NIGDY nie zaokrąglaj do zera</strong> - małe wartości mają znaczenie interpretacyjne</li>
<li><strong>Dla bardzo małych liczb</strong> używaj notacji naukowej gdy to ułatwia odczyt</li>
<li><strong>P-wartości</strong> często wymagają większej precyzji — zachowaj 2-3 cyfry znaczące</li>
</ol>
<p>⚠️ UWAGA: Nie zaokrąglaj do zera!</p>
</section>
<section id="notacja-naukowa-w-statystyce" class="level3">
<h3 class="anchored" data-anchor-id="notacja-naukowa-w-statystyce">Notacja naukowa w statystyce</h3>
<p>W statystyce często spotykamy bardzo małe liczby. Używaj notacji naukowej gdy ułatwia to odczyt:</p>
<p><strong>P-wartości i prawdopodobieństwa:</strong></p>
<ul>
<li><span class="math inline">p = 0.000347 = 3.47 \times 10^{-4}</span> (lepiej: <span class="math inline">3.5 \times 10^{-4}</span>)</li>
<li><span class="math inline">P(Z &gt; 3.5) = 0.000233 = 2.33 \times 10^{-4}</span></li>
</ul>
<p><strong>Bardzo małe odchylenia standardowe:</strong></p>
<ul>
<li><span class="math inline">\sigma = 0.000892 = 8.92 \times 10^{-4}</span></li>
</ul>
<p><strong>Duże liczby (rzadko w podstawowej statystyce):</strong></p>
<ul>
<li><span class="math inline">N = 1\,234\,567 = 1.23 \times 10^6</span></li>
</ul>
<p><strong>Wątpliwości:</strong> Lepiej zachować dodatkową cyfrę niż zaokrąglić zbyt mocno</p>
</section>
</div>
</div>
<hr>
<p>Dziedzinę statystyki można ogólnie podzielić na dwie uzupełniające się gałęzie:</p>
<section id="statystyka-opisowa-descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="statystyka-opisowa-descriptive-statistics">Statystyka opisowa (Descriptive Statistics)</h3>
<p><strong>Statystyka opisowa</strong> obejmuje metody podsumowywania i prezentowania danych. Obejmuje to:</p>
<p><strong>Miary tendencji centralnej</strong> - Gdzie znajduje się “centrum” (średnia) zbioru danych?</p>
<ul>
<li><strong>Średnia (Mean)</strong>: Średnia arytmetyczna. Jeśli całkowity dochód gospodarstw domowych na wsi liczącej 100 gospodarstw wynosi 5 000 000 zł, średni dochód wynosi 50 000 zł. Jednak jeśli jedno gospodarstwo jest niezwykle bogate, może to nie reprezentować dobrze typowego gospodarstwa.</li>
<li><strong>Mediana (Median)</strong>: Wartość środkowa, gdy dane są uporządkowane. Jeśli większość gospodarstw zarabia między 20 000-40 000 zł, ale jedno zarabia 2 000 000 zł, mediana lepiej reprezentuje typowe gospodarstwo.</li>
<li><strong>Moda/Dominanta (Mode)</strong>: Najczęściej występująca wartość. W badaniu wielkości rodziny, jeśli większość rodzin ma 2 dzieci, 2 jest modą (dominantą), nawet jeśli średnia wynosi 2,3 dziecka.</li>
</ul>
<p><strong>Miary zmienności</strong> - Jak rozrzucone/zróżnicowane są dane?</p>
<ul>
<li><strong>Rozstęp (Range)</strong>: Różnica między wartością maksymalną a minimalną. Jeśli wiek w społeczności waha się od 0 do 95 lat, rozstęp wynosi 95 lat.</li>
<li><strong>Wariancja (Variance)</strong>: Średnie kwadratowe odchylenie od średniej. Mierzy, jak daleko wartości przeciętnie odchylają się od centrum.</li>
<li><strong>Odchylenie standardowe (Standard Deviation)</strong>: Pierwiastek kwadratowy z wariancji, w tych samych jednostkach co oryginalne dane. Jeśli średni wiek wynosi 35 lat z odchyleniem standardowym 20 lat, większość ludzi ma między 15 a 55 lat.</li>
</ul>
<p><strong>Reprezentacje wizualne (przykłady)</strong></p>
<ul>
<li><strong>Piramidy wieku (Population Pyramids)</strong>: Pokazują rozkład wieku i płci, ujawniając historię demograficzną. Szeroka podstawa wskazuje na wysokie wskaźniki urodzeń; wąska podstawa sugeruje spadającą płodność.</li>
<li><strong>Tablice trwania życia (Life Tables)</strong>: Podsumowują wzorce śmiertelności, pokazując prawdopodobieństwo przeżycia do każdego wieku.</li>
<li><strong>Wykresy szeregów czasowych (Time Series Graphs)</strong>: Wyświetlają trendy w czasie, takie jak zmieniające się wskaźniki płodności na przestrzeni dekad.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Lodz_population_pyramid.svg" class="img-fluid figure-img"></p>
<figcaption>https://commons.wikimedia.org/wiki/File:%C5%81%C3%B3d%C5%BA_population_pyramid.svg</figcaption>
</figure>
</div>
</section>
<section id="wnioskowanie-statystyczne-inferential-statistics" class="level3">
<h3 class="anchored" data-anchor-id="wnioskowanie-statystyczne-inferential-statistics">Wnioskowanie statystyczne (Inferential Statistics)</h3>
<p><strong>Wnioskowanie statystyczne</strong> to szacowanie efektów na podstawie próby i określanie, jak bardzo te wyniki są niepewne. Stosujemy je w eksperymentach (porównanie grup), w modelach regresji (współczynniki opisujące związek między zmiennymi) oraz w sondażach, gdzie z próby wnioskujemy o populacji (np. odsetki/średnie) i podajemy margines błędu oraz przedział ufności.</p>
<p><img src="stat_imgs/random-sample.svg" class="img-fluid"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wnioskowanie z próby o cechach populacji: Analogia „próbowania zupy”
</div>
</div>
<div class="callout-body-container callout-body">
<p><img src="stat_imgs/soup-svgrepo-com.svg" class="img-fluid" style="width:30.0%"></p>
<p>Rozważmy kucharza przygotowującego zupę dla 100 osób, który musi ocenić jej smak bez konsumowania całego garnka:</p>
<p><strong>Populacja</strong>: Cały garnek zupy (100 porcji)</p>
<p><strong>Próba</strong>: Jedna łyżka do spróbowania</p>
<p><strong>Parametr populacji</strong>: Prawdziwy średni poziom słoności całego garnka (nieznany)</p>
<p><strong>Statystyka z próby</strong>: Poziom słoności wykryty w łyżce (obserwowalny)</p>
<p><strong>Wnioskowanie statystyczne</strong>: Używanie charakterystyk łyżki do wyciągania wniosków o całym garnku</p>
<section id="ważne" class="level3">
<h3 class="anchored" data-anchor-id="ważne">Ważne</h3>
<p><strong>1. Losowe próbkowanie jest niezbędne</strong>: Kucharz musi dokładnie wymieszać zupę przed pobraniem próbki. Konsekwentne pobieranie próbek z powierzchni może pominąć przyprawy, które osiadły, wprowadzając systematyczne obciążenie.</p>
<p><strong>2. Wielkość próby wpływa na precyzję</strong>: Większa łyżka dostarcza bardziej wiarygodnych informacji o ogólnym smaku niż mały łyk, choć np. koszty i czas ograniczają możliwość dowolnego zwiększania próby.</p>
<p><strong>3. Niepewność jest nieodłączna</strong>: Nawet przy właściwej technice próbkowania (sampling), łyżka może nie reprezentować idealnie charakterystyk całego garnka.</p>
<p><strong>4. Systematyczne obciążenie/stronniczość (bias) podważa wnioskowanie</strong>: Jeśli ktoś potajemnie doda sól tylko do obszaru próbkowania, wnioski o całym garnku stają się nieważne — ilustrując, jak obciążenie próbkowania zniekształca wnioskowanie statystyczne.</p>
<p><strong>5. Wnioskowanie ma ograniczenia zakresu</strong>: Próba może oszacować średnią słoność, ale nie może ujawnić, czy niektóre części są bardziej słone niż inne, podkreślając granice tego, co próby mogą nam powiedzieć o zmienności w populacji.</p>
<p>Ta analogia chwyta istotę rozumowania statystycznego: używanie starannie wybranych prób do poznawania większych populacji przy jednoczesnym jawnym uznawaniu i kwantyfikacji nieodłącznej niepewności w tym procesie.</p>
</section>
</div>
</div>
<blockquote class="blockquote">
<p>Na przykład, jeśli badanie 1000 gospodarstw domowych stwierdza, że 23% obejmuje trzy pokolenia mieszkające razem, statystyka inferencyjna pomaga nam:</p>
</blockquote>
<ul>
<li>Oszacować, że między 20% a 26% wszystkich gospodarstw w populacji prawdopodobnie ma taką strukturę (przedział ufności)</li>
<li>Sprawdzić, czy ten odsetek wzrósł w porównaniu do poprzedniej dekady (testowanie hipotez)</li>
<li>Zbadać, czy mieszkanie wielopokoleniowe jest bardziej powszechne w niektórych grupach etnicznych (porównanie grup)</li>
<li>Przewidzieć przyszłe trendy na podstawie obecnych wzorców (regresja i prognozowanie)</li>
</ul>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Podstawowa zasada</strong>: Statystyka nie eliminuje niepewności — pomaga nam ją mierzyć, zarządzać nią i skutecznie komunikować.</p>
</div>
</div>
</section>
<section id="myślenie-statystyczne-wprowadzenie" class="level3">
<h3 class="anchored" data-anchor-id="myślenie-statystyczne-wprowadzenie">Myślenie Statystyczne: Wprowadzenie</h3>
<section id="scenariusz-badawczy" class="level4">
<h4 class="anchored" data-anchor-id="scenariusz-badawczy">Scenariusz Badawczy</h4>
<p>Władze uniwersytetu rozważają udostępnienie biblioteki całodobowo. Administracja potrzebuje odpowiedzi na pytanie: <strong>Jaka część studentów popiera tę zmianę?</strong></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Podstawowe Wyzwanie
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Sytuacja idealna</strong>: Zapytanie wszystkich 20 000 studentów → Uzyskanie dokładnej odpowiedzi<br>
<strong>Sytuacja rzeczywista</strong>: Ankietowanie 100 studentów → Uzyskanie oszacowania z niepewnością</p>
</div>
</div>
</section>
<section id="dwa-podejścia-do-tych-samych-danych" class="level4">
<h4 class="anchored" data-anchor-id="dwa-podejścia-do-tych-samych-danych">Dwa Podejścia do Tych Samych Danych</h4>
<p>Załóżmy, że przeprowadzono ankietę wśród 100 losowo wybranych studentów i stwierdzono, że 60 z nich popiera całodobowe otwarcie biblioteki.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>❌ Bez Myślenia Statystycznego</strong></p>
<p>“60 ze 100 studentów odpowiedziało twierdząco.”</p>
<p><strong>Wniosek</strong>: “Dokładnie 60% wszystkich studentów popiera zmianę.”</p>
<p><strong>Decyzja</strong>: “Ponieważ przekracza to 50%, mamy wyraźne poparcie większości.”</p>
<p><strong>Problem</strong>: Ignorowanie faktu, że inna próba mogłaby dać wynik 55% lub 65%</p>
</div><div class="column" style="width:50%;">
<p><strong>✅ Z Zastosowaniem Myślenia Statystycznego</strong></p>
<p>“60 ze 100 studentów odpowiedziało twierdząco.”</p>
<p><strong>Wniosek</strong>: “Szacujemy poparcie na poziomie 60% z marginesem błędu ±10%”</p>
<p><strong>Decyzja</strong>: “Prawdziwe poparcie prawdopodobnie mieści się między 50% a 70% — potrzebujemy większej próby dla pewności większościowego poparcia.”</p>
<p><strong>Przewaga</strong>: Uznanie niepewności prowadzi do lepszych decyzji</p>
</div>
</div>
</section>
<section id="znaczenie-praktyczne" class="level4">
<h4 class="anchored" data-anchor-id="znaczenie-praktyczne">Znaczenie Praktyczne</h4>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ważna uwaga
</div>
</div>
<div class="callout-body-container callout-body">
<p>Myślenie statystyczne nie polega na zmniejszeniu pewności — polega na <strong>rzetelnym przedstawieniu niepewności</strong>.</p>
<p>Rozważmy następujące scenariusze dla wyniku 60% (±10% margines błędu):</p>
<ul>
<li><strong>Scenariusz optymistyczny</strong>: Rzeczywiste poparcie może wynosić 70% (silna większość)</li>
<li><strong>Scenariusz pesymistyczny</strong>: Rzeczywiste poparcie może wynosić 50% (brak wyraźnej większości)</li>
<li><strong>Scenariusz najbardziej prawdopodobny</strong>: Rzeczywiste poparcie wynosi około 60% (umiarkowana większość)</li>
</ul>
<p>Bez uwzględnienia tego zakresu możemy podejmować kosztowne decyzje oparte na fałszywej precyzji.</p>
</div>
</div>
</section>
<section id="znaczenie-wielkości-próby" class="level4">
<h4 class="anchored" data-anchor-id="znaczenie-wielkości-próby">Znaczenie Wielkości Próby</h4>
<p>Jeśli wymagana jest większa precyzja, należy rozważyć wpływ wielkości próby na poziom ufności:</p>
<table class="table-striped table-hover caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Wielkość Próby</th>
<th>Wynik Badania</th>
<th>Margines Błędu</th>
<th>Przedział Ufności</th>
<th>Interpretacja</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n = 100</td>
<td>60%</td>
<td>±10%</td>
<td>50% do 70%</td>
<td>Niepewność co do większości</td>
</tr>
<tr class="even">
<td>n = 400</td>
<td>60%</td>
<td>±5%</td>
<td>55% do 65%</td>
<td>Prawdopodobne poparcie większości</td>
</tr>
<tr class="odd">
<td>n = 1 600</td>
<td>60%</td>
<td>±2,5%</td>
<td>57,5% do 62,5%</td>
<td>Wyraźne poparcie większości</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Należy Pamiętać
</div>
</div>
<div class="callout-body-container callout-body">
<p>Myślenie statystyczne przekształca stwierdzenie “60 studentów odpowiedziało twierdząco” z pozornie precyzyjnej, lecz wprowadzającej w błąd informacji w rzetelną ocenę: “Z dużym prawdopodobieństwem można stwierdzić, że między 50% a 70% wszystkich studentów popiera tę propozycję.”</p>
<p><strong>Ta ostrożność w formułowaniu wniosków prowadzi do lepszych decyzji.</strong></p>
</div>
</div>
</section>
<section id="zastosowanie-myślenia-statystycznego-w-praktyce" class="level4">
<h4 class="anchored" data-anchor-id="zastosowanie-myślenia-statystycznego-w-praktyce">Zastosowanie Myślenia Statystycznego w Praktyce</h4>
<p>Analizując dane statystyczne, należy zawsze rozważyć następujące pytania:</p>
<ul>
<li>Jaka jest wielkość próby badawczej?</li>
<li>Jaki jest margines błędu statystycznego?</li>
<li>Czy prawdziwa wartość może znacząco różnić się od wartości raportowanej?</li>
<li>Czy decyzja uległaby zmianie, gdyby prawdziwa wartość znajdowała się na granicy przedziału niepewności/ufności?</li>
</ul>
<p>Odpowiedzi na te pytania stanowią fundament myślenia statystycznego.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Przykład historyczny: Sondaż Literary Digest z 1936 roku
</div>
</div>
<div class="callout-body-container callout-body">
<p>Literary Digest przeprowadził jeden z największych sondaży w historii z <strong>2,4 miliona odpowiedzi</strong>, przewidując, że Alf Landon pokona Franklina D. Roosevelta w wyborach prezydenckich w 1936 roku.</p>
<p>Pomimo ogromnej wielkości próby:</p>
<p><strong>Przewidywanie</strong>: Landon 57%, Roosevelt 43% <strong>Rzeczywisty wynik</strong>: Roosevelt 62%, Landon 38% <strong>Błąd</strong>: 25 punktów procentowych!</p>
<p><strong>Co poszło nie tak?</strong> Sondaż był wadliwy z powodu systematycznego błędu/obciążenia (bias):</p>
<p><strong>Obciążenie selekcyjne (selection bias) w ramce/operacie losowania</strong>:</p>
<ul>
<li>Źródła: książki telefoniczne, rejestracje samochodów, członkostwo w klubach</li>
<li>Problem: W 1936 roku źródła te nadreprezentowały bogatych Amerykanów, którzy faworyzowali Landona</li>
<li>Wynik: Próba systematycznie wykluczała zwolenników Roosevelta</li>
</ul>
<p><strong>Obciążenie braku odpowiedzi</strong>:</p>
<ul>
<li>Tylko 24% skontaktowanych osób odpowiedziało (problem z “response rate”)</li>
<li>Prawdopodobni respondenci: osoby z silnymi opiniami anty-Roosevelt</li>
<li>Struktura odmów: wielu zwolenników Roosevelta nie czuło potrzeby uczestniczenia</li>
</ul>
<p><strong>Kluczowe wnioski</strong>:</p>
<ol type="1">
<li><strong>Duża obciążona (biased) próba jest gorsza niż mała reprezentatywna próba</strong></li>
<li><strong>Błędy standardowe mierzą tylko błąd losowy, nie obciążenie</strong></li>
<li><strong>Wielkość próby nie może naprawić fundamentalnych problemów dotyczących nielosowego doboru próby</strong></li>
<li><strong>Reprezentatywne losowanie ma większe znaczenie niż wielkość próby</strong></li>
</ol>
<p>Ta katastrofa doprowadziła do znacznych ulepszeń w metodologii sondażowej, w tym rozwoju losowania probabilistycznego i śledzenia wskaźników odpowiedzi.</p>
</div>
</div>
</section>
</section>
<section id="współczesne-sondaże" class="level3">
<h3 class="anchored" data-anchor-id="współczesne-sondaże">Współczesne sondaże</h3>
<p>Dzisiejsze sondaże, choć znacznie mniejsze niż 2,4 miliona odpowiedzi Literary Digest, są zwykle znacznie dokładniejsze, ponieważ koncentrują się na:</p>
<p><strong>Reprezentatywnym losowaniu</strong>: Używanie metod opartych na prawdopodobieństwie, aby zapewnić wszystkim grupom znane szanse selekcji</p>
<p><strong>Wykrywanie i korekcja obciążenia</strong>: Monitorowanie wskaźników odpowiedzi w różnych grupach demograficznych i korygowanie znanych obciążeń (bias)</p>
<p><strong>Kwantyfikacja niepewności</strong>: Raportowanie marginesów błędu (statystyczny błąd losowy), które uczciwie komunikują granice tego, co wiemy</p>
<p><strong>Przykład</strong>: Współczesny sondaż 1000 losowo wybranych wyborców z 3% marginesem błędu jest zwykle znacznie bardziej wiarygodny niż masywne, ale obciążone badanie Literary Digest.</p>
<hr>
</section>
</section>
<section id="dane-i-rozkłady" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="dane-i-rozkłady"><span class="header-section-number">2.2</span> Dane i rozkłady</h2>
<p><strong>Dane</strong>: Informacje zebrane podczas badania – obejmują odpowiedzi z ankiet, wyniki eksperymentów, wskaźniki ekonomiczne, treści z mediów społecznościowych lub wszelkie inne mierzalne obserwacje.</p>
<p>Zrozumienie typów danych i rozkładów jest fundamentalne dla wyboru odpowiednich analiz i poprawnej interpretacji wyników.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rodzaje i Formaty Zbiorów Danych
</div>
</div>
<div class="callout-body-container callout-body">
<section id="dane-przekrojowe" class="level4">
<h4 class="anchored" data-anchor-id="dane-przekrojowe">Dane Przekrojowe</h4>
<p>Obserwacje na zmiennych (kolumny w bazie danych) zebrane w jednym punkcie czasowym dla wielu podmiotów:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Osoba</th>
<th>Wiek</th>
<th>Dochód</th>
<th>Wykształcenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>25</td>
<td>5000</td>
<td>Licencjat</td>
</tr>
<tr class="even">
<td>2</td>
<td>35</td>
<td>7500</td>
<td>Magister</td>
</tr>
<tr class="odd">
<td>3</td>
<td>45</td>
<td>9000</td>
<td>Doktorat</td>
</tr>
</tbody>
</table>
</section>
<section id="szeregi-czasowe" class="level4">
<h4 class="anchored" data-anchor-id="szeregi-czasowe">Szeregi Czasowe</h4>
<p>Obserwacje jednego podmiotu w kolejnych punktach czasowych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Rok</th>
<th>PKB (w mld)</th>
<th>Stopa Bezrobocia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2018</td>
<td>20.580</td>
<td>3,9%</td>
</tr>
<tr class="even">
<td>2019</td>
<td>21.433</td>
<td>3,7%</td>
</tr>
<tr class="odd">
<td>2020</td>
<td>20.933</td>
<td>8,1%</td>
</tr>
</tbody>
</table>
</section>
<section id="dane-panelowe-longitudinalne" class="level4">
<h4 class="anchored" data-anchor-id="dane-panelowe-longitudinalne">Dane Panelowe (Longitudinalne)</h4>
<p>Obserwacje wielu podmiotów w czasie:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>Rok</th>
<th>PKB per capita</th>
<th>Długość życia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Polska</td>
<td>2018</td>
<td>32.794</td>
<td>76,7</td>
</tr>
<tr class="even">
<td>Polska</td>
<td>2019</td>
<td>35.118</td>
<td>76,8</td>
</tr>
<tr class="odd">
<td>Niemcy</td>
<td>2018</td>
<td>46.194</td>
<td>81,9</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>2019</td>
<td>46.194</td>
<td>82,0</td>
</tr>
</tbody>
</table>
</section>
<section id="dane-przekrojowo-czasowe-tscs" class="level4">
<h4 class="anchored" data-anchor-id="dane-przekrojowo-czasowe-tscs">Dane Przekrojowo-Czasowe (TSCS)</h4>
<p>Szczególny przypadek danych panelowych gdzie:</p>
<ul>
<li>Liczba punktów czasowych &gt; liczba podmiotów</li>
<li>Struktura podobna do danych panelowych</li>
<li>Często stosowane w ekonomii i politologii</li>
</ul>
<hr>
</section>
<section id="formaty-danych" class="level3">
<h3 class="anchored" data-anchor-id="formaty-danych">Formaty Danych</h3>
<section id="format-szeroki" class="level4">
<h4 class="anchored" data-anchor-id="format-szeroki">Format Szeroki</h4>
<p>Każdy wiersz to podmiot; kolumny to zmienne/punkty czasowe:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>PKB_2018</th>
<th>PKB_2019</th>
<th>DŻ_2018</th>
<th>DŻ_2019</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Polska</td>
<td>32.794</td>
<td>35.118</td>
<td>76,7</td>
<td>76,8</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>46.194</td>
<td>46.194</td>
<td>81,9</td>
<td>82,0</td>
</tr>
</tbody>
</table>
</section>
<section id="format-długi" class="level4">
<h4 class="anchored" data-anchor-id="format-długi">Format Długi</h4>
<p>Każdy wiersz to unikalna kombinacja podmiot-czas-zmienna:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>Rok</th>
<th>Zmienna</th>
<th>Wartość</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Polska</td>
<td>2018</td>
<td>PKB per capita</td>
<td>32.794</td>
</tr>
<tr class="even">
<td>Polska</td>
<td>2019</td>
<td>PKB per capita</td>
<td>35.118</td>
</tr>
<tr class="odd">
<td>Polska</td>
<td>2018</td>
<td>Długość życia</td>
<td>76,7</td>
</tr>
<tr class="even">
<td>Polska</td>
<td>2019</td>
<td>Długość życia</td>
<td>76,8</td>
</tr>
<tr class="odd">
<td>Niemcy</td>
<td>2018</td>
<td>PKB per capita</td>
<td>46.194</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>2019</td>
<td>PKB per capita</td>
<td>46.194</td>
</tr>
<tr class="odd">
<td>Niemcy</td>
<td>2018</td>
<td>Długość życia</td>
<td>81,9</td>
</tr>
<tr class="even">
<td>Niemcy</td>
<td>2019</td>
<td>Długość życia</td>
<td>82,0</td>
</tr>
</tbody>
</table>
<p><strong>Uwaga:</strong> Format długi jest zazwyczaj preferowany do:</p>
<ul>
<li>Manipulacji danymi w R i Pythonie</li>
<li>Analiz statystycznych</li>
<li>Wizualizacji danych</li>
<li>Modelowania efektów mieszanych</li>
<li>Analiz powtarzanych pomiarów</li>
</ul>
</section>
</section>
</div>
</div>
<section id="typy-danych" class="level3">
<h3 class="anchored" data-anchor-id="typy-danych">Typy danych</h3>
<p><strong>Dane</strong> składają się z zebranych obserwacji lub pomiarów. Typ danych określa, jakie operacje matematyczne są wykonalne i jakie metody statystyczne mają zastosowanie.</p>
<section id="dane-ilościowe" class="level4">
<h4 class="anchored" data-anchor-id="dane-ilościowe">Dane ilościowe</h4>
<p><strong>Dane ciągłe</strong> mogą przyjmować dowolną wartość w przedziale:</p>
<p><strong>Przykłady o znaczeniu demograficznym:</strong></p>
<ul>
<li><strong>Wiek</strong>: Może wynosić 25,5 lat, 25,51 lat, 25,514 lat (precyzja ograniczona tylko dokładnością narzędzia pomiarowego)</li>
<li><strong>Wskaźnik masy ciała</strong>: 23,7 kg/m²</li>
<li><strong>Współczynnik dzietności</strong>: 1,73 dzieci na kobietę</li>
<li><strong>Gęstość zaludnienia</strong>: 4521,3 osoby na km²</li>
</ul>
<p><strong>Właściwości:</strong></p>
<ul>
<li>Można wykonywać wszystkie operacje arytmetyczne</li>
<li>Można obliczać średnie, odchylenia standardowe</li>
<li>Często podążają za znanymi rozkładami prawdopodobieństwa</li>
</ul>
<p><strong>Dane dyskretne</strong> mogą przyjmować tylko określone wartości:</p>
<p><strong>Przykłady:</strong></p>
<ul>
<li><strong>Liczba dzieci</strong>: 0, 1, 2, 3… (nie można mieć 2,5 dziecka)</li>
<li><strong>Liczba małżeństw</strong>: 0, 1, 2, 3…</li>
<li><strong>Wielkość gospodarstwa domowego</strong>: 1, 2, 3, 4… osób</li>
<li><strong>Liczba wizyt u lekarza</strong>: 0, 1, 2, 3… rocznie</li>
</ul>
</section>
<section id="dane-jakościowekategorialne" class="level4">
<h4 class="anchored" data-anchor-id="dane-jakościowekategorialne">Dane jakościowe/kategorialne</h4>
<p><strong>Dane nominalne</strong> reprezentują kategorie bez naturalnego porządku:</p>
<p><strong>Przykłady:</strong></p>
<ul>
<li><strong>Kraj urodzenia</strong>: USA, Chiny, Indie, Brazylia…</li>
<li><strong>Religia</strong>: Chrześcijaństwo, Islam, Hinduizm, Buddyzm, Brak…</li>
<li><strong>Stan cywilny</strong>: Kawaler/Panna, Żonaty/Mężatka, Rozwiedziony/a, Wdowiec/Wdowa</li>
<li><strong>Przyczyna śmierci</strong>: Choroby serca, Rak, Wypadek, Udar…</li>
<li><strong>Grupa krwi</strong>: A, B, AB, 0</li>
</ul>
<p><strong>Co możemy zrobić:</strong></p>
<ul>
<li>Liczyć częstości</li>
<li>Obliczać proporcje</li>
<li>Znaleźć modę</li>
<li>Testować niezależność</li>
</ul>
<p><strong>Czego nie możemy zrobić:</strong></p>
<ul>
<li>Obliczać średniej (średnia religia nie ma sensu)</li>
<li>Porządkować kategorii znacząco</li>
<li>Obliczać odległości między kategoriami</li>
</ul>
<p><strong>Dane porządkowe</strong> reprezentują uporządkowane kategorie:</p>
<p><strong>Przykłady:</strong></p>
<ul>
<li><strong>Poziom wykształcenia</strong>: Brak &lt; Podstawowe &lt; Średnie &lt; Wyższe</li>
<li><strong>Status społeczno-ekonomiczny</strong>: Niski &lt; Średni &lt; Wysoki</li>
<li><strong>Samoocena zdrowia</strong>: Zły &lt; Przeciętny &lt; Dobry &lt; Doskonały</li>
<li><strong>Skala zgody</strong>: Zdecydowanie się nie zgadzam &lt; Nie zgadzam się &lt; Neutralny &lt; Zgadzam się &lt; Zdecydowanie się zgadzam</li>
</ul>
<p><strong>Uwaga</strong>: Interwały między kategoriami niekoniecznie są równe. „Odległość” od Złego do Przeciętnego zdrowia może nie równać się odległości od Dobrego do Doskonałego.</p>
</section>
</section>
<section id="rozkład-danych" class="level3">
<h3 class="anchored" data-anchor-id="rozkład-danych">Rozkład danych</h3>
<p><strong>Rozkład danych</strong> opisuje, jak wartości rozkładają się na możliwe wyniki (jakie wartości cecha przyjmuje i jak często). Rozkłady mówią nam, jakie wartości są powszechne, jakie wartości są rzadkie i jakie wzorce istnieją w naszych danych.</p>
<section id="opisywanie-rozkładów" class="level4">
<h4 class="anchored" data-anchor-id="opisywanie-rozkładów">Opisywanie rozkładów</h4>
<p><strong>Charakterystyki kształtu:</strong></p>
<p><strong>Symetria vs.&nbsp;Skośność:</strong></p>
<ul>
<li><strong>Symetryczny</strong>: Lustrzane odbicie wokół środka (przykład: wzrost w jednorodnej populacji)</li>
<li><strong>Prawostronnie skośny (skośność dodatnia)</strong>: Długi ogon po prawej stronie (przykład: dochód, bogactwo)</li>
<li><strong>Lewostronnie skośny (skośność ujemna)</strong>: Długi ogon po lewej stronie (przykład: liczba lat życia w krajach rozwiniętych)</li>
</ul>
<p><strong>Przykład wpływu skośności:</strong></p>
<p>Rozkład dochodu w USA:</p>
<ul>
<li>Mediana dochodu gospodarstwa domowego: ~70 000 USD</li>
<li>Średni dochód gospodarstwa domowego: ~100 000 USD</li>
<li>Średnia &gt; Mediana wskazuje na skośność prawostronną</li>
<li>Kilka bardzo wysokich dochodów podnosi średnią</li>
</ul>
<p><a href="https://mathspace.co/textbooks/syllabuses/Syllabus-1189/topics/Topic-22474/subtopics/Subtopic-290603/?coreTextbookSubtopicActiveTab=solidifyLesson&amp;activeLessonTab=content"><img src="stat_imgs/skewness-2.svg" class="img-fluid"></a></p>
<p><strong>Modalność:</strong></p>
<ul>
<li><strong>Jednomodalny</strong>: Jeden szczyt (przykład: wyniki testów)</li>
<li><strong>Dwumodalny</strong>: Dwa szczyty (przykład: wzrost przy mieszaniu mężczyzn i kobiet)</li>
<li><strong>Wielomodalny</strong>: Wiele szczytów (przykład: rozkład wieku w mieście uniwersyteckim — szczyty w wieku studenckim i średnim wieku)</li>
</ul>
<p><strong>Ważne rozkłady prawdopodobieństwa:</strong></p>
<p><strong>Rozkład normalny (Gaussa):</strong></p>
<ul>
<li>Kształt dzwonu, symetryczny</li>
<li>Charakteryzowany przez średnią (<span class="math inline">\mu</span>) i odchylenie standardowe (<span class="math inline">\sigma</span>)</li>
<li>Około 68% wartości w granicach <span class="math inline">\mu \pm \sigma</span></li>
<li>Około 95% w granicach <span class="math inline">\mu \pm 2\sigma</span></li>
<li>Około 99,7% w granicach <span class="math inline">\mu \pm 3\sigma</span></li>
</ul>
<p><em>Zastosowania demograficzne:</em></p>
<ul>
<li>Wzrost w jednorodnych populacjach</li>
<li>Błędy pomiarowe</li>
<li>Rozkłady próbkowania średnich (Centralne Twierdzenie Graniczne)</li>
</ul>
<p><strong>Rozkład dwumianowy:</strong></p>
<ul>
<li>Liczba sukcesów w <span class="math inline">n</span> niezależnych próbach</li>
<li>Każda próba ma prawdopodobieństwo <span class="math inline">p</span> sukcesu</li>
<li>Średnia = <span class="math inline">np</span>, Wariancja = <span class="math inline">np(1-p)</span></li>
</ul>
<p><em>Przykład</em>: Liczba urodzeń chłopców na 100 urodzeń (<span class="math inline">p \approx 0,512</span>)</p>
<p><strong>Rozkład Poissona:</strong></p>
<ul>
<li>Liczba zdarzeń w stałym czasie/przestrzeni</li>
<li>Średnia = Wariancja = <span class="math inline">\lambda</span></li>
<li>Dobry dla rzadkich zdarzeń</li>
</ul>
<p><em>Zastosowania demograficzne:</em></p>
<ul>
<li>Liczba zgonów dziennie w małym mieście</li>
<li>Liczba urodzeń na godzinę w szpitalu</li>
<li>Liczba wypadków na skrzyżowaniu miesięcznie</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="rozkład-częstości" class="level3">
<h3 class="anchored" data-anchor-id="rozkład-częstości">Rozkład częstości</h3>
<p><strong>Rozkład częstości</strong> pokazuje, jak często każda wartość występuje w zbiorze danych. To często pierwszy krok w zrozumieniu twoich danych.</p>
<section id="komponenty-rozkładów-częstości" class="level4">
<h4 class="anchored" data-anchor-id="komponenty-rozkładów-częstości">Komponenty rozkładów częstości</h4>
<p><strong>Częstość bezwzględna</strong>: Liczba obserwacji dla każdej wartości.</p>
<p><strong>Częstość względna</strong>: Proporcja w każdej kategorii. <span class="math display">\text{Częstość względna} = \frac{\text{Liczba}}{\text{Suma}}</span></p>
<p><strong>Częstość skumulowana</strong>: Suma bieżąca do każdej wartości.</p>
<p><strong>Szczegółowy przykład</strong>: Rozkład wieku w badaniu zdrowotnym społeczności 200 osób:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Grupa wiekowa</th>
<th>Częstość bezwzględna</th>
<th>Częstość względna</th>
<th>Częstość skumulowana</th>
<th>Skumulowana %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0-9</td>
<td>24</td>
<td>0,12</td>
<td>24</td>
<td>12%</td>
</tr>
<tr class="even">
<td>10-19</td>
<td>28</td>
<td>0,14</td>
<td>52</td>
<td>26%</td>
</tr>
<tr class="odd">
<td>20-29</td>
<td>35</td>
<td>0,175</td>
<td>87</td>
<td>43,5%</td>
</tr>
<tr class="even">
<td>30-39</td>
<td>32</td>
<td>0,16</td>
<td>119</td>
<td>59,5%</td>
</tr>
<tr class="odd">
<td>40-49</td>
<td>30</td>
<td>0,15</td>
<td>149</td>
<td>74,5%</td>
</tr>
<tr class="even">
<td>50-59</td>
<td>25</td>
<td>0,125</td>
<td>174</td>
<td>87%</td>
</tr>
<tr class="odd">
<td>60-69</td>
<td>16</td>
<td>0,08</td>
<td>190</td>
<td>95%</td>
</tr>
<tr class="even">
<td>70+</td>
<td>10</td>
<td>0,05</td>
<td>200</td>
<td>100%</td>
</tr>
</tbody>
</table>
<p><strong>Co to nam mówi:</strong></p>
<ul>
<li>Moda: grupa wiekowa 20-29 (najwyższa częstość)</li>
<li>Mediana: W grupie 30-39 (skumulowana przekracza 50% tutaj)</li>
<li>Młoda populacja: 43,5% poniżej 30 lat</li>
<li>Wiek produkcyjny (20-59): 60,5% populacji</li>
</ul>
</section>
<section id="wizualizacja-rozkładów-częstości" class="level4">
<h4 class="anchored">Wizualizacja rozkładów częstości</h4>
<p><strong>Histogram</strong>: Dla danych ciągłych, pokazuje częstość wysokościami słupków.</p>
<ul>
<li>Oś X: Zakresy wartości (przedziały)</li>
<li>Oś Y: Częstość lub gęstość</li>
<li>Brak przerw między słupkami (dane ciągłe)</li>
<li>Szerokość przedziału wpływa na wygląd</li>
</ul>
<p>Masz rację! Oto poprawiona, bardziej naturalna wersja po polsku:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Histogramy krok po kroku: częstość i gęstość
</div>
</div>
<div class="callout-body-container callout-body">
<section id="czym-się-różni-częstość-od-gęstości" class="level3">
<h3 class="anchored" data-anchor-id="czym-się-różni-częstość-od-gęstości">Czym się różni częstość od gęstości?</h3>
<p>Wyobraź sobie, że sortujesz dane do koszyków:</p>
<ul>
<li><strong>Częstość (frequency)</strong> = Ile obserwacji trafiło do każdego koszyka (po prostu liczymy)</li>
<li><strong>Gęstość (density)</strong> = Jak bardzo “zagęszczone” są dane w przeliczeniu na jednostkę</li>
</ul>
</section>
<section id="po-co-w-ogóle-ta-gęstość" class="level3">
<h3 class="anchored" data-anchor-id="po-co-w-ogóle-ta-gęstość">Po co w ogóle ta gęstość?</h3>
<p>Załóżmy, że porównujesz wzrost 50 osób z próbą 5000 osób. Gdybyś używał zwykłych zliczeń, drugi histogram byłby olbrzymi! Gęstość przeskalowuje dane tak, żebyś mógł porównywać kształty rozkładów niezależnie od tego, ile masz obserwacji.</p>
</section>
<section id="o-co-w-tym-chodzi" class="level3">
<h3 class="anchored" data-anchor-id="o-co-w-tym-chodzi">O co w tym chodzi?</h3>
<p>Przechodząc z częstości na gęstość, tak naprawdę pytamy: <strong>“Jaki ułamek danych przypada tu w przeliczeniu na jednostkę?”</strong></p>
<p>Przykład dla jednego słupka:</p>
<ul>
<li><strong>Częstość</strong> mówi ci: “15 osób ma wzrost 170-175 cm”</li>
<li><strong>Gęstość</strong> mówi ci: “3% osób <strong>na każdy centymetr</strong> mieści się w tym przedziale”</li>
</ul>
<p>⚠️ <strong>Uwaga:</strong> Gęstość to NIE jest prawdopodobieństwo! To prawdopodobieństwo <strong>na jednostkę</strong> (np. na centymetr). Żeby dostać prawdopodobieństwo, musisz pomnożyć gęstość przez szerokość słupka.</p>
<p>Wzór jest prosty: <span class="math display">\text{Gęstość} = \frac{\text{Liczba obserwacji w słupku}}{\text{Wszystkie obserwacje} \times \text{Szerokość słupka}}</span></p>
<p>Kiedy pomnożysz gęstość przez szerokość słupka, dostajesz <strong>prawdopodobieństwo</strong>: <span class="math display">\text{Prawdopodobieństwo} = \text{Gęstość} \times \text{Szerokość słupka}</span></p>
<p>Suma wszystkich prawdopodobieństw (pól słupków) daje 1!</p>
</section>
<section id="przykład-w-r" class="level3">
<h3 class="anchored" data-anchor-id="przykład-w-r">Przykład w R</h3>
<section id="krok-1-zwykłe-liczenie-częstość" class="level4">
<h4 class="anchored" data-anchor-id="krok-1-zwykłe-liczenie-częstość">Krok 1: Zwykłe liczenie (częstość)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heights, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">boundary =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram częstości"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wzrost (cm)"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Liczba osób"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/hist-frequency-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Ile osób mieści się w każdym przedziale wzrostu?</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-2-przeskalowanie-do-gęstości" class="level4">
<h4 class="anchored" data-anchor-id="krok-2-przeskalowanie-do-gęstości">Krok 2: Przeskalowanie do gęstości</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heights, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">boundary =</span> <span class="dv">0</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram gęstości z wygładzoną krzywą"</span>, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wzrost (cm)"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Gęstość (prawdopodobieństwo/cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/hist-density-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Te same dane, ale teraz oś Y pokazuje prawdopodobieństwo na cm. Suma pól wszystkich słupków = 1</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-3-sprawdźmy-na-konkretnym-przykładzie" class="level4">
<h4 class="anchored" data-anchor-id="krok-3-sprawdźmy-na-konkretnym-przykładzie">Krok 3: Sprawdźmy na konkretnym przykładzie</h4>
<p>Weźmy przedział 170-175 cm i zobaczmy, jak to działa:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Liczymy osoby między 170 a 175 cm</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>osoby_170_175 <span class="ot">&lt;-</span> <span class="fu">sum</span>(heights<span class="sc">$</span>height <span class="sc">&gt;=</span> <span class="dv">170</span> <span class="sc">&amp;</span> heights<span class="sc">$</span>height <span class="sc">&lt;</span> <span class="dv">175</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>wszystkie_osoby <span class="ot">&lt;-</span> <span class="fu">nrow</span>(heights)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>szerokosc <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczamy gęstość i prawdopodobieństwo</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>gestosc <span class="ot">&lt;-</span> osoby_170_175 <span class="sc">/</span> (wszystkie_osoby <span class="sc">*</span> szerokosc)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>prawdopodobienstwo <span class="ot">&lt;-</span> gestosc <span class="sc">*</span> szerokosc  <span class="co"># Pole = prawdopodobieństwo</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Osób w przedziale [170, 175) cm:"</span>, osoby_170_175, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Osób w przedziale [170, 175) cm: 79 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Gęstość (wysokość słupka):"</span>, <span class="fu">round</span>(gestosc, <span class="dv">4</span>), <span class="st">"na cm</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Gęstość (wysokość słupka): 0.0316 na cm</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Prawdopodobieństwo (pole słupka):"</span>, <span class="fu">round</span>(prawdopodobienstwo, <span class="dv">3</span>), </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"czyli"</span>, <span class="fu">round</span>(prawdopodobienstwo <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Prawdopodobieństwo (pole słupka): 0.158 czyli 15.8 %</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sprawdzenie: Gęstość × Szerokość ="</span>, <span class="fu">round</span>(gestosc, <span class="dv">4</span>), </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"×"</span>, szerokosc, <span class="st">"="</span>, <span class="fu">round</span>(prawdopodobienstwo, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sprawdzenie: Gęstość × Szerokość = 0.0316 × 5 = 0.158</code></pre>
</div>
</div>
</section>
</section>
<section id="analogia" class="level3">
<h3 class="anchored" data-anchor-id="analogia">Analogia</h3>
<p>To jak gęstość zaludnienia:</p>
<ul>
<li><strong>Warszawa</strong> ma wysoką gęstość (dużo mieszkańców na km²)</li>
<li><strong>Podlasie</strong> ma niską gęstość (mało mieszkańców na km²)</li>
<li>Sama gęstość nie mówi ile dokładnie ludzi tam mieszka — musisz pomnożyć przez powierzchnię!</li>
</ul>
<p>Tak samo w histogramach:</p>
<ul>
<li><strong>Gęstość</strong> = zagęszczenie danych (prawdopodobieństwo/jednostkę)</li>
<li><strong>Pole słupka</strong> = prawdopodobieństwo (gęstość × szerokość)</li>
</ul>
</section>
<section id="najważniejsze-dla-początkujących" class="level3">
<h3 class="anchored" data-anchor-id="najważniejsze-dla-początkujących">Najważniejsze dla początkujących</h3>
<ol type="1">
<li><strong>Częstość = ile sztuk</strong> (konkretne liczby)</li>
<li><strong>Gęstość = prawdopodobieństwo/jednostkę</strong> (np. na centymetr)</li>
<li><strong>Gęstość może przekraczać 1</strong> (bo to nie jest prawdopodobieństwo!)</li>
<li><strong>Pole słupka = prawdopodobieństwo</strong> (to już musi być ≤ 1)</li>
<li><strong>Suma wszystkich pól = 1</strong> (100% prawdopodobieństwa)</li>
<li><strong>Czerwona krzywa</strong> pokazuje, jak wyglądałby rozkład dla nieskończenie wielu punktów danych</li>
</ol>
</section>
<section id="kiedy-co-stosować" class="level3">
<h3 class="anchored" data-anchor-id="kiedy-co-stosować">Kiedy co stosować?</h3>
<ul>
<li><strong>Częstość</strong> — gdy interesują cię konkretne liczby (“Ilu klientów kupiło produkt X?”)</li>
<li><strong>Gęstość</strong> — gdy chcesz porównywać rozkłady lub liczyć prawdopodobieństwa (“Jakie jest prawdopodobieństwo, że losowy klient ma 25-30 lat?”)</li>
</ul>
</section>
<section id="wzór-do-zapamiętania" class="level3">
<h3 class="anchored" data-anchor-id="wzór-do-zapamiętania">Wzór do zapamiętania</h3>
<p>Dla każdego słupka histogramu:</p>
<ul>
<li><strong>Wysokość</strong> (gęstość) = prawdopodobieństwo/jednostkę</li>
<li><strong>Szerokość</strong> = rozmiar przedziału</li>
<li><strong>Pole</strong> (wysokość × szerokość) = prawdopodobieństwo dla tego zakresu</li>
</ul>
</section>
</div>
</div>
<p><strong>Wykres słupkowy</strong>: Dla danych kategorycznych, pokazuje częstość z oddzielonymi słupkami.</p>
<ul>
<li>Oś X: Kategorie</li>
<li>Oś Y: Częstość</li>
<li>Przerwy między słupkami (dyskretne kategorie)</li>
<li>Kolejność może mieć znaczenie lub nie</li>
</ul>
<p><strong>Dystrybuanta (Funkcja Rozkładu Skumulowanego)</strong>: Pokazuje proporcję wartości ≤ każdego punktu danych. - Zawsze rośnie (lub pozostaje płaska) - Zaczyna się od 0, kończy na 1 - Strome nachylenia wskazują na częste wartości - Płaskie obszary wskazują na rzadkie wartości</p>
<p><strong>Wykres Pudełkowy (Wykres Skrzynkowy)</strong>: Wizualne podsumowanie, które przedstawia kluczowe statystyki rozkładu przy użyciu pięciu kluczowych wartości.</p>
<p><strong>Podsumowanie Pięciu Liczb:</strong></p>
<ul>
<li><strong>Minimum</strong>: Koniec lewego wąsa (z wyłączeniem wartości odstających)</li>
<li><strong>Q1 (Pierwszy Kwartyl)</strong>: Lewa krawędź pudełka (25. percentyl)</li>
<li><strong>Mediana (Q2)</strong>: Linia wewnątrz pudełka (50. percentyl)<br>
</li>
<li><strong>Q3 (Trzeci Kwartyl)</strong>: Prawa krawędź pudełka (75. percentyl)</li>
<li><strong>Maksimum</strong>: Koniec prawego wąsa (z wyłączeniem wartości odstających)</li>
</ul>
<p><strong>Co Pokazuje:</strong></p>
<ul>
<li><strong>Skośność</strong>: Jeśli linia mediany jest przesunięta w pudełku lub wąsy są nierówne</li>
<li><strong>Rozrzut</strong>: Szersze pudełka i dłuższe wąsy wskazują na większą zmienność</li>
<li><strong>Wartości odstające</strong>: Natychmiast widoczne jako oddzielne punkty</li>
<li><strong>Symetria</strong>: Równe długości wąsów i wyśrodkowana mediana sugerują rozkład normalny</li>
</ul>
<p><strong>Szybka Interpretacja:</strong></p>
<ul>
<li>Wąskie pudełko = spójne dane</li>
<li>Długie wąsy = szeroki zakres wartości<br>
</li>
<li>Wiele wartości odstających = potencjalne problemy z jakością danych lub interesujące przypadki skrajne</li>
<li>Mediana bliżej Q1 = dane skośne prawostronnie (ogon rozciąga się w prawo)</li>
<li>Mediana bliżej Q3 = dane skośne lewostronnie (ogon rozciąga się w lewo)</li>
</ul>
<p>Wykresy pudełkowe są szczególnie użyteczne do porównywania wielu grup obok siebie!</p>
<hr>
</section>
</section>
</section>
<section id="populacje-i-próby" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="populacje-i-próby"><span class="header-section-number">2.3</span> Populacje i próby</h2>
<p>Zrozumienie rozróżnienia między populacjami a próbami jest kluczowe dla właściwej analizy statystycznej. To rozróżnienie wpływa na każdy aspekt naszej analizy, od zbierania danych po interpretację wyników.</p>
<section id="populacja-population" class="level3">
<h3 class="anchored" data-anchor-id="populacja-population">Populacja (Population)</h3>
<p><strong>Populacja</strong> to kompletny zbiór jednostek, obiektów lub pomiarów, o których chcemy wyciągnąć wnioski. Kluczowe słowo to „kompletny” — populacja obejmuje każdego pojedynczego członka grupy, którą badamy.</p>
<p><strong>Przykłady populacji w demografii:</strong></p>
<ul>
<li><strong>Wszyscy mieszkańcy Polski na dzień 1 stycznia 2024</strong>: Obejmuje każdą osobę mieszkającą w Polsce w tym konkretnym dniu — około 38 milionów osób.</li>
<li><strong>Wszystkie urodzenia w Szwecji w 2023 roku</strong>: Każde dziecko urodzone w granicach Szwecji w tym roku kalendarzowym — około 100 000 urodzeń.</li>
<li><strong>Wszystkie gospodarstwa domowe w Tokio</strong>: Każda jednostka mieszkalna, gdzie ludzie mieszkają, gotują i śpią — około 7 milionów gospodarstw.</li>
<li><strong>Wszystkie zgony z powodu COVID-19 na świecie w 2020 roku</strong>: Każdy zgon, gdzie COVID-19 został wymieniony jako przyczyna — kilka milionów zgonów.</li>
</ul>
<p>Populacje mogą być:</p>
<p><strong>Skończone (Finite)</strong>: Mające policzalną liczbę członków (wszyscy obecni obywatele Polski, wszytkie gminy w Polsce w 2024 r.)</p>
<p><strong>Nieskończone (Infinite)</strong>: Teoretyczne lub niepoliczalnie duże (wszystkie możliwe przyszłe urodzenia)</p>
<p><strong>Stałe (Fixed)</strong>: Zdefiniowane w określonym punkcie czasu (wszyscy mieszkańcy w dniu spisu)</p>
<p><strong>Dynamiczne (Dynamic)</strong>: Zmieniające się w czasie (populacja miasta doświadczająca urodzeń, zgonów i migracji codziennie)</p>
</section>
<section id="próba-sample" class="level3">
<h3 class="anchored" data-anchor-id="próba-sample">Próba (Sample)</h3>
<p><strong>Próba</strong> to podzbiór populacji, który jest faktycznie obserwowany lub mierzony. Badamy próby, ponieważ badanie całych populacji jest często niemożliwe, niepraktyczne lub niepotrzebne.</p>
<p><strong>Dlaczego używamy prób:</strong></p>
<p><strong>Praktyczna niemożliwość</strong>: Wyobraź sobie testowanie każdej osoby w Chinach na obecność pewnej choroby. Zanim skończyłbyś testować 1,4 miliarda ludzi, sytuacja chorobowa całkowicie by się zmieniła, a niektórzy ludzie testowani wcześnie wymagaliby ponownego testowania.</p>
<p><strong>Względy kosztowe</strong>: Amerykański spis powszechny z 2020 roku kosztował około 16 miliardów dolarów. Przeprowadzanie tak kompletnych wyliczeń często byłoby zbyt kosztowne.</p>
<p><strong>Ograniczenia czasowe</strong>: Decydenci często potrzebują informacji szybko. Badanie ankietowe 10 000 osób można ukończyć w ciągu tygodni, podczas gdy spis wymaga lat planowania, wykonania i przetwarzania.</p>
<p><strong>Pomiar destrukcyjny</strong>: Niektóre pomiary niszczą to, co jest mierzone. Testowanie żywotności żarówek wymaga użycia prób.</p>
<p><strong>Większa dokładność</strong>: Co zaskakujące, próby mogą czasem być dokładniejsze niż badania pełne. Z próbą można pozwolić sobie na lepsze szkolenie ankieterów, bardziej staranne zbieranie danych i dokładniejsze kontrole jakości.</p>
<p><strong>Przykład próby vs.&nbsp;populacja:</strong></p>
<p>Powiedzmy, że chcemy poznać średnią wielkość gospodarstwa domowego w Warszawie:</p>
<ul>
<li><strong>Populacja</strong>: Wszystkie 800 000 gospodarstw domowych w Warszawie</li>
<li><strong>Podejście spisowe</strong>: Próba skontaktowania się z każdym gospodarstwem (drogie, czasochłonne, niektóre zostaną pominięte)</li>
<li><strong>Podejście próbkowe</strong>: Losowo wybrać 5000 gospodarstw, dokładnie zmierzyć ich wielkości i użyć tego do oszacowania średniej dla wszystkich gospodarstw</li>
<li><strong>Wynik</strong>: Próba może znaleźć średnią 2,43 osób na gospodarstwo z marginesem błędu ±0,05, co oznacza, że jesteśmy pewni, że prawdziwa średnia populacji mieści się między 2,38 a 2,48</li>
</ul>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Superpopulacja i Proces Generowania Danych (DGP) (*)
</div>
</div>
<div class="callout-body-container callout-body">
<hr>
<section id="superpopulacja-superpopulation" class="level3">
<h3 class="anchored" data-anchor-id="superpopulacja-superpopulation"><strong>Superpopulacja (Superpopulation)</strong></h3>
<p><strong>Superpopulacja</strong> to teoretyczna nieskończona populacja, z której twoja skończona populacja jest traktowana jako jedna losowa próba.</p>
<p><strong>Pomyśl o tym w trzech poziomach:</strong></p>
<ol type="1">
<li><strong>Superpopulacja</strong>: Nieskończony zbiór możliwych wartości (teoretyczny)</li>
<li><strong>Populacja skończona (finite population)</strong>: Rzeczywista populacja, którą teoretycznie możesz spisać (np. wszystkie 50 stanów USA, wszystkie 10 000 firm w branży)</li>
<li><strong>Próba (sample)</strong>: Podzbiór, który faktycznie obserwujesz (np. 30 stanów, 500 firm)</li>
</ol>
<p><strong>Dlaczego potrzebujemy tego pojęcia?</strong></p>
<p>Rozważmy 50 stanów USA. Możesz zmierzyć stopę bezrobocia dla wszystkich 50 stanów — pełny spis, bez próbkowania. Ale nadal chcesz:</p>
<ul>
<li>Sprawdzić, czy bezrobocie jest powiązane z poziomem wykształcenia</li>
<li>Przewidzieć przyszłoroczne stopy bezrobocia</li>
<li>Określić, czy różnice między stanami są „istotne statystycznie”</li>
</ul>
<p>Bez koncepcji superpopulacji utkniesz — masz wszystkie dane, więc co pozostaje do wnioskowania? Odpowiedź: traktuj tegoroczne 50 wartości jako jedno losowanie z nieskończonej superpopulacji możliwych wartości, które mogłyby wystąpić w podobnych warunkach.</p>
<p><strong>Reprezentacja matematyczna:</strong></p>
<ul>
<li>Wartość populacji skończonej: <span class="math inline">Y_i</span> (stopa bezrobocia stanu i)</li>
<li>Model superpopulacji: <span class="math inline">Y_i = \mu + \epsilon_i</span> gdzie <span class="math inline">\epsilon_i \sim (0, \sigma^2)</span></li>
<li>50 zaobserwowanych wartości to jedna realizacja tego procesu</li>
</ul>
<hr>
</section>
<section id="proces-generowania-danych-data-generating-process-prawdziwa-recepta" class="level3">
<h3 class="anchored" data-anchor-id="proces-generowania-danych-data-generating-process-prawdziwa-recepta"><strong>Proces Generowania Danych (Data Generating Process): Prawdziwa Recepta</strong></h3>
<p><strong>Proces Generowania Danych (DGP)</strong> to rzeczywisty mechanizm, który tworzy twoje dane — włączając wszystkie czynniki, relacje i elementy losowe.</p>
<p><strong>Intuicyjny przykład:</strong> Załóżmy, że wyniki testów uczniów są naprawdę generowane przez:</p>
<p><span class="math display">\text{Wynik}_i = 50 + 2(\text{GodzinyNauki}_i) + 3(\text{GodzinySnu}_i) - 5(\text{Stres}_i) + 1.5(\text{Śniadanie}_i) + \epsilon_i</span></p>
<p>To jest PRAWDZIWY DGP. Ale ty tego nie wiesz! Możesz estymować:</p>
<p><span class="math display">\text{Wynik}_i = \alpha + \beta(\text{GodzinyNauki}_i) + u_i</span></p>
<p>Twój model jest prostszy niż rzeczywistość. Brakuje ci zmiennych (sen, stres, śniadanie), więc twoje oszacowania mogą być obciążone (biased). Składnik <span class="math inline">u_i</span> zawiera wszystko, co pominąłeś.</p>
<p><strong>Kluczowa intuicja</strong>: Nigdy nie znamy prawdziwego DGP. Nasze modele statystyczne są zawsze przybliżeniami, próbującymi uchwycić najważniejsze części nieznanej, złożonej prawdy.</p>
<hr>
</section>
<section id="dwa-podejścia-do-wnioskowania-statystycznego" class="level3">
<h3 class="anchored" data-anchor-id="dwa-podejścia-do-wnioskowania-statystycznego"><strong>Dwa Podejścia do Wnioskowania Statystycznego</strong></h3>
<p>Analizując dane, szczególnie z badań czy prób, możemy przyjąć dwa filozoficzne podejścia:</p>
<section id="wnioskowanie-oparte-na-schemacie-design-based-inference" class="level4">
<h4 class="anchored" data-anchor-id="wnioskowanie-oparte-na-schemacie-design-based-inference"><strong>1. Wnioskowanie Oparte na Schemacie (Design-Based Inference)</strong></h4>
<ul>
<li><strong>Filozofia</strong>: Wartości populacji są stałymi liczbami. Losowość pochodzi TYLKO z tego, które jednostki wylosowaliśmy.</li>
<li><strong>Skupienie</strong>: Jak wybraliśmy próbę (losowanie proste, warstwowe, gniazdowe itp.)</li>
<li><strong>Przykład</strong>: Średni dochód hrabstw Kalifornii jest stałą liczbą. Losujemy 10 hrabstw. Nasza niepewność wynika z tego, które 10 losowo wybraliśmy.</li>
<li><strong>Bez modeli</strong>: Nie zakładamy nic o rozkładzie wartości populacji</li>
</ul>
</section>
<section id="wnioskowanie-oparte-na-modelu-model-based-inference" class="level4">
<h4 class="anchored" data-anchor-id="wnioskowanie-oparte-na-modelu-model-based-inference"><strong>2. Wnioskowanie Oparte na Modelu (Model-Based Inference)</strong></h4>
<ul>
<li><strong>Filozofia</strong>: Same wartości populacji są realizacjami z pewnego modelu probabilistycznego (superpopulacji)</li>
<li><strong>Skupienie</strong>: Model statystyczny generujący wartości populacji</li>
<li><strong>Przykład</strong>: Dochód każdego hrabstwa Kalifornii jest losowany z: <span class="math inline">Y_i = \mu + \epsilon_i</span> gdzie <span class="math inline">\epsilon_i \sim N(0, \sigma^2)</span></li>
<li><strong>Wymagane modele</strong>: Przyjmujemy założenia o tym, jak dane zostały wygenerowane</li>
</ul>
<p><strong>Które jest lepsze?</strong></p>
<ul>
<li><strong>Duże populacje, dobre próby losowe</strong>: Podejście oparte na schemacie działa dobrze</li>
<li><strong>Małe populacje (jak 50 stanów)</strong>: Często konieczne podejście modelowe</li>
<li><strong>Pełne spisanie</strong>: Tylko podejście modelowe umożliwia wnioskowanie</li>
<li><strong>Współczesna praktyka</strong>: Często łączy oba podejścia</li>
</ul>
<hr>
</section>
</section>
<section id="praktyczny-przykład-analiza-wydatków-stanowych-na-edukację" class="level3">
<h3 class="anchored" data-anchor-id="praktyczny-przykład-analiza-wydatków-stanowych-na-edukację"><strong>Praktyczny Przykład: Analiza Wydatków Stanowych na Edukację</strong></h3>
<p>Załóżmy, że zbierasz wydatki na edukację per uczeń dla wszystkich 50 stanów USA.</p>
<p><strong>Bez myślenia superpopulacyjnego:</strong></p>
<ul>
<li>Masz wszystkie 50 wartości — to wszystko</li>
<li>Średnia to średnia, bez niepewności</li>
<li>Nie możesz testować hipotez ani tworzyć prognoz</li>
</ul>
<p><strong>Z myśleniem superpopulacyjnym:</strong></p>
<ul>
<li>Tegoroczne 50 wartości to jedna realizacja z superpopulacji</li>
<li>Model: <span class="math inline">\text{Wydatki}_i = \mu + \beta(\text{DochódStanu}_i) + \epsilon_i</span></li>
<li>Teraz możesz:
<ul>
<li>Testować, czy wydatki są powiązane z dochodem stanu (<span class="math inline">\beta \neq 0</span>?)</li>
<li>Przewidywać przyszłoroczne wartości</li>
<li>Obliczać przedziały ufności</li>
</ul></li>
</ul>
<p><strong>Kluczowa intuicja</strong>: Nawet z kompletnymi danymi, ramy superpopulacji umożliwiają wnioskowanie statystyczne poprzez traktowanie obserwowanych wartości jako jednego możliwego wyniku z podstawowego procesu stochastycznego.</p>
<hr>
</section>
<section id="podsumowanie" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie"><strong>Podsumowanie</strong></h3>
<ul>
<li><p><strong>Superpopulacja</strong>: Traktuje twoją populację skończoną jako jedno losowanie z nieskończonej przestrzeni możliwości — niezbędne, gdy twoja populacja skończona jest mała lub całkowicie obserwowana</p></li>
<li><p><strong>DGP</strong>: Prawdziwy (nieznany) proces tworzący twoje dane — twoje modele próbują go przybliżyć</p></li>
</ul>
</section>
</div>
</div>
<hr>
</section>
</section>
<section id="zmienne-i-skale-pomiarowe" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="zmienne-i-skale-pomiarowe"><span class="header-section-number">2.4</span> Zmienne i skale pomiarowe</h2>
<p>Zanim zagłębimy się w populacje i próby, musimy zrozumieć typy zmiennych, z którymi pracujemy i jak je mierzymy.</p>
<blockquote class="blockquote">
<p><strong>Zmienna</strong> to każda charakterystyka, która może przyjmować różne wartości dla różnych jednostek obserwacji.</p>
</blockquote>
<section id="pomiar-przekształcanie-pojęć-w-liczby" class="level3">
<h3 class="anchored" data-anchor-id="pomiar-przekształcanie-pojęć-w-liczby">Pomiar: przekształcanie pojęć w liczby</h3>
<section id="świat-polityki-jest-pełen-danych" class="level4">
<h4 class="anchored">Świat polityki jest pełen danych</h4>
<p>Politologia ewoluowała z dyscypliny głównie teoretycznej do takiej, która coraz bardziej opiera się na dowodach empirycznych. Niezależnie od tego, czy badamy:</p>
<ul>
<li><strong>Wyniki wyborów</strong>: Dlaczego ludzie głosują tak, jak głosują?</li>
<li><strong>Opinię publiczną</strong>: Co kształtuje postawy wobec imigracji lub polityki klimatycznej?</li>
<li><strong>Stosunki międzynarodowe</strong>: Jakie czynniki przewidują konflikt między narodami/państwami?</li>
<li><strong>Skuteczność polityk</strong>: Czy nowa polityka edukacyjna rzeczywiście poprawiła wyniki uczniów?</li>
</ul>
<p>Potrzebujemy systematycznych sposobów analizowania danych i wyciągania wniosków, które wykraczają poza anegdoty i osobiste wrażenia.</p>
<blockquote class="blockquote">
<p>Rozważ to pytanie: “Czy demokracja prowadzi do wzrostu gospodarczego?”</p>
</blockquote>
<p>Twoja intuicja może sugerować, że tak - kraje demokratyczne są zazwyczaj bogatsze. Ale czy to przyczynowość, czy korelacja? Czy są wyjątki? Jak pewni możemy być naszych wniosków?</p>
<p>Statystyka dostarcza narzędzi do przejścia od przeczuć do odpowiedzi opartych na dowodach, pomagając nam rozróżnić między tym, co wydaje się prawdziwe, a tym, co rzeczywiście jest prawdziwe.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🔍 Korelacja ≠ Przyczynowość: Zrozumienie Związków Pozornych (spurious correlation)
</div>
</div>
<div class="callout-body-container callout-body">
<section id="fundamentalne-rozróżnienie" class="level3">
<h3 class="anchored" data-anchor-id="fundamentalne-rozróżnienie"><strong>Fundamentalne Rozróżnienie</strong></h3>
<p><strong>Korelacja (correlation)</strong> mierzy, jak dwie zmienne poruszają się razem:</p>
<ul>
<li>Dodatnia: Obie rosną razem (godziny nauki ↑, oceny ↑)</li>
<li>Ujemna: Jedna rośnie, gdy druga maleje (godziny TV ↑, oceny ↓)</li>
<li>Mierzona współczynnikiem korelacji: <span class="math inline">r \in [-1, 1]</span></li>
</ul>
<p><strong>Przyczynowość (causation)</strong> oznacza, że jedna zmienna bezpośrednio wpływa na drugą:</p>
<ul>
<li><span class="math inline">X \rightarrow Y</span>: Zmiany w X bezpośrednio powodują zmiany w Y</li>
<li>Wymaga: (1) korelacji, (2) poprzedzania czasowego, (3) braku alternatywnych wyjaśnień</li>
</ul>
</section>
<section id="zagrożenie-korelacja-pozorna" class="level3">
<h3 class="anchored" data-anchor-id="zagrożenie-korelacja-pozorna"><strong>Zagrożenie: Korelacja Pozorna</strong></h3>
<p><strong>Korelacja pozorna (spurious correlation)</strong> występuje, gdy dwie zmienne wydają się powiązane, ale w rzeczywistości obie są pod wpływem trzeciej zmiennej (<strong>czynnika zakłócającego/confoundera</strong>).</p>
<p><strong>Klasyczny przykład:</strong></p>
<ul>
<li><p><strong>Obserwacja</strong>: Sprzedaż lodów koreluje z liczbą utonięć</p></li>
<li><p><strong>Pozorny wniosek</strong>: Lody powodują utonięcia (❌)</p></li>
<li><p><strong>Rzeczywistość</strong>: Letnia pogoda (czynnik zakłócający) powoduje oba zjawiska:</p></li>
<li><p>Lato → Więcej sprzedanych lodów</p></li>
<li><p>Lato → Więcej pływania → Więcej utonięć</p></li>
</ul>
<p><strong>Reprezentacja matematyczna:</strong></p>
<ul>
<li>Obserwowana korelacja: <span class="math inline">\text{Cor}(X,Y) \neq 0</span></li>
<li>Ale prawdziwy model: <span class="math inline">X = \alpha Z + \epsilon_1</span> oraz <span class="math inline">Y = \beta Z + \epsilon_2</span></li>
<li>Gdzie <span class="math inline">Z</span> to zmienna zakłócająca powodująca oba zjawiska</li>
</ul>
</section>
<section id="czynniki-zakłócające-confounding-ukryty-wpływ" class="level3">
<h3 class="anchored" data-anchor-id="czynniki-zakłócające-confounding-ukryty-wpływ"><strong>Czynniki Zakłócające (Confounding): Ukryty Wpływ</strong></h3>
<p><strong>Zmienna zakłócająca (confounding variable/confounder)</strong>:</p>
<ol type="1">
<li>Wpływa zarówno na domniemaną przyczynę, jak i skutek</li>
<li>Tworzy iluzję bezpośredniej przyczynowości</li>
<li>Musi być kontrolowana dla ważnego wnioskowania przyczynowego</li>
</ol>
<p><strong>Przykład badawczy:</strong></p>
<ul>
<li><p><strong>Obserwacja</strong>: Spożycie kawy koreluje z chorobami serca</p></li>
<li><p><strong>Potencjalny czynnik zakłócający</strong>: Palenie (osoby pijące kawę częściej palą)</p></li>
<li><p><strong>Prawdziwe relacje</strong>:</p></li>
<li><p>Palenie → Choroby serca (przyczynowa)</p></li>
<li><p>Palenie → Spożycie kawy (związek)</p></li>
<li><p>Kawa → Choroby serca (pozorna bez kontroli palenia)</p></li>
</ul>
</section>
<section id="jak-identyfikować-związki-przyczynowe" class="level3">
<h3 class="anchored" data-anchor-id="jak-identyfikować-związki-przyczynowe"><strong>Jak Identyfikować Związki Przyczynowe</strong></h3>
<ol type="1">
<li><strong>Randomizowane badania kontrolowane (RCTs)</strong>: Losowy przydział przerywa wpływ czynników zakłócających</li>
<li><strong>Eksperymenty naturalne (natural experiments)</strong>: Zdarzenia zewnętrzne tworzą „jakby” losową zmienność</li>
<li><strong>Kontrola statystyczna</strong>: Włączenie czynników zakłócających do modeli regresji</li>
<li><strong>Zmienne instrumentalne (instrumental variables)</strong>: Znalezienie zmiennych wpływających na X, ale nie bezpośrednio na Y</li>
</ol>
</section>
<section id="kluczowy-wniosek" class="level3">
<h3 class="anchored" data-anchor-id="kluczowy-wniosek"><strong>Kluczowy Wniosek</strong></h3>
<p>Znalezienie korelacji jest łatwe. Ustalenie przyczynowości jest trudne. Zawsze pytaj: „Co jeszcze mogłoby wyjaśniać ten związek?”</p>
<p><strong>Pamiętaj</strong>: Najbardziej niebezpieczne zdanie w badaniach empirycznych to „nasze dane pokazują, że X powoduje Y”, gdy tak naprawdę zmierzyłeś tylko korelację.</p>
</section>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
📊 Szybki Test: Korelacja czy Przyczynowość?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Dla każdego scenariusza określ, czy związek jest prawdopodobnie przyczynowy czy pozorny:</p>
<ol type="1">
<li><strong>Miasta z większą liczbą kościołów mają więcej przestępstw</strong>
<ul>
<li>Odpowiedź: Pozorny (czynnik zakłócający: wielkość populacji)</li>
</ul></li>
<li><strong>Palenie prowadzi do raka płuc</strong>
<ul>
<li>Odpowiedź: Przyczynowy (ustalony poprzez wiele projektów badawczych)</li>
</ul></li>
<li><strong>Uczniowie z większą liczbą książek w domu mają lepsze oceny</strong>
<ul>
<li>Odpowiedź: Prawdopodobnie pozorny (czynniki zakłócające: wykształcenie rodziców, dochód)</li>
</ul></li>
<li><strong>Kraje z wyższym spożyciem czekolady mają więcej laureatów Nobla</strong>
<ul>
<li>Odpowiedź: Pozorny (czynnik zakłócający: poziom zamożności/rozwoju)</li>
</ul></li>
</ol>
</div>
</div>
</div>
</section>
<section id="wyzwanie-pomiaru-w-naukach-społecznych" class="level4">
<h4 class="anchored" data-anchor-id="wyzwanie-pomiaru-w-naukach-społecznych">Wyzwanie pomiaru w naukach społecznych</h4>
<p>W naukach społecznych często zmagamy się z tym, że kluczowe pojęcia nie przekładają się wprost na liczby:</p>
<ul>
<li>Jak zmierzyć „demokrację”?</li>
<li>Jaka liczba oddaje „ideologię polityczną”?</li>
<li>Jak ilościowo ująć „siłę instytucji”?</li>
<li>Jak zmierzyć „partycypację polityczną”?</li>
</ul>
<hr>
</section>
</section>
<section id="typy-zmiennych" class="level3">
<h3 class="anchored" data-anchor-id="typy-zmiennych">Typy zmiennych</h3>
<p><strong>Zmienne ilościowe (Quantitative Variables)</strong> reprezentują ilości lub wielkości i mogą być:</p>
<p><strong>Zmienne ciągłe (Continuous Variables)</strong>: Mogą przyjmować dowolną wartość w przedziale, ograniczoną tylko precyzją pomiaru.</p>
<ul>
<li>Wiek (22,5 lat, 22,51 lat, 22,514 lat…)</li>
<li>Dochód (45 234,67 zł)</li>
<li>Wzrost (175,3 cm)</li>
<li>Gęstość zaludnienia (432,7 osób na kilometr kwadratowy)</li>
</ul>
<p><strong>Zmienne dyskretne (Discrete Variables)</strong>: Mogą przyjmować tylko określone wartości, zazwyczaj liczenia.</p>
<ul>
<li>Liczba dzieci w rodzinie (0, 1, 2, 3…)</li>
<li>Liczba małżeństw (0, 1, 2…)</li>
<li>Liczba pokoi w mieszkaniu (1, 2, 3…)</li>
<li>Liczba migrantów wjeżdżających do kraju rocznie</li>
</ul>
<p><strong>Zmienne jakościowe (Qualitative Variables)</strong> reprezentują kategorie lub cechy i mogą być:</p>
<p><strong>Zmienne nominalne (Nominal Variables)</strong>: Kategorie bez naturalnego porządku.</p>
<ul>
<li>Kraj urodzenia (Polska, Meksyk, Kanada…)</li>
<li>Religia (Chrześcijaństwo, Islam, Hinduizm, Buddyzm…)</li>
<li>Grupa krwi (A, B, AB, 0)</li>
<li>Przyczyna śmierci (choroby serca, nowotwory, wypadek…)</li>
</ul>
<p><strong>Zmienne porządkowe (Ordinal Variables)</strong>: Kategorie ze znaczącym porządkiem, ale nierównymi interwałami.</p>
<ul>
<li>Poziom wykształcenia (brak wykształcenia, podstawowe, średnie, wyższe)</li>
<li>Zadowolenie z opieki zdrowotnej (bardzo niezadowolony, niezadowolony, neutralny, zadowolony, bardzo zadowolony)</li>
<li>Status społeczno-ekonomiczny (niski, średni, wysoki)</li>
<li>Samoocena stanu zdrowia (zły, przeciętny, dobry, doskonały)</li>
</ul>
</section>
<section id="skale-pomiarowe" class="level3">
<h3 class="anchored" data-anchor-id="skale-pomiarowe">Skale pomiarowe</h3>
<p>Zrozumienie skal pomiarowych jest kluczowe, ponieważ determinują, które metody statystyczne są odpowiednie:</p>
<p><strong>Skala nominalna (Nominal Scale)</strong>: Tylko kategorie — możemy liczyć częstości, ale nie możemy porządkować ani wykonywać operacji arytmetycznych. Przykład: Możemy powiedzieć, że 45% mieszkańców urodziło się lokalnie, ale nie możemy obliczyć „średniego miejsca urodzenia”.</p>
<p><strong>Skala porządkowa (Ordinal Scale)</strong>: Kolejność ma znaczenie, ale różnice między wartościami niekoniecznie są równe. Przykład: Różnica między „złym” a „przeciętnym” zdrowiem może nie równać się różnicy między „dobrym” a „doskonałym” zdrowiem.</p>
<p><strong>Skala interwałowa (Interval Scale)</strong>: Równe interwały między wartościami, ale brak prawdziwego punktu zerowego. Przykład: Temperatura w stopniach Celsjusza — różnica między 20°C a 30°C równa się różnicy między 30°C a 40°C, ale 0°C nie oznacza „braku temperatury”.</p>
<p><strong>Skala ilorazowa (Ratio Scale)</strong>: Równe interwały z prawdziwym punktem zerowym, umożliwiające wszystkie operacje matematyczne. Przykład: Dochód — 40 000 zł to dwa razy więcej niż 20 000 zł, a 0 zł oznacza brak dochodu.</p>
<hr>
</section>
</section>
<section id="parametry-statystyki-i-estymacja" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="parametry-statystyki-i-estymacja"><span class="header-section-number">2.5</span> Parametry, statystyki i estymacja</h2>
<p>Te pojęcia stanowią rdzeń wnioskowania statystycznego — jak uczymy się o populacjach z prób. Zrozumienie relacji między tymi terminami jest niezbędne dla właściwego rozumowania statystycznego.</p>
<section id="parametr" class="level3">
<h3 class="anchored" data-anchor-id="parametr">Parametr</h3>
<p><strong>Parametr</strong> to liczbowa charakterystyka populacji. Parametry są zazwyczaj nieznane, ponieważ nie możemy zmierzyć całej populacji. Są to wartości stałe (nie losowe), ale nieznane nam. Oznaczamy parametry literami greckimi.</p>
<p><strong>Powszechne parametry demograficzne:</strong></p>
<ul>
<li><span class="math inline">\mu</span> (mi): Średni wiek populacji. Na przykład, prawdziwy średni wiek wszystkich Europejczyków.</li>
<li><span class="math inline">\sigma^2</span> (sigma kwadrat): Wariancja populacji w dochodzie we wszystkich gospodarstwach domowych w Brazylii.</li>
<li><span class="math inline">p</span>: Proporcja populacji. Na przykład, prawdziwa proporcja wszystkich dorosłych w Japonii, którzy są małżonkami.</li>
<li><span class="math inline">\beta</span> (beta): Współczynnik regresji. Prawdziwa relacja między wykształceniem a płodnością w populacji.</li>
<li><span class="math inline">\lambda</span> (lambda): Parametr stopy. Prawdziwa stopa migracji z obszarów wiejskich do miejskich.</li>
</ul>
<p><strong>Przykład</strong>: Prawdziwy średni wiek przy pierwszym porodzie dla wszystkich kobiet we Francji, które urodziły dziecko w 2023 roku, jest parametrem. Nazwijmy go <span class="math inline">\mu = 31,2</span> lat. Nie znamy tej wartości bez zmierzenia każdego pojedynczego porodu.</p>
</section>
<section id="statystyka" class="level3">
<h3 class="anchored" data-anchor-id="statystyka">Statystyka</h3>
<p><strong>Statystyka</strong> to liczbowa charakterystyka obliczona z danych z próby. Statystyki są zmiennymi losowymi — ich wartości różnią się od próby do próby. Używamy łacińskich liter dla statystyk.</p>
<p><strong>Powszechne statystyki z próby:</strong></p>
<ul>
<li><span class="math inline">\bar{x}</span> (x z kreską): Średnia wieku z próby z badania 1000 osób</li>
<li><span class="math inline">s^2</span>: Wariancja dochodu z próby z 500 ankietowanych gospodarstw</li>
<li><span class="math inline">\hat{p}</span> (p z daszkiem): Proporcja małżonków z próby z badania</li>
<li><span class="math inline">r</span>: Korelacja z próby między wykształceniem a dochodem</li>
<li><span class="math inline">b</span>: Współczynnik regresji z próby</li>
</ul>
<p><strong>Przykład</strong>: Z próby 500 urodzeń we Francji obliczamy średni wiek przy pierwszym porodzie z próby <span class="math inline">\bar{x} = 30,9</span> lat. To jest nasza statystyka. Inna próba może dać <span class="math inline">\bar{x} = 31,4</span> lat.</p>
</section>
<section id="relacja-między-parametrami-a-statystykami" class="level3">
<h3 class="anchored" data-anchor-id="relacja-między-parametrami-a-statystykami">Relacja między parametrami a statystykami</h3>
<p>Pomyśl o tej relacji jak o próbie zrozumienia głębokości jeziora:</p>
<ul>
<li><strong>Parametr</strong>: Prawdziwa średnia głębokość jeziora (nieznana, stała)</li>
<li><strong>Statystyka</strong>: Średnia głębokość z kilku punktów pomiarowych (znana, zmienia się z różnymi próbami)</li>
<li><strong>Estymacja</strong>: Używanie naszych pomiarów do zgadywania prawdziwej średniej głębokości</li>
</ul>
</section>
<section id="estymator" class="level3">
<h3 class="anchored" data-anchor-id="estymator">Estymator</h3>
<p><strong>Estymator</strong> to reguła lub formuła do obliczania oszacowania parametru populacji z danych z próby. Estymator to funkcja, która odwzorowuje dane z próby na oszacowania parametrów.</p>
<p><strong>Właściwości dobrych estymatorów:</strong></p>
<p><strong>Nieobciążoność (Unbiasedness)</strong>: Średnio estymator równa się prawdziwej wartości parametru. Gdybyśmy powtórzyli próbkowanie wiele razy, średnia wszystkich naszych oszacowań równałaby się prawdziwemu parametrowi.</p>
<p><strong>Przykład</strong>: Średnia z próby <span class="math inline">\bar{x}</span> jest nieobciążonym estymatorem średniej populacji <span class="math inline">\mu</span>. Gdybyśmy wzięli 1000 różnych prób i obliczyli 1000 średnich z prób, ich średnia byłaby bardzo bliska <span class="math inline">\mu</span>.</p>
<p><strong>Zgodność (Consistency)</strong>: Gdy wielkość próby wzrasta, estymator zbiega się do prawdziwej wartości parametru.</p>
<p>Przykład: Z <span class="math inline">n=10</span>, nasze oszacowanie średniego dochodu może być oddalone o 5000 zł. Z <span class="math inline">n=1000</span>, możemy być oddaleni tylko o 500 zł. Z <span class="math inline">n=100 000</span>, możemy być oddaleni tylko o 50 zł.</p>
<p><strong>Efektywność (Efficiency)</strong>: Wśród nieobciążonych estymatorów, ten z najmniejszą wariancją. Średnia z próby jest bardziej efektywna niż mediana z próby do estymowania średniej populacji rozkładu normalnego.</p>
<p><strong>Powszechne estymatory:</strong></p>
<ul>
<li>Średnia z próby jako estymator średniej populacji: <span class="math inline">\bar{x} = \frac{\sum x_i}{n}</span></li>
<li>Proporcja z próby jako estymator proporcji populacji: <span class="math inline">\hat{p} = \frac{x}{n}</span> (gdzie <span class="math inline">x</span> to liczba sukcesów)</li>
<li>Wariancja z próby jako estymator wariancji populacji: <span class="math inline">s^2 = \frac{\sum(x_i - \bar{x})^2}{n-1}</span></li>
</ul>
<p>Uwaga: Dzielimy przez <span class="math inline">(n-1)</span>, a nie <span class="math inline">n</span> dla wariancji z próby, aby uczynić ją nieobciążoną — to się nazywa korekta Bessela.</p>
</section>
<section id="estimand" class="level3">
<h3 class="anchored" data-anchor-id="estimand">Estimand</h3>
<p><strong>Estimand</strong> to konkretny parametr populacji, który chcemy oszacować. To cel naszej procedury estymacji. Jasna specyfikacja estimandu jest kluczowa dla właściwego wnioskowania statystycznego i unikania błędnej interpretacji.</p>
<p><strong>Przykłady jasno zdefiniowanych estimandów:</strong></p>
<ul>
<li>„Mediana dochodu gospodarstwa domowego dla wszystkich gospodarstw w Kalifornii na dzień 1 stycznia 2024”</li>
<li>„Różnica w oczekiwanej długości życia między mężczyznami a kobietami urodzonymi w Szwecji w 2023 roku”</li>
<li>„Proporcja wszystkich dorosłych w wieku 25-34 lat w obszarach miejskich, którzy ukończyli edukację wyższą”</li>
</ul>
<p><strong>Dlaczego precyzyjna definicja estimandu ma znaczenie:</strong></p>
<p>Rozważ badanie „stopy bezrobocia”. Estimand musi określić:</p>
<ul>
<li>Kto liczy się jako bezrobotny? (Aktywnie poszukujący pracy? Zniechęceni pracownicy?)</li>
<li>Jaki zakres wieku? (15+? 16-64?)</li>
<li>Jaki obszar geograficzny?</li>
<li>Jaki okres czasu?</li>
</ul>
<p>Różne definicje prowadzą do różnych liczb. Amerykańskie Biuro Statystyki Pracy publikuje sześć różnych stóp bezrobocia (U-1 do U-6) na podstawie różnych definicji.</p>
</section>
<section id="oszacowanie-estimate" class="level3">
<h3 class="anchored" data-anchor-id="oszacowanie-estimate">Oszacowanie (Estimate)</h3>
<p><strong>Oszacowanie</strong> to konkretna wartość numeryczna obliczona przez zastosowanie estymatora do obserwowanych danych. To nasze najlepsze przypuszczenie o prawdziwej wartości parametru na podstawie dostępnych informacji.</p>
<p><strong>Przykład kompletnego procesu:</strong></p>
<ol type="1">
<li><strong>Estimand</strong> (cel): Proporcja wszystkich dorosłych Amerykanów, którzy popierają działalność prezydenta</li>
<li><strong>Parametr</strong> (prawdziwa nieznana wartość): <span class="math inline">p = 0,42</span> (42%, ale tego nie wiemy)</li>
<li><strong>Estymator</strong> (metoda): Proporcja z próby <span class="math inline">\hat{p} = \frac{x}{n}</span> gdzie <span class="math inline">x</span> to liczba popierających, a <span class="math inline">n</span> to wielkość próby</li>
<li><strong>Próba</strong>: Ankietujemy 1500 losowo wybranych dorosłych, 650 popiera</li>
<li><strong>Oszacowanie</strong> (obliczona wartość): <span class="math inline">\hat{p} = \frac{650}{1500} = 0,433</span> (43,3%)</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estimandy: Co dokładnie próbujemy oszacować?
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Estimand</strong> to konkretna wielkość, którą chcemy oszacować — na co celujemy naszą analizą statystyczną. Choć często jest to parametr populacji, estimandy mogą być bardziej złożone.</p>
<p><strong>Przykłady różnych estimandów</strong>:</p>
<p><strong>Prosty estimand parametru</strong>: Średni dochód populacji (<span class="math inline">\mu</span>) <strong>Porównawczy estimand</strong>: Różnica w średnim dochodzie między dwiema grupami (<span class="math inline">\mu_1 - \mu_2</span>) <strong>Przyczynowy estimand</strong>: Średni efekt leczenia programu szkoleniowego na zarobki <strong>Warunkowy estimand</strong>: Oczekiwana frekwencja wyborcza przy konkretnych warunkach pogodowych</p>
<section id="kompletna-struktura" class="level3">
<h3 class="anchored" data-anchor-id="kompletna-struktura">Kompletna struktura</h3>
<p>Zrozumienie wnioskowania statystycznego wymaga rozróżnienia między tymi powiązanymi, ale odrębnymi pojęciami:</p>
<ul>
<li><strong>Parametr populacji</strong>: Prawdziwa charakterystyka populacji (np. <span class="math inline">\mu</span>)</li>
<li><strong>Estimand</strong>: Konkretna wielkość, którą chcemy oszacować (często, ale nie zawsze, parametr)</li>
<li><strong>Estymator</strong>: Metoda obliczania naszego oszacowania (np. średnia z próby)</li>
<li><strong>Oszacowanie</strong>: Rzeczywista liczba, którą obliczamy z naszych danych</li>
</ul>
<p><strong>Przykład w kontekście</strong>:</p>
<ul>
<li><strong>Parametr</strong>: Prawdziwa średnia frekwencja wyborcza we wszystkich wyborach (<span class="math inline">\mu</span>)</li>
<li><strong>Estimand</strong>: Oczekiwana różnica frekwencji między deszczowymi a słonecznymi dniami wyborów (<span class="math inline">\mu_{\text{deszczowy}} - \mu_{\text{słoneczny}}</span>)</li>
<li><strong>Estymator</strong>: Różnica między średnimi z prób z deszczowych i słonecznych wyborów</li>
<li><strong>Oszacowanie</strong>: 3,2 punkty procentowe niższa frekwencja w deszczowe dni</li>
</ul>
<p>Ta struktura pomaga wyjaśnić dokładnie, na jakie pytanie odpowiadamy i zapewnia, że nasze metody są zgodne z naszymi celami badawczymi.</p>
</section>
</div>
</div>
<hr>
</section>
</section>
<section id="błąd-statystyczny-i-niepewność" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="błąd-statystyczny-i-niepewność"><span class="header-section-number">2.6</span> Błąd Statystyczny i Niepewność</h2>
<section id="sec-intro" class="level3">
<h3 class="anchored" data-anchor-id="sec-intro">Wprowadzenie: Dlaczego Niepewność Ma Znaczenie</h3>
<p>Żaden pomiar ani oszacowanie nie jest doskonałe. Zrozumienie różnych typów błędów jest kluczowe dla interpretacji wyników i poprawy projektu badania. Ta sekcja bada matematyczne podstawy i praktyczne implikacje niepewności statystycznej.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Główne Wyzwanie
</div>
</div>
<div class="callout-body-container callout-body">
<p>Za każdym razem, gdy używamy <strong>próby</strong> do poznania <strong>populacji</strong>, wprowadzamy niepewność. Kluczem jest:</p>
<ol type="1">
<li>Uczciwe kwantyfikowanie tej niepewności</li>
<li>Rozróżnianie między różnymi źródłami błędu</li>
<li>Transparentne komunikowanie wyników</li>
</ol>
</div>
</div>
<hr>
</section>
<section id="sec-error-types" class="level3">
<h3 class="anchored" data-anchor-id="sec-error-types">Typy Błędów</h3>
<section id="błąd-losowy-błąd-próbkowania" class="level4">
<h4 class="anchored" data-anchor-id="błąd-losowy-błąd-próbkowania">Błąd Losowy (Błąd Próbkowania)</h4>
<p><strong>Błąd losowy</strong> wynika z naturalnej zmienności w próbkowaniu — nieuniknionej wariacji, która występuje, ponieważ obserwujemy próbę, a nie całą populację.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Kluczowe Cechy
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Nieprzewidywalny Kierunek</strong>: Czasem za wysoko, czasem za nisko</li>
<li><strong>Maleje z Wielkością Próby</strong>: <span class="math inline">\propto 1/\sqrt{n}</span></li>
<li><strong>Kwantyfikowalny</strong>: Możliwy do obliczenia przy użyciu teorii prawdopodobieństwa</li>
<li><strong>Uśrednia się do Zera</strong>: W wielu próbach błędy się znoszą</li>
</ul>
</div>
</div>
<section id="przykład-badanie-dostępu-do-internetu" class="level5">
<h5 class="anchored" data-anchor-id="przykład-badanie-dostępu-do-internetu">Przykład: Badanie Dostępu do Internetu</h5>
<p>Wyobraź sobie badanie 100 losowych gospodarstw domowych o dostępie do internetu:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Zmienność wokół prawdziwej wartości (czerwona linia) reprezentuje błąd losowy. Przy większych próbach oszacowania byłyby bardziej skupione.</p>
</section>
</section>
<section id="błąd-systematyczny-obciążenie" class="level4">
<h4 class="anchored" data-anchor-id="błąd-systematyczny-obciążenie">Błąd Systematyczny (Obciążenie)</h4>
<p><strong>Błąd systematyczny</strong> reprezentuje stałe odchylenie w określonym kierunku. W przeciwieństwie do błędu losowego, nie uśrednia się przy powtarzanym próbkowaniu.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Obciążenie Selekcji</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Obciążenie Pomiaru</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Obciążenie Odpowiedzi</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Obciążenie Braku Odpowiedzi</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Obciążenie Przetrwania</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Metoda próbkowania systematycznie wyklucza pewne grupy.</p>
<p><strong>Przykład</strong>: Ankiety telefoniczne w godzinach pracy niedostatecznie reprezentują osoby pracujące.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Instrument pomiarowy konsekwentnie zawyża/zaniża pomiary.</p>
<p><strong>Przykład</strong>: Waga, która zawsze pokazuje 1 kg za dużo.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Respondenci systematycznie błędnie raportują.</p>
<p><strong>Przykład</strong>: Ludzie zaniżają spożycie alkoholu, zawyżają uczestnictwo w głosowaniu.</p>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Osoby nieudzielające odpowiedzi różnią się systematycznie od respondentów.</p>
<p><strong>Przykład</strong>: Bardzo chorzy i bardzo zdrowi ludzie rzadziej odpowiadają na ankiety zdrowotne.</p>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Obserwowanie tylko “ocalałych” z jakiegoś procesu.</p>
<p><strong>Przykład</strong>: Badanie długowieczności poprzez wywiady z 90-latkami pomija tych, którzy zmarli młodsi.</p>
</div>
</div>
</div>
</section>
<section id="dekompozycja-obciążenia-wariancji" class="level4">
<h4 class="anchored" data-anchor-id="dekompozycja-obciążenia-wariancji">Dekompozycja Obciążenia-Wariancji</h4>
<p>Matematycznie, całkowity błąd (Błąd Średniokwadratowy) rozkłada się na:</p>
<p><span class="math display">\mathrm{MSE}(\hat\theta) = \underbrace{\mathrm{Var}(\hat\theta)}_{\text{błąd losowy}} + \underbrace{\big(\mathrm{Bias}(\hat\theta)\big)^2}_{\text{błąd systematyczny}}</span></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Kluczowa Uwaga
</div>
</div>
<div class="callout-body-container callout-body">
<p>Duża <strong>obciążona</strong> próba daje <strong>precyzyjnie błędną</strong> odpowiedź.</p>
<ul>
<li>Zwiększ <span class="math inline">n</span> → redukuje błąd losowy</li>
<li>Popraw projekt → redukuje błąd systematyczny</li>
</ul>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/bias-variance-targets.svg" class="img-fluid figure-img"></p>
<figcaption>Różne kombinacje obciążenia i wariancji w estymacji</figcaption>
</figure>
</div>
<hr>
</section>
</section>
<section id="sec-measures" class="level3">
<h3 class="anchored" data-anchor-id="sec-measures">Kwantyfikowanie Niepewności</h3>
<section id="błąd-standardowy" class="level4">
<h4 class="anchored" data-anchor-id="błąd-standardowy">Błąd Standardowy</h4>
<p><strong>Błąd standardowy</strong> (SE) kwantyfikuje, jak bardzo oszacowanie różni się w różnych możliwych próbach.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Dla Proporcji:</strong> <span class="math display">SE(\hat{p}) = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}</span></p>
<p><strong>Dla Średniej:</strong> <span class="math display">SE(\bar{x}) = \frac{s}{\sqrt{n}}</span></p>
</div><div class="column" style="width:50%;">
<p><strong>Dla Różnicy:</strong> <span class="math display">SE(\bar{x}_1 - \bar{x}_2) = \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}</span></p>
</div>
</div>
</section>
<section id="margines-błędu" class="level4">
<h4 class="anchored" data-anchor-id="margines-błędu">Margines Błędu</h4>
<p><strong>Margines błędu</strong> (MOE) reprezentuje oczekiwaną maksymalną różnicę między oszacowaniem z próby a prawdziwym parametrem.</p>
<p><span class="math display">\text{MOE} = \text{Wartość Krytyczna} \times \text{Błąd Standardowy}</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zrozumienie Wartości Krytycznej
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Dla 95% ufności używamy 1,96 (często upraszczane do 2). To zapewnia, że ~95% przedziałów skonstruowanych w ten sposób będzie zawierać prawdziwy parametr.</p>
<ul>
<li>90% ufności: z = 1,645</li>
<li>95% ufności: z = 1,96</li>
<li>99% ufności: z = 2,576</li>
</ul>
</div>
</div>
</div>
</section>
<section id="przedziały-ufności" class="level4">
<h4 class="anchored" data-anchor-id="przedziały-ufności">Przedziały Ufności</h4>
<p><strong>Przedział ufności</strong> dostarcza zakres prawdopodobnych wartości:</p>
<p><span class="math display">\text{CI} = \text{Oszacowanie} \pm (\text{Wartość Krytyczna} \times \text{Błąd Standardowy})</span></p>
<hr>
</section>
</section>
<section id="sec-polling" class="level3">
<h3 class="anchored" data-anchor-id="sec-polling">Praktyczne Zastosowanie: Sondaże Opinii</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Studium Przypadku: Sondaże Polityczne
</div>
</div>
<div class="callout-body-container callout-body">
<p>Gdy sondaż podaje “Kandydat A: 52%, Kandydat B: 48%”, jest to <strong>niepełne</strong> bez kwantyfikacji niepewności.</p>
</div>
</div>
<section id="złota-zasada-sondaży" class="level4">
<h4 class="anchored" data-anchor-id="złota-zasada-sondaży">Złota Zasada Sondaży</h4>
<p>Przy ~1000 losowo wybranych respondentach:</p>
<ul>
<li><strong>Margines błędu</strong>: ±3 punkty procentowe (95% ufności)</li>
<li><strong>Interpretacja</strong>: Zgłoszone 52% oznacza prawdziwe poparcie prawdopodobnie między 49% a 55%</li>
</ul>
</section>
<section id="wielkość-próby-i-precyzja" class="level4">
<h4 class="anchored" data-anchor-id="wielkość-próby-i-precyzja">Wielkość Próby i Precyzja</h4>
<table class="table-striped table-hover caption-top table">
<thead>
<tr class="header">
<th>Wielkość Próby</th>
<th>Margines Błędu (95%)</th>
<th>Zastosowanie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n = 100</td>
<td>± 10%</td>
<td>Tylko ogólny kierunek</td>
</tr>
<tr class="even">
<td>n = 400</td>
<td>± 5%</td>
<td>Ogólne trendy</td>
</tr>
<tr class="odd">
<td>n = 1000</td>
<td>± 3%</td>
<td><strong>Standardowe sondaże</strong></td>
</tr>
<tr class="even">
<td>n = 2500</td>
<td>± 2%</td>
<td>Wysoka precyzja</td>
</tr>
<tr class="odd">
<td>n = 10000</td>
<td>± 1%</td>
<td>Bardzo wysoka precyzja</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prawo Malejących Przychodów
</div>
</div>
<div class="callout-body-container callout-body">
<p>Aby zmniejszyć margines błędu o połowę, potrzebujesz <strong>cztery razy</strong> większej próby, ponieważ <span class="math inline">\text{MOE} \propto 1/\sqrt{n}</span></p>
</div>
</div>
</section>
<section id="co-powinny-raportować-sondaże" class="level4">
<h4 class="anchored" data-anchor-id="co-powinny-raportować-sondaże">Co Powinny Raportować Sondaże</h4>
<p>Wysokiej jakości sondaże muszą ujawniać:</p>
<ul class="task-list">
<li><label><input type="checkbox">Daty przeprowadzenia badania</label></li>
<li><label><input type="checkbox">Definicję i wielkość próby</label></li>
<li><label><input type="checkbox">Sposób traktowania niezdecydowanych wyborców</label></li>
<li><label><input type="checkbox">Margines błędu próbkowania</label></li>
<li><label><input type="checkbox">Niepewność w marginesach głosowania</label></li>
</ul>
<hr>
</section>
</section>
<section id="sec-viz" class="level3">
<h3 class="anchored" data-anchor-id="sec-viz">Wizualizacja: Zmienność Próbkowania</h3>
<p>Poniższa symulacja pokazuje, jak zachowują się przedziały ufności przy powtarzanym próbkowaniu:</p>
<div class="cell">
<details class="code-fold">
<summary>Pokaż kod symulacji</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametry</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>n_polls      <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>n_people     <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>true_support <span class="ot">&lt;-</span> <span class="fl">0.50</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Symulacja niezależnych sondaży</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>support <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_polls, n_people, true_support) <span class="sc">/</span> n_people</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie błędów standardowych i marginesów błędu</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>se   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(support <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> support) <span class="sc">/</span> n_people)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>moe  <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> se  <span class="co"># Uproszczony mnożnik dla jasności</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przedziałów ufności</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, support <span class="sc">-</span> moe)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="dv">1</span>, support <span class="sc">+</span> moe)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Sprawdzanie pokrycia</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>covers <span class="ot">&lt;-</span> (lower <span class="sc">&lt;=</span> true_support) <span class="sc">&amp;</span> (upper <span class="sc">&gt;=</span> true_support)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>n_cover <span class="ot">&lt;-</span> <span class="fu">sum</span>(covers)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">poll =</span> <span class="fu">seq_len</span>(n_polls),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  support, se, moe, lower, upper, covers</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wizualizacji</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> poll, <span class="at">y =</span> support, <span class="at">color =</span> covers)) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_support, </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"forestgreen"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"darkorange"</span>),</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"Pokrywa prawdę"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"Mija się z prawdą"</span>),</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">name   =</span> <span class="cn">NULL</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title    =</span> <span class="st">"Zmienność Próbkowania w 20 Niezależnych Sondażach"</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Każdy sondaż: n = "</span>, n_people, <span class="st">" | Prawdziwa wartość = "</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>      scales<span class="sc">::</span><span class="fu">percent</span>(true_support),</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">" | Pokrycie: "</span>, n_cover, <span class="st">"/"</span>, n_polls,</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">" ("</span>, <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> n_cover <span class="sc">/</span> n_polls), <span class="st">"%)"</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Numer Sondażu"</span>,</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Oszacowane Poparcie"</span>,</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Słupki błędu pokazują przybliżone 95% przedziały ufności"</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Kluczowa Obserwacja
</div>
</div>
<div class="callout-body-container callout-body">
<p>Większość przedziałów obejmuje prawdziwą wartość, ale niektóre “mijają się” wyłącznie z powodu losowości próbkowania. Jest to oczekiwane i kwantyfikowalne.</p>
</div>
</div>
<hr>
</section>
<section id="sec-misconceptions" class="level3">
<h3 class="anchored" data-anchor-id="sec-misconceptions">Częste Błędne Przekonania</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Czego NIE Mówi Nam Margines Błędu
</div>
</div>
<div class="callout-body-container callout-body">
<p>❌ <strong>Mit</strong>: “Prawdziwa wartość na pewno mieści się w marginesie błędu” ✅ <strong>Rzeczywistość</strong>: Nadal istnieje 5% szans, że jest poza (przy 95% ufności)</p>
<p>❌ <strong>Mit</strong>: “Margines błędu obejmuje wszystkie typy błędów” ✅ <strong>Rzeczywistość</strong>: Obejmuje tylko losowy błąd próbkowania, nie systematyczne obciążenie</p>
<p>❌ <strong>Mit</strong>: “Większe próby eliminują wszystkie błędy” ✅ <strong>Rzeczywistość</strong>: Redukują tylko błąd losowy; obciążenie pozostaje niezmienione</p>
</div>
</div>
<hr>
</section>
<section id="sec-summary" class="level3">
<h3 class="anchored" data-anchor-id="sec-summary">Kluczowe Wnioski</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Najważniejsze Punkty
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Dwa typy błędów</strong>: Losowy (redukowany większymi próbami) i Systematyczny (wymaga lepszego projektu)</li>
<li><strong>Błąd standardowy</strong> mierzy typową zmienność próbkowania</li>
<li><strong>Margines błędu</strong> ≈ 2 × SE dla 95% ufności</li>
<li><strong>Wielkość próby</strong> i precyzja są w relacji pierwiastkowej</li>
<li><strong>Przedziały ufności</strong> dostarczają zakresów, nie gwarancji</li>
<li><strong>Zawsze rozważ</strong> zarówno błąd próbkowania JAK I potencjalne obciążenia</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zapamiętaj
</div>
</div>
<div class="callout-body-container callout-body">
<p>Precyzyjna błędna odpowiedź (duża obciążona próba) jest gorsza niż nieprecyzyjna prawidłowa odpowiedź (mała nieobciążona próba).</p>
</div>
</div>
<hr>
</section>
</section>
<section id="próbkowanie-i-metody-próbkowania" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="próbkowanie-i-metody-próbkowania"><span class="header-section-number">2.7</span> Próbkowanie i metody próbkowania</h2>
<p><strong>Próbkowanie</strong> to proces wyboru podzbioru jednostek z populacji w celu oszacowania charakterystyk całej populacji. Sposób, w jaki próbkujemy, głęboko wpływa na to, co możemy wywnioskować z naszych danych.</p>
<section id="operat-losowania-sampling-frame" class="level3">
<h3 class="anchored" data-anchor-id="operat-losowania-sampling-frame">Operat losowania (Sampling Frame)</h3>
<p>Zanim omówimy metody, musimy zrozumieć <strong>operant losowania</strong> — listę lub urządzenie, z którego pobieramy naszą próbę. Operant powinien idealnie obejmować każdego członka populacji dokładnie raz.</p>
<p><strong>Powszechne operanty losowania:</strong></p>
<ul>
<li>Listy wyborcze (dla dorosłych obywateli)</li>
<li>Książki telefoniczne (coraz bardziej problematyczne z powodu telefonów komórkowych i numerów nienotowanych)</li>
<li>Listy adresowe z poczty</li>
<li>Rejestracje urodzeń (dla noworodków)</li>
<li>Listy zapisów do szkół (dla dzieci)</li>
<li>Rejestry podatkowe (dla osób zarabiających)</li>
<li>Zdjęcia satelitarne (dla mieszkań w odległych obszarach)</li>
</ul>
<p><strong>Problemy z operatami losowania:</strong></p>
<ul>
<li><strong>Niepełne pokrycie (Undercoverage)</strong>: Operat pomija członków populacji (bezdomni nieobecni na listach adresowych)</li>
<li><strong>Nadmierne pokrycie (Overcoverage)</strong>: Operat obejmuje osoby spoza populacji (zmarli nadal na listach wyborców)</li>
<li><strong>Duplikacja</strong>: Ta sama jednostka pojawia się wielokrotnie (osoby z wieloma numerami telefonów)</li>
<li><strong>Grupowanie (Clustering)</strong>: Wielu członków populacji na jednostkę operatu (wiele rodzin pod jednym adresem)</li>
</ul>
</section>
<section id="metody-próbkowania-probabilistycznego" class="level3">
<h3 class="anchored" data-anchor-id="metody-próbkowania-probabilistycznego">Metody próbkowania probabilistycznego</h3>
<p><strong>Próbkowanie probabilistyczne</strong> daje każdemu członkowi populacji znane, niezerowe prawdopodobieństwo selekcji. To pozwala nam dokonywać wnioskowań statystycznych o populacji.</p>
<section id="proste-losowanie-simple-random-sampling---srs" class="level4">
<h4 class="anchored" data-anchor-id="proste-losowanie-simple-random-sampling---srs">Proste losowanie (Simple Random Sampling - SRS)</h4>
<p>Każda możliwa próba o wielkości <span class="math inline">n</span> ma równe prawdopodobieństwo selekcji. To złoty standard teorii statystycznej, ale często niepraktyczny dla dużych populacji.</p>
<p><strong>Jak to działa:</strong></p>
<ol type="1">
<li>Ponumeruj każdą jednostkę w populacji od 1 do <span class="math inline">N</span></li>
<li>Użyj liczb losowych do wybrania <span class="math inline">n</span> jednostek</li>
<li>Każda jednostka ma prawdopodobieństwo <span class="math inline">n/N</span> selekcji</li>
</ol>
<p><strong>Przykład</strong>: Aby wybrać próbę 50 uczniów ze szkoły liczącej 1000:</p>
<ul>
<li>Przypisz każdemu uczniowi numer od 1 do 1000</li>
<li>Wygeneruj 50 losowych liczb między 1 a 1000</li>
<li>Wybierz uczniów z tymi numerami</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Statystycznie optymalny</li>
<li>Łatwy do analizy</li>
<li>Nie wymaga dodatkowych informacji o populacji</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Wymaga kompletnego operatu losowania</li>
<li>Może być kosztowny (wybrane jednostki mogą być daleko od siebie)</li>
<li>Może nie reprezentować dobrze ważnych podgrup przez przypadek</li>
</ul>
</section>
<section id="losowanie-systematyczne-systematic-sampling" class="level4">
<h4 class="anchored" data-anchor-id="losowanie-systematyczne-systematic-sampling">Losowanie systematyczne (Systematic Sampling)</h4>
<p>Wybierz co <span class="math inline">k</span>-ty element z uporządkowanego operatu losowania, gdzie <span class="math inline">k = N/n</span> (interwał próbkowania).</p>
<p><strong>Jak to działa:</strong></p>
<ol type="1">
<li>Oblicz interwał próbkowania <span class="math inline">k = N/n</span></li>
<li>Losowo wybierz punkt początkowy między 1 a <span class="math inline">k</span></li>
<li>Wybierz co <span class="math inline">k</span>-tą jednostkę następnie</li>
</ol>
<p><strong>Przykład</strong>: Aby wybrać próbę 100 domów z 5000 na liście ulic:</p>
<ul>
<li><span class="math inline">k = 5000/100 = 50</span></li>
<li>Losowy start: 23</li>
<li>Próba gospodarstw domowych: 23, 73, 123, 173, 223…</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Proste do wdrożenia w terenie</li>
<li>Rozprzestrzenia próbę w całej populacji</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Może wprowadzić obciążenie, jeśli jest okresowość w operacie</li>
</ul>
<p><strong>Przykład ukrytej okresowości</strong>: Próbkowanie co 10. mieszkania w budynkach, gdzie mieszkania narożne (numery kończące się na 0) są wszystkie większe. To zawyżyłoby nasze oszacowanie średniej wielkości mieszkania.</p>
</section>
<section id="losowanie-warstwowe-stratified-sampling" class="level4">
<h4 class="anchored" data-anchor-id="losowanie-warstwowe-stratified-sampling">Losowanie warstwowe (Stratified Sampling)</h4>
<p>Podziel populację na jednorodne podgrupy (warstwy) przed próbkowaniem. Próbkuj niezależnie w każdej warstwie.</p>
<p><strong>Jak to działa:</strong></p>
<ol type="1">
<li>Podziel populację na nienachodzące warstwy</li>
<li>Próbkuj niezależnie z każdej warstwy</li>
<li>Połącz wyniki z odpowiednimi wagami</li>
</ol>
<p><strong>Przykład</strong>: Badanie dochodu w mieście z odrębnymi dzielnicami:</p>
<ul>
<li>Warstwa 1: Dzielnica wysokich dochodów (10% populacji) - próba 100</li>
<li>Warstwa 2: Dzielnica średnich dochodów (60% populacji) - próba 600</li>
<li>Warstwa 3: Dzielnica niskich dochodów (30% populacji) - próba 300</li>
</ul>
<p><strong>Typy alokacji:</strong></p>
<p><strong>Proporcjonalna</strong>: Wielkość próby w każdej warstwie proporcjonalna do wielkości warstwy</p>
<ul>
<li>Jeśli warstwa ma 20% populacji, dostaje 20% próby</li>
</ul>
<p><strong>Optymalna (Neymana)</strong>: Większe próby z bardziej zmiennych warstw</p>
<ul>
<li>Jeśli dochód bardziej się różni w obszarach wysokich dochodów, próbkuj tam więcej</li>
</ul>
<p><strong>Równa</strong>: Ta sama wielkość próby na warstwę niezależnie od wielkości populacji</p>
<ul>
<li>Przydatna, gdy porównywanie warstw jest głównym celem</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Zapewnia reprezentację wszystkich podgrup</li>
<li>Może znacznie zwiększyć precyzję</li>
<li>Pozwala na różne metody próbkowania w warstwie</li>
<li>Dostarcza oszacowania dla każdej warstwy</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Wymaga informacji do utworzenia warstw</li>
<li>Może być trudna do badania</li>
</ul>
</section>
<section id="losowanie-grupowe-cluster-sampling" class="level4">
<h4 class="anchored" data-anchor-id="losowanie-grupowe-cluster-sampling">Losowanie grupowe (Cluster Sampling)</h4>
<p>Wybierz grupy (klastry) zamiast jednostek. Często używane, gdy populacja jest naturalnie pogrupowana lub gdy utworzenie kompletnego operanta jest trudne.</p>
<p><strong>Jednostopniowe losowanie grupowe:</strong></p>
<ol type="1">
<li>Podziel populację na klastry</li>
<li>Losowo wybierz niektóre klastry</li>
<li>Uwzględnij wszystkie jednostki z wybranych klastrów</li>
</ol>
<p><strong>Dwustopniowe losowanie grupowe:</strong></p>
<ol type="1">
<li>Losowo wybierz klastry (Pierwotne Jednostki Losowania)</li>
<li>W wybranych klastrach losowo wybierz jednostki (Wtórne Jednostki Losowania)</li>
</ol>
<p><strong>Przykład</strong>: Badanie gospodarstw wiejskich w dużym kraju:</p>
<ul>
<li>Etap 1: Losowo wybierz 50 wsi z 1000 wsi</li>
<li>Etap 2: W każdej wybranej wsi losowo wybierz 20 gospodarstw</li>
<li>Całkowita próba: 50 × 20 = 1000 gospodarstw</li>
</ul>
<p><strong>Przykład wielostopniowy</strong>: Krajowe badanie zdrowotne:</p>
<ul>
<li>Etap 1: Wybierz województwa</li>
<li>Etap 2: Wybierz powiaty w wybranych województwach</li>
<li>Etap 3: Wybierz obwody spisowe w wybranych powiatach</li>
<li>Etap 4: Wybierz gospodarstwa w wybranych obwodach</li>
<li>Etap 5: Wybierz jednego dorosłego w wybranych gospodarstwach</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Nie wymaga kompletnej listy populacji</li>
<li>Redukuje koszty podróży (jednostki zgrupowane geograficznie)</li>
<li>Może używać różnych metod na różnych etapach</li>
<li>Naturalne dla populacji hierarchicznych</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Mniej statystycznie efektywne niż SRS</li>
<li>Złożona estymacja wariancji</li>
<li>Większe próby potrzebne dla tej samej precyzji</li>
</ul>
<p><strong>Efekt projektu (Design Effect)</strong>: Losowanie grupowe zazwyczaj wymaga większych prób niż SRS. Efekt projektu (DEFF) kwantyfikuje to:</p>
<p><span class="math display">\text{DEFF} = \frac{\text{Wariancja(próba grupowa)}}{\text{Wariancja(SRS)}}</span></p>
<p>Jeśli DEFF = 2, potrzebujesz dwukrotnie większej próby, aby osiągnąć taką samą precyzję jak SRS.</p>
</section>
</section>
<section id="metody-próbkowania-nieprobabilistycznego" class="level3">
<h3 class="anchored" data-anchor-id="metody-próbkowania-nieprobabilistycznego">Metody próbkowania nieprobabilistycznego</h3>
<p><strong>Próbkowanie nieprobabilistyczne</strong> nie gwarantuje znanych prawdopodobieństw selekcji. Choć ogranicza wnioskowanie statystyczne, te metody mogą być konieczne lub przydatne w pewnych sytuacjach.</p>
<section id="próbkowanie-wygodne-convenience-sampling" class="level4">
<h4 class="anchored" data-anchor-id="próbkowanie-wygodne-convenience-sampling">Próbkowanie wygodne (Convenience Sampling)</h4>
<p>Selekcja oparta wyłącznie na łatwości dostępu. Brak próby reprezentacji.</p>
<p><strong>Przykłady:</strong></p>
<ul>
<li>Ankietowanie studentów w twojej klasie o nawykach nauki</li>
<li>Wywiadowanie ludzi w centrum handlowym o preferencjach konsumenckich</li>
<li>Ankiety online, w których każdy może uczestniczyć</li>
<li>Badania medyczne używające wolontariuszy, którzy odpowiadają na ogłoszenia</li>
</ul>
<p><strong>Kiedy może być akceptowalne:</strong></p>
<ul>
<li>Badania pilotażowe do testowania instrumentów ankietowych</li>
<li>Badania eksploracyjne do identyfikacji problemów</li>
<li>Gdy badane procesy uważa się za uniwersalne</li>
</ul>
<p><strong>Główne problemy:</strong></p>
<ul>
<li>Brak podstaw do wnioskowania o populacji</li>
<li>Prawdopodobne poważne obciążenie selekcyjne</li>
<li>Wyniki mogą być całkowicie mylące</li>
</ul>
<p><strong>Prawdziwy przykład</strong>: Sondaż prezydencki Literary Digest z 1936 roku ankietował 2,4 miliona osób (ogromna próba!), ale używał książek telefonicznych i członkostwa w klubach jako operantów podczas Wielkiego Kryzysu, dramatycznie nadreprezentując bogatych wyborców i niepoprawnie przewidując, że Landon pokona Roosevelta.</p>
</section>
<section id="próbkowanie-celowe-purposivejudgmental-sampling" class="level4">
<h4 class="anchored" data-anchor-id="próbkowanie-celowe-purposivejudgmental-sampling">Próbkowanie celowe (Purposive/Judgmental Sampling)</h4>
<p>Celowy wybór konkretnych przypadków oparty na osądzie badacza o tym, co jest „typowe” lub „interesujące”.</p>
<p><strong>Przykłady:</strong></p>
<ul>
<li>Wybór „typowych” wsi do reprezentowania obszarów wiejskich</li>
<li>Wybór konkretnych grup wiekowych do badania rozwojowego</li>
<li>Wybór skrajnych przypadków do zrozumienia zakresu zmienności</li>
<li>Wybór przypadków bogatych w informacje do dogłębnego badania</li>
</ul>
<p><strong>Typy próbkowania celowego:</strong></p>
<p><strong>Typowy przypadek</strong>: Wybierz przeciętne lub normalne przykłady</p>
<ul>
<li>Badanie „typowych” polskich przedmieść</li>
</ul>
<p><strong>Skrajny/dewiacyjny przypadek</strong>: Wybierz niezwykłe przykłady</p>
<ul>
<li>Badanie wsi z niezwykle niską śmiertelnością niemowląt, aby zrozumieć czynniki sukcesu</li>
</ul>
<p><strong>Maksymalna zmienność</strong>: Celowo wybierz różnorodne przypadki</p>
<ul>
<li>Wybór różnych szkół (miejskich/wiejskich, bogatych/biednych, dużych/małych) do badań edukacyjnych</li>
</ul>
<p><strong>Przypadek krytyczny</strong>: Wybierz przypadki, które będą definitywne</p>
<ul>
<li>„Jeśli to nie działa tutaj, nie zadziała nigdzie”</li>
</ul>
<p><strong>Kiedy jest przydatne:</strong></p>
<ul>
<li>Badania jakościowe skupiające się na głębi nad szerokością</li>
<li>Gdy badane są rzadkie populacje</li>
<li>Ograniczenia zasobów poważnie limitują wielkość próby</li>
<li>Fazy eksploracyjne badań</li>
</ul>
<p><strong>Problemy:</strong></p>
<ul>
<li>Całkowicie zależne od osądu badacza</li>
<li>Niemożliwe wnioskowanie statystyczne</li>
<li>Różni badacze mogą wybrać różne „typowe” przypadki</li>
</ul>
</section>
<section id="próbkowanie-kwotowe-quota-sampling" class="level4">
<h4 class="anchored" data-anchor-id="próbkowanie-kwotowe-quota-sampling">Próbkowanie kwotowe (Quota Sampling)</h4>
<p>Selekcja w celu dopasowania proporcji populacji w kluczowych charakterystykach. Jak losowanie warstwowe, ale bez losowej selekcji w grupach.</p>
<p><strong>Jak działa próbkowanie kwotowe:</strong></p>
<ol type="1">
<li>Zidentyfikuj kluczowe charakterystyki (wiek, płeć, rasa, wykształcenie)</li>
<li>Określ proporcje populacji dla tych charakterystyk</li>
<li>Ustaw kwoty dla każdej kombinacji</li>
<li>Ankieterzy wypełniają kwoty używając metod wygodnych</li>
</ol>
<p><strong>Szczegółowy przykład</strong>: Sondaż polityczny z kwotami:</p>
<p>Proporcje populacji:</p>
<ul>
<li>Mężczyzna 18-34: 15%</li>
<li>Mężczyzna 35-54: 20%</li>
<li>Mężczyzna 55+: 15%</li>
<li>Kobieta 18-34: 16%</li>
<li>Kobieta 35-54: 19%</li>
<li>Kobieta 55+: 15%</li>
</ul>
<p>Dla próby 1000:</p>
<ul>
<li>Wywiad z 150 mężczyznami w wieku 18-34</li>
<li>Wywiad z 200 mężczyznami w wieku 35-54</li>
<li>I tak dalej…</li>
</ul>
<p>Ankieterzy mogą stać na rogach ulic, podchodząc do osób, które wydają się pasować do potrzebnych kategorii, aż kwoty zostaną wypełnione.</p>
<p><strong>Dlaczego jest popularne w badaniach rynkowych:</strong></p>
<ul>
<li>Szybsze niż próbkowanie probabilistyczne</li>
<li>Tańsze (brak ponownych kontaktów dla konkretnych osób)</li>
<li>Zapewnia reprezentację demograficzną</li>
<li>Nie wymaga operatu losowania</li>
</ul>
<p><strong>Dlaczego jest problematyczne dla wnioskowania statystycznego:</strong></p>
<p><strong>Ukryte obciążenie selekcyjne</strong>: Ankieterzy podchodzą do osób, które wyglądają na przystępne, dobrze mówią językiem, nie spieszą się — systematycznie wykluczając pewne typy w każdej komórce kwotowej.</p>
<p><strong>Przykład obciążenia</strong>: Ankieter wypełniający kwotę dla „kobiet 18-34” może podchodzić do kobiet w centrum handlowym we wtorek po południu, systematycznie pomijając:</p>
<ul>
<li>Kobiety pracujące w dni powszednie</li>
<li>Kobiety, których nie stać na zakupy w centrach handlowych</li>
<li>Kobiety z małymi dziećmi, które unikają centrów handlowych</li>
<li>Kobiety robiące zakupy online</li>
</ul>
<p>Mimo że końcowa próba ma „właściwą” proporcję młodych kobiet, nie są one reprezentatywne dla wszystkich młodych kobiet.</p>
<p><strong>Brak miary błędu próbkowania</strong>: Bez prawdopodobieństw selekcji nie możemy obliczyć błędów standardowych ani przedziałów ufności.</p>
<p><strong>Historyczna przestroga</strong>: Próbkowanie kwotowe było standardem w sondażach do wyborów prezydenckich w USA w 1948 roku, gdy sondaże używające próbkowania kwotowego niepoprawnie przewidziały, że Dewey pokona Trumana. Niepowodzenie doprowadziło do przyjęcia próbkowania probabilistycznego w sondażach.</p>
</section>
<section id="próbkowanie-kuli-śnieżnej-snowball-sampling" class="level4">
<h4 class="anchored" data-anchor-id="próbkowanie-kuli-śnieżnej-snowball-sampling">Próbkowanie kuli śnieżnej (Snowball Sampling)</h4>
<p>Uczestnicy rekrutują dodatkowych uczestników ze swoich znajomych. Próba rośnie jak tocząca się kula śnieżna.</p>
<p><strong>Jak to działa:</strong></p>
<ol type="1">
<li>Zidentyfikuj początkowych uczestników (nasiona)</li>
<li>Poproś ich o polecenie innych z wymaganymi charakterystykami</li>
<li>Poproś nowych uczestników o dalsze polecenia</li>
<li>Kontynuuj, aż osiągnięta zostanie wielkość próby lub wyczerpią się polecenia</li>
</ol>
<p><strong>Przykład</strong>: Badanie nieudokumentowanych imigrantów:</p>
<ul>
<li>Zacznij od 5 imigrantów, których możesz zidentyfikować</li>
<li>Każdy poleca 3 innych, których zna</li>
<li>Tych 15 każdy poleca 2-3 innych</li>
<li>Kontynuuj, aż masz 100+ uczestników</li>
</ul>
<p><strong>Kiedy jest wartościowe:</strong></p>
<p><strong>Ukryte populacje</strong>: Grupy bez operantów losowania</p>
<ul>
<li>Użytkownicy narkotyków</li>
<li>Osoby bezdomne</li>
<li>Osoby z rzadkimi chorobami</li>
<li>Członkowie ruchów podziemnych</li>
</ul>
<p><strong>Populacje połączone społecznie</strong>: Gdy relacje mają znaczenie</p>
<ul>
<li>Badanie efektów sieci społecznych</li>
<li>Badanie transmisji chorób w społeczności</li>
<li>Zrozumienie dyfuzji informacji</li>
</ul>
<p><strong>Badania zależne od zaufania</strong>: Gdy polecenia zwiększają uczestnictwo</p>
<ul>
<li>Wrażliwe tematy, gdzie zaufanie jest niezbędne</li>
<li>Zamknięte społeczności podejrzliwe wobec obcych</li>
</ul>
<p><strong>Główne ograniczenia:</strong></p>
<ul>
<li>Próby obciążone w kierunku osób współpracujących, dobrze połączonych</li>
<li>Odizolowani członkowie populacji całkowicie pominięci</li>
<li>Wnioskowanie statystyczne generalnie niemożliwe</li>
<li>Może wzmacniać podziały społeczne (łańcuchy rzadko przekraczają granice społeczne)</li>
</ul>
<p><strong>Zaawansowana wersja — Próbkowanie sterowane przez respondentów (Respondent-Driven Sampling - RDS):</strong></p>
<p>Próbuje uczynić próbkowanie kuli śnieżnej bardziej rygorystycznym poprzez:</p>
<ul>
<li>Śledzenie, kto zrekrutował kogo</li>
<li>Ograniczanie liczby poleceń na osobę</li>
<li>Ważenie na podstawie wielkości sieci</li>
<li>Używanie modeli matematycznych do korekty obciążenia</li>
</ul>
<p>Nadal kontrowersyjne, czy RDS naprawdę pozwala na ważne wnioskowanie.</p>
<hr>
</section>
</section>
</section>
<section id="pojęcia-prawdopodobieństwa-w-analizie-statystycznej" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="pojęcia-prawdopodobieństwa-w-analizie-statystycznej"><span class="header-section-number">2.8</span> Pojęcia prawdopodobieństwa w analizie statystycznej</h2>
<p>Choć to przede wszystkim kurs statystyki, zrozumienie podstawowego prawdopodobieństwa jest niezbędne dla wnioskowania statystycznego.</p>
<section id="podstawowe-prawdopodobieństwo" class="level3">
<h3 class="anchored" data-anchor-id="podstawowe-prawdopodobieństwo">Podstawowe prawdopodobieństwo</h3>
<p><strong>Prawdopodobieństwo</strong> kwantyfikuje niepewność na skali od 0 (niemożliwe) do 1 (pewne).</p>
<p><strong>Prawdopodobieństwo klasyczne</strong>: <span class="math display">P(\text{zdarzenie}) = \frac{\text{Liczba korzystnych wyników}}{\text{Całkowita liczba możliwych wyników}}</span></p>
<p>Przykład: Prawdopodobieństwo, że losowo wybrana osoba jest kobietą <span class="math inline">\approx 0,5</span></p>
<p><strong>Prawdopodobieństwo empiryczne</strong>: Oparte na obserwowanych częstościach</p>
<p>Przykład: W wiosce 423 z 1000 mieszkańców to kobiety, więc <span class="math inline">P(\text{kobieta}) \approx 0,423</span></p>
</section>
<section id="prawdopodobieństwo-warunkowe" class="level3">
<h3 class="anchored" data-anchor-id="prawdopodobieństwo-warunkowe">Prawdopodobieństwo warunkowe</h3>
<p><strong>Prawdopodobieństwo warunkowe</strong> to prawdopodobieństwo zdarzenia A, przy założeniu że zdarzenie B wystąpiło: <span class="math inline">P(A|B)</span></p>
<p><strong>Przykład demograficzny</strong>: Prawdopodobieństwo śmierci w ciągu roku przy danym wieku:</p>
<ul>
<li><span class="math inline">P(\text{śmierć w ciągu roku} | \text{wiek 30}) \approx 0,001</span></li>
<li><span class="math inline">P(\text{śmierć w ciągu roku} | \text{wiek 80}) \approx 0,05</span></li>
</ul>
<p>Te prawdopodobieństwa warunkowe stanowią podstawę tablic trwania życia.</p>
</section>
<section id="niezależność" class="level3">
<h3 class="anchored" data-anchor-id="niezależność">Niezależność</h3>
<p>Zdarzenia A i B są <strong>niezależne</strong>, jeśli <span class="math inline">P(A|B) = P(A)</span>.</p>
<p><strong>Testowanie niezależności w danych demograficznych:</strong></p>
<p>Czy wykształcenie i płodność są niezależne?</p>
<ul>
<li><span class="math inline">P(\text{3+ dzieci}) = 0,3</span> ogólnie</li>
<li><span class="math inline">P(\text{3+ dzieci} | \text{wykształcenie wyższe}) = 0,15</span></li>
<li>Różne prawdopodobieństwa wskazują na zależność</li>
</ul>
</section>
<section id="prawo-wielkich-liczb" class="level3">
<h3 class="anchored" data-anchor-id="prawo-wielkich-liczb">Prawo wielkich liczb</h3>
<p>Gdy wielkość próby wzrasta, statystyki z próby zbiegają się do parametrów populacji.</p>
<p><strong>Demonstracja</strong>: Szacowanie proporcji płci przy urodzeniu:</p>
<ul>
<li>10 urodzeń: 7 chłopców (70% - bardzo niestabilne)</li>
<li>100 urodzeń: 53 chłopców (53% - zbliżamy się do ~51,2%)</li>
<li>1000 urodzeń: 515 chłopców (51,5% - całkiem blisko)</li>
<li>10 000 urodzeń: 5118 chłopców (51,18% - bardzo blisko)</li>
</ul>
</section>
<section id="wizualizacja-prawa-wielkich-liczb-rzuty-monetą" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-prawa-wielkich-liczb-rzuty-monetą">Wizualizacja Prawa wielkich liczb: rzuty monetą</h3>
<p>Zobaczmy to w działaniu na przykładzie rzutów monetą. Uczciwa moneta ma 50% szansy na wypadnięcie orła, ale poszczególne rzuty są nieprzewidywalne.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Symulacja rzutów monetą i pokazanie zbieżności</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>n_flips <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>flips <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_flips, <span class="dv">1</span>, <span class="fl">0.5</span>)  <span class="co"># 1 = orzeł, 0 = reszka</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie skumulowanej proporcji orłów</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>cumulative_prop <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(flips) <span class="sc">/</span> <span class="fu">seq_along</span>(flips)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie ramki danych do wizualizacji</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>lln_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">flip_number =</span> <span class="dv">1</span><span class="sc">:</span>n_flips,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cumulative_proportion =</span> cumulative_prop</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres zbieżności</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lln_data, <span class="fu">aes</span>(<span class="at">x =</span> flip_number, <span class="at">y =</span> cumulative_proportion)) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.45</span>, <span class="fl">0.55</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Prawo wielkich liczb: Proporcje rzutów monetą zbiegają do 0,5"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Liczba rzutów monetą"</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Skumulowana proporcja orłów"</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Czerwona linia przerywana = prawdziwe prawdopodobieństwo (0,5)</span><span class="sc">\n</span><span class="st">Linie kropkowane = zakres ±5%"</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/lln-demo-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Co to pokazuje</strong>:</p>
<ul>
<li>Początkowe rzuty wykazują duże wahania (pierwsze 10 rzutów może dać 70% lub 30% orłów)</li>
<li>W miarę dodawania kolejnych rzutów, proporcja stabilizuje się wokół 50%</li>
<li>„Szum” poszczególnych wyników się uśrednia w czasie</li>
</ul>
</section>
<section id="sformułowanie-matematyczne" class="level3">
<h3 class="anchored" data-anchor-id="sformułowanie-matematyczne">Sformułowanie matematyczne</h3>
<p>Niech <span class="math inline">A</span> oznacza zdarzenie nas interesujące (np. „orzeł w rzucie monetą”, „głos na partię X”, „suma kostek równa 7”). Jeśli <span class="math inline">P(A) = p</span> i obserwujemy <span class="math inline">n</span> <strong>niezależnych prób z tym samym rozkładem</strong> (i.i.d.), to <strong>częstość próbkowa zdarzenia</strong> <span class="math inline">A</span>:</p>
<p><span class="math display">\hat{p}_n = \frac{\text{liczba wystąpień zdarzenia } A}{n}</span></p>
<p><strong>zbiega do</strong> <span class="math inline">p</span> gdy <span class="math inline">n</span> rośnie.</p>
</section>
<section id="przykłady-w-różnych-kontekstach" class="level3">
<h3 class="anchored" data-anchor-id="przykłady-w-różnych-kontekstach">Przykłady w różnych kontekstach</h3>
<p><strong>Przykład z kostkami</strong>: Zdarzenie „suma = 7” przy dwóch kostkach ma prawdopodobieństwo <span class="math inline">6/36 ≈ 16,7\%</span>, podczas gdy „suma = 4” ma <span class="math inline">3/36 ≈ 8,3\%</span>. Przy wielu rzutach suma 7 pojawia się około dwa razy częściej niż suma 4.</p>
<p><strong>Sondaże wyborcze</strong>: Jeśli poparcie populacyjne dla partii wynosi <span class="math inline">p</span>, to przy losowym doborze próby o wielkości <span class="math inline">n</span> obserwowana częstość <span class="math inline">\hat{p}_n</span> będzie zbliżać się do <span class="math inline">p</span> w miarę wzrostu <span class="math inline">n</span> (zakładając losowy dobór i niezależność prób).</p>
<p><strong>Kontrola jakości</strong>: Jeśli 2% produktów jest wadliwych, to w dużych partiach około 2% zostanie uznanych za wadliwe (zakładając niezależną produkcję).</p>
</section>
<section id="dlaczego-to-ma-znaczenie-dla-statystyki" class="level3">
<h3 class="anchored">Dlaczego to ma znaczenie dla statystyki</h3>
<p><strong>Wniosek</strong>: Losowość stanowi podstawę wnioskowania statystycznego, przekształcając niepewność poszczególnych wyników w <strong>przewidywalne rozkłady</strong> dla estymatorów. Prawo wielkich liczb gwarantuje, że „szum” poszczególnych wyników się uśrednia, pozwalając nam:</p>
<ul>
<li>Przewidywać długookresowe częstości</li>
<li>Kwantyfikować niepewność (marginesy błędu)</li>
<li>Wyciągać rzetelne wnioski z prób</li>
<li>Formułować probabilistyczne stwierdzenia o populacjach</li>
</ul>
<p>Ta zasada działa w sondażach, eksperymentach, a nawet w zjawiskach kwantowych (w interpretacji częstościowej).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Czym jest losowość? (*)
</div>
</div>
<div class="callout-body-container callout-body">
<p>W statystyce <strong>losowość</strong> to uporządkowany sposób opisu niepewności: pojedyncze wyniki są nieprzewidywalne, natomiast w <strong>długiej serii powtórzeń</strong> ujawniają się stabilne prawidłowości (np. częstości, średnie).</p>
<p><strong>Dwie perspektywy</strong></p>
<ol type="1">
<li><strong>Pojedyncza realizacja</strong> — nie potrafimy przesądzić, jak zagłosuje konkretny wyborca w danym momencie.<br>
</li>
<li><strong>Zbiorowość</strong> — możemy opisać odsetek wyborców głosujących na daną partię oraz związaną z nim niepewność estymacji.</li>
</ol>
<p><strong>Losowość epistemiczna a ontologiczna</strong></p>
<ul>
<li><p><strong>Epistemiczna</strong> (związana z niewiedzą): wynik traktujemy jako losowy, ponieważ nie obserwujemy wszystkich determinant lub nie kontrolujemy warunków.</p>
<p><strong>Przykłady:</strong></p>
<ul>
<li>decyzja pojedynczego wyborcy w sondażu (nie znamy pełnych motywacji),</li>
<li>błąd pomiaru w ankiecie (ograniczona precyzja, brak odpowiedzi),</li>
<li>rzut monetą modelowany jako losowy, ponieważ drobne, nieobserwowalne różnice warunków początkowych determinują wynik.</li>
</ul></li>
<li><p><strong>Ontologiczna</strong> (wrodzona przypadkowość zjawiska): nawet pełna wiedza nie usuwa niepewności wyniku.</p>
<p><strong>Przykłady:</strong></p>
<ul>
<li>czas rozpadu promieniotwórczego atomu.</li>
</ul></li>
</ul>
<section id="znaczenie-losowości" class="level3">
<h3 class="anchored" data-anchor-id="znaczenie-losowości">Znaczenie losowości</h3>
<ul>
<li><p><strong>Losowe próbkowanie</strong></p>
<ul>
<li>Ogranicza systematyczny błąd doboru, dzięki czemu próba przypomina populację docelową (w średnim ujęciu / w wartości oczekiwanej).</li>
<li>Umożliwia <strong>ilościowe</strong> ujęcie niepewności (np. margines błędu; pojęcie „przedziału ufności” omówimy później), pod warunkiem rzeczywiście losowego doboru i dobrego pokrycia populacji.</li>
</ul></li>
<li><p><strong>Losowy przydział (eksperymenty)</strong></p>
<ul>
<li>Przerywa związek między przydziałem a innymi czynnikami, czyniąc grupy porównywalnymi <strong>średnio</strong> (zarówno pod względem cech obserwowalnych, jak i nieobserwowalnych).</li>
<li>Umożliwia wiarygodne <strong>wnioskowanie przyczynowe</strong> (identyfikację średnich efektów przy standardowych założeniach).</li>
</ul></li>
</ul>
</section>
<section id="siła-losowego-próbkowania" class="level3">
<h3 class="anchored" data-anchor-id="siła-losowego-próbkowania">Siła losowego próbkowania</h3>
<p>Załóżmy, że losujemy <strong>próbę prostą</strong> o liczebności <span class="math inline">n=1000</span> wyborców i obserwujemy <span class="math inline">\hat p = 0{,}55</span> (tj. 55% poparcia). Wówczas:</p>
<ul>
<li><p>Naszą najlepszą, jednowartościową oceną odsetka w populacji <span class="math inline">p</span> jest <span class="math inline">\hat p = 0{,}55</span>.</p></li>
<li><p>Orientacyjny „<span class="math inline">95\%</span> zakres wartości plauzybilnych” wokół <span class="math inline">\hat p</span> można przybliżyć wzorem <span class="math display">
\hat p \,\pm\, 2\sqrt{\frac{\hat p(1-\hat p)}{n}}
\;=\;
0{,}55 \,\pm\, 2\sqrt{\frac{0{,}55\cdot 0{,}45}{1000}}
\approx
0{,}55 \pm 0{,}031,
</span> czyli w przybliżeniu <span class="math inline">52\%\text{–}58\%</span> (około <span class="math inline">\pm 3{,}1</span> punktu procentowego, <strong>pp</strong>).</p></li>
<li><p>Szerokość tego zakresu maleje wraz z liczebnością próby: <span class="math display">
\text{szerokość} \;\propto\; \frac{1}{\sqrt{n}}.
</span> Przykładowo, zwiększenie <span class="math inline">n</span> z <span class="math inline">1000</span> do <span class="math inline">4000</span> mniej więcej <strong>zmniejsza błąd o połowę</strong>.</p></li>
</ul>
</section>
<section id="rozumienie-różnych-typów-nieprzewidywalności" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="rozumienie-różnych-typów-nieprzewidywalności"><span class="header-section-number">2.9</span> Rozumienie różnych typów nieprzewidywalności</h2>
<p>Nie wszystkie rodzaje niepewności są takie same. Zrozumienie różnych źródeł nieprzewidywalności pomaga w wyborze odpowiednich metod statystycznych i prawidłowej interpretacji wyników.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Pojęcie</th>
<th>Czym jest?</th>
<th>Źródło nieprzewidywalności</th>
<th>Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Losowość</strong> (randomness)</td>
<td>Poszczególne wyniki są niepewne, ale <strong>rozkład prawdopodobieństwa</strong> jest znany lub modelowany.</td>
<td>Fluktuacje między realizacjami; brak informacji o konkretnym wyniku.</td>
<td>Rzut kostką, rzut monetą, próba sondażowa</td>
</tr>
<tr class="even">
<td><strong>Chaos</strong></td>
<td>Dynamika <strong>deterministyczna</strong> <strong>bardzo wrażliwa</strong> na warunki początkowe (efekt motyla).</td>
<td>Niewielkie różnice początkowe szybko narastają → duże rozbieżności trajektorii.</td>
<td>Prognoza pogody, podwójne wahadło, dynamika populacyjna</td>
</tr>
<tr class="odd">
<td><strong>Entropia</strong></td>
<td><strong>Miara</strong> niepewności/rozproszenia (teorioinformacyjna lub termodynamiczna).</td>
<td>Większa gdy wyniki są bardziej równomiernie rozłożone (mniej informacji predykcyjnej).</td>
<td>Entropia Shannona w kompresji danych</td>
</tr>
<tr class="even">
<td><strong>„Przypadkowość”</strong> (potoczne)</td>
<td>Odczuwany brak porządku bez wyraźnego modelu; mieszanka mechanizmów.</td>
<td>Brak uporządkowanego opisu lub stabilnych reguł; nakładające się procesy.</td>
<td>Wzorce ruchu, trendy w mediach społecznościowych</td>
</tr>
<tr class="odd">
<td><strong>Losowość kwantowa</strong> (quantum randomness)</td>
<td>Pojedynczy wynik <strong>nie jest zdeterminowany</strong>; tylko rozkład jest określony (reguła Borna).</td>
<td><strong>Fundamentalna (ontologiczna)</strong> nieokreśloność poszczególnych pomiarów.</td>
<td>Pomiar spinu elektronu, polaryzacja fotonu</td>
</tr>
</tbody>
</table>
<section id="kluczowe-rozróżnienia-dla-praktyki-statystycznej" class="level3">
<h3 class="anchored" data-anchor-id="kluczowe-rozróżnienia-dla-praktyki-statystycznej">Kluczowe rozróżnienia dla praktyki statystycznej</h3>
<p><strong>Chaos deterministyczny ≠ losowość statystyczna</strong>: System chaotyczny jest w pełni deterministyczny, ale praktycznie nieprzewidywalny z powodu ekstremalnej wrażliwości na warunki początkowe. Losowość statystyczna modeluje natomiast niepewność poprzez rozkłady prawdopodobieństwa, gdzie poszczególne wyniki są rzeczywiście niepewne.</p>
<p><strong>Dlaczego to ważne</strong>: W statystyce zazwyczaj modelujemy zjawiska jako procesy losowe, zakładając, że możemy określić rozkłady prawdopodobieństwa, nawet gdy poszczególne wyniki są nieprzewidywalne. To założenie stanowi podstawę większości wnioskowań statystycznych.</p>
</section>
<section id="mechanika-kwantowa-i-fundamentalna-losowość" class="level3">
<h3 class="anchored" data-anchor-id="mechanika-kwantowa-i-fundamentalna-losowość">Mechanika kwantowa i fundamentalna losowość</h3>
<p>W interpretacji kopenhaskiej losowość jest <strong>fundamentalna (ontologiczna)</strong>: <strong>pojedynczy</strong> wynik nie może być przewidziany, ale <strong>rozkład prawdopodobieństwa</strong> jest dany przez regułę Borna.</p>
<p>To reprezentuje prawdziwą losowość na najbardziej podstawowym poziomie natury, nie tylko naszą ignorancję czynników determinujących.</p>
</section>
</section>
</div>
</div>
</section>
<section id="centralne-twierdzenie-graniczne" class="level3">
<h3 class="anchored" data-anchor-id="centralne-twierdzenie-graniczne">Centralne Twierdzenie Graniczne</h3>
<p>Rozkład średnich z prób zbliża się do rozkładu normalnego, gdy wielkość próby wzrasta, niezależnie od rozkładu populacji.</p>
<p><strong>Dlaczego to ma znaczenie</strong>: Nawet jeśli dochód jest bardzo skośny, średni dochód z prób 100+ osób podąża za przybliżonym rozkładem normalnym, pozwalając nam używać przedziałów ufności opartych na rozkładzie normalnym.</p>
<hr>
</section>
</section>
<section id="istotność-statystyczna-wprowadzenie" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="istotność-statystyczna-wprowadzenie"><span class="header-section-number">2.10</span> Istotność Statystyczna: Wprowadzenie</h2>
<p>Wyobraź sobie, że rzucasz monetą 10 razy i wypadło 8 orłów. Czy moneta jest fałszywa, czy po prostu miałeś szczęście? To jest kluczowe pytanie, na które pomaga odpowiedzieć istotność statystyczna (wnioskowanie statystyczne).</p>
<p><strong>Istotność statystyczna</strong> to miara (p-value) tego, na ile możemy być pewni, że wzorce obserwowane w naszej próbie nie są dziełem przypadku. Gdy wynik jest statystycznie istotny (zwykle przyjmujemy p-value &lt; 0.05), oznacza to, że prawdopodobieństwo uzyskania takich danych przy braku rzeczywistego efektu jest bardzo niskie.</p>
<p><strong>Istotność statystyczna</strong> pomaga nam rozróżnić między rzeczywistymi zjawiskami a przypadkowymi fluktuacjami w danych. Gdy mówimy, że wynik jest statystycznie istotny, znaczy to, że prawdopodobnie nie powstał przez zwykły zbieg okoliczności.</p>
<section id="analogia-do-sali-sądowej" class="level3">
<h3 class="anchored" data-anchor-id="analogia-do-sali-sądowej">Analogia do Sali Sądowej</h3>
<p>Testowanie hipotez statystycznych działa jak proces karny:</p>
<ul>
<li><strong>Hipoteza Zerowa (</strong><span class="math inline">H_0</span>): Oskarżony jest niewinny (nie ma efektu)</li>
<li><strong>Hipoteza Alternatywna (</strong><span class="math inline">H_1</span>): Oskarżony jest winny (efekt istnieje)</li>
<li><strong>Dowody</strong>: Twoje dane i wyniki testów</li>
<li><strong>Werdykt</strong>: “Winny” (odrzuć <span class="math inline">H_0</span>) lub “Niewinny” (nie odrzucaj <span class="math inline">H_0</span>)</li>
</ul>
<p><strong>Kluczowe rozróżnienie</strong>: “Niewinny” ≠ “Niewinny”</p>
<ul>
<li>Werdykt “niewinny” oznacza niewystarczające dowody do skazania</li>
<li>Podobnie, “brak istotności statystycznej” oznacza niewystarczające dowody na istnienie efektu, NIE dowód braku efektu</li>
</ul>
</section>
<section id="brak-efektu-domniemanie-niewinności" class="level3">
<h3 class="anchored" data-anchor-id="brak-efektu-domniemanie-niewinności">Brak efektu (“Domniemanie niewinności”)</h3>
<p>W statystyce zawsze zaczynamy od założenia, że nic specjalnego się nie dzieje:</p>
<ul>
<li><strong>Hipoteza Zerowa (</strong><span class="math inline">H_0</span>): “Nie ma efektu”
<ul>
<li>Moneta jest uczciwa</li>
<li>Nowy lek nie działa</li>
<li>Czas nauki nie wpływa na wyniki w nauce</li>
</ul></li>
<li><strong>Hipoteza Alternatywna (</strong><span class="math inline">H_1</span>): “Efekt ISTNIEJE”
<ul>
<li>Moneta jest fałszywa</li>
<li>Lek działa</li>
<li>Więcej nauki poprawia oceny</li>
</ul></li>
</ul>
<p><strong>Kluczowa zasada</strong>: Podtrzymujemy hipotezę zerową (niewinność), chyba że dane dostarczą mocnych dowodów przeciwko niej — “ponad wszelką wątpliwość” w terminologii prawnej, lub “p &lt; 0,05” w terminologii statystycznej.</p>
</section>
</section>
<section id="wartość-p-p-value-twój-miernik-zaskoczenia" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="wartość-p-p-value-twój-miernik-zaskoczenia"><span class="header-section-number">2.11</span> Wartość p (p-value): Twój “Miernik Zaskoczenia”</h2>
<p><strong>Wartość p</strong> odpowiada na jedno konkretne pytanie:</p>
<blockquote class="blockquote">
<p>“Gdyby nic specjalnego się nie działo (hipoteza zerowa jest prawdziwa), jak zaskakujące byłyby nasze wyniki?”</p>
</blockquote>
<blockquote class="blockquote">
<p>Wartość p, p-wartość, prawdopodobieństwo testowe (ang. p-value, probability value) – prawdopodobieństwo uzyskania wyników testu co najmniej tak samo skrajnych, jak te zaobserwowane w rzeczywistości (w próbie badawczej), obliczone przy założeniu, że hipoteza zerowa (brak efektu, różnicy, itp.) jest prawdziwa.</p>
</blockquote>
<section id="trzy-sposoby-myślenia-o-wartościach-p" class="level3">
<h3 class="anchored" data-anchor-id="trzy-sposoby-myślenia-o-wartościach-p">Trzy Sposoby Myślenia o Wartościach p</h3>
<section id="skala-zaskoczenia" class="level4">
<h4 class="anchored" data-anchor-id="skala-zaskoczenia">1. Skala Zaskoczenia</h4>
<ul>
<li><strong>p &lt; 0,01</strong>: Bardzo zaskakujące! (Mocne dowody przeciwko <span class="math inline">H_0</span>)</li>
<li><strong>p &lt; 0,05</strong>: Dość zaskakujące (Umiarkowane dowody przeciwko <span class="math inline">H_0</span>)</li>
<li><strong>p &gt; 0,05</strong>: Niezbyt zaskakujące (Niewystarczające dowody przeciwko <span class="math inline">H_0</span>)</li>
</ul>
</section>
<section id="konkretny-przykład-podejrzana-moneta" class="level4">
<h4 class="anchored" data-anchor-id="konkretny-przykład-podejrzana-moneta">2. Konkretny Przykład: Podejrzana Moneta</h4>
<p>Rzucasz monetą 10 razy i wypadło 8 orłów. Jaka jest wartość p?</p>
<p><strong>Obliczenie</strong>: Jeśli moneta byłaby uczciwa, prawdopodobieństwo uzyskania 8 lub więcej orłów wynosi:</p>
<p><span class="math display">p = P(≥8 \text{ orłów w 10 rzutach}) \approx 0.055 \approx 5.5\%</span></p>
<p><span class="math display">P(X \geq 8) = \sum_{k=8}^{10} \binom{10}{k} 0,5^{10} = \frac{56}{1024} \approx 0,0547</span></p>
<p><strong>Interpretacja</strong>: Jest 5,5% szans na uzyskanie tak ekstremalnych wyników z uczciwą monetą. To trochę nietypowe, ale nie jest to skrajnie nieprawdopodobny wynik.</p>
</section>
<section id="formalna-definicja" class="level4">
<h4 class="anchored" data-anchor-id="formalna-definicja">3. Formalna Definicja</h4>
<p>Wartość p to prawdopodobieństwo uzyskania wyników co najmniej tak ekstremalnych jak zaobserwowane, <strong>zakładając że hipoteza zerowa jest prawdziwa</strong>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Częsty Błąd</strong>: Wartość p NIE jest prawdopodobieństwem, że hipoteza zerowa jest prawdziwa! Zakłada ona, że hipoteza zerowa jest prawdziwa i mówi, jak nietypowe byłyby twoje dane w tym świecie (w którym <span class="math inline">H_0</span> jest prawdziwa).</p>
</div>
</div>
</section>
</section>
</section>
<section id="błąd-rozumowania-prokuratorskiego-ostrzeżenie" class="level2" data-number="2.12">
<h2 data-number="2.12" class="anchored" data-anchor-id="błąd-rozumowania-prokuratorskiego-ostrzeżenie"><span class="header-section-number">2.12</span> Błąd Rozumowania Prokuratorskiego: Ostrzeżenie</h2>
<section id="wyjaśnienie-błędu" class="level3">
<h3 class="anchored" data-anchor-id="wyjaśnienie-błędu">Wyjaśnienie błędu</h3>
<p>Wyobraź sobie taką scenę w sądzie:</p>
<p><strong>Prokurator</strong>: “Jeśli oskarżony byłby niewinny, istnieje tylko 1% szans, że znaleźlibyśmy jego DNA na miejscu zbrodni. Znaleźliśmy jego DNA. Zatem istnieje 99% pewności, że jest winny!”</p>
<p><strong>To BŁĄD!</strong> Prokurator pomylił:</p>
<ul>
<li>P(Dowód | Niewinny) = 0,01 ← To, co wiemy</li>
<li>P(Niewinny | Dowód) = ? ← To, co chcemy wiedzieć (ale nie możemy tego wywnioskować z samej wartości p!)</li>
</ul>
<hr>
<p>Gdy otrzymujemy p = 0,01, kuszące jest myślenie:</p>
<p>❌ <strong>ŹLE</strong>: “Jest tylko 1% szans, że hipoteza zerowa jest prawdziwa”<br>
❌ <strong>ŹLE</strong>: “Jest 99% szans, że nasze leczenie działa”</p>
<p>✅ <strong>DOBRZE</strong>: “Jeśli hipoteza zerowa byłaby prawdziwa, istnieje tylko 1% szans, że zobaczylibyśmy tak ekstremalne dane”</p>
</section>
<section id="dlaczego-to-ważne-prosty-przykład-testu-medycznego" class="level3">
<h3 class="anchored" data-anchor-id="dlaczego-to-ważne-prosty-przykład-testu-medycznego">Dlaczego to ważne: Prosty przykład testu medycznego</h3>
<p>Wyobraź sobie test na rzadką chorobę, który jest dokładny w 99%:</p>
<ul>
<li>Jeśli masz chorobę, test jest pozytywny w 99% przypadków</li>
<li>Jeśli nie masz choroby, test jest negatywny w 99% przypadków (czyli 1% wyników fałszywie pozytywnych)</li>
</ul>
<p><strong>Oto klucz</strong>: Załóżmy, że tylko 1 na 1000 osób faktycznie ma tę chorobę.</p>
<p>Przetestujmy 10 000 osób:</p>
<ul>
<li><strong>10 osób ma chorobę</strong> → 10 ma pozytywny wynik testu (w zaokrągleniu)</li>
<li><strong>9 990 osób nie ma choroby</strong> → około 100 ma pozytywny wynik przez pomyłkę (1% z 9 990)</li>
<li><strong>Łącznie pozytywnych testów</strong>: 110</li>
</ul>
<p><strong>Jeśli twój test jest pozytywny, jakie jest prawdopodobieństwo, że rzeczywiście masz chorobę?</strong></p>
<ul>
<li>Tylko 10 ze 110 pozytywnych testów to prawdziwe przypadki</li>
<li>To około 9%, nie 99%!</li>
</ul>
</section>
<section id="analogia-do-badań-naukowych" class="level3">
<h3 class="anchored" data-anchor-id="analogia-do-badań-naukowych">Analogia do badań naukowych</h3>
<p>To samo dzieje się w badaniach:</p>
<ul>
<li>Gdy testujemy wiele hipotez (jak testowanie wielu potencjalnych leków)</li>
<li>Większość nie działa (jak większość ludzi nie ma rzadkiej choroby)</li>
<li>Nawet przy “istotnych” wynikach (jak pozytywny test), większość odkryć może być fałszywie pozytywna</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wartość p mówi ci, jak zaskakujące byłyby twoje dane, GDYBY hipoteza zerowa była prawdziwa. Nie mówi ci o prawdopodobieństwie, że hipoteza zerowa JEST prawdziwa.</p>
<p>Pomyśl o tym tak: Prawdopodobieństwo, że ziemia będzie mokra, JEŚLI padało, jest zupełnie inne niż prawdopodobieństwo, że padało, JEŚLI ziemia jest mokra — ziemia mogła być mokra od zraszacza!</p>
<p><strong>Pamiętaj</strong>: Wartość p mówi ci P(Dane | Hipoteza zerowa jest prawdziwa), nie P(Hipoteza zerowa jest prawdziwa | Dane). To tak różne jak P(Mokra ziemia | Deszcz) i P(Deszcz | Mokra ziemia) — ziemia może być mokra od zraszacza!</p>
</div>
</div>
<hr>
</section>
</section>
<section id="wprowadzenie-do-analizy-regresji-modelowanie-relacji-między-zmiennymi" class="level2" data-number="2.13">
<h2 data-number="2.13" class="anchored" data-anchor-id="wprowadzenie-do-analizy-regresji-modelowanie-relacji-między-zmiennymi"><span class="header-section-number">2.13</span> Wprowadzenie do analizy regresji: Modelowanie relacji między zmiennymi</h2>
<p>Jednym z najważniejszych narzędzi w analizie statystycznej jest <strong>analiza regresji</strong> — metoda zrozumienia i kwantyfikacji relacji między zmiennymi.</p>
<p>Podstawowa idea jest prosta: Jak jedna rzecz odnosi się do drugiej i czy możemy użyć tej relacji do dokonywania przewidywań (np. jak liczba lat nauki wpływa na dochody?)?</p>
<blockquote class="blockquote">
<p><strong>W jednym zdaniu:</strong> Regresja pomaga nam zrozumieć, jak różne zjawiska są ze sobą powiązane w skomplikowanym świecie, gdzie wszystko wpływa na wszystko inne.</p>
</blockquote>
<section id="czym-jest-analiza-regresji" class="level3">
<h3 class="anchored" data-anchor-id="czym-jest-analiza-regresji">Czym jest analiza regresji?</h3>
<p>Wyobraź sobie, że jesteś ciekawy relacji między wykształceniem a dochodem. Zauważasz, że ludzie z większym wykształceniem zwykle zarabiają więcej pieniędzy, ale chcesz zrozumieć tę relację bardziej precyzyjnie:</p>
<ul>
<li>O ile średnio każdy dodatkowy rok edukacji zwiększa dochód?</li>
<li>Jak silna jest ta relacja?</li>
<li>Czy są inne czynniki, które powinniśmy rozważyć?</li>
<li>Czy możemy przewidzieć prawdopodobny dochód kogoś, jeśli znamy jego poziom wykształcenia?</li>
</ul>
<p>Analiza regresji w sposób systematyczny odpowiada na te pytania — szuka najlepiej dopasowanego opisu relacji między zmiennymi.</p>
</section>
<section id="zmienne-i-zmienność" class="level3">
<h3 class="anchored" data-anchor-id="zmienne-i-zmienność">Zmienne i Zmienność</h3>
<p><strong>Zmienna</strong> to każda charakterystyka, która może przyjmować różne wartości dla różnych jednostek obserwacji. W naukach politycznych:</p>
<ul>
<li><strong>Jednostki analizy</strong>: Kraje, osoby, wybory, polityki, lata</li>
<li><strong>Zmienne</strong>: PKB, preferencje wyborcze, wskaźnik demokracji, wystąpienie konfliktu</li>
</ul>
<blockquote class="blockquote">
<p><strong>💡 Mówiąc Prosto:</strong> Zmienna to wszystko, co się zmienia. Gdyby wszyscy głosowali tak samo, “preferencje wyborcze” nie byłyby zmienną - byłyby stałą. Badamy zmienne, ponieważ chcemy zrozumieć, dlaczego rzeczy się różnią.</p>
</blockquote>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rozważmy typowy nagłówek prasowy przed wyborami: „Poparcie dla kandydata Kowalskiego sięga 68%.” Najprawdopodobniej wyciągniesz wniosek, że Kowalski ma dobre perspektywy wyborcze—nie gwarantowane zwycięstwo, ale silną pozycję. Intuicyjnie rozumiesz, że wyższe poparcie zwykle przekłada się na lepsze wyniki wyborcze, nawet jeśli związek ten nie jest doskonały.</p>
<p>Ta intuicyjna ocena ilustruje istotę analizy regresji. Wykorzystałeś jedną informację (wskaźnik poparcia), aby przewidzieć inny wynik (sukces wyborczy). Co więcej, rozpoznałeś zarówno związek między tymi zmiennymi, jak i niepewność związaną z twoją prognozą.</p>
<p>Chociaż takie nieformalne rozumowanie dobrze nam służy w życiu codziennym, ma istotne ograniczenia. O ile lepsze są szanse Kowalskiego przy 68% poparciu w porównaniu do 58%? Co się dzieje, gdy musimy jednocześnie uwzględnić wiele czynników—poparcie, sytuację gospodarczą i status urzędującego kandydata? Jak pewni powinniśmy być naszych prognoz?</p>
<p>Analiza regresji dostarcza systematycznych ram do odpowiedzi na te pytania. Przekształca nasze intuicyjne rozumienie związków w precyzyjne modele matematyczne, które można testować i udoskonalać. Dzięki analizie regresji badacze mogą:</p>
<ul>
<li><p><strong>Generować precyzyjne prognozy</strong>: Wyjść poza ogólne oceny ku konkretnym liczbowym szacunkom—na przykład przewidywać nie tylko, że Kowalski „prawdopodobnie wygra”, ale oszacować oczekiwany procent głosów i zakres prawdopodobnych wyników.</p></li>
<li><p><strong>Określić, które czynniki są najważniejsze</strong>: Ustalić względne znaczenie różnych zmiennych—być może odkrywając, że warunki gospodarcze wpływają na wybory silniej niż wskaźniki poparcia.</p></li>
<li><p><strong>Określić ilościowo niepewność prognoz</strong>: Dokładnie zmierzyć, jak pewni powinniśmy być naszych przewidywań, rozróżniając między niemal pewnymi wynikami a edukowanymi przypuszczeniami.</p></li>
<li><p><strong>Testować propozycje teoretyczne danymi empirycznymi</strong>: Ocenić, czy nasze przekonania o związkach przyczynowo-skutkowych sprawdzają się, gdy testujemy je systematycznie na wielu obserwacjach.</p></li>
</ul>
<blockquote class="blockquote">
<p>W istocie analiza regresji systematyzuje rozpoznawanie wzorców, które wykonujemy intuicyjnie, dostarczając narzędzi do tego, aby nasze prognozy były dokładniejsze, nasze porównania bardziej znaczące, a nasze wnioski bardziej wiarygodne.</p>
</blockquote>
<hr>
<section id="model-podstawowy" class="level3">
<h3 class="anchored" data-anchor-id="model-podstawowy">Model Podstawowy</h3>
<p>Model reprezentuje obiekt, osobę lub system w sposób informatywny. Modele dzielą się na reprezentacje fizyczne (takie jak modele architektoniczne) i abstrakcyjne (takie jak równania matematyczne opisujące dynamikę atmosfery).</p>
<p>Rdzeń myślenia statystycznego można wyrazić jako:</p>
<p><span class="math display">Y = f(X) + \text{błąd}</span></p>
<p>To równanie stwierdza, że nasz wynik (<span class="math inline">Y</span>) równa się jakiejś funkcji naszych predyktorów (<span class="math inline">X</span>), plus nieprzewidywalna zmienność.</p>
<p><strong>Składniki</strong>:</p>
<ul>
<li><span class="math inline">Y</span> = Zmienna zależna (zjawisko, które chcemy wyjaśnić)</li>
<li><span class="math inline">X</span> = Zmienna(e) niezależna(e) (czynniki wyjaśniające)</li>
<li><span class="math inline">f()</span> = Związek funkcyjny (często zakładamy liniowy)</li>
<li>błąd (<span class="math inline">\epsilon</span>) = Niewyjaśniona zmienność</li>
</ul>
<blockquote class="blockquote">
<p><strong>💡 Co To Naprawdę Oznacza:</strong> Można to porównać do przepisu kulinarnego. Ocena z przedmiotu (<span class="math inline">Y</span>) zależy od godzin nauki (<span class="math inline">X</span>), ale nie doskonale. Dwóch studentów uczących się 10 godzin może otrzymać różne oceny z powodu stresu przed egzaminem, wcześniejszej wiedzy czy po prostu szczęścia (składnik błędu). Regresja znajduje średni związek.</p>
</blockquote>
<p>Ten model stanowi podstawę całej analizy statystycznej - od prostych korelacji po złożone algorytmy uczenia maszynowego.</p>
<p>Regresja pomaga odpowiedzieć na fundamentalne pytania takie jak:</p>
<ul>
<li>O ile edukacja zwiększa uczestnictwo polityczne?</li>
<li>Jakie czynniki przewidują sukces wyborczy?</li>
<li>Czy instytucje demokratyczne promują wzrost gospodarczy?</li>
</ul>
</section>
</div>
</div>
<hr>
</section>
<section id="podstawowa-idea-rysowanie-najlepszej-linii-przez-punkty" class="level3">
<h3 class="anchored" data-anchor-id="podstawowa-idea-rysowanie-najlepszej-linii-przez-punkty">Podstawowa idea: Rysowanie najlepszej linii przez punkty</h3>
<section id="prosta-regresja-liniowa-simple-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="prosta-regresja-liniowa-simple-linear-regression">Prosta regresja liniowa (Simple Linear Regression)</h4>
<p>Zacznijmy od najprostszego przypadku: relacji między dwiema zmiennymi. Załóżmy, że rysujemy wykształcenie (lata nauki) na osi x i roczny dochód na osi y dla 100 osób. Zobaczylibyśmy chmurę punktów, a regresja znajduje prostą linię, która najlepiej reprezentuje wzorzec w tych punktach.</p>
<p><strong>Co czyni linię „najlepszą”?</strong> Linia regresji minimalizuje całkowitą sumę kwadratów pionowych odległości od wszystkich punktów do linii. Pomyśl o tym jako o znalezieniu linii, która tworzy najmniejszy całkowity błąd predykcji.</p>
<p>Równanie tej linii to: <span class="math display">Y = a + bX + \text{błąd}</span></p>
<p>Lub w naszym przykładzie: <span class="math display">\text{Dochód} = a + b \times \text{Wykształcenie} + \text{błąd}</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">a</span> (wyraz wolny/intercept) = przewidywany dochód przy zerowym wykształceniu</li>
<li><span class="math inline">b</span> (nachylenie/slope) = zmiana dochodu na każdy dodatkowy rok wykształcenia</li>
<li>błąd (<span class="math inline">e</span>) = różnica między rzeczywistym a przewidywanym dochodem</li>
</ul>
<p><strong>Interpretacja wyników:</strong></p>
<p>Jeśli nasza analiza znajduje: <span class="math display">\text{Dochód} = 15000 + 4000 \times \text{Wykształcenie}</span></p>
<p>To mówi nam:</p>
<ul>
<li>Ktoś z 0 latami wykształcenia przewidywany jest na zarobki 15 000 zł</li>
<li>Każdy dodatkowy rok wykształcenia jest związany z 4000 zł większym dochodem</li>
<li>Ktoś z 12 latami wykształcenia przewidywany jest na zarobki: 15 000 + (4000 × 12) = 63 000 zł</li>
<li>Ktoś z 16 latami (licencjat) przewidywany jest na zarobki: 15 000 + (4000 × 16) = 79 000 zł</li>
</ul>
</section>
</section>
<section id="zrozumienie-relacji-vs.-dowodzenie-przyczynowości" class="level3">
<h3 class="anchored" data-anchor-id="zrozumienie-relacji-vs.-dowodzenie-przyczynowości">Zrozumienie relacji vs.&nbsp;dowodzenie przyczynowości</h3>
<p>Kluczowe rozróżnienie: regresja pokazuje <strong>związek (association)</strong>, niekoniecznie <strong>przyczynowość (causation)</strong>. Nasza regresja wykształcenie-dochód pokazuje, że są powiązane, ale nie dowodzi, że wykształcenie powoduje wyższy dochód. Inne wyjaśnienia są możliwe:</p>
<ul>
<li><strong>Odwrotna przyczynowość</strong>: Może bogatsze rodziny mogą sobie pozwolić na więcej edukacji dla swoich dzieci</li>
<li><strong>Wspólna przyczyna</strong>: Być może inteligencja lub motywacja wpływa zarówno na wykształcenie, jak i dochód</li>
<li><strong>Zbieg okoliczności</strong>: W małych próbach wzorce mogą pojawić się przez przypadek</li>
</ul>
<p><strong>Przykład pozornej korelacji</strong>: Regresja może pokazać, że sprzedaż lodów silnie przewiduje utopienia. Czy lody powodują utopienia? Nie! Oba wzrastają latem (wspólna przyczyna, <em>confounding variable</em>).</p>
<hr>
</section>
<section id="regresja-wieloraka-multiple-regression-kontrolowanie-innych-czynników" class="level3">
<h3 class="anchored" data-anchor-id="regresja-wieloraka-multiple-regression-kontrolowanie-innych-czynników">Regresja wieloraka (Multiple Regression): Kontrolowanie innych czynników</h3>
<p>Rzeczywistość jest skomplikowana — wiele czynników wpływa na wyniki jednocześnie. <strong>Regresja wieloraka</strong> pozwala nam badać jedną relację, jednocześnie „kontrolując” lub „utrzymując na stałym poziomie” inne zmienne.</p>
<section id="moc-kontroli-statystycznej" class="level4">
<h4 class="anchored" data-anchor-id="moc-kontroli-statystycznej">Moc kontroli statystycznej</h4>
<p>Wracając do wykształcenia i dochodu, możemy się zastanawiać: Czy efekt wykształcenia wynika tylko z tego, że wykształceni ludzie są zwykle z bogatszych rodzin lub mieszkają w miastach? Regresja wieloraka może oddzielić te efekty:</p>
<p><span class="math display">\text{Dochód} = a + b_1 \times \text{Wykształcenie} + b_2 \times \text{Wiek} + b_3 \times \text{Miasto} + b_4 \times \text{Dochód rodziców} + \text{błąd}</span></p>
<p>Teraz <span class="math inline">b_1</span> reprezentuje efekt wykształcenia <em>po uwzględnieniu</em> wieku, lokalizacji i pochodzenia rodzinnego. Jeśli <span class="math inline">b_1 = 3000</span>, oznacza to: „Porównując osoby w tym samym wieku, lokalizacji i pochodzeniu rodzinnym, każdy dodatkowy rok wykształcenia jest związany z 3000 zł większym dochodem.”</p>
<p><strong>Przykład demograficzny</strong>: Płodność i wykształcenie kobiet</p>
<p>Badacze badający płodność mogą znaleźć: <span class="math display">\text{Dzieci} = 4,5 - 0,3 \times \text{Wykształcenie}</span></p>
<p>To sugeruje, że każdy rok wykształcenia kobiet jest związany z 0,3 mniej dzieci. Ale czy wykształcenie jest przyczyną, czy wykształcone kobiety różnią się w innych aspektach? Dodając kontrole:</p>
<p><span class="math display">\text{Dzieci} = a - 0,15 \times \text{Wykształcenie} - 0,2 \times \text{Miasto} + 0,1 \times \text{Wykształcenie męża} - 0,4 \times \text{Dostęp do antykoncepcji}</span></p>
<p>Teraz widzimy, że związek wykształcenia jest słabszy (-0,15 zamiast -0,3) po uwzględnieniu zamieszkania w mieście i dostępu do antykoncepcji. To sugeruje, że część pozornego efektu wykształcenia działa przez te inne ścieżki.</p>
</section>
</section>
<section id="typy-zmiennych-w-regresji" class="level3">
<h3 class="anchored" data-anchor-id="typy-zmiennych-w-regresji">Typy zmiennych w regresji</h3>
<section id="zmienna-wynikowa-zależna" class="level4">
<h4 class="anchored" data-anchor-id="zmienna-wynikowa-zależna">Zmienna wynikowa (zależna)</h4>
<p>To jest to, co próbujemy zrozumieć lub przewidzieć:</p>
<ul>
<li>Dochód w naszym pierwszym przykładzie</li>
<li>Liczba dzieci w naszym przykładzie płodności</li>
<li>Oczekiwana długość życia w badaniach zdrowotnych</li>
<li>Prawdopodobieństwo migracji w badaniach populacyjnych</li>
</ul>
</section>
<section id="zmienne-predykcyjne-niezależne" class="level4">
<h4 class="anchored" data-anchor-id="zmienne-predykcyjne-niezależne">Zmienne predykcyjne (niezależne)</h4>
<p>To są czynniki, które według nas mogą wpływać na wynik:</p>
<ul>
<li><strong>Ilościowe</strong>: Wiek, lata wykształcenia, dochód, odległość</li>
<li><strong>Jakościowe (kategorialne)</strong>: Płeć, rasa, stan cywilny, region</li>
<li><strong>Binarne (dummy)</strong>: Miasto/wieś, zatrudniony/bezrobotny, żonaty/nieżonaty</li>
</ul>
<p><strong>Obsługa zmiennych kategorialnych</strong>: Nie możemy bezpośrednio wstawić „religii” do równania. Zamiast tego tworzymy zmienne binarne:</p>
<ul>
<li>Chrześcijanin = 1 jeśli chrześcijanin, 0 w przeciwnym razie</li>
<li>Muzułmanin = 1 jeśli muzułmanin, 0 w przeciwnym razie</li>
<li>Buddysta = 1 jeśli buddysta, 0 w przeciwnym razie</li>
<li>(Jedna kategoria staje się grupą referencyjną)</li>
</ul>
</section>
</section>
<section id="różne-typy-regresji-dla-różnych-wyników" class="level3">
<h3 class="anchored" data-anchor-id="różne-typy-regresji-dla-różnych-wyników">Różne typy regresji dla różnych wyników</h3>
<p>Podstawowa idea regresji dostosowuje się do wielu sytuacji:</p>
<section id="regresja-liniowa" class="level4">
<h4 class="anchored" data-anchor-id="regresja-liniowa">Regresja liniowa</h4>
<p>Dla wyników ilościowych (dochód, wzrost, ciśnienie krwi): <span class="math display">Y = a + b_1X_1 + b_2X_2 + … + \text{błąd}</span></p>
</section>
<section id="regresja-logistyczna" class="level4">
<h4 class="anchored" data-anchor-id="regresja-logistyczna">Regresja logistyczna</h4>
<p>Dla wyników binarnych (zmarł/przeżył, wyemigrował/został, żonaty/nieżonaty):</p>
<p>Zamiast przewidywać wynik bezpośrednio, przewidujemy prawdopodobieństwo: <span class="math display">\log\left(\frac{p}{1-p}\right) = a + b_1X_1 + b_2X_2 + …</span></p>
<p>Gdzie <span class="math inline">p</span> to prawdopodobieństwo wystąpienia zdarzenia.</p>
<p><strong>Przykład</strong>: Przewidywanie prawdopodobieństwa migracji na podstawie wieku, wykształcenia i stanu cywilnego. Model może stwierdzić, że młodzi, wykształceni, nieżonaci ludzie mają 40% prawdopodobieństwo migracji, podczas gdy starsi, mniej wykształceni, żonaci ludzie mają tylko 5% prawdopodobieństwo.</p>
</section>
<section id="regresja-poissona" class="level4">
<h4 class="anchored" data-anchor-id="regresja-poissona">Regresja Poissona</h4>
<p>Dla wyników “zliczeniowych”/count data (liczba dzieci, liczba wizyt u lekarza): <span class="math display">\log(\text{oczekiwana liczba}) = a + b_1X_1 + b_2X_2 + …</span></p>
<p><strong>Przykład</strong>: Modelowanie liczby dzieci na podstawie charakterystyk kobiet. Przydatne, ponieważ zapewnia, że przewidywania nigdy nie są ujemne (nie można mieć -0,5 dziecka!).</p>
</section>
<section id="analiza-przeżycia-model-coxaregresja-hazardu" class="level4">
<h4 class="anchored" data-anchor-id="analiza-przeżycia-model-coxaregresja-hazardu">Analiza przeżycia (model Coxa)/Regresja hazardu</h4>
<p><strong>Do czego służy:</strong> Przewidywanie <em>kiedy</em> coś się stanie, nie tylko <em>czy</em> się stanie.</p>
<p><strong>Problem:</strong> Wyobraź sobie, że badasz jak długo trwają małżeństwa. Obserwujesz 1000 par przez 10 lat, ale na koniec badania: - 400 par się rozwiodło (wiesz dokładnie kiedy) - 600 par jest nadal w małżeństwie (nie wiesz czy/kiedy się rozwiodą)</p>
<p>Zwykła regresja nie radzi sobie z tym problemem “niekompletnej historii” — te 600 trwających małżeństw zawiera cenne informacje, ale nie znamy jeszcze ich zakończenia.</p>
<p><strong>Jak pomagają modele Coxa:</strong> Zamiast próbować przewidzieć dokładny moment, skupiają się na <em>ryzyku względnym</em> — kto ma większą szansę na wcześniejsze doświadczenie zdarzenia. To jak pytanie “W dowolnym momencie, kto jest bardziej narażony?” zamiast “Dokładnie kiedy to się stanie?”</p>
<p><strong>Zastosowania praktyczne:</strong> - Badania medyczne: Kto szybciej reaguje na leczenie? - Biznes: Którzy klienci wcześniej rezygnują z subskrypcji? - Nauki społeczne: Jakie czynniki powodują, że wydarzenia życiowe następują wcześniej/później?</p>
<hr>
</section>
</section>
<section id="interpretacja-wyników-regresji" class="level3">
<h3 class="anchored" data-anchor-id="interpretacja-wyników-regresji">Interpretacja wyników regresji</h3>
<section id="współczynniki" class="level4">
<h4 class="anchored" data-anchor-id="współczynniki">Współczynniki</h4>
<p>Współczynnik mówi nam o oczekiwanej zmianie wyniku przy wzroście predyktora o jedną jednostkę, przy zachowaniu stałości innych zmiennych.</p>
<p><strong>Przykłady interpretacji:</strong></p>
<p>Regresja liniowa dla dochodu:</p>
<ul>
<li>„Każdy dodatkowy rok wykształcenia jest związany z 3500 zł wyższym rocznym dochodem, kontrolując wiek i doświadczenie”</li>
</ul>
<p>Regresja logistyczna dla śmiertelności niemowląt:</p>
<ul>
<li>„Każda dodatkowa wizyta prenatalna jest związana z 15% niższymi szansami śmierci niemowlęcia, kontrolując wiek i wykształcenie matki”</li>
</ul>
<p>Regresja wieloraka dla oczekiwanej długości życia:</p>
<ul>
<li>„Każde 1000 USD wzrostu PKB per capita jest związane z 0,4 roku dłuższą oczekiwaną długością życia, po kontroli wykształcenia i dostępu do opieki zdrowotnej”</li>
</ul>
</section>
<section id="istotność-statystyczna" class="level4">
<h4 class="anchored" data-anchor-id="istotność-statystyczna">Istotność statystyczna</h4>
<p>Regresja testuje również, czy relacje mogą wynikać z przypadku:</p>
<ul>
<li><strong>wartość p &lt; 0,05</strong>: Relacja nieprawdopodobna z powodu przypadku (statystycznie istotna)</li>
<li><strong>wartość p &gt; 0,05</strong>: Relacja może być prawdopodobnie losową zmiennością</li>
</ul>
<blockquote class="blockquote">
<p>Ale pamiętaj: Istotność statystyczna ≠ praktyczne znaczenie (“praktyczna istotność”). Przy dużych próbach malutkie efekty stają się „istotne”.</p>
</blockquote>
</section>
<section id="przedziały-ufności-dla-współczynników" class="level4">
<h4 class="anchored" data-anchor-id="przedziały-ufności-dla-współczynników">Przedziały ufności dla współczynników</h4>
<p>Tak jak mamy przedziały ufności dla średnich lub propocji, mamy je dla współczynników regresji:</p>
<p>„Efekt wykształcenia na dochód wynosi 3500 zł rocznie, 95% CI: [2800 zł, 4200 zł]”</p>
<p>To oznacza, że jesteśmy 95% pewni, że prawdziwy efekt mieści się między 2800 zł a 4200 zł.</p>
</section>
<section id="r-kwadrat-jak-dobrze-model-pasuje-do-danych" class="level4">
<h4 class="anchored" data-anchor-id="r-kwadrat-jak-dobrze-model-pasuje-do-danych">R-kwadrat: Jak dobrze model pasuje do danych?</h4>
<p><span class="math inline">R^2</span> (R-kwadrat) mierzy proporcję zmienności wyniku wyjaśnioną przez predyktory:</p>
<ul>
<li><span class="math inline">R^2 = 0</span>: Predyktory nic nie wyjaśniają</li>
<li><span class="math inline">R^2 = 1</span>: Predyktory wyjaśniają wszystko</li>
<li><span class="math inline">R^2 = 0,3</span>: Predyktory wyjaśniają 30% zmienności</li>
</ul>
<p><strong>Przykład</strong>: Model dochodu z tylko wykształceniem może mieć <span class="math inline">R^2 = 0,15</span> (wykształcenie wyjaśnia 15% zmienności dochodu). Dodanie wieku, doświadczenia i lokalizacji może zwiększyć <span class="math inline">R^2</span> do 0,35 (razem wyjaśniają 35%).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Założenia i ograniczenia
</div>
</div>
<div class="callout-body-container callout-body">
<p>Regresja opiera się na założeniach, które mogą nie być spełnione:</p>
<section id="egzogeniczność-brak-ukrytych-zależności" class="level4">
<h4 class="anchored" data-anchor-id="egzogeniczność-brak-ukrytych-zależności">Egzogeniczność (brak ukrytych zależności)</h4>
<p>Najważniejsze założenie: predyktory nie mogą być skorelowane z błędami. Prościej mówiąc, nie powinny istnieć ukryte czynniki wpływające jednocześnie na zmienne objaśniające i wynik.</p>
<p><strong>Przykład</strong>: Badając wpływ edukacji na dochód, ale pomijając “zdolności”, otrzymasz obciążone wyniki - zdolności wpływają zarówno na poziom wykształcenia, jak i dochód. To założenie zapisujemy jako: <span class="math inline">E[\varepsilon | X] = 0</span></p>
<p><strong>Dlaczego to kluczowe</strong>: Bez tego wszystkie twoje współczynniki są błędne, nawet przy milionach obserwacji!</p>
</section>
<section id="liniowość" class="level4">
<h4 class="anchored" data-anchor-id="liniowość">Liniowość</h4>
<p>Zakłada związki prostoliniowe. A co jeśli wpływ edukacji na dochód jest silniejszy na wyższych poziomach? Możemy dodać człony wielomianowe: <span class="math display">\text{Dochód} = a + b_1 \times \text{Edukacja} + b_2 \times \text{Edukacja}^2</span></p>
</section>
<section id="niezależność-1" class="level4">
<h4 class="anchored" data-anchor-id="niezależność-1">Niezależność</h4>
<p>Zakłada, że obserwacje są niezależne. Ale członkowie rodziny mogą być podobni, powtarzane pomiary tej samej osoby są powiązane, a sąsiedzi mogą na siebie wpływać. Specjalne metody radzą sobie z tymi zależnościami.</p>
</section>
<section id="homoskedastyczność" class="level4">
<h4 class="anchored" data-anchor-id="homoskedastyczność">Homoskedastyczność</h4>
<p>Zakłada stałą wariancję błędów. Ale błędy predykcji mogą być większe dla osób o wysokich dochodach niż niskich. Wykresy diagnostyczne pomagają to wykryć.</p>
</section>
<section id="normalność" class="level4">
<h4 class="anchored" data-anchor-id="normalność">Normalność</h4>
<p>Zakłada, że błędy mają rozkład normalny. Ważne dla małych prób i testów hipotez, mniej krytyczne dla dużych prób.</p>
<p><strong>Uwaga</strong>: Pierwsze założenie (egzogeniczność) dotyczy otrzymania poprawnej odpowiedzi. Pozostałe dotyczą głównie precyzji i wnioskowania statystycznego. Naruszenie egzogeniczności oznacza, że model jest fundamentalnie błędny; naruszenie pozostałych oznacza, że przedziały ufności i p-wartości mogą być niedokładne.</p>
</section>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Częste pułapki statystyczne
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Endogeniczność (obciążenie pominiętą zmienną)</strong>: Zapominanie o ukrytych czynnikach wpływających zarówno na X jak i Y, co narusza fundamentalne założenie egzogeniczności. <em>Przykład</em>: Badanie edukacja→dochód bez uwzględnienia zdolności.</p></li>
<li><p><strong>Symultaniczność/Odwrotna przyczynowość</strong>: Gdy X i Y określają się wzajemnie w tym samym czasie. Prosta regresja zakłada jednokierunkową przyczynowość, ale rzeczywistość często jest dwukierunkowa. <em>Przykład</em>: Cena wpływa na popyt ORAZ popyt wpływa na cenę jednocześnie.</p></li>
<li><p><strong>Zmienne zakłócające (confounding)</strong>: Nieuwzględnienie zmiennych wpływających zarówno na predyktor jak i wynik, co prowadzi do pozornych zależności. <em>Przykład</em>: Sprzedaż lodów koreluje z utonięciami (oba powodowane przez lato).</p></li>
<li><p><strong>Błąd selekcji</strong>: Nielosowe próby systematycznie wykluczające pewne grupy, uniemożliwiające generalizację. <em>Przykład</em>: Badanie użycia internetu tylko wśród posiadaczy smartfonów.</p></li>
<li><p><strong>Błąd ekologiczny</strong>: Zakładanie, że wzorce grupowe dotyczą jednostek. <em>Przykład</em>: Bogate kraje mają niższą dzietność ≠ bogaci ludzie mają mniej dzieci.</p></li>
<li><p><strong>P-hacking (drążenie danych)</strong>: Testowanie wielu hipotez aż do znalezienia istotności, lub modyfikowanie analizy aż p &lt; 0,05. Przy 20 testach spodziewasz się 1 fałszywego wyniku przez przypadek!</p></li>
<li><p><strong>Przeuczenie (overfitting)</strong>: Budowanie modelu zbyt złożonego dla twoich danych - idealny na danych treningowych, bezużyteczny do predykcji. <em>Pamiętaj</em>: Z wystarczającą liczbą parametrów możesz dopasować słonia.</p></li>
<li><p><strong>Błąd przetrwania</strong>: Analizowanie tylko “ocalałych” ignorując porażki. <em>Przykład</em>: Badanie firm sukcesu pomijając te, które zbankrutowały.</p></li>
<li><p><strong>Nadmierna generalizacja</strong>: Rozszerzanie wniosków poza badaną populację, okres czasu lub kontekst. <em>Przykład</em>: Wyniki z amerykańskich studentów ≠ uniwersalne zachowanie ludzkie.</p></li>
</ol>
<p><strong>Pamiętaj</strong>: Pierwsze trzy to formy <strong>endogeniczności</strong> - naruszają <span class="math inline">E[\varepsilon|X]=0</span> i sprawiają, że współczynniki są <em>fundamentalnie błędne</em>. Pozostałe czynią wyniki <em>mylącymi</em> lub <em>niereprezentatywnymi</em>.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="zastosowania-w-demografii" class="level3">
<h3 class="anchored" data-anchor-id="zastosowania-w-demografii">Zastosowania w demografii</h3>
<section id="analiza-płodności" class="level4">
<h4 class="anchored" data-anchor-id="analiza-płodności">Analiza płodności</h4>
<p>Zrozumienie, jakie czynniki wpływają na decyzje o płodności: <span class="math display">\text{Dzieci} = f(\text{Wykształcenie, Dochód, Miasto, Religia, Antykoncepcja, …})</span></p>
<p>Pomaga zidentyfikować dźwignie polityczne dla krajów zaniepokojonych wysoką lub niską płodnością.</p>
</section>
<section id="modelowanie-śmiertelności" class="level4">
<h4 class="anchored" data-anchor-id="modelowanie-śmiertelności">Modelowanie śmiertelności</h4>
<p>Przewidywanie oczekiwanej długości życia lub ryzyka śmiertelności: <span class="math display">\text{Ryzyko śmiertelności} = f(\text{Wiek, Płeć, Palenie, Wykształcenie, Dostęp do opieki zdrowotnej, …})</span></p>
<p>Używane przez firmy ubezpieczeniowe, urzędników zdrowia publicznego i badaczy.</p>
</section>
<section id="przewidywanie-migracji" class="level4">
<h4 class="anchored" data-anchor-id="przewidywanie-migracji">Przewidywanie migracji</h4>
<p>Zrozumienie, kto migruje i dlaczego: <span class="math display">P(\text{Migracja}) = f(\text{Wiek, Wykształcenie, Zatrudnienie, Więzi rodzinne, Odległość, …})</span></p>
<p>Pomaga przewidywać przepływy populacji i planować zmiany demograficzne.</p>
</section>
<section id="małżeństwo-i-rozwód" class="level4">
<h4 class="anchored" data-anchor-id="małżeństwo-i-rozwód">Małżeństwo i rozwód</h4>
<p>Analizowanie formowania i rozpadu związków: <span class="math display">P(\text{Rozwód}) = f(\text{Wiek przy małżeństwie, Dopasowanie wykształcenia, Dochód, Dzieci, Czas trwania, …})</span></p>
<p>Informuje politykę społeczną i usługi wsparcia.</p>
</section>
</section>
<section id="powszechne-pułapki-i-jak-ich-unikać" class="level3">
<h3 class="anchored" data-anchor-id="powszechne-pułapki-i-jak-ich-unikać">Powszechne pułapki i jak ich unikać</h3>
<section id="przeuczenie-overfitting" class="level4">
<h4 class="anchored" data-anchor-id="przeuczenie-overfitting">Przeuczenie (Overfitting)</h4>
<p>Włączenie zbyt wielu predyktorów może sprawić, że model idealnie pasuje do twojej próby, ale zawiedzie z nowymi danymi. Jak zapamiętywanie odpowiedzi na egzamin zamiast zrozumienia pojęć.</p>
<p><strong>Rozwiązanie</strong>: Użyj prostszych modeli, walidacji krzyżowej lub zarezerwuj niektóre dane do testowania.</p>
</section>
<section id="współliniowość-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="współliniowość-multicollinearity">Współliniowość (Multicollinearity)</h4>
<p>Gdy predyktory są silnie skorelowane (np. lata wykształcenia i poziom stopnia), model nie może oddzielić ich efektów.</p>
<p><strong>Rozwiązanie</strong>: Wybierz jedną zmienną lub połącz je w indeks.</p>
</section>
<section id="obciążenie-pominiętej-zmiennej-omitted-variable-bias" class="level4">
<h4 class="anchored" data-anchor-id="obciążenie-pominiętej-zmiennej-omitted-variable-bias">Obciążenie pominiętej zmiennej (Omitted Variable Bias)</h4>
<p>Pominięcie ważnych zmiennych może sprawić, że inne efekty wydają się silniejsze lub słabsze niż naprawdę są.</p>
<p><strong>Przykład</strong>: Relacja między sprzedażą lodów a wskaźnikami przestępczości znika, gdy kontrolujesz temperaturę.</p>
</section>
<section id="ekstrapolacja" class="level4">
<h4 class="anchored" data-anchor-id="ekstrapolacja">Ekstrapolacja</h4>
<p>Używanie modelu poza zakresem obserwowanych danych.</p>
<p><strong>Przykład</strong>: Jeśli twoje dane obejmują wykształcenie od 0-20 lat, nie przewiduj dochodu dla kogoś z 30 latami wykształcenia.</p>
</section>
</section>
<section id="intuicje" class="level3">
<h3 class="anchored" data-anchor-id="intuicje">Intuicje</h3>
<p>Pomyśl o regresji jako o wyrafinowanej technice uśredniania:</p>
<ul>
<li><strong>Prosta średnia</strong>: „Średni dochód wynosi 50 000 zł”</li>
<li><strong>Średnia warunkowa</strong>: „Średni dochód dla absolwentów uczelni wynosi 70 000 zł”</li>
<li><strong>Regresja</strong>: „Średni dochód dla 35-letnich absolwentów uczelni w obszarach miejskich wynosi 78 000 zł”</li>
</ul>
<p>Każda dodana zmienna czyni nasze przewidywanie bardziej konkretnym i (miejmy nadzieję) dokładniejszym.</p>
</section>
<section id="regresja-w-praktyce-kompletny-przykład" class="level3">
<h3 class="anchored" data-anchor-id="regresja-w-praktyce-kompletny-przykład">Regresja w praktyce: Kompletny przykład</h3>
<p><strong>Pytanie badawcze</strong>: Jakie czynniki wpływają na wiek przy pierwszym porodzie?</p>
<p><strong>Dane</strong>: Badanie 1000 kobiet, które miały co najmniej jedno dziecko</p>
<p><strong>Zmienne</strong>:</p>
<ul>
<li>Wynik: Wiek przy pierwszym porodzie (lata)</li>
<li>Predyktory: Wykształcenie (lata), Miasto (0/1), Dochód (tysiące), Religijność (0/1)</li>
</ul>
<p><strong>Wynik prostej regresji</strong>: <span class="math display">\text{Wiek przy pierwszym porodzie} = 18 + 0,8 \times \text{Wykształcenie}</span></p>
<p>Interpretacja: Każdy rok wykształcenia związany z 0,8 roku późniejszym pierwszym porodem.</p>
<p><strong>Wynik regresji wielorakiej</strong>: <span class="math display">\text{Wiek przy pierwszym porodzie} = 16 + 0,5 \times \text{Wykształcenie} + 2 \times \text{Miasto} + 0,03 \times \text{Dochód} - 1,5 \times \text{Religijność}</span></p>
<p>Interpretacja:</p>
<ul>
<li>Efekt wykształcenia zredukowany, ale nadal dodatni (0,5 roku na rok wykształcenia)</li>
<li>Kobiety miejskie mają pierwsze porody 2 lata później</li>
<li>Każde 1000 zł dochodu związane z 0,03 roku (11 dni) później</li>
<li>Religijne kobiety mają pierwsze porody 1,5 roku wcześniej</li>
<li><span class="math inline">R^2 = 0,42</span> (model wyjaśnia 42% zmienności)</li>
</ul>
<p>Ten bogatszy model pomaga nam zrozumieć, że efekt wykształcenia częściowo działa przez zamieszkanie w mieście i dochód.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Regresja jest bramą do zaawansowanego modelowania statystycznego. Gdy zrozumiesz podstawową koncepcję — używanie zmiennych do przewidywania wyników i kwantyfikowania relacji — możesz eksplorować:</p>
<ul>
<li><strong>Efekty interakcji</strong>: Gdy efekt jednej zmiennej zależy od innej</li>
<li><strong>Relacje nieliniowe</strong>: Krzywe, progi i złożone wzorce</li>
<li><strong>Modele wielopoziomowe</strong>: Uwzględnianie zgrupowanych danych (uczniowie w szkołach, ludzie w dzielnicach)</li>
<li><strong>Regresja szeregów czasowych</strong>: Analizowanie zmian w czasie</li>
<li><strong>Rozszerzenia uczenia maszynowego</strong>: Lasy losowe, sieci neuronowe i więcej</li>
</ul>
<p>Kluczowy wgląd pozostaje: Próbujemy zrozumieć, jak rzeczy odnoszą się do siebie w systematyczny, kwantyfikowalny sposób.</p>
</div>
</div>
</section>
</section>
<section id="jakość-i-źródła-danych" class="level2" data-number="2.14">
<h2 data-number="2.14" class="anchored" data-anchor-id="jakość-i-źródła-danych"><span class="header-section-number">2.14</span> Jakość i źródła danych</h2>
<p>Żadna analiza nie jest lepsza niż dane, na których się opiera. Zrozumienie problemów jakości danych jest kluczowe dla badań demograficznych i społecznych.</p>
<section id="wymiary-jakości-danych" class="level3">
<h3 class="anchored" data-anchor-id="wymiary-jakości-danych">Wymiary jakości danych</h3>
<p><strong>Dokładność (Accuracy)</strong>: Jak blisko pomiarów są prawdziwe wartości?</p>
<p>Przykład: Raportowanie wieku często pokazuje „skupianie” na okrągłych liczbach (30, 40, 50), ponieważ ludzie zaokrąglają swój wiek.</p>
<p><strong>Kompletność (Completeness)</strong>: Jaka proporcja populacji jest objęta?</p>
<p>Przykład: Kompletność rejestracji urodzeń różni się znacznie:</p>
<ul>
<li>Kraje rozwinięte: &gt;99%</li>
<li>Niektóre kraje rozwijające się: &lt;50%</li>
</ul>
<p><strong>Aktualność (Timeliness)</strong>: Jak aktualne są dane?</p>
<p>Przykład: Spis przeprowadzany co 10 lat staje się coraz bardziej nieaktualny, szczególnie w szybko zmieniających się obszarach.</p>
<p><strong>Spójność (Consistency)</strong>: Czy definicje i metody są stabilne w czasie i przestrzeni?</p>
<p>Przykład: Definicja „miasta” różni się między krajami, utrudniając międzynarodowe porównania.</p>
<p><strong>Dostępność (Accessibility)</strong>: Czy badacze i decydenci mogą faktycznie używać danych?</p>
</section>
<section id="powszechne-źródła-danych-w-demografii" class="level3">
<h3 class="anchored" data-anchor-id="powszechne-źródła-danych-w-demografii">Powszechne źródła danych w demografii</h3>
<p><strong>Spis powszechny (Census)</strong>: Kompletne wyliczenie populacji</p>
<p><em>Zalety:</em></p>
<ul>
<li>Kompletne pokrycie (w teorii)</li>
<li>Dane dla małych obszarów dostępne</li>
<li>Punkt odniesienia dla innych oszacowań</li>
</ul>
<p><em>Wady:</em></p>
<ul>
<li>Drogie i rzadkie</li>
<li>Niektóre populacje trudne do policzenia</li>
<li>Ograniczone zbierane zmienne</li>
</ul>
<p><strong>Rejestry urzędu stanu cywilnego (Vital Registration)</strong>: Ciągłe rejestrowanie urodzeń, zgonów, małżeństw</p>
<p><em>Zalety:</em></p>
<ul>
<li>Ciągłe i aktualne</li>
<li>Wymóg prawny zapewnia zgodność</li>
<li>Informacje o medycznej przyczynie śmierci</li>
</ul>
<p><em>Wady:</em></p>
<ul>
<li>Pokrycie różni się według poziomu rozwoju</li>
<li>Jakość kodowania przyczyny śmierci się różni</li>
<li>Opóźniona rejestracja powszechna w niektórych obszarach</li>
</ul>
<p><strong>Badania próbkowe (Sample Surveys)</strong>: Szczegółowe dane z podzbioru populacji</p>
<p><em>Przykłady:</em></p>
<ul>
<li>Badania demograficzne i zdrowotne (DHS)</li>
<li>Amerykańskie Badanie Społeczności (ACS)</li>
<li>Badania Siły Roboczej (np. BAEL GUS)</li>
</ul>
<p><em>Zalety:</em></p>
<ul>
<li>Można zbierać szczegółowe informacje</li>
<li>Częstsze niż spis</li>
<li>Można skupić się na konkretnych tematach</li>
</ul>
<p><em>Wady:</em></p>
<ul>
<li>Obecny błąd próbkowania</li>
<li>Małe obszary niereprezentowane</li>
<li>Obciążenie odpowiedzi może zmniejszyć jakość</li>
</ul>
<p><strong>Rejestry administracyjne (Administrative Records)</strong>: Dane zbierane do celów niestatystycznych</p>
<p><em>Przykłady:</em></p>
<ul>
<li>Rejestry podatkowe</li>
<li>Zapisy szkolne</li>
<li>Roszczenia ubezpieczenia zdrowotnego</li>
<li>Dane telefonii komórkowej</li>
</ul>
<p><em>Zalety:</em></p>
<ul>
<li>Już zebrane (bez dodatkowego obciążenia)</li>
<li>Często kompletne dla objętej populacji</li>
<li>Ciągle aktualizowane</li>
</ul>
<p><em>Wady:</em></p>
<ul>
<li>Pokrycie może być selektywne</li>
<li>Definicje mogą nie odpowiadać potrzebom badawczym</li>
<li>Dostęp często ograniczony</li>
</ul>
</section>
<section id="problemy-jakości-danych-specyficzne-dla-demografii" class="level3">
<h3 class="anchored" data-anchor-id="problemy-jakości-danych-specyficzne-dla-demografii">Problemy jakości danych specyficzne dla demografii</h3>
<p><strong>Skupianie wieku (Age Heaping)</strong>: Tendencja do raportowania wieku kończącego się na 0 lub 5</p>
<p><em>Wykrywanie</em>: Oblicz Indeks Whipple’a lub Indeks Myersa</p>
<p><em>Wpływ</em>: Wpływa na wskaźniki specyficzne dla wieku i projekcje</p>
<p><strong>Preferencja cyfr (Digit Preference)</strong>: Raportowanie niektórych końcowych cyfr częściej niż innych</p>
<p><em>Przykład</em>: Wagi urodzeniowe często raportowane jako 3000g, 3500g zamiast dokładnych wartości</p>
<p><strong>Obciążenie przypominania (Recall Bias)</strong>: Trudność dokładnego przypominania przeszłych wydarzeń</p>
<p><em>Przykład</em>: „Ile razy odwiedziłeś lekarza w zeszłym roku?” Często niedoszacowane dla częstych odwiedzających, przeszacowane dla rzadkich odwiedzających.</p>
<p><strong>Raportowanie przez pełnomocnika (Proxy Reporting)</strong>: Informacje dostarczane przez kogoś innego</p>
<p><em>Wyzwanie</em>: Głowa gospodarstwa domowego raportująca za wszystkich członków może nie znać dokładnego wieku lub wykształcenia każdego</p>
</section>
</section>
<section id="względy-etyczne-w-demografii-statystycznej" class="level2" data-number="2.15">
<h2 data-number="2.15" class="anchored" data-anchor-id="względy-etyczne-w-demografii-statystycznej"><span class="header-section-number">2.15</span> Względy etyczne w demografii statystycznej</h2>
<p>Statystyka to nie tylko liczby — dotyczy prawdziwych ludzi i ma prawdziwe konsekwencje.</p>
<section id="świadoma-zgoda" class="level3">
<h3 class="anchored" data-anchor-id="świadoma-zgoda">Świadoma zgoda</h3>
<p>Uczestnicy powinni zrozumieć:</p>
<ul>
<li>Cel zbierania danych</li>
<li>Jak dane będą używane</li>
<li>Ryzyka i korzyści</li>
<li>Ich prawo do odmowy lub wycofania się</li>
</ul>
<p><strong>Wyzwanie w demografii</strong>: Uczestnictwo w spisie jest często obowiązkowe, co rodzi pytania etyczne o zgodę.</p>
</section>
<section id="poufność-i-prywatność" class="level3">
<h3 class="anchored" data-anchor-id="poufność-i-prywatność">Poufność i prywatność</h3>
<p><strong>Statystyczna kontrola ujawniania</strong>: Ochrona tożsamości jednostek w opublikowanych danych</p>
<p>Metody obejmują:</p>
<ul>
<li>Tłumienie małych komórek (np. „&lt;5” zamiast „2”)</li>
<li>Agregacja geograficzna</li>
</ul>
<p><strong>Przykład</strong>: W tabeli zawodu według wieku według płci dla małego miasta może być tylko jedna lekarka w wieku 60-65 lat, co czyni ją identyfikowalną.</p>
</section>
<section id="reprezentacja-i-uczciwość" class="level3">
<h3 class="anchored" data-anchor-id="reprezentacja-i-uczciwość">Reprezentacja i uczciwość</h3>
<p><strong>Kto jest liczony?</strong>: Decyzje o tym, kogo uwzględnić, wpływają na reprezentację</p>
<ul>
<li>Więźniowie: Gdzie są liczeni — lokalizacja więzienia czy adres domowy?</li>
<li>Bezdomni: Jak zapewnić pokrycie?</li>
<li>Nieudokumentowani imigranci: Uwzględnić czy wykluczyć?</li>
</ul>
<p><strong>Prywatność różnicowa (Differential Privacy)</strong>: Matematyczna struktura ochrony prywatności przy zachowaniu użyteczności statystycznej</p>
<p>Kompromis: Większa ochrona prywatności = mniej dokładne statystyki</p>
</section>
<section id="niewłaściwe-użycie-statystyk" class="level3">
<h3 class="anchored" data-anchor-id="niewłaściwe-użycie-statystyk">Niewłaściwe użycie statystyk</h3>
<p><strong>Wybieranie wisienek (Cherry-Picking)</strong>: Wybieranie tylko korzystnych wyników</p>
<p>Przykład: Raportowanie spadku ciąż nastolatek od roku szczytowego zamiast pokazywania pełnego trendu</p>
<p><strong>P-Hacking</strong>: Manipulowanie analizą w celu osiągnięcia istotności statystycznej</p>
<p><strong>Błąd ekologiczny</strong>: Wnioskowanie relacji indywidualnych z danych grupowych</p>
<p>Przykład: Powiaty z większą liczbą imigrantów mają wyższe średnie dochody ≠ imigranci mają wyższe dochody</p>
</section>
<section id="odpowiedzialne-raportowanie" class="level3">
<h3 class="anchored" data-anchor-id="odpowiedzialne-raportowanie">Odpowiedzialne raportowanie</h3>
<p><strong>Komunikacja niepewności</strong>: Zawsze raportuj przedziały ufności lub marginesy błędu</p>
<p><strong>Dostarczanie kontekstu</strong>: Uwzględnij odpowiednie grupy porównawcze i trendy historyczne</p>
<p><strong>Uznanie ograniczeń</strong>: Jasno określ, co dane mogą i nie mogą pokazać</p>
</section>
</section>
<section id="powszechne-nieporozumienia-w-statystyce" class="level2" data-number="2.16">
<h2 data-number="2.16" class="anchored" data-anchor-id="powszechne-nieporozumienia-w-statystyce"><span class="header-section-number">2.16</span> Powszechne nieporozumienia w statystyce</h2>
<p>Zrozumienie, czym statystyka NIE jest, jest równie ważne jak zrozumienie, czym jest.</p>
<section id="nieporozumienie-1-statystyki-mogą-udowodnić-wszystko" class="level3">
<h3 class="anchored" data-anchor-id="nieporozumienie-1-statystyki-mogą-udowodnić-wszystko">Nieporozumienie 1: „Statystyki mogą udowodnić wszystko”</h3>
<p><strong>Rzeczywistość</strong>: Statystyki mogą dostarczyć tylko dowodów, nigdy absolutnego dowodu. A właściwa statystyka, uczciwie zastosowana, znacznie ogranicza wnioski.</p>
<p><strong>Przykład</strong>: Badanie znajduje korelację między sprzedażą lodów a utopieniami. Statystyka nie „dowodzi”, że lody powodują utopienia — oba są związane z letnią pogodą.</p>
</section>
<section id="nieporozumienie-2-większe-próby-są-zawsze-lepsze" class="level3">
<h3 class="anchored" data-anchor-id="nieporozumienie-2-większe-próby-są-zawsze-lepsze">Nieporozumienie 2: „Większe próby są zawsze lepsze”</h3>
<p><strong>Rzeczywistość</strong>: Poza pewnym punktem większe próby dodają niewiele precyzji, ale mogą dodać obciążenie.</p>
<p><strong>Przykład</strong>: Ankieta online z 1 milionem odpowiedzi może być mniej dokładna niż próba probabilistyczna 1000 osób z powodu obciążenia samoselekcji.</p>
<p><strong>Malejące zyski</strong>:</p>
<ul>
<li><span class="math inline">n = 100</span>: Margines błędu <span class="math inline">\approx 10%</span></li>
<li><span class="math inline">n = 1000</span>: Margines błędu <span class="math inline">\approx 3,2%</span></li>
<li><span class="math inline">n = 10 000</span>: Margines błędu <span class="math inline">\approx 1%</span></li>
<li><span class="math inline">n = 100 000</span>: Margines błędu <span class="math inline">\approx 0,32%</span></li>
</ul>
<p>Skok z 10 000 do 100 000 ledwo poprawia precyzję, ale kosztuje <span class="math inline">10\times</span> więcej.</p>
</section>
<section id="nieporozumienie-3-istotność-statystyczna-praktyczne-znaczenie" class="level3">
<h3 class="anchored" data-anchor-id="nieporozumienie-3-istotność-statystyczna-praktyczne-znaczenie">Nieporozumienie 3: “Istotność statystyczna = Praktyczne znaczenie”</h3>
<p><strong>Rzeczywistość</strong>: Przy dużych próbach malutkie różnice stają się „statystycznie istotne”, nawet jeśli są bez znaczenia.</p>
<p><strong>Przykład</strong>: Badanie 100 000 osób stwierdza, że mężczyźni są średnio o 0,1 cm wyżsi (p &lt; 0,001). Statystycznie istotne, ale praktycznie nieistotne.</p>
</section>
<section id="nieporozumienie-4-korelacja-implikuje-przyczynowość" class="level3">
<h3 class="anchored" data-anchor-id="nieporozumienie-4-korelacja-implikuje-przyczynowość">Nieporozumienie 4: “Korelacja implikuje przyczynowość”</h3>
<p><strong>Rzeczywistość</strong>: Korelacja jest konieczna, ale niewystarczająca dla przyczynowości.</p>
<p><strong>Klasyczne przykłady</strong>:</p>
<ul>
<li>Miasta z większą liczbą kościołów mają więcej przestępstw (oba korelują z wielkością populacji)</li>
<li>Kraje z większą liczbą telewizorów mają dłuższą oczekiwaną długość życia (oba korelują z rozwojem)</li>
</ul>
</section>
<section id="nieporozumienie-5-losowy-oznacza-przypadkowy" class="level3">
<h3 class="anchored" data-anchor-id="nieporozumienie-5-losowy-oznacza-przypadkowy">Nieporozumienie 5: “Losowy oznacza przypadkowy”</h3>
<p><strong>Rzeczywistość</strong>: Statystyczna losowość jest starannie kontrolowana i systematyczna.</p>
<p><strong>Przykład</strong>: Losowe próbkowanie wymaga starannej procedury, a nie tylko chwytania kogokolwiek wygodnego.</p>
</section>
<section id="nieporozumienie-6-średnia-reprezentuje-wszystkich" class="level3">
<h3 class="anchored" data-anchor-id="nieporozumienie-6-średnia-reprezentuje-wszystkich">Nieporozumienie 6: “Średnia reprezentuje wszystkich”</h3>
<p><strong>Rzeczywistość</strong>: Średnie mogą być mylące, gdy rozkłady są skośne lub wielomodalne.</p>
<p><strong>Przykład</strong>: Średni dochód bywalców baru wynosi 50 000 zł. Bill Gates wchodzi. Teraz średnia wynosi 1 milion zł. Rzeczywisty dochód nikogo się nie zmienił.</p>
</section>
<section id="nieporozumienie-7-przeszłe-wzorce-gwarantują-przyszłe-wyniki" class="level3">
<h3 class="anchored" data-anchor-id="nieporozumienie-7-przeszłe-wzorce-gwarantują-przyszłe-wyniki">Nieporozumienie 7: “Przeszłe wzorce gwarantują przyszłe wyniki”</h3>
<p><strong>Rzeczywistość</strong>: Ekstrapolacja zakłada, że warunki pozostają stałe.</p>
<p><strong>Przykład</strong>: Liniowa projekcja wzrostu populacji z lat 1950-2000 źle przeszacowałaby populację 2050 roku, ponieważ pomija spadek płodności.</p>
<hr>
</section>
</section>
<section id="zastosowania-w-demografii-1" class="level2" data-number="2.17">
<h2 data-number="2.17" class="anchored" data-anchor-id="zastosowania-w-demografii-1"><span class="header-section-number">2.17</span> Zastosowania w demografii</h2>
<section id="szacowanie-i-projekcja-populacji" class="level3">
<h3 class="anchored" data-anchor-id="szacowanie-i-projekcja-populacji">Szacowanie i projekcja populacji</h3>
<p><strong>Oszacowania międzyspisowe</strong>: Szacowanie populacji między spisami</p>
<p>Metoda komponentów: <span class="math display">P(t+1) = P(t) + B - D + I - E</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">P(t)</span> = Populacja w czasie <span class="math inline">t</span></li>
<li><span class="math inline">B</span> = Urodzenia</li>
<li><span class="math inline">D</span> = Zgony</li>
<li><span class="math inline">I</span> = Imigracja</li>
<li><span class="math inline">E</span> = Emigracja</li>
</ul>
<p>Każdy komponent szacowany z różnych źródeł z różnymi strukturami błędów.</p>
<p><strong>Projekcje populacji</strong>: Prognozowanie przyszłej populacji</p>
<p>Metoda komponentów kohortowych:</p>
<ol type="1">
<li>Prognozuj wskaźniki przeżycia według wieku</li>
<li>Prognozuj wskaźniki płodności</li>
<li>Prognozuj wskaźniki migracji</li>
<li>Zastosuj do populacji bazowej</li>
<li>Zagreguj wyniki</li>
</ol>
<p>Niepewność wzrasta z horyzontem projekcji.</p>
</section>
<section id="obliczanie-wskaźników-demograficznych" class="level3">
<h3 class="anchored" data-anchor-id="obliczanie-wskaźników-demograficznych">Obliczanie wskaźników demograficznych</h3>
<p><strong>Wskaźniki surowe (Crude Rates)</strong>: Zdarzenia na 1000 populacji</p>
<p><span class="math display">\text{Surowy współczynnik urodzeń} = \frac{\text{Urodzenia}}{\text{Populacja w połowie roku}} \times 1000</span></p>
<p><strong>Wskaźniki specyficzne dla wieku</strong> (Age-Specific Fertility Rate): Kontrola struktury wieku</p>
<p><span class="math display">\text{Współczynnik płodności specyficzny dla wieku} = \frac{\text{Urodzenia kobietom w wieku } x}{\text{Kobiety w wieku } x} \times 1000</span></p>
<p><strong>Standaryzacja</strong>: Porównywanie populacji z różnymi strukturami</p>
<p>Standaryzacja bezpośrednia: Zastosuj wskaźniki populacji do standardowej struktury wieku Standaryzacja pośrednia: Zastosuj standardowe wskaźniki do struktury wieku populacji</p>
</section>
<section id="analiza-tablic-trwania-życia" class="level3">
<h3 class="anchored" data-anchor-id="analiza-tablic-trwania-życia">Analiza tablic trwania życia</h3>
<p>Tablice życia podsumowują doświadczenie śmiertelności populacji.</p>
<p>Kluczowe kolumny:</p>
<ul>
<li><span class="math inline">q_x</span>: Prawdopodobieństwo śmierci między wiekiem <span class="math inline">x</span> a <span class="math inline">x+1</span></li>
<li><span class="math inline">l_x</span>: Liczba przeżywających do wieku <span class="math inline">x</span> (ze 100 000 urodzeń)</li>
<li><span class="math inline">d_x</span>: Zgony między wiekiem <span class="math inline">x</span> a <span class="math inline">x+1</span></li>
<li><span class="math inline">L_x</span>: Osobo-lata przeżyte między wiekiem <span class="math inline">x</span> a <span class="math inline">x+1</span></li>
<li><span class="math inline">e_x</span>: Oczekiwana długość życia w wieku <span class="math inline">x</span></li>
</ul>
<p><strong>Przykład interpretacji</strong>: Jeśli <span class="math inline">q_{65} = 0,015</span>, to 1,5% 65-latków umrze przed osiągnięciem 66 lat. Jeśli <span class="math inline">e_{65} = 18,5</span>, to 65-latkowie średnio żyją jeszcze 18,5 roku.</p>
</section>
<section id="analiza-płodności-1" class="level3">
<h3 class="anchored" data-anchor-id="analiza-płodności-1">Analiza płodności</h3>
<p><strong>Współczynnik dzietności całkowitej (TFR - Total Fertility Rate)</strong>: Średnia liczba dzieci na kobietę przy obecnych wskaźnikach płodności specyficznych dla wieku (ASFR - Age-Specific Fertility Rate)</p>
<p><span class="math display">\text{TFR} = \sum (\text{ASFR} \times \text{szerokość przedziału wieku})</span></p>
<p><strong>Przykład</strong>: Jeśli każda 5-letnia grupa wiekowa od 15-49 ma ASFR = 20 na 1000: <span class="math display">\text{TFR} = 7 \text{ grup wiekowych} \times \frac{20}{1000} \times 5 \text{ lat} = 0,7 \text{ dzieci na kobietę}</span></p>
<p>Ten bardzo niski TFR wskazuje na płodność poniżej poziomu zastępowalności.</p>
</section>
<section id="analiza-migracji" class="level3">
<h3 class="anchored" data-anchor-id="analiza-migracji">Analiza migracji</h3>
<p><strong>Współczynnik migracji netto</strong>: <span class="math display">\text{NMR} = \frac{\text{Imigranci} - \text{Emigranci}}{\text{Populacja}} \times 1000</span></p>
<p><strong>Wskaźnik efektywności migracji</strong>: <span class="math display">\text{MEI} = \frac{|\text{Napływ} - \text{Odpływ}|}{\text{Napływ} + \text{Odpływ}}</span></p>
<ul>
<li>Wartości blisko 0: Wysoka rotacja, mała zmiana netto</li>
<li>Wartości blisko 1: Głównie przepływ jednokierunkowy</li>
</ul>
</section>
<section id="metryki-zdrowia-populacji" class="level3">
<h3 class="anchored" data-anchor-id="metryki-zdrowia-populacji">Metryki zdrowia populacji</h3>
<p><strong>Lata życia skorygowane o niepełnosprawność (DALYs)</strong>: Utracone lata zdrowego życia</p>
<p>DALY = Utracone lata życia (YLL) + Lata przeżyte z niepełnosprawnością (YLD)</p>
<p><strong>Oczekiwana długość życia w zdrowiu</strong>: Oczekiwane lata w dobrym zdrowiu</p>
<p>Łączy informacje o śmiertelności i chorobowości.</p>
</section>
</section>
<section id="oprogramowanie-i-narzędzia" class="level2" data-number="2.18">
<h2 data-number="2.18" class="anchored" data-anchor-id="oprogramowanie-i-narzędzia"><span class="header-section-number">2.18</span> Oprogramowanie i narzędzia</h2>
<p>Współczesna statystyka demograficzna opiera się w dużej mierze na narzędziach obliczeniowych.</p>
<section id="pakiety-oprogramowania-statystycznego" class="level3">
<h3 class="anchored" data-anchor-id="pakiety-oprogramowania-statystycznego">Pakiety oprogramowania statystycznego</h3>
<p><strong>R</strong>: Darmowy, otwarty, rozbudowane pakiety demograficzne</p>
<ul>
<li>Pakiety: demography, popReconstruct, bayesPop</li>
<li>Zalety: Powtarzalne badania, najnowocześniejsze metody</li>
<li>Wady: Stroma krzywa uczenia</li>
</ul>
<p><strong>Stata</strong>: Szeroko używany w naukach społecznych</p>
<ul>
<li>Mocne strony: Analiza danych z badań, dane panelowe</li>
<li>Powszechny w: Ekonomii, epidemiologii</li>
</ul>
<p><strong>SPSS</strong>: Przyjazny interfejs użytkownika</p>
<ul>
<li>Mocne strony: Interfejs wskaż-i-kliknij</li>
<li>Powszechny w: Naukach społecznych, badaniach rynkowych</li>
</ul>
<p><strong>Python</strong>: Język programowania ogólnego przeznaczenia z bibliotekami statystycznymi</p>
<ul>
<li>Biblioteki: pandas, numpy, scipy, statsmodels</li>
<li>Zalety: Integracja z innymi aplikacjami</li>
</ul>
</section>
</section>
<section id="zakończenie" class="level2" data-number="2.19">
<h2 data-number="2.19" class="anchored" data-anchor-id="zakończenie"><span class="header-section-number">2.19</span> Zakończenie</h2>
<section id="podsumowanie-kluczowych-terminów" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie-kluczowych-terminów">Podsumowanie kluczowych terminów</h3>
<p><strong>Statystyka</strong>: Nauka o zbieraniu, organizowaniu, analizowaniu, interpretowaniu i prezentowaniu danych w celu zrozumienia zjawisk i wsparcia podejmowania decyzji</p>
<p><strong>Statystyka opisowa</strong>: Metody podsumowywania i prezentowania danych w znaczący sposób bez rozszerzania wniosków poza obserwowane dane</p>
<p><strong>Statystyka wnioskowania</strong>: Techniki wyciągania wniosków o populacjach z prób, w tym estymacja i testowanie hipotez</p>
<p><strong>Populacja</strong>: Kompletny zbiór jednostek, obiektów lub pomiarów, o których chcemy wyciągnąć wnioski</p>
<p><strong>Próba</strong>: Podzbiór populacji, który jest faktycznie obserwowany lub mierzony w celu dokonania wniosków o populacji</p>
<p><strong>Superpopulacja</strong>: Teoretyczna nieskończona populacja, z której obserwowane skończone populacje są uważane za próby</p>
<p><strong>Parametr</strong>: Liczbowa charakterystyka populacji (zazwyczaj nieznana i oznaczana literami greckimi)</p>
<p><strong>Statystyka</strong>: Liczbowa charakterystyka obliczona z danych z próby (znana i oznaczana literami łacińskimi)</p>
<p><strong>Estymator</strong>: Reguła lub formuła do obliczania oszacowań parametrów populacji z danych z próby</p>
<p><strong>Estimand</strong>: Konkretny parametr populacji będący celem estymacji</p>
<p><strong>Oszacowanie</strong>: Wartość liczbowa uzyskana przez zastosowanie estymatora do obserwowanych danych</p>
<p><strong>Błąd losowy</strong>: Nieprzewidywalna zmienność wynikająca z procesu próbkowania, która maleje z większymi próbami</p>
<p><strong>Błąd systematyczny (Obciążenie)</strong>: Konsekwentne odchylenie od prawdziwych wartości, którego nie można zmniejszyć przez zwiększenie wielkości próby</p>
<p><strong>Próbkowanie</strong>: Proces wyboru podzbioru jednostek z populacji do pomiaru</p>
<p><strong>Operat losowania</strong>: Lista lub urządzenie, z którego pobierana jest próba, idealnie zawierające wszystkich członków populacji</p>
<p><strong>Próbkowanie probabilistyczne</strong>: Metody próbkowania, w których każdy członek populacji ma znane, niezerowe prawdopodobieństwo selekcji</p>
<p><strong>Proste losowanie</strong>: Każda możliwa próba wielkości n ma równe prawdopodobieństwo selekcji</p>
<p><strong>Losowanie systematyczne</strong>: Wybór co k-tego elementu z uporządkowanego operanta losowania</p>
<p><strong>Losowanie warstwowe</strong>: Podział populacji na jednorodne podgrupy przed próbkowaniem w każdej</p>
<p><strong>Losowanie grupowe</strong>: Wybór grup (klastrów) zamiast jednostek</p>
<p><strong>Próbkowanie nieprobabilistyczne</strong>: Metody próbkowania bez gwarantowanych znanych prawdopodobieństw selekcji</p>
<p><strong>Próbkowanie wygodne</strong>: Wybór oparty wyłącznie na łatwości dostępu</p>
<p><strong>Próbkowanie celowe</strong>: Celowy wybór oparty na osądzie badacza</p>
<p><strong>Próbkowanie kwotowe</strong>: Wybór w celu dopasowania proporcji populacji w kluczowych charakterystykach bez losowej selekcji</p>
<p><strong>Próbkowanie kuli śnieżnej</strong>: Uczestnicy rekrutują dodatkowych uczestników ze swoich znajomych</p>
<p><strong>Błąd standardowy</strong>: Odchylenie standardowe rozkładu próbkowania statystyki</p>
<p><strong>Margines błędu</strong>: Maksymalna oczekiwana różnica między oszacowaniem a parametrem przy określonym poziomie ufności</p>
<p><strong>Przedział ufności</strong>: Zakres prawdopodobnych wartości dla parametru przy określonym poziomie ufności</p>
<p><strong>Poziom ufności</strong>: Prawdopodobieństwo, że metoda przedziału ufności wytworzy przedziały zawierające parametr</p>
<p><strong>Dane</strong>: Zebrane obserwacje lub pomiary</p>
<p><strong>Dane ilościowe</strong>: Pomiary liczbowe (ciągłe lub dyskretne)</p>
<p><strong>Dane jakościowe</strong>: Informacje kategoryczne (nominalne lub porządkowe)</p>
<p><strong>Rozkład danych</strong>: Opis tego, jak wartości rozkładają się na możliwe wyniki</p>
<p><strong>Rozkład częstości</strong>: Podsumowanie pokazujące, jak często każda wartość występuje w danych</p>
<p><strong>Częstość bezwzględna</strong>: Liczba obserwacji dla każdej wartości</p>
<p><strong>Częstość względna</strong>: Proporcja obserwacji w każdej kategorii</p>
<p><strong>Częstość skumulowana</strong>: Suma bieżąca częstości do każdej wartości</p>
<hr>
</section>
</section>
<section id="załącznik-a-visualizations-for-statistics-demography" class="level2" data-number="2.20">
<h2 data-number="2.20" class="anchored" data-anchor-id="załącznik-a-visualizations-for-statistics-demography"><span class="header-section-number">2.20</span> Załącznik A: Visualizations for Statistics &amp; Demography</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ============================================</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualizations for Statistics &amp; Demography</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Chapter 1: Foundations</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ============================================</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)  <span class="co"># for combining plots</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme for all plots</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>))</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Color palette for consistency</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2E86AB"</span>, <span class="st">"#A23B72"</span>, <span class="st">"#F18F01"</span>, <span class="st">"#C73E1D"</span>, <span class="st">"#6A994E"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. POPULATION vs SAMPLE VISUALIZATION</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a population and sample visualization</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate population data (e.g., ages of 10,000 people)</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>,</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">40</span>, <span class="at">sd =</span> <span class="dv">15</span>))</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>population<span class="sc">$</span>age[population<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>population<span class="sc">$</span>age[population<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a random sample</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> population[<span class="fu">sample</span>(<span class="fu">nrow</span>(population), sample_size), ]</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(population, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> colors[<span class="dv">1</span>], <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(population<span class="sc">$</span>age), </span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> colors[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Population Distribution (N = 10,000)"</span>,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Population mean (μ) ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(population<span class="sc">$</span>age), <span class="dv">2</span>), <span class="st">"years"</span>),</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sample_data, <span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> colors[<span class="dv">3</span>], <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(sample_data<span class="sc">$</span>age), </span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> colors[<span class="dv">4</span>], <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Sample Distribution (n ="</span>, sample_size, <span class="st">")"</span>),</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Sample mean (x̄) ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(sample_data<span class="sc">$</span>age), <span class="dv">2</span>), <span class="st">"years"</span>),</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age (years)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>population_sample_plot <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(population_sample_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. TYPES OF DATA DISTRIBUTIONS</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate different distribution types</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal distribution</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>normal_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-skewed distribution (income-like)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>right_skewed <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">15</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Left-skewed distribution (age at death in developed country)</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>left_skewed <span class="ot">&lt;-</span> <span class="dv">90</span> <span class="sc">-</span> <span class="fu">rgamma</span>(n, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">scale =</span> <span class="dv">5</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>left_skewed[left_skewed <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Bimodal distribution (e.g., height of mixed male/female population)</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>n2  <span class="ot">&lt;-</span> <span class="dv">20000</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>nf <span class="ot">&lt;-</span> n2 <span class="sc">%/%</span> <span class="dv">2</span>; nm <span class="ot">&lt;-</span> n2 <span class="sc">-</span> nf</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>bimodal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(nf, <span class="at">mean =</span> <span class="dv">164</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(nm, <span class="at">mean =</span> <span class="dv">182</span>, <span class="at">sd =</span> <span class="dv">5</span>))</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>distributions_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Normal =</span> normal_data,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Right Skewed</span><span class="st">`</span> <span class="ot">=</span> right_skewed,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Left Skewed</span><span class="st">`</span> <span class="ot">=</span> left_skewed,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bimodal =</span> bimodal</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Distribution"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distributions</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>distributions_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(distributions_df, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Distribution)) <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Distribution, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colors[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Types of Data Distributions"</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Common patterns in demographic data"</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(distributions_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. NORMAL DISTRIBUTION WITH 68-95-99.7 RULE</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate normal distribution data</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>mean_val <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>sd_val <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(mean_val <span class="sc">-</span> <span class="dv">4</span><span class="sc">*</span>sd_val, mean_val <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>sd_val, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mean_val, <span class="at">sd =</span> sd_val)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>df_norm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>normal_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_norm, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fill areas under the curve</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(df_norm, x <span class="sc">&gt;=</span> mean_val <span class="sc">-</span> sd_val <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> mean_val <span class="sc">+</span> sd_val),</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> colors[<span class="dv">1</span>], <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(df_norm, x <span class="sc">&gt;=</span> mean_val <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>sd_val <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> mean_val <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sd_val),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> colors[<span class="dv">2</span>], <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> <span class="fu">subset</span>(df_norm, x <span class="sc">&gt;=</span> mean_val <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>sd_val <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> mean_val <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>sd_val),</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> colors[<span class="dv">3</span>], <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the curve</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add vertical lines for standard deviations</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_val, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(mean_val <span class="sc">-</span> sd_val, mean_val <span class="sc">+</span> sd_val), </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">color =</span> colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(mean_val <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>sd_val, mean_val <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sd_val), </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">color =</span> colors[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(mean_val <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>sd_val, mean_val <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>sd_val), </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">color =</span> colors[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mean_val, <span class="at">y =</span> <span class="fu">max</span>(y) <span class="sc">*</span> <span class="fl">0.5</span>, <span class="at">label =</span> <span class="st">"68%"</span>, </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mean_val, <span class="at">y =</span> <span class="fu">max</span>(y) <span class="sc">*</span> <span class="fl">0.3</span>, <span class="at">label =</span> <span class="st">"95%"</span>, </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> colors[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mean_val, <span class="at">y =</span> <span class="fu">max</span>(y) <span class="sc">*</span> <span class="fl">0.1</span>, <span class="at">label =</span> <span class="st">"99.7%"</span>, </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> colors[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(mean_val <span class="sc">-</span> <span class="dv">3</span><span class="sc">*</span>sd_val, mean_val <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>sd_val, </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>                                mean_val <span class="sc">-</span> sd_val, mean_val, </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>                                mean_val <span class="sc">+</span> sd_val, mean_val <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>sd_val, </span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>                                mean_val <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>sd_val),</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"μ-3σ"</span>, <span class="st">"μ-2σ"</span>, <span class="st">"μ-σ"</span>, <span class="st">"μ"</span>, <span class="st">"μ+σ"</span>, <span class="st">"μ+2σ"</span>, <span class="st">"μ+3σ"</span>)) <span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal Distribution: The 68-95-99.7 Rule"</span>,</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Proportion of data within standard deviations from the mean"</span>,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Probability Density"</span>) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(normal_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. SIMPLE LINEAR REGRESSION</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define color palette (this was missing in original code)</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2E86AB"</span>, <span class="st">"#A23B72"</span>, <span class="st">"#F18F01"</span>, <span class="st">"#C73E1D"</span>, <span class="st">"#592E83"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data for regression example (Education vs Income)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>n_reg <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n_reg, <span class="at">mean =</span> <span class="dv">14</span>, <span class="at">sd =</span> <span class="dv">3</span>))</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>education[education <span class="sc">&lt;</span> <span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>education[education <span class="sc">&gt;</span> <span class="dv">22</span>] <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create income with linear relationship plus noise</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="sc">+</span> <span class="dv">4000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="fu">rnorm</span>(n_reg, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">8000</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>income[income <span class="sc">&lt;</span> <span class="dv">10000</span>] <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>reg_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">education =</span> education, <span class="at">income =</span> income)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> reg_data)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create subset of data for residual lines</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>subset_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(reg_data), <span class="dv">20</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> reg_data[subset_indices, ]</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>subset_data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_model, <span class="at">newdata =</span> subset_data)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create regression plot</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>regression_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(reg_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line with confidence interval</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> colors[<span class="dv">2</span>], <span class="at">fill =</span> colors[<span class="dv">2</span>], <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add residual lines for a subset of points to show the concept</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> subset_data,</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">xend =</span> education, </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> income, <span class="at">yend =</span> predicted),</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> colors[<span class="dv">4</span>], <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add equation to plot (adjusted position based on data range)</span></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">min</span>(reg_data<span class="sc">$</span>education) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fu">max</span>(reg_data<span class="sc">$</span>income) <span class="sc">*</span> <span class="fl">0.9</span>, </span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Income = $"</span>, <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">coef</span>(lm_model)[<span class="dv">1</span>]), <span class="at">big.mark =</span> <span class="st">","</span>), </span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>                        <span class="st">" + $"</span>, <span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">coef</span>(lm_model)[<span class="dv">2</span>]), <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">" × Education"</span>,</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"</span><span class="sc">\n</span><span class="st">R² = "</span>, <span class="fu">round</span>(<span class="fu">summary</span>(lm_model)<span class="sc">$</span>r.squared, <span class="dv">3</span>), <span class="at">sep =</span> <span class="st">""</span>),</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>) <span class="sc">+</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels and formatting</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>()) <span class="sc">+</span></span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simple Linear Regression: Education and Income"</span>,</span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Each year of education associated with higher income"</span>,</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, </span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Annual Income"</span>) <span class="sc">+</span></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(regression_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. SAMPLING ERROR AND SAMPLE SIZE</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show how standard error decreases with sample size</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2500</span>, <span class="dv">5000</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># True population parameters</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>true_mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>true_sd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Run simulations for each sample size</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>se_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_simulations, <span class="fu">mean</span>(<span class="fu">rnorm</span>(n, true_mean, true_sd)))</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  se_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(se_results, </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">data.frame</span>(<span class="at">n =</span> n, </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                                <span class="at">se_empirical =</span> <span class="fu">sd</span>(sample_means),</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                                <span class="at">se_theoretical =</span> true_sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>se_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(se_results, <span class="fu">aes</span>(<span class="at">x =</span> n)) <span class="sc">+</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> se_empirical, <span class="at">color =</span> <span class="st">"Empirical SE"</span>), <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> se_empirical, <span class="at">color =</span> <span class="st">"Empirical SE"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> se_theoretical, <span class="at">color =</span> <span class="st">"Theoretical SE"</span>), </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> sample_sizes) <span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Empirical SE"</span> <span class="ot">=</span> colors[<span class="dv">1</span>], </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Theoretical SE"</span> <span class="ot">=</span> colors[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Standard Error Decreases with Sample Size"</span>,</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The precision of estimates improves with larger samples"</span>,</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sample Size (log scale)"</span>, </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Standard Error"</span>,</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(se_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. CONFIDENCE INTERVALS VISUALIZATION</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate multiple samples and their confidence intervals</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>sample_size_ci <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>true_mean_ci <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>true_sd_ci <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate samples and calculate CIs</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>ci_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_samples) {</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  sample_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_size_ci, true_mean_ci, true_sd_ci)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  mean_i <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_i)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  se_i <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample_i) <span class="sc">/</span> <span class="fu">sqrt</span>(sample_size_ci)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> mean_i <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se_i</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> mean_i <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se_i</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  contains_true <span class="ot">&lt;-</span> (true_mean_ci <span class="sc">&gt;=</span> ci_lower) <span class="sc">&amp;</span> (true_mean_ci <span class="sc">&lt;=</span> ci_upper)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  ci_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ci_data,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">data.frame</span>(<span class="at">sample =</span> i, <span class="at">mean =</span> mean_i, </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lower =</span> ci_lower, <span class="at">upper =</span> ci_upper,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">contains =</span> contains_true))</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create CI plot</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>ci_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ci_data, <span class="fu">aes</span>(<span class="at">x =</span> sample, <span class="at">y =</span> mean)) <span class="sc">+</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_mean_ci, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, <span class="at">color =</span> contains), </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> contains), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> colors[<span class="dv">1</span>], <span class="st">"FALSE"</span> <span class="ot">=</span> colors[<span class="dv">4</span>]),</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Misses true value"</span>, <span class="st">"Contains true value"</span>)) <span class="sc">+</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"95% Confidence Intervals from 20 Different Samples"</span>,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"True population mean = "</span>, true_mean_ci, </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>                       <span class="st">" (red dashed line)"</span>, <span class="at">sep =</span> <span class="st">""</span>),</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sample Number"</span>, </span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sample Mean with 95% CI"</span>,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. SAMPLING DISTRIBUTIONS (CENTRAL LIMIT THEOREM)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Setup ----</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Skewed population (Gamma); change if you want another DGP</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>Npop <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(Npop, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">10</span>)  <span class="co"># skewed right</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>mu    <span class="ot">&lt;-</span> <span class="fu">mean</span>(population)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(population)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- CLT: sampling distribution of the mean ----</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">100</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">2000</span>  <span class="co"># resamples per n</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>clt_df <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dfr</span>(sample_sizes, \(n) {</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">n =</span> n,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean =</span> <span class="fu">replicate</span>(B, <span class="fu">mean</span>(<span class="fu">sample</span>(population, n, <span class="at">replace =</span> <span class="cn">TRUE</span>))))</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal overlays: N(mu, sigma/sqrt(n))</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>clt_range <span class="ot">&lt;-</span> clt_df <span class="sc">|&gt;</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">|&gt;</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">min_x =</span> <span class="fu">min</span>(mean), <span class="at">max_x =</span> <span class="fu">max</span>(mean), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>normal_df <span class="ot">&lt;-</span> clt_range <span class="sc">|&gt;</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="fu">seq</span>(min_x, max_x, <span class="at">length.out =</span> <span class="dv">200</span>))) <span class="sc">|&gt;</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(x) <span class="sc">|&gt;</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>clt_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(clt_df, <span class="fu">aes</span>(mean)) <span class="sc">+</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density), <span class="at">fill =</span> <span class="fu">factor</span>(n)),</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> normal_df, <span class="fu">aes</span>(x, density), <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mu, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> n, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"CLT: Sampling distribution of the mean → Normal(μ, σ/√n)"</span>,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Skewed population: Gamma(shape=2, scale=10).  μ≈%.2f, σ≈%.2f; B=%d resamples each."</span>, mu, sigma, B),</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sample mean"</span>, <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>)</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>clt_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. TYPES OF SAMPLING ERROR</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data to show random vs systematic error</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>n_measurements <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>true_value <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Random error only</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>random_error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_measurements, <span class="at">mean =</span> true_value, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Systematic error (bias) only</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>systematic_error <span class="ot">&lt;-</span> <span class="fu">rep</span>(true_value <span class="sc">+</span> <span class="dv">10</span>, n_measurements) <span class="sc">+</span> <span class="fu">rnorm</span>(n_measurements, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Both errors</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>both_errors <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_measurements, <span class="at">mean =</span> true_value <span class="sc">+</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>error_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">measurement =</span> <span class="dv">1</span><span class="sc">:</span>n_measurements,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Random Error Only</span><span class="st">`</span> <span class="ot">=</span> random_error,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Systematic Error Only</span><span class="st">`</span> <span class="ot">=</span> systematic_error,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Both Errors</span><span class="st">`</span> <span class="ot">=</span> both_errors</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>measurement, <span class="at">names_to =</span> <span class="st">"Error_Type"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create error visualization</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>error_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(error_data, <span class="fu">aes</span>(<span class="at">x =</span> measurement, <span class="at">y =</span> Value, <span class="at">color =</span> Error_Type)) <span class="sc">+</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_value, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Error_Type, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Random Error vs Systematic Error (Bias)"</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"True value = "</span>, true_value, <span class="st">" (black dashed line)"</span>, <span class="at">sep =</span> <span class="st">""</span>),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Measurement Number"</span>, </span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Measured Value"</span>) <span class="sc">+</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(error_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. DEMOGRAPHIC PYRAMID</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age pyramid data</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">777</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>age_groups <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0-4"</span>, <span class="st">"5-9"</span>, <span class="st">"10-14"</span>, <span class="st">"15-19"</span>, <span class="st">"20-24"</span>, <span class="st">"25-29"</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"30-34"</span>, <span class="st">"35-39"</span>, <span class="st">"40-44"</span>, <span class="st">"45-49"</span>, <span class="st">"50-54"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"55-59"</span>, <span class="st">"60-64"</span>, <span class="st">"65-69"</span>, <span class="st">"70-74"</span>, <span class="st">"75-79"</span>, <span class="st">"80+"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for a developing country pattern</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>male_pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="fl">11.5</span>, <span class="dv">11</span>, <span class="fl">10.5</span>, <span class="dv">10</span>, <span class="fl">9.5</span>, <span class="dv">9</span>, <span class="fl">8.5</span>, <span class="dv">8</span>, <span class="fl">7.5</span>, <span class="dv">7</span>, </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>             <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="fl">1.5</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>female_pop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.8</span>, <span class="fl">11.3</span>, <span class="fl">10.8</span>, <span class="fl">10.3</span>, <span class="fl">9.8</span>, <span class="fl">9.3</span>, <span class="fl">8.8</span>, <span class="fl">8.3</span>, <span class="fl">7.8</span>, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>               <span class="fl">7.3</span>, <span class="fl">6.8</span>, <span class="fl">5.8</span>, <span class="fl">4.8</span>, <span class="fl">3.8</span>, <span class="fl">2.8</span>, <span class="fl">2.2</span>, <span class="dv">2</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>pyramid_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(age_groups, <span class="dv">2</span>), <span class="at">levels =</span> <span class="fu">rev</span>(age_groups)),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Population =</span> <span class="fu">c</span>(<span class="sc">-</span>male_pop, female_pop),  <span class="co"># Negative for males</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Male"</span>, <span class="fu">length</span>(male_pop)), <span class="fu">rep</span>(<span class="st">"Female"</span>, <span class="fu">length</span>(female_pop)))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create population pyramid</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>pyramid_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pyramid_data, <span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> Population, <span class="at">fill =</span> Sex)) <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="fu">abs</span>(x), <span class="st">"%"</span>)) <span class="sc">+</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Male"</span> <span class="ot">=</span> colors[<span class="dv">1</span>], <span class="st">"Female"</span> <span class="ot">=</span> colors[<span class="dv">3</span>])) <span class="sc">+</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Population Pyramid"</span>,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Age and sex distribution (typical developing country pattern)"</span>,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Age Group"</span>, </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Percentage of Population"</span>) <span class="sc">+</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pyramid_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. REGRESSION RESIDUALS AND DIAGNOSTICS</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the previous regression model for diagnostics</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>reg_diagnostics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fitted =</span> <span class="fu">fitted</span>(lm_model),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">residuals</span>(lm_model),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized_residuals =</span> <span class="fu">rstandard</span>(lm_model),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> reg_data<span class="sc">$</span>education,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> reg_data<span class="sc">$</span>income</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create diagnostic plots</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Residuals vs Fitted</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>p_resid_fitted <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(reg_diagnostics, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> colors[<span class="dv">2</span>], <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Fitted Values"</span>,</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Check for homoscedasticity"</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Q-Q plot</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>p_qq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(reg_diagnostics, <span class="fu">aes</span>(<span class="at">sample =</span> standardized_residuals)) <span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="at">color =</span> colors[<span class="dv">1</span>]) <span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal Q-Q Plot"</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Check for normality of residuals"</span>,</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Standardized Residuals"</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Histogram of residuals</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>p_hist_resid <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(reg_diagnostics, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> colors[<span class="dv">3</span>], <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Residuals"</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Should be approximately normal"</span>,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Residuals vs Predictor</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>p_resid_x <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(reg_diagnostics, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> colors[<span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> colors[<span class="dv">2</span>], <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals vs Predictor"</span>,</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Check for patterns"</span>,</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Education (years)"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine diagnostic plots</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>diagnostic_plots <span class="ot">&lt;-</span> (p_resid_fitted <span class="sc">+</span> p_qq) <span class="sc">/</span> (p_hist_resid <span class="sc">+</span> p_resid_x)</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(diagnostic_plots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 11. SAVE ALL PLOTS (Optional)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment to save plots as high-resolution images</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("population_sample.png", population_sample_plot, width = 10, height = 8, dpi = 300)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("distributions.png", distributions_plot, width = 12, height = 8, dpi = 300)</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("normal_distribution.png", normal_plot, width = 10, height = 6, dpi = 300)</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("regression.png", regression_plot, width = 10, height = 7, dpi = 300)</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("standard_error.png", se_plot, width = 10, height = 6, dpi = 300)</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("confidence_intervals.png", ci_plot, width = 10, height = 8, dpi = 300)</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("central_limit_theorem.png", clt_plot, width = 14, height = 5, dpi = 300)</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("error_types.png", error_plot, width = 14, height = 5, dpi = 300)</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("population_pyramid.png", pyramid_plot, width = 8, height = 8, dpi = 300)</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave("regression_diagnostics.png", diagnostic_plots, width = 12, height = 10, dpi = 300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter1.html" class="pagination-link" aria-label="Foundations of Statistics and Demography">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations of Statistics and Demography</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter2.html" class="pagination-link" aria-label="Understanding Data Types in Social Sciences">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>