<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Wprowadzenie do Nauki o Danych i Statystyki – Social Data Analysis: An Introduction (Wprowadzenie do Analizy Danych Społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter2.html" rel="next">
<link href="./chapter1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rozdzial1.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do Analizy Danych Społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Zrozumienie Typów Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Próbkowania i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#czym-są-statystyka-i-nauka-o-danych" id="toc-czym-są-statystyka-i-nauka-o-danych" class="nav-link active" data-scroll-target="#czym-są-statystyka-i-nauka-o-danych"><span class="header-section-number">2.1</span> Czym są Statystyka i Nauka o Danych?</a></li>
  <li><a href="#związek-między-statystyką-a-nauką-o-danych" id="toc-związek-między-statystyką-a-nauką-o-danych" class="nav-link" data-scroll-target="#związek-między-statystyką-a-nauką-o-danych"><span class="header-section-number">2.2</span> Związek między Statystyką a Nauką o Danych</a></li>
  <li><a href="#podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" id="toc-podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" class="nav-link" data-scroll-target="#podstawowe-pojęcia-w-nauce-o-danych-i-statystyce"><span class="header-section-number">2.3</span> Podstawowe Pojęcia w Nauce o Danych i Statystyce</a>
  <ul class="collapse">
  <li><a href="#dane-i-populacje" id="toc-dane-i-populacje" class="nav-link" data-scroll-target="#dane-i-populacje"><span class="header-section-number">2.3.1</span> Dane i Populacje</a></li>
  <li><a href="#wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" id="toc-wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" class="nav-link" data-scroll-target="#wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację"><span class="header-section-number">2.3.2</span> Wnioskowanie Statystyczne: Jak Mała Próba Może Reprezentować Dużą Populację?</a></li>
  <li><a href="#zrozumienie-błędu-statystycznego" id="toc-zrozumienie-błędu-statystycznego" class="nav-link" data-scroll-target="#zrozumienie-błędu-statystycznego"><span class="header-section-number">2.3.3</span> Zrozumienie Błędu Statystycznego</a></li>
  <li><a href="#dobór-wielkości-próby" id="toc-dobór-wielkości-próby" class="nav-link" data-scroll-target="#dobór-wielkości-próby"><span class="header-section-number">2.3.4</span> Dobór Wielkości Próby</a></li>
  <li><a href="#proporcje-a-średnie" id="toc-proporcje-a-średnie" class="nav-link" data-scroll-target="#proporcje-a-średnie"><span class="header-section-number">2.3.5</span> Proporcje a Średnie</a></li>
  <li><a href="#przykład-maksymalnej-niepewności-dlaczego-50-to-najgorszy-przypadek" id="toc-przykład-maksymalnej-niepewności-dlaczego-50-to-najgorszy-przypadek" class="nav-link" data-scroll-target="#przykład-maksymalnej-niepewności-dlaczego-50-to-najgorszy-przypadek"><span class="header-section-number">2.3.6</span> Przykład Maksymalnej Niepewności: Dlaczego 50% to “Najgorszy Przypadek”</a></li>
  <li><a href="#podsumowanie-kluczowe-punkty-do-zapamiętania" id="toc-podsumowanie-kluczowe-punkty-do-zapamiętania" class="nav-link" data-scroll-target="#podsumowanie-kluczowe-punkty-do-zapamiętania"><span class="header-section-number">2.3.7</span> Podsumowanie: Kluczowe Punkty do Zapamiętania</a></li>
  </ul></li>
  <li><a href="#parametry-populacji" id="toc-parametry-populacji" class="nav-link" data-scroll-target="#parametry-populacji"><span class="header-section-number">2.4</span> Parametry Populacji</a></li>
  <li><a href="#rozkład-statystyk-z-próby" id="toc-rozkład-statystyk-z-próby" class="nav-link" data-scroll-target="#rozkład-statystyk-z-próby"><span class="header-section-number">2.5</span> Rozkład Statystyk z Próby</a></li>
  <li><a href="#wartość-oczekiwana-statystyki-z-próby" id="toc-wartość-oczekiwana-statystyki-z-próby" class="nav-link" data-scroll-target="#wartość-oczekiwana-statystyki-z-próby"><span class="header-section-number">2.6</span> Wartość Oczekiwana Statystyki z Próby</a></li>
  <li><a href="#rozkład-normalny---krzywa-dzwonowa" id="toc-rozkład-normalny---krzywa-dzwonowa" class="nav-link" data-scroll-target="#rozkład-normalny---krzywa-dzwonowa"><span class="header-section-number">2.7</span> Rozkład Normalny - Krzywa Dzwonowa</a>
  <ul class="collapse">
  <li><a href="#reprezentacja-matematyczna" id="toc-reprezentacja-matematyczna" class="nav-link" data-scroll-target="#reprezentacja-matematyczna"><span class="header-section-number">2.7.1</span> Reprezentacja Matematyczna</a></li>
  <li><a href="#praktyczne-znaczenie-1" id="toc-praktyczne-znaczenie-1" class="nav-link" data-scroll-target="#praktyczne-znaczenie-1"><span class="header-section-number">2.7.2</span> Praktyczne Znaczenie</a></li>
  </ul></li>
  <li><a href="#popularna-notacja-statystyczna" id="toc-popularna-notacja-statystyczna" class="nav-link" data-scroll-target="#popularna-notacja-statystyczna"><span class="header-section-number">2.8</span> Popularna Notacja Statystyczna</a></li>
  <li><a href="#rodzaje-danych-i-zmiennych" id="toc-rodzaje-danych-i-zmiennych" class="nav-link" data-scroll-target="#rodzaje-danych-i-zmiennych"><span class="header-section-number">2.9</span> Rodzaje Danych i Zmiennych</a>
  <ul class="collapse">
  <li><a href="#źródła-danych" id="toc-źródła-danych" class="nav-link" data-scroll-target="#źródła-danych"><span class="header-section-number">2.9.1</span> Źródła Danych</a></li>
  <li><a href="#zmienne-i-stałe" id="toc-zmienne-i-stałe" class="nav-link" data-scroll-target="#zmienne-i-stałe"><span class="header-section-number">2.9.2</span> Zmienne i Stałe</a></li>
  </ul></li>
  <li><a href="#pojęcia-związane-z-estymacją-statystyczną" id="toc-pojęcia-związane-z-estymacją-statystyczną" class="nav-link" data-scroll-target="#pojęcia-związane-z-estymacją-statystyczną"><span class="header-section-number">2.10</span> Pojęcia Związane z Estymacją Statystyczną</a>
  <ul class="collapse">
  <li><a href="#parametr-populacji-estymand" id="toc-parametr-populacji-estymand" class="nav-link" data-scroll-target="#parametr-populacji-estymand"><span class="header-section-number">2.10.1</span> Parametr Populacji (Estymand)</a></li>
  <li><a href="#estymator-statystyka" id="toc-estymator-statystyka" class="nav-link" data-scroll-target="#estymator-statystyka"><span class="header-section-number">2.10.2</span> Estymator (Statystyka)</a></li>
  <li><a href="#oszacowanie-estymata" id="toc-oszacowanie-estymata" class="nav-link" data-scroll-target="#oszacowanie-estymata"><span class="header-section-number">2.10.3</span> Oszacowanie (Estymata)</a></li>
  <li><a href="#właściwości-dobrych-estymatorów" id="toc-właściwości-dobrych-estymatorów" class="nav-link" data-scroll-target="#właściwości-dobrych-estymatorów"><span class="header-section-number">2.10.4</span> Właściwości Dobrych Estymatorów</a></li>
  </ul></li>
  <li><a href="#modele-statystyczne-i-wnioskowanie" id="toc-modele-statystyczne-i-wnioskowanie" class="nav-link" data-scroll-target="#modele-statystyczne-i-wnioskowanie"><span class="header-section-number">2.11</span> Modele Statystyczne i Wnioskowanie</a>
  <ul class="collapse">
  <li><a href="#modele-statystyczne" id="toc-modele-statystyczne" class="nav-link" data-scroll-target="#modele-statystyczne"><span class="header-section-number">2.11.1</span> Modele Statystyczne</a></li>
  <li><a href="#wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne" id="toc-wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne" class="nav-link" data-scroll-target="#wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne"><span class="header-section-number">2.11.2</span> Wnioskowanie Przyczynowe a Predykcyjne (korelacyjne)</a></li>
  <li><a href="#wyzwania-wnioskowania-przyczynowego" id="toc-wyzwania-wnioskowania-przyczynowego" class="nav-link" data-scroll-target="#wyzwania-wnioskowania-przyczynowego"><span class="header-section-number">2.11.3</span> Wyzwania Wnioskowania Przyczynowego</a></li>
  </ul></li>
  <li><a href="#wnioskowanie-statystyczne" id="toc-wnioskowanie-statystyczne" class="nav-link" data-scroll-target="#wnioskowanie-statystyczne"><span class="header-section-number">2.12</span> Wnioskowanie Statystyczne</a>
  <ul class="collapse">
  <li><a href="#estymacja" id="toc-estymacja" class="nav-link" data-scroll-target="#estymacja"><span class="header-section-number">2.12.1</span> Estymacja</a></li>
  <li><a href="#testowanie-hipotez" id="toc-testowanie-hipotez" class="nav-link" data-scroll-target="#testowanie-hipotez"><span class="header-section-number">2.12.2</span> Testowanie Hipotez</a></li>
  <li><a href="#rodzaje-błędów-w-testowaniu-hipotez" id="toc-rodzaje-błędów-w-testowaniu-hipotez" class="nav-link" data-scroll-target="#rodzaje-błędów-w-testowaniu-hipotez"><span class="header-section-number">2.12.3</span> Rodzaje Błędów w Testowaniu Hipotez</a></li>
  </ul></li>
  <li><a href="#podstawy-dobrego-badania-statystycznego" id="toc-podstawy-dobrego-badania-statystycznego" class="nav-link" data-scroll-target="#podstawy-dobrego-badania-statystycznego"><span class="header-section-number">2.13</span> Podstawy Dobrego Badania Statystycznego</a>
  <ul class="collapse">
  <li><a href="#podsumowanie-kluczowych-pojęć" id="toc-podsumowanie-kluczowych-pojęć" class="nav-link" data-scroll-target="#podsumowanie-kluczowych-pojęć"><span class="header-section-number">2.13.1</span> Podsumowanie Kluczowych Pojęć</a></li>
  </ul></li>
  <li><a href="#appendices-additional-topics-in-statistics-and-data-science" id="toc-appendices-additional-topics-in-statistics-and-data-science" class="nav-link" data-scroll-target="#appendices-additional-topics-in-statistics-and-data-science"><span class="header-section-number">3</span> Appendices: Additional Topics in Statistics and Data Science (*)</a>
  <ul class="collapse">
  <li><a href="#appendix-a-r-for-social-science-data-analysis" id="toc-appendix-a-r-for-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">3.1</span> Appendix A: R for Social Science Data Analysis</a></li>
  <li><a href="#appendix-b-causal-inference-vs.-observational-studies" id="toc-appendix-b-causal-inference-vs.-observational-studies" class="nav-link" data-scroll-target="#appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">3.2</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</a>
  <ul class="collapse">
  <li><a href="#causal-inference" id="toc-causal-inference" class="nav-link" data-scroll-target="#causal-inference"><span class="header-section-number">3.2.1</span> Causal Inference</a></li>
  <li><a href="#observational-studies" id="toc-observational-studies" class="nav-link" data-scroll-target="#observational-studies"><span class="header-section-number">3.2.2</span> Observational Studies</a></li>
  <li><a href="#challenges-in-establishing-causality" id="toc-challenges-in-establishing-causality" class="nav-link" data-scroll-target="#challenges-in-establishing-causality"><span class="header-section-number">3.2.3</span> Challenges in Establishing Causality</a></li>
  <li><a href="#methods-to-strengthen-causal-claims" id="toc-methods-to-strengthen-causal-claims" class="nav-link" data-scroll-target="#methods-to-strengthen-causal-claims"><span class="header-section-number">3.2.4</span> Methods to Strengthen Causal Claims</a></li>
  </ul></li>
  <li><a href="#appendix-c-understanding-spurious-correlations-confounders-and-colliders" id="toc-appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="nav-link" data-scroll-target="#appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">3.3</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</a>
  <ul class="collapse">
  <li><a href="#spurious-correlations" id="toc-spurious-correlations" class="nav-link" data-scroll-target="#spurious-correlations"><span class="header-section-number">3.3.1</span> Spurious Correlations</a></li>
  <li><a href="#confounders" id="toc-confounders" class="nav-link" data-scroll-target="#confounders"><span class="header-section-number">3.3.2</span> Confounders</a></li>
  <li><a href="#colliders" id="toc-colliders" class="nav-link" data-scroll-target="#colliders"><span class="header-section-number">3.3.3</span> Colliders</a></li>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox"><span class="header-section-number">3.3.4</span> Simpson’s Paradox</a></li>
  <li><a href="#directed-acyclic-graphs-dags" id="toc-directed-acyclic-graphs-dags" class="nav-link" data-scroll-target="#directed-acyclic-graphs-dags"><span class="header-section-number">3.3.5</span> Directed Acyclic Graphs (DAGs)</a></li>
  </ul></li>
  <li><a href="#appendix-d-models-in-science-from-deterministic-to-stochastic" id="toc-appendix-d-models-in-science-from-deterministic-to-stochastic" class="nav-link" data-scroll-target="#appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">3.4</span> Appendix D: Models in Science: From Deterministic to Stochastic</a>
  <ul class="collapse">
  <li><a href="#types-of-models" id="toc-types-of-models" class="nav-link" data-scroll-target="#types-of-models"><span class="header-section-number">3.4.1</span> Types of Models</a></li>
  <li><a href="#model-error-and-bias-variance-tradeoff" id="toc-model-error-and-bias-variance-tradeoff" class="nav-link" data-scroll-target="#model-error-and-bias-variance-tradeoff"><span class="header-section-number">3.4.2</span> Model Error and Bias-Variance Tradeoff</a></li>
  </ul></li>
  <li><a href="#appendix-e-classical-vs-quantum-randomness" id="toc-appendix-e-classical-vs-quantum-randomness" class="nav-link" data-scroll-target="#appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">3.5</span> Appendix E: Classical vs Quantum Randomness</a>
  <ul class="collapse">
  <li><a href="#origin-of-randomness" id="toc-origin-of-randomness" class="nav-link" data-scroll-target="#origin-of-randomness"><span class="header-section-number">3.5.1</span> Origin of Randomness</a></li>
  <li><a href="#philosophical-implications" id="toc-philosophical-implications" class="nav-link" data-scroll-target="#philosophical-implications"><span class="header-section-number">3.5.2</span> Philosophical Implications</a></li>
  <li><a href="#practical-implications" id="toc-practical-implications" class="nav-link" data-scroll-target="#practical-implications"><span class="header-section-number">3.5.3</span> Practical Implications</a></li>
  </ul></li>
  <li><a href="#appendix-f-ethical-considerations-in-social-science-data-analysis" id="toc-appendix-f-ethical-considerations-in-social-science-data-analysis" class="nav-link" data-scroll-target="#appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">3.6</span> Appendix F: Ethical Considerations in Social Science Data Analysis</a>
  <ul class="collapse">
  <li><a href="#privacy-and-consent" id="toc-privacy-and-consent" class="nav-link" data-scroll-target="#privacy-and-consent"><span class="header-section-number">3.6.1</span> 1. Privacy and Consent</a></li>
  <li><a href="#data-protection" id="toc-data-protection" class="nav-link" data-scroll-target="#data-protection"><span class="header-section-number">3.6.2</span> 2. Data Protection</a></li>
  <li><a href="#bias-and-representation" id="toc-bias-and-representation" class="nav-link" data-scroll-target="#bias-and-representation"><span class="header-section-number">3.6.3</span> 3. Bias and Representation</a></li>
  <li><a href="#transparency-and-reproducibility" id="toc-transparency-and-reproducibility" class="nav-link" data-scroll-target="#transparency-and-reproducibility"><span class="header-section-number">3.6.4</span> 4. Transparency and Reproducibility</a></li>
  <li><a href="#social-impact" id="toc-social-impact" class="nav-link" data-scroll-target="#social-impact"><span class="header-section-number">3.6.5</span> 5. Social Impact</a></li>
  </ul></li>
  <li><a href="#appendix-g-introduction-to-rstudio-and-the-tidyverse" id="toc-appendix-g-introduction-to-rstudio-and-the-tidyverse" class="nav-link" data-scroll-target="#appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">3.7</span> Appendix G: Introduction to RStudio and the tidyverse</a>
  <ul class="collapse">
  <li><a href="#getting-started-with-rstudio" id="toc-getting-started-with-rstudio" class="nav-link" data-scroll-target="#getting-started-with-rstudio"><span class="header-section-number">3.7.1</span> Getting Started with RStudio</a></li>
  <li><a href="#the-tidyverse-ecosystem" id="toc-the-tidyverse-ecosystem" class="nav-link" data-scroll-target="#the-tidyverse-ecosystem"><span class="header-section-number">3.7.2</span> The tidyverse Ecosystem</a></li>
  <li><a href="#basic-tidyverse-workflow" id="toc-basic-tidyverse-workflow" class="nav-link" data-scroll-target="#basic-tidyverse-workflow"><span class="header-section-number">3.7.3</span> Basic tidyverse Workflow</a></li>
  <li><a href="#resources-for-learning-r" id="toc-resources-for-learning-r" class="nav-link" data-scroll-target="#resources-for-learning-r"><span class="header-section-number">3.7.4</span> Resources for Learning R</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="czym-są-statystyka-i-nauka-o-danych" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="czym-są-statystyka-i-nauka-o-danych"><span class="header-section-number">2.1</span> Czym są Statystyka i Nauka o Danych?</h2>
<blockquote class="blockquote">
<p><strong>Ważne</strong></p>
<p>Statystyka i nauka o danych to zarówno sztuka, jak i nauka wydobywania wiedzy z danych – pomagają nam zrozumieć świat poprzez metodyczną analizę zebranych informacji.</p>
</blockquote>
<p>Statystyka i nauka o danych dostarczają niezbędnych narzędzi dla badaczy nauk społecznych, niezależnie od specjalizacji. Bez względu na to, czy studiujesz nauki polityczne, ekonomię, socjologię czy inną dziedzinę nauk społecznych, narzędzia te umożliwiają:</p>
<ul>
<li>Analizę trendów i zachowań społecznych</li>
<li>Mierzenie skutków różnych polityk</li>
<li>Formułowanie wniosków w oparciu o dowody empiryczne, a nie intuicję</li>
</ul>
<p>Statystyka dostarcza matematycznych podstaw do analizy danych, w tym projektowania badań, syntezy informacji i testowania hipotez. Nauka o danych rozszerza te możliwości, łącząc statystykę z umiejętnościami programowania i wiedzą dziedzinową, umożliwiając pracę ze złożonymi zbiorami danych.</p>
<p>W dzisiejszej erze cyfrowej, wraz z szybko rosnącą ilością dostępnych danych, kompetencje analityczne stały się niezbędne dla współczesnych badaczy i specjalistów nauk społecznych.</p>
<blockquote class="blockquote">
<p><strong>Uwaga</strong></p>
<p>W naukach społecznych nauka o danych stanowi zestaw metod do rozwiązywania złożonych problemów badawczych – łącząc podejścia statystyczne, narzędzia obliczeniowe i specjalistyczną wiedzę w celu skuteczniejszej analizy procesów społecznych.</p>
</blockquote>
</section>
<section id="związek-między-statystyką-a-nauką-o-danych" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="związek-między-statystyką-a-nauką-o-danych"><span class="header-section-number">2.2</span> Związek między Statystyką a Nauką o Danych</h2>
<p>Zamiast traktować statystykę i naukę o danych jako odrębne dyscypliny, korzystniej jest postrzegać je jako podejścia uzupełniające się w ramach spektrum metod analizy danych. Naukę o danych można rozumieć jako współczesne rozszerzenie tradycyjnej statystyki, które ewoluowało w odpowiedzi na:</p>
<ul>
<li>Nowe możliwości technologiczne</li>
<li>Potrzebę analizy coraz bardziej złożonych danych społecznych</li>
<li>Dostępność narzędzi obliczeniowych do przetwarzania dużych zbiorów danych</li>
</ul>
</section>
<section id="podstawowe-pojęcia-w-nauce-o-danych-i-statystyce" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="podstawowe-pojęcia-w-nauce-o-danych-i-statystyce"><span class="header-section-number">2.3</span> Podstawowe Pojęcia w Nauce o Danych i Statystyce</h2>
<section id="dane-i-populacje" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="dane-i-populacje"><span class="header-section-number">2.3.1</span> Dane i Populacje</h3>
<ol type="1">
<li><p><strong>Dane</strong>: Informacje zebrane podczas badania – obejmują odpowiedzi z ankiet, wyniki eksperymentów, wskaźniki ekonomiczne, treści z mediów społecznościowych lub wszelkie inne mierzalne obserwacje.</p></li>
<li><p><strong>Populacja</strong>: Pełny zbiór jednostek (osób, instytucji, zdarzeń), których dotyczy badanie – cała grupa, na temat której badacz chce wyciągnąć wnioski.</p>
<ul>
<li><em>Przykład</em>: W badaniu preferencji wyborczych populację stanowią wszyscy obywatele uprawnieni do głosowania w danym kraju.</li>
</ul></li>
<li><p><strong>Próba</strong>: Podzbiór populacji wybrany do badania. <strong>Reprezentatywna</strong> próba odzwierciedla kluczowe cechy populacji docelowej we właściwych proporcjach.</p>
<ul>
<li><em>Przykład</em>: Zamiast badać wszystkich uprawnionych do głosowania, badacze mogą analizować 1500 losowo wybranych osób, uwzględniając odpowiedni rozkład wieku, płci, wykształcenia i regionu zamieszkania.</li>
</ul>
<p>Właściwie dobrana próba umożliwia wnioskowanie o całej populacji przy jednoczesnym znacznym zmniejszeniu kosztów i czasu badań.</p></li>
<li><p><strong>Dobór próby</strong>: Procedura wybierania osób z populacji do badania. Nieobciążona metoda doboru próby daje każdej osobie w populacji równą szansę wyboru, zapewniając reprezentatywne wyniki.</p></li>
<li><p><strong>Wnioskowanie statystyczne</strong>: Proces wyciągania wniosków o populacji na podstawie danych z próby. Obejmuje:</p>
<ul>
<li>Obliczanie oszacowań parametrów populacji</li>
<li>Ocenę wiarygodności tych oszacowań</li>
<li>Testowanie hipotez dotyczących cech populacji</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/population_vs_sample.png" class="img-fluid figure-img"></p>
<figcaption>Proces wykorzystania próby do oszacowania parametru populacji. W tym przykładzie, w próbie 10 osób stwierdzono, że 6 posiada iPhone’a, co daje szacowaną proporcję w populacji na poziomie 60%. Rzeczywista proporcja w populacji wynosi 53,8%.</figcaption>
</figure>
</div>
</section>
<section id="wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="wnioskowanie-statystyczne-jak-mała-próba-może-reprezentować-dużą-populację"><span class="header-section-number">2.3.2</span> Wnioskowanie Statystyczne: Jak Mała Próba Może Reprezentować Dużą Populację?</h3>
<p>Kiedy ankieterzy badają tylko 1000 wyborców, aby przewidzieć wynik wyborów z 30 000 000 uprawnionych do głosowania (zaledwie 0,003% populacji), może się to wydawać zagadkowe. Jak tak niewielki ułamek może powiedzieć nam coś o całości?</p>
<p>To podobne do próbowania zupy. Gdy gotujesz duży garnek zupy i dokładnie ją mieszasz, nie musisz zjeść całego garnka, aby wiedzieć, jak smakuje. Wystarczy jedna łyżka – o ile zupa jest dobrze wymieszana.</p>
<section id="dlaczego-losowy-dobór-próby-działa" class="level4" data-number="2.3.2.1">
<h4 data-number="2.3.2.1" class="anchored" data-anchor-id="dlaczego-losowy-dobór-próby-działa"><span class="header-section-number">2.3.2.1</span> Dlaczego Losowy Dobór Próby Działa</h4>
<p>Losowy dobór próby działa dzięki trzem kluczowym zasadom:</p>
<ol type="1">
<li><p><strong>Równe szanse</strong>: Każda osoba w populacji ma taką samą szansę na wybór, co zapobiega systematycznemu błędowi.</p></li>
<li><p><strong>Reprezentatywna różnorodność</strong>: Gdy każdy ma równą szansę, naturalnie otrzymujesz osoby ze wszystkich różnych grup w mniej więcej takich samych proporcjach, w jakich występują w populacji.</p>
<p><em>Przykład</em>: Jeśli 51% wyborców to kobiety, to około 51% twojej losowej próby prawdopodobnie będą stanowić kobiety (plus minus pewne losowe wahania).</p></li>
<li><p><strong>Prawo wielkich liczb</strong>: Wraz ze wzrostem wielkości próby (n), losowe wahania stają się mniej wpływowe, a statystyki próby zbliżają się do prawdziwych wartości populacji.</p>
<p><em>Przykład</em>: Jeśli rzucisz monetą 10 razy, możesz otrzymać 7 orłów (70%). Ale jeśli rzucisz nią 1000 razy, jest znacznie bardziej prawdopodobne, że otrzymasz około 500 orłów (50%).</p></li>
</ol>
<p>Bez właściwego losowego doboru próby można łatwo uzyskać próbę obciążoną. Na przykład, gdybyś przeprowadzał ankiety tylko wśród osób w centrum handlowym w dni powszednie rano, pominąłbyś większość pracujących osób i studentów, co dałoby zniekształcony obraz populacji.</p>
</section>
</section>
<section id="zrozumienie-błędu-statystycznego" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="zrozumienie-błędu-statystycznego"><span class="header-section-number">2.3.3</span> Zrozumienie Błędu Statystycznego</h3>
<p>Korzystając z próby do poznania populacji, nieuchronnie napotykamy błąd statystyczny:</p>
<p><strong>Błąd statystyczny</strong> to różnica między naszym oszacowaniem z próby a prawdziwą wartością w populacji. Możemy podzielić go na dwa główne typy:</p>
<ol type="1">
<li><p><strong>Błąd losowy (błąd próbkowania, <em>sampling error</em>)</strong>: Naturalna zmienność, która występuje przypadkowo przy wyborze losowej próby. Dzieje się tak po prostu dlatego, że patrzymy na część, a nie na całą populację.</p>
<p><strong>Błąd standardowy</strong> mierzy ten błąd próbkowania. Pokazuje, jak bardzo nasze statystyki z próby (takie jak średnie czy proporcje) różniłyby się, gdybyśmy wielokrotnie pobierali różne próby z tej samej populacji.</p>
<ul>
<li>Mniejsze błędy standardowe wskazują na bardziej precyzyjne oszacowania</li>
<li>Błąd standardowy zmniejsza się wraz ze wzrostem wielkości próby (w przybliżeniu proporcjonalnie do 1/√n)</li>
<li>Błąd standardowy zależy od zmienności w populacji</li>
</ul></li>
<li><p><strong>Błąd systematyczny (błąd niepróbkowy, <em>non-sampling error</em>)</strong>: Występuje, gdy nasze metody zbierania danych systematycznie zniekształcają wyniki w jednym kierunku. W przeciwieństwie do błędu próbkowania, błędu systematycznego NIE MOŻNA zmniejszyć przez zwiększenie wielkości próby.</p>
<p>Źródła błędu systematycznego obejmują:</p>
<ul>
<li><strong>Błąd selekcji</strong>: Gdy metoda wyboru próby faworyzuje pewne grupy (np. ankiety telefoniczne mogą pomijać osoby bez telefonów)</li>
<li><strong>Błąd odpowiedzi</strong>: Gdy respondenci udzielają niedokładnych odpowiedzi (np. zawyżanie dochodów)</li>
<li><strong>Błąd braku odpowiedzi</strong>: Gdy osoby, które odmawiają udziału, różnią się od tych, które uczestniczą</li>
<li><strong>Błąd pomiaru</strong>: Wynikający z niedokładnych narzędzi lub metod pomiarowych</li>
</ul></li>
</ol>
<p>Na przykład, jeśli obliczamy średni wzrost z próby, błąd standardowy mówi nam, jak bardzo ta średnia mogłaby się różnić, gdybyśmy wielokrotnie pobierali różne losowe próby. Jednak jeśli nasze urządzenie pomiarowe jest wadliwe i zawsze dodaje 2,5 cm do każdego pomiaru, mamy błąd systematyczny, którego zwiększenie wielkości próby nie naprawi.</p>
<p>Dobry projekt badania musi uwzględniać oba typy błędów:</p>
<ul>
<li>Błąd próbkowania można zmniejszyć zwiększając wielkość próby</li>
<li>Błąd systematyczny można zmniejszyć tylko przez ulepszenie metod zbierania danych</li>
</ul>
</section>
<section id="dobór-wielkości-próby" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="dobór-wielkości-próby"><span class="header-section-number">2.3.4</span> Dobór Wielkości Próby</h3>
<p>Niezbędna wielkość próby zależy od trzech głównych czynników:</p>
<ol type="1">
<li><p><strong>Jaki rodzaj oszacowania wykonujesz?</strong> (proporcja czy średnia)</p></li>
<li><p><strong>Jak dokładne musi być twoje oszacowanie?</strong></p>
<ul>
<li>Większa dokładność = większa próba</li>
<li>Przykład: Oszacowanie z dokładnością do ±1% wymaga około 9 razy więcej osób niż oszacowanie z dokładnością do ±3%</li>
</ul></li>
<li><p><strong>Jak zróżnicowana jest twoja populacja?</strong></p>
<ul>
<li>Dla proporcji: Maksymalna zmienność występuje przy 50%, minimalna przy 0% lub 100%</li>
<li>Dla średnich: Sprawdź, jak bardzo pomiary różnią się między sobą (wariancja)</li>
</ul></li>
</ol>
<section id="uwagi-dotyczące-małych-populacji" class="level4" data-number="2.3.4.1">
<h4 data-number="2.3.4.1" class="anchored" data-anchor-id="uwagi-dotyczące-małych-populacji"><span class="header-section-number">2.3.4.1</span> Uwagi dotyczące małych populacji</h4>
<p>Pracując z małymi populacjami (np. 1000 osób lub mniej):</p>
<ul>
<li>Istnieją znaczące różnice metodologiczne w porównaniu do dużych populacji</li>
<li>Prosta próba losowa tradycyjnie zakłada losowanie ze zwracaniem</li>
<li>W praktyce badawczej zazwyczaj stosuje się losowanie bez zwracania</li>
<li>Im mniejsza populacja, tym większa różnica między tymi podejściami</li>
<li><strong>Współczynnik korekty dla populacji skończonej</strong> staje się niezbędny podczas badania więcej niż 5-10% populacji</li>
</ul>
<p><strong>Praktyczne zalecenia dla małych populacji:</strong></p>
<ul>
<li>Dla populacji poniżej 200 jednostek, rozważ pełny spis (badanie całej populacji)</li>
<li>Stosuj odpowiednie formuły statystyczne uwzględniające losowanie bez zwracania</li>
<li>Standardowe formuły dla błędów standardowych oparte na losowaniu ze zwracaniem przeszacują błąd w małych populacjach</li>
<li>Jasno dokumentuj mechanizm doboru próby w raportach badawczych</li>
</ul>
<p><strong>Wyjaśnienie różnicy:</strong></p>
<ul>
<li>Losowanie ze zwracaniem: każda jednostka ma stałe prawdopodobieństwo wyboru w każdym losowaniu (np. 1/N)</li>
<li>Losowanie bez zwracania: prawdopodobieństwo wyboru zmienia się w kolejnych losowaniach (z 1/N na 1/(N-1), 1/(N-2) itd.)</li>
<li>W dużych populacjach różnica jest minimalna, w małych - fundamentalna</li>
<li>Schematy losowania bez zwracania mają często mniejszą wariancję estymatora niż przy losowaniu ze zwracaniem</li>
</ul>
</section>
</section>
<section id="proporcje-a-średnie" class="level3" data-number="2.3.5">
<h3 data-number="2.3.5" class="anchored" data-anchor-id="proporcje-a-średnie"><span class="header-section-number">2.3.5</span> Proporcje a Średnie</h3>
<section id="proporcje-odsetki" class="level4" data-number="2.3.5.1">
<h4 data-number="2.3.5.1" class="anchored" data-anchor-id="proporcje-odsetki"><span class="header-section-number">2.3.5.1</span> Proporcje (odsetki)</h4>
<p>Przy szacowaniu proporcji (np. odsetka wyborców popierających danego kandydata), wymagana wielkość próby zależy w dużej mierze od tego, jak blisko ta proporcja jest 50%.</p>
<p><strong>Dlaczego proporcje bliskie 50% wymagają większych prób:</strong></p>
<p>Spójrzmy na konkretny przykład z różnymi wielkościami próby:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 43%">
<col style="width: 25%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Prawdziwa Proporcja w Populacji</th>
<th>Wielkość Próby</th>
<th>Typowy Margines Błędu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>50% (maksymalna niepewność)</td>
<td>100</td>
<td>±10 punktów procentowych</td>
</tr>
<tr class="even">
<td>50% (maksymalna niepewność)</td>
<td>400</td>
<td>±5 punktów procentowych</td>
</tr>
<tr class="odd">
<td>50% (maksymalna niepewność)</td>
<td>1000</td>
<td>±3 punkty procentowe</td>
</tr>
<tr class="even">
<td>10% (mniejsza niepewność)</td>
<td>100</td>
<td>±6 punktów procentowych</td>
</tr>
<tr class="odd">
<td>10% (mniejsza niepewność)</td>
<td>400</td>
<td>±3 punkty procentowe</td>
</tr>
<tr class="even">
<td>10% (mniejsza niepewność)</td>
<td>1000</td>
<td>±2 punkty procentowe</td>
</tr>
</tbody>
</table>
<p>Te liczby pokazują dwa ważne wzorce: 1. <strong>Wraz ze wzrostem wielkości próby maleje margines błędu</strong> (porównując wiersze) 2. <strong>Przy tej samej wielkości próby, proporcje bliskie 50% mają większe marginesy błędu</strong> niż proporcje bliskie 0% lub 100% (porównując 50% vs 10%)</p>
<p>Dzieje się tak, ponieważ proporcje podlegają rozkładowi dwumianowemu, gdzie wariancja jest maksymalna przy p=0,5 (50%) i minimalna przy p=0 lub p=1 (0% lub 100%).</p>
<p><strong>Wielkość populacji ma minimalny wpływ:</strong></p>
<p>Dla typowego sondażu wyborczego z proporcjami bliskimi 50%, około 1000 losowo wybranych osób zapewnia dokładność około ±3 punktów procentowych. Co zaskakujące, ta wielkość próby pozostaje w przybliżeniu taka sama, niezależnie od tego, czy populacja liczy 30 000 czy 30 milionów. Ta nieintuicyjna prawidłowość wyjaśnia, dlaczego sondaże ogólnokrajowe mogą być dokładne przy stosunkowo małych próbach.</p>
</section>
<section id="średnie" class="level4" data-number="2.3.5.2">
<h4 data-number="2.3.5.2" class="anchored" data-anchor-id="średnie"><span class="header-section-number">2.3.5.2</span> Średnie</h4>
<p>Przy szacowaniu średniej (np. typowego dochodu gospodarstwa domowego lub wzrostu):</p>
<ul>
<li>Średnia podsumowuje ciągłe pomiary, które mogą przyjmować wiele różnych wartości</li>
<li>Wielkość próby zależy głównie od tego, jak bardzo te pomiary różnią się między osobami</li>
<li>Kluczowe uwagi:
<ul>
<li>Populacje z bardziej zróżnicowanymi pomiarami wymagają większych prób</li>
<li>Dokładniejsze oszacowania wymagają większych prób</li>
<li>W przeciwieństwie do proporcji, nie ma “maksymalnej niepewności” przy określonej wartości</li>
</ul></li>
<li>Na przykład, oszacowanie średniego dochodu może wymagać większej próby niż oszacowanie średniego wzrostu, ponieważ dochody zwykle różnią się bardziej niż wzrost</li>
</ul>
</section>
<section id="parametry-modeli-regresji" class="level4" data-number="2.3.5.3">
<h4 data-number="2.3.5.3" class="anchored" data-anchor-id="parametry-modeli-regresji"><span class="header-section-number">2.3.5.3</span> Parametry Modeli Regresji</h4>
<p>Przy szacowaniu parametrów modeli regresji:</p>
<ul>
<li><p><strong>Czym jest regresja?</strong> Modele regresji opisują, jak jedna zmienna (zmienna zależna) odnosi się do jednej lub więcej innych zmiennych (zmiennych niezależnych). Na przykład, jak sprzedaż zależy od wydatków na reklamę lub jak plony zależą od opadów i temperatury.</p></li>
<li><p>Te parametry pokazują związki między zmiennymi</p></li>
<li><p>Wielkość próby dla modeli regresji jest bardziej złożona niż dla prostych średnich czy proporcji</p></li>
<li><p>Kluczowe czynniki wpływające na wymaganą wielkość próby:</p>
<ul>
<li>Liczba zmiennych w modelu (więcej zmiennych = większa próba)</li>
<li>Siła badanych efektów (słabsze efekty wymagają większych prób do wykrycia)</li>
<li>Zmienność danych (większa zmienność = większa próba)</li>
<li>Złożoność modelu (bardziej złożone modele wymagają większych prób)</li>
</ul></li>
</ul>
<p><strong>Proste zasady dla modeli regresji:</strong></p>
<ul>
<li>Podstawowa reguła: co najmniej 10-20 obserwacji na zmienną w modelu</li>
<li>Do wykrywania subtelnych efektów: może być potrzebne 100+ obserwacji na zmienną</li>
<li>Modele wielopoziomowe lub hierarchiczne: wymagają znacznie większych prób</li>
</ul>
</section>
</section>
<section id="przykład-maksymalnej-niepewności-dlaczego-50-to-najgorszy-przypadek" class="level3" data-number="2.3.6">
<h3 data-number="2.3.6" class="anchored" data-anchor-id="przykład-maksymalnej-niepewności-dlaczego-50-to-najgorszy-przypadek"><span class="header-section-number">2.3.6</span> Przykład Maksymalnej Niepewności: Dlaczego 50% to “Najgorszy Przypadek”</h3>
<p>Aby zrozumieć, dlaczego proporcje bliskie 50% wymagają większych prób, przyjrzyjmy się symulacji:</p>
<p>Wyobraź sobie, że masz 100 monet w torbie, które są albo złote, albo srebrne. Chcesz oszacować, jaki procent stanowią złote monety, losowo wybierając 20 monet.</p>
<p><strong>Scenariusz A: 50% Złotych (Maksymalna Niepewność)</strong></p>
<ul>
<li>Torba zawiera 50 złotych i 50 srebrnych monet (50% złotych)</li>
<li>Zasymulujmy losowanie 20 monet 10 różnych razy:
<ul>
<li>Losowanie 1: 8 złotych monet (40% - błąd o 10%)</li>
<li>Losowanie 2: 12 złotych monet (60% - błąd o 10%)</li>
<li>Losowanie 3: 9 złotych monet (45% - błąd o 5%)</li>
<li>Losowanie 4: 7 złotych monet (35% - błąd o 15%)</li>
<li>Losowanie 5: 11 złotych monet (55% - błąd o 5%)</li>
<li>Losowanie 6: 14 złotych monet (70% - błąd o 20%)</li>
<li>Losowanie 7: 8 złotych monet (40% - błąd o 10%)</li>
<li>Losowanie 8: 10 złotych monet (50% - idealnie!)</li>
<li>Losowanie 9: 7 złotych monet (35% - błąd o 15%)</li>
<li>Losowanie 10: 12 złotych monet (60% - błąd o 10%)</li>
</ul></li>
</ul>
<p>Te wyniki różnią się znacznie, od 35% do 70%, ze średnim błędem wynoszącym 10 punktów procentowych!</p>
<p><strong>Scenariusz B: 10% Złotych (Mniejsza Niepewność)</strong></p>
<ul>
<li>Torba zawiera 10 złotych i 90 srebrnych monet (10% złotych)</li>
<li>Zasymulujmy losowanie 20 monet 10 różnych razy:
<ul>
<li>Losowanie 1: 1 złota moneta (5% - błąd o 5%)</li>
<li>Losowanie 2: 2 złote monety (10% - idealnie!)</li>
<li>Losowanie 3: 3 złote monety (15% - błąd o 5%)</li>
<li>Losowanie 4: 1 złota moneta (5% - błąd o 5%)</li>
<li>Losowanie 5: 2 złote monety (10% - idealnie!)</li>
<li>Losowanie 6: 0 złotych monet (0% - błąd o 10%)</li>
<li>Losowanie 7: 3 złote monety (15% - błąd o 5%)</li>
<li>Losowanie 8: 2 złote monety (10% - idealnie!)</li>
<li>Losowanie 9: 1 złota moneta (5% - błąd o 5%)</li>
<li>Losowanie 10: 2 złote monety (10% - idealnie!)</li>
</ul></li>
</ul>
<p>Te wyniki pozostają znacznie bliżej prawdziwych 10%, wahając się od 0% do 15%, ze średnim błędem wynoszącym tylko 4 punkty procentowe.</p>
<p>To pokazuje, dlaczego potrzebujemy większych prób, gdy proporcja jest bliska 50% - naturalna zmienność jest znacznie większa. Gdy prawdziwa proporcja wynosi 50%, każde odchylenie od tej idealnej równowagi jest równie prawdopodobne w dowolnym kierunku, tworząc maksymalną niepewność.</p>
<section id="przykład-sondażu-opinii-popularni-a-niepopularni-kandydaci" class="level4" data-number="2.3.6.1">
<h4 data-number="2.3.6.1" class="anchored" data-anchor-id="przykład-sondażu-opinii-popularni-a-niepopularni-kandydaci"><span class="header-section-number">2.3.6.1</span> Przykład Sondażu Opinii: Popularni a Niepopularni Kandydaci</h4>
<p>W sondażu wyborczym z 1000 osób:</p>
<p><strong>Dla głównego kandydata z poparciem 40%:</strong></p>
<ul>
<li>Nasza dokładność wyniosłaby około ±3 punktów procentowych</li>
<li>Możemy oszacować jego poparcie między 37% a 43%</li>
</ul>
<p><strong>Dla kandydata z mniejszym poparciem 3%:</strong></p>
<ul>
<li>Nasza dokładność wyniosłaby około ±1 punkt procentowy</li>
<li>Możemy oszacować jego poparcie między 2% a 4%</li>
</ul>
<p><strong>Ważne wyjaśnienie dotyczące dokładności:</strong></p>
<ol type="1">
<li><p><strong>Dokładność bezwzględna (w punktach procentowych):</strong></p>
<ul>
<li>Dla kandydata z mniejszym poparciem (3%): ±1 punkt procentowy (mniejszy błąd bezwzględny)</li>
<li>Dla głównego kandydata (40%): ±3 punkty procentowe (większy błąd bezwzględny)</li>
</ul></li>
<li><p><strong>Dokładność względna (jako proporcja oszacowania):</strong></p>
<ul>
<li>Dla kandydata z mniejszym poparciem (3%): ±1 punkt procentowy to 33% jego poziomu poparcia</li>
<li>Dla głównego kandydata (40%): ±3 punkty procentowe to tylko 7,5% jego poziomu poparcia</li>
</ul></li>
</ol>
<p>To wyjaśnia, dlaczego sondaże mogą wiarygodnie wykrywać obecność kandydatów z mniejszym poparciem, ale mogą mieć trudności z precyzyjnym mierzeniem małych zmian w ich poziomach poparcia. Ta sama wielkość próby daje różne dokładności bezwzględne w zależności od tego, jak blisko proporcja jest 50%.</p>
</section>
</section>
<section id="podsumowanie-kluczowe-punkty-do-zapamiętania" class="level3" data-number="2.3.7">
<h3 data-number="2.3.7" class="anchored" data-anchor-id="podsumowanie-kluczowe-punkty-do-zapamiętania"><span class="header-section-number">2.3.7</span> Podsumowanie: Kluczowe Punkty do Zapamiętania</h3>
<ol type="1">
<li><p><strong>Statystyka i nauka o danych</strong> dostarczają niezbędnych narzędzi do zrozumienia zjawisk społecznych poprzez analizę danych.</p></li>
<li><p><strong>Właściwie dobrane próby</strong> pozwalają na wiarygodne wnioskowanie o całych populacjach bez badania wszystkich.</p></li>
<li><p><strong>Błąd statystyczny</strong> występuje w dwóch formach:</p>
<ul>
<li>Błąd losowy (zmniejszany przez większe próby)</li>
<li>Błąd systematyczny (zmniejszany przez lepszą metodologię)</li>
</ul></li>
<li><p><strong>Potrzebna wielkość próby</strong> zależy od:</p>
<ul>
<li>Co mierzysz (proporcje czy średnie)</li>
<li>Pożądanej dokładności</li>
<li>Zmienności w populacji</li>
<li>W przypadku proporcji, wartości bliskie 50% wymagają większych prób</li>
</ul></li>
<li><p><strong>Małe populacje</strong> wymagają specjalnych rozważań dotyczących doboru próby i mogą korzystać z współczynnika korekty dla populacji skończonej.</p></li>
</ol>
<p>Zrozumienie tych podstawowych pojęć pozwoli ci lepiej projektować i interpretować badania w naukach społecznych.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="language">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">SRS</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Dobór warstwowy</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Dobór grupowy</a></li></ul>
<div class="tab-content" data-group="language">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><strong>Prosty Dobór Losowy</strong>: Każda jednostka ma równe prawdopodobieństwo wyboru. Cała populacja jest losowo próbkowana bez żadnego z góry ustalonego wzorca.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Simple_Random_Sampling2.svg" class="img-fluid figure-img"></p>
<figcaption>Prosty Dobór Losowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><strong>Dobór Warstwowy</strong>: Populacja jest podzielona na odrębne podgrupy (warstwy) przed losowym pobraniem próbek z każdej warstwy proporcjonalnie.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Stratified2.svg" class="img-fluid figure-img"></p>
<figcaption>Dobór Warstwowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><strong>Dobór Grupowy</strong>: Populacja jest podzielona na skupiska (klastry), a całe skupiska są losowo wybierane do analizy zamiast pojedynczych jednostek.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Cluster2.svg" class="img-fluid figure-img"></p>
<figcaption>Dobór Grupowy. Źródło: https://app.passyourmath.com/courses/theory/116/1750/26640/en</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data Generating Process i Superpopulacja w kontekście badań statystycznych
</div>
</div>
<div class="callout-body-container callout-body">
<p>W statystyce i ekonometrii często posługujemy się pojęciami populacji i próby. Jednak dla pełnego zrozumienia statystycznych modeli warto wprowadzić dwa dodatkowe koncepty: <strong>data generating process (DGP)</strong> oraz <strong>superpopulację</strong>. Pojęcia te pomogą lepiej zrozumieć, w jaki sposób powstają dane, które analizujemy.</p>
<section id="podstawowe-pojęcia" class="level3" data-number="2.3.8">
<h3 data-number="2.3.8" class="anchored" data-anchor-id="podstawowe-pojęcia"><span class="header-section-number">2.3.8</span> Podstawowe pojęcia</h3>
<p><strong>Populacja</strong>: Zbiór wszystkich jednostek (osób, firm, krajów itp.), które są przedmiotem naszego badania. Przykładowo, wszystkie gospodarstwa domowe w Polsce.</p>
<p><strong>Próba</strong>: Podzbiór populacji, który badamy, aby wyciągnąć wnioski o całej populacji. Przykładowo, 1000 losowo wybranych gospodarstw domowych w Polsce.</p>
</section>
<section id="data-generating-process-dgp" class="level3" data-number="2.3.9">
<h3 data-number="2.3.9" class="anchored" data-anchor-id="data-generating-process-dgp"><span class="header-section-number">2.3.9</span> Data Generating Process (DGP)</h3>
<p><strong>Data Generating Process</strong> (proces generujący dane) to mechanizm lub model stochastyczny (losowy), który określa, w jaki sposób powstają wartości zmiennych, które obserwujemy.</p>
<p>Kluczowe cechy DGP:</p>
<ul>
<li>Jest to abstrakcyjny, matematyczny model opisujący, jak zmienne są ze sobą powiązane</li>
<li>Zawiera zarówno element deterministyczny (przewidywalny), jak i losowy (nieprzewidywalny)</li>
<li>Zwykle wyrażany za pomocą równań i rozkładów prawdopodobieństwa</li>
</ul>
<section id="przykład-dgp" class="level4" data-number="2.3.9.1">
<h4 data-number="2.3.9.1" class="anchored" data-anchor-id="przykład-dgp"><span class="header-section-number">2.3.9.1</span> Przykład DGP:</h4>
<p>Załóżmy, że badamy dochody gospodarstw domowych. Model DGP (równanie matematyczne) mógłby wyglądać tak:</p>
<p><span class="math inline">Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \varepsilon_i</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y_i</span> to dochód gospodarstwa domowego <span class="math inline">i</span></li>
<li><span class="math inline">X_{1i}</span> to liczba osób pracujących w gospodarstwie <span class="math inline">i</span></li>
<li><span class="math inline">X_{2i}</span> to poziom wykształcenia głównego żywiciela gospodarstwa <span class="math inline">i</span></li>
<li><span class="math inline">\varepsilon_i</span> to czynnik losowy (błąd)</li>
<li><span class="math inline">\beta_0, \beta_1, \beta_2</span> to parametry modelu</li>
</ul>
<p>W tym przykładzie DGP określa, jak dochód zależy od liczby pracujących osób i wykształcenia, plus element losowy.</p>
</section>
</section>
<section id="superpopulacja" class="level3" data-number="2.3.10">
<h3 data-number="2.3.10" class="anchored" data-anchor-id="superpopulacja"><span class="header-section-number">2.3.10</span> Superpopulacja</h3>
<p><strong>Superpopulacja</strong> to hipotetyczna, nieskończona populacja, z której nasza rzeczywista populacja może być traktowana jako próba.</p>
<p>Kluczowe cechy superpopulacji:</p>
<ul>
<li>Jest konceptualnym rozszerzeniem pojęcia populacji</li>
<li>Reprezentuje wszystkie możliwe realizacje procesu generującego dane (DGP)</li>
<li>Pozwala na wnioskowanie nie tylko o aktualnej populacji, ale o ogólnych prawidłowościach</li>
</ul>
<section id="przykłady-superpopulacji" class="level4" data-number="2.3.10.1">
<h4 data-number="2.3.10.1" class="anchored" data-anchor-id="przykłady-superpopulacji"><span class="header-section-number">2.3.10.1</span> Przykłady superpopulacji:</h4>
<ol type="1">
<li><p>Badamy wyniki matur w Polsce w 2024 roku (populacja). Superpopulacja to hipotetyczne wyniki matur wszystkich możliwych uczniów, którzy mogliby zdawać maturę w podobnych warunkach, w dowolnym roku.</p></li>
<li><p>Analizujemy PKB krajów europejskich w 2023 roku (populacja). Superpopulacja to wszystkie możliwe realizacje PKB tych krajów w różnych warunkach gospodarczych.</p></li>
</ol>
</section>
</section>
<section id="relacje-między-pojęciami" class="level3" data-number="2.3.11">
<h3 data-number="2.3.11" class="anchored" data-anchor-id="relacje-między-pojęciami"><span class="header-section-number">2.3.11</span> Relacje między pojęciami</h3>
<pre><code>DGP → Superpopulacja → Populacja → Próba</code></pre>
<ul>
<li><strong>DGP</strong> definiuje mechanizm generowania danych</li>
<li><strong>Superpopulacja</strong> to wszystkie możliwe realizacje DGP</li>
<li><strong>Populacja</strong> to konkretna, skończona realizacja z superpopulacji</li>
<li><strong>Próba</strong> to podzbiór populacji, który faktycznie obserwujemy i analizujemy</li>
</ul>
</section>
<section id="praktyczne-znaczenie" class="level3" data-number="2.3.12">
<h3 data-number="2.3.12" class="anchored" data-anchor-id="praktyczne-znaczenie"><span class="header-section-number">2.3.12</span> Praktyczne znaczenie</h3>
<section id="dlaczego-te-pojęcia-są-ważne" class="level4" data-number="2.3.12.1">
<h4 data-number="2.3.12.1" class="anchored" data-anchor-id="dlaczego-te-pojęcia-są-ważne"><span class="header-section-number">2.3.12.1</span> Dlaczego te pojęcia są ważne?</h4>
<ol type="1">
<li><p><strong>Modelowanie ekonometryczne</strong> - DGP jest fundamentem modelowania ekonometrycznego, pozwala zrozumieć, jak zmienne ekonomiczne wpływają na siebie nawzajem.</p></li>
<li><p><strong>Wnioskowanie statystyczne</strong> - Koncepcja superpopulacji pozwala na formułowanie wniosków ogólnych, wykraczających poza konkretny moment czasowy czy grupę.</p></li>
<li><p><strong>Prognozowanie</strong> - Zrozumienie DGP umożliwia lepsze prognozowanie przyszłych wartości zmiennych ekonomicznych.</p></li>
<li><p><strong>Weryfikacja hipotez</strong> - Pozwala lepiej określić, czy zaobserwowane zależności są dziełem przypadku, czy odzwierciedlają rzeczywiste prawidłowości.</p></li>
</ol>
</section>
</section>
<section id="przykład-zastosowania-w-ekonomii" class="level3" data-number="2.3.13">
<h3 data-number="2.3.13" class="anchored" data-anchor-id="przykład-zastosowania-w-ekonomii"><span class="header-section-number">2.3.13</span> Przykład zastosowania w ekonomii</h3>
<p>Załóżmy, że ekonomista bada wpływ stóp procentowych na inflację:</p>
<ul>
<li><strong>DGP</strong>: Równanie opisujące, jak stopa procentowa i inne czynniki wpływają na inflację</li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe wartości inflacji przy różnych poziomach stóp procentowych i innych czynników</li>
<li><strong>Populacja</strong>: Faktyczne wartości inflacji we wszystkich krajach w danym okresie</li>
<li><strong>Próba</strong>: Dane o inflacji z 30 wybranych krajów, które badamy</li>
</ul>
</section>
<section id="przykłady-ze-studiów-wyborczych" class="level3" data-number="2.3.14">
<h3 data-number="2.3.14" class="anchored" data-anchor-id="przykłady-ze-studiów-wyborczych"><span class="header-section-number">2.3.14</span> Przykłady ze studiów wyborczych</h3>
<p><strong>Przykład 1: Frekwencja wyborcza</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Frekwencja_i = \beta_0 + \beta_1 Wiek_i + \beta_2 Wykształcenie_i + \beta_3 Dochód_i + \varepsilon_i</span></li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe decyzje o udziale w wyborach, które mogliby podjąć wyborcy o różnych cechach społeczno-demograficznych w różnych warunkach</li>
<li><strong>Populacja</strong>: Wszyscy uprawnieni do głosowania w wyborach prezydenckich 2020</li>
<li><strong>Próba</strong>: 1500 respondentów ankiety exit poll po wyborach</li>
</ul>
<p><strong>Przykład 2: Poparcie dla partii politycznych</strong></p>
<ul>
<li><strong>DGP</strong>: <span class="math inline">Poparcie_{ij} = \beta_0 + \beta_1 Ideologia_i + \beta_2 SytuacjaEkonomiczna_i + \beta_3 Wiek_i + \varepsilon_i</span></li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe preferencje wyborcze osób o różnych cechach w różnych warunkach społeczno-ekonomicznych</li>
<li><strong>Populacja</strong>: Wszyscy wyborcy w Polsce w 2023 roku</li>
<li><strong>Próba</strong>: Respondenci sondażu przedwyborczego (n=1000)</li>
</ul>
</section>
<section id="symulacja-i-estymacja-funkcji-popytu-jako-dgp-w-r" class="level3" data-number="2.3.15">
<h3 data-number="2.3.15" class="anchored" data-anchor-id="symulacja-i-estymacja-funkcji-popytu-jako-dgp-w-r"><span class="header-section-number">2.3.15</span> Symulacja i estymacja funkcji popytu jako DGP w R</h3>
<p>Poniższy kod ilustruje, jak można zasymulować funkcję popytu z wieloma predyktorami jako DGP i estymować jej parametry za pomocą regresji OLS:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Załadowanie potrzebnych pakietów</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ustawienie ziarna losowości dla powtarzalnych wyników</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Zdefiniowanie "prawdziwego" DGP: Funkcja popytu na produkt</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Model: Q = beta0 + beta1*P + beta2*I + beta3*P_sub + beta4*P_comp + beta5*A + epsilon</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Gdzie:</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Q = ilość popytu na produkt</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># P = cena produktu</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># I = dochód konsumentów</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># P_sub = cena dobra substytucyjnego</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># P_comp = cena dobra komplementarnego</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># A = wydatki na reklamę</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Prawdziwe wartości parametrów (zgodne z teorią ekonomiczną)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>beta0_true <span class="ot">&lt;-</span> <span class="dv">100</span>      <span class="co"># Stała</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>beta1_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span>     <span class="co"># Efekt własnej ceny (ujemny - zgodnie z prawem popytu)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>beta2_true <span class="ot">&lt;-</span> <span class="fl">0.8</span>      <span class="co"># Efekt dochodu (dodatni - dobro normalne)</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>beta3_true <span class="ot">&lt;-</span> <span class="fl">1.2</span>      <span class="co"># Efekt ceny substytutu (dodatni)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>beta4_true <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span>     <span class="co"># Efekt ceny dobra komplementarnego (ujemny)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>beta5_true <span class="ot">&lt;-</span> <span class="fl">0.5</span>      <span class="co"># Efekt reklamy (dodatni)</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>sigma_true <span class="ot">&lt;-</span> <span class="dv">5</span>        <span class="co"># Odchylenie standardowe błędu losowego</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Symulacja superpopulacji (5000 potencjalnych rynków/okresów)</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>n_super <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie predyktorów</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>cena <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)               <span class="co"># Cena produktu (zł)</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>dochod <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">3000</span>, <span class="at">sd =</span> <span class="dv">500</span>)         <span class="co"># Średni dochód (zł)</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>cena_substytutu <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">4</span>, <span class="at">max =</span> <span class="dv">16</span>)    <span class="co"># Cena substytutu (zł)</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>cena_komplementu <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">8</span>)    <span class="co"># Cena komplementu (zł)</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>reklama <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_super, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>)           <span class="co"># Wydatki na reklamę (tys. zł)</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodanie korelacji między zmiennymi (np. cena i cena substytutu)</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>cena_substytutu <span class="ot">&lt;-</span> cena_substytutu <span class="sc">+</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="fl">0.2</span> <span class="sc">*</span> cena, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie popytu zgodnie z DGP</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_super, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma_true)  <span class="co"># Składnik losowy</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>popyt <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>         beta1_true <span class="sc">*</span> cena <span class="sc">+</span> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>         beta2_true <span class="sc">*</span> (dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span>  <span class="co"># skalowanie dochodu dla lepszej interpretacji</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>         beta3_true <span class="sc">*</span> cena_substytutu <span class="sc">+</span> </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>         beta4_true <span class="sc">*</span> cena_komplementu <span class="sc">+</span> </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>         beta5_true <span class="sc">*</span> (reklama<span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span>    <span class="co"># skalowanie reklamy dla lepszej interpretacji</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>         epsilon</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych superpopulacji</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>superpopulacja <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_super,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena =</span> cena,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> dochod,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_substytutu =</span> cena_substytutu,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_komplementu =</span> cena_komplementu,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">reklama =</span> reklama,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">popyt =</span> popyt</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Pokaż kilka pierwszych obserwacji</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(superpopulacja)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
     id  cena dochod cena_substytutu cena_komplementu reklama popyt
  &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1     1  7.88  2661.           11.9              7.95    50.4  89.5
2     2 12.9   3287.            7.10             3.81    88.5  79.6
3     3  9.09  2648.           14.5              4.60    94.1  87.7
4     4 13.8   2733.           19.0              2.96    80.3  84.1
5     5 14.4   3387.           11.1              6.94    66.0  73.0
6     6  5.46  2762.           13.2              3.25    32.8  95.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Pobieranie próby z superpopulacji (np. 200 obserwacji)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>indeksy_proby <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n_super, n_sample)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>proba <span class="ot">&lt;-</span> superpopulacja[indeksy_proby, ]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Estymacja modelu OLS na podstawie próby</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>model_ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(popyt <span class="sc">~</span> cena <span class="sc">+</span> <span class="fu">I</span>(dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> cena_substytutu <span class="sc">+</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                cena_komplementu <span class="sc">+</span> <span class="fu">I</span>(reklama<span class="sc">/</span><span class="dv">10</span>), <span class="at">data =</span> proba)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Wyświetlenie podsumowania modelu</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_ols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = popyt ~ cena + I(dochod/1000) + cena_substytutu + 
    cena_komplementu + I(reklama/10), data = proba)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5705  -2.8401   0.1072   2.9881  14.1873 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       99.8079     2.7949  35.711  &lt; 2e-16 ***
cena              -2.3571     0.1196 -19.711  &lt; 2e-16 ***
I(dochod/1000)     0.5259     0.6850   0.768 0.443582    
cena_substytutu    1.1635     0.0918  12.674  &lt; 2e-16 ***
cena_komplementu  -0.7483     0.1933  -3.871 0.000148 ***
I(reklama/10)      0.5600     0.1170   4.785 3.38e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.843 on 194 degrees of freedom
Multiple R-squared:  0.7377,    Adjusted R-squared:  0.7309 
F-statistic: 109.1 on 5 and 194 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Porównanie prawdziwych parametrów z estymowanymi</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>parametry_prawdziwe <span class="ot">&lt;-</span> <span class="fu">c</span>(beta0_true, beta1_true, beta2_true, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                         beta3_true, beta4_true, beta5_true)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>parametry_estymowane <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_ols)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>porownanie <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parametr =</span> <span class="fu">c</span>(<span class="st">"Stała"</span>, <span class="st">"Cena"</span>, <span class="st">"Dochód (tys.)"</span>, <span class="st">"Cena substytutu"</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Cena komplementu"</span>, <span class="st">"Reklama (10 tys.)"</span>),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  prawdziwa_wartość <span class="ot">=</span> parametry_prawdziwe,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  estymowana_wartość <span class="ot">=</span> parametry_estymowane,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  różnica <span class="ot">=</span> estymowana_wartość <span class="sc">-</span> prawdziwa_wartość,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  błąd<span class="at">_procentowy =</span> <span class="fu">abs</span>(różnica <span class="sc">/</span> prawdziwa_wartość) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(porownanie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  parametr          prawdziwa_wartość estymowana_wartość różnica błąd_procentowy
  &lt;chr&gt;                         &lt;dbl&gt;              &lt;dbl&gt;   &lt;dbl&gt;           &lt;dbl&gt;
1 Stała                         100               99.8   -0.192            0.192
2 Cena                           -2.5             -2.36   0.143            5.72 
3 Dochód (tys.)                   0.8              0.526 -0.274           34.3  
4 Cena substytutu                 1.2              1.16  -0.0365           3.04 
5 Cena komplementu               -0.7             -0.748 -0.0483           6.90 
6 Reklama (10 tys.)               0.5              0.560  0.0600          12.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Wizualizacja porównania prawdziwych i estymowanych parametrów</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(porownanie, <span class="fu">aes</span>(<span class="at">x =</span> parametr, <span class="at">y =</span> prawdziwa_wartość)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> estymowana_wartość), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> parametr, <span class="at">y =</span> prawdziwa_wartość, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> estymowana_wartość), <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porównanie prawdziwego DGP z estymowanym modelem"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Niebieskie punkty: prawdziwe wartości, czerwone punkty: estymowane wartości"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Parametr"</span>, <span class="at">y =</span> <span class="st">"Wartość"</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Sprawdzenie zdolności predykcyjnej modelu na nowych danych</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pobieramy nowe dane z superpopulacji (nie używane w estymacji)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>nowe_indeksy <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n_super, indeksy_proby), <span class="dv">100</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>nowe_dane <span class="ot">&lt;-</span> superpopulacja[nowe_indeksy, ]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Predykcja na nowych danych</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>nowe_dane<span class="sc">$</span>przewidywany_popyt <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ols, <span class="at">newdata =</span> nowe_dane)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie błędu średniokwadratowego (MSE) predykcji</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((nowe_dane<span class="sc">$</span>popyt <span class="sc">-</span> nowe_dane<span class="sc">$</span>przewidywany_popyt)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pierwiastek błędu średniokwadratowego (RMSE):"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pierwiastek błędu średniokwadratowego (RMSE): 5.47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Wizualizacja relacji między ceną a popytem</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (efekt ceteris paribus - przy kontroli innych zmiennych)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ceteris_paribus <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="at">length.out =</span> <span class="dv">100</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>dochod),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_substytutu =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>cena_substytutu),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cena_komplementu =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>cena_komplementu),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">reklama =</span> <span class="fu">mean</span>(proba<span class="sc">$</span>reklama)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie przewidywanego popytu według prawdziwego DGP</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>popyt_prawdziwy <span class="ot">&lt;-</span> beta0_true <span class="sc">+</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                                 beta1_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena <span class="sc">+</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                                 beta2_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>dochod<span class="sc">/</span><span class="dv">1000</span>) <span class="sc">+</span> </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                                 beta3_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena_substytutu <span class="sc">+</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                                 beta4_true <span class="sc">*</span> ceteris_paribus<span class="sc">$</span>cena_komplementu <span class="sc">+</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                                 beta5_true <span class="sc">*</span> (ceteris_paribus<span class="sc">$</span>reklama<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie przewidywanego popytu według estymowanego modelu</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>ceteris_paribus<span class="sc">$</span>popyt_estymowany <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_ols, <span class="at">newdata =</span> ceteris_paribus)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ceteris_paribus, <span class="fu">aes</span>(<span class="at">x =</span> cena)) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> popyt_prawdziwy, <span class="at">color =</span> <span class="st">"Prawdziwy DGP"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> popyt_estymowany, <span class="at">color =</span> <span class="st">"Estymowany model"</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Prawdziwy DGP"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Estymowany model"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Krzywa popytu: Prawdziwy DGP vs. Estymowany model"</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Efekt ceteris paribus (przy stałych wartościach innych zmiennych)"</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cena produktu (zł)"</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Popyt (ilość)"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ten kod pokazuje:</p>
<ol type="1">
<li>Definiowanie złożonego DGP dla funkcji popytu z wieloma predyktorami zgodnej z teorią ekonomiczną</li>
<li>Symulowanie superpopulacji zgodnie z tym DGP</li>
<li>Pobieranie próby z superpopulacji</li>
<li>Estymację parametrów modelu za pomocą regresji OLS</li>
<li>Porównanie estymowanych parametrów z ich prawdziwymi wartościami</li>
<li>Wizualizację porównania prawdziwych i estymowanych parametrów</li>
<li>Sprawdzenie zdolności predykcyjnej modelu na nowych danych</li>
<li>Wizualizację relacji między ceną a popytem z efektem ceteris paribus</li>
</ol>
<p>Przykład ten pokazuje, jak można symulować złożone zależności ekonomiczne, a następnie używać metod ekonometrycznych do odkrywania tych zależności na podstawie próby danych. Jest to doskonała ilustracja, jak teoria ekonomiczna, DGP i metody statystyczne są ze sobą powiązane.</p>
<p>W rzeczywistości nigdy nie znamy prawdziwego DGP - to właśnie próbujemy odkryć za pomocą analizy statystycznej. Symulacje tego typu pozwalają jednak zrozumieć konceptualnie, jak wnioskowanie statystyczne łączy się z pojęciem DGP i superpopulacji.</p>
</section>
<section id="przykłady-pomocnicze" class="level3" data-number="2.3.16">
<h3 data-number="2.3.16" class="anchored" data-anchor-id="przykłady-pomocnicze"><span class="header-section-number">2.3.16</span> Przykłady pomocnicze</h3>
<section id="przykład-1-badanie-opinii-wyborców" class="level4" data-number="2.3.16.1">
<h4 data-number="2.3.16.1" class="anchored" data-anchor-id="przykład-1-badanie-opinii-wyborców"><span class="header-section-number">2.3.16.1</span> Przykład 1: Badanie opinii wyborców</h4>
<ul>
<li><strong>Populacja</strong>: Wszyscy zarejestrowani wyborcy w Polsce w 2023 roku (ok. 30 milionów osób)</li>
<li><strong>Próba</strong>: 1000 losowo wybranych wyborców ankietowanych w sondażu</li>
<li><strong>Superpopulacja</strong>: Wszyscy możliwi wyborcy (obecni, przyszli i hipotetyczni) oraz wszystkie możliwe scenariusze głosowania</li>
<li><strong>DGP</strong> (Data Generating Process): Złożony mechanizm kształtujący opinie i decyzje wyborcze, w tym:
<ul>
<li>Czynniki demograficzne (wiek, wykształcenie, miejsce zamieszkania)</li>
<li>Warunki ekonomiczne (dochód, status zawodowy)</li>
<li>Wpływ mediów i debaty publicznej</li>
<li>Doświadczenia osobiste</li>
<li>Historyczne uwarunkowania polityczne</li>
</ul></li>
</ul>
</section>
<section id="przykład-2-badanie-efektów-leku-przeciwcukrzycowego" class="level4" data-number="2.3.16.2">
<h4 data-number="2.3.16.2" class="anchored" data-anchor-id="przykład-2-badanie-efektów-leku-przeciwcukrzycowego"><span class="header-section-number">2.3.16.2</span> Przykład 2: Badanie efektów leku przeciwcukrzycowego</h4>
<ul>
<li><strong>Populacja</strong>: Wszyscy pacjenci z cukrzycą typu 2 w danym kraju (np. 2 miliony osób)</li>
<li><strong>Próba</strong>: 500 pacjentów uczestniczących w badaniu klinicznym</li>
<li><strong>Superpopulacja</strong>: Wszyscy możliwi pacjenci z cukrzycą typu 2 (obecni i przyszli) z różnymi profilami genetycznymi i środowiskowymi</li>
<li><strong>DGP</strong>: Biologiczny mechanizm obejmujący:
<ul>
<li>Interakcje leku z receptorami w organizmie</li>
<li>Indywidualne uwarunkowania genetyczne</li>
<li>Czynniki środowiskowe (dieta, aktywność fizyczna)</li>
<li>Interakcje z innymi lekami</li>
<li>Mechanizmy metaboliczne organizmu</li>
</ul></li>
</ul>
</section>
<section id="przykład-3-gdy-próba-równa-się-populacji" class="level4" data-number="2.3.16.3">
<h4 data-number="2.3.16.3" class="anchored" data-anchor-id="przykład-3-gdy-próba-równa-się-populacji"><span class="header-section-number">2.3.16.3</span> Przykład 3: Gdy próba równa się populacji</h4>
<p>Badanie wszystkich 50 stanów USA:</p>
<ul>
<li><strong>Tradycyjne podejście</strong>: Nie ma rozróżnienia między próbą a populacją (badamy wszystkie stany)</li>
<li><strong>Podejście superpopulacyjne</strong>:
<ul>
<li><strong>Populacja/Próba</strong>: 50 istniejących stanów USA</li>
<li><strong>Superpopulacja</strong>: Teoretyczny zbiór wszystkich możliwych jednostek terytorialnych typu “stan” w różnych warunkach historycznych, politycznych i społecznych</li>
<li><strong>DGP</strong>: Fundamentalne mechanizmy geograficzne, historyczne, polityczne i społeczno-ekonomiczne kształtujące charakterystyki stanów</li>
</ul></li>
</ul>
</section>
<section id="przykład-4-jakość-pizzy-w-nowym-jorku" class="level4" data-number="2.3.16.4">
<h4 data-number="2.3.16.4" class="anchored" data-anchor-id="przykład-4-jakość-pizzy-w-nowym-jorku"><span class="header-section-number">2.3.16.4</span> Przykład 4: Jakość pizzy w Nowym Jorku</h4>
<ul>
<li><strong>Populacja</strong>: Wszystkie obecnie działające pizzerie w Nowym Jorku (np. 2000 lokali)</li>
<li><strong>Próba</strong>: 50 losowo wybranych pizzerii z różnych dzielnic</li>
<li><strong>Superpopulacja</strong>: Wszystkie możliwe pizzerie, które mogłyby istnieć w Nowym Jorku:
<ul>
<li>Obecnie działające</li>
<li>Przyszłe (jeszcze nieotwarte)</li>
<li>Historyczne (już zamknięte)</li>
<li>Hipotetyczne (w alternatywnych warunkach ekonomicznych czy kulturowych)</li>
</ul></li>
<li><strong>DGP</strong>: Czynniki wpływające na jakość pizzy:
<ul>
<li>Składniki i ich jakość</li>
<li>Umiejętności i doświadczenie szefów kuchni</li>
<li>Sprzęt i infrastruktura kuchenna</li>
<li>Metody przygotowania i przepisy</li>
<li>Czynniki środowiskowe (np. jakość lokalnej wody)</li>
<li>Wpływy kulturowe i tradycje kulinarne</li>
<li>Uwarunkowania ekonomiczne (koszty operacyjne, czynsze)</li>
</ul></li>
</ul>
<p>DGP jest jak “przepis na jakość pizzy”, który determinuje rezultaty dla wszystkich potencjalnych pizzerii w superpopulacji, nie tylko dla obecnie istniejących lokali.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
    A[Data Generating Process DGP]
    S(Superpopulacja)
    B(Populacja)
    C[Próba]
    A --&gt;|Generuje| S
    S --&gt;|Jedna realizacja| B
    B --&gt;|Pobieranie próby| C
    C -.-&gt;|Wnioskowanie| B
    C -.-&gt;|Wnioskowanie| S
    C -.-&gt;|Wnioskowanie| A
    B -.-&gt;|Wnioskowanie| S
    B -.-&gt;|Wnioskowanie| A
    S -.-&gt;|Wnioskowanie| A
    
    classDef dgp fill:#f9f,stroke:#333,stroke-width:4px;
    classDef superpop fill:#fce,stroke:#333,stroke-width:3px;
    classDef pop fill:#bbf,stroke:#333,stroke-width:2px;
    classDef sam fill:#bfb,stroke:#333,stroke-width:2px;
    
    class A dgp;
    class S superpop;
    class B pop;
    class C sam;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
</div>
</div>
</section>
</section>
<section id="parametry-populacji" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="parametry-populacji"><span class="header-section-number">2.4</span> Parametry Populacji</h2>
<blockquote class="blockquote">
<p><strong>Ważne</strong></p>
<p><strong>Parametr populacji</strong> (<span class="math inline">\theta</span>) to wartość liczbowa charakteryzująca określoną cechę całej populacji. Parametry populacji są zwykle nieznane i stanowią przedmiot estymacji na podstawie próby.</p>
</blockquote>
<p>Typowe parametry populacji obejmują:</p>
<ul>
<li><span class="math inline">\mu</span> (średnia populacji): Przeciętna wartość w populacji</li>
<li><span class="math inline">\sigma^2</span> (wariancja populacji): Przeciętne kwadratowe odchylenie od średniej</li>
<li><span class="math inline">\sigma</span> (odchylenie standardowe populacji): Pierwiastek kwadratowy z wariancji</li>
<li><span class="math inline">p</span> (proporcja w populacji): Udział jednostek w populacji posiadających określoną cechę</li>
</ul>
<p>Ponieważ badanie całej populacji jest zazwyczaj niepraktyczne, używamy prób do szacowania tych parametrów.</p>
</section>
<section id="rozkład-statystyk-z-próby" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="rozkład-statystyk-z-próby"><span class="header-section-number">2.5</span> Rozkład Statystyk z Próby</h2>
<p><strong>Statystyka z próby</strong> (<span class="math inline">\hat{\theta}</span>) to wartość obliczona na podstawie obserwacji w próbie, służąca do oszacowania parametru populacji <span class="math inline">\theta</span>.</p>
<p>Rozkład statystyki opisuje, jak jej wartości zmieniają się przy wielokrotnym pobieraniu prób tej samej wielkości <span class="math inline">n</span> z tej samej populacji. Zrozumienie tego pojęcia jest kluczowe dla wnioskowania statystycznego.</p>
<p>Wyobraźmy to sobie tak: Gdy pobieramy próbę i obliczamy statystykę (np. średnią z próby), otrzymujemy jedną konkretną wartość. Gdybyśmy jednak powtórzyli ten proces wielokrotnie – pobierając różne losowe próby tej samej wielkości z tej samej populacji – otrzymywalibyśmy za każdym razem inne wartości. Rozkład statystyki opisuje właśnie ten wzorzec zmienności.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/sampling-estimators.svg" class="img-fluid figure-img"></p>
<figcaption>Różne losowe próby tej samej wielkości i ich statystyki. Retrieved from: https://allmodelsarewrong.github.io/mse.html</figcaption>
</figure>
</div>
<p>Kluczowe aspekty rozkładu statystyki:</p>
<ol type="1">
<li>Pokazuje, jak statystyka zmienia się między próbami</li>
<li>Pomaga zrozumieć błąd próbkowania i niepewność</li>
<li>Pozwala formułować stwierdzenia probabilistyczne o tym, jak blisko nasze oszacowanie jest rzeczywistego parametru populacji</li>
<li>Stanowi fundament wnioskowania statystycznego</li>
</ol>
<p>Przykład: Jeśli interesuje nas średnia populacji <span class="math inline">\mu</span>, jej estymatorem jest średnia z próby <span class="math inline">\bar{x}</span>, obliczana jako:</p>
<p><span class="math display">\bar{x} = \frac{1}{n}\sum_{i=1}^{n}x_i</span></p>
<p>gdzie <span class="math inline">x_1, x_2, ..., x_n</span> to obserwacje w losowej próbie.</p>
</section>
<section id="wartość-oczekiwana-statystyki-z-próby" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="wartość-oczekiwana-statystyki-z-próby"><span class="header-section-number">2.6</span> Wartość Oczekiwana Statystyki z Próby</h2>
<p>Zanim pójdziemy dalej, wyjaśnijmy krótko, co oznacza “wartość oczekiwana”:</p>
<p><strong>Wartość oczekiwana</strong> (lub średnia) zmiennej losowej to przeciętna wartość, jaką zaobserwowalibyśmy, gdybyśmy mogli powtarzać doświadczenie losowe nieskończenie wiele razy. To w zasadzie “środek ciężkości” rozkładu prawdopodobieństwa - punkt, wokół którego rozkład się równoważy.</p>
<p>Dla dyskretnej zmiennej losowej X, wartość oczekiwana jest obliczana jako:</p>
<p><span class="math display">E(X) = \sum_i x_i \cdot P(X = x_i)</span></p>
<p>Gdzie <span class="math inline">x_i</span> to możliwe wartości, a <span class="math inline">P(X = x_i)</span> to ich prawdopodobieństwa.</p>
<p>Mając to na uwadze, wartość oczekiwana statystyki z próby <span class="math inline">E(\hat{\theta})</span> to średnia wartość, jaką przyjmuje ta statystyka przy wielokrotnym pobieraniu prób z populacji.</p>
<p>Dla dobrze skonstruowanych estymatorów wartość oczekiwana jest równa parametrowi, który staramy się oszacować:</p>
<p><span class="math display">E(\hat{\theta}) = \theta</span></p>
<p>Oznacza to, że “dobry” estymator będzie, średnio rzecz biorąc, dawał właściwą odpowiedź. Taki estymator nazywamy <strong>nieobciążonym</strong>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Opcjonalnie: Dowód, że średnia z próby jest nieobciążonym estymatorem
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dla średniej z próby <span class="math inline">\bar{x}</span> możemy udowodnić, że jest nieobciążonym estymatorem średniej populacji <span class="math inline">\mu</span> w następujący sposób:</p>
<p><span class="math display">E(\bar{x}) = E\left(\frac{1}{n}\sum_{i=1}^{n}x_i\right)</span></p>
<p>Korzystając z liniowości wartości oczekiwanej (wartość oczekiwana sumy równa się sumie wartości oczekiwanych):</p>
<p><span class="math display">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}E(x_i)</span></p>
<p>Ponieważ każde <span class="math inline">x_i</span> jest losową obserwacją z populacji o średniej <span class="math inline">\mu</span>:</p>
<p><span class="math display">E(x_i) = \mu \text{ dla wszystkich } i</span></p>
<p>Zatem:</p>
<p><span class="math display">E(\bar{x}) = \frac{1}{n}\sum_{i=1}^{n}\mu = \frac{1}{n} \cdot n \cdot \mu = \mu</span></p>
<p>To dowodzi, że średnia z próby jest nieobciążonym estymatorem średniej populacji.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Opcjonalnie: Dlaczego w mianowniku wariancji z próby używamy n-1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wariancja z próby jest powszechnie definiowana jako:</p>
<p><span class="math display">s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>Dlaczego używamy <span class="math inline">n-1</span> w mianowniku zamiast <span class="math inline">n</span>?</p>
<p>Zastanówmy się, co by się stało, gdybyśmy użyli <span class="math inline">n</span>:</p>
<p><span class="math display">\tilde{s}^2 = \frac{1}{n}\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<p>Aby sprawdzić, czy jest to estymator nieobciążony, musimy znaleźć <span class="math inline">E(\tilde{s}^2)</span> i sprawdzić, czy równa się <span class="math inline">\sigma^2</span>.</p>
<p>Pomijając wszystkie kroki matematyczne, kluczowym spostrzeżeniem jest: 1. Gdy obliczamy <span class="math inline">(x_i - \bar{x})^2</span>, używamy <span class="math inline">\bar{x}</span> (średniej z próby) zamiast <span class="math inline">\mu</span> (średniej populacji) 2. Średnia z próby <span class="math inline">\bar{x}</span> jest sama w sobie oszacowana z tych samych danych 3. Wprowadza to zależność, która powoduje, że nasz estymator wariancji systematycznie niedoszacowuje prawdziwą wariancję 4. Konkretnie, <span class="math inline">E(\tilde{s}^2) = \frac{n-1}{n}\sigma^2</span>, co oznacza, że jest obciążony o czynnik <span class="math inline">\frac{n-1}{n}</span> 5. Aby skorygować to obciążenie, dzielimy przez <span class="math inline">n-1</span> zamiast <span class="math inline">n</span>, otrzymując: <span class="math display">E(s^2) = E\left(\frac{n}{n-1}\tilde{s}^2\right) = \frac{n}{n-1}E(\tilde{s}^2) = \frac{n}{n-1}\frac{n-1}{n}\sigma^2 = \sigma^2</span></p>
<p>Intuicyjnie, używamy <span class="math inline">n-1</span>, ponieważ “zużyliśmy” już jeden stopień swobody przy szacowaniu średniej. Mianownik <span class="math inline">n-1</span> nazywany jest “stopniami swobody” - liczbą niezależnych informacji dostępnych do oszacowania wariancji po oszacowaniu średniej.</p>
</div>
</div>
<p>Nie wszystkie estymatory są nieobciążone. Na przykład, jak właśnie zobaczyliśmy, prosty estymator wariancji wymaga korekty (<span class="math inline">\frac{1}{n-1}</span> zamiast <span class="math inline">\frac{1}{n}</span>), aby był nieobciążony.</p>
</section>
<section id="rozkład-normalny---krzywa-dzwonowa" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="rozkład-normalny---krzywa-dzwonowa"><span class="header-section-number">2.7</span> Rozkład Normalny - Krzywa Dzwonowa</h2>
<blockquote class="blockquote">
<p><strong>Uwaga</strong></p>
<p>Rozkład normalny (znany również jako rozkład Gaussa lub krzywa dzwonowa) jest jednym z najważniejszych rozkładów prawdopodobieństwa w statystyce. Ma symetryczny dzwonowaty kształt i jest w pełni opisany przez dwa parametry:</p>
<ul>
<li>Średnią <span class="math inline">\mu</span> (określającą środek rozkładu)</li>
<li>Odchylenie standardowe <span class="math inline">\sigma</span> (określające szerokość “dzwonu”)</li>
</ul>
<p>Rozkład normalny występuje często w przyrodzie i systemach ludzkich (wysokość, błędy pomiarowe, wyniki testów).</p>
</blockquote>
<section id="reprezentacja-matematyczna" class="level3" data-number="2.7.1">
<h3 data-number="2.7.1" class="anchored" data-anchor-id="reprezentacja-matematyczna"><span class="header-section-number">2.7.1</span> Reprezentacja Matematyczna</h3>
<p>Funkcja gęstości prawdopodobieństwa (PDF) rozkładu normalnego to:</p>
<p><span class="math display">f(x) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2}</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">x</span> to zmienna losowa</li>
<li><span class="math inline">\mu</span> to średnia (parametr położenia)</li>
<li><span class="math inline">\sigma</span> to odchylenie standardowe (parametr skali)</li>
<li><span class="math inline">e</span> to liczba Eulera (około 2,71828)</li>
<li><span class="math inline">\pi</span> to stała matematyczna pi (około 3,14159)</li>
</ul>
</section>
<section id="praktyczne-znaczenie-1" class="level3" data-number="2.7.2">
<h3 data-number="2.7.2" class="anchored" data-anchor-id="praktyczne-znaczenie-1"><span class="header-section-number">2.7.2</span> Praktyczne Znaczenie</h3>
<p>Rozkład normalny jest szczególnie ważny ze względu na:</p>
<ol type="1">
<li><p><strong>Regułę 68-95-99,7</strong>: Około 68% wartości mieści się w odległości jednego odchylenia standardowego od średniej, 95% w odległości dwóch odchyleń standardowych, a 99,7% w odległości trzech odchyleń standardowych.</p></li>
<li><p><strong>Centralne Twierdzenie Graniczne</strong>: Średnie z próby mają tendencję do podążania za rozkładem normalnym niezależnie od kształtu oryginalnego rozkładu (przy wystarczająco dużej wielkości próby).</p></li>
<li><p><strong>Wnioskowanie Statystyczne</strong>: Rozkład normalny stanowi podstawę dla wielu testów statystycznych i przedziałów ufności.</p></li>
</ol>
</section>
</section>
<section id="popularna-notacja-statystyczna" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="popularna-notacja-statystyczna"><span class="header-section-number">2.8</span> Popularna Notacja Statystyczna</h2>
<p>Zrozumienie symboli używanych w statystyce jest niezbędne do śledzenia pojęć i wzorów statystycznych. Oto tabela referencyjna najczęściej używanej notacji:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 41%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Opis</th>
<th>Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">n</span></td>
<td>Liczebność próby (liczba obserwacji w próbie)</td>
<td>“Zebraliśmy dane od <span class="math inline">n = 30</span> uczestników”</td>
</tr>
<tr class="even">
<td><span class="math inline">N</span></td>
<td>Liczebność populacji (całkowita liczba jednostek w populacji)</td>
<td>“Miasto ma <span class="math inline">N = 5000</span> mieszkańców”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\bar{x}</span></td>
<td>Średnia z próby (średnia obserwacji w próbie)</td>
<td>“<span class="math inline">\bar{x} = 25,3</span> lat”</td>
</tr>
<tr class="even">
<td><span class="math inline">\mu</span></td>
<td>Średnia populacji (średnia wartość w całej populacji)</td>
<td>“Średni wzrost w populacji to <span class="math inline">\mu = 175</span> cm”</td>
</tr>
<tr class="odd">
<td><span class="math inline">s</span></td>
<td>Odchylenie standardowe z próby</td>
<td>“Odchylenie standardowe w próbie wynosi <span class="math inline">s = 4,2</span> punktu”</td>
</tr>
<tr class="even">
<td><span class="math inline">s^2</span></td>
<td>Wariancja z próby</td>
<td>“Wariancja w próbie wynosi <span class="math inline">s^2 = 17,64</span> kwadratu punktu”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\sigma</span></td>
<td>Odchylenie standardowe populacji</td>
<td>“Odchylenie standardowe populacji wynosi <span class="math inline">\sigma = 15</span> minut”</td>
</tr>
<tr class="even">
<td><span class="math inline">\sigma^2</span></td>
<td>Wariancja populacji</td>
<td>“Wariancja populacji wynosi <span class="math inline">\sigma^2 = 225</span> kwadratów minut”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\hat{p}</span></td>
<td>Frakcja w próbie</td>
<td>“<span class="math inline">\hat{p} = 0,35</span> respondentów zgodziło się”</td>
</tr>
<tr class="even">
<td><span class="math inline">p</span></td>
<td>Frakcja w populacji</td>
<td>“Prawdziwa proporcja <span class="math inline">p</span> osób leworęcznych”</td>
</tr>
<tr class="odd">
<td><span class="math inline">H_0</span></td>
<td>Hipoteza zerowa</td>
<td>“<span class="math inline">H_0: \mu = 100</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">H_1</span> lub <span class="math inline">H_a</span></td>
<td>Hipoteza alternatywna</td>
<td>“<span class="math inline">H_1: \mu \neq 100</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\alpha</span></td>
<td>Poziom istotności (prawdopodobieństwo błędu I rodzaju)</td>
<td>“Zastosowaliśmy <span class="math inline">\alpha = 0,05</span> w naszym teście”</td>
</tr>
<tr class="even">
<td><span class="math inline">\beta</span></td>
<td>Prawdopodobieństwo błędu II rodzaju</td>
<td>“Test miał <span class="math inline">\beta = 0,2</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">1-\beta</span></td>
<td>Moc statystyczna</td>
<td>“Test miał moc <span class="math inline">1-\beta = 0,8</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">\sum</span></td>
<td>Suma</td>
<td>“<span class="math inline">\sum_{i=1}^{n} x_i</span> oznacza dodanie wszystkich wartości od <span class="math inline">x_1</span> do <span class="math inline">x_n</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">\rho</span></td>
<td>Współczynnik korelacji w populacji</td>
<td>“Korelacja w populacji wynosi <span class="math inline">\rho = 0,75</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">r</span></td>
<td>Współczynnik korelacji w próbie</td>
<td>“Korelacja w próbie wynosi <span class="math inline">r = 0,72</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">df</span></td>
<td>Stopnie swobody</td>
<td>“Test <span class="math inline">t</span> miał <span class="math inline">df = 29</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">SE</span></td>
<td>Błąd standardowy</td>
<td>“<span class="math inline">SE(\bar{x}) = \frac{s}{\sqrt{n}}</span>”</td>
</tr>
<tr class="odd">
<td><span class="math inline">CI</span></td>
<td>Przedział ufności</td>
<td>“95% <span class="math inline">CI = [42,1, 45,7]</span>”</td>
</tr>
<tr class="even">
<td><span class="math inline">\hat{\theta}</span></td>
<td>Ogólna notacja dla estymatora parametru <span class="math inline">\theta</span></td>
<td>“<span class="math inline">\hat{\theta}</span> to nasz estymator”</td>
</tr>
</tbody>
</table>
<p>Przy czytaniu wzorów i pojęć statystycznych zwracaj zawsze uwagę na rozróżnienie między: - <strong>Statystykami z próby</strong> (zazwyczaj litery łacińskie: <span class="math inline">\bar{x}</span>, <span class="math inline">s</span>, <span class="math inline">r</span>) - <strong>Parametrami populacji</strong> (zazwyczaj litery greckie: <span class="math inline">\mu</span>, <span class="math inline">\sigma</span>, <span class="math inline">\rho</span>)</p>
<p>Ta konwencja pomaga wyjaśnić, czy mówimy o wartości obliczonej z naszych danych z próby, czy o prawdziwej (zwykle nieznanej) charakterystyce całej populacji.</p>
</section>
<section id="rodzaje-danych-i-zmiennych" class="level2" data-number="2.9">
<h2 data-number="2.9" class="anchored" data-anchor-id="rodzaje-danych-i-zmiennych"><span class="header-section-number">2.9</span> Rodzaje Danych i Zmiennych</h2>
<p>Dane stanowią fundament analizy statystycznej. Aby lepiej zrozumieć ich rolę, warto zapoznać się z kluczowymi pojęciami.</p>
<section id="źródła-danych" class="level3" data-number="2.9.1">
<h3 data-number="2.9.1" class="anchored" data-anchor-id="źródła-danych"><span class="header-section-number">2.9.1</span> Źródła Danych</h3>
<ul>
<li><strong>Dane pierwotne</strong>: Zebrane bezpośrednio do konkretnego celu badawczego (np. prowadzenie własnej ankiety)</li>
<li><strong>Dane wtórne</strong>: Pozyskane z istniejących źródeł (np. bazy danych czy statystyki rządowe)</li>
</ul>
</section>
<section id="zmienne-i-stałe" class="level3" data-number="2.9.2">
<h3 data-number="2.9.2" class="anchored" data-anchor-id="zmienne-i-stałe"><span class="header-section-number">2.9.2</span> Zmienne i Stałe</h3>
<p><strong>Zmienne</strong> to cechy, które mogą przyjmować różne wartości w zbiorze danych. Są one przedmiotem naszych badań i analiz.</p>
<section id="klasyfikacja-zmiennych" class="level4" data-number="2.9.2.1">
<h4 data-number="2.9.2.1" class="anchored" data-anchor-id="klasyfikacja-zmiennych"><span class="header-section-number">2.9.2.1</span> Klasyfikacja Zmiennych</h4>
<ol type="1">
<li><strong>Zmienne Ilościowe</strong> (reprezentują ilości lub pomiary):
<ul>
<li><strong>Ciągłe</strong>: Mogą przyjmować dowolną wartość w określonym zakresie (np. wzrost, waga, temperatura)</li>
<li><strong>Dyskretne</strong>: Przyjmują tylko określone wartości, zwykle liczby całkowite (np. liczba dzieci, błędów)</li>
</ul></li>
<li><strong>Zmienne Jakościowe</strong> (reprezentują kategorie lub cechy):
<ul>
<li><strong>Nominalne</strong>: Kategorie bez naturalnego porządku (np. grupa krwi, płeć, region)</li>
<li><strong>Porządkowe</strong>: Kategorie z naturalnym porządkiem (np. poziom wykształcenia, oceny zadowolenia)</li>
</ul></li>
</ol>
<p><strong>Stałe</strong> to wartości, które pozostają niezmienione w całej analizie i często służą jako punkty odniesienia.</p>
</section>
</section>
</section>
<section id="pojęcia-związane-z-estymacją-statystyczną" class="level2" data-number="2.10">
<h2 data-number="2.10" class="anchored" data-anchor-id="pojęcia-związane-z-estymacją-statystyczną"><span class="header-section-number">2.10</span> Pojęcia Związane z Estymacją Statystyczną</h2>
<p>W statystyce często myli się ze sobą kilka podobnie brzmiących pojęć. Oto wyraźne rozróżnienie między tymi kluczowymi terminami:</p>
<section id="parametr-populacji-estymand" class="level3" data-number="2.10.1">
<h3 data-number="2.10.1" class="anchored" data-anchor-id="parametr-populacji-estymand"><span class="header-section-number">2.10.1</span> Parametr Populacji (Estymand)</h3>
<p><strong>Parametr populacji</strong> to wartość liczbowa opisująca charakterystykę całej populacji:</p>
<ol type="1">
<li>Dotyczy <em>całej</em> populacji, nie tylko próby</li>
<li>Zwykle oznaczany literami greckimi (μ, σ, π, ρ)</li>
<li>W większości przypadków pozostaje <strong>nieznany</strong> (nie możemy zbadać całej populacji)</li>
<li>Jest determinowany przez rzeczywisty proces generowania danych (ang. Data Generating Process, DGP)</li>
</ol>
<p><strong>Estymand</strong> to konkretny parametr populacji lub funkcja parametrów, którą chcemy oszacować. Jest to <em>cel naszej estymacji</em>.</p>
<blockquote class="blockquote">
<p><strong>Ważne rozróżnienie!</strong></p>
<p>Estymand (parametr populacji) to wartość w populacji, którą chcemy poznać, ale która pozostaje dla nas nieznana. Jest to nasz cel badawczy.</p>
</blockquote>
</section>
<section id="estymator-statystyka" class="level3" data-number="2.10.2">
<h3 data-number="2.10.2" class="anchored" data-anchor-id="estymator-statystyka"><span class="header-section-number">2.10.2</span> Estymator (Statystyka)</h3>
<p><strong>Estymator</strong> to funkcja matematyczna (formuła, procedura), która dostarcza oszacowania parametru populacji na podstawie danych z próby. <strong>Estymator jest zmienną losową</strong>, ponieważ jego wartość zależy od konkretnej próby.</p>
<p><strong>Statystyka</strong> to dowolna miara obliczona z danych z próby. Gdy statystyka jest używana do oszacowania parametru populacji, nazywamy ją estymatorem.</p>
<p>Przykłady estymatorów:</p>
<ul>
<li>Średnia z próby: <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> (estymator średniej populacji μ)</li>
<li>Wariancja z próby: <span class="math inline">s^2 = \frac{1}{n-1}\sum_{i=1}^n (x_i - \bar{x})^2</span> (estymator wariancji populacji σ²)</li>
<li>Frakcja w próbie: <span class="math inline">\hat{p} = \frac{x}{n}</span> (estymator frakcji w populacji p)</li>
</ul>
<blockquote class="blockquote">
<p><strong>Uwaga: Estymator jako procedura</strong></p>
<p>Estymator należy rozumieć jako <strong>przepis</strong> na obliczenie wartości na podstawie próby. Ten sam estymator zastosowany do różnych prób będzie dawał różne wyniki.</p>
<p>Przykład: Estymator średniej <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> to procedura “zsumuj wszystkie wartości i podziel przez ich liczbę”.</p>
</blockquote>
</section>
<section id="oszacowanie-estymata" class="level3" data-number="2.10.3">
<h3 data-number="2.10.3" class="anchored" data-anchor-id="oszacowanie-estymata"><span class="header-section-number">2.10.3</span> Oszacowanie (Estymata)</h3>
<p><strong>Oszacowanie</strong> to konkretna wartość liczbowa uzyskana po zastosowaniu estymatora do konkretnej próby. Jest to pojedyncza liczba, będąca realizacją zmiennej losowej, jaką jest estymator.</p>
<blockquote class="blockquote">
<p><strong>Przykład rozróżniający te pojęcia</strong></p>
<ul>
<li><strong>Estymand</strong>: Średni wzrost wszystkich dorosłych w kraju (μ) - nieznana wartość</li>
<li><strong>Estymator</strong>: Wzór na średnią z próby <span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span> - procedura obliczeniowa</li>
<li><strong>Oszacowanie</strong>: 173,5 cm - konkretna wartość uzyskana z próby</li>
</ul>
<p>Różne próby dadzą różne oszacowania tego samego estymanda przy użyciu tego samego estymatora.</p>
</blockquote>
</section>
<section id="właściwości-dobrych-estymatorów" class="level3" data-number="2.10.4">
<h3 data-number="2.10.4" class="anchored" data-anchor-id="właściwości-dobrych-estymatorów"><span class="header-section-number">2.10.4</span> Właściwości Dobrych Estymatorów</h3>
<p>Dobry estymator powinien mieć korzystne właściwości statystyczne:</p>
<ol type="1">
<li><p><strong>Nieobciążoność</strong>: Estymator jest nieobciążony, jeśli jego wartość oczekiwana równa się parametrowi, który szacuje. Formalnie: E(<span class="math inline">\hat{\theta}</span>) = <span class="math inline">\theta</span></p></li>
<li><p><strong>Efektywność</strong>: Estymator jest efektywny, jeśli ma najmniejszą możliwą wariancję spośród wszystkich nieobciążonych estymatorów</p></li>
<li><p><strong>Zgodność</strong>: Estymator jest zgodny, jeśli wraz ze wzrostem wielkości próby jego wartość zbliża się do prawdziwej wartości parametru</p></li>
<li><p><strong>Dostateczność</strong>: Estymator jest dostateczny, jeśli wykorzystuje wszystkie dostępne informacje z próby dotyczące szacowanego parametru</p></li>
</ol>
</section>
</section>
<section id="modele-statystyczne-i-wnioskowanie" class="level2" data-number="2.11">
<h2 data-number="2.11" class="anchored" data-anchor-id="modele-statystyczne-i-wnioskowanie"><span class="header-section-number">2.11</span> Modele Statystyczne i Wnioskowanie</h2>
<section id="modele-statystyczne" class="level3" data-number="2.11.1">
<h3 data-number="2.11.1" class="anchored" data-anchor-id="modele-statystyczne"><span class="header-section-number">2.11.1</span> Modele Statystyczne</h3>
<p>Model statystyczny to matematyczna reprezentacja rzeczywistości, która opisuje relacje między zmiennymi i strukturę danych. Pozwala on na opisanie procesu generowania danych i wnioskowanie o parametrach.</p>
<blockquote class="blockquote">
<p><strong>Komponenty Modelu Statystycznego</strong></p>
<p>Pełny model statystyczny składa się z:</p>
<ol type="1">
<li><strong>Formy funkcyjnej</strong>: Matematycznej struktury definiującej relację między zmiennymi (np. liniową, kwadratową)</li>
<li><strong>Zmiennych</strong>:
<ul>
<li>Zmiennej zależnej (zależnych): To, co staramy się przewidzieć lub wyjaśnić</li>
<li>Zmiennych niezależnych/objaśniających: Czynniki, które mogą wpływać na zmienną zależną</li>
</ul></li>
<li><strong>Parametrów</strong>: Nieznanych wartości, które szacujemy z danych (np. współczynniki regresji)</li>
<li><strong>Komponentu losowego</strong>: Członu błędu uwzględniającego niewyjaśnioną zmienność</li>
<li><strong>Założeń o rozkładzie prawdopodobieństwa</strong>: Specyfikacji dotyczących rozkładu komponentu losowego</li>
</ol>
</blockquote>
<p>Przykład modelu regresji liniowej: <span class="math inline">y = \beta_0 + \beta_1x + \epsilon</span>, gdzie <span class="math inline">\epsilon \sim N(0, \sigma^2)</span></p>
<p>W tym modelu: - <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> to parametry, które chcemy oszacować - <span class="math inline">\epsilon</span> to komponent losowy reprezentujący niewyjaśnioną zmienność - Zakładamy normalność rozkładu błędów</p>
</section>
<section id="wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne" class="level3" data-number="2.11.2">
<h3 data-number="2.11.2" class="anchored" data-anchor-id="wnioskowanie-przyczynowe-a-predykcyjne-korelacyjne"><span class="header-section-number">2.11.2</span> Wnioskowanie Przyczynowe a Predykcyjne (korelacyjne)</h3>
<p>W analizie statystycznej możemy mieć dwa główne cele:</p>
<ol type="1">
<li><strong>Wnioskowanie przyczynowe</strong>: Określenie, czy zmienna X <em>powoduje</em> zmianę w zmiennej Y
<ul>
<li>Wymaga dodatkowych założeń lub specjalnych projektów badawczych</li>
<li>Umożliwia przewidywanie skutków interwencji</li>
</ul></li>
<li><strong>Wnioskowanie predykcyjne (korelacyjne)</strong>: Przewidywanie wartości Y na podstawie X
<ul>
<li>Nie musi zakładać związku przyczynowego</li>
<li>Koncentruje się na dokładności przewidywań</li>
</ul></li>
</ol>
<blockquote class="blockquote">
<p><strong>Ostrzeżenie: Korelacja ≠ Przyczynowość</strong></p>
<p>Pozorna zależność lub korelacja pozorna występuje, gdy dwie lub więcej zmiennych są ze sobą powiązane, ale nie przyczynowo.</p>
<p>Dwie zmienne mogą być silnie skorelowane z powodu:</p>
<ol type="1">
<li>Zmiennej zakłócającej, która wpływa na obie zmienne</li>
<li>Odwrotnej przyczynowości (Y wpływa na X, a nie odwrotnie)</li>
<li>Przypadku (korelacja pozorna)</li>
</ol>
</blockquote>
</section>
<section id="wyzwania-wnioskowania-przyczynowego" class="level3" data-number="2.11.3">
<h3 data-number="2.11.3" class="anchored" data-anchor-id="wyzwania-wnioskowania-przyczynowego"><span class="header-section-number">2.11.3</span> Wyzwania Wnioskowania Przyczynowego</h3>
<p>Fundamentalnym problemem wnioskowania przyczynowego jest niemożność zaobserwowania <strong>stanów kontrfaktycznych</strong> (alternatywnych scenariuszy). Dla danej jednostki możemy zaobserwować tylko jeden potencjalny wynik.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/meme_horse.svg" class="img-fluid figure-img"></p>
<figcaption>Fundamentalny problem wnioskowania przyczynowego: Możemy myśleć o wnioskowaniu przyczynowym jako o problemie PRZEWIDYWANIA. Jak możemy przewidzieć stan kontrfaktyczny, skoro nigdy go nie obserwujemy?</figcaption>
</figure>
</div>
<p>Przykład:</p>
<ul>
<li>Obserwujemy osobę, która ukończyła studia i zarabia 8000 zł miesięcznie</li>
<li>Nie możemy zaobserwować, ile ta sama osoba zarabiałaby, gdyby nie ukończyła studiów</li>
</ul>
<p>Metody przyczynowe próbują rozwiązać ten problem poprzez:</p>
<ol type="1">
<li>Eksperymenty randomizowane</li>
<li>Zmienne instrumentalne</li>
<li>Metody dopasowania (matching)</li>
<li>Analizę nieciągłości regresji (ang. regression discontinuity)</li>
<li>Różnicę w różnicach (ang. difference-in-differences)</li>
</ol>
<p>Typowe problemy we wnioskowaniu przyczynowym:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4337.jpg" class="img-fluid figure-img"></p>
<figcaption>Błąd zmiennej zakłócającej: picie alkoholu poprzedniego wieczoru jest wspólną przyczyną spania w butach i budzenia się z bólem głowy</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ff13-23.png" class="img-fluid figure-img"></p>
<figcaption>Odwrotna przyczynowość</figcaption>
</figure>
</div>
</section>
</section>
<section id="wnioskowanie-statystyczne" class="level2" data-number="2.12">
<h2 data-number="2.12" class="anchored" data-anchor-id="wnioskowanie-statystyczne"><span class="header-section-number">2.12</span> Wnioskowanie Statystyczne</h2>
<p>Wnioskowanie statystyczne to proces wyciągania wniosków o populacji na podstawie danych z próby. Obejmuje dwa główne obszary:</p>
<section id="estymacja" class="level3" data-number="2.12.1">
<h3 data-number="2.12.1" class="anchored" data-anchor-id="estymacja"><span class="header-section-number">2.12.1</span> Estymacja</h3>
<p>Estymacja to proces wykorzystywania danych z próby do oszacowania nieznanych parametrów populacji. Rozróżniamy:</p>
<ul>
<li><strong>Estymację punktową</strong>: Podanie pojedynczej wartości jako najlepszego przybliżenia parametru</li>
<li><strong>Estymację przedziałową</strong>: Skonstruowanie przedziału ufności, który wskazuje zakres możliwych wartości parametru zgodnych z naszymi danymi</li>
</ul>
<p>Przykład przedziału ufności: “95% przedział ufności dla średniego wzrostu dorosłych wynosi (173 cm, 175 cm)”.</p>
<p><strong>Poprawna interpretacja przedziału ufności</strong>: Gdybyśmy wielokrotnie pobierali próby z tej samej populacji i dla każdej z nich konstruowali 95% przedział ufności tą samą metodą, około 95% tak skonstruowanych przedziałów zawierałoby prawdziwą wartość parametru populacji.</p>
<p><strong>Błędna interpretacja</strong>: “Istnieje 95% szans, że prawdziwa średnia znajduje się w przedziale (173 cm, 175 cm)” – jest to niepoprawne, ponieważ parametr populacji jest stałą (choć nieznaną) wartością, a nie zmienną losową.</p>
</section>
<section id="testowanie-hipotez" class="level3" data-number="2.12.2">
<h3 data-number="2.12.2" class="anchored" data-anchor-id="testowanie-hipotez"><span class="header-section-number">2.12.2</span> Testowanie Hipotez</h3>
<p>Testowanie hipotez to formalna procedura weryfikacji przypuszczeń dotyczących parametrów populacji.</p>
<blockquote class="blockquote">
<p><strong>Przykład: Test dwumianowy dla monety</strong></p>
<p>Wyobraźmy sobie, że chcemy sprawdzić, czy moneta jest uczciwa.</p>
<ol type="1">
<li><p><strong>Pytanie badawcze</strong>: Czy moneta jest uczciwa (prawdopodobieństwo orła = 0,5)?</p></li>
<li><p><strong>Sformułowanie hipotez</strong>:</p>
<ul>
<li><strong>Hipoteza zerowa (H₀)</strong>: p = 0,5 (moneta jest uczciwa)</li>
<li><strong>Hipoteza alternatywna (H₁)</strong>: p ≠ 0,5 (moneta nie jest uczciwa)</li>
</ul></li>
<li><p><strong>Zebranie danych</strong>: Rzucamy monetą 100 razy i otrzymujemy 65 orłów.</p></li>
<li><p><strong>Analiza</strong>: Czy 65 orłów na 100 rzutów stanowi dowód przeciwko hipotezie, że moneta jest uczciwa?</p></li>
<li><p><strong>Rozumowanie</strong>:</p>
<ul>
<li>Jeśli moneta byłaby uczciwa (p = 0,5), liczba orłów w 100 rzutach powinna podążać za rozkładem dwumianowym B(100, 0,5)</li>
<li>Dla tego rozkładu oczekujemy średnio 50 orłów, z odchyleniem standardowym √(100 × 0,5 × 0,5) = 5</li>
<li>Otrzymanie 65 orłów oznacza odchylenie o 3 odchylenia standardowe od wartości oczekiwanej</li>
<li>Prawdopodobieństwo otrzymania 65 lub więcej orłów przy uczciwej monecie jest bardzo małe (p &lt; 0,01)</li>
</ul></li>
<li><p><strong>Wniosek</strong>: Ponieważ zaobserwowany wynik jest bardzo mało prawdopodobny przy założeniu, że moneta jest uczciwa, odrzucamy hipotezę zerową i wnioskujemy, że moneta najprawdopodobniej nie jest uczciwa.</p></li>
</ol>
</blockquote>
<p>Ogólna procedura testowania hipotez:</p>
<ol type="1">
<li>Sformułuj hipotezę zerową (H₀) i hipotezę alternatywną (H₁)</li>
<li>Wybierz poziom istotności α (zwykle 0,05)</li>
<li>Zbierz dane i oblicz odpowiednią statystykę testową</li>
<li>Oblicz wartość p (prawdopodobieństwo uzyskania naszych danych lub bardziej skrajnych wyników przy założeniu, że H₀ jest prawdziwa)</li>
<li>Podejmij decyzję: jeśli p &lt; α, odrzuć H₀ na korzyść H₁</li>
</ol>
<blockquote class="blockquote">
<p><strong>Uwaga: Intuicja stojąca za testowaniem hipotez</strong></p>
<p>Testowanie hipotez przypomina procedurę sądową:</p>
</blockquote>
<blockquote class="blockquote">
<ul>
<li>H₀ odpowiada zasadzie “niewinny, dopóki nie udowodni się winy”</li>
<li>Dane stanowią “dowód” przeciwko H₀</li>
<li>Wartość p określa, jak silny jest ten dowód</li>
<li>Jeśli dowód jest wystarczająco silny (p &lt; α), “skazujemy” H₀ (odrzucamy ją)</li>
<li>Jeśli dowód nie jest wystarczająco silny, nie odrzucamy H₀ (ale nie udowadniamy jej prawdziwości)</li>
</ul>
</blockquote>
</section>
<section id="rodzaje-błędów-w-testowaniu-hipotez" class="level3" data-number="2.12.3">
<h3 data-number="2.12.3" class="anchored" data-anchor-id="rodzaje-błędów-w-testowaniu-hipotez"><span class="header-section-number">2.12.3</span> Rodzaje Błędów w Testowaniu Hipotez</h3>
<p>W testowaniu hipotez statystycznych możemy popełnić dwa rodzaje błędów:</p>
<ul>
<li><strong>Błąd I rodzaju (α)</strong>: Odrzucenie prawdziwej hipotezy zerowej (“skazanie niewinnego”)
<ul>
<li>Prawdopodobieństwo tego błędu jest kontrolowane przez poziom istotności α</li>
<li>Typowo przyjmuje się α = 0,05, co oznacza, że akceptujemy 5% ryzyko odrzucenia prawdziwej hipotezy zerowej</li>
</ul></li>
<li><strong>Błąd II rodzaju (β)</strong>: Nieodrzucenie fałszywej hipotezy zerowej (“uniewinnienie winnego”)
<ul>
<li>Prawdopodobieństwo uniknięcia tego błędu (1-β) nazywane jest mocą testu</li>
<li>Moc testu wzrasta wraz z wielkością próby i wielkością efektu</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p><strong>Ważne: Częste błędy w interpretacji wartości p i testów</strong></p>
<ol type="1">
<li>Wartość p to <strong>NIE</strong> prawdopodobieństwo, że hipoteza zerowa jest prawdziwa</li>
<li>Wartość p to <strong>NIE</strong> prawdopodobieństwo popełnienia błędu przy odrzucaniu H₀</li>
<li>Nieodrzucenie H₀ <strong>NIE</strong> oznacza udowodnienia jej prawdziwości (brak dowodów przeciwko oskarżonemu nie dowodzi niewinności)</li>
<li>Bardzo mała wartość p <strong>NIE</strong> wskazuje na duży efekt praktyczny (istotność statystyczna ≠ istotność praktyczna)</li>
<li>Wartość p zależy od wielkości próby - przy bardzo dużych próbach nawet małe, praktycznie nieistotne różnice mogą być statystycznie istotne</li>
</ol>
<p><strong>Definicja wartości p</strong>: Prawdopodobieństwo zaobserwowania wyniku co najmniej tak skrajnego jak uzyskany, przy założeniu, że hipoteza zerowa jest prawdziwa.</p>
</blockquote>
</section>
</section>
<section id="podstawy-dobrego-badania-statystycznego" class="level2" data-number="2.13">
<h2 data-number="2.13" class="anchored" data-anchor-id="podstawy-dobrego-badania-statystycznego"><span class="header-section-number">2.13</span> Podstawy Dobrego Badania Statystycznego</h2>
<p>Aby przeprowadzić rzetelne badanie statystyczne, należy zapewnić:</p>
<ol type="1">
<li><strong>Reprezentatywność próby</strong>: Próba powinna dobrze odzwierciedlać badaną populację</li>
<li><strong>Odpowiednią wielkość próby</strong>: Większe próby zapewniają dokładniejsze oszacowania i większą moc statystyczną</li>
<li><strong>Kontrolę zmiennych zakłócających</strong>: Zarówno w projektowaniu badań, jak i w analizie danych</li>
<li><strong>Odpowiednie metody statystyczne</strong>: Dopasowane do rodzaju danych i pytań badawczych</li>
<li><strong>Jasną interpretację</strong>: Uwzględniającą ograniczenia badania i alternatywne wyjaśnienia</li>
</ol>
<section id="podsumowanie-kluczowych-pojęć" class="level3" data-number="2.13.1">
<h3 data-number="2.13.1" class="anchored" data-anchor-id="podsumowanie-kluczowych-pojęć"><span class="header-section-number">2.13.1</span> Podsumowanie Kluczowych Pojęć</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 36%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Pojęcie</th>
<th>Definicja</th>
<th>Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Parametr populacji (Estymand)</strong></td>
<td>Wartość charakteryzująca populację, zwykle nieznana</td>
<td>μ (średnia populacji)</td>
</tr>
<tr class="even">
<td><strong>Estymator (Statystyka)</strong></td>
<td>Funkcja/procedura szacowania parametru na podstawie próby</td>
<td><span class="math inline">\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i</span></td>
</tr>
<tr class="odd">
<td><strong>Oszacowanie (Estymata)</strong></td>
<td>Konkretna wartość uzyskana po zastosowaniu estymatora do próby</td>
<td><span class="math inline">\bar{x} = 173,5</span> cm</td>
</tr>
<tr class="even">
<td><strong>Błąd standardowy</strong></td>
<td>Miara zmienności estymatora między próbami</td>
<td><span class="math inline">SE(\bar{x}) = \frac{s}{\sqrt{n}}</span></td>
</tr>
<tr class="odd">
<td><strong>Przedział ufności</strong></td>
<td>Zakres wartości, który z określonym prawdopodobieństwem zawiera parametr</td>
<td>(173 cm, 175 cm)</td>
</tr>
<tr class="even">
<td><strong>Wartość p</strong></td>
<td>Prawdopodobieństwo zaobserwowania danych przy założeniu prawdziwości H₀</td>
<td>p = 0,03</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="appendices-additional-topics-in-statistics-and-data-science" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Appendices: Additional Topics in Statistics and Data Science (*)</h1>
<section id="appendix-a-r-for-social-science-data-analysis" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="appendix-a-r-for-social-science-data-analysis"><span class="header-section-number">3.1</span> Appendix A: R for Social Science Data Analysis</h2>
<p>R offers powerful capabilities for social science research, from data manipulation to advanced statistical modeling.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data with a Simpson's Paradox</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Old"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>)),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">education_years =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">13</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">16</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">~</span> <span class="dv">70000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Middle"</span> <span class="sc">~</span> <span class="dv">50000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>),</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    age_group <span class="sc">==</span> <span class="st">"Old"</span> <span class="sc">~</span> <span class="dv">30000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic data summary</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  age_group         education_years      income     
 Length:1000        Min.   : 6.628   Min.   :34068  
 Class :character   1st Qu.:10.913   1st Qu.:51508  
 Mode  :character   Median :13.004   Median :63376  
                    Mean   :12.986   Mean   :63307  
                    3rd Qu.:14.934   3rd Qu.:75023  
                    Max.   :18.861   Max.   :96620  </code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation analysis</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data <span class="sc">%&gt;%</span> <span class="fu">select</span>(education_years, income))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                education_years     income
education_years       1.0000000 -0.8152477
income               -0.8152477  1.0000000</code></pre>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall trend (Simpson's Paradox)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Relationship between Education and Income"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Appears negative"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Trend by age group (Resolving Simpson's Paradox)</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>grouped_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> education_years, <span class="at">y =</span> income, <span class="at">color =</span> age_group)) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Education and Income by Age Group"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Resolving Simpson's Paradox: Positive relationship within groups"</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(grouped_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example demonstrates Simpson’s Paradox, where the overall relationship between education and income appears negative, but when grouped by age, the relationship within each group is positive. This illustrates how critical it is to consider confounding variables in your analysis.</p>
</section>
<section id="appendix-b-causal-inference-vs.-observational-studies" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="appendix-b-causal-inference-vs.-observational-studies"><span class="header-section-number">3.2</span> Appendix B: Causal Inference vs.&nbsp;Observational Studies</h2>
<p>Understanding the relationship between variables is crucial in social sciences. Two key approaches are causal inference and observational studies, each with distinct strengths and limitations.</p>
<section id="causal-inference" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="causal-inference"><span class="header-section-number">3.2.1</span> Causal Inference</h3>
<ul>
<li>Aims to establish cause-and-effect relationships</li>
<li>Often involves experimental designs or advanced statistical techniques</li>
<li>Seeks to answer “What if?” questions and determine the impact of interventions</li>
<li>Examples: Randomized controlled trials, quasi-experimental designs, instrumental variables</li>
</ul>
</section>
<section id="observational-studies" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="observational-studies"><span class="header-section-number">3.2.2</span> Observational Studies</h3>
<ul>
<li>Examine relationships between variables without direct intervention</li>
<li>Rely on data collected from natural settings or existing datasets</li>
<li>Can identify correlations and patterns but struggle to establish causation</li>
<li>Examples: Cohort studies, case-control studies, cross-sectional surveys</li>
</ul>
<blockquote class="blockquote">
<p><strong>Important: Correlation Does Not Imply Causation</strong></p>
<ul>
<li><strong>Correlation</strong>: Measures the strength and direction of a relationship between variables</li>
<li><strong>Causation</strong>: Indicates that changes in one variable directly cause changes in another</li>
</ul>
<p>While strong correlations can suggest potential causal links, additional evidence and rigorous methods are required to establish causality.</p>
</blockquote>
</section>
<section id="challenges-in-establishing-causality" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="challenges-in-establishing-causality"><span class="header-section-number">3.2.3</span> Challenges in Establishing Causality</h3>
<ul>
<li><strong>Confounding variables</strong>: Unmeasured factors that affect both the presumed cause and effect</li>
<li><strong>Reverse causality</strong>: The presumed effect might actually be causing the presumed cause</li>
<li><strong>Selection bias</strong>: Non-random selection of subjects into study groups</li>
</ul>
</section>
<section id="methods-to-strengthen-causal-claims" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="methods-to-strengthen-causal-claims"><span class="header-section-number">3.2.4</span> Methods to Strengthen Causal Claims</h3>
<ol type="1">
<li>Randomized controlled trials (when ethical and feasible)</li>
<li>Natural experiments or quasi-experimental designs</li>
<li>Propensity score matching</li>
<li>Difference-in-differences analysis</li>
<li>Instrumental variable approaches</li>
<li>Directed acyclic graphs (DAGs) for visualizing causal relationships</li>
</ol>
<p>Understanding these distinctions is crucial in social sciences, where ethical considerations often limit experimental manipulation.</p>
</section>
</section>
<section id="appendix-c-understanding-spurious-correlations-confounders-and-colliders" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="appendix-c-understanding-spurious-correlations-confounders-and-colliders"><span class="header-section-number">3.3</span> Appendix C: Understanding Spurious Correlations, Confounders, and Colliders</h2>
<p>These concepts are essential for avoiding misinterpretations in statistical analysis. Let’s explore them with R examples.</p>
<div class="cell">
<details class="code-fold">
<summary>Load required libraries</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="spurious-correlations" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="spurious-correlations"><span class="header-section-number">3.3.1</span> Spurious Correlations</h3>
<p>Spurious correlations are relationships between variables that appear to be causal but are actually coincidental or caused by an unseen third factor.</p>
<p><strong>Example: Ice Cream Sales and Drowning Incidents</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>spurious_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice_cream_sales =</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">drowning_incidents =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the apparent correlation</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> ice_cream_sales, <span class="at">y =</span> drowning_incidents)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Spurious Correlation: Ice Cream Sales vs. Drowning"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Ice Cream Sales"</span>, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Drowning Incidents"</span>) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the common cause</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(spurious_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature)) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">color =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> ice_cream_sales), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> drowning_incidents <span class="sc">*</span> <span class="dv">10</span>), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">10</span>, <span class="at">name =</span> <span class="st">"Drowning Incidents"</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Temperature as the Common Cause"</span>,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.left =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#D55E00"</span>),</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"#0072B2"</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>cor_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(spurious_data<span class="sc">$</span>ice_cream_sales, spurious_data<span class="sc">$</span>drowning_incidents)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for spurious correlation example</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation between ice cream sales and drowning incidents:"</span>, <span class="fu">round</span>(cor_value, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation between ice cream sales and drowning incidents: 0.68</code></pre>
</div>
</div>
<p>In this example, temperature is the common cause (confounder) that influences both ice cream sales and drowning incidents. When we plot them against each other, they appear correlated (r ≈ 0.5), but this is spurious. The relationship disappears when we control for temperature.</p>
</section>
<section id="confounders" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="confounders"><span class="header-section-number">3.3.2</span> Confounders</h3>
<p>A confounder is a variable that influences both the dependent variable and independent variable, causing a spurious association.</p>
<p><strong>Example: Education, Income, and Age</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for confounder example</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">runif</span>(n, <span class="dv">25</span>, <span class="dv">65</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">2</span>)),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="dv">20000</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="dv">500</span> <span class="sc">*</span> age <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="dv">5000</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create age groups for visualization</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>confounder_data <span class="ot">&lt;-</span> confounder_data <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="dv">3</span>, </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Models with and without controlling for the confounder</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> confounder_data)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>model_adjusted <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> age, <span class="at">data =</span> confounder_data)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(confounder_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> age), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> age_group, <span class="at">color =</span> <span class="fu">as.numeric</span>(age_group)), </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Age"</span>, </span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">60</span>), </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Older"</span>)) <span class="sc">+</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Education vs Income, Confounded by Age"</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling for age: effect ="</span>, </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_naive)[<span class="st">"education"</span>], <span class="dv">1</span>),</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With age control: effect ="</span>, </span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_adjusted)[<span class="st">"education"</span>], <span class="dv">1</span>)),</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Years of Education"</span>, </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Income"</span>) <span class="sc">+</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, age is a confounder in the relationship between education and income. Without controlling for age, we overestimate the effect of education on income (the black line). When we examine the relationship within specific age groups (colored lines), we see a more accurate representation of the true effect.</p>
</section>
<section id="colliders" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="colliders"><span class="header-section-number">3.3.3</span> Colliders</h3>
<p>A collider is a variable that is influenced by both the independent variable and the dependent variable. Controlling for a collider can introduce a spurious correlation.</p>
<p><strong>Example: Job Satisfaction, Salary, and Work-Life Balance</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for collider example</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataset</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>collider_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">job_satisfaction =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">salary =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Both job satisfaction and salary negatively affect work-life balance</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">work_life_balance =</span> <span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> job_satisfaction <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Without controlling for work-life balance</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction, <span class="at">data =</span> collider_data)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrectly controlling for the collider</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>model_collider <span class="ot">&lt;-</span> <span class="fu">lm</span>(salary <span class="sc">~</span> job_satisfaction <span class="sc">+</span> work_life_balance, <span class="at">data =</span> collider_data)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(collider_data, <span class="fu">aes</span>(<span class="at">x =</span> job_satisfaction, <span class="at">y =</span> salary, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">color =</span> work_life_balance)) <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Work-Life</span><span class="sc">\n</span><span class="st">Balance"</span>) <span class="sc">+</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Job Satisfaction vs Salary, with Work-Life Balance as Collider"</span>,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Without controlling: correlation ="</span>, </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_correct)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>),</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"| With control: correlation ="</span>, </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">coef</span>(model_collider)[<span class="st">"job_satisfaction"</span>], <span class="dv">3</span>)),</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Job Satisfaction"</span>, </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Salary"</span>) <span class="sc">+</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, there’s no inherent relationship between job satisfaction and salary (the black line shows near-zero correlation). However, both variables negatively impact work-life balance. If we control for work-life balance (the collider), we introduce a positive correlation between job satisfaction and salary that doesn’t actually exist.</p>
</section>
<section id="simpsons-paradox" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="simpsons-paradox"><span class="header-section-number">3.3.4</span> Simpson’s Paradox</h3>
<p>Simpson’s paradox occurs when a trend appears in different groups of data but disappears or reverses when these groups are combined.</p>
<p><strong>Example: Treatment Effectiveness Across Age Groups</strong></p>
<div class="cell">
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create example dataset</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>simpson_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">age_group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Young"</span>, <span class="st">"Older"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Treatment A"</span>, <span class="st">"Treatment B"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Different recovery rates based on age and treatment</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_prob =</span> <span class="fu">case_when</span>(</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.70</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Young"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.80</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment A"</span> <span class="sc">~</span> <span class="fl">0.50</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> treatment <span class="sc">==</span> <span class="st">"Treatment B"</span> <span class="sc">~</span> <span class="fl">0.40</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># More older people get Treatment A</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">if_else</span>(</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>      age_group <span class="sc">==</span> <span class="st">"Older"</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.7</span>, </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Treatment A"</span>, </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>      treatment</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate recovery outcomes</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered =</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, recovery_prob)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate data</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>overall_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>by_age_rates <span class="ot">&lt;-</span> simpson_data <span class="sc">%&gt;%</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_patients =</span> <span class="fu">n</span>(),</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovered_patients =</span> <span class="fu">sum</span>(recovered),</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">recovery_rate =</span> <span class="fu">mean</span>(recovered)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>overall_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(overall_rates, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Recovery Rates"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Simpson's Paradox: Treatment B appears worse overall"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>by_age_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(by_age_rates, </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> recovery_rate, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(recovery_rate<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Recovery Rates by Age Group"</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Within each age group, Treatment B is actually better"</span>,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Recovery Rate"</span>) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>age_group) <span class="sc">+</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Display tables and plots</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(overall_rates, <span class="at">caption =</span> <span class="st">"Overall Recovery Rates by Treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overall Recovery Rates by Treatment</caption>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">0.5993266</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: right;">406</td>
<td style="text-align: right;">297</td>
<td style="text-align: right;">0.7315271</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(by_age_rates, <span class="at">caption =</span> <span class="st">"Recovery Rates by Treatment and Age Group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Recovery Rates by Treatment and Age Group</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 14%">
<col style="width: 21%">
<col style="width: 27%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">treatment</th>
<th style="text-align: left;">age_group</th>
<th style="text-align: right;">total_patients</th>
<th style="text-align: right;">recovered_patients</th>
<th style="text-align: right;">recovery_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">0.4833333</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment A</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">0.6779661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Older</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.4181818</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment B</td>
<td style="text-align: left;">Young</td>
<td style="text-align: right;">351</td>
<td style="text-align: right;">274</td>
<td style="text-align: right;">0.7806268</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(overall_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>R code for Simpson’s paradox example</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(by_age_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Simpson’s paradox is occurring here because:</p>
<ol type="1">
<li><strong>Within each age group</strong>: Treatment B has a higher recovery rate than Treatment A</li>
<li><strong>Overall</strong>: Treatment A appears to have a higher recovery rate than Treatment B</li>
</ol>
<p>This paradox happens because: - Treatment A is given more frequently to older patients - Older patients have lower recovery rates regardless of treatment - This skews the overall average to make Treatment A look better, even though Treatment B is better for both young and older patients</p>
</section>
<section id="directed-acyclic-graphs-dags" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="directed-acyclic-graphs-dags"><span class="header-section-number">3.3.5</span> Directed Acyclic Graphs (DAGs)</h3>
<p>DAGs are powerful tools for visualizing causal relationships and identifying potential biases in statistical analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>R code for DAG examples</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try to load dagitty and ggdag if available</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"dagitty"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="sc">&amp;&amp;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">requireNamespace</span>(<span class="st">"ggdag"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dagitty)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggdag)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 1: Confounder</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  confounder_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Y</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; X</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="st">    Z -&gt; Y</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 2: Collider</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  collider_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="st">    X -&gt; Z</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="st">    Y -&gt; Z</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="st">    X -- Y [unobserved]</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example 3: Simpson's Paradox</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  simpson_dag <span class="ot">&lt;-</span> <span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="st">    Treatment -&gt; Recovery</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Treatment</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="st">    Age -&gt; Recovery</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="st">  }'</span>)</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot the DAGs</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(confounder_dag) <span class="sc">+</span> </span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confounder (Z)"</span>)</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(collider_dag) <span class="sc">+</span> </span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Collider (Z)"</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggdag</span>(simpson_dag) <span class="sc">+</span> </span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simpson's Paradox Structure"</span>)</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p1)</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p2)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(p3)</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"DAG visualization packages not installed. Install dagitty and ggdag packages for these examples."</span>)</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggdag'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial1_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>DAGs help us visualize different causal structures:</p>
<ol type="1">
<li><strong>Confounder</strong>: A variable (Z) that affects both the exposure (X) and outcome (Y)</li>
<li><strong>Collider</strong>: A variable (Z) that is affected by both the exposure (X) and another variable (Y)</li>
<li><strong>Simpson’s Paradox</strong>: Often involves a confounder that influences both the treatment/exposure and the outcome</li>
</ol>
<p>Understanding these structures helps us decide which variables to control for in our analyses and which to leave out.</p>
</section>
</section>
<section id="appendix-d-models-in-science-from-deterministic-to-stochastic" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="appendix-d-models-in-science-from-deterministic-to-stochastic"><span class="header-section-number">3.4</span> Appendix D: Models in Science: From Deterministic to Stochastic</h2>
<p>Models are essential tools in scientific research, helping scientists to represent, understand, and predict complex phenomena.</p>
<section id="types-of-models" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="types-of-models"><span class="header-section-number">3.4.1</span> Types of Models</h3>
<section id="mathematical-models" class="level4" data-number="3.4.1.1">
<h4 data-number="3.4.1.1" class="anchored" data-anchor-id="mathematical-models"><span class="header-section-number">3.4.1.1</span> Mathematical Models</h4>
<p>Mathematical models use equations to describe and analyze systems. They can be divided into:</p>
<section id="deterministic-models" class="level5" data-number="3.4.1.1.1">
<h5 data-number="3.4.1.1.1" class="anchored" data-anchor-id="deterministic-models"><span class="header-section-number">3.4.1.1.1</span> Deterministic Models</h5>
<p>Deterministic models provide precise predictions based on a set of variables, without incorporating randomness.</p>
<p><strong>Example:</strong> Newton’s laws of motion, which can precisely predict the motion of objects under known forces:</p>
<p><span class="math display">x(t) = x_0 + v_0t + \frac{1}{2}at^2</span></p>
<p>Where <span class="math inline">x(t)</span> is the position at time <span class="math inline">t</span>, <span class="math inline">x_0</span> is the initial position, <span class="math inline">v_0</span> is the initial velocity, and <span class="math inline">a</span> is the acceleration.</p>
</section>
<section id="stochastic-models" class="level5" data-number="3.4.1.1.2">
<h5 data-number="3.4.1.1.2" class="anchored" data-anchor-id="stochastic-models"><span class="header-section-number">3.4.1.1.2</span> Stochastic Models</h5>
<p>Stochastic models incorporate randomness and probability. They come in two fundamentally different types:</p>
<p><strong>Classical Stochastic Models</strong>: Deal with randomness arising from incomplete information or complex interactions in classical systems. The underlying system is deterministic, but practical limitations lead to probabilistic descriptions.</p>
<p><strong>Example:</strong> Regression models in statistics, where the randomness represents unexplained variation:</p>
<p><span class="math display">y = \beta_0 + \beta_1x + \varepsilon</span></p>
<p>Where <span class="math inline">y</span> is the dependent variable, <span class="math inline">x</span> is the independent variable, <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> are parameters, and <span class="math inline">\varepsilon</span> is the error term.</p>
<p><strong>Quantum Stochastic Models</strong>: Deal with the fundamental, irreducible randomness inherent in quantum mechanical systems.</p>
<p><strong>Example:</strong> The decay of a radioactive particle follows a probability distribution:</p>
<p><span class="math display">P(t) = e^{-t/\tau}</span></p>
<p>Where <span class="math inline">P(t)</span> is the probability that the particle has not decayed after time <span class="math inline">t</span>, and <span class="math inline">\tau</span> is the mean lifetime of the particle.</p>
</section>
</section>
<section id="other-model-types" class="level4" data-number="3.4.1.2">
<h4 data-number="3.4.1.2" class="anchored" data-anchor-id="other-model-types"><span class="header-section-number">3.4.1.2</span> Other Model Types</h4>
<ul>
<li><strong>Computer Simulation Models</strong>: Use algorithms to simulate complex systems</li>
<li><strong>Conceptual Models</strong>: Abstract representations using diagrams or flowcharts</li>
<li><strong>Physical Models</strong>: Tangible representations like scale models</li>
<li><strong>Theoretical Models</strong>: Abstract frameworks based on fundamental principles</li>
</ul>
</section>
</section>
<section id="model-error-and-bias-variance-tradeoff" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="model-error-and-bias-variance-tradeoff"><span class="header-section-number">3.4.2</span> Model Error and Bias-Variance Tradeoff</h3>
<p>All models involve some degree of error. Understanding the balance between bias and variance is crucial:</p>
<ul>
<li><strong>Bias</strong>: Systematic error from simplifying assumptions</li>
<li><strong>Variance</strong>: Error from sensitivity to small fluctuations in the training data</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/ModelError.png" class="img-fluid figure-img"></p>
<figcaption>Bias-Variance Tradeoff in Models</figcaption>
</figure>
</div>
<p>The ideal model balances complexity to minimize both bias and variance, leading to the best predictive performance.</p>
</section>
</section>
<section id="appendix-e-classical-vs-quantum-randomness" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="appendix-e-classical-vs-quantum-randomness"><span class="header-section-number">3.5</span> Appendix E: Classical vs Quantum Randomness</h2>
<p>To understand how randomness differs across scientific disciplines, we need to examine the origins and implications of different types of uncertainty.</p>
<section id="origin-of-randomness" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="origin-of-randomness"><span class="header-section-number">3.5.1</span> Origin of Randomness</h3>
<section id="classical-randomness-e.g.-regression-models" class="level4" data-number="3.5.1.1">
<h4 data-number="3.5.1.1" class="anchored" data-anchor-id="classical-randomness-e.g.-regression-models"><span class="header-section-number">3.5.1.1</span> Classical Randomness (e.g., Regression Models)</h4>
<ul>
<li><strong>Source</strong>: Incomplete information or complex interactions in an otherwise deterministic system</li>
<li><strong>Nature</strong>: Epistemic uncertainty (due to lack of knowledge)</li>
<li><strong>Example</strong>: In a regression model, the error term represents unexplained variation</li>
</ul>
</section>
<section id="quantum-randomness" class="level4" data-number="3.5.1.2">
<h4 data-number="3.5.1.2" class="anchored" data-anchor-id="quantum-randomness"><span class="header-section-number">3.5.1.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Source</strong>: Fundamental property of quantum systems</li>
<li><strong>Nature</strong>: Ontic uncertainty (inherent to the system, not due to lack of knowledge)</li>
<li><strong>Example</strong>: The exact time of decay of a radioactive atom cannot be predicted</li>
</ul>
</section>
</section>
<section id="philosophical-implications" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="philosophical-implications"><span class="header-section-number">3.5.2</span> Philosophical Implications</h3>
<section id="classical-randomness" class="level4" data-number="3.5.2.1">
<h4 data-number="3.5.2.1" class="anchored" data-anchor-id="classical-randomness"><span class="header-section-number">3.5.2.1</span> Classical Randomness</h4>
<ul>
<li><strong>Determinism</strong>: Underlying reality is deterministic; randomness reflects our ignorance</li>
<li><strong>Hidden Variables</strong>: In principle, with complete information, we could predict outcomes precisely</li>
</ul>
</section>
<section id="quantum-randomness-1" class="level4" data-number="3.5.2.2">
<h4 data-number="3.5.2.2" class="anchored" data-anchor-id="quantum-randomness-1"><span class="header-section-number">3.5.2.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Indeterminism</strong>: Randomness is a fundamental feature of reality</li>
<li><strong>No Hidden Variables</strong>: Even with complete information, some outcomes remain unpredictable (as suggested by Bell’s theorem)</li>
</ul>
</section>
</section>
<section id="practical-implications" class="level3" data-number="3.5.3">
<h3 data-number="3.5.3" class="anchored" data-anchor-id="practical-implications"><span class="header-section-number">3.5.3</span> Practical Implications</h3>
<section id="classical-randomness-1" class="level4" data-number="3.5.3.1">
<h4 data-number="3.5.3.1" class="anchored" data-anchor-id="classical-randomness-1"><span class="header-section-number">3.5.3.1</span> Classical Randomness</h4>
<ul>
<li><strong>Reducible</strong>: Can be reduced by gathering more data or improving measurement precision</li>
<li><strong>Controllable</strong>: Systematic errors can be identified and corrected</li>
</ul>
</section>
<section id="quantum-randomness-2" class="level4" data-number="3.5.3.2">
<h4 data-number="3.5.3.2" class="anchored" data-anchor-id="quantum-randomness-2"><span class="header-section-number">3.5.3.2</span> Quantum Randomness</h4>
<ul>
<li><strong>Irreducible</strong>: Cannot be eliminated even with perfect measurements</li>
<li><strong>Fundamentally Uncontrollable</strong>: The act of measurement itself affects the system</li>
</ul>
<p>Understanding these differences is crucial for correctly interpreting statistical models in different scientific contexts.</p>
</section>
</section>
</section>
<section id="appendix-f-ethical-considerations-in-social-science-data-analysis" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="appendix-f-ethical-considerations-in-social-science-data-analysis"><span class="header-section-number">3.6</span> Appendix F: Ethical Considerations in Social Science Data Analysis</h2>
<p>Ethics play a vital role in social science research. Key considerations include:</p>
<section id="privacy-and-consent" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="privacy-and-consent"><span class="header-section-number">3.6.1</span> 1. Privacy and Consent</h3>
<ul>
<li>Ensure participants understand how their data will be used</li>
<li>Obtain informed consent before collecting data</li>
<li>Protect personally identifiable information</li>
<li>Consider cultural differences in privacy expectations</li>
</ul>
</section>
<section id="data-protection" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="data-protection"><span class="header-section-number">3.6.2</span> 2. Data Protection</h3>
<ul>
<li>Securely store sensitive data</li>
<li>Implement appropriate access controls</li>
<li>Follow relevant regulations (e.g., GDPR, HIPAA)</li>
<li>Have a data management plan that includes secure disposal</li>
</ul>
</section>
<section id="bias-and-representation" class="level3" data-number="3.6.3">
<h3 data-number="3.6.3" class="anchored" data-anchor-id="bias-and-representation"><span class="header-section-number">3.6.3</span> 3. Bias and Representation</h3>
<ul>
<li>Address sampling bias that could exclude marginalized groups</li>
<li>Ensure diverse representation in research</li>
<li>Consider how variable definitions might reflect social biases</li>
<li>Be transparent about limitations in population coverage</li>
</ul>
</section>
<section id="transparency-and-reproducibility" class="level3" data-number="3.6.4">
<h3 data-number="3.6.4" class="anchored" data-anchor-id="transparency-and-reproducibility"><span class="header-section-number">3.6.4</span> 4. Transparency and Reproducibility</h3>
<ul>
<li>Clearly document research methods</li>
<li>Share code and data when possible</li>
<li>Pre-register studies when appropriate</li>
<li>Acknowledge limitations and potential biases</li>
</ul>
</section>
<section id="social-impact" class="level3" data-number="3.6.5">
<h3 data-number="3.6.5" class="anchored" data-anchor-id="social-impact"><span class="header-section-number">3.6.5</span> 5. Social Impact</h3>
<ul>
<li>Consider the potential societal implications of research findings</li>
<li>Avoid reinforcing harmful stereotypes</li>
<li>Think about how results might be misinterpreted or misused</li>
<li>Engage with communities being studied</li>
</ul>
<p>Ethical considerations should be integrated throughout the research process, from study design to data collection, analysis, and reporting of results.</p>
</section>
</section>
<section id="appendix-g-introduction-to-rstudio-and-the-tidyverse" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="appendix-g-introduction-to-rstudio-and-the-tidyverse"><span class="header-section-number">3.7</span> Appendix G: Introduction to RStudio and the tidyverse</h2>
<p>R is a powerful programming language for statistical computing and graphics. RStudio provides an integrated development environment that makes working with R easier.</p>
<section id="getting-started-with-rstudio" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="getting-started-with-rstudio"><span class="header-section-number">3.7.1</span> Getting Started with RStudio</h3>
<p>RStudio has four main panes:</p>
<ol type="1">
<li><strong>Source Editor</strong>: Where you write and edit your R scripts</li>
<li><strong>Console</strong>: Where you run R commands and see output</li>
<li><strong>Environment/History</strong>: Shows your workspace objects and command history</li>
<li><strong>Files/Plots/Packages/Help</strong>: For file management, viewing plots, managing packages, and accessing help</li>
</ol>
</section>
<section id="the-tidyverse-ecosystem" class="level3" data-number="3.7.2">
<h3 data-number="3.7.2" class="anchored" data-anchor-id="the-tidyverse-ecosystem"><span class="header-section-number">3.7.2</span> The tidyverse Ecosystem</h3>
<p>The tidyverse is a collection of R packages designed for data science with a consistent design philosophy.</p>
<p>Key packages include:</p>
<ul>
<li><strong>ggplot2</strong>: Data visualization</li>
<li><strong>dplyr</strong>: Data manipulation</li>
<li><strong>tidyr</strong>: Data tidying</li>
<li><strong>readr</strong>: Data import</li>
<li><strong>purrr</strong>: Functional programming</li>
<li><strong>tibble</strong>: Modern data frames</li>
</ul>
</section>
<section id="basic-tidyverse-workflow" class="level3" data-number="3.7.3">
<h3 data-number="3.7.3" class="anchored" data-anchor-id="basic-tidyverse-workflow"><span class="header-section-number">3.7.3</span> Basic tidyverse Workflow</h3>
<div class="cell">
<details class="code-fold">
<summary>Click to show/hide R code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load tidyverse</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"my_data.csv"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and transform</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(important_variable)) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1, var2, var3) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_var =</span> var1 <span class="sc">/</span> var2)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and summarize</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> cleaned_data <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category) <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_val =</span> <span class="fu">mean</span>(var3),</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cleaned_data, <span class="fu">aes</span>(<span class="at">x =</span> var1, <span class="at">y =</span> var2, <span class="at">color =</span> category)) <span class="sc">+</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between Variables"</span>,</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Variable 1"</span>,</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variable 2"</span>) <span class="sc">+</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This workflow demonstrates the power of the tidyverse’s pipe operator (<code>%&gt;%</code>), which allows you to chain operations together in a readable way.</p>
</section>
<section id="resources-for-learning-r" class="level3" data-number="3.7.4">
<h3 data-number="3.7.4" class="anchored" data-anchor-id="resources-for-learning-r"><span class="header-section-number">3.7.4</span> Resources for Learning R</h3>
<ul>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse documentation</a></li>
<li><a href="https://www.rstudio.com/resources/cheatsheets/">RStudio Cheat Sheets</a></li>
<li><a href="https://quarto.org/docs/guide/">Quarto Guide</a></li>
</ul>
<p>The best way to learn R is through practice. Start with small, manageable projects and gradually build your skills.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter1.html" class="pagination-link" aria-label="Introduction to Data Science and Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter2.html" class="pagination-link" aria-label="Understanding Data Types in Social Sciences">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>