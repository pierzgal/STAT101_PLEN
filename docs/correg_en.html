<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Introduction to Correlation and Regression Analysis – Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./correg_pl.html" rel="next">
<link href="./rozdzial6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ffd282cb318059e0bcb130885a47f5dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_en.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations of Statistics and Demography</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Podstawy Statystyki i Demografii</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy statystyki opisowej jednej zmiennej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">9.1</span> Introduction</a></li>
  <li><a href="#theoretical-foundations" id="toc-theoretical-foundations" class="nav-link" data-scroll-target="#theoretical-foundations"><span class="header-section-number">9.2</span> Theoretical Foundations</a>
  <ul class="collapse">
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance">Covariance</a></li>
  <li><a href="#correlation-coefficient" id="toc-correlation-coefficient" class="nav-link" data-scroll-target="#correlation-coefficient">Correlation Coefficient</a></li>
  <li><a href="#pearson-correlation-coefficient" id="toc-pearson-correlation-coefficient" class="nav-link" data-scroll-target="#pearson-correlation-coefficient">Pearson Correlation Coefficient</a></li>
  <li><a href="#spearman-rank-correlation-coefficient" id="toc-spearman-rank-correlation-coefficient" class="nav-link" data-scroll-target="#spearman-rank-correlation-coefficient">Spearman Rank Correlation Coefficient</a></li>
  <li><a href="#visualizing-correlation-patterns" id="toc-visualizing-correlation-patterns" class="nav-link" data-scroll-target="#visualizing-correlation-patterns">Visualizing Correlation Patterns</a></li>
  </ul></li>
  <li><a href="#manual-calculation-methods" id="toc-manual-calculation-methods" class="nav-link" data-scroll-target="#manual-calculation-methods"><span class="header-section-number">9.3</span> Manual Calculation Methods</a>
  <ul class="collapse">
  <li><a href="#calculating-covariance-step-by-step" id="toc-calculating-covariance-step-by-step" class="nav-link" data-scroll-target="#calculating-covariance-step-by-step">Calculating Covariance: Step-by-Step</a></li>
  <li><a href="#calculating-pearson-correlation-step-by-step" id="toc-calculating-pearson-correlation-step-by-step" class="nav-link" data-scroll-target="#calculating-pearson-correlation-step-by-step">Calculating Pearson Correlation: Step-by-Step</a></li>
  <li><a href="#calculating-spearman-correlation-step-by-step" id="toc-calculating-spearman-correlation-step-by-step" class="nav-link" data-scroll-target="#calculating-spearman-correlation-step-by-step">Calculating Spearman Correlation: Step-by-Step</a></li>
  </ul></li>
  <li><a href="#r-verification-and-implementation" id="toc-r-verification-and-implementation" class="nav-link" data-scroll-target="#r-verification-and-implementation"><span class="header-section-number">9.4</span> R Verification and Implementation</a>
  <ul class="collapse">
  <li><a href="#covariance-verification" id="toc-covariance-verification" class="nav-link" data-scroll-target="#covariance-verification">Covariance Verification</a></li>
  <li><a href="#pearson-correlation-verification" id="toc-pearson-correlation-verification" class="nav-link" data-scroll-target="#pearson-correlation-verification">Pearson Correlation Verification</a></li>
  <li><a href="#spearman-correlation-verification" id="toc-spearman-correlation-verification" class="nav-link" data-scroll-target="#spearman-correlation-verification">Spearman Correlation Verification</a></li>
  </ul></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises"><span class="header-section-number">9.5</span> Practice Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise-1-calculate-covariance-and-pearson-correlation-manually" id="toc-exercise-1-calculate-covariance-and-pearson-correlation-manually" class="nav-link" data-scroll-target="#exercise-1-calculate-covariance-and-pearson-correlation-manually">Exercise 1: Calculate Covariance and Pearson Correlation Manually</a></li>
  <li><a href="#exercise-2-calculate-spearman-correlation-manually" id="toc-exercise-2-calculate-spearman-correlation-manually" class="nav-link" data-scroll-target="#exercise-2-calculate-spearman-correlation-manually">Exercise 2: Calculate Spearman Correlation Manually</a></li>
  <li><a href="#exercise-3-comparing-pearson-and-spearman" id="toc-exercise-3-comparing-pearson-and-spearman" class="nav-link" data-scroll-target="#exercise-3-comparing-pearson-and-spearman">Exercise 3: Comparing Pearson and Spearman</a></li>
  </ul></li>
  <li><a href="#important-points-to-remember" id="toc-important-points-to-remember" class="nav-link" data-scroll-target="#important-points-to-remember"><span class="header-section-number">9.6</span> Important Points to Remember</a></li>
  <li><a href="#summary-decision-tree-for-correlation-analysis" id="toc-summary-decision-tree-for-correlation-analysis" class="nav-link" data-scroll-target="#summary-decision-tree-for-correlation-analysis"><span class="header-section-number">9.7</span> Summary: Decision Tree for Correlation Analysis</a>
  <ul class="collapse">
  <li><a href="#quick-reference-card" id="toc-quick-reference-card" class="nav-link" data-scroll-target="#quick-reference-card">Quick Reference Card</a></li>
  </ul></li>
  <li><a href="#introduction-to-statistical-modeling-regression-analysis-and-ols-method" id="toc-introduction-to-statistical-modeling-regression-analysis-and-ols-method" class="nav-link" data-scroll-target="#introduction-to-statistical-modeling-regression-analysis-and-ols-method"><span class="header-section-number">9.8</span> Introduction to Statistical Modeling, Regression Analysis, and OLS Method</a>
  <ul class="collapse">
  <li><a href="#what-is-a-model-and-why-do-we-need-models" id="toc-what-is-a-model-and-why-do-we-need-models" class="nav-link" data-scroll-target="#what-is-a-model-and-why-do-we-need-models">What Is a Model and Why Do We Need Models?</a></li>
  <li><a href="#why-regression-analysis" id="toc-why-regression-analysis" class="nav-link" data-scroll-target="#why-regression-analysis">Why Regression Analysis?</a></li>
  <li><a href="#deterministic-vs.-stochastic-models" id="toc-deterministic-vs.-stochastic-models" class="nav-link" data-scroll-target="#deterministic-vs.-stochastic-models">Deterministic vs.&nbsp;Stochastic Models</a></li>
  <li><a href="#visualizing-relationships-scatterplots-and-types-of-patterns" id="toc-visualizing-relationships-scatterplots-and-types-of-patterns" class="nav-link" data-scroll-target="#visualizing-relationships-scatterplots-and-types-of-patterns">Visualizing Relationships: Scatterplots and Types of Patterns</a></li>
  <li><a href="#a-simple-example-study-hours-and-exam-scores" id="toc-a-simple-example-study-hours-and-exam-scores" class="nav-link" data-scroll-target="#a-simple-example-study-hours-and-exam-scores">A Simple Example: Study Hours and Exam Scores</a></li>
  <li><a href="#the-idea-of-a-best-fit-line" id="toc-the-idea-of-a-best-fit-line" class="nav-link" data-scroll-target="#the-idea-of-a-best-fit-line">The Idea of a “Best Fit” Line</a></li>
  <li><a href="#visualizing-different-lines-and-their-sse" id="toc-visualizing-different-lines-and-their-sse" class="nav-link" data-scroll-target="#visualizing-different-lines-and-their-sse">Visualizing Different Lines and Their SSE</a></li>
  <li><a href="#the-zero-model-predicting-with-the-mean" id="toc-the-zero-model-predicting-with-the-mean" class="nav-link" data-scroll-target="#the-zero-model-predicting-with-the-mean">The Zero Model: Predicting with the Mean</a></li>
  <li><a href="#variance-decomposition-how-good-is-our-model" id="toc-variance-decomposition-how-good-is-our-model" class="nav-link" data-scroll-target="#variance-decomposition-how-good-is-our-model">Variance Decomposition: How Good is Our Model?</a></li>
  <li><a href="#finding-the-ols-coefficients-minimizing-sse" id="toc-finding-the-ols-coefficients-minimizing-sse" class="nav-link" data-scroll-target="#finding-the-ols-coefficients-minimizing-sse">Finding the OLS Coefficients: Minimizing SSE</a></li>
  <li><a href="#evaluating-model-quality-r-squared" id="toc-evaluating-model-quality-r-squared" class="nav-link" data-scroll-target="#evaluating-model-quality-r-squared">Evaluating Model Quality: R-squared</a></li>
  <li><a href="#evaluating-model-quality-rmse" id="toc-evaluating-model-quality-rmse" class="nav-link" data-scroll-target="#evaluating-model-quality-rmse">Evaluating Model Quality: RMSE</a></li>
  <li><a href="#model-interpretation-effect-size-and-diagnostics" id="toc-model-interpretation-effect-size-and-diagnostics" class="nav-link" data-scroll-target="#model-interpretation-effect-size-and-diagnostics">Model Interpretation, Effect Size, and Diagnostics</a></li>
  <li><a href="#correlation-vs.-causation-and-spurious-relationships" id="toc-correlation-vs.-causation-and-spurious-relationships" class="nav-link" data-scroll-target="#correlation-vs.-causation-and-spurious-relationships">Correlation vs.&nbsp;Causation and Spurious Relationships</a></li>
  <li><a href="#key-assumptions-of-ols" id="toc-key-assumptions-of-ols" class="nav-link" data-scroll-target="#key-assumptions-of-ols">Key Assumptions of OLS</a></li>
  <li><a href="#extension-to-multiple-regression" id="toc-extension-to-multiple-regression" class="nav-link" data-scroll-target="#extension-to-multiple-regression">Extension to Multiple Regression</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  <li><a href="#complete-manual-ols-calculation-a-step-by-step-example" id="toc-complete-manual-ols-calculation-a-step-by-step-example" class="nav-link" data-scroll-target="#complete-manual-ols-calculation-a-step-by-step-example"><span class="header-section-number">9.9</span> Complete Manual OLS Calculation: A Step-by-Step Example</a></li>
  <li><a href="#step-1-calculate-the-means" id="toc-step-1-calculate-the-means" class="nav-link" data-scroll-target="#step-1-calculate-the-means"><span class="header-section-number">9.10</span> Step 1: Calculate the Means</a></li>
  <li><a href="#step-2-calculate-deviations-from-means" id="toc-step-2-calculate-deviations-from-means" class="nav-link" data-scroll-target="#step-2-calculate-deviations-from-means"><span class="header-section-number">9.11</span> Step 2: Calculate Deviations from Means</a></li>
  <li><a href="#step-3-calculate-products-and-squares" id="toc-step-3-calculate-products-and-squares" class="nav-link" data-scroll-target="#step-3-calculate-products-and-squares"><span class="header-section-number">9.12</span> Step 3: Calculate Products and Squares</a></li>
  <li><a href="#step-4-calculate-the-slope-hatbeta_1" id="toc-step-4-calculate-the-slope-hatbeta_1" class="nav-link" data-scroll-target="#step-4-calculate-the-slope-hatbeta_1"><span class="header-section-number">9.13</span> Step 4: Calculate the Slope (<span class="math inline">\hat{\beta}_1</span>)</a></li>
  <li><a href="#step-5-calculate-the-intercept-hatbeta_0" id="toc-step-5-calculate-the-intercept-hatbeta_0" class="nav-link" data-scroll-target="#step-5-calculate-the-intercept-hatbeta_0"><span class="header-section-number">9.14</span> Step 5: Calculate the Intercept (<span class="math inline">\hat{\beta}_0</span>)</a></li>
  <li><a href="#step-6-write-the-regression-equation" id="toc-step-6-write-the-regression-equation" class="nav-link" data-scroll-target="#step-6-write-the-regression-equation"><span class="header-section-number">9.15</span> Step 6: Write the Regression Equation</a></li>
  <li><a href="#step-7-calculate-predicted-values-and-residuals" id="toc-step-7-calculate-predicted-values-and-residuals" class="nav-link" data-scroll-target="#step-7-calculate-predicted-values-and-residuals"><span class="header-section-number">9.16</span> Step 7: Calculate Predicted Values and Residuals</a></li>
  <li><a href="#step-8-calculate-sum-of-squares" id="toc-step-8-calculate-sum-of-squares" class="nav-link" data-scroll-target="#step-8-calculate-sum-of-squares"><span class="header-section-number">9.17</span> Step 8: Calculate Sum of Squares</a>
  <ul class="collapse">
  <li><a href="#total-sum-of-squares-sst" id="toc-total-sum-of-squares-sst" class="nav-link" data-scroll-target="#total-sum-of-squares-sst">Total Sum of Squares (SST)</a></li>
  <li><a href="#regression-sum-of-squares-ssr" id="toc-regression-sum-of-squares-ssr" class="nav-link" data-scroll-target="#regression-sum-of-squares-ssr">Regression Sum of Squares (SSR)</a></li>
  <li><a href="#error-sum-of-squares-sse" id="toc-error-sum-of-squares-sse" class="nav-link" data-scroll-target="#error-sum-of-squares-sse">Error Sum of Squares (SSE)</a></li>
  </ul></li>
  <li><a href="#step-9-calculate-r-squared" id="toc-step-9-calculate-r-squared" class="nav-link" data-scroll-target="#step-9-calculate-r-squared"><span class="header-section-number">9.18</span> Step 9: Calculate R-Squared</a></li>
  <li><a href="#step-10-calculate-effect-sizes" id="toc-step-10-calculate-effect-sizes" class="nav-link" data-scroll-target="#step-10-calculate-effect-sizes"><span class="header-section-number">9.19</span> Step 10: Calculate Effect Sizes</a>
  <ul class="collapse">
  <li><a href="#raw-effect-size" id="toc-raw-effect-size" class="nav-link" data-scroll-target="#raw-effect-size">Raw Effect Size</a></li>
  <li><a href="#standardized-effect-size" id="toc-standardized-effect-size" class="nav-link" data-scroll-target="#standardized-effect-size">Standardized Effect Size</a></li>
  </ul></li>
  <li><a href="#step-11-practical-significance-assessment" id="toc-step-11-practical-significance-assessment" class="nav-link" data-scroll-target="#step-11-practical-significance-assessment"><span class="header-section-number">9.20</span> Step 11: Practical Significance Assessment</a>
  <ul class="collapse">
  <li><a href="#context-analysis" id="toc-context-analysis" class="nav-link" data-scroll-target="#context-analysis">Context Analysis</a></li>
  </ul></li>
  <li><a href="#summary-of-results" id="toc-summary-of-results" class="nav-link" data-scroll-target="#summary-of-results"><span class="header-section-number">9.21</span> Summary of Results</a></li>
  <li><a href="#verification-check" id="toc-verification-check" class="nav-link" data-scroll-target="#verification-check"><span class="header-section-number">9.22</span> Verification Check</a></li>
  <li><a href="#r-code-to-verify-manual-calculations" id="toc-r-code-to-verify-manual-calculations" class="nav-link" data-scroll-target="#r-code-to-verify-manual-calculations"><span class="header-section-number">9.23</span> R Code to Verify Manual Calculations</a>
  <ul class="collapse">
  <li><a href="#running-the-code" id="toc-running-the-code" class="nav-link" data-scroll-target="#running-the-code">Running the Code</a></li>
  <li><a href="#expected-output-highlights" id="toc-expected-output-highlights" class="nav-link" data-scroll-target="#expected-output-highlights">Expected Output Highlights</a></li>
  </ul></li>
  <li><a href="#model-interpretation-a-beginners-guide" id="toc-model-interpretation-a-beginners-guide" class="nav-link" data-scroll-target="#model-interpretation-a-beginners-guide"><span class="header-section-number">9.24</span> Model Interpretation: A Beginner’s Guide</a></li>
  <li><a href="#derivation-of-ols-estimators" id="toc-derivation-of-ols-estimators" class="nav-link" data-scroll-target="#derivation-of-ols-estimators"><span class="header-section-number">9.25</span> Derivation of OLS Estimators (*)</a>
  <ul class="collapse">
  <li><a href="#properties-of-ols-estimators" id="toc-properties-of-ols-estimators" class="nav-link" data-scroll-target="#properties-of-ols-estimators">Properties of OLS Estimators</a></li>
  <li><a href="#classical-linear-model-assumptions" id="toc-classical-linear-model-assumptions" class="nav-link" data-scroll-target="#classical-linear-model-assumptions">Classical Linear Model Assumptions</a></li>
  <li><a href="#gauss-markov-theorem" id="toc-gauss-markov-theorem" class="nav-link" data-scroll-target="#gauss-markov-theorem">Gauss-Markov Theorem</a></li>
  <li><a href="#visualization-of-ols-methodology" id="toc-visualization-of-ols-methodology" class="nav-link" data-scroll-target="#visualization-of-ols-methodology">Visualization of OLS Methodology</a></li>
  <li><a href="#diagnostic-analysis" id="toc-diagnostic-analysis" class="nav-link" data-scroll-target="#diagnostic-analysis">Diagnostic Analysis</a></li>
  <li><a href="#key-learning-points" id="toc-key-learning-points" class="nav-link" data-scroll-target="#key-learning-points">Key Learning Points</a></li>
  </ul></li>
  <li><a href="#key-assumptions-of-linear-regression" id="toc-key-assumptions-of-linear-regression" class="nav-link" data-scroll-target="#key-assumptions-of-linear-regression"><span class="header-section-number">9.26</span> Key Assumptions of Linear Regression (*)</a>
  <ul class="collapse">
  <li><a href="#strict-exogeneity-the-fundamental-assumption" id="toc-strict-exogeneity-the-fundamental-assumption" class="nav-link" data-scroll-target="#strict-exogeneity-the-fundamental-assumption">Strict Exogeneity: The Fundamental Assumption</a></li>
  <li><a href="#linearity-the-form-assumption" id="toc-linearity-the-form-assumption" class="nav-link" data-scroll-target="#linearity-the-form-assumption">Linearity: The Form Assumption</a></li>
  <li><a href="#understanding-violations-and-solutions" id="toc-understanding-violations-and-solutions" class="nav-link" data-scroll-target="#understanding-violations-and-solutions">Understanding Violations and Solutions</a></li>
  </ul></li>
  <li><a href="#spurious-correlation-causes-and-examples" id="toc-spurious-correlation-causes-and-examples" class="nav-link" data-scroll-target="#spurious-correlation-causes-and-examples"><span class="header-section-number">9.27</span> Spurious Correlation: Causes and Examples</a>
  <ul class="collapse">
  <li><a href="#random-coincidence-chance" id="toc-random-coincidence-chance" class="nav-link" data-scroll-target="#random-coincidence-chance">Random Coincidence (Chance)</a></li>
  <li><a href="#confounding-variables-hidden-third-factors" id="toc-confounding-variables-hidden-third-factors" class="nav-link" data-scroll-target="#confounding-variables-hidden-third-factors">Confounding Variables (Hidden Third Factors)</a></li>
  <li><a href="#reverse-causality" id="toc-reverse-causality" class="nav-link" data-scroll-target="#reverse-causality">Reverse Causality</a></li>
  <li><a href="#collider-bias-selection-bias" id="toc-collider-bias-selection-bias" class="nav-link" data-scroll-target="#collider-bias-selection-bias">Collider Bias (Selection Bias)</a></li>
  <li><a href="#improper-analysis" id="toc-improper-analysis" class="nav-link" data-scroll-target="#improper-analysis">Improper Analysis</a></li>
  <li><a href="#endogeneity-and-its-sources" id="toc-endogeneity-and-its-sources" class="nav-link" data-scroll-target="#endogeneity-and-its-sources">Endogeneity and Its Sources</a></li>
  </ul></li>
  <li><a href="#appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data" id="toc-appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data" class="nav-link" data-scroll-target="#appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data"><span class="header-section-number">9.28</span> Appendix A.1: Understanding Correlation Measures: A Self-Study Tutorial (Using Stress Level and Cognitive Performance Data)</a>
  <ul class="collapse">
  <li><a href="#dataset-overview" id="toc-dataset-overview" class="nav-link" data-scroll-target="#dataset-overview">Dataset Overview</a></li>
  <li><a href="#covariance-calculation" id="toc-covariance-calculation" class="nav-link" data-scroll-target="#covariance-calculation">1. Covariance Calculation</a></li>
  <li><a href="#pearson-correlation-coefficient-1" id="toc-pearson-correlation-coefficient-1" class="nav-link" data-scroll-target="#pearson-correlation-coefficient-1">2. Pearson Correlation Coefficient</a></li>
  <li><a href="#spearman-rank-correlation" id="toc-spearman-rank-correlation" class="nav-link" data-scroll-target="#spearman-rank-correlation">3. Spearman Rank Correlation</a></li>
  <li><a href="#verification-using-r" id="toc-verification-using-r" class="nav-link" data-scroll-target="#verification-using-r">Verification using R</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  </ul></li>
  <li><a href="#appendix-a.2-calculating-covariance-pearson-spearman-correlation-and-ols---worked-example" id="toc-appendix-a.2-calculating-covariance-pearson-spearman-correlation-and-ols---worked-example" class="nav-link" data-scroll-target="#appendix-a.2-calculating-covariance-pearson-spearman-correlation-and-ols---worked-example"><span class="header-section-number">9.29</span> Appendix A.2: Calculating Covariance, Pearson, Spearman Correlation, and OLS - worked example</a>
  <ul class="collapse">
  <li><a href="#step-1-calculate-basic-statistics" id="toc-step-1-calculate-basic-statistics" class="nav-link" data-scroll-target="#step-1-calculate-basic-statistics">Step 1: Calculate Basic Statistics</a></li>
  <li><a href="#step-2-detailed-covariance-calculations" id="toc-step-2-detailed-covariance-calculations" class="nav-link" data-scroll-target="#step-2-detailed-covariance-calculations">Step 2: Detailed Covariance Calculations</a></li>
  <li><a href="#step-3-standard-deviation-calculations" id="toc-step-3-standard-deviation-calculations" class="nav-link" data-scroll-target="#step-3-standard-deviation-calculations">Step 3: Standard Deviation Calculations</a></li>
  <li><a href="#step-4-pearson-correlation-calculation" id="toc-step-4-pearson-correlation-calculation" class="nav-link" data-scroll-target="#step-4-pearson-correlation-calculation">Step 4: Pearson Correlation Calculation</a></li>
  <li><a href="#step-5-spearman-rank-correlation-calculation" id="toc-step-5-spearman-rank-correlation-calculation" class="nav-link" data-scroll-target="#step-5-spearman-rank-correlation-calculation">Step 5: Spearman Rank Correlation Calculation</a></li>
  <li><a href="#step-6-r-verification" id="toc-step-6-r-verification" class="nav-link" data-scroll-target="#step-6-r-verification">Step 6: R Verification</a></li>
  <li><a href="#step-7-basic-visualization" id="toc-step-7-basic-visualization" class="nav-link" data-scroll-target="#step-7-basic-visualization">Step 7: Basic Visualization</a></li>
  <li><a href="#ols-estimation-and-goodness-of-fit-measures" id="toc-ols-estimation-and-goodness-of-fit-measures" class="nav-link" data-scroll-target="#ols-estimation-and-goodness-of-fit-measures">OLS Estimation and Goodness-of-Fit Measures</a></li>
  <li><a href="#step-1-calculate-ols-estimates" id="toc-step-1-calculate-ols-estimates" class="nav-link" data-scroll-target="#step-1-calculate-ols-estimates">Step 1: Calculate OLS Estimates</a></li>
  <li><a href="#step-2-calculate-fitted-values-and-residuals" id="toc-step-2-calculate-fitted-values-and-residuals" class="nav-link" data-scroll-target="#step-2-calculate-fitted-values-and-residuals">Step 2: Calculate Fitted Values and Residuals</a></li>
  <li><a href="#step-3-calculate-goodness-of-fit-measures" id="toc-step-3-calculate-goodness-of-fit-measures" class="nav-link" data-scroll-target="#step-3-calculate-goodness-of-fit-measures">Step 3: Calculate Goodness-of-Fit Measures</a></li>
  <li><a href="#step-4-r-verification" id="toc-step-4-r-verification" class="nav-link" data-scroll-target="#step-4-r-verification">Step 4: R Verification</a></li>
  <li><a href="#step-5-residual-analysis" id="toc-step-5-residual-analysis" class="nav-link" data-scroll-target="#step-5-residual-analysis">Step 5: Residual Analysis</a></li>
  <li><a href="#step-6-predicted-vs-actual-values-plot" id="toc-step-6-predicted-vs-actual-values-plot" class="nav-link" data-scroll-target="#step-6-predicted-vs-actual-values-plot">Step 6: Predicted vs Actual Values Plot</a></li>
  <li><a href="#log-transformed-models" id="toc-log-transformed-models" class="nav-link" data-scroll-target="#log-transformed-models">Log-Transformed Models</a></li>
  <li><a href="#step-1-data-transformation" id="toc-step-1-data-transformation" class="nav-link" data-scroll-target="#step-1-data-transformation">Step 1: Data Transformation</a></li>
  <li><a href="#step-2-compare-different-model-specifications" id="toc-step-2-compare-different-model-specifications" class="nav-link" data-scroll-target="#step-2-compare-different-model-specifications">Step 2: Compare Different Model Specifications</a></li>
  <li><a href="#step-3-visual-comparison" id="toc-step-3-visual-comparison" class="nav-link" data-scroll-target="#step-3-visual-comparison">Step 3: Visual Comparison</a></li>
  <li><a href="#step-4-residual-analysis-for-best-model" id="toc-step-4-residual-analysis-for-best-model" class="nav-link" data-scroll-target="#step-4-residual-analysis-for-best-model">Step 4: Residual Analysis for Best Model</a></li>
  <li><a href="#step-5-interpretation-of-best-model" id="toc-step-5-interpretation-of-best-model" class="nav-link" data-scroll-target="#step-5-interpretation-of-best-model">Step 5: Interpretation of Best Model</a></li>
  <li><a href="#step-6-model-predictions" id="toc-step-6-model-predictions" class="nav-link" data-scroll-target="#step-6-model-predictions">Step 6: Model Predictions</a></li>
  <li><a href="#step-7-elasticity-analysis" id="toc-step-7-elasticity-analysis" class="nav-link" data-scroll-target="#step-7-elasticity-analysis">Step 7: Elasticity Analysis</a></li>
  </ul></li>
  <li><a href="#appendix-a.3-understanding-pearson-spearman-and-kendall" id="toc-appendix-a.3-understanding-pearson-spearman-and-kendall" class="nav-link" data-scroll-target="#appendix-a.3-understanding-pearson-spearman-and-kendall"><span class="header-section-number">9.30</span> Appendix A.3: Understanding Pearson, Spearman, and Kendall</a>
  <ul class="collapse">
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#pearson-correlation" id="toc-pearson-correlation" class="nav-link" data-scroll-target="#pearson-correlation">Pearson Correlation</a></li>
  <li><a href="#spearman-correlation" id="toc-spearman-correlation" class="nav-link" data-scroll-target="#spearman-correlation">Spearman Correlation</a></li>
  <li><a href="#kendalls-tau" id="toc-kendalls-tau" class="nav-link" data-scroll-target="#kendalls-tau">Kendall’s Tau</a></li>
  <li><a href="#verification-in-r" id="toc-verification-in-r" class="nav-link" data-scroll-target="#verification-in-r">Verification in R</a></li>
  <li><a href="#interpretation-of-results" id="toc-interpretation-of-results" class="nav-link" data-scroll-target="#interpretation-of-results">Interpretation of Results</a></li>
  <li><a href="#comparison-of-measures" id="toc-comparison-of-measures" class="nav-link" data-scroll-target="#comparison-of-measures">Comparison of Measures</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  <li><a href="#key-points-to-remember" id="toc-key-points-to-remember" class="nav-link" data-scroll-target="#key-points-to-remember">Key Points to Remember</a></li>
  </ul></li>
  <li><a href="#appendix-b-bias-in-ols-estimation-with-endogenous-regressors" id="toc-appendix-b-bias-in-ols-estimation-with-endogenous-regressors" class="nav-link" data-scroll-target="#appendix-b-bias-in-ols-estimation-with-endogenous-regressors"><span class="header-section-number">9.31</span> Appendix B: Bias in OLS Estimation with Endogenous Regressors</a></li>
  <li><a href="#theoretical-derivation" id="toc-theoretical-derivation" class="nav-link" data-scroll-target="#theoretical-derivation"><span class="header-section-number">9.32</span> Theoretical Derivation</a></li>
  <li><a href="#simulation-in-r" id="toc-simulation-in-r" class="nav-link" data-scroll-target="#simulation-in-r"><span class="header-section-number">9.33</span> Simulation in R</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">9.34</span> Conclusion</a></li>
  <li><a href="#appendix-c.-ols---worked-examples" id="toc-appendix-c.-ols---worked-examples" class="nav-link" data-scroll-target="#appendix-c.-ols---worked-examples"><span class="header-section-number">9.35</span> Appendix C. OLS - Worked Examples</a></li>
  <li><a href="#example-1.-practice-hours-vs.-skill-rating-visual-guide-to-ols-and-r-squared" id="toc-example-1.-practice-hours-vs.-skill-rating-visual-guide-to-ols-and-r-squared" class="nav-link" data-scroll-target="#example-1.-practice-hours-vs.-skill-rating-visual-guide-to-ols-and-r-squared"><span class="header-section-number">9.36</span> Example 1. Practice Hours vs.&nbsp;Skill Rating: Visual Guide to OLS and R-squared</a>
  <ul class="collapse">
  <li><a href="#manual-calculations" id="toc-manual-calculations" class="nav-link" data-scroll-target="#manual-calculations">Manual Calculations</a></li>
  <li><a href="#visualization-1-the-ols-best-fit-line" id="toc-visualization-1-the-ols-best-fit-line" class="nav-link" data-scroll-target="#visualization-1-the-ols-best-fit-line">Visualization 1: The OLS Best-Fit Line</a></li>
  <li><a href="#visualization-2-variance-decomposition-sst-ssr-sse" id="toc-visualization-2-variance-decomposition-sst-ssr-sse" class="nav-link" data-scroll-target="#visualization-2-variance-decomposition-sst-ssr-sse">Visualization 2: Variance Decomposition (SST = SSR + SSE)</a></li>
  <li><a href="#visualization-3-r-squared-as-a-proportion" id="toc-visualization-3-r-squared-as-a-proportion" class="nav-link" data-scroll-target="#visualization-3-r-squared-as-a-proportion">Visualization 3: R-squared as a Proportion</a></li>
  <li><a href="#visualization-4-r²-as-correlation-between-deviations" id="toc-visualization-4-r²-as-correlation-between-deviations" class="nav-link" data-scroll-target="#visualization-4-r²-as-correlation-between-deviations">Visualization 4: R² as Correlation Between Deviations</a></li>
  <li><a href="#visualization-5-scatterplot-of-deviations-r²-interpretation" id="toc-visualization-5-scatterplot-of-deviations-r²-interpretation" class="nav-link" data-scroll-target="#visualization-5-scatterplot-of-deviations-r²-interpretation">Visualization 5: Scatterplot of Deviations (R² Interpretation)</a></li>
  <li><a href="#summary-table" id="toc-summary-table" class="nav-link" data-scroll-target="#summary-table">Summary Table</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  </ul></li>
  <li><a href="#example-2.-income-and-voter-turnout" id="toc-example-2.-income-and-voter-turnout" class="nav-link" data-scroll-target="#example-2.-income-and-voter-turnout"><span class="header-section-number">9.37</span> Example 2. Income and Voter Turnout</a>
  <ul class="collapse">
  <li><a href="#initial-r-output-for-reference" id="toc-initial-r-output-for-reference" class="nav-link" data-scroll-target="#initial-r-output-for-reference">Initial R Output for Reference</a></li>
  <li><a href="#dispersion-measures" id="toc-dispersion-measures" class="nav-link" data-scroll-target="#dispersion-measures">Dispersion Measures</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation">Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#detailed-decomposition-of-variance-and-r-squared" id="toc-detailed-decomposition-of-variance-and-r-squared" class="nav-link" data-scroll-target="#detailed-decomposition-of-variance-and-r-squared">Detailed Decomposition of Variance and R-squared</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  </ul></li>
  <li><a href="#example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" id="toc-example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="nav-link" data-scroll-target="#example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">9.38</span> Example 3. Anxiety Levels and Cognitive Performance: A Laboratory Study</a>
  <ul class="collapse">
  <li><a href="#data-and-context" id="toc-data-and-context" class="nav-link" data-scroll-target="#data-and-context">Data and Context</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-1" id="toc-covariance-and-correlation-1" class="nav-link" data-scroll-target="#covariance-and-correlation-1">Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-1" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-1">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation" id="toc-r-squared-calculation" class="nav-link" data-scroll-target="#r-squared-calculation">R-squared Calculation</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1">Visualization</a></li>
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2">Interpretation</a></li>
  <li><a href="#study-limitations" id="toc-study-limitations" class="nav-link" data-scroll-target="#study-limitations">Study Limitations</a></li>
  </ul></li>
  <li><a href="#example-4.-anxiety-vs.-performance-correlation-and-regression-analysis" id="toc-example-4.-anxiety-vs.-performance-correlation-and-regression-analysis" class="nav-link" data-scroll-target="#example-4.-anxiety-vs.-performance-correlation-and-regression-analysis"><span class="header-section-number">9.39</span> Example 4. Anxiety vs.&nbsp;Performance: Correlation and Regression Analysis</a></li>
  <li><a href="#data-presentation" id="toc-data-presentation" class="nav-link" data-scroll-target="#data-presentation"><span class="header-section-number">9.40</span> Data Presentation</a>
  <ul class="collapse">
  <li><a href="#the-dataset" id="toc-the-dataset" class="nav-link" data-scroll-target="#the-dataset">The Dataset</a></li>
  <li><a href="#initial-visualization" id="toc-initial-visualization" class="nav-link" data-scroll-target="#initial-visualization">Initial Visualization</a></li>
  </ul></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="header-section-number">9.41</span> Summary Statistics</a>
  <ul class="collapse">
  <li><a href="#calculating-the-means" id="toc-calculating-the-means" class="nav-link" data-scroll-target="#calculating-the-means">Calculating the Means</a></li>
  <li><a href="#calculating-variance-and-standard-deviation" id="toc-calculating-variance-and-standard-deviation" class="nav-link" data-scroll-target="#calculating-variance-and-standard-deviation">Calculating Variance and Standard Deviation</a></li>
  </ul></li>
  <li><a href="#covariance-and-correlation-2" id="toc-covariance-and-correlation-2" class="nav-link" data-scroll-target="#covariance-and-correlation-2"><span class="header-section-number">9.42</span> Covariance and Correlation</a>
  <ul class="collapse">
  <li><a href="#calculating-covariance" id="toc-calculating-covariance" class="nav-link" data-scroll-target="#calculating-covariance">Calculating Covariance</a></li>
  <li><a href="#calculating-pearson-correlation-coefficient" id="toc-calculating-pearson-correlation-coefficient" class="nav-link" data-scroll-target="#calculating-pearson-correlation-coefficient">Calculating Pearson Correlation Coefficient</a></li>
  </ul></li>
  <li><a href="#simple-ols-regression" id="toc-simple-ols-regression" class="nav-link" data-scroll-target="#simple-ols-regression"><span class="header-section-number">9.43</span> Simple OLS Regression</a>
  <ul class="collapse">
  <li><a href="#the-problem-of-modeling-relationships" id="toc-the-problem-of-modeling-relationships" class="nav-link" data-scroll-target="#the-problem-of-modeling-relationships">The Problem of Modeling Relationships</a></li>
  <li><a href="#the-idea-of-sum-of-squared-errors-sse" id="toc-the-idea-of-sum-of-squared-errors-sse" class="nav-link" data-scroll-target="#the-idea-of-sum-of-squared-errors-sse">The Idea of Sum of Squared Errors (SSE)</a></li>
  <li><a href="#ols-estimators" id="toc-ols-estimators" class="nav-link" data-scroll-target="#ols-estimators">OLS Estimators</a></li>
  <li><a href="#calculating-the-ols-parameters" id="toc-calculating-the-ols-parameters" class="nav-link" data-scroll-target="#calculating-the-ols-parameters">Calculating the OLS Parameters</a></li>
  </ul></li>
  <li><a href="#plotting-the-model" id="toc-plotting-the-model" class="nav-link" data-scroll-target="#plotting-the-model"><span class="header-section-number">9.44</span> Plotting the Model</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="header-section-number">9.45</span> Model Evaluation</a>
  <ul class="collapse">
  <li><a href="#variance-decomposition" id="toc-variance-decomposition" class="nav-link" data-scroll-target="#variance-decomposition">Variance Decomposition</a></li>
  <li><a href="#r-squared-coefficient-of-determination" id="toc-r-squared-coefficient-of-determination" class="nav-link" data-scroll-target="#r-squared-coefficient-of-determination">R-squared (Coefficient of Determination)</a></li>
  </ul></li>
  <li><a href="#effect-size" id="toc-effect-size" class="nav-link" data-scroll-target="#effect-size"><span class="header-section-number">9.46</span> Effect Size</a></li>
  <li><a href="#confidence-intervals-and-statistical-significance" id="toc-confidence-intervals-and-statistical-significance" class="nav-link" data-scroll-target="#confidence-intervals-and-statistical-significance"><span class="header-section-number">9.47</span> Confidence Intervals and Statistical Significance</a>
  <ul class="collapse">
  <li><a href="#standard-error-of-the-regression" id="toc-standard-error-of-the-regression" class="nav-link" data-scroll-target="#standard-error-of-the-regression">Standard Error of the Regression</a></li>
  <li><a href="#standard-error-of-the-slope" id="toc-standard-error-of-the-slope" class="nav-link" data-scroll-target="#standard-error-of-the-slope">Standard Error of the Slope</a></li>
  <li><a href="#confidence-interval-for-the-slope" id="toc-confidence-interval-for-the-slope" class="nav-link" data-scroll-target="#confidence-interval-for-the-slope">95% Confidence Interval for the Slope</a></li>
  <li><a href="#statistical-significance" id="toc-statistical-significance" class="nav-link" data-scroll-target="#statistical-significance">Statistical Significance</a></li>
  </ul></li>
  <li><a href="#summary-and-interpretation" id="toc-summary-and-interpretation" class="nav-link" data-scroll-target="#summary-and-interpretation"><span class="header-section-number">9.48</span> Summary and Interpretation</a>
  <ul class="collapse">
  <li><a href="#what-weve-learned" id="toc-what-weve-learned" class="nav-link" data-scroll-target="#what-weve-learned">What We’ve Learned</a></li>
  <li><a href="#practical-implications" id="toc-practical-implications" class="nav-link" data-scroll-target="#practical-implications">Practical Implications</a></li>
  <li><a href="#recommendations-based-on-findings" id="toc-recommendations-based-on-findings" class="nav-link" data-scroll-target="#recommendations-based-on-findings">Recommendations Based on Findings</a></li>
  <li><a href="#limitations-of-our-analysis" id="toc-limitations-of-our-analysis" class="nav-link" data-scroll-target="#limitations-of-our-analysis">Limitations of Our Analysis</a></li>
  <li><a href="#complete-r-code" id="toc-complete-r-code" class="nav-link" data-scroll-target="#complete-r-code">Complete R Code</a></li>
  </ul></li>
  <li><a href="#example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" id="toc-example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="nav-link" data-scroll-target="#example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">9.49</span> Example 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process">Data Generating Process</a></li>
  <li><a href="#descriptive-statistics-1" id="toc-descriptive-statistics-1" class="nav-link" data-scroll-target="#descriptive-statistics-1">Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-3" id="toc-covariance-and-correlation-3" class="nav-link" data-scroll-target="#covariance-and-correlation-3">Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-2" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-2">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation-1" id="toc-r-squared-calculation-1" class="nav-link" data-scroll-target="#r-squared-calculation-1">R-squared Calculation</a></li>
  <li><a href="#visualization---true-vs.-estimated-parameters" id="toc-visualization---true-vs.-estimated-parameters" class="nav-link" data-scroll-target="#visualization---true-vs.-estimated-parameters">Visualization - True vs.&nbsp;Estimated Parameters</a></li>
  <li><a href="#observations-about-model-fit" id="toc-observations-about-model-fit" class="nav-link" data-scroll-target="#observations-about-model-fit">Observations about Model Fit</a></li>
  <li><a href="#interpretation-3" id="toc-interpretation-3" class="nav-link" data-scroll-target="#interpretation-3">Interpretation</a></li>
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context">Study Context</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  </ul></li>
  <li><a href="#appendix-d-ols-regression-in-matrix-form---manual-calculations" id="toc-appendix-d-ols-regression-in-matrix-form---manual-calculations" class="nav-link" data-scroll-target="#appendix-d-ols-regression-in-matrix-form---manual-calculations"><span class="header-section-number">9.50</span> Appendix D: OLS Regression in Matrix Form - Manual Calculations (*)</a>
  <ul class="collapse">
  <li><a href="#a.1-essential-linear-algebra-concepts" id="toc-a.1-essential-linear-algebra-concepts" class="nav-link" data-scroll-target="#a.1-essential-linear-algebra-concepts">A.1 Essential Linear Algebra Concepts</a></li>
  <li><a href="#a.2-ols-minimization-problem-and-derivation" id="toc-a.2-ols-minimization-problem-and-derivation" class="nav-link" data-scroll-target="#a.2-ols-minimization-problem-and-derivation">A.2 OLS Minimization Problem and Derivation</a></li>
  <li><a href="#a.3-case-1-simple-linear-regression-one-predictor" id="toc-a.3-case-1-simple-linear-regression-one-predictor" class="nav-link" data-scroll-target="#a.3-case-1-simple-linear-regression-one-predictor">A.3 Case 1: Simple Linear Regression (One Predictor)</a></li>
  <li><a href="#a.4-case-2-multiple-linear-regression-two-predictors" id="toc-a.4-case-2-multiple-linear-regression-two-predictors" class="nav-link" data-scroll-target="#a.4-case-2-multiple-linear-regression-two-predictors">A.4 Case 2: Multiple Linear Regression (Two Predictors)</a></li>
  <li><a href="#a.5-the-gauss-markov-theorem" id="toc-a.5-the-gauss-markov-theorem" class="nav-link" data-scroll-target="#a.5-the-gauss-markov-theorem">A.5 The Gauss-Markov Theorem</a></li>
  <li><a href="#a.6-key-takeaways" id="toc-a.6-key-takeaways" class="nav-link" data-scroll-target="#a.6-key-takeaways">A.6 Key Takeaways</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">9.1</span> Introduction</h2>
<p>The distinction between correlation and causation represents a fundamental challenge in statistical analysis. While correlation measures the statistical association between variables, causation implies a direct influence of one variable on another.</p>
<p>Statistical relationships form the backbone of data-driven decision making across disciplines—from economics and public health to psychology and environmental science. Understanding when a relationship indicates mere association versus genuine causality is crucial for valid inference and effective policy recommendations.</p>
</section>
<section id="theoretical-foundations" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="theoretical-foundations"><span class="header-section-number">9.2</span> Theoretical Foundations</h2>
<section id="covariance" class="level3">
<h3 class="anchored" data-anchor-id="covariance">Covariance</h3>
<p>Covariance measures how two variables vary together, indicating both the direction and magnitude of their linear relationship. It provides the foundation for understanding correlation but has a critical limitation: its value depends on the units of measurement, making comparisons across different datasets difficult.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\text{cov}(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">x_i</span> and <span class="math inline">y_i</span> are individual data points</li>
<li><span class="math inline">\bar{x}</span> and <span class="math inline">\bar{y}</span> are the means of variables X and Y</li>
<li><span class="math inline">n</span> is the number of observations</li>
<li>We divide by <span class="math inline">(n-1)</span> for sample covariance (Bessel’s correction)</li>
</ul>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Positive covariance</strong>: Variables tend to increase together</li>
<li><strong>Negative covariance</strong>: When one variable increases, the other tends to decrease</li>
<li><strong>Zero covariance</strong>: No linear relationship (variables vary independently)</li>
<li><strong>Magnitude problem</strong>: A covariance of 37.5 vs.&nbsp;7245 cannot be directly compared—the scale depends on the units of X and Y</li>
</ul>
</section>
<section id="correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="correlation-coefficient">Correlation Coefficient</h3>
<p>The correlation coefficient standardizes covariance to eliminate scale dependency, producing values between -1 and +1. This standardization makes correlation coefficients comparable across different datasets and units of measurement.</p>
<p><strong>Interpretation Guidelines:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Correlation Value</th>
<th>Strength</th>
<th>Interpretation</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>±0.90 to ±1.00</td>
<td>Very Strong</td>
<td>Almost perfect relationship</td>
<td>Height of parents and children</td>
</tr>
<tr class="even">
<td>±0.70 to ±0.89</td>
<td>Strong</td>
<td>Highly related variables</td>
<td>Study time and grades</td>
</tr>
<tr class="odd">
<td>±0.50 to ±0.69</td>
<td>Moderate</td>
<td>Moderately related</td>
<td>Exercise and weight loss</td>
</tr>
<tr class="even">
<td>±0.30 to ±0.49</td>
<td>Weak</td>
<td>Weakly related</td>
<td>Shoe size and reading ability</td>
</tr>
<tr class="odd">
<td>±0.00 to ±0.29</td>
<td>Very Weak/None</td>
<td>Little to no relationship</td>
<td>Birth month and intelligence</td>
</tr>
</tbody>
</table>
</section>
<section id="pearson-correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="pearson-correlation-coefficient">Pearson Correlation Coefficient</h3>
<p>Pearson’s <span class="math inline">r</span> measures the <strong>linear</strong> relationship between two continuous variables. It assumes that the relationship can be adequately described by a straight line.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">r = \frac{\text{cov}(X,Y)}{s_X s_Y} = \frac{\sum_{i=1}^n(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^n(x_i - \bar{x})^2} \cdot \sqrt{\sum_{i=1}^n(y_i - \bar{y})^2}}</span></p>
<p>Where <span class="math inline">s_X</span> and <span class="math inline">s_Y</span> are the sample standard deviations of X and Y.</p>
<p><strong>Properties:</strong></p>
<ul>
<li>Range: <span class="math inline">-1 \leq r \leq 1</span></li>
<li><span class="math inline">r = 1</span>: Perfect positive linear relationship</li>
<li><span class="math inline">r = -1</span>: Perfect negative linear relationship</li>
<li><span class="math inline">r = 0</span>: No linear relationship (but non-linear relationships may still exist)</li>
<li>Sensitive to outliers and non-linear patterns</li>
</ul>
</section>
<section id="spearman-rank-correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="spearman-rank-correlation-coefficient">Spearman Rank Correlation Coefficient</h3>
<p>Spearman’s <span class="math inline">\rho</span> (rho) measures <strong>monotonic</strong> relationships using ranks instead of raw values. A monotonic relationship means that as one variable increases, the other either consistently increases or consistently decreases, but not necessarily at a constant rate.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\rho = 1 - \frac{6 \sum_{i=1}^n d_i^2}{n(n^2 - 1)}</span></p>
<p>Where <span class="math inline">d_i</span> is the difference between the ranks of corresponding observations.</p>
<p><strong>When to use Spearman vs.&nbsp;Pearson:</strong></p>
<ul>
<li><strong>Use Pearson when:</strong>
<ul>
<li>Both variables are continuous</li>
<li>The relationship is linear</li>
<li>Data are approximately normally distributed</li>
<li>No significant outliers</li>
</ul></li>
<li><strong>Use Spearman when:</strong>
<ul>
<li>Variables are ordinal (ranked data)</li>
<li>The relationship is monotonic but not linear</li>
<li>Data contain outliers</li>
<li>Distributions are skewed</li>
</ul></li>
</ul>
</section>
<section id="visualizing-correlation-patterns" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-correlation-patterns">Visualizing Correlation Patterns</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data with different correlation patterns</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive linear correlation</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>years_education <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">3</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>annual_income <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="sc">+</span> <span class="dv">3500</span> <span class="sc">*</span> years_education <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>pos_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(years_education, annual_income), <span class="dv">3</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative linear correlation</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>screen_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>sleep_hours <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> screen_time <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>neg_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(screen_time, sleep_hours), <span class="dv">3</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># No correlation</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>x_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>y_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>no_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(x_random, y_random), <span class="dv">3</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-linear correlation (quadratic)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>hours_studied <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">12</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>test_score <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (hours_studied <span class="sc">-</span> <span class="dv">6</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">90</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>nonlin_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(hours_studied, test_score), <span class="dv">3</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frames with correlation values</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>positive_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> years_education, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> annual_income,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Positive Linear (r = "</span>, pos_cor, <span class="st">")"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>negative_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> screen_time, </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> sleep_hours,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Negative Linear (r = "</span>, neg_cor, <span class="st">")"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>no_corr_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_random, </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_random,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"No Correlation (r = "</span>, no_cor, <span class="st">")"</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>nonlinear_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> hours_studied, </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> test_score,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Non-linear (Pearson r = "</span>, nonlin_cor, <span class="st">")"</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(positive_data, negative_data, no_corr_data, nonlinear_data)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Create faceted plot</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Different Types of Correlations"</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Linear regression line shown in red with confidence band"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/correlation_types-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Important Note:</strong> The bottom-right panel demonstrates why Pearson correlation can be misleading for non-linear relationships. Despite a clear pattern, the Pearson <span class="math inline">r</span> value is near zero because the relationship is not linear. In such cases, Spearman correlation or non-linear modeling would be more appropriate.</p>
</section>
</section>
<section id="manual-calculation-methods" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="manual-calculation-methods"><span class="header-section-number">9.3</span> Manual Calculation Methods</h2>
<p>This section provides step-by-step pen-and-paper calculation procedures for computing covariance and correlation coefficients. These manual calculations are essential for understanding the conceptual foundation of these measures.</p>
<section id="calculating-covariance-step-by-step" class="level3">
<h3 class="anchored" data-anchor-id="calculating-covariance-step-by-step">Calculating Covariance: Step-by-Step</h3>
<p><strong>Example: Student Study Hours vs.&nbsp;Test Scores</strong></p>
<p>Data:</p>
<ul>
<li>Study Hours (X): 2, 4, 6, 8, 10</li>
<li>Test Scores (Y): 65, 70, 80, 85, 95</li>
</ul>
<p><strong>Step 1: Calculate the means</strong></p>
<p><span class="math display">\bar{x} = \frac{2+4+6+8+10}{5} = \frac{30}{5} = 6 \text{ hours}</span></p>
<p><span class="math display">\bar{y} = \frac{65+70+80+85+95}{5} = \frac{395}{5} = 79 \text{ points}</span></p>
<p><strong>Step 2: Calculate deviations from the mean</strong></p>
<p>For X: <span class="math inline">(x_i - \bar{x})</span></p>
<ul>
<li><span class="math inline">2 - 6 = -4</span></li>
<li><span class="math inline">4 - 6 = -2</span></li>
<li><span class="math inline">6 - 6 = 0</span></li>
<li><span class="math inline">8 - 6 = 2</span></li>
<li><span class="math inline">10 - 6 = 4</span></li>
</ul>
<p>For Y: <span class="math inline">(y_i - \bar{y})</span></p>
<ul>
<li><span class="math inline">65 - 79 = -14</span></li>
<li><span class="math inline">70 - 79 = -9</span></li>
<li><span class="math inline">80 - 79 = 1</span></li>
<li><span class="math inline">85 - 79 = 6</span></li>
<li><span class="math inline">95 - 79 = 16</span></li>
</ul>
<p><strong>Step 3: Calculate the products of deviations</strong></p>
<p><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span>:</p>
<ul>
<li><span class="math inline">(-4)(-14) = 56</span></li>
<li><span class="math inline">(-2)(-9) = 18</span></li>
<li><span class="math inline">(0)(1) = 0</span></li>
<li><span class="math inline">(2)(6) = 12</span></li>
<li><span class="math inline">(4)(16) = 64</span></li>
</ul>
<p><strong>Step 4: Sum the products</strong></p>
<p><span class="math display">\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) = 56 + 18 + 0 + 12 + 64 = 150</span></p>
<p><strong>Step 5: Divide by <span class="math inline">(n-1)</span></strong></p>
<p><span class="math display">\text{cov}(X,Y) = \frac{150}{5-1} = \frac{150}{4} = 37.5</span></p>
<p><strong>Interpretation:</strong> The positive covariance (37.5) indicates that study hours and test scores tend to increase together.</p>
</section>
<section id="calculating-pearson-correlation-step-by-step" class="level3">
<h3 class="anchored" data-anchor-id="calculating-pearson-correlation-step-by-step">Calculating Pearson Correlation: Step-by-Step</h3>
<p>Using the same study hours data, we now standardize the covariance to get the correlation coefficient.</p>
<p><strong>Step 1: Use the covariance from above</strong></p>
<p><span class="math display">\text{cov}(X,Y) = 37.5</span></p>
<p><strong>Step 2: Calculate the sum of squared deviations</strong></p>
<p>For X: <span class="math inline">\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<ul>
<li><span class="math inline">(-4)^2 = 16</span></li>
<li><span class="math inline">(-2)^2 = 4</span></li>
<li><span class="math inline">(0)^2 = 0</span></li>
<li><span class="math inline">(2)^2 = 4</span></li>
<li><span class="math inline">(4)^2 = 16</span></li>
<li><strong>Sum = 40</strong></li>
</ul>
<p>For Y: <span class="math inline">\sum_{i=1}^n (y_i - \bar{y})^2</span></p>
<ul>
<li><span class="math inline">(-14)^2 = 196</span></li>
<li><span class="math inline">(-9)^2 = 81</span></li>
<li><span class="math inline">(1)^2 = 1</span></li>
<li><span class="math inline">(6)^2 = 36</span></li>
<li><span class="math inline">(16)^2 = 256</span></li>
<li><strong>Sum = 570</strong></li>
</ul>
<p><strong>Step 3: Calculate the sample standard deviations</strong></p>
<p><span class="math display">s_X = \sqrt{\frac{\sum(x_i - \bar{x})^2}{n-1}} = \sqrt{\frac{40}{4}} = \sqrt{10} = 3.162</span></p>
<p><span class="math display">s_Y = \sqrt{\frac{\sum(y_i - \bar{y})^2}{n-1}} = \sqrt{\frac{570}{4}} = \sqrt{142.5} = 11.937</span></p>
<p><strong>Step 4: Calculate the correlation coefficient</strong></p>
<p><span class="math display">r = \frac{\text{cov}(X,Y)}{s_X \cdot s_Y} = \frac{37.5}{3.162 \times 11.937} = \frac{37.5}{37.73} = 0.994</span></p>
<p><strong>Interpretation:</strong> <span class="math inline">r = 0.994</span> indicates an almost perfect positive linear relationship between study hours and test scores.</p>
</section>
<section id="calculating-spearman-correlation-step-by-step" class="level3">
<h3 class="anchored" data-anchor-id="calculating-spearman-correlation-step-by-step">Calculating Spearman Correlation: Step-by-Step</h3>
<p><strong>Example: Math and English Scores</strong></p>
<p>Raw data:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Math Score</th>
<th>English Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>78</td>
<td>82</td>
</tr>
<tr class="even">
<td>B</td>
<td>85</td>
<td>90</td>
</tr>
<tr class="odd">
<td>C</td>
<td>88</td>
<td>88</td>
</tr>
<tr class="even">
<td>D</td>
<td>92</td>
<td>94</td>
</tr>
<tr class="odd">
<td>E</td>
<td>95</td>
<td>96</td>
</tr>
</tbody>
</table>
<p><strong>Step 1: Rank each variable separately (lowest to highest)</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Math Score</th>
<th>Math Rank</th>
<th>English Score</th>
<th>English Rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>78</td>
<td>1</td>
<td>82</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>85</td>
<td>2</td>
<td>90</td>
<td>3</td>
</tr>
<tr class="odd">
<td>C</td>
<td>88</td>
<td>3</td>
<td>88</td>
<td>2</td>
</tr>
<tr class="even">
<td>D</td>
<td>92</td>
<td>4</td>
<td>94</td>
<td>4</td>
</tr>
<tr class="odd">
<td>E</td>
<td>95</td>
<td>5</td>
<td>96</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><strong>Step 2: Calculate differences between ranks</strong></p>
<p><span class="math inline">d = \text{Math Rank} - \text{English Rank}</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Math Rank</th>
<th>English Rank</th>
<th><span class="math inline">d</span></th>
<th><span class="math inline">d^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>3</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><strong>Sum:</strong></td>
<td><strong>2</strong></td>
</tr>
</tbody>
</table>
<p><strong>Step 3: Apply the Spearman formula</strong></p>
<p><span class="math display">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)} = 1 - \frac{6 \times 2}{5(25-1)} = 1 - \frac{12}{120} = 1 - 0.1 = 0.9</span></p>
<p><strong>Interpretation:</strong> <span class="math inline">\rho = 0.9</span> indicates a very strong monotonic relationship between math and English scores.</p>
</section>
</section>
<section id="r-verification-and-implementation" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="r-verification-and-implementation"><span class="header-section-number">9.4</span> R Verification and Implementation</h2>
<p>This section provides R code to verify the manual calculations and demonstrates efficient computational methods for correlation analysis.</p>
<section id="covariance-verification" class="level3">
<h3 class="anchored" data-anchor-id="covariance-verification">Covariance Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>test_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate covariance using R</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>cov_r <span class="ot">&lt;-</span> <span class="fu">cov</span>(study_hours, test_scores)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Covariance (R function):"</span>, <span class="fu">round</span>(cov_r, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Covariance (R function): 37.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation step by step</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(study_hours)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(test_scores)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x_dev <span class="ot">&lt;-</span> study_hours <span class="sc">-</span> x_mean</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>y_dev <span class="ot">&lt;-</span> test_scores <span class="sc">-</span> y_mean</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>products <span class="ot">&lt;-</span> x_dev <span class="sc">*</span> y_dev</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>cov_manual <span class="ot">&lt;-</span> <span class="fu">sum</span>(products) <span class="sc">/</span> (<span class="fu">length</span>(study_hours) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display detailed calculation table</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>calc_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> study_hours,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> test_scores,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_dev =</span> x_dev,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_dev =</span> y_dev,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product =</span> products</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calc_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y X_dev Y_dev Product
1  2 65    -4   -14      56
2  4 70    -2    -9      18
3  6 80     0     1       0
4  8 85     2     6      12
5 10 95     4    16      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of products:"</span>, <span class="fu">sum</span>(products))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of products: 150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">n - 1 ="</span>, <span class="fu">length</span>(study_hours) <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
n - 1 = 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Covariance (manual):"</span>, <span class="fu">round</span>(cov_manual, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Covariance (manual): 37.5</code></pre>
</div>
</div>
</section>
<section id="pearson-correlation-verification" class="level3">
<h3 class="anchored" data-anchor-id="pearson-correlation-verification">Pearson Correlation Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data from manual example</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>test_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Pearson correlation using R</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>r_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(study_hours, test_scores, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson correlation (R):"</span>, <span class="fu">round</span>(r_value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson correlation (R): 0.993 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed manual calculation</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(study_hours)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(test_scores)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>x_dev <span class="ot">&lt;-</span> study_hours <span class="sc">-</span> x_mean</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>y_dev <span class="ot">&lt;-</span> test_scores <span class="sc">-</span> y_mean</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive calculation table</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>detailed_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> study_hours,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> test_scores,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_dev =</span> x_dev,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_dev =</span> y_dev,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_dev_sq =</span> x_dev<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_dev_sq =</span> y_dev<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product =</span> x_dev <span class="sc">*</span> y_dev</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(detailed_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y X_dev Y_dev X_dev_sq Y_dev_sq Product
1  2 65    -4   -14       16      196      56
2  4 70    -2    -9        4       81      18
3  6 80     0     1        0        1       0
4  8 85     2     6        4       36      12
5 10 95     4    16       16      256      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary calculations</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Summary Statistics:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Summary Statistics:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of (X - mean_X)²:"</span>, <span class="fu">sum</span>(x_dev<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of (X - mean_X)²: 40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of (Y - mean_Y)²:"</span>, <span class="fu">sum</span>(y_dev<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of (Y - mean_Y)²: 570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of products:"</span>, <span class="fu">sum</span>(x_dev <span class="sc">*</span> y_dev))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of products: 150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Standard deviation of X:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(study_hours), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Standard deviation of X: 3.162</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviation of Y:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(test_scores), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviation of Y: 11.937</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Covariance:"</span>, <span class="fu">round</span>(<span class="fu">cov</span>(study_hours, test_scores), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Covariance: 37.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Correlation:"</span>, <span class="fu">round</span>(r_value, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation: 0.993</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical significance test</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>cor_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(study_hours, test_scores, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Statistical Test Results:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Statistical Test Results:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">t-statistic:"</span>, <span class="fu">round</span>(cor_test_result<span class="sc">$</span>statistic, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t-statistic: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">p-value:"</span>, <span class="fu">round</span>(cor_test_result<span class="sc">$</span>p.value, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
p-value: 0.0006</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">95% Confidence Interval: ["</span>, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_test_result<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">","</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(cor_test_result<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
95% Confidence Interval: [ 0.899 , 1 ]</code></pre>
</div>
</div>
</section>
<section id="spearman-correlation-verification" class="level3">
<h3 class="anchored" data-anchor-id="spearman-correlation-verification">Spearman Correlation Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data from manual example</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>math_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">92</span>, <span class="dv">95</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>english_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">82</span>, <span class="dv">90</span>, <span class="dv">88</span>, <span class="dv">94</span>, <span class="dv">96</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ranking table</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>rank_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math_Score =</span> math_scores,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math_Rank =</span> <span class="fu">rank</span>(math_scores),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">English_Score =</span> english_scores,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">English_Rank =</span> <span class="fu">rank</span>(english_scores)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>rank_table<span class="sc">$</span>d <span class="ot">&lt;-</span> rank_table<span class="sc">$</span>Math_Rank <span class="sc">-</span> rank_table<span class="sc">$</span>English_Rank</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>rank_table<span class="sc">$</span>d_squared <span class="ot">&lt;-</span> rank_table<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rank_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Math_Score Math_Rank English_Score English_Rank  d d_squared
1       A         78         1            82            1  0         0
2       B         85         2            90            3 -1         1
3       C         88         3            88            2  1         1
4       D         92         4            94            4  0         0
5       E         95         5            96            5  0         0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of d²:"</span>, <span class="fu">sum</span>(rank_table<span class="sc">$</span>d_squared))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of d²: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate using R function</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>rho_r <span class="ot">&lt;-</span> <span class="fu">cor</span>(math_scores, english_scores, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (R):"</span>, <span class="fu">round</span>(rho_r, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (R): 0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual calculation verification</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(math_scores)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>rho_manual <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">6</span> <span class="sc">*</span> <span class="fu">sum</span>(rank_table<span class="sc">$</span>d_squared)) <span class="sc">/</span> (n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (manual):"</span>, <span class="fu">round</span>(rho_manual, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (manual): 0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistical test</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(math_scores, english_scores, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">p-value:"</span>, <span class="fu">round</span>(spearman_test<span class="sc">$</span>p.value, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

p-value: 0.0833</code></pre>
</div>
</div>
</section>
</section>
<section id="practice-exercises" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="practice-exercises"><span class="header-section-number">9.5</span> Practice Exercises</h2>
<section id="exercise-1-calculate-covariance-and-pearson-correlation-manually" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1-calculate-covariance-and-pearson-correlation-manually">Exercise 1: Calculate Covariance and Pearson Correlation Manually</h3>
<p><strong>Data: Temperature and Ice Cream Sales</strong></p>
<ul>
<li>Temperature (°F): 32, 50, 68, 86, 95</li>
<li>Ice Cream Sales ($): 100, 200, 400, 600, 800</li>
</ul>
<p><strong>Tasks:</strong></p>
<ol type="1">
<li>Calculate the covariance manually</li>
<li>Calculate the Pearson correlation coefficient manually</li>
<li>Interpret the results</li>
</ol>
<p><strong>Manual Solution:</strong></p>
<p><strong>Part 1: Covariance</strong></p>
<p>Step 1: Calculate means</p>
<p><span class="math display">\bar{x} = \frac{32 + 50 + 68 + 86 + 95}{5} = \frac{331}{5} = 66.2°F</span></p>
<p><span class="math display">\bar{y} = \frac{100 + 200 + 400 + 600 + 800}{5} = \frac{2100}{5} = 420 \text{ dollars}</span></p>
<p>Step 2: Calculate deviations</p>
<p>For Temperature: <span class="math inline">-34.2, -16.2, 1.8, 19.8, 28.8</span></p>
<p>For Sales: <span class="math inline">-320, -220, -20, 180, 380</span></p>
<p>Step 3: Calculate products</p>
<ul>
<li><span class="math inline">(-34.2)(-320) = 10944</span></li>
<li><span class="math inline">(-16.2)(-220) = 3564</span></li>
<li><span class="math inline">(1.8)(-20) = -36</span></li>
<li><span class="math inline">(19.8)(180) = 3564</span></li>
<li><span class="math inline">(28.8)(380) = 10944</span></li>
</ul>
<p>Step 4: Sum products and divide</p>
<p><span class="math display">\text{cov}(X,Y) = \frac{10944 + 3564 + (-36) + 3564 + 10944}{4} = \frac{28980}{4} = 7245</span></p>
<p><strong>Part 2: Pearson Correlation</strong></p>
<p>Step 1: Calculate sum of squared deviations</p>
<p>For Temperature:</p>
<ul>
<li><span class="math inline">(-34.2)^2 = 1169.64</span></li>
<li><span class="math inline">(-16.2)^2 = 262.44</span></li>
<li><span class="math inline">(1.8)^2 = 3.24</span></li>
<li><span class="math inline">(19.8)^2 = 392.04</span></li>
<li><span class="math inline">(28.8)^2 = 829.44</span></li>
<li><strong>Sum = 2656.8</strong></li>
</ul>
<p>For Sales:</p>
<ul>
<li><span class="math inline">(-320)^2 = 102400</span></li>
<li><span class="math inline">(-220)^2 = 48400</span></li>
<li><span class="math inline">(-20)^2 = 400</span></li>
<li><span class="math inline">(180)^2 = 32400</span></li>
<li><span class="math inline">(380)^2 = 144400</span></li>
<li><strong>Sum = 328000</strong></li>
</ul>
<p>Step 2: Calculate standard deviations</p>
<p><span class="math display">s_X = \sqrt{\frac{2656.8}{4}} = \sqrt{664.2} = 25.77</span></p>
<p><span class="math display">s_Y = \sqrt{\frac{328000}{4}} = \sqrt{82000} = 286.36</span></p>
<p>Step 3: Calculate correlation</p>
<p><span class="math display">r = \frac{7245}{25.77 \times 286.36} = \frac{7245}{7380.14} = 0.982</span></p>
<p><strong>Interpretation:</strong> The very strong positive correlation (<span class="math inline">r = 0.982</span>) indicates that as temperature increases, ice cream sales increase proportionally. The covariance of 7245 confirms this positive relationship, though its magnitude is difficult to interpret without standardization.</p>
<p><strong>R Verification:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">50</span>, <span class="dv">68</span>, <span class="dv">86</span>, <span class="dv">95</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">600</span>, <span class="dv">800</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Covariance:"</span>, <span class="fu">round</span>(<span class="fu">cov</span>(temp, sales), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Covariance: 7245 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detailed calculation table</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>temp_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>sales_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sales)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>temp_dev <span class="ot">&lt;-</span> temp <span class="sc">-</span> temp_mean</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>sales_dev <span class="ot">&lt;-</span> sales <span class="sc">-</span> sales_mean</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>calc_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temperature =</span> temp,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sales =</span> sales,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temp_dev =</span> temp_dev,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sales_dev =</span> sales_dev,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temp_dev_sq =</span> temp_dev<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sales_dev_sq =</span> sales_dev<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product =</span> temp_dev <span class="sc">*</span> sales_dev</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calc_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Temperature Sales Temp_dev Sales_dev Temp_dev_sq Sales_dev_sq Product
1          32   100    -34.2      -320     1169.64       102400   10944
2          50   200    -16.2      -220      262.44        48400    3564
3          68   400      1.8       -20        3.24          400     -36
4          86   600     19.8       180      392.04        32400    3564
5          95   800     28.8       380      829.44       144400   10944</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pearson correlation:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(temp, sales), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Pearson correlation: 0.982</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviation (Temp):"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(temp), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviation (Temp): 25.77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviation (Sales):"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(sales), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviation (Sales): 286.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>cor_test_ex1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(temp, sales)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">p-value:"</span>, <span class="fu">format.pval</span>(cor_test_ex1<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
p-value: 0.002962</code></pre>
</div>
</div>
</section>
<section id="exercise-2-calculate-spearman-correlation-manually" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2-calculate-spearman-correlation-manually">Exercise 2: Calculate Spearman Correlation Manually</h3>
<p><strong>Data: Student Rankings in Math and Science</strong></p>
<p>Given rankings (already ranked from lowest to highest performance):</p>
<ul>
<li>Student rankings in Math: 1, 3, 2, 5, 4</li>
<li>Student rankings in Science: 2, 4, 1, 5, 3</li>
</ul>
<p><strong>Tasks:</strong></p>
<ol type="1">
<li>Calculate the Spearman correlation coefficient manually</li>
<li>Interpret the result</li>
<li>Compare with Pearson correlation</li>
</ol>
<p><strong>Manual Solution:</strong></p>
<p>Step 1: Create difference table</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Math Rank</th>
<th>Science Rank</th>
<th><span class="math inline">d</span></th>
<th><span class="math inline">d^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>4</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><strong>Sum:</strong></td>
<td><strong>4</strong></td>
</tr>
</tbody>
</table>
<p>Step 2: Apply formula</p>
<p><span class="math display">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)} = 1 - \frac{6 \times 4}{5(25 - 1)} = 1 - \frac{24}{120} = 1 - 0.2 = 0.8</span></p>
<p><strong>Interpretation:</strong> The Spearman correlation of <span class="math inline">\rho = 0.8</span> indicates a strong positive monotonic relationship between math and science rankings. Students who rank higher in math tend to rank higher in science.</p>
<p><strong>R Verification:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rankings (already ranked data)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>math_rank <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>science_rank <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create table</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> math_rank <span class="sc">-</span> science_rank</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>d_squared <span class="ot">&lt;-</span> d<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>rank_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math_Rank =</span> math_rank,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Science_Rank =</span> science_rank,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> d,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_squared =</span> d_squared</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rank_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Math_Rank Science_Rank  d d_squared
1       1         1            2 -1         1
2       2         3            4 -1         1
3       3         2            1  1         1
4       4         5            5  0         0
5       5         4            3  1         1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculations</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(math_rank)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>sum_d_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(d_squared)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>rho_manual <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">6</span> <span class="sc">*</span> sum_d_sq) <span class="sc">/</span> (n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of d²:"</span>, sum_d_sq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of d²: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">n(n² - 1) ="</span>, n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
n(n² - 1) = 120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (manual):"</span>, <span class="fu">round</span>(rho_manual, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (manual): 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (R):"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(math_rank, science_rank, <span class="at">method =</span> <span class="st">"spearman"</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (R): 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with Pearson (on ranks)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pearson correlation (on ranks):"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(math_rank, science_rank, <span class="at">method =</span> <span class="st">"pearson"</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Pearson correlation (on ranks): 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>spearman_test_ex2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(math_rank, science_rank, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">p-value:"</span>, <span class="fu">round</span>(spearman_test_ex2<span class="sc">$</span>p.value, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
p-value: 0.1333</code></pre>
</div>
</div>
</section>
<section id="exercise-3-comparing-pearson-and-spearman" class="level3">
<h3 class="anchored" data-anchor-id="exercise-3-comparing-pearson-and-spearman">Exercise 3: Comparing Pearson and Spearman</h3>
<p><strong>Data: Hours Studied and Exam Performance (with outlier)</strong></p>
<ul>
<li>Hours Studied: 2, 3, 4, 5, 20 (last value is an outlier)</li>
<li>Exam Score: 60, 65, 70, 75, 80</li>
</ul>
<p><strong>Tasks:</strong></p>
<ol type="1">
<li>Calculate both Pearson and Spearman correlations manually</li>
<li>Explain why the values differ</li>
<li>Which measure is more appropriate here?</li>
</ol>
<p><strong>Manual Solution:</strong></p>
<p><strong>Part 1: Pearson Correlation</strong></p>
<p>Means: <span class="math inline">\bar{x} = 6.8</span>, <span class="math inline">\bar{y} = 70</span></p>
<p>Deviations and calculations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>X</th>
<th>Y</th>
<th><span class="math inline">(x_i - \bar{x})</span></th>
<th><span class="math inline">(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
<th>Product</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>60</td>
<td>-4.8</td>
<td>-10</td>
<td>23.04</td>
<td>100</td>
<td>48</td>
</tr>
<tr class="even">
<td>3</td>
<td>65</td>
<td>-3.8</td>
<td>-5</td>
<td>14.44</td>
<td>25</td>
<td>19</td>
</tr>
<tr class="odd">
<td>4</td>
<td>70</td>
<td>-2.8</td>
<td>0</td>
<td>7.84</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>5</td>
<td>75</td>
<td>-1.8</td>
<td>5</td>
<td>3.24</td>
<td>25</td>
<td>-9</td>
</tr>
<tr class="odd">
<td>20</td>
<td>80</td>
<td>13.2</td>
<td>10</td>
<td>174.24</td>
<td>100</td>
<td>132</td>
</tr>
</tbody>
</table>
<p>Sums: <span class="math inline">\sum(x - \bar{x})^2 = 222.8</span>, <span class="math inline">\sum(y - \bar{y})^2 = 250</span>, <span class="math inline">\sum \text{products} = 190</span></p>
<p><span class="math display">s_X = \sqrt{\frac{222.8}{4}} = 7.46, \quad s_Y = \sqrt{\frac{250}{4}} = 7.91</span></p>
<p><span class="math display">r = \frac{190/(4)}{7.46 \times 7.91} = \frac{47.5}{59.01} = 0.805</span></p>
<p><strong>Part 2: Spearman Correlation</strong></p>
<p>Ranks:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>X</th>
<th>Rank(X)</th>
<th>Y</th>
<th>Rank(Y)</th>
<th>d</th>
<th><span class="math inline">d^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>60</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
<td>65</td>
<td>2</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3</td>
<td>70</td>
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>5</td>
<td>4</td>
<td>75</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>20</td>
<td>5</td>
<td>80</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\rho = 1 - \frac{6 \times 0}{5(24)} = 1 - 0 = 1.0</span></p>
<p><strong>Explanation:</strong> Pearson correlation (<span class="math inline">r = 0.805</span>) is affected by the outlier (20 hours), reducing the correlation strength. Spearman correlation (<span class="math inline">\rho = 1.0</span>) is perfect because the <strong>rank order</strong> is identical despite the extreme value. The ranking approach is robust to outliers.</p>
<p><strong>Which is more appropriate?</strong> Spearman is more appropriate here because:</p>
<ol type="1">
<li>The relationship is monotonic but potentially non-linear</li>
<li>The outlier (20 hours) distorts the Pearson correlation</li>
<li>We care about the ordering relationship more than the exact linear fit</li>
</ol>
<p><strong>R Verification:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data with outlier</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">20</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Both correlations</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>pearson_r <span class="ot">&lt;-</span> <span class="fu">cor</span>(hours, scores, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>spearman_rho <span class="ot">&lt;-</span> <span class="fu">cor</span>(hours, scores, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson correlation:"</span>, <span class="fu">round</span>(pearson_r, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson correlation: 0.805</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation:"</span>, <span class="fu">round</span>(spearman_rho, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Difference:"</span>, <span class="fu">round</span>(spearman_rho <span class="sc">-</span> pearson_r, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Difference: 0.195</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show ranks</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rank_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Hours =</span> hours,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rank_Hours =</span> <span class="fu">rank</span>(hours),</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Scores =</span> scores,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rank_Scores =</span> <span class="fu">rank</span>(scores)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rank_comparison)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Hours Rank_Hours Scores Rank_Scores
1     2          1     60           1
2     3          2     65           2
3     4          3     70           3
4     5          4     75           4
5    20          5     80           5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hours, scores, <span class="at">main =</span> <span class="st">"Raw Data"</span>, </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Hours Studied"</span>, <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(scores <span class="sc">~</span> hours), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">15</span>, <span class="dv">65</span>, <span class="fu">paste</span>(<span class="st">"Pearson r ="</span>, <span class="fu">round</span>(pearson_r, <span class="dv">3</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rank</span>(hours), <span class="fu">rank</span>(scores), <span class="at">main =</span> <span class="st">"Ranked Data"</span>,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Rank (Hours)"</span>, <span class="at">ylab =</span> <span class="st">"Rank (Scores)"</span>,</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">rank</span>(scores) <span class="sc">~</span> <span class="fu">rank</span>(hours)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="fu">paste</span>(<span class="st">"Spearman ρ ="</span>, <span class="fu">round</span>(spearman_rho, <span class="dv">3</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/exercise3_verification-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><strong>Key Takeaways:</strong></p>
<ol type="1">
<li><p><strong>Covariance</strong> measures the direction and strength of the relationship, but its value depends on the units of measurement of both variables—covariances cannot be compared across different pairs of variables</p></li>
<li><p><strong>Pearson correlation</strong> standardizes covariance to the range [-1, 1], measuring the strength of a <strong>linear</strong> relationship. It is sensitive to outliers and can be misleading for non-linear relationships</p></li>
<li><p><strong>Spearman correlation</strong> is based on ranks, measuring <strong>monotonic</strong> relationships (not necessarily linear). It is robust to outliers and appropriate for ordinal data</p></li>
<li><p><strong>Manual calculations</strong> are crucial for understanding how these measures are constructed—they show that correlation is essentially a standardized average of products of deviations</p></li>
<li><p><strong>Visualization is essential</strong>—a scatter plot can reveal non-linearity, outliers, or lack of relationship that numbers alone will not show</p></li>
<li><p><strong>Choosing a measure</strong>: Use Pearson for linear relationships between continuous variables without outliers; use Spearman for ranked data, non-linear relationships, or in the presence of outliers</p></li>
</ol>
<hr>
</section>
</section>
<section id="important-points-to-remember" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="important-points-to-remember"><span class="header-section-number">9.6</span> Important Points to Remember</h2>
<ol type="1">
<li><strong>Correlation measures relationship strength:</strong> Values range from -1 to +1</li>
<li><strong>Correlation ≠ Causation:</strong> High correlation doesn’t prove one variable causes another</li>
<li><strong>Choose the right method:</strong>
<ul>
<li>Pearson: For linear relationships in continuous data</li>
<li>Spearman: For monotonic relationships or ranked data</li>
</ul></li>
<li><strong>Check assumptions:</strong>
<ul>
<li>Pearson assumes linear relationship and normal distribution</li>
<li>Spearman only assumes monotonic relationship</li>
</ul></li>
<li><strong>Watch for outliers:</strong> Extreme values can greatly affect Pearson correlation</li>
<li><strong>Visualize your data:</strong> Always plot before calculating correlation</li>
</ol>
</section>
<section id="summary-decision-tree-for-correlation-analysis" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="summary-decision-tree-for-correlation-analysis"><span class="header-section-number">9.7</span> Summary: Decision Tree for Correlation Analysis</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
CHOOSING THE RIGHT CORRELATION METHOD:

Is your data numerical?
├─ YES → Is the relationship linear?
│   ├─ YES → Use PEARSON correlation
│   └─ NO → Is it monotonic?
│       ├─ YES → Use SPEARMAN correlation
│       └─ NO → Consider non-linear methods
└─ NO → Is it ordinal (ranked)?
    ├─ YES → Use SPEARMAN correlation
    └─ NO → Use CROSS-TABULATION for categorical data (beyond the scope of this course)</code></pre>
</div>
</div>
<section id="quick-reference-card" class="level3">
<h3 class="anchored" data-anchor-id="quick-reference-card">Quick Reference Card</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Measure</th>
<th>Use When</th>
<th>Formula</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Covariance</strong></td>
<td>Initial exploration of relationship</td>
<td><span class="math inline">\frac{\sum(x_i-\bar{x})(y_i-\bar{y})}{n-1}</span></td>
<td>-∞ to +∞</td>
</tr>
<tr class="even">
<td><strong>Pearson r</strong></td>
<td>Linear relationships, continuous data</td>
<td><span class="math inline">\frac{\text{cov}(X,Y)}{s_X s_Y}</span></td>
<td>-1 to +1</td>
</tr>
<tr class="odd">
<td><strong>Spearman ρ</strong></td>
<td>Monotonic relationships, ranked data</td>
<td><span class="math inline">1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></td>
<td>-1 to +1</td>
</tr>
<tr class="even">
<td><strong>Cross-tabs</strong></td>
<td>Categorical variables</td>
<td>Frequency counts</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="introduction-to-statistical-modeling-regression-analysis-and-ols-method" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="introduction-to-statistical-modeling-regression-analysis-and-ols-method"><span class="header-section-number">9.8</span> Introduction to Statistical Modeling, Regression Analysis, and OLS Method</h2>
<section id="what-is-a-model-and-why-do-we-need-models" class="level3">
<h3 class="anchored" data-anchor-id="what-is-a-model-and-why-do-we-need-models">What Is a Model and Why Do We Need Models?</h3>
<p>A <strong>model</strong> is a simplified representation of reality. It’s not meant to capture every detail of the world – that would be impossible and useless.</p>
<p>Instead, a model deliberately ignores most complexity to focus on the essential relationships we care about.</p>
<p>Think about a subway map. It doesn’t show real distances, street layouts, or building locations. It’s “wrong” in most details – but it’s incredibly useful because it shows what matters: which stations connect and in what order. This is what all good models do: they sacrifice completeness for clarity and usefulness.</p>
<p>In social sciences, we build models to:</p>
<ul>
<li><strong>Understand relationships</strong>: Does education affect income? Does campaign spending influence election outcomes? Models help us isolate specific relationships from the noise of reality.</li>
<li><strong>Make predictions</strong>: What voter turnout can we expect given current economic conditions? Models let us make educated guesses about unknown or future values.</li>
<li><strong>Test theories</strong>: Is there evidence that proportional representation systems increase voter participation? Models provide a framework for rigorous hypothesis testing.</li>
<li><strong>Simplify complexity</strong>: Real social phenomena involve thousands of factors. Models help us focus on what matters most.</li>
</ul>
<p>The famous statistician George Box wrote: <em>“All models are wrong, but some are useful.”</em> This isn’t pessimism – it’s realism. We know our models don’t capture every detail of reality. The question is whether they’re useful enough for our purposes.</p>
</section>
<section id="why-regression-analysis" class="level3">
<h3 class="anchored" data-anchor-id="why-regression-analysis">Why Regression Analysis?</h3>
<p>Regression analysis is one of the most fundamental tools in quantitative social science. At its core, regression answers a simple question: <strong>How does <span class="math inline">Y</span> change when <span class="math inline">X</span> changes?</strong></p>
<p>For example:</p>
<ul>
<li>How does GDP growth (Y) relate to government debt (X)?</li>
<li>How does voter turnout (Y) change with education levels (X)?</li>
<li>How does policy support (Y) respond to media coverage (X)?</li>
</ul>
<p>But regression does more than just describe relationships. It allows us to:</p>
<ol type="1">
<li><strong>Quantify relationships</strong>: Not just “education affects income” but “each additional year of education is associated with approximately X% higher income, on average.”</li>
<li><strong>Control for confounding factors</strong>: We can examine the effect of X on Y while holding other variables constant – crucial when we can’t run controlled experiments.</li>
<li><strong>Make conditional predictions</strong>: Given specific values of our predictor variables, what outcome would we expect?</li>
<li><strong>Test competing explanations</strong>: Do economic factors or cultural factors better explain voting behavior? Regression lets us compare.</li>
</ol>
<hr>
</section>
<section id="deterministic-vs.-stochastic-models" class="level3">
<h3 class="anchored" data-anchor-id="deterministic-vs.-stochastic-models">Deterministic vs.&nbsp;Stochastic Models</h3>
<p>In science and social sciences, we work with two fundamentally different types of models:</p>
<p><strong>Deterministic models</strong> assume perfect, exact relationships with no randomness. For example, in physics:</p>
<p><span class="math display">d = v \cdot t</span></p>
<p>If velocity (<span class="math inline">v</span>) is 50 km/h and time (<span class="math inline">t</span>) is 2 hours, then distance (<span class="math inline">d</span>) is <strong>exactly</strong> 100 km. No variation, no uncertainty.</p>
<p><strong>Stochastic models</strong> acknowledge that relationships are not perfect – they include randomness and uncertainty. In social sciences, we almost always work with stochastic models because:</p>
<ul>
<li>Human behavior is complex and influenced by many factors</li>
<li>We can’t measure everything that matters</li>
<li>There’s genuine randomness in social processes</li>
<li>Measurement itself contains errors</li>
</ul>
<p>A stochastic model captures this by writing:</p>
<p><span class="math display">Y_i = f(X_i) + \varepsilon_i</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">Y_i</span> is the outcome we want to predict (e.g., voter turnout)</li>
<li><span class="math inline">X_i</span> is our predictor variable (e.g., GDP per capita)</li>
<li><span class="math inline">f(X_i)</span> is the systematic part – the pattern we can explain</li>
<li><span class="math inline">\varepsilon_i</span> is the stochastic part – the random error or unexplained variation</li>
</ul>
<p><strong>Example:</strong> Predicting exam scores from study hours. Even if we know someone studied 5 hours, we can’t predict their exact score – maybe they had a bad day, maybe the material was particularly hard for them, maybe they’re naturally talented. The best we can do is predict the <strong>average</strong> score for people who studied 5 hours, acknowledging there will be variation around this average.</p>
<p>The key insight: we’re trying to model the <strong>systematic relationship</strong> while acknowledging that <strong>perfect prediction is impossible</strong>.</p>
</section>
<section id="visualizing-relationships-scatterplots-and-types-of-patterns" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-relationships-scatterplots-and-types-of-patterns">Visualizing Relationships: Scatterplots and Types of Patterns</h3>
<p>Before fitting any model, we should always visualize our data. A <strong>scatterplot</strong> displays the relationship between two variables. Different datasets can show very different patterns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Strong positive linear relationship</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Strong Positive Linear"</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Weak positive linear relationship</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2, y2, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Weak Positive Linear"</span>,</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Negative linear relationship</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x3, y3, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Negative Linear"</span>,</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Curvilinear (quadratic) relationship</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x4 <span class="sc">-</span> <span class="fl">0.3</span><span class="sc">*</span>x4<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x4, y4, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Curvilinear (Quadratic)"</span>,</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. No relationship</span></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">30</span>, <span class="dv">8</span>)</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x5, y5, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"No Relationship"</span>,</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Non-linear (exponential-like)</span></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>y6 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.35</span><span class="sc">*</span>x6) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x6, y6, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Non-linear (Exponential)"</span>,</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-relationship-types" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-relationship-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-relationship-types-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-relationship-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: Different types of relationships between variables
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Why focus on linear relationships?</strong></p>
<p>Linear relationships are our starting point for several reasons:</p>
<ul>
<li>Many real-world relationships are approximately linear (at least within a limited range)</li>
<li>Linear models are simple, interpretable, and mathematically tractable</li>
<li>They serve as a baseline – if a linear model doesn’t fit well, we know we need something more complex</li>
<li>Many non-linear relationships can be transformed to linear ones (e.g., logarithmic transformations)</li>
</ul>
<p><strong>Important:</strong> If your scatterplot shows a clear curvilinear or non-linear pattern, a straight line will be a poor fit. Always check your data first!</p>
</section>
<section id="a-simple-example-study-hours-and-exam-scores" class="level3">
<h3 class="anchored" data-anchor-id="a-simple-example-study-hours-and-exam-scores">A Simple Example: Study Hours and Exam Scores</h3>
<p>For the rest of this section, we’ll work with a dataset that shows an approximately linear relationship:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>exam_scores <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> study_hours <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Scatterplot: Study Hours vs. Exam Scores"</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter-example" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-scatter-example-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: Relationship between study hours and exam scores
</figcaption>
</figure>
</div>
</div>
</div>
<p>In this scatterplot, we can see a general <strong>positive linear relationship</strong>: students who study more tend to score higher. But the relationship isn’t perfect – there’s scatter around any imaginary line we might draw through the points.</p>
</section>
<section id="the-idea-of-a-best-fit-line" class="level3">
<h3 class="anchored" data-anchor-id="the-idea-of-a-best-fit-line">The Idea of a “Best Fit” Line</h3>
<p>Looking at the scatterplot, we might want to summarize the relationship with a straight line. But which line? There are infinitely many lines we could draw. We need a criterion for what makes a line “best.”</p>
<p>The <strong>regression line</strong> (or “best fit line”) is the line that minimizes the sum of squared errors (SSE). Let’s understand this step by step.</p>
<p>If we propose a line with equation <span class="math inline">\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_i</span>, then for each observation <span class="math inline">i</span>, we can calculate:</p>
<ul>
<li>The <strong>predicted value</strong>: <span class="math inline">\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_i</span></li>
<li>The <strong>residual</strong> (or error): <span class="math inline">e_i = Y_i - \hat{Y}_i</span></li>
</ul>
<p>The residual is the vertical distance between the actual point and our line. The <strong>Sum of Squared Errors</strong> is:</p>
<p><span class="math display">SSE = \sum_{i=1}^{n} e_i^2 = \sum_{i=1}^{n} (Y_i - \hat{Y}_i)^2</span></p>
<p>We square the errors for two reasons:</p>
<ol type="1">
<li>Positive and negative errors don’t cancel out</li>
<li>Larger errors are penalized more heavily (a 4-unit error counts as 16 in SSE, while two 2-unit errors count as 8)</li>
</ol>
</section>
<section id="visualizing-different-lines-and-their-sse" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-different-lines-and-their-sse">Visualizing Different Lines and Their SSE</h3>
<p>Let’s see how SSE changes for different lines:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try three different lines</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 1: Too flat</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>, <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Line 1: Too Flat (slope = 2)"</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">55</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="dv">55</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> study_hours</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>sse1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((exam_scores <span class="sc">-</span> pred1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2</span>, <span class="dv">90</span>, <span class="fu">paste</span>(<span class="st">"SSE ="</span>, <span class="fu">round</span>(sse1, <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 2: Too steep</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>, <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Line 2: Too Steep (slope = 6)"</span>)</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">45</span>, <span class="at">b =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="dv">45</span> <span class="sc">+</span> <span class="dv">6</span> <span class="sc">*</span> study_hours</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>sse2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((exam_scores <span class="sc">-</span> pred2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2</span>, <span class="dv">90</span>, <span class="fu">paste</span>(<span class="st">"SSE ="</span>, <span class="fu">round</span>(sse2, <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">"orange"</span>)</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Line 3: OLS line (best fit)</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>, <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Line 3: OLS Line (Best Fit)"</span>)</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>sse3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2</span>, <span class="dv">90</span>, <span class="fu">paste</span>(<span class="st">"SSE ="</span>, <span class="fu">round</span>(sse3, <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize residuals for OLS line</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>, <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"OLS Line with Residuals"</span>)</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(study_hours, exam_scores, study_hours, pred3, </span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sse-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sse-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-sse-comparison-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sse-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3: Comparing different lines and their SSE values
</figcaption>
</figure>
</div>
</div>
</div>
<p>Notice that the OLS line has the <strong>smallest SSE</strong> – that’s what makes it the “best” fit line.</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Regression Notation Conventions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Population model (unknown, true parameters):</strong></p>
<p><span class="math display">Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i</span></p>
<p>where <span class="math inline">\beta_0, \beta_1</span> are population parameters and <span class="math inline">\varepsilon_i</span> is the error term.</p>
<p><strong>Fitted regression line (sample estimates):</strong></p>
<p><span class="math display">\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_i</span></p>
<p>where <span class="math inline">\hat{\beta}_0, \hat{\beta}_1</span> are OLS estimates of the parameters.</p>
<p><strong>Alternative notation:</strong> Some texts use <span class="math inline">b_0, b_1</span> for estimates instead of <span class="math inline">\hat{\beta}_0, \hat{\beta}_1</span> to avoid hat notation.</p>
<p><strong>Residuals:</strong></p>
<p><span class="math display">e_i = Y_i - \hat{Y}_i = Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i</span></p>
<p><strong>Sum of Squared Errors (SSE):</strong></p>
<p><span class="math display">SSE = \sum_{i=1}^{n} e_i^2 = \sum_{i=1}^{n}(Y_i - \hat{Y}_i)^2 = \sum_{i=1}^{n}(Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i)^2</span></p>
<p><strong>Key distinction:</strong> Hats (<span class="math inline">\hat{~}</span>) denote sample estimates; no hats denote population parameters.</p>
</div>
</div>
<hr>
</section>
<section id="the-zero-model-predicting-with-the-mean" class="level3">
<h3 class="anchored" data-anchor-id="the-zero-model-predicting-with-the-mean">The Zero Model: Predicting with the Mean</h3>
<p>Before introducing predictors, let’s consider the simplest possible model: predicting the same value for everyone. What value should we predict?</p>
<p>The <strong>zero model</strong> (or <strong>intercept-only model</strong>) predicts the mean for all observations:</p>
<p><span class="math display">\hat{Y}_i = \bar{Y}</span></p>
<p>This might seem useless, but it serves as a <strong>baseline</strong> for comparison. Any predictor we add should perform better than just guessing the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>, <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Zero Model: Predict Mean for Everyone"</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>mean_score <span class="ot">&lt;-</span> <span class="fu">mean</span>(exam_scores)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> mean_score, <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">5</span>, mean_score <span class="sc">+</span> <span class="dv">5</span>, <span class="fu">paste</span>(<span class="st">"Mean ="</span>, <span class="fu">round</span>(mean_score, <span class="dv">1</span>)), </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"purple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-zero-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zero-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-zero-model-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zero-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.4: Zero model: predicting the mean for everyone
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="variance-decomposition-how-good-is-our-model" class="level3">
<h3 class="anchored" data-anchor-id="variance-decomposition-how-good-is-our-model">Variance Decomposition: How Good is Our Model?</h3>
<p>Now comes the crucial question: does including <span class="math inline">X</span> (study hours) improve our predictions compared to the zero model?</p>
<p>We can decompose the <strong>total variance</strong> in <span class="math inline">Y</span> into two parts:</p>
<ol type="1">
<li><strong>Explained variance</strong>: variation captured by our model</li>
<li><strong>Unexplained variance</strong>: residual variation (what our model misses)</li>
</ol>
<p>Mathematically, for each observation:</p>
<p><span class="math display">\underbrace{Y_i - \bar{Y}}_{\text{Total deviation}} = \underbrace{\hat{Y}_i - \bar{Y}}_{\text{Explained deviation}} + \underbrace{Y_i - \hat{Y}_i}_{\text{Residual}}</span></p>
<p>Squaring and summing across all observations:</p>
<p><span class="math display">\underbrace{\sum (Y_i - \bar{Y})^2}_{\text{Total Sum of Squares (SST)}} = \underbrace{\sum (\hat{Y}_i - \bar{Y})^2}_{\text{Regression Sum of Squares (SSR)}} + \underbrace{\sum (Y_i - \hat{Y}_i)^2}_{\text{Sum of Squared Errors (SSE)}}</span></p>
<p>Or more compactly:</p>
<p><span class="math display">SST = SSR + SSE</span></p>
<hr>
<p><strong>Manual calculation example:</strong></p>
<p>Suppose we have five students:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Study Hours (<span class="math inline">X</span>)</th>
<th>Exam Score (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>60</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>73</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>71</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>86</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>90</td>
</tr>
</tbody>
</table>
<p><strong>Step 1:</strong> Calculate the mean: <span class="math inline">\bar{Y} = \frac{60 + 73 + 71 + 86 + 90}{5} = 76</span></p>
<p><strong>Step 2:</strong> Calculate <span class="math inline">\bar{X} = \frac{2 + 4 + 6 + 8 + 10}{5} = 6</span></p>
<p><strong>Step 3:</strong> Fit OLS line (we’ll show the formula below):</p>
<p>First, calculate the slope:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 31%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>60</td>
<td>-4</td>
<td>-16</td>
<td>64</td>
<td>16</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>73</td>
<td>-2</td>
<td>-3</td>
<td>6</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>71</td>
<td>0</td>
<td>-5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>86</td>
<td>2</td>
<td>10</td>
<td>20</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>90</td>
<td>4</td>
<td>14</td>
<td>56</td>
<td>16</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>Sum = 146</strong></td>
<td><strong>Sum = 40</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\hat{\beta}_1 = \frac{146}{40} = 3.65</span></p>
<p><span class="math display">\hat{\beta}_0 = 76 - 3.65 \times 6 = 76 - 21.9 = 54.1</span></p>
<p>So our regression line is: <span class="math inline">\hat{Y}_i = 54.1 + 3.65X_i</span></p>
<p><strong>Step 4:</strong> Calculate predictions and variance components:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\bar{Y}</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">\hat{Y}_i - \bar{Y}</span></th>
<th><span class="math inline">Y_i - \hat{Y}_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>60</td>
<td>76</td>
<td>61.4</td>
<td>-16</td>
<td>-14.6</td>
<td>-1.4</td>
</tr>
<tr class="even">
<td>2</td>
<td>73</td>
<td>76</td>
<td>68.7</td>
<td>-3</td>
<td>-7.3</td>
<td>4.3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>71</td>
<td>76</td>
<td>76.0</td>
<td>-5</td>
<td>0.0</td>
<td>-5.0</td>
</tr>
<tr class="even">
<td>4</td>
<td>86</td>
<td>76</td>
<td>83.3</td>
<td>10</td>
<td>7.3</td>
<td>2.7</td>
</tr>
<tr class="odd">
<td>5</td>
<td>90</td>
<td>76</td>
<td>90.6</td>
<td>14</td>
<td>14.6</td>
<td>-0.6</td>
</tr>
</tbody>
</table>
<p><strong>Step 5:</strong> Sum of squares:</p>
<ul>
<li><span class="math inline">SST = (-16)^2 + (-3)^2 + (-5)^2 + 10^2 + 14^2 = 256 + 9 + 25 + 100 + 196 = 586</span></li>
<li><span class="math inline">SSR = (-14.6)^2 + (-7.3)^2 + 0^2 + 7.3^2 + 14.6^2 = 213.16 + 53.29 + 0 + 53.29 + 213.16 = 532.9</span></li>
<li><span class="math inline">SSE = (-1.4)^2 + 4.3^2 + (-5.0)^2 + 2.7^2 + (-0.6)^2 = 1.96 + 18.49 + 25 + 7.29 + 0.36 = 53.1</span></li>
</ul>
<p>Check: <span class="math inline">532.9 + 53.1 = 586</span> ✓</p>
</section>
<section id="finding-the-ols-coefficients-minimizing-sse" class="level3">
<h3 class="anchored" data-anchor-id="finding-the-ols-coefficients-minimizing-sse">Finding the OLS Coefficients: Minimizing SSE</h3>
<p>The <strong>Ordinary Least Squares (OLS)</strong> method finds the coefficients <span class="math inline">\hat{\beta}_0</span> (intercept) and <span class="math inline">\hat{\beta}_1</span> (slope) that minimize SSE.</p>
<p>For a simple linear regression <span class="math inline">Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i</span>, the OLS estimators are:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum_{i=1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{\sum_{i=1}^{n} (X_i - \bar{X})^2} = \frac{Cov(X, Y)}{Var(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X}</span></p>
<p>We already showed this calculation in the previous section. The key insight is that:</p>
<ul>
<li><span class="math inline">\hat{\beta}_1</span> measures the <strong>average change in <span class="math inline">Y</span> per unit change in <span class="math inline">X</span></strong></li>
<li><span class="math inline">\hat{\beta}_0</span> is the <strong>predicted value of <span class="math inline">Y</span> when <span class="math inline">X = 0</span></strong></li>
</ul>
<p><strong>Interpretation of our example:</strong> <span class="math inline">\hat{Y}_i = 54.1 + 3.65X_i</span></p>
<p>Each additional hour of study is associated with a 3.65-point increase in exam score. A student who doesn’t study at all (<span class="math inline">X = 0</span>) would be predicted to score 54.1 points (though this extrapolation may not be meaningful).</p>
</section>
<section id="evaluating-model-quality-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="evaluating-model-quality-r-squared">Evaluating Model Quality: R-squared</h3>
<p>The <strong>R-squared</strong> (<span class="math inline">R^2</span>) tells us what proportion of variance in <span class="math inline">Y</span> is explained by our model:</p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>From our example: <span class="math inline">R^2 = \frac{532.9}{586} = 0.909</span> or <span class="math inline">1 - \frac{53.1}{586} = 0.909</span></p>
<p><strong>Interpretation:</strong> 90.9% of the variance in exam scores is explained by study hours. Our model does a good job, though there’s still about 9% of variance that remains unexplained – likely due to other factors like natural ability, test anxiety, quality of study, or prior knowledge.</p>
<p>Properties of <span class="math inline">R^2</span>:</p>
<ul>
<li>Ranges from 0 to 1</li>
<li><span class="math inline">R^2 = 0</span>: model no better than predicting the mean</li>
<li><span class="math inline">R^2 = 1</span>: perfect predictions (all points on the line)</li>
<li>Higher <span class="math inline">R^2</span> means better fit, but doesn’t guarantee causality or good predictions out of sample</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># High R-squared</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"High R² ="</span>, </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span> x1))<span class="sc">$</span>r.squared, <span class="dv">2</span>)))</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span> x1), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Medium R-squared</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y2, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Medium R² ="</span>, </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y2 <span class="sc">~</span> x1))<span class="sc">$</span>r.squared, <span class="dv">2</span>)))</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y2 <span class="sc">~</span> x1), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Low R-squared</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">30</span>)</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y3, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Low R² ="</span>, </span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y3 <span class="sc">~</span> x1))<span class="sc">$</span>r.squared, <span class="dv">2</span>)))</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y3 <span class="sc">~</span> x1), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-rsquared-examples" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rsquared-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-rsquared-examples-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rsquared-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.5: Different R-squared values
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="evaluating-model-quality-rmse" class="level3">
<h3 class="anchored" data-anchor-id="evaluating-model-quality-rmse">Evaluating Model Quality: RMSE</h3>
<p>While <span class="math inline">R^2</span> is scale-free, <strong>Root Mean Squared Error (RMSE)</strong> gives us the average prediction error in the original units:</p>
<p><span class="math display">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(Y_i - \hat{Y}_i)^2}{n}}</span></p>
<p>From our example: <span class="math inline">RMSE = \sqrt{\frac{53.1}{5}} = \sqrt{10.62} = 3.26</span> points</p>
<p><strong>Interpretation:</strong> On average, our predictions are off by about 3.3 points.</p>
<p>RMSE is useful for:</p>
<ul>
<li>Comparing models on the same outcome variable</li>
<li>Understanding prediction accuracy in meaningful units</li>
<li>Penalizing large errors (like SSE)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate RMSE</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE: 7.37 points</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.743 </code></pre>
</div>
</div>
</section>
<section id="model-interpretation-effect-size-and-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-interpretation-effect-size-and-diagnostics">Model Interpretation, Effect Size, and Diagnostics</h3>
<p>Once we’ve fit a regression model, we need to go beyond <span class="math inline">R^2</span> and RMSE to understand what our model tells us. This involves three key tasks: interpreting coefficients substantively, assessing effect sizes, and checking for potential problems through diagnostics.</p>
<section id="interpreting-regression-coefficients" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-regression-coefficients">Interpreting Regression Coefficients</h4>
<p>The slope coefficient <span class="math inline">\hat{\beta}_1</span> has a specific interpretation:</p>
<blockquote class="blockquote">
<p>A one-unit increase in <span class="math inline">X</span> is associated with a <span class="math inline">\hat{\beta}_1</span>-unit change in <span class="math inline">Y</span>, on average.</p>
</blockquote>
<p>For our example (<span class="math inline">\hat{Y}_i = 54.1 + 3.65X_i</span>):</p>
<ul>
<li><strong>Slope interpretation</strong>: Each additional hour of study is associated with a 3.65-point increase in exam score, on average.</li>
<li><strong>Intercept interpretation</strong>: A student with zero study hours would be predicted to score 54.1 points (though this may involve extrapolation beyond the data range).</li>
</ul>
<p><strong>Important considerations:</strong></p>
<ul>
<li>The coefficient describes <strong>association</strong>, not necessarily <strong>causation</strong></li>
<li>The relationship is <strong>linear</strong> – we assume the effect is constant across the range of <span class="math inline">X</span></li>
<li>The effect is an <strong>average</strong> – individual students may vary</li>
</ul>
<p><strong>Practical interpretation example:</strong></p>
<p>If you study 3 hours vs.&nbsp;6 hours (a 3-hour difference), the predicted score difference is:</p>
<p><span class="math display">3 \times 3.65 = 10.95 \text{ points}</span></p>
<p>This gives us a practical sense of the relationship’s magnitude.</p>
</section>
<section id="effect-size-standardized-coefficients" class="level4">
<h4 class="anchored" data-anchor-id="effect-size-standardized-coefficients">Effect Size: Standardized Coefficients</h4>
<p>When comparing effects across different variables or studies, raw coefficients can be misleading because they depend on the units of measurement. Is a 3.65-point increase per hour “large” or “small”?</p>
<p><strong>Standardized coefficients</strong> (beta coefficients) express the effect in standard deviation units:</p>
<p><span class="math display">\hat{\beta}_1^{*} = \hat{\beta}_1 \times \frac{SD_X}{SD_Y}</span></p>
<p>This tells us: a one-standard-deviation increase in <span class="math inline">X</span> is associated with a <span class="math inline">\hat{\beta}_1^{*}</span>-standard-deviation change in <span class="math inline">Y</span>.</p>
<p><strong>Manual calculation for our example:</strong></p>
<p>First, calculate standard deviations:</p>
<ul>
<li><span class="math inline">SD_X = \sqrt{\frac{\sum(X_i - \bar{X})^2}{n-1}} = \sqrt{\frac{40}{4}} = \sqrt{10} = 3.16</span> hours</li>
<li><span class="math inline">SD_Y = \sqrt{\frac{\sum(Y_i - \bar{Y})^2}{n-1}} = \sqrt{\frac{586}{4}} = \sqrt{146.5} = 12.10</span> points</li>
</ul>
<p>Then:</p>
<p><span class="math display">\hat{\beta}_1^{*} = 3.65 \times \frac{3.16}{12.10} = 3.65 \times 0.261 = 0.953</span></p>
<p><strong>Interpretation:</strong> A one-standard-deviation increase in study hours (about 3.2 hours) is associated with a 0.953-standard-deviation increase in exam scores (about 11.5 points).</p>
<p><strong>Rule of thumb for effect sizes:</strong></p>
<ul>
<li>Small effect: <span class="math inline">|\hat{\beta}_1^{*}| \approx 0.1</span></li>
<li>Medium effect: <span class="math inline">|\hat{\beta}_1^{*}| \approx 0.3</span></li>
<li>Large effect: <span class="math inline">|\hat{\beta}_1^{*}| \approx 0.5</span> or higher</li>
</ul>
<p>Our effect (0.953) is very large, suggesting study hours have a substantial relationship with exam scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate standardized coefficient</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>beta_raw <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)[<span class="dv">2</span>]</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>beta_std <span class="ot">&lt;-</span> beta_raw <span class="sc">*</span> (<span class="fu">sd</span>(study_hours) <span class="sc">/</span> <span class="fu">sd</span>(exam_scores))</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Raw coefficient:"</span>, <span class="fu">round</span>(beta_raw, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw coefficient: 4.305 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standardized coefficient:"</span>, <span class="fu">round</span>(beta_std, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standardized coefficient: 0.862 </code></pre>
</div>
</div>
</section>
<section id="diagnostic-plots-residual-analysis" class="level4">
<h4 class="anchored" data-anchor-id="diagnostic-plots-residual-analysis">Diagnostic Plots: Residual Analysis</h4>
<p>After fitting a model, we should check whether our assumptions hold. The most useful diagnostic tool is the <strong>residual plot</strong>: plotting residuals (<span class="math inline">e_i = Y_i - \hat{Y}_i</span>) against predicted values (<span class="math inline">\hat{Y}_i</span>).</p>
<p><strong>What to look for:</strong></p>
<ol type="1">
<li><strong>Random scatter</strong>: Residuals should be randomly scattered around zero</li>
<li><strong>Constant spread</strong>: The vertical spread should be roughly constant (homoscedasticity)</li>
<li><strong>No patterns</strong>: Curved patterns suggest non-linearity</li>
<li><strong>No outliers</strong>: Extremely large residuals may indicate problems</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Residuals vs. Fitted</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(model), <span class="fu">residuals</span>(model),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs. Fitted"</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Histogram of residuals</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(model), </span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram of Residuals"</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Q-Q plot (checking normality)</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(model), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(model), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Residuals vs. Predictor</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, <span class="fu">residuals</span>(model),</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>,</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs. Study Hours"</span>,</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-residual-diagnostics" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residual-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-residual-diagnostics-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residual-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.6: Residual diagnostic plots
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpreting the residual plot:</strong></p>
<ul>
<li><strong>Good</strong>: Points scattered randomly around zero with no pattern</li>
<li><strong>Bad - Funnel shape</strong>: Variance increases with fitted values (heteroscedasticity)</li>
<li><strong>Bad - Curved pattern</strong>: Non-linear relationship not captured by the model</li>
<li><strong>Bad - Clustering</strong>: Possible subgroups or missing variables</li>
</ul>
</section>
<section id="identifying-outliers-and-influential-points" class="level4">
<h4 class="anchored" data-anchor-id="identifying-outliers-and-influential-points">Identifying Outliers and Influential Points</h4>
<p>Not all data points are equally important. Some observations can have a disproportionate influence on the regression line.</p>
<p><strong>Types of unusual observations:</strong></p>
<ol type="1">
<li><strong>Outliers</strong>: Observations with large residuals (far from the regression line)</li>
<li><strong>High leverage points</strong>: Observations with extreme <span class="math inline">X</span> values</li>
<li><strong>Influential points</strong>: Observations that, if removed, would substantially change the regression line</li>
</ol>
<p><strong>Detecting outliers manually:</strong></p>
<p>For our five-student example, let’s examine the residuals:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i</span></th>
<th><span class="math inline">|e_i|</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>60</td>
<td>61.4</td>
<td>-1.4</td>
<td>1.4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>73</td>
<td>68.7</td>
<td>4.3</td>
<td>4.3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>71</td>
<td>76.0</td>
<td>-5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>86</td>
<td>83.3</td>
<td>2.7</td>
<td>2.7</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>90</td>
<td>90.6</td>
<td>-0.6</td>
<td>0.6</td>
</tr>
</tbody>
</table>
<p>Student 3 has the largest residual (5.0 points below predicted). Is this an outlier?</p>
<p><strong>Rule of thumb</strong>: A residual is concerning if <span class="math inline">|e_i| &gt; 2 \times RMSE</span></p>
<p>In our case: <span class="math inline">2 \times 3.26 = 6.52</span> points. Student 3’s residual (5.0) is below this threshold, so it’s not a severe outlier.</p>
<p><strong>Visualizing potential outliers:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Highlight potential outliers</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>,</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Identifying Outliers"</span>,</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify points with large residuals</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>large_resid <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">residuals</span>(model)) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(<span class="fu">residuals</span>(model))</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">any</span>(large_resid)) {</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(study_hours[large_resid], exam_scores[large_resid],</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(study_hours[large_resid], exam_scores[large_resid],</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">which</span>(large_resid), <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"orange"</span>)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Leverage plot</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hatvalues</span>(model),</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation Number"</span>,</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Leverage"</span>,</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Leverage of Each Point"</span>,</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">coef</span>(model)) <span class="sc">/</span> <span class="fu">length</span>(exam_scores), </span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-outlier-detection" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-outlier-detection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-outlier-detection-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outlier-detection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.7: Identifying outliers and influential points
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>What to do about outliers:</strong></p>
<ol type="1">
<li><strong>Investigate</strong>: Check if it’s a data entry error</li>
<li><strong>Understand</strong>: What makes this observation unusual?</li>
<li><strong>Report</strong>: Note the outlier and consider analyzing with and without it</li>
<li><strong>Don’t automatically delete</strong>: Outliers may contain important information</li>
</ol>
<p>For example, Student 3 might have test anxiety despite adequate preparation, or might learn differently. This is substantively meaningful information, not just “noise.”</p>
</section>
<section id="summary-of-diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="summary-of-diagnostics">Summary of Diagnostics</h4>
<p><strong>Good model indicators:</strong></p>
<ul>
<li>Residuals randomly scattered around zero</li>
<li>Constant variance across the range of predictions</li>
<li><span class="math inline">R^2</span> is reasonably high (context-dependent)</li>
<li>RMSE is small relative to the scale of <span class="math inline">Y</span></li>
<li>Few or no extreme outliers</li>
<li>Standardized coefficients suggest meaningful effect sizes</li>
</ul>
<p><strong>Warning signs:</strong></p>
<ul>
<li>Systematic patterns in residual plots</li>
<li>Funnel-shaped residuals (heteroscedasticity)</li>
<li>Multiple influential outliers</li>
<li>Very low <span class="math inline">R^2</span> (model explains little variance)</li>
<li>Coefficients that don’t make substantive sense</li>
</ul>
<p>Always remember: statistical diagnostics should be combined with <strong>substantive knowledge</strong> about your research question. A statistically “good” model that doesn’t make theoretical sense is still problematic.</p>
</section>
</section>
<section id="correlation-vs.-causation-and-spurious-relationships" class="level3">
<h3 class="anchored" data-anchor-id="correlation-vs.-causation-and-spurious-relationships">Correlation vs.&nbsp;Causation and Spurious Relationships</h3>
<p>One of the most important lessons in statistics is that <strong>correlation does not imply causation</strong>. Just because two variables are related does not mean one causes the other. This section explores why this distinction matters and how spurious correlations can mislead us.</p>
<section id="the-fundamental-problem" class="level4">
<h4 class="anchored" data-anchor-id="the-fundamental-problem">The Fundamental Problem</h4>
<p>When we find that <span class="math inline">X</span> and <span class="math inline">Y</span> are correlated (they move together), there are several possible explanations:</p>
<ol type="1">
<li><strong><span class="math inline">X</span> causes <span class="math inline">Y</span></strong>: Changes in <span class="math inline">X</span> directly produce changes in <span class="math inline">Y</span></li>
<li><strong><span class="math inline">Y</span> causes <span class="math inline">X</span></strong>: The causal arrow goes the other direction</li>
<li><strong>Confounding</strong>: A third variable <span class="math inline">Z</span> causes both <span class="math inline">X</span> and <span class="math inline">Y</span></li>
<li><strong>Coincidence</strong>: The relationship is spurious – just random chance</li>
</ol>
<p>Regression analysis can tell us that <span class="math inline">X</span> and <span class="math inline">Y</span> are <strong>associated</strong>, but it cannot tell us <strong>why</strong> they’re associated. To claim causation, we need additional evidence beyond correlation.</p>
</section>
<section id="classic-examples-of-correlation-without-causation" class="level4">
<h4 class="anchored" data-anchor-id="classic-examples-of-correlation-without-causation">Classic Examples of Correlation Without Causation</h4>
<p><strong>Example 1: Ice cream sales and drowning deaths</strong></p>
<p>Observation: Countries with higher ice cream sales also have more drowning deaths. Should we ban ice cream to prevent drownings?</p>
<p>No! The confounding variable is <strong>temperature</strong>. Hot weather causes both:</p>
<ul>
<li>More ice cream sales (people cool off with ice cream)</li>
<li>More drowning deaths (people swim more often)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">25</span>, <span class="dv">5</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>ice_cream <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>drownings <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Ice cream vs. drownings (spurious correlation)</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ice_cream, drownings,</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Drowning Deaths"</span>,</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Spurious Correlation"</span>,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">60</span>, <span class="dv">35</span>, <span class="fu">paste</span>(<span class="st">"R² ="</span>, <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream))<span class="sc">$</span>r.squared, <span class="dv">2</span>)),</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Both related to temperature (confounding)</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(temperature, ice_cream,</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Temperature (°C)"</span>,</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Ice Cream Sales / Drownings"</span>,</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Both Related to Temperature"</span>,</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>))</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(temperature, drownings <span class="sc">*</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(ice_cream <span class="sc">~</span> temperature), <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">I</span>(drownings <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">~</span> temperature), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Ice Cream"</span>, <span class="st">"Drownings (scaled)"</span>),</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"darkgreen"</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">17</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-spurious-correlation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spurious-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-spurious-correlation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spurious-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.8: Example of spurious correlation through confounding
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Example 2: Shoe size and reading ability in children</strong></p>
<p>Observation: Children with larger shoe sizes read better. Does foot size enhance cognition?</p>
<p>No! The confounding variable is <strong>age</strong>. Older children have both:</p>
<ul>
<li>Larger shoe sizes (they’ve grown)</li>
<li>Better reading skills (they’ve had more education)</li>
</ul>
<p><strong>Example 3: Number of firefighters and fire damage</strong></p>
<p>Observation: Fires with more firefighters present tend to have more property damage. Should we send fewer firefighters to reduce damage?</p>
<p>Absolutely not! This is <strong>reverse causation</strong> combined with confounding:</p>
<ul>
<li>Bigger fires cause more damage (directly)</li>
<li>Bigger fires also require more firefighters (response to severity)</li>
</ul>
<p>The number of firefighters doesn’t cause damage; fire severity causes both.</p>
</section>
<section id="what-makes-a-relationship-causal" class="level4">
<h4 class="anchored" data-anchor-id="what-makes-a-relationship-causal">What Makes a Relationship Causal?</h4>
<p>To establish causation, we typically need:</p>
<ol type="1">
<li><strong>Temporal precedence</strong>: The cause must precede the effect</li>
<li><strong>Association</strong>: The variables must be correlated</li>
<li><strong>No plausible confounders</strong>: We’ve ruled out alternative explanations</li>
<li><strong>Mechanism</strong>: We understand <em>how</em> <span class="math inline">X</span> affects <span class="math inline">Y</span></li>
<li><strong>Dose-response</strong>: Larger values of <span class="math inline">X</span> produce larger effects on <span class="math inline">Y</span></li>
</ol>
<p>The <strong>gold standard</strong> for establishing causation is a <strong>randomized controlled experiment</strong>, where we randomly assign people to receive different values of <span class="math inline">X</span>. This breaks the relationship between <span class="math inline">X</span> and potential confounders.</p>
<p>However, in social science, we often can’t run experiments (it would be unethical or impractical). Instead, we use:</p>
<ul>
<li>Longitudinal designs (measuring variables over time)</li>
<li>Natural experiments (finding naturally occurring random variation)</li>
<li>Careful control for confounders (including them in multiple regression)</li>
<li>Theoretical reasoning and prior evidence</li>
</ul>
</section>
<section id="spurious-correlations" class="level4">
<h4 class="anchored" data-anchor-id="spurious-correlations">Spurious Correlations</h4>
<p>A <strong>spurious correlation</strong> is a statistical relationship between two variables that is not due to any causal connection between them. These often arise from:</p>
<ol type="1">
<li><strong>Common cause (confounding)</strong>: <span class="math inline">Z</span> causes both <span class="math inline">X</span> and <span class="math inline">Y</span></li>
<li><strong>Coincidence</strong>: Random chance produces apparent patterns</li>
<li><strong>Selection bias</strong>: The way we sample creates artificial relationships</li>
</ol>
<p><strong>Famous spurious correlations:</strong></p>
<ul>
<li>Per capita cheese consumption correlates with deaths by bedsheet tangling (<span class="math inline">r = 0.95</span>)</li>
<li>Number of Nicolas Cage movies correlates with swimming pool drownings (<span class="math inline">r = 0.67</span>)</li>
<li>Per capita margarine consumption correlates with divorce rate in Maine (<span class="math inline">r = 0.99</span>)</li>
</ul>
<p>These are clearly not causal – they’re coincidences in time-series data. The lesson: <strong>high correlation, even very high, does not prove causation</strong>.</p>
</section>
<section id="implications-for-regression-analysis" class="level4">
<h4 class="anchored" data-anchor-id="implications-for-regression-analysis">Implications for Regression Analysis</h4>
<p>When we interpret our regression results, we must be cautious:</p>
<p><strong>What regression tells us:</strong></p>
<ul>
<li><span class="math inline">X</span> and <span class="math inline">Y</span> are associated</li>
<li>The strength of the association (<span class="math inline">\hat{\beta}_1</span>)</li>
<li>How much variance is explained (<span class="math inline">R^2</span>)</li>
<li>Whether the relationship is linear</li>
</ul>
<p><strong>What regression does NOT tell us:</strong></p>
<ul>
<li>Whether <span class="math inline">X</span> causes <span class="math inline">Y</span></li>
<li>Whether we’ve omitted important confounders</li>
<li>The direction of causation</li>
<li>Whether the relationship is spurious</li>
</ul>
<p><strong>Our study hours example:</strong></p>
<p>We found that study hours strongly predict exam scores (<span class="math inline">R^2 = 0.909</span>). Does studying <strong>cause</strong> higher scores?</p>
<p>Probably yes, but we should consider alternative explanations:</p>
<ul>
<li><strong>Reverse causation</strong>: Maybe students who are naturally good at the subject (high ability) enjoy studying more, so they study longer. Here, ability causes both study hours and exam scores.</li>
<li><strong>Confounding</strong>: Maybe students with supportive parents both study more and perform better (parents help with homework and create good study environments).</li>
<li><strong>Selection</strong>: Maybe only motivated students were in our sample, and motivation causes both studying and performance.</li>
</ul>
<p>To strengthen a causal claim, we could:</p>
<ul>
<li>Control for prior ability (include previous exam scores)</li>
<li>Control for parental involvement</li>
<li>Use an experimental design (randomly assign study hours)</li>
<li>Check if the relationship holds across different contexts</li>
</ul>
</section>
<section id="practical-advice" class="level4">
<h4 class="anchored" data-anchor-id="practical-advice">Practical Advice</h4>
<p>When reporting regression results:</p>
<ul>
<li>Use careful language: “associated with” rather than “causes” or “leads to”</li>
<li>Acknowledge potential confounders</li>
<li>Discuss alternative explanations</li>
<li>Be explicit about the study design’s limitations</li>
<li>If claiming causation, provide theoretical reasoning and additional evidence</li>
</ul>
<p>Remember: <strong>correlation is a necessary but not sufficient condition for causation</strong>. Finding an association is just the first step in understanding whether one variable influences another.</p>
</section>
</section>
<section id="key-assumptions-of-ols" class="level3">
<h3 class="anchored" data-anchor-id="key-assumptions-of-ols">Key Assumptions of OLS</h3>
<p>For OLS to provide meaningful estimates, we need several assumptions:</p>
<ol type="1">
<li><p><strong>Linearity</strong>: The relationship between <span class="math inline">X</span> and <span class="math inline">Y</span> is linear: <span class="math inline">Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i</span></p></li>
<li><p><strong>Strict Exogeneity</strong>: The error term has zero expected value conditional on <span class="math inline">X</span>: <span class="math inline">E[\varepsilon_i | X_i] = 0</span></p>
<p>This means <span class="math inline">X</span> is uncorrelated with the error – there are no omitted variables that affect both <span class="math inline">X</span> and <span class="math inline">Y</span>.</p></li>
<li><p><strong>Homoscedasticity</strong> (not strict, but desirable): The variance of errors is constant: <span class="math inline">Var(\varepsilon_i | X_i) = \sigma^2</span></p></li>
<li><p><strong>No perfect collinearity</strong> (important for multiple regression): Predictor variables are not perfectly correlated.</p></li>
</ol>
<p><strong>Important note:</strong> We are <strong>not</strong> making probabilistic assumptions about the sampling distribution here. We’re simply describing the relationship in our data. For inference (hypothesis tests, confidence intervals), we would need additional assumptions, but that’s beyond our scope for now.</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
For What Data Can We Apply OLS Regression?
</div>
</div>
<div class="callout-body-container callout-body">
<p>OLS regression has specific requirements regarding variable types:</p>
<p><strong>Dependent variable (outcome, <span class="math inline">Y</span>):</strong></p>
<ul>
<li><strong>Must be continuous</strong> or <strong>quasi-continuous</strong> (e.g., discrete with many values)</li>
<li>Level of measurement (Stevens’ typology):
<ul>
<li><strong>Interval</strong>: differences between values are meaningful, but no natural zero (e.g., temperature in °C, IQ test scores)</li>
<li><strong>Ratio</strong>: like interval, but with a natural zero (e.g., income, age, hours)</li>
</ul></li>
<li><strong>Not suitable</strong>: Nominal variables – categories without order (e.g., eye color, gender) or ordinal variables with few categories (e.g., Likert scale 1-5)</li>
</ul>
<p><strong>Independent variables (predictors, <span class="math inline">X</span>):</strong></p>
<ul>
<li><strong>Can be</strong> continuous, discrete, or binary (0/1)</li>
<li>Level of measurement:
<ul>
<li><strong>Ratio/Interval</strong>: ideal (e.g., age, income, temperature)</li>
<li><strong>Ordinal</strong>: acceptable if treated as quasi-continuous (e.g., education level: 1=primary, 2=secondary, 3=tertiary)</li>
<li><strong>Nominal binary</strong>: acceptable (e.g., gender: 0=female, 1=male)</li>
<li><strong>Nominal multi-category</strong>: requires transformation into dummy variables – e.g., region: 3 binary variables for 4 regions</li>
</ul></li>
</ul>
<p><strong>Examples of correct applications:</strong></p>
<ul>
<li><span class="math inline">Y</span>: Exam score (0-100 points, interval) ~ <span class="math inline">X</span>: Study hours (continuous, ratio) ✓</li>
<li><span class="math inline">Y</span>: Income (continuous, ratio) ~ <span class="math inline">X_1</span>: Age (continuous, ratio) + <span class="math inline">X_2</span>: Gender (binary, nominal) ✓</li>
<li><span class="math inline">Y</span>: Voter turnout (%, ratio) ~ <span class="math inline">X</span>: GDP per capita (continuous, ratio) ✓</li>
</ul>
<p><strong>Incorrect applications:</strong></p>
<ul>
<li><span class="math inline">Y</span>: Eye color (nominal) ~ <span class="math inline">X</span>: Age – use multinomial regression ✗</li>
<li><span class="math inline">Y</span>: Party choice (nominal, 5 options) ~ <span class="math inline">X</span>: Income – use multinomial regression ✗</li>
<li><span class="math inline">Y</span>: Agreement (Yes/No, binary) ~ <span class="math inline">X</span>: Age – use logistic regression ✗</li>
</ul>
<p><strong>Rule of thumb</strong>: If <span class="math inline">Y</span> has fewer than ~7 unique values, consider other methods (logistic, ordinal, or Poisson regression).</p>
</div>
</div>
<hr>
</section>
<section id="extension-to-multiple-regression" class="level3">
<h3 class="anchored" data-anchor-id="extension-to-multiple-regression">Extension to Multiple Regression</h3>
<p>So far, we’ve looked at <strong>simple linear regression</strong> with one predictor. In reality, social phenomena are complex and require multiple predictors.</p>
<p>The <strong>multiple regression model</strong> extends our framework:</p>
<p><span class="math display">Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \cdots + \beta_k X_{ki} + \varepsilon_i</span></p>
<p>For example, predicting voter turnout:</p>
<p><span class="math display">\text{Turnout}_i = \beta_0 + \beta_1 \text{GDP}_i + \beta_2 \text{Compulsory}_i + \beta_3 \text{Age}_i + \varepsilon_i</span></p>
<p>The OLS principle remains the same: find coefficients that minimize <span class="math inline">SSE = \sum (Y_i - \hat{Y}_i)^2</span>.</p>
<p>The interpretation changes slightly:</p>
<ul>
<li><span class="math inline">\hat{\beta}_1</span> is the effect of <span class="math inline">X_1</span> on <span class="math inline">Y</span>, <strong>holding all other variables constant</strong></li>
<li>This is often called the “partial effect” or “controlling for” other variables</li>
</ul>
<p><strong>Matrix notation</strong> (for reference):</p>
<p><span class="math display">\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}</span></p>
<p>But you don’t need to memorize this – software (like R’s <code>lm()</code> function) handles the calculations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple regression example</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (using built-in mtcars dataset)</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt <span class="sc">+</span> cyl, <span class="at">data =</span> mtcars)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt + cyl, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.9290 -1.5598 -0.5311  1.1850  5.8986 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept) 38.75179    1.78686  21.687 &lt; 0.0000000000000002 ***
hp          -0.01804    0.01188  -1.519             0.140015    
wt          -3.16697    0.74058  -4.276             0.000199 ***
cyl         -0.94162    0.55092  -1.709             0.098480 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.512 on 28 degrees of freedom
Multiple R-squared:  0.8431,    Adjusted R-squared:  0.8263 
F-statistic: 50.17 on 3 and 28 DF,  p-value: 0.00000000002184</code></pre>
</div>
</div>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p>We’ve covered the fundamentals of regression analysis:</p>
<ul>
<li>Deterministic models assume perfect relationships; stochastic models acknowledge uncertainty</li>
<li>Statistical models include both systematic patterns and random variation</li>
<li>Different relationships exist in data – linear models work best for linear relationships</li>
<li>The OLS method finds the line that minimizes the sum of squared errors</li>
<li>We can decompose variance: <span class="math inline">SST = SSR + SSE</span></li>
<li><span class="math inline">R^2 = SSR/SST</span> measures the proportion of variance explained (0 to 1)</li>
<li>RMSE measures average prediction error in original units</li>
<li>Coefficients should be interpreted substantively, considering effect sizes</li>
<li>Standardized coefficients allow comparison across different scales</li>
<li>Residual plots and outlier detection help diagnose model problems</li>
<li><strong>Correlation does not imply causation</strong> – confounding and spurious relationships are common</li>
<li>To establish causation, we need temporal precedence, no confounders, and theoretical mechanisms</li>
<li>OLS requires assumptions like linearity and strict exogeneity</li>
<li>Multiple regression extends this framework to many predictors</li>
</ul>
<p>In practice, <strong>always visualize your data first</strong>, check whether a linear model is appropriate, examine residual plots for problems, think carefully about causal interpretation, and remember that association is not causation – even a high <span class="math inline">R^2</span> doesn’t prove that <span class="math inline">X</span> causes <span class="math inline">Y</span>.</p>
<hr>
</section>
</section>
<section id="complete-manual-ols-calculation-a-step-by-step-example" class="level2" data-number="9.9">
<h2 data-number="9.9" class="anchored" data-anchor-id="complete-manual-ols-calculation-a-step-by-step-example"><span class="header-section-number">9.9</span> Complete Manual OLS Calculation: A Step-by-Step Example</h2>
<p>A professor wants to understand the relationship between hours spent studying and exam scores. She collects data from 6 students:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Study Hours (X)</th>
<th>Exam Score (Y)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
</tr>
</tbody>
</table>
<p>Our goal: Find the best-fitting line <span class="math inline">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X</span> using OLS.</p>
</section>
<section id="step-1-calculate-the-means" class="level2" data-number="9.10">
<h2 data-number="9.10" class="anchored" data-anchor-id="step-1-calculate-the-means"><span class="header-section-number">9.10</span> Step 1: Calculate the Means</h2>
<p>First, we need the mean of X and Y.</p>
<p><strong>For X (study hours):</strong> <span class="math display">\bar{X} = \frac{1 + 2 + 3 + 4 + 5 + 6}{6} = \frac{21}{6} = 3.5</span></p>
<p><strong>For Y (exam scores):</strong> <span class="math display">\bar{Y} = \frac{65 + 70 + 75 + 85 + 88 + 95}{6} = \frac{478}{6} = 79.67</span></p>
</section>
<section id="step-2-calculate-deviations-from-means" class="level2" data-number="9.11">
<h2 data-number="9.11" class="anchored" data-anchor-id="step-2-calculate-deviations-from-means"><span class="header-section-number">9.11</span> Step 2: Calculate Deviations from Means</h2>
<p>For each observation, calculate <span class="math inline">(X_i - \bar{X})</span> and <span class="math inline">(Y_i - \bar{Y})</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
<td>1 - 3.5 = -2.5</td>
<td>65 - 79.67 = -14.67</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
<td>2 - 3.5 = -1.5</td>
<td>70 - 79.67 = -9.67</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
<td>3 - 3.5 = -0.5</td>
<td>75 - 79.67 = -4.67</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
<td>4 - 3.5 = 0.5</td>
<td>85 - 79.67 = 5.33</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
<td>5 - 3.5 = 1.5</td>
<td>88 - 79.67 = 8.33</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
<td>6 - 3.5 = 2.5</td>
<td>95 - 79.67 = 15.33</td>
</tr>
</tbody>
</table>
</section>
<section id="step-3-calculate-products-and-squares" class="level2" data-number="9.12">
<h2 data-number="9.12" class="anchored" data-anchor-id="step-3-calculate-products-and-squares"><span class="header-section-number">9.12</span> Step 3: Calculate Products and Squares</h2>
<p>Now calculate <span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span> and <span class="math inline">(X_i - \bar{X})^2</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>(-2.5)(-14.67) = 36.68</td>
<td>(-2.5)² = 6.25</td>
</tr>
<tr class="even">
<td>B</td>
<td>(-1.5)(-9.67) = 14.51</td>
<td>(-1.5)² = 2.25</td>
</tr>
<tr class="odd">
<td>C</td>
<td>(-0.5)(-4.67) = 2.34</td>
<td>(-0.5)² = 0.25</td>
</tr>
<tr class="even">
<td>D</td>
<td>(0.5)(5.33) = 2.67</td>
<td>(0.5)² = 0.25</td>
</tr>
<tr class="odd">
<td>E</td>
<td>(1.5)(8.33) = 12.50</td>
<td>(1.5)² = 2.25</td>
</tr>
<tr class="even">
<td>F</td>
<td>(2.5)(15.33) = 38.33</td>
<td>(2.5)² = 6.25</td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td><strong>107.03</strong></td>
<td><strong>17.50</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="step-4-calculate-the-slope-hatbeta_1" class="level2" data-number="9.13">
<h2 data-number="9.13" class="anchored" data-anchor-id="step-4-calculate-the-slope-hatbeta_1"><span class="header-section-number">9.13</span> Step 4: Calculate the Slope (<span class="math inline">\hat{\beta}_1</span>)</h2>
<p>Using the OLS formula: <span class="math display">\hat{\beta}_1 = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2} = \frac{107.03}{17.50} = 6.12</span></p>
<p><strong>Interpretation:</strong> Each additional hour of study is associated with a 6.12-point increase in exam score.</p>
</section>
<section id="step-5-calculate-the-intercept-hatbeta_0" class="level2" data-number="9.14">
<h2 data-number="9.14" class="anchored" data-anchor-id="step-5-calculate-the-intercept-hatbeta_0"><span class="header-section-number">9.14</span> Step 5: Calculate the Intercept (<span class="math inline">\hat{\beta}_0</span>)</h2>
<p><span class="math display">\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X} = 79.67 - (6.12 \times 3.5) = 79.67 - 21.42 = 58.25</span></p>
<p><strong>Interpretation:</strong> A student who studies 0 hours is predicted to score 58.25 points.</p>
</section>
<section id="step-6-write-the-regression-equation" class="level2" data-number="9.15">
<h2 data-number="9.15" class="anchored" data-anchor-id="step-6-write-the-regression-equation"><span class="header-section-number">9.15</span> Step 6: Write the Regression Equation</h2>
<p><span class="math display">\hat{Y} = 58.25 + 6.12X</span></p>
</section>
<section id="step-7-calculate-predicted-values-and-residuals" class="level2" data-number="9.16">
<h2 data-number="9.16" class="anchored" data-anchor-id="step-7-calculate-predicted-values-and-residuals"><span class="header-section-number">9.16</span> Step 7: Calculate Predicted Values and Residuals</h2>
<p>Using our equation to predict each student’s score:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 58.25 + 6.12X_i</span></th>
<th>Residual <span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
<td>58.25 + 6.12(1) = 64.37</td>
<td>65 - 64.37 = 0.63</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
<td>58.25 + 6.12(2) = 70.49</td>
<td>70 - 70.49 = -0.49</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
<td>58.25 + 6.12(3) = 76.61</td>
<td>75 - 76.61 = -1.61</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
<td>58.25 + 6.12(4) = 82.73</td>
<td>85 - 82.73 = 2.27</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
<td>58.25 + 6.12(5) = 88.85</td>
<td>88 - 88.85 = -0.85</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
<td>58.25 + 6.12(6) = 94.97</td>
<td>95 - 94.97 = 0.03</td>
</tr>
</tbody>
</table>
<p><strong>Check:</strong> Sum of residuals = 0.63 - 0.49 - 1.61 + 2.27 - 0.85 + 0.03 ≈ 0 ✓</p>
</section>
<section id="step-8-calculate-sum-of-squares" class="level2" data-number="9.17">
<h2 data-number="9.17" class="anchored" data-anchor-id="step-8-calculate-sum-of-squares"><span class="header-section-number">9.17</span> Step 8: Calculate Sum of Squares</h2>
<section id="total-sum-of-squares-sst" class="level3">
<h3 class="anchored" data-anchor-id="total-sum-of-squares-sst">Total Sum of Squares (SST)</h3>
<p>How much total variation exists in exam scores?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>65</td>
<td>(65 - 79.67)² = (-14.67)² = 215.21</td>
</tr>
<tr class="even">
<td>B</td>
<td>70</td>
<td>(70 - 79.67)² = (-9.67)² = 93.51</td>
</tr>
<tr class="odd">
<td>C</td>
<td>75</td>
<td>(75 - 79.67)² = (-4.67)² = 21.81</td>
</tr>
<tr class="even">
<td>D</td>
<td>85</td>
<td>(85 - 79.67)² = (5.33)² = 28.41</td>
</tr>
<tr class="odd">
<td>E</td>
<td>88</td>
<td>(88 - 79.67)² = (8.33)² = 69.39</td>
</tr>
<tr class="even">
<td>F</td>
<td>95</td>
<td>(95 - 79.67)² = (15.33)² = 235.01</td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td><strong>SST = 663.34</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="regression-sum-of-squares-ssr" class="level3">
<h3 class="anchored" data-anchor-id="regression-sum-of-squares-ssr">Regression Sum of Squares (SSR)</h3>
<p>How much variation does our model explain?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>64.37</td>
<td>(64.37 - 79.67)² = (-15.30)² = 234.09</td>
</tr>
<tr class="even">
<td>B</td>
<td>70.49</td>
<td>(70.49 - 79.67)² = (-9.18)² = 84.27</td>
</tr>
<tr class="odd">
<td>C</td>
<td>76.61</td>
<td>(76.61 - 79.67)² = (-3.06)² = 9.36</td>
</tr>
<tr class="even">
<td>D</td>
<td>82.73</td>
<td>(82.73 - 79.67)² = (3.06)² = 9.36</td>
</tr>
<tr class="odd">
<td>E</td>
<td>88.85</td>
<td>(88.85 - 79.67)² = (9.18)² = 84.27</td>
</tr>
<tr class="even">
<td>F</td>
<td>94.97</td>
<td>(94.97 - 79.67)² = (15.30)² = 234.09</td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td><strong>SSR = 655.44</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="error-sum-of-squares-sse" class="level3">
<h3 class="anchored" data-anchor-id="error-sum-of-squares-sse">Error Sum of Squares (SSE)</h3>
<p>How much variation is unexplained?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Residual <span class="math inline">e_i</span></th>
<th><span class="math inline">e_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>0.63</td>
<td>0.40</td>
</tr>
<tr class="even">
<td>B</td>
<td>-0.49</td>
<td>0.24</td>
</tr>
<tr class="odd">
<td>C</td>
<td>-1.61</td>
<td>2.59</td>
</tr>
<tr class="even">
<td>D</td>
<td>2.27</td>
<td>5.15</td>
</tr>
<tr class="odd">
<td>E</td>
<td>-0.85</td>
<td>0.72</td>
</tr>
<tr class="even">
<td>F</td>
<td>0.03</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td><strong>SSE = 9.10</strong></td>
</tr>
</tbody>
</table>
<p><strong>Verification:</strong> SST = SSR + SSE 663.34 ≈ 655.44 + 9.10 = 664.54 ✓ (small rounding difference)</p>
</section>
</section>
<section id="step-9-calculate-r-squared" class="level2" data-number="9.18">
<h2 data-number="9.18" class="anchored" data-anchor-id="step-9-calculate-r-squared"><span class="header-section-number">9.18</span> Step 9: Calculate R-Squared</h2>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{655.44}{663.34} = 0.988</span></p>
<p><strong>Alternative formula:</strong> <span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{9.10}{663.34} = 1 - 0.014 = 0.986</span></p>
<p>(Small difference due to rounding)</p>
<p><strong>Interpretation:</strong> Study hours explain 98.8% of the variation in exam scores. This is an extremely strong relationship.</p>
</section>
<section id="step-10-calculate-effect-sizes" class="level2" data-number="9.19">
<h2 data-number="9.19" class="anchored" data-anchor-id="step-10-calculate-effect-sizes"><span class="header-section-number">9.19</span> Step 10: Calculate Effect Sizes</h2>
<section id="raw-effect-size" class="level3">
<h3 class="anchored" data-anchor-id="raw-effect-size">Raw Effect Size</h3>
<p>The raw effect size is simply the slope: <strong>6.12 points per hour</strong></p>
</section>
<section id="standardized-effect-size" class="level3">
<h3 class="anchored" data-anchor-id="standardized-effect-size">Standardized Effect Size</h3>
<p>First, calculate standard deviations:</p>
<p><strong>For X:</strong> <span class="math display">s_X = \sqrt{\frac{\sum(X_i - \bar{X})^2}{n-1}} = \sqrt{\frac{17.50}{5}} = \sqrt{3.50} = 1.87</span></p>
<p><strong>For Y:</strong> <span class="math display">s_Y = \sqrt{\frac{\sum(Y_i - \bar{Y})^2}{n-1}} = \sqrt{\frac{663.34}{5}} = \sqrt{132.67} = 11.52</span></p>
<p><strong>Standardized coefficient:</strong> <span class="math display">\beta_{std} = \hat{\beta}_1 \times \frac{s_X}{s_Y} = 6.12 \times \frac{1.87}{11.52} = 6.12 \times 0.162 = 0.99</span></p>
<p><strong>Interpretation:</strong> A one standard deviation increase in study hours (1.87 hours) is associated with a 0.99 standard deviation increase in exam score.</p>
<p>According to Cohen’s guidelines:</p>
<ul>
<li>Small effect: |β| = 0.10</li>
<li>Medium effect: |β| = 0.30</li>
<li>Large effect: |β| = 0.50</li>
</ul>
<p>Our standardized effect of 0.99 is nearly twice Cohen’s “large effect” threshold.</p>
</section>
</section>
<section id="step-11-practical-significance-assessment" class="level2" data-number="9.20">
<h2 data-number="9.20" class="anchored" data-anchor-id="step-11-practical-significance-assessment"><span class="header-section-number">9.20</span> Step 11: Practical Significance Assessment</h2>
<section id="context-analysis" class="level3">
<h3 class="anchored" data-anchor-id="context-analysis">Context Analysis</h3>
<ol type="1">
<li><strong>Scale consideration:</strong>
<ul>
<li>Effect: 6.12 points per hour</li>
<li>Exam scale: 0-100 points</li>
<li>Percentage impact: 6.12% per hour</li>
</ul></li>
<li><strong>Practical thresholds:</strong>
<ul>
<li>Letter grade difference: Often 10 points</li>
<li>Time to improve one letter grade: 10/6.12 = 1.63 hours</li>
<li>Conclusion: Less than 2 hours of extra study could change a letter grade</li>
</ul></li>
<li><strong>Cost-benefit analysis:</strong>
<ul>
<li>Benefit: 6.12 points per hour</li>
<li>Cost: 1 hour of time</li>
<li>Decision: Highly favorable return on investment</li>
</ul></li>
</ol>
</section>
</section>
<section id="summary-of-results" class="level2" data-number="9.21">
<h2 data-number="9.21" class="anchored" data-anchor-id="summary-of-results"><span class="header-section-number">9.21</span> Summary of Results</h2>
<p><strong>Regression equation:</strong> <span class="math inline">\hat{Y} = 58.25 + 6.12X</span></p>
<p><strong>Key statistics:</strong></p>
<ul>
<li>Slope (<span class="math inline">\hat{\beta}_1</span>): 6.12 points/hour</li>
<li>Intercept (<span class="math inline">\hat{\beta}_0</span>): 58.25 points</li>
<li>R²: 0.988 (98.8% of variance explained)</li>
<li>Standardized effect: 0.99 (very large effect)</li>
</ul>
<p><strong>Practical interpretation:</strong></p>
<ul>
<li>Each hour of study adds about 6 points to exam score</li>
<li>The model fits extremely well (R² near 1)</li>
<li>The effect is both statistically and practically significant</li>
<li>Students can meaningfully improve grades with modest increases in study time</li>
</ul>
</section>
<section id="verification-check" class="level2" data-number="9.22">
<h2 data-number="9.22" class="anchored" data-anchor-id="verification-check"><span class="header-section-number">9.22</span> Verification Check</h2>
<p>To verify our calculations, let’s check that the regression line passes through <span class="math inline">(\bar{X}, \bar{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 58.25 + 6.12(3.5) = 58.25 + 21.42 = 79.67 = \bar{Y}</span> ✓</p>
<p>The calculation confirms our regression line passes through the point of means, as it should.</p>
</section>
<section id="r-code-to-verify-manual-calculations" class="level2" data-number="9.23">
<h2 data-number="9.23" class="anchored" data-anchor-id="r-code-to-verify-manual-calculations"><span class="header-section-number">9.23</span> R Code to Verify Manual Calculations</h2>
<p>Below is R code that checks all our manual calculations. You can run this code to confirm every step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create the data</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)  <span class="co"># X variable</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>exam_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">95</span>)  <span class="co"># Y variable</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(study_hours)  <span class="co"># Sample size</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for easier handling</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> study_hours,</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> exam_scores</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Original Data:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Original Data:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student X  Y
1       A 1 65
2       B 2 70
3       C 3 75
4       D 4 85
5       E 5 88
6       F 6 95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Calculate means</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(study_hours)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(exam_scores)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Means:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Means:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Mean of X (study hours): %.2f</span><span class="sc">\n</span><span class="st">"</span>, x_bar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of X (study hours): 3.50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Mean of Y (exam scores): %.2f</span><span class="sc">\n</span><span class="st">"</span>, y_bar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of Y (exam scores): 79.67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Calculate deviations from means</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>x_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>X <span class="sc">-</span> x_bar  <span class="co"># X deviations</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>Y <span class="sc">-</span> y_bar  <span class="co"># Y deviations</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Deviations from means:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Deviations from means:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data[, <span class="fu">c</span>(<span class="st">"Student"</span>, <span class="st">"x_dev"</span>, <span class="st">"y_dev"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student x_dev      y_dev
1       A  -2.5 -14.666667
2       B  -1.5  -9.666667
3       C  -0.5  -4.666667
4       D   0.5   5.333333
5       E   1.5   8.333333
6       F   2.5  15.333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Calculate products and squares for OLS formula</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>xy_product <span class="ot">&lt;-</span> data<span class="sc">$</span>x_dev <span class="sc">*</span> data<span class="sc">$</span>y_dev  <span class="co"># (Xi - X̄)(Yi - Ȳ)</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>x_dev_sq <span class="ot">&lt;-</span> data<span class="sc">$</span>x_dev<span class="sc">^</span><span class="dv">2</span>  <span class="co"># (Xi - X̄)²</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum of products and squares</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>sum_xy_product <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>xy_product)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>sum_x_dev_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>x_dev_sq)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of (Xi - X̄)(Yi - Ȳ):"</span>, <span class="fu">round</span>(sum_xy_product, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of (Xi - X̄)(Yi - Ȳ): 107 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sum of (Xi - X̄)²:"</span>, sum_x_dev_sq, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of (Xi - X̄)²: 17.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Calculate slope (beta_1) manually</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>beta_1_manual <span class="ot">&lt;-</span> sum_xy_product <span class="sc">/</span> sum_x_dev_sq</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Slope (β₁) calculated manually:"</span>, <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Slope (β₁) calculated manually: 6.11 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Calculate intercept (beta_0) manually</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>beta_0_manual <span class="ot">&lt;-</span> y_bar <span class="sc">-</span> beta_1_manual <span class="sc">*</span> x_bar</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Intercept (β₀) calculated manually:"</span>, <span class="fu">round</span>(beta_0_manual, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Intercept (β₀) calculated manually: 58.27 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Compare with R's lm() function</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Verification with R's lm() function ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Verification with R's lm() function ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error
(Intercept) 58.266667  1.4045278
X            6.114286  0.3606495</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Calculate predicted values and residuals</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Y_hat <span class="ot">&lt;-</span> beta_0_manual <span class="sc">+</span> beta_1_manual <span class="sc">*</span> data<span class="sc">$</span>X  <span class="co"># Predicted values</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residual <span class="ot">&lt;-</span> data<span class="sc">$</span>Y <span class="sc">-</span> data<span class="sc">$</span>Y_hat  <span class="co"># Residuals</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted values and residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Predicted values and residuals:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data[, <span class="fu">c</span>(<span class="st">"Student"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Y_hat"</span>, <span class="st">"residual"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student X  Y    Y_hat    residual
1       A 1 65 64.38095  0.61904762
2       B 2 70 70.49524 -0.49523810
3       C 3 75 76.60952 -1.60952381
4       D 4 85 82.72381  2.27619048
5       E 5 88 88.83810 -0.83809524
6       F 6 95 94.95238  0.04761905</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sum of residuals (should be ≈ 0):"</span>, <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residual), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of residuals (should be ≈ 0): 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 9: Calculate Sum of Squares</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Total Sum of Squares (SST)</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>Y <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Sum of Squares Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sum of Squares Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Total Sum of Squares):"</span>, <span class="fu">round</span>(SST, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Total Sum of Squares): 663.33 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression Sum of Squares (SSR)</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>Y_hat <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Regression Sum of Squares):"</span>, <span class="fu">round</span>(SSR, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Regression Sum of Squares): 654.23 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error Sum of Squares (SSE)</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Error Sum of Squares):"</span>, <span class="fu">round</span>(SSE, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Error Sum of Squares): 9.1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that SST = SSR + SSE</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Verification: SST = SSR + SSE</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Verification: SST = SSR + SSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f = %.2f + %.2f</span><span class="sc">\n</span><span class="st">"</span>, SST, SSR, SSE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>663.33 = 654.23 + 9.10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (due to rounding):"</span>, <span class="fu">round</span>(SST <span class="sc">-</span> (SSR <span class="sc">+</span> SSE), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (due to rounding): 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 10: Calculate R-squared</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>R_squared_method1 <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>R_squared_method2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSE <span class="sc">/</span> SST)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>R_squared_lm <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- R-squared Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- R-squared Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (Method 1: SSR/SST):"</span>, <span class="fu">round</span>(R_squared_method1, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (Method 1: SSR/SST): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (Method 2: 1 - SSE/SST):"</span>, <span class="fu">round</span>(R_squared_method2, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (Method 2: 1 - SSE/SST): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (from lm function):"</span>, <span class="fu">round</span>(R_squared_lm, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (from lm function): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 11: Calculate Effect Sizes</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw effect size (just the slope)</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Effect Size Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Effect Size Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Raw effect size (slope):"</span>, <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"points per hour</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw effect size (slope): 6.11 points per hour</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard deviations for standardized effect</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>X)  <span class="co"># Standard deviation of X</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Y)  <span class="co"># Standard deviation of Y</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviations:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviations:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SD of X: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sd_x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of X: 1.87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SD of Y: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sd_y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of Y: 11.52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized effect size</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>beta_std <span class="ot">&lt;-</span> beta_1_manual <span class="sc">*</span> (sd_x <span class="sc">/</span> sd_y)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized effect size: %.2f</span><span class="sc">\n</span><span class="st">"</span>, beta_std))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized effect size: 0.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation coefficient (should equal sqrt(R²) for simple regression)</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(data<span class="sc">$</span>X, data<span class="sc">$</span>Y)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pearson correlation coefficient:"</span>, <span class="fu">round</span>(correlation, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Pearson correlation coefficient: 0.9931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Square root of R²:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(R_squared_method1), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Square root of R²: 0.9931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"These should be equal (within rounding error)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>These should be equal (within rounding error)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 12: Create visualization</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Creating Visualization ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Creating Visualization ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data and regression line</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>X, data<span class="sc">$</span>Y, </span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Study Hours vs Exam Scores with OLS Regression Line"</span>,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>,</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the regression line</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> beta_0_manual, <span class="at">b =</span> beta_1_manual, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the mean point</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x_bar, y_bar, <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add vertical lines for residuals</span></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) {</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(data<span class="sc">$</span>X[i], data<span class="sc">$</span>Y[i], data<span class="sc">$</span>X[i], data<span class="sc">$</span>Y_hat[i], </span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, </span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Observed Data"</span>, <span class="st">"Regression Line"</span>, <span class="st">"Mean Point"</span>, <span class="st">"Residuals"</span>),</span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"gray"</span>),</span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>, <span class="dv">15</span>, <span class="cn">NA</span>),</span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">1</span>))</span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the equation to the plot</span></span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a>equation_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Y = %.2f + %.2f*X"</span>, beta_0_manual, beta_1_manual)</span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a>r2_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"R² = %.3f"</span>, R_squared_method1)</span>
<span id="cb179-31"><a href="#cb179-31" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, <span class="dv">92</span>, equation_text, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb179-32"><a href="#cb179-32" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, <span class="dv">89</span>, r2_text, <span class="at">pos =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final summary</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">========== FINAL SUMMARY ==========</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
========== FINAL SUMMARY ==========</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Regression Equation: Y ="</span>, <span class="fu">round</span>(beta_0_manual, <span class="dv">2</span>), <span class="st">"+"</span>, </span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"* X</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Regression Equation: Y = 58.27 + 6.11 * X</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(R_squared_method1, <span class="dv">4</span>), </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"(%.1f%% of variance explained)</span><span class="sc">\n</span><span class="st">"</span>, R_squared_method1 <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9863 (98.6% of variance explained)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standardized Effect Size:"</span>, <span class="fu">round</span>(beta_std, <span class="dv">2</span>), <span class="st">"(Very Large Effect)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standardized Effect Size: 0.99 (Very Large Effect)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Each additional hour of study increases exam score by"</span>, </span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Each additional hour of study increases exam score by 6.11 points</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Study hours explain"</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, R_squared_method1 <span class="sc">*</span> <span class="dv">100</span>), </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"of the variation in exam scores</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Study hours explain 98.6% of the variation in exam scores</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- The relationship is extremely strong (correlation ="</span>, </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(correlation, <span class="dv">3</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- The relationship is extremely strong (correlation = 0.993 )</code></pre>
</div>
</div>
<section id="running-the-code" class="level3">
<h3 class="anchored" data-anchor-id="running-the-code">Running the Code</h3>
<p>To run this R code:</p>
<ol type="1">
<li>Copy the entire code block above</li>
<li>Paste it into RStudio or any R console</li>
<li>Execute the code</li>
<li>Compare the output with our manual calculations</li>
</ol>
<p>The code will:</p>
<ul>
<li>Recreate all our manual calculations step by step</li>
<li>Verify results using R’s built-in <code>lm()</code> function</li>
<li>Generate a visualization of the data with the regression line</li>
<li>Display all intermediate calculations with clear labels</li>
</ul>
</section>
<section id="expected-output-highlights" class="level3">
<h3 class="anchored" data-anchor-id="expected-output-highlights">Expected Output Highlights</h3>
<p>When you run this code, you should see:</p>
<ul>
<li><strong>Slope:</strong> 6.12 (matching our manual calculation)</li>
<li><strong>Intercept:</strong> 58.25 (matching our manual calculation)</li>
<li><strong>R²:</strong> 0.988 (matching our manual calculation)</li>
<li><strong>Standardized effect:</strong> 0.99 (matching our manual calculation)</li>
<li>A plot showing the data points, regression line, and residuals</li>
</ul>
<p>This verification confirms that our pen-and-paper calculations were correct! :::</p>
<hr>
</section>
</section>
<section id="model-interpretation-a-beginners-guide" class="level2" data-number="9.24">
<h2 data-number="9.24" class="anchored" data-anchor-id="model-interpretation-a-beginners-guide"><span class="header-section-number">9.24</span> Model Interpretation: A Beginner’s Guide</h2>
<p>Let’s create a simple dataset to understand regression output better. Imagine we’re studying how years of education affect annual income:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple dataset - this is our Data Generating Process (DGP)</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>education_years <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>  <span class="co"># Education from 10 to 20 years</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(education_years)</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="co"># True parameters in our model - using more realistic values for Poland</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>true_intercept <span class="ot">&lt;-</span> <span class="dv">3000</span>   <span class="co"># Base monthly income with no education (in PLN)</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>true_slope <span class="ot">&lt;-</span> <span class="dv">250</span>        <span class="co"># Each year of education increases monthly income by 250 PLN</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate monthly incomes with some random noise</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> true_intercept <span class="sc">+</span> true_slope <span class="sc">*</span> education_years <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">300</span>)</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create our dataset</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>education_income <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> education_years,</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> income</span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's visualize our data</span></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(education_income, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">8500</span>), </span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5000</span>, <span class="dv">8500</span>, <span class="at">by =</span> <span class="dv">500</span>),</span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Education and Income in Poland"</span>,</span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of Education"</span>,</span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Monthly Income (PLN)"</span>,</span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red line shows the estimated linear relationship"</span></span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">11</span>, <span class="at">y =</span> <span class="dv">8000</span>, </span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Each point represents</span><span class="sc">\n</span><span class="st">one person's data"</span>, </span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/create-example-data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="fitting-the-model" class="level4">
<h4 class="anchored" data-anchor-id="fitting-the-model">Fitting the Model</h4>
<p>Now let’s fit a linear regression model to this data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a simple regression model</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>edu_income_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> education_income)</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the results</span></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>model_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(edu_income_model)</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>model_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = income ~ education, data = education_income)

Residuals:
    Min      1Q  Median      3Q     Max 
-427.72 -206.04  -38.12  207.32  460.78 

Coefficients:
            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)   3095.3      447.6   6.915 0.0000695 ***
education      247.2       29.2   8.467 0.0000140 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 306.3 on 9 degrees of freedom
Multiple R-squared:  0.8885,    Adjusted R-squared:  0.8761 
F-statistic: 71.69 on 1 and 9 DF,  p-value: 0.00001403</code></pre>
</div>
</div>
</section>
<section id="understanding-the-regression-output-step-by-step" class="level4">
<h4 class="anchored" data-anchor-id="understanding-the-regression-output-step-by-step">Understanding the Regression Output Step by Step</h4>
<p>Let’s break down what each part of this output means in simple terms:</p>
<section id="the-formula" class="level5">
<h5 class="anchored" data-anchor-id="the-formula">1. The Formula</h5>
<p>At the top, you see <code>income ~ education</code>, which means we’re predicting income based on education.</p>
</section>
<section id="residuals" class="level5">
<h5 class="anchored" data-anchor-id="residuals">2. Residuals</h5>
<p>These show how far our predictions are from the actual values. Ideally, they should be centered around zero.</p>
</section>
<section id="coefficients-table" class="level5">
<h5 class="anchored" data-anchor-id="coefficients-table">3. Coefficients Table</h5>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Coefficient Estimates</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">3095.27</td>
<td style="text-align: right;">447.63</td>
<td style="text-align: right;">6.91</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">education</td>
<td style="text-align: right;">247.23</td>
<td style="text-align: right;">29.20</td>
<td style="text-align: right;">8.47</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Intercept</strong> (<span class="math inline">\beta_0</span>):</p>
<ul>
<li><p>Value: Approximately 3095</p></li>
<li><p>Interpretation: This is the predicted monthly income for someone with 0 years of education</p></li>
<li><p>Note: Sometimes the intercept isn’t meaningful in real-world terms, especially if x=0 is outside your data range</p></li>
</ul>
<p><strong>Education</strong> (<span class="math inline">\beta_1</span>):</p>
<ul>
<li><p>Value: Approximately 247</p></li>
<li><p>Interpretation: For each additional year of education, we expect monthly income to increase by this amount in PLN</p></li>
<li><p>This is our main coefficient of interest!</p></li>
</ul>
<p><strong>Standard Error</strong>:</p>
<ul>
<li><p>Measures how precise our estimates are</p></li>
<li><p>Smaller standard errors mean more precise estimates</p></li>
<li><p>Think of it as “give or take how much” for our coefficients</p></li>
</ul>
<p><strong>t value</strong>:</p>
<ul>
<li><p>This is the coefficient divided by its standard error</p></li>
<li><p>It tells us how many standard errors away from zero our coefficient is</p></li>
<li><p>Larger absolute t values (above 2) suggest the effect is statistically significant</p></li>
</ul>
<p><strong>p-value</strong>:</p>
<ul>
<li><p>The probability of seeing our result (or something more extreme) if there was actually no relationship</p></li>
<li><p>Typically, p &lt; 0.05 is considered statistically significant</p></li>
<li><p>For education, p = 0.000014, which is significant!</p></li>
</ul>
</section>
<section id="model-fit-statistics" class="level5">
<h5 class="anchored" data-anchor-id="model-fit-statistics">4. Model Fit Statistics</h5>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Model Fit Statistics</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Statistic</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R-squared</td>
<td style="text-align: right;">0.888</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adjusted R-squared</td>
<td style="text-align: right;">0.876</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F-statistic</td>
<td style="text-align: right;">71.686</td>
</tr>
<tr class="even">
<td style="text-align: left;">p-value</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>R-squared</strong>:</p>
<ul>
<li><p>Value: 0.888</p></li>
<li><p>Interpretation: 89% of the variation in income is explained by education</p></li>
<li><p>Higher is better, but be cautious of very high values (could indicate overfitting)</p></li>
</ul>
<p><strong>F-statistic</strong>:</p>
<ul>
<li><p>Tests whether the model as a whole is statistically significant</p></li>
<li><p>A high F-statistic with a low p-value indicates a significant model</p></li>
</ul>
</section>
</section>
<section id="visualizing-the-model-results" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-the-model-results">Visualizing the Model Results</h4>
<p>Let’s visualize what our model actually tells us:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>education_income<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(edu_income_model)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>education_income<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(edu_income_model)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a more informative plot</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(education_income, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income)) <span class="sc">+</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Actual data points</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Regression line</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Residual lines</span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> education, <span class="at">yend =</span> predicted), </span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set proper scales</span></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">8500</span>), </span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5000</span>, <span class="dv">8500</span>, <span class="at">by =</span> <span class="dv">500</span>),</span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Annotations</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">19</span>, <span class="at">y =</span> <span class="dv">7850</span>, </span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Slope ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(edu_income_model)[<span class="dv">2</span>]), <span class="st">"PLN per year"</span>),</span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">10.5</span>, <span class="at">y =</span> <span class="dv">5500</span>, </span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Intercept ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(edu_income_model)[<span class="dv">1</span>]), <span class="st">"PLN"</span>),</span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-32"><a href="#cb200-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">14</span>, <span class="at">y =</span> <span class="dv">8200</span>, </span>
<span id="cb200-33"><a href="#cb200-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"R² ="</span>, <span class="fu">round</span>(model_summary<span class="sc">$</span>r.squared, <span class="dv">2</span>)),</span>
<span id="cb200-34"><a href="#cb200-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb200-35"><a href="#cb200-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb200-36"><a href="#cb200-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels</span></span>
<span id="cb200-37"><a href="#cb200-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb200-38"><a href="#cb200-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Interpreting the Education-Income Regression Model"</span>,</span>
<span id="cb200-39"><a href="#cb200-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Red line shows predicted income for each education level"</span>,</span>
<span id="cb200-40"><a href="#cb200-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of Education"</span>,</span>
<span id="cb200-41"><a href="#cb200-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Monthly Income (PLN)"</span>,</span>
<span id="cb200-42"><a href="#cb200-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Gray dashed lines represent residuals (prediction errors)"</span></span>
<span id="cb200-43"><a href="#cb200-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb200-44"><a href="#cb200-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb200-45"><a href="#cb200-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb200-46"><a href="#cb200-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb200-47"><a href="#cb200-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb200-48"><a href="#cb200-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb200-49"><a href="#cb200-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/visualize-model-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="real-world-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="real-world-interpretation">Real-World Interpretation</h4>
<ul>
<li><p>A person with 16 years of education (college graduate) would be predicted to earn about: <span class="math inline">\hat{Y} = 3095 + 247 \times 16 = 7051 \text{ PLN monthly}</span></p></li>
<li><p>The model suggests that each additional year of education is associated with a 247 PLN increase in monthly income.</p></li>
<li><p>Our model explains approximately 89% of the variation in income in our sample.</p></li>
<li><p>The relationship is statistically significant (p &lt; 0.001), meaning it’s very unlikely to observe this relationship if education truly had no effect on income.</p></li>
</ul>
</section>
<section id="important-cautions-for-beginners" class="level4">
<h4 class="anchored" data-anchor-id="important-cautions-for-beginners">Important Cautions for Beginners</h4>
<ol type="1">
<li><p><strong>Correlation ≠ Causation</strong>: Our model shows association, not necessarily causation</p></li>
<li><p><strong>Omitted Variables</strong>: Other factors might influence both education and income</p></li>
<li><p><strong>Extrapolation</strong>: Be careful predicting outside the range of your data</p></li>
<li><p><strong>Linear Relationship</strong>: We’ve assumed the relationship is linear, which may not always be true</p></li>
</ol>
<hr>
</section>
</section>
<section id="derivation-of-ols-estimators" class="level2" data-number="9.25">
<h2 data-number="9.25" class="anchored" data-anchor-id="derivation-of-ols-estimators"><span class="header-section-number">9.25</span> Derivation of OLS Estimators (*)</h2>
<p>For simple linear regression, the OLS estimators are obtained by minimizing the sum of squared residuals:</p>
<p><span class="math display">SSE = \sum_{i=1}^{n} (Y_i - \beta_0 - \beta_1 X_i)^2</span></p>
<p>Taking partial derivatives with respect to <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> and setting them equal to zero yields the normal equations. Solving this system produces:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{\sum_{i=1}^{n}(X_i - \bar{X})^2} = \frac{Cov(X,Y)}{Var(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X}</span></p>
<section id="properties-of-ols-estimators" class="level3">
<h3 class="anchored" data-anchor-id="properties-of-ols-estimators">Properties of OLS Estimators</h3>
<p>The OLS procedure guarantees several important properties:</p>
<ol type="1">
<li><strong>Zero sum of residuals</strong>: <span class="math inline">\sum_{i=1}^{n} e_i = 0</span></li>
<li><strong>Orthogonality of residuals and predictors</strong>: <span class="math inline">\sum_{i=1}^{n} X_i e_i = 0</span></li>
<li><strong>The fitted regression line passes through the point</strong> <span class="math inline">(\bar{X}, \bar{Y})</span></li>
<li><strong>Zero covariance between fitted values and residuals</strong>: <span class="math inline">\sum_{i=1}^{n} \hat{Y}_i e_i = 0</span></li>
</ol>
</section>
<section id="classical-linear-model-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="classical-linear-model-assumptions">Classical Linear Model Assumptions</h3>
<section id="core-assumptions" class="level4">
<h4 class="anchored" data-anchor-id="core-assumptions">Core Assumptions</h4>
<p>For OLS estimators to possess desirable statistical properties, the following assumptions must hold:</p>
</section>
<section id="assumption-1-linearity-in-parameters" class="level4">
<h4 class="anchored" data-anchor-id="assumption-1-linearity-in-parameters">Assumption 1: Linearity in Parameters</h4>
<p>The relationship between the dependent and independent variables is linear in the parameters: <span class="math display">Y_i = \beta_0 + \beta_1 X_{1i} + ... + \beta_k X_{ki} + \varepsilon_i</span></p>
</section>
<section id="assumption-2-strict-exogeneity" class="level4">
<h4 class="anchored" data-anchor-id="assumption-2-strict-exogeneity">Assumption 2: Strict Exogeneity</h4>
<p>The error term has zero conditional expectation given all values of the independent variables: <span class="math display">E[\varepsilon_i | X] = 0</span></p>
<p>This assumption implies that the independent variables contain no information about the mean of the error term. It is stronger than contemporaneous exogeneity and rules out feedback from past errors to current regressors. This assumption is critical for unbiased estimation and is often violated in time series contexts with lagged dependent variables or in the presence of omitted variables.</p>
<p>This assumption is particularly important for our discussion of spurious correlations. Violations of the exogeneity assumption lead to endogeneity problems, which we will discuss later.</p>
</section>
<section id="assumption-3-no-perfect-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="assumption-3-no-perfect-multicollinearity">Assumption 3: No Perfect Multicollinearity</h4>
<p>In multiple regression, no independent variable can be expressed as a perfect linear combination of other independent variables. The matrix <span class="math inline">X'X</span> must be invertible.</p>
</section>
<section id="assumption-4-homoscedasticity" class="level4">
<h4 class="anchored" data-anchor-id="assumption-4-homoscedasticity">Assumption 4: Homoscedasticity</h4>
<p>The variance of the error term is constant across all observations: <span class="math display">Var(\varepsilon_i | X) = \sigma^2</span></p>
<p>This assumption ensures that the precision of the regression does not vary systematically with the level of the independent variables.</p>
</section>
<section id="assumption-5-no-autocorrelation" class="level4">
<h4 class="anchored" data-anchor-id="assumption-5-no-autocorrelation">Assumption 5: No Autocorrelation</h4>
<p>The error terms are uncorrelated with each other: <span class="math display">Cov(\varepsilon_i, \varepsilon_j | X) = 0 \text{ for } i \neq j</span></p>
</section>
<section id="assumption-6-normality-of-errors-for-inference" class="level4">
<h4 class="anchored" data-anchor-id="assumption-6-normality-of-errors-for-inference">Assumption 6: Normality of Errors (for inference)</h4>
<p>The error terms follow a normal distribution: <span class="math display">\varepsilon_i \sim N(0, \sigma^2)</span></p>
<p>This assumption is not required for the unbiasedness or consistency of OLS estimators but is necessary for exact finite-sample inference.</p>
</section>
</section>
<section id="gauss-markov-theorem" class="level3">
<h3 class="anchored" data-anchor-id="gauss-markov-theorem">Gauss-Markov Theorem</h3>
<p>Under Assumptions 1-5, the OLS estimators are BLUE (Best Linear Unbiased Estimators):</p>
<ul>
<li><strong>Best</strong>: Minimum variance among the class of linear unbiased estimators</li>
<li><strong>Linear</strong>: The estimators are linear functions of the dependent variable</li>
<li><strong>Unbiased</strong>: <span class="math inline">E[\hat{\beta}] = \beta</span></li>
</ul>
</section>
<section id="visualization-of-ols-methodology" class="level3">
<h3 class="anchored" data-anchor-id="visualization-of-ols-methodology">Visualization of OLS Methodology</h3>
<section id="geometric-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="geometric-interpretation">Geometric Interpretation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprehensive visualization of OLS regression</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>x <span class="sc">+</span> epsilon</span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>fitted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)</span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-19"><a href="#cb202-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive plot</span></span>
<span id="cb202-20"><a href="#cb202-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb202-21"><a href="#cb202-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add confidence interval</span></span>
<span id="cb202-22"><a href="#cb202-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb202-23"><a href="#cb202-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line</span></span>
<span id="cb202-24"><a href="#cb202-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb202-25"><a href="#cb202-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add residual segments</span></span>
<span id="cb202-26"><a href="#cb202-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> fitted), </span>
<span id="cb202-27"><a href="#cb202-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb202-28"><a href="#cb202-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add observed points</span></span>
<span id="cb202-29"><a href="#cb202-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb202-30"><a href="#cb202-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add fitted values</span></span>
<span id="cb202-31"><a href="#cb202-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb202-32"><a href="#cb202-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Annotations</span></span>
<span id="cb202-33"><a href="#cb202-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb202-34"><a href="#cb202-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb202-35"><a href="#cb202-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb202-36"><a href="#cb202-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb202-37"><a href="#cb202-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb202-38"><a href="#cb202-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb202-39"><a href="#cb202-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb202-40"><a href="#cb202-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Ordinary Least Squares Regression"</span>,</span>
<span id="cb202-41"><a href="#cb202-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Estimated equation: Y = %.2f + %.3f X  (R² = %.3f, RSE = %.2f)"</span>,</span>
<span id="cb202-42"><a href="#cb202-42" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="fu">coef</span>(model)[<span class="dv">2</span>], </span>
<span id="cb202-43"><a href="#cb202-43" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, </span>
<span id="cb202-44"><a href="#cb202-44" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">summary</span>(model)<span class="sc">$</span>sigma),</span>
<span id="cb202-45"><a href="#cb202-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Independent Variable (X)"</span>,</span>
<span id="cb202-46"><a href="#cb202-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Dependent Variable (Y)"</span></span>
<span id="cb202-47"><a href="#cb202-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb202-48"><a href="#cb202-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">min</span>(x) <span class="sc">+</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="fu">max</span>(y) <span class="sc">-</span> <span class="dv">5</span>,</span>
<span id="cb202-49"><a href="#cb202-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"SSE = %.1f"</span>, <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb202-50"><a href="#cb202-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualization-of-squared-residuals" class="level4">
<h4 class="anchored" data-anchor-id="visualization-of-squared-residuals">Visualization of Squared Residuals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate why squaring is necessary</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example with clear pattern</span></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, df)</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>fitted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model)</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>residual <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Raw residuals</span></span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> residual, <span class="at">xend =</span> x), </span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>residual <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkred"</span>),</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> residual), <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>residual <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"darkgreen"</span>, <span class="st">"darkred"</span>)) <span class="sc">+</span></span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residuals (ei)"</span>,</span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Sum = %.2f (not meaningful)"</span>, <span class="fu">sum</span>(df<span class="sc">$</span>residual)),</span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Residual"</span>) <span class="sc">+</span></span>
<span id="cb204-29"><a href="#cb204-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb204-30"><a href="#cb204-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-31"><a href="#cb204-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Squared residuals</span></span>
<span id="cb204-32"><a href="#cb204-32" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb204-33"><a href="#cb204-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb204-34"><a href="#cb204-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> residual<span class="sc">^</span><span class="dv">2</span>, <span class="at">xend =</span> x), </span>
<span id="cb204-35"><a href="#cb204-35" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb204-36"><a href="#cb204-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> residual<span class="sc">^</span><span class="dv">2</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkred"</span>) <span class="sc">+</span></span>
<span id="cb204-37"><a href="#cb204-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb204-38"><a href="#cb204-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Squared Residuals (ei²)"</span>,</span>
<span id="cb204-39"><a href="#cb204-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"Sum = %.2f (minimized by OLS)"</span>, <span class="fu">sum</span>(df<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb204-40"><a href="#cb204-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Squared Residual"</span>) <span class="sc">+</span></span>
<span id="cb204-41"><a href="#cb204-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">36</span>))</span>
<span id="cb204-42"><a href="#cb204-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-43"><a href="#cb204-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb204-44"><a href="#cb204-44" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="diagnostic-analysis" class="level3">
<h3 class="anchored" data-anchor-id="diagnostic-analysis">Diagnostic Analysis</h3>
<section id="residual-diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="residual-diagnostics">Residual Diagnostics</h4>
<p>Assessment of model assumptions requires careful examination of residual patterns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate diagnostic plots</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted Values</span></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests linearity and homoscedasticity assumptions</span></span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal Q-Q Plot</span></span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests normality assumption</span></span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale-Location Plot</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests homoscedasticity assumption</span></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Cook's Distance</span></span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identifies influential observations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testing-assumptions-formally" class="level4">
<h4 class="anchored" data-anchor-id="testing-assumptions-formally">Testing Assumptions Formally</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Formal statistical tests</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for heteroscedasticity</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Breusch-Pagan test</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  model
BP = 0.37876, df = 1, p-value = 0.5383</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for autocorrelation</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Durbin-Watson test</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  model
DW = 2.1781, p-value = 0.5599
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for normality</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Shapiro-Wilk test on residuals</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(model)
W = 0.98221, p-value = 0.9593</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for linearity</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rainbow test</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">raintest</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Rainbow test

data:  model
Rain = 1.2139, df1 = 10, df2 = 8, p-value = 0.3995</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="key-learning-points" class="level3">
<h3 class="anchored" data-anchor-id="key-learning-points">Key Learning Points</h3>
<ul>
<li>The Sum of Squared Errors (SSE) is what Ordinary Least Squares (OLS) regression minimizes</li>
<li>Each residual contributes its squared value to the total SSE</li>
<li>The OLS line has a lower SSE than any other possible line</li>
<li>Large residuals contribute disproportionately to the SSE due to the squaring operation</li>
<li>This is why outliers can have such a strong influence on regression lines</li>
</ul>
<section id="step-by-step-sse-minimization" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-sse-minimization">Step-by-Step SSE Minimization</h4>
<p>To illustrate the process of finding the minimum SSE, we can create a sequence that passes through the optimal point, showing how the SSE first decreases to a minimum and then increases again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(model)</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of steps that passes through the optimal OLS line</span></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>steps <span class="ot">&lt;-</span> <span class="dv">9</span>  <span class="co"># Use odd number to have a middle point at the optimum</span></span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>step_seq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">step =</span> <span class="dv">1</span><span class="sc">:</span>steps,</span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">seq</span>(coef[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">8</span>, coef[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">8</span>, <span class="at">length.out =</span> steps),</span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">seq</span>(coef[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.5</span>, coef[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">length.out =</span> steps)</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Mark the middle step (optimal OLS solution)</span></span>
<span id="cb219-20"><a href="#cb219-20" aria-hidden="true" tabindex="-1"></a>optimal_step <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(steps<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb219-21"><a href="#cb219-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-22"><a href="#cb219-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SSE for each step</span></span>
<span id="cb219-23"><a href="#cb219-23" aria-hidden="true" tabindex="-1"></a>step_seq<span class="sc">$</span>sse <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(step_seq), <span class="cf">function</span>(i) {</span>
<span id="cb219-24"><a href="#cb219-24" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> step_seq<span class="sc">$</span>intercept[i] <span class="sc">+</span> step_seq<span class="sc">$</span>slope[i] <span class="sc">*</span> x</span>
<span id="cb219-25"><a href="#cb219-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((y <span class="sc">-</span> predicted)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb219-26"><a href="#cb219-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb219-27"><a href="#cb219-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-28"><a href="#cb219-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a "journey through the SSE valley" plot</span></span>
<span id="cb219-29"><a href="#cb219-29" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb219-30"><a href="#cb219-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb219-31"><a href="#cb219-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> step_seq, </span>
<span id="cb219-32"><a href="#cb219-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope, </span>
<span id="cb219-33"><a href="#cb219-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> sse, <span class="at">group =</span> step),</span>
<span id="cb219-34"><a href="#cb219-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb219-35"><a href="#cb219-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight the optimal line</span></span>
<span id="cb219-36"><a href="#cb219-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> step_seq<span class="sc">$</span>intercept[optimal_step], </span>
<span id="cb219-37"><a href="#cb219-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> step_seq<span class="sc">$</span>slope[optimal_step],</span>
<span id="cb219-38"><a href="#cb219-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb219-39"><a href="#cb219-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb219-40"><a href="#cb219-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Journey Through the SSE Valley"</span>,</span>
<span id="cb219-41"><a href="#cb219-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The green line represents the OLS solution with minimum SSE"</span>,</span>
<span id="cb219-42"><a href="#cb219-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"SSE Value"</span>) <span class="sc">+</span></span>
<span id="cb219-43"><a href="#cb219-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb219-44"><a href="#cb219-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-45"><a href="#cb219-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an SSE valley plot</span></span>
<span id="cb219-46"><a href="#cb219-46" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(step_seq, <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> sse)) <span class="sc">+</span></span>
<span id="cb219-47"><a href="#cb219-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb219-48"><a href="#cb219-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">color =</span> sse)) <span class="sc">+</span></span>
<span id="cb219-49"><a href="#cb219-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb219-50"><a href="#cb219-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Highlight the optimal point</span></span>
<span id="cb219-51"><a href="#cb219-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> step_seq[optimal_step, ], <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> sse), </span>
<span id="cb219-52"><a href="#cb219-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb219-53"><a href="#cb219-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add annotation</span></span>
<span id="cb219-54"><a href="#cb219-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> optimal_step, <span class="at">y =</span> step_seq<span class="sc">$</span>sse[optimal_step] <span class="sc">*</span> <span class="fl">1.1</span>, </span>
<span id="cb219-55"><a href="#cb219-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Minimum SSE"</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb219-56"><a href="#cb219-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"The SSE Valley: Decreasing Then Increasing"</span>,</span>
<span id="cb219-57"><a href="#cb219-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The SSE reaches its minimum at the OLS solution"</span>,</span>
<span id="cb219-58"><a href="#cb219-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Step"</span>,</span>
<span id="cb219-59"><a href="#cb219-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sum of Squared Errors"</span>) <span class="sc">+</span></span>
<span id="cb219-60"><a href="#cb219-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb219-61"><a href="#cb219-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb219-62"><a href="#cb219-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-63"><a href="#cb219-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Display both plots</span></span>
<span id="cb219-64"><a href="#cb219-64" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p2, p3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_en_files/figure-html/sse-valley-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>SSE minimization visualization</figcaption>
</figure>
</div>
</div>
</div>
<p>In R, the <code>lm()</code> function fits linear regression models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
</section>
<section id="key-assumptions-of-linear-regression" class="level2" data-number="9.26">
<h2 data-number="9.26" class="anchored" data-anchor-id="key-assumptions-of-linear-regression"><span class="header-section-number">9.26</span> Key Assumptions of Linear Regression (*)</h2>
<section id="strict-exogeneity-the-fundamental-assumption" class="level3">
<h3 class="anchored" data-anchor-id="strict-exogeneity-the-fundamental-assumption">Strict Exogeneity: The Fundamental Assumption</h3>
<p>The most crucial assumption in regression is strict exogeneity:</p>
<p><span class="math display">E[\varepsilon|X] = 0</span></p>
<p>This means:</p>
<ol type="1">
<li>The error term has zero mean conditional on X</li>
<li>X contains no information about the average error</li>
<li>There are no systematic patterns in how our predictions are wrong</li>
</ol>
<p>Let’s visualize when this assumption holds and when it doesn’t:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: Exogenous errors</span></span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>y_exog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2: Non-exogenous errors (error variance increases with x)</span></span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>y_nonexog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a>data_exog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_exog,</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Exogenous Errors</span><span class="sc">\n</span><span class="st">(Assumption Satisfied)"</span></span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>data_nonexog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_nonexog,</span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Non-Exogenous Errors</span><span class="sc">\n</span><span class="st">(Assumption Violated)"</span></span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_exog, data_nonexog)</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots with residuals</span></span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>plot_residuals <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title)</span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Residuals"</span>)</span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1, p2)</span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate plots</span></span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a>plots_exog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_exog, <span class="st">"Exogenous Errors"</span>)</span>
<span id="cb221-49"><a href="#cb221-49" aria-hidden="true" tabindex="-1"></a>plots_nonexog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_nonexog, <span class="st">"Non-Exogenous Errors"</span>)</span>
<span id="cb221-50"><a href="#cb221-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-51"><a href="#cb221-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb221-52"><a href="#cb221-52" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb221-53"><a href="#cb221-53" aria-hidden="true" tabindex="-1"></a>  plots_exog[[<span class="dv">1</span>]], plots_exog[[<span class="dv">2</span>]],</span>
<span id="cb221-54"><a href="#cb221-54" aria-hidden="true" tabindex="-1"></a>  plots_nonexog[[<span class="dv">1</span>]], plots_nonexog[[<span class="dv">2</span>]],</span>
<span id="cb221-55"><a href="#cb221-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb221-56"><a href="#cb221-56" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exogeneity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-exogeneity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.9: Exogeneity vs.&nbsp;Non-Exogeneity Examples
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="linearity-the-form-assumption" class="level3">
<h3 class="anchored" data-anchor-id="linearity-the-form-assumption">Linearity: The Form Assumption</h3>
<p>The relationship between X and Y should be linear in parameters:</p>
<p><span class="math display">E[Y|X] = \beta_0 + \beta_1X</span></p>
<p>Note that this doesn’t mean X and Y must have a straight-line relationship - we can transform variables. Let’s see different types of relationships:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Different relationships</span></span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>data_relationships <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Linear</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Quadratic</span></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exponential</span></span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb223-16"><a href="#cb223-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Quadratic"</span>, <span class="st">"Exponential"</span>), <span class="at">each =</span> <span class="fu">length</span>(x))</span>
<span id="cb223-17"><a href="#cb223-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb223-18"><a href="#cb223-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-19"><a href="#cb223-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb223-20"><a href="#cb223-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_relationships, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb223-21"><a href="#cb223-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb223-22"><a href="#cb223-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb223-23"><a href="#cb223-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb223-24"><a href="#cb223-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb223-25"><a href="#cb223-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb223-26"><a href="#cb223-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Red: linear fit, Blue: true relationship"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-linearity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.10: Linear and Nonlinear Relationships
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="understanding-violations-and-solutions" class="level3">
<h3 class="anchored" data-anchor-id="understanding-violations-and-solutions">Understanding Violations and Solutions</h3>
<p>When linearity is violated:</p>
<ol type="1">
<li>Transform variables:
<ul>
<li>Log transformation: for exponential relationships</li>
<li>Square root: for moderate nonlinearity</li>
<li>Power transformations: for more complex relationships</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate exponential data</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">102</span>)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>data_trans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_y =</span> <span class="fu">log</span>(y)</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(y): NaNs produced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original scale plot</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Original Scale"</span>)</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale plot</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> log_y)) <span class="sc">+</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Transformed Y"</span>)</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-transformations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_en_files/figure-html/fig-transformations-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.11: Effect of Variable Transformations
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="spurious-correlation-causes-and-examples" class="level2" data-number="9.27">
<h2 data-number="9.27" class="anchored" data-anchor-id="spurious-correlation-causes-and-examples"><span class="header-section-number">9.27</span> Spurious Correlation: Causes and Examples</h2>
<p>Spurious correlation occurs when variables appear related but the relationship is not causal. These misleading correlations arise from several sources:</p>
<ul>
<li>Random coincidence (chance)</li>
<li>Confounding variables (hidden third factors)</li>
<li>Selection biases</li>
<li>Improper statistical analysis</li>
<li>Reverse causality</li>
<li>Endogeneity problems (including simultaneity)</li>
</ul>
<section id="random-coincidence-chance" class="level3">
<h3 class="anchored" data-anchor-id="random-coincidence-chance">Random Coincidence (Chance)</h3>
<p>With sufficient data mining or small sample sizes, seemingly meaningful correlations can emerge purely by chance. This is especially problematic when researchers conduct multiple analyses without appropriate corrections for multiple comparisons, a practice known as “p-hacking.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a realistic example of spurious correlation based on actual country data</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using country data on chocolate consumption and Nobel prize winners</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This example is inspired by a published correlation (Messerli, 2012)</span></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Switzerland"</span>, <span class="st">"Sweden"</span>, <span class="st">"Denmark"</span>, <span class="st">"Belgium"</span>, <span class="st">"Austria"</span>, </span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Norway"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Finland"</span>, </span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">"France"</span>, <span class="st">"Italy"</span>, <span class="st">"Spain"</span>, <span class="st">"Poland"</span>, <span class="st">"Greece"</span>, <span class="st">"Portugal"</span>)</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create realistic data: Chocolate consumption correlates with GDP per capita</span></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Higher GDP countries tend to consume more chocolate and have better research funding</span></span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a>gdp_per_capita <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">87097</span>, <span class="dv">58977</span>, <span class="dv">67218</span>, <span class="dv">51096</span>, <span class="dv">53879</span>, <span class="dv">89154</span>, <span class="dv">51860</span>, <span class="dv">57534</span>, </span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">46510</span>, <span class="dv">53982</span>, <span class="dv">43659</span>, <span class="dv">35551</span>, <span class="dv">30416</span>, <span class="dv">17841</span>, <span class="dv">20192</span>, <span class="dv">24567</span>)</span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize GDP values to make them more manageable</span></span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a>gdp_normalized <span class="ot">&lt;-</span> (gdp_per_capita <span class="sc">-</span> <span class="fu">min</span>(gdp_per_capita)) <span class="sc">/</span> </span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a>                 (<span class="fu">max</span>(gdp_per_capita) <span class="sc">-</span> <span class="fu">min</span>(gdp_per_capita))</span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a><span class="co"># More realistic chocolate consumption - loosely based on real consumption patterns</span></span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plus some randomness, but influenced by GDP</span></span>
<span id="cb231-20"><a href="#cb231-20" aria-hidden="true" tabindex="-1"></a>chocolate_consumption <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">8</span> <span class="sc">*</span> gdp_normalized <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="fl">0.8</span>)</span>
<span id="cb231-21"><a href="#cb231-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-22"><a href="#cb231-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Nobel prizes - also influenced by GDP (research funding) with noise</span></span>
<span id="cb231-23"><a href="#cb231-23" aria-hidden="true" tabindex="-1"></a><span class="co"># The relationship is non-linear, but will show up as correlated</span></span>
<span id="cb231-24"><a href="#cb231-24" aria-hidden="true" tabindex="-1"></a>nobel_prizes <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">12</span> <span class="sc">*</span> gdp_normalized<span class="sc">^</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb231-25"><a href="#cb231-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-26"><a href="#cb231-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe</span></span>
<span id="cb231-27"><a href="#cb231-27" aria-hidden="true" tabindex="-1"></a>country_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb231-28"><a href="#cb231-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">country =</span> countries,</span>
<span id="cb231-29"><a href="#cb231-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">chocolate =</span> <span class="fu">round</span>(chocolate_consumption, <span class="dv">1</span>),</span>
<span id="cb231-30"><a href="#cb231-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">nobel =</span> <span class="fu">round</span>(nobel_prizes, <span class="dv">1</span>),</span>
<span id="cb231-31"><a href="#cb231-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">gdp =</span> gdp_per_capita</span>
<span id="cb231-32"><a href="#cb231-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb231-33"><a href="#cb231-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-34"><a href="#cb231-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model - chocolate vs nobel without controlling for GDP</span></span>
<span id="cb231-35"><a href="#cb231-35" aria-hidden="true" tabindex="-1"></a>chocolate_nobel_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(nobel <span class="sc">~</span> chocolate, <span class="at">data =</span> country_data)</span>
<span id="cb231-36"><a href="#cb231-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-37"><a href="#cb231-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Better model that reveals the confounding</span></span>
<span id="cb231-38"><a href="#cb231-38" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(nobel <span class="sc">~</span> chocolate <span class="sc">+</span> gdp, <span class="at">data =</span> country_data)</span>
<span id="cb231-39"><a href="#cb231-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-40"><a href="#cb231-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the apparent relationship</span></span>
<span id="cb231-41"><a href="#cb231-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(country_data, <span class="fu">aes</span>(<span class="at">x =</span> chocolate, <span class="at">y =</span> nobel)) <span class="sc">+</span></span>
<span id="cb231-42"><a href="#cb231-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb231-43"><a href="#cb231-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb231-44"><a href="#cb231-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb231-45"><a href="#cb231-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb231-46"><a href="#cb231-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Apparent Correlation: Chocolate Consumption vs. Nobel Prizes"</span>,</span>
<span id="cb231-47"><a href="#cb231-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Demonstrates how confounding variables create spurious correlations"</span>,</span>
<span id="cb231-48"><a href="#cb231-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Chocolate Consumption (kg per capita)"</span>,</span>
<span id="cb231-49"><a href="#cb231-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Nobel Prizes per 10M Population"</span></span>
<span id="cb231-50"><a href="#cb231-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb231-51"><a href="#cb231-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/random_correlation-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show regression results</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(chocolate_nobel_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = nobel ~ chocolate, data = country_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9080 -1.4228  0.0294  0.5962  3.2977 

Coefficients:
            Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept)  -4.0518     1.3633  -2.972     0.0101 *  
chocolate     1.3322     0.1682   7.921 0.00000154 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.626 on 14 degrees of freedom
Multiple R-squared:  0.8176,    Adjusted R-squared:  0.8045 
F-statistic: 62.75 on 1 and 14 DF,  p-value: 0.000001536</code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate multiple testing problem</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate two completely random variables with n=20</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test for correlation and store p-value</span></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>  p_values[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)<span class="sc">$</span>p.value</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a><span class="co"># How many "significant" results at alpha = 0.05?</span></span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(p_values <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the multiple testing phenomenon</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p_values, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"P-values from 100 Tests of Random Data"</span>,</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"P-value"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"white"</span>)</span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.15</span>, <span class="dv">20</span>, <span class="fu">paste</span>(<span class="st">"Approximately"</span>, <span class="fu">sum</span>(p_values <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"tests are 'significant'</span><span class="sc">\n</span><span class="st">by random chance alone!"</span>), </span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/random_correlation-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example demonstrates how seemingly compelling correlations can emerge between unrelated variables due to confounding factors and chance. The correlation between chocolate consumption and Nobel prizes appears significant (p &lt; 0.05) when analyzed directly, even though it’s explained by a third variable - national wealth (GDP per capita).</p>
<p>Wealthier countries typically consume more chocolate and simultaneously invest more in education and research, leading to more Nobel prizes. Without controlling for this confounding factor, we would mistakenly conclude a direct relationship between chocolate and Nobel prizes.</p>
<p>The multiple testing demonstration further illustrates why spurious correlations appear so frequently in research. When conducting 100 statistical tests on completely random data, we expect approximately 5 “significant” results at α = 0.05 purely by chance. In real research settings where hundreds of variables might be analyzed, the probability of finding false positive correlations increases dramatically.</p>
<p>This example underscores three critical points:</p>
<ol type="1">
<li>Small sample sizes (16 countries) are particularly vulnerable to chance correlations</li>
<li>Confounding variables can create strong apparent associations between unrelated factors</li>
<li>Multiple testing without appropriate corrections virtually guarantees finding “significant” but meaningless patterns</li>
</ol>
<p>Such findings explain why replication is essential in research and why most initial “discoveries” fail to hold up in subsequent studies.</p>
</section>
<section id="confounding-variables-hidden-third-factors" class="level3">
<h3 class="anchored" data-anchor-id="confounding-variables-hidden-third-factors">Confounding Variables (Hidden Third Factors)</h3>
<p>Confounding occurs when an external variable influences both the predictor and outcome variables, creating an apparent relationship that may disappear when the confounder is accounted for.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>ability <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">100</span>, <span class="dv">15</span>)                       <span class="co"># Natural ability </span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> ability <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Education affected by ability</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="sc">+</span> <span class="dv">2000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="dv">100</span> <span class="sc">*</span> ability <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5000</span>)  <span class="co"># Income affected by both</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a>omitted_var_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb238-8"><a href="#cb238-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ability =</span> ability,</span>
<span id="cb238-9"><a href="#cb238-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> education,</span>
<span id="cb238-10"><a href="#cb238-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> income</span>
<span id="cb238-11"><a href="#cb238-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb238-12"><a href="#cb238-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-13"><a href="#cb238-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Model without accounting for ability</span></span>
<span id="cb238-14"><a href="#cb238-14" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> omitted_var_data)</span>
<span id="cb238-15"><a href="#cb238-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-16"><a href="#cb238-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Model accounting for ability</span></span>
<span id="cb238-17"><a href="#cb238-17" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> ability, <span class="at">data =</span> omitted_var_data)</span>
<span id="cb238-18"><a href="#cb238-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-19"><a href="#cb238-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb238-20"><a href="#cb238-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_naive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = income ~ education, data = omitted_var_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-14422.9  -3362.1    142.7   3647.7  14229.6 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  18982.0     2410.5   7.875    0.000000000000221 ***
education     2050.9      158.7  12.926 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5066 on 198 degrees of freedom
Multiple R-squared:  0.4576,    Adjusted R-squared:  0.4549 
F-statistic: 167.1 on 1 and 198 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = income ~ education + ability, data = omitted_var_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-12739.9  -3388.7    -41.1   3572.1  14976.8 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept) 13203.84    3018.85   4.374            0.0000198 ***
education    1871.43     166.03  11.272 &lt; 0.0000000000000002 ***
ability        85.60      27.87   3.071              0.00243 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4961 on 197 degrees of freedom
Multiple R-squared:  0.4824,    Adjusted R-squared:  0.4772 
F-statistic: 91.81 on 2 and 197 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization with ability shown through color</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(omitted_var_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income, <span class="at">color =</span> ability)) <span class="sc">+</span></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Ability Score"</span>) <span class="sc">+</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Income vs. Education, Colored by Ability"</span>,</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Visualizing the confounding variable"</span>,</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of Education"</span>,</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Annual Income (PLN)"</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/confounding_vis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example illustrates omitted variable bias: without accounting for ability, the estimated effect of education on income is exaggerated (2,423 PLN per year vs.&nbsp;1,962 PLN per year). The confounding occurs because ability influences both education and income, creating a spurious component in the observed correlation.</p>
<section id="classic-example-ice-cream-and-drownings" class="level4">
<h4 class="anchored" data-anchor-id="classic-example-ice-cream-and-drownings">Classic Example: Ice Cream and Drownings</h4>
<p>A classic example of confounding involves the correlation between ice cream sales and drowning incidents, both influenced by temperature:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">5</span>, <span class="dv">35</span>)  <span class="co"># Temperature in Celsius</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Both ice cream sales and drownings are influenced by temperature</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>ice_cream_sales <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>drownings <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>confounding_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> temperature,</span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice_cream_sales =</span> ice_cream_sales,</span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">drownings =</span> drownings</span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Model without controlling for temperature</span></span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream_sales, <span class="at">data =</span> confounding_data)</span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Model controlling for temperature</span></span>
<span id="cb244-19"><a href="#cb244-19" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream_sales <span class="sc">+</span> temperature, <span class="at">data =</span> confounding_data)</span>
<span id="cb244-20"><a href="#cb244-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-21"><a href="#cb244-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb244-22"><a href="#cb244-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_naive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = drownings ~ ice_cream_sales, data = confounding_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.8163 -0.7597  0.0118  0.7846  2.5797 

Coefficients:
                 Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)     -1.503063   0.370590  -4.056              0.0001 ***
ice_cream_sales  0.028074   0.001205  23.305 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.088 on 98 degrees of freedom
Multiple R-squared:  0.8471,    Adjusted R-squared:  0.8456 
F-statistic: 543.1 on 1 and 98 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = drownings ~ ice_cream_sales + temperature, data = confounding_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.85074 -0.61169  0.01186  0.60556  2.01776 

Coefficients:
                 Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept)      1.243785   0.530123   2.346         0.021 *  
ice_cream_sales -0.002262   0.004839  -0.467         0.641    
temperature      0.317442   0.049515   6.411 0.00000000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9169 on 97 degrees of freedom
Multiple R-squared:  0.8926,    Adjusted R-squared:  0.8904 
F-statistic: 403.2 on 2 and 97 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(confounding_data, <span class="fu">aes</span>(<span class="at">x =</span> ice_cream_sales, <span class="at">y =</span> drownings, <span class="at">color =</span> temperature)) <span class="sc">+</span></span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Temperature (°C)"</span>) <span class="sc">+</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"The Ice Cream and Drownings Correlation"</span>,</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Temperature as a confounding variable"</span>,</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Ice Cream Sales"</span>,</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Drowning Incidents"</span></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/ice_cream_drownings-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The naive model shows a statistically significant relationship between ice cream sales and drownings. However, once temperature is included in the model, the coefficient for ice cream sales decreases substantially and becomes statistically insignificant. This demonstrates how failing to account for confounding variables can lead to spurious correlations.</p>
</section>
</section>
<section id="reverse-causality" class="level3">
<h3 class="anchored" data-anchor-id="reverse-causality">Reverse Causality</h3>
<p>Reverse causality occurs when the assumed direction of causation is incorrect. Consider this example of anxiety and relaxation techniques:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>anxiety_level <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">10</span>)  <span class="co"># Anxiety level (1-10)</span></span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="co"># People with higher anxiety tend to use more relaxation techniques</span></span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>relaxation_techniques <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.7</span> <span class="sc">*</span> anxiety_level <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>reverse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">anxiety =</span> anxiety_level,</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">relaxation =</span> relaxation_techniques</span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models in both directions</span></span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true" tabindex="-1"></a>model_incorrect <span class="ot">&lt;-</span> <span class="fu">lm</span>(anxiety <span class="sc">~</span> relaxation, <span class="at">data =</span> reverse_data)</span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(relaxation <span class="sc">~</span> anxiety, <span class="at">data =</span> reverse_data)</span>
<span id="cb250-16"><a href="#cb250-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-17"><a href="#cb250-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show regression results</span></span>
<span id="cb250-18"><a href="#cb250-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_incorrect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = anxiety ~ relaxation, data = reverse_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9651 -0.7285 -0.0923  0.7247  3.7996 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept) -0.09482    0.21973  -0.432               0.667    
relaxation   1.15419    0.04105  28.114 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.182 on 198 degrees of freedom
Multiple R-squared:  0.7997,    Adjusted R-squared:  0.7987 
F-statistic: 790.4 on 1 and 198 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_correct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = relaxation ~ anxiety, data = reverse_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.15178 -0.51571 -0.00222  0.55513  2.04334 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  1.05726    0.15286   6.917      0.0000000000624 ***
anxiety      0.69284    0.02464  28.114 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9161 on 198 degrees of freedom
Multiple R-squared:  0.7997,    Adjusted R-squared:  0.7987 
F-statistic: 790.4 on 1 and 198 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reverse_data, <span class="fu">aes</span>(<span class="at">x =</span> relaxation, <span class="at">y =</span> anxiety)) <span class="sc">+</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Anxiety and Relaxation Techniques"</span>,</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Example of reverse causality"</span>,</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Use of Relaxation Techniques (frequency/week)"</span>,</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Anxiety Level (1-10 scale)"</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/reverse_causality-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Both regression models show statistically significant relationships, but they imply different causal mechanisms. The incorrect model suggests that relaxation techniques increase anxiety, while the correct model reflects the true data generating process: anxiety drives the use of relaxation techniques.</p>
</section>
<section id="collider-bias-selection-bias" class="level3">
<h3 class="anchored" data-anchor-id="collider-bias-selection-bias">Collider Bias (Selection Bias)</h3>
<p>Collider bias occurs when conditioning on a variable that is affected by both the independent and dependent variables of interest, creating an artificial relationship between variables that are actually independent.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate two independent variables (no relationship between them)</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>intelligence <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">100</span>, <span class="dv">15</span>)  <span class="co"># IQ score</span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>family_wealth <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">15</span>)  <span class="co"># Wealth score (independent from intelligence)</span></span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a><span class="co"># True data-generating process: admission depends on both intelligence and wealth</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>admission_score <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="sc">*</span> intelligence <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> family_wealth <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>admitted <span class="ot">&lt;-</span> admission_score <span class="sc">&gt;</span> <span class="fu">median</span>(admission_score)  <span class="co"># Binary admission variable</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create full dataset</span></span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>full_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">intelligence =</span> intelligence,</span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">wealth =</span> family_wealth,</span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">admission_score =</span> admission_score,</span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">admitted =</span> admitted</span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression in full population (true model)</span></span>
<span id="cb256-21"><a href="#cb256-21" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(intelligence <span class="sc">~</span> wealth, <span class="at">data =</span> full_data)</span>
<span id="cb256-22"><a href="#cb256-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(full_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = intelligence ~ wealth, data = full_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-49.608 -10.115   0.119  10.832  55.581 

Coefficients:
             Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept) 101.42330    1.73139   58.58 &lt;0.0000000000000002 ***
wealth       -0.02701    0.03334   -0.81               0.418    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.41 on 998 degrees of freedom
Multiple R-squared:  0.0006569, Adjusted R-squared:  -0.0003444 
F-statistic: 0.656 on 1 and 998 DF,  p-value: 0.4182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get just the admitted students</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>admitted_only <span class="ot">&lt;-</span> full_data[full_data<span class="sc">$</span>admitted, ]</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression in admitted students (conditioning on the collider)</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>admitted_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(intelligence <span class="sc">~</span> wealth, <span class="at">data =</span> admitted_only)</span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(admitted_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = intelligence ~ wealth, data = admitted_only)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.511  -9.064   0.721   8.965  48.267 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept) 115.4750     2.6165  44.133 &lt; 0.0000000000000002 ***
wealth       -0.1704     0.0462  -3.689              0.00025 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.91 on 498 degrees of freedom
Multiple R-squared:  0.0266,    Adjusted R-squared:  0.02464 
F-statistic: 13.61 on 1 and 498 DF,  p-value: 0.0002501</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional analysis - regression with the collider as a control variable</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This demonstrates how controlling for a collider introduces bias</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>collider_control_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(intelligence <span class="sc">~</span> wealth <span class="sc">+</span> admitted, <span class="at">data =</span> full_data)</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(collider_control_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = intelligence ~ wealth + admitted, data = full_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.729  -8.871   0.700   8.974  48.044 

Coefficients:
              Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  102.90069    1.56858  65.601 &lt; 0.0000000000000002 ***
wealth        -0.19813    0.03224  -6.145        0.00000000116 ***
admittedTRUE  14.09944    0.94256  14.959 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.93 on 997 degrees of freedom
Multiple R-squared:  0.1838,    Adjusted R-squared:  0.1822 
F-statistic: 112.3 on 2 and 997 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for full population</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(full_data, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> intelligence)) <span class="sc">+</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Full Population"</span>,</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Correlation:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(full_data<span class="sc">$</span>intelligence, full_data<span class="sc">$</span>wealth), <span class="dv">3</span>)),</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Family Wealth Score"</span>,</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Intelligence Score"</span></span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for admitted students</span></span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(admitted_only, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> intelligence)) <span class="sc">+</span></span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Admitted Students Only"</span>,</span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Correlation:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(admitted_only<span class="sc">$</span>intelligence, admitted_only<span class="sc">$</span>wealth), <span class="dv">3</span>)),</span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Family Wealth Score"</span>,</span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Intelligence Score"</span></span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots side by side</span></span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/collider_visualization-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This example demonstrates collider bias in three ways:</p>
<ol type="1">
<li>In the full population, intelligence and wealth have no relationship (coefficient near zero, p-value = 0.87)</li>
<li>Among admitted students (conditioning on the collider), a significant negative relationship appears (coefficient = -0.39, p-value &lt; 0.001)</li>
<li>When controlling for admission status in a regression, a spurious relationship is introduced (coefficient = -0.16, p-value &lt; 0.001)</li>
</ol>
<p>The collider bias creates relationships between variables that are truly independent. This can be represented in a directed acyclic graph (DAG):</p>
<p><span class="math display">\text{Intelligence} \rightarrow \text{Admission} \leftarrow \text{Wealth}</span></p>
<p>When we condition on admission (the collider), we create a spurious association between intelligence and wealth.</p>
</section>
<section id="improper-analysis" class="level3">
<h3 class="anchored" data-anchor-id="improper-analysis">Improper Analysis</h3>
<p>Inappropriate statistical methods can produce spurious correlations. Common issues include using linear models for non-linear relationships, ignoring data clustering, or mishandling time series data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with a true non-linear relationship</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> n)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># Quadratic relationship</span></span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>improper_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit incorrect linear model</span></span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>wrong_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> improper_data)</span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit correct quadratic model</span></span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a>correct_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> improper_data)</span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wrong_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = improper_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.2176 -2.1477 -0.6468  2.4365  7.3457 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  3.14689    0.28951  10.870 &lt;0.0000000000000002 ***
x            0.08123    0.16548   0.491               0.625    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.895 on 98 degrees of freedom
Multiple R-squared:  0.002453,  Adjusted R-squared:  -0.007726 
F-statistic: 0.2409 on 1 and 98 DF,  p-value: 0.6246</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(correct_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x + I(x^2), data = improper_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.81022 -0.65587  0.01935  0.61168  2.68894 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  0.12407    0.14498   0.856               0.394    
x            0.08123    0.05524   1.470               0.145    
I(x^2)       0.98766    0.03531  27.972 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9664 on 97 degrees of freedom
Multiple R-squared:   0.89, Adjusted R-squared:  0.8877 
F-statistic: 392.3 on 2 and 97 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(improper_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Improper Analysis Example"</span>,</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Linear model (red) vs. Quadratic model (green)"</span>,</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Variable X"</span>,</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Variable Y"</span></span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/improper_analysis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The linear model incorrectly suggests no relationship between x and y (coefficient near zero, p-value = 0.847), while the quadratic model reveals the true relationship (<span class="math inline">R^2 = 0.90</span>). This demonstrates how model misspecification can create spurious non-correlations, masking real relationships that exist in different forms.</p>
</section>
<section id="endogeneity-and-its-sources" class="level3">
<h3 class="anchored" data-anchor-id="endogeneity-and-its-sources">Endogeneity and Its Sources</h3>
<p>Endogeneity occurs when an explanatory variable is correlated with the error term in a regression model. This violates the exogeneity assumption of OLS regression and leads to biased estimates. There are several sources of endogeneity:</p>
<section id="omitted-variable-bias" class="level4">
<h4 class="anchored" data-anchor-id="omitted-variable-bias">Omitted Variable Bias</h4>
<p>As shown in the education-income example, when important variables are omitted from the model, their effects are absorbed into the error term, which becomes correlated with included variables.</p>
</section>
<section id="measurement-error" class="level4">
<h4 class="anchored" data-anchor-id="measurement-error">Measurement Error</h4>
<p>When variables are measured with error, the observed values differ from true values, creating correlation between the error term and the predictors.</p>
</section>
<section id="simultaneity-bidirectional-causality" class="level4">
<h4 class="anchored" data-anchor-id="simultaneity-bidirectional-causality">Simultaneity (Bidirectional Causality)</h4>
<p>When the dependent variable also affects the independent variable, creating a feedback loop. Let’s demonstrate this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data with mutual influence</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize variables</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>economic_growth <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>employment_rate <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">60</span>, <span class="dv">5</span>)</span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mutual influence through iterations</span></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>  economic_growth <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> employment_rate <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>  employment_rate <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> economic_growth <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a>simultaneity_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">growth =</span> economic_growth,</span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">employment =</span> employment_rate</span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimating effect of growth on employment</span></span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a>model_growth_on_emp <span class="ot">&lt;-</span> <span class="fu">lm</span>(employment <span class="sc">~</span> growth, <span class="at">data =</span> simultaneity_data)</span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-22"><a href="#cb270-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimating effect of employment on growth</span></span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true" tabindex="-1"></a>model_emp_on_growth <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> employment, <span class="at">data =</span> simultaneity_data)</span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_growth_on_emp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = employment ~ growth, data = simultaneity_data)

Residuals:
   Min     1Q Median     3Q    Max 
-3.603 -1.500 -0.099  1.387  5.673 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  49.9665     2.0717   24.12 &lt;0.0000000000000002 ***
growth        5.0151     0.3528   14.22 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.045 on 98 degrees of freedom
Multiple R-squared:  0.6734,    Adjusted R-squared:  0.6701 
F-statistic: 202.1 on 1 and 98 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_emp_on_growth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = growth ~ employment, data = simultaneity_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.11417 -0.20626 -0.02185  0.22646  0.72941 

Coefficients:
             Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept) -4.801257   0.749557  -6.405        0.00000000523 ***
employment   0.134283   0.009446  14.216 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3346 on 98 degrees of freedom
Multiple R-squared:  0.6734,    Adjusted R-squared:  0.6701 
F-statistic: 202.1 on 1 and 98 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(simultaneity_data, <span class="fu">aes</span>(<span class="at">x =</span> growth, <span class="at">y =</span> employment)) <span class="sc">+</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Simultaneity Between Economic Growth and Employment"</span>,</span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Economic Growth (%)"</span>,</span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Employment Rate (%)"</span></span>
<span id="cb274-9"><a href="#cb274-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb274-10"><a href="#cb274-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/simultaneity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The true data generating process is a system of simultaneous equations:</p>
<p><span class="math display">\text{Growth}_i = \alpha_0 + \alpha_1 \text{Employment}_i + u_i</span> <span class="math display">\text{Employment}_i = \beta_0 + \beta_1 \text{Growth}_i + v_i</span></p>
<p>Standard OLS regression cannot consistently estimate either equation because each explanatory variable is correlated with the error term in its respective equation.</p>
</section>
<section id="selection-bias" class="level4">
<h4 class="anchored">Selection Bias</h4>
<p>When the sample is not randomly selected from the population, the selection process can introduce correlation between the error term and the predictors. The collider bias example demonstrates a form of selection bias.</p>
<p>The consequences of endogeneity include: - Biased coefficient estimates - Incorrect standard errors - Invalid hypothesis tests - Misleading causal interpretations</p>
<p>Addressing endogeneity requires specialized methods such as instrumental variables, system estimation, panel data methods, or experimental designs.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding Endogeneity in Regression (*)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Endogeneity is a critical concept in statistical analysis that occurs when an explanatory variable in a regression model is correlated with the error term. This creates challenges for accurately understanding cause-and-effect relationships in research. Let’s examine the three main types of endogeneity and how they affect research outcomes.</p>
<section id="omitted-variable-bias-ovb" class="level3">
<h3 class="anchored" data-anchor-id="omitted-variable-bias-ovb">Omitted Variable Bias (OVB)</h3>
<p>Omitted Variable Bias occurs when an important variable that affects both the dependent and independent variables is left out of the analysis. This omission leads to incorrect conclusions about the relationship between the variables we’re studying.</p>
<p>Consider a study examining the relationship between education and income:</p>
<p><strong>Example: Education and Income</strong> The observed relationship shows that more education correlates with higher income. However, an individual’s inherent abilities affect both their educational attainment and their earning potential. Without accounting for ability, we may overestimate education’s direct effect on income.</p>
<p>The statistical representation shows why this matters:</p>
<p><span class="math inline">y_i = \beta_0 + \beta_1x_i + \beta_2z_i + \epsilon_i</span> (Complete model)</p>
<p><span class="math inline">y_i = \beta_0 + \beta_1x_i + u_i</span> (Incomplete model)</p>
<p>When we omit an important variable, our estimates of the remaining relationships become biased and unreliable.</p>
</section>
<section id="simultaneity" class="level3">
<h3 class="anchored" data-anchor-id="simultaneity">Simultaneity</h3>
<p>Simultaneity occurs when two variables simultaneously influence each other, making it difficult to determine the direction of causation. This creates a feedback loop that complicates statistical analysis.</p>
<p><strong>Common Examples of Simultaneity:</strong></p>
<p>Academic Performance and Study Habits represent a clear case of simultaneity. Academic performance influences how much time students dedicate to studying, while study time affects academic performance. This two-way relationship makes it challenging to measure the isolated effect of either variable.</p>
<p>Market Dynamics provide another example. Prices influence demand, while demand influences prices. This concurrent relationship requires special analytical approaches to understand the true relationships.</p>
</section>
<section id="measurement-error-1" class="level3">
<h3 class="anchored" data-anchor-id="measurement-error-1">Measurement Error</h3>
<p>Measurement error occurs when we cannot accurately measure our variables of interest. This imprecision can significantly impact our analysis and conclusions.</p>
<p><strong>Common Sources of Measurement Error:</strong></p>
<p>Self-Reported Data presents a significant challenge. When participants report their own behaviors or characteristics, such as study time, the reported values often differ from actual values. This discrepancy affects our ability to measure true relationships.</p>
<p>Technical Limitations also contribute to measurement error through imprecise measuring tools, inconsistent measurement conditions, and recording or data entry errors.</p>
</section>
<section id="addressing-endogeneity-in-research" class="level3">
<h3 class="anchored" data-anchor-id="addressing-endogeneity-in-research">Addressing Endogeneity in Research</h3>
<section id="identification-strategies" class="level4">
<h4 class="anchored" data-anchor-id="identification-strategies">Identification Strategies</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example of controlling for omitted variables</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>model_simple <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> df)</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> ability <span class="sc">+</span> experience <span class="sc">+</span> region, <span class="at">data =</span> df)</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare coefficients</span></span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_simple)</span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><p>Include Additional Variables: Collect data on potentially important omitted variables and include relevant control variables in your analysis. For example, including measures of ability when studying education’s effect on income.</p></li>
<li><p>Use Panel Data: Collect data across multiple time periods to control for unobserved fixed characteristics and analyze changes over time.</p></li>
<li><p>Instrumental Variables: Find variables that affect your independent variable but not your dependent variable to isolate the relationship of interest.</p></li>
</ol>
</section>
<section id="improving-measurement" class="level4">
<h4 class="anchored" data-anchor-id="improving-measurement">Improving Measurement</h4>
<ol type="1">
<li><p>Multiple Measurements: Take several measurements of key variables, use averaging to reduce random error, and compare different measurement methods.</p></li>
<li><p>Better Data Collection: Use validated measurement instruments, implement quality control procedures, and document potential sources of error.</p></li>
</ol>
</section>
</section>
<section id="best-practices-for-researchers" class="level3">
<h3 class="anchored" data-anchor-id="best-practices-for-researchers">Best Practices for Researchers</h3>
<p>Research Design fundamentally shapes your ability to address endogeneity. Plan for potential endogeneity issues before collecting data, include measures for potentially important control variables, and consider using multiple measurement approaches.</p>
<p>Analysis should include testing for endogeneity when possible, using appropriate statistical methods for your specific situation, and documenting assumptions and limitations.</p>
<p>Reporting must clearly describe potential endogeneity concerns, explain how you addressed these issues, and discuss implications for your conclusions.</p>
</section>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formal Derivation of OLS Estimators (*)
</div>
</div>
<div class="callout-body-container callout-body">
<section id="objective-and-setup" class="level3">
<h3 class="anchored" data-anchor-id="objective-and-setup">Objective and Setup</h3>
<p>We seek to find the values of <span class="math inline">\hat{\beta}_0</span> and <span class="math inline">\hat{\beta}_1</span> that minimize the sum of squared residuals:</p>
<p><span class="math display">SSE = \sum_{i=1}^n e_i^2 = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p>
<p>This is an unconstrained optimization problem where we treat SSE as a function of two variables: <span class="math inline">SSE(\hat{\beta}_0, \hat{\beta}_1)</span>.</p>
</section>
<section id="mathematical-prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="mathematical-prerequisites">Mathematical Prerequisites</h3>
<p><strong>Chain Rule for Composite Functions</strong>: For <span class="math inline">f(g(x))</span>, the derivative is: <span class="math display">\frac{d}{dx}[f(g(x))] = f'(g(x)) \cdot g'(x)</span></p>
<p>In our context:</p>
<ul>
<li>Outer function: <span class="math inline">f(u) = u^2</span> with derivative <span class="math inline">f'(u) = 2u</span></li>
<li>Inner function: <span class="math inline">u = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></li>
</ul>
<p><strong>First-Order Conditions</strong>: At a minimum, both partial derivatives equal zero: <span class="math display">\frac{\partial SSE}{\partial \hat{\beta}_0} = 0 \quad \text{and} \quad \frac{\partial SSE}{\partial \hat{\beta}_1} = 0</span></p>
</section>
<section id="derivation-of-hatbeta_0" class="level3">
<h3 class="anchored" data-anchor-id="derivation-of-hatbeta_0">Derivation of <span class="math inline">\hat{\beta}_0</span></h3>
<p><strong>Step 1</strong>: Take the partial derivative with respect to <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math display">\frac{\partial SSE}{\partial \hat{\beta}_0} = \frac{\partial}{\partial \hat{\beta}_0} \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)^2</span></p>
<p><strong>Step 2</strong>: Apply the chain rule to each term: <span class="math display">= \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) \cdot \frac{\partial}{\partial \hat{\beta}_0}(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)</span></p>
<p><span class="math display">= \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) \cdot (-1)</span></p>
<p><span class="math display">= -2\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)</span></p>
<p><strong>Step 3</strong>: Set equal to zero and solve: <span class="math display">-2\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p>
<p>Dividing by -2 and expanding: <span class="math display">\sum_{i=1}^n y_i - n\hat{\beta}_0 - \hat{\beta}_1\sum_{i=1}^n x_i = 0</span></p>
<p><strong>Step 4</strong>: Isolate <span class="math inline">\hat{\beta}_0</span>: <span class="math display">n\hat{\beta}_0 = \sum_{i=1}^n y_i - \hat{\beta}_1\sum_{i=1}^n x_i</span></p>
<p><span class="math display">\boxed{\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}}</span></p>
<p><strong>Interpretation</strong>: The intercept adjusts to ensure the regression line passes through the point of means <span class="math inline">(\bar{x}, \bar{y})</span>.</p>
</section>
<section id="derivation-of-hatbeta_1" class="level3">
<h3 class="anchored" data-anchor-id="derivation-of-hatbeta_1">Derivation of <span class="math inline">\hat{\beta}_1</span></h3>
<p><strong>Step 1</strong>: Take the partial derivative with respect to <span class="math inline">\hat{\beta}_1</span>:</p>
<p><span class="math display">\frac{\partial SSE}{\partial \hat{\beta}_1} = \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) \cdot (-x_i)</span></p>
<p><span class="math display">= -2\sum_{i=1}^n x_i(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)</span></p>
<p><strong>Step 2</strong>: Substitute the expression for <span class="math inline">\hat{\beta}_0</span>: <span class="math display">= -2\sum_{i=1}^n x_i(y_i - (\bar{y} - \hat{\beta}_1\bar{x}) - \hat{\beta}_1x_i)</span></p>
<p><span class="math display">= -2\sum_{i=1}^n x_i((y_i - \bar{y}) - \hat{\beta}_1(x_i - \bar{x}))</span></p>
<p><strong>Step 3</strong>: Set equal to zero and expand: <span class="math display">\sum_{i=1}^n x_i(y_i - \bar{y}) - \hat{\beta}_1\sum_{i=1}^n x_i(x_i - \bar{x}) = 0</span></p>
<p><strong>Step 4</strong>: Use the algebraic identity <span class="math inline">\sum_{i=1}^n x_i(y_i - \bar{y}) = \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})</span>:</p>
<p>This identity holds because: <span class="math display">\sum_{i=1}^n x_i(y_i - \bar{y}) = \sum_{i=1}^n (x_i - \bar{x} + \bar{x})(y_i - \bar{y})</span> <span class="math display">= \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) + \bar{x}\sum_{i=1}^n(y_i - \bar{y})</span> <span class="math display">= \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) + 0</span></p>
<p>Similarly, <span class="math inline">\sum_{i=1}^n x_i(x_i - \bar{x}) = \sum_{i=1}^n (x_i - \bar{x})^2</span>.</p>
<p><strong>Step 5</strong>: Solve for <span class="math inline">\hat{\beta}_1</span>: <span class="math display">\hat{\beta}_1\sum_{i=1}^n (x_i - \bar{x})^2 = \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})</span></p>
<p><span class="math display">\boxed{\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2} = \frac{\text{Cov}(X,Y)}{\text{Var}(X)}}</span></p>
</section>
<section id="verification-of-minimum-second-order-conditions" class="level3">
<h3 class="anchored" data-anchor-id="verification-of-minimum-second-order-conditions">Verification of Minimum (Second-Order Conditions)</h3>
<p>To confirm we have found a minimum (not a maximum or saddle point), we examine the Hessian matrix of second partial derivatives:</p>
<p><strong>Second partial derivatives</strong>:</p>
<p><span class="math display">\frac{\partial^2 SSE}{\partial \hat{\beta}_0^2} = 2n &gt; 0</span></p>
<p><span class="math display">\frac{\partial^2 SSE}{\partial \hat{\beta}_1^2} = 2\sum_{i=1}^n x_i^2 &gt; 0</span></p>
<p><span class="math display">\frac{\partial^2 SSE}{\partial \hat{\beta}_0 \partial \hat{\beta}_1} = 2\sum_{i=1}^n x_i</span></p>
<p><strong>Hessian matrix</strong>: <span class="math display">\mathbf{H} = 2\begin{bmatrix} n &amp; \sum_{i=1}^n x_i \\ \sum_{i=1}^n x_i &amp; \sum_{i=1}^n x_i^2 \end{bmatrix}</span></p>
<p><strong>Positive definiteness check</strong>:</p>
<ul>
<li>First leading principal minor: <span class="math inline">2n &gt; 0</span> ✓</li>
<li>Second leading principal minor (determinant): <span class="math display">\det(\mathbf{H}) = 4\left(n\sum_{i=1}^n x_i^2 - \left(\sum_{i=1}^n x_i\right)^2\right) = 4n\sum_{i=1}^n(x_i - \bar{x})^2 &gt; 0</span> ✓</li>
</ul>
<p>Since the Hessian is positive definite, we have confirmed a minimum.</p>
</section>
<section id="geometric-interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="geometric-interpretation-1">Geometric Interpretation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the optimization surface</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create grid of beta values</span></span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>beta0_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>beta1_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">beta0 =</span> beta0_seq, <span class="at">beta1 =</span> beta1_seq)</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SSE for each combination</span></span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">$</span>SSE <span class="ot">&lt;-</span> <span class="fu">apply</span>(grid, <span class="dv">1</span>, <span class="cf">function</span>(params) {</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((y <span class="sc">-</span> (params[<span class="dv">1</span>] <span class="sc">+</span> params[<span class="dv">2</span>]<span class="sc">*</span>x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-16"><a href="#cb282-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create contour plot</span></span>
<span id="cb282-17"><a href="#cb282-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grid, <span class="fu">aes</span>(<span class="at">x =</span> beta0, <span class="at">y =</span> beta1, <span class="at">z =</span> SSE)) <span class="sc">+</span></span>
<span id="cb282-18"><a href="#cb282-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">after_stat</span>(level))) <span class="sc">+</span></span>
<span id="cb282-19"><a href="#cb282-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">1</span>], </span>
<span id="cb282-20"><a href="#cb282-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">2</span>], </span>
<span id="cb282-21"><a href="#cb282-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb282-22"><a href="#cb282-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SSE Surface in Parameter Space"</span>,</span>
<span id="cb282-23"><a href="#cb282-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Red point shows the OLS minimum"</span>,</span>
<span id="cb282-24"><a href="#cb282-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">0</span>]),</span>
<span id="cb282-25"><a href="#cb282-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta)[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb282-26"><a href="#cb282-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data" class="level2" data-number="9.28">
<h2 data-number="9.28" class="anchored" data-anchor-id="appendix-a.1-understanding-correlation-measures-a-self-study-tutorial-using-stress-level-and-cognitive-performance-data"><span class="header-section-number">9.28</span> Appendix A.1: Understanding Correlation Measures: A Self-Study Tutorial (Using Stress Level and Cognitive Performance Data)</h2>
<section id="dataset-overview" class="level3">
<h3 class="anchored" data-anchor-id="dataset-overview">Dataset Overview</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">anxiety_level =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">14</span>, <span class="dv">7</span>, <span class="dv">10</span>),</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">cognitive_performance =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">62</span>, <span class="dv">55</span>, <span class="dv">80</span>, <span class="dv">65</span>)</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="covariance-calculation" class="level3">
<h3 class="anchored" data-anchor-id="covariance-calculation">1. Covariance Calculation</h3>
<section id="step-1-calculate-means" class="level4">
<h4 class="anchored" data-anchor-id="step-1-calculate-means">Step 1: Calculate Means</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 50%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Calculation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean Anxiety (<span class="math inline">\bar{x}</span>)</td>
<td><span class="math inline">(8 + 5 + 11 + 14 + 7 + 10) ÷ 6</span></td>
<td>9.17</td>
</tr>
<tr class="even">
<td>Mean Cognitive (<span class="math inline">\bar{y}</span>)</td>
<td><span class="math inline">(85 + 90 + 62 + 55 + 80 + 65) ÷ 6</span></td>
<td>72.83</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-calculate-deviations-and-products" class="level4">
<h4 class="anchored" data-anchor-id="step-2-calculate-deviations-and-products">Step 2: Calculate Deviations and Products</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">(x_i - \bar{x})</span></th>
<th><span class="math inline">(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>8</td>
<td>85</td>
<td>-1.17</td>
<td>12.17</td>
<td>-14.24</td>
</tr>
<tr class="even">
<td>2</td>
<td>5</td>
<td>90</td>
<td>-4.17</td>
<td>17.17</td>
<td>-71.60</td>
</tr>
<tr class="odd">
<td>3</td>
<td>11</td>
<td>62</td>
<td>1.83</td>
<td>-10.83</td>
<td>-19.82</td>
</tr>
<tr class="even">
<td>4</td>
<td>14</td>
<td>55</td>
<td>4.83</td>
<td>-17.83</td>
<td>-86.12</td>
</tr>
<tr class="odd">
<td>5</td>
<td>7</td>
<td>80</td>
<td>-2.17</td>
<td>7.17</td>
<td>-15.56</td>
</tr>
<tr class="even">
<td>6</td>
<td>10</td>
<td>65</td>
<td>0.83</td>
<td>-7.83</td>
<td>-6.50</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>55</td>
<td>437</td>
<td>0.00</td>
<td>0.00</td>
<td>-213.84</td>
</tr>
</tbody>
</table>
</section>
<section id="step-3-calculate-covariance" class="level4">
<h4 class="anchored" data-anchor-id="step-3-calculate-covariance">Step 3: Calculate Covariance</h4>
<p><span class="math display"> \text{Cov}(X,Y) = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{n-1} = \frac{-213.84}{5} = -42.77 </span></p>
</section>
</section>
<section id="pearson-correlation-coefficient-1" class="level3">
<h3 class="anchored" data-anchor-id="pearson-correlation-coefficient-1">2. Pearson Correlation Coefficient</h3>
<section id="step-1-calculate-squared-deviations" class="level4">
<h4 class="anchored" data-anchor-id="step-1-calculate-squared-deviations">Step 1: Calculate Squared Deviations</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">(x_i - \bar{x})</span></th>
<th><span class="math inline">(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-1.17</td>
<td>12.17</td>
<td>1.37</td>
<td>148.11</td>
</tr>
<tr class="even">
<td>2</td>
<td>-4.17</td>
<td>17.17</td>
<td>17.39</td>
<td>294.81</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1.83</td>
<td>-10.83</td>
<td>3.35</td>
<td>117.29</td>
</tr>
<tr class="even">
<td>4</td>
<td>4.83</td>
<td>-17.83</td>
<td>23.33</td>
<td>317.91</td>
</tr>
<tr class="odd">
<td>5</td>
<td>-2.17</td>
<td>7.17</td>
<td>4.71</td>
<td>51.41</td>
</tr>
<tr class="even">
<td>6</td>
<td>0.83</td>
<td>-7.83</td>
<td>0.69</td>
<td>61.31</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>0.00</td>
<td>0.00</td>
<td>50.84</td>
<td>990.84</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-calculate-standard-deviations" class="level4">
<h4 class="anchored" data-anchor-id="step-2-calculate-standard-deviations">Step 2: Calculate Standard Deviations</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Measure</th>
<th>Formula</th>
<th>Calculation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">s_x</span></td>
<td><span class="math inline">\sqrt{\frac{\sum (x_i - \bar{x})^2}{n-1}}</span></td>
<td><span class="math inline">\sqrt{\frac{50.84}{5}}</span></td>
<td>3.19</td>
</tr>
<tr class="even">
<td><span class="math inline">s_y</span></td>
<td><span class="math inline">\sqrt{\frac{\sum (y_i - \bar{y})^2}{n-1}}</span></td>
<td><span class="math inline">\sqrt{\frac{990.84}{5}}</span></td>
<td>14.08</td>
</tr>
</tbody>
</table>
</section>
<section id="step-3-calculate-pearson-correlation" class="level4">
<h4 class="anchored" data-anchor-id="step-3-calculate-pearson-correlation">Step 3: Calculate Pearson Correlation</h4>
<p><span class="math display"> r = \frac{\text{Cov}(X,Y)}{s_x s_y} = \frac{-42.77}{3.19 \times 14.08} = -0.95 </span></p>
</section>
</section>
<section id="spearman-rank-correlation" class="level3">
<h3 class="anchored" data-anchor-id="spearman-rank-correlation">3. Spearman Rank Correlation</h3>
<section id="step-1-assign-ranks" class="level4">
<h4 class="anchored" data-anchor-id="step-1-assign-ranks">Step 1: Assign Ranks</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th>Rank <span class="math inline">x_i</span></th>
<th>Rank <span class="math inline">y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>8</td>
<td>85</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>5</td>
<td>90</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>11</td>
<td>62</td>
<td>5</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>14</td>
<td>55</td>
<td>6</td>
<td>6</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>5</td>
<td>7</td>
<td>80</td>
<td>2</td>
<td>3</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>10</td>
<td>65</td>
<td>4</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>2</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-calculate-spearman-correlation" class="level4">
<h4 class="anchored" data-anchor-id="step-2-calculate-spearman-correlation">Step 2: Calculate Spearman Correlation</h4>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} = 1 - \frac{6(2)}{6(36-1)} = 1 - \frac{12}{210} = 0.94 </span></p>
</section>
</section>
<section id="verification-using-r" class="level3">
<h3 class="anchored" data-anchor-id="verification-using-r">Verification using R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations using R</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>anxiety_level, data<span class="sc">$</span>cognitive_performance, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9527979</code></pre>
</div>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>anxiety_level, data<span class="sc">$</span>cognitive_performance, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9428571</code></pre>
</div>
</div>
</section>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<ol type="1">
<li><p>The strong negative Pearson correlation (r = -0.95) indicates a very strong negative linear relationship between anxiety level and cognitive performance.</p></li>
<li><p>The strong positive Spearman correlation (ρ = 0.94) shows that the relationship is also strongly monotonic.</p></li>
<li><p>The difference between Pearson and Spearman correlations suggests that while there is a strong relationship, it might not be perfectly linear.</p></li>
</ol>
</section>
<section id="exercise" class="level3">
<h3 class="anchored" data-anchor-id="exercise">Exercise</h3>
<ol type="1">
<li>Verify each calculation step in the tables above.</li>
<li>Try calculating these measures with a modified dataset:
<ul>
<li>Add one outlier and observe how it affects both correlation coefficients</li>
<li>Change one pair of values and recalculate</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-a.2-calculating-covariance-pearson-spearman-correlation-and-ols---worked-example" class="level2" data-number="9.29">
<h2 data-number="9.29" class="anchored" data-anchor-id="appendix-a.2-calculating-covariance-pearson-spearman-correlation-and-ols---worked-example"><span class="header-section-number">9.29</span> Appendix A.2: Calculating Covariance, Pearson, Spearman Correlation, and OLS - worked example</h2>
<p>A political science student is investigating the relationship between district magnitude (DM) and Gallagher’s disproportionality index (GH) in parliamentary elections across 10 randomly selected democracies.</p>
<p>Data on electoral district magnitudes (<span class="math inline">\text{DM}</span>) and Gallagher index:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\text{DM}</span> (<span class="math inline">X</span>)</th>
<th>Gallagher (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18.2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16.7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15.8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15.3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15.0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14.8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14.7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14.6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14.55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14.52</td>
</tr>
</tbody>
</table>
<section id="step-1-calculate-basic-statistics" class="level3">
<h3 class="anchored" data-anchor-id="step-1-calculate-basic-statistics">Step 1: Calculate Basic Statistics</h3>
<p>Calculation of means:</p>
<p>For <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n}</span></p>
<p>Detailed calculation:</p>
<p><span class="math display">2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65</span> <span class="math display">\bar{x} = \frac{65}{10} = 6.5</span></p>
<p>For Gallagher index (<span class="math inline">Y</span>): <span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}</span></p>
<p>Detailed calculation:</p>
<p><span class="math display">18.2 + 16.7 + 15.8 + 15.3 + 15.0 + 14.8 + 14.7 + 14.6 + 14.55 + 14.52 = 154.17</span> <span class="math display">\bar{y} = \frac{154.17}{10} = 15.417</span></p>
</section>
<section id="step-2-detailed-covariance-calculations" class="level3">
<h3 class="anchored" data-anchor-id="step-2-detailed-covariance-calculations">Step 2: Detailed Covariance Calculations</h3>
<p>Complete working table showing all calculations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td><span class="math inline">-4.5</span></td>
<td>2.783</td>
<td><span class="math inline">-12.5235</span></td>
<td>20.25</td>
<td>7.7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td><span class="math inline">-3.5</span></td>
<td>1.283</td>
<td><span class="math inline">-4.4905</span></td>
<td>12.25</td>
<td>1.6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td><span class="math inline">-2.5</span></td>
<td>0.383</td>
<td><span class="math inline">-0.9575</span></td>
<td>6.25</td>
<td>0.1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td><span class="math inline">-1.5</span></td>
<td><span class="math inline">-0.117</span></td>
<td>0.1755</td>
<td>2.25</td>
<td>0.0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td><span class="math inline">-0.5</span></td>
<td><span class="math inline">-0.417</span></td>
<td>0.2085</td>
<td>0.25</td>
<td>0.1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>0.5</td>
<td><span class="math inline">-0.617</span></td>
<td><span class="math inline">-0.3085</span></td>
<td>0.25</td>
<td>0.3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>1.5</td>
<td><span class="math inline">-0.717</span></td>
<td><span class="math inline">-1.0755</span></td>
<td>2.25</td>
<td>0.5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>2.5</td>
<td><span class="math inline">-0.817</span></td>
<td><span class="math inline">-2.0425</span></td>
<td>6.25</td>
<td>0.6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>3.5</td>
<td><span class="math inline">-0.867</span></td>
<td><span class="math inline">-3.0345</span></td>
<td>12.25</td>
<td>0.7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>4.5</td>
<td><span class="math inline">-0.897</span></td>
<td><span class="math inline">-4.0365</span></td>
<td>20.25</td>
<td>0.8047</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>65</td>
<td>154.17</td>
<td>0</td>
<td>0</td>
<td><span class="math inline">-28.085</span></td>
<td>82.5</td>
<td>12.8442</td>
</tr>
</tbody>
</table>
<p>Covariance calculation: <span class="math display">\text{Cov}(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p><span class="math display">\text{Cov}(X,Y) = \frac{-28.085}{9} = -3.120556</span></p>
</section>
<section id="step-3-standard-deviation-calculations" class="level3">
<h3 class="anchored" data-anchor-id="step-3-standard-deviation-calculations">Step 3: Standard Deviation Calculations</h3>
<p>For <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_x = \sqrt{\frac{82.5}{9}} = \sqrt{9.1667} = 3.026582</span></p>
<p>For Gallagher (<span class="math inline">Y</span>): <span class="math display">\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_y = \sqrt{\frac{12.8442}{9}} = \sqrt{1.4271} = 1.194612</span></p>
</section>
<section id="step-4-pearson-correlation-calculation" class="level3">
<h3 class="anchored" data-anchor-id="step-4-pearson-correlation-calculation">Step 4: Pearson Correlation Calculation</h3>
<p><span class="math display">r = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y}</span></p>
<p><span class="math display">r = \frac{-3.120556}{3.026582 \times 1.194612} = \frac{-3.120556}{3.615752} = -0.863044</span></p>
</section>
<section id="step-5-spearman-rank-correlation-calculation" class="level3">
<h3 class="anchored" data-anchor-id="step-5-spearman-rank-correlation-calculation">Step 5: Spearman Rank Correlation Calculation</h3>
<p>Complete ranking table with all calculations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th>Rank <span class="math inline">X_i</span></th>
<th>Rank <span class="math inline">Y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>1</td>
<td>10</td>
<td><span class="math inline">-9</span></td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>2</td>
<td>9</td>
<td><span class="math inline">-7</span></td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>3</td>
<td>8</td>
<td><span class="math inline">-5</span></td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>4</td>
<td>7</td>
<td><span class="math inline">-3</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>5</td>
<td>6</td>
<td><span class="math inline">-1</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Spearman correlation calculation: <span class="math display">\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></p>
<p><span class="math display">\rho = 1 - \frac{6 \times 330}{10(100 - 1)} = 1 - \frac{1980}{990} = 1 - 2 = -1</span></p>
</section>
<section id="step-6-r-verification" class="level3">
<h3 class="anchored" data-anchor-id="step-6-r-verification">Step 6: R Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create vectors</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate covariance</span></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="step-7-basic-visualization" class="level3">
<h3 class="anchored" data-anchor-id="step-7-basic-visualization">Step 7: Basic Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb294"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb294-2"><a href="#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb294-4"><a href="#cb294-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb294-5"><a href="#cb294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-6"><a href="#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatter plot</span></span>
<span id="cb294-7"><a href="#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb294-8"><a href="#cb294-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb294-9"><a href="#cb294-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb294-10"><a href="#cb294-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb294-11"><a href="#cb294-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"District Magnitude vs Gallagher Index"</span>,</span>
<span id="cb294-12"><a href="#cb294-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude (DM)"</span>,</span>
<span id="cb294-13"><a href="#cb294-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index (GH)"</span></span>
<span id="cb294-14"><a href="#cb294-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb294-15"><a href="#cb294-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ols-estimation-and-goodness-of-fit-measures" class="level3">
<h3 class="anchored" data-anchor-id="ols-estimation-and-goodness-of-fit-measures">OLS Estimation and Goodness-of-Fit Measures</h3>
</section>
<section id="step-1-calculate-ols-estimates" class="level3">
<h3 class="anchored" data-anchor-id="step-1-calculate-ols-estimates">Step 1: Calculate OLS Estimates</h3>
<p>Using previously calculated values:</p>
<ul>
<li><span class="math inline">\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28.085</span></li>
<li><span class="math inline">\sum(X_i - \bar{X})^2 = 82.5</span></li>
<li><span class="math inline">\bar{X} = 6.5</span></li>
<li><span class="math inline">\bar{Y} = 15.417</span></li>
</ul>
<p>Calculate slope (<span class="math inline">\hat{\beta_1}</span>): <span class="math inline">\hat{\beta_1} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta_1} = -28,085 ÷ 82,5 = -0,3404</span></p>
<p>Calculate intercept (<span class="math inline">\hat{\beta_0}</span>): <span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</span></p>
<p>Therefore, the OLS regression equation is: <span class="math inline">\hat{Y} = 17.6296 - 0.3404X</span></p>
</section>
<section id="step-2-calculate-fitted-values-and-residuals" class="level3">
<h3 class="anchored" data-anchor-id="step-2-calculate-fitted-values-and-residuals">Step 2: Calculate Fitted Values and Residuals</h3>
<p>Complete table showing all calculations:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">e_i^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>16.9488</td>
<td>1.2512</td>
<td>1.5655</td>
<td>7.7451</td>
<td>2.3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>16.6084</td>
<td>0.0916</td>
<td>0.0084</td>
<td>1.6461</td>
<td>1.4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>16.2680</td>
<td>-0.4680</td>
<td>0.2190</td>
<td>0.1467</td>
<td>0.7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>15.9276</td>
<td>-0.6276</td>
<td>0.3939</td>
<td>0.0137</td>
<td>0.2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>15.5872</td>
<td>-0.5872</td>
<td>0.3448</td>
<td>0.1739</td>
<td>0.0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>15.2468</td>
<td>-0.4468</td>
<td>0.1996</td>
<td>0.3807</td>
<td>0.0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>14.9064</td>
<td>-0.2064</td>
<td>0.0426</td>
<td>0.5141</td>
<td>0.2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>14.5660</td>
<td>0.0340</td>
<td>0.0012</td>
<td>0.6675</td>
<td>0.7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>14.2256</td>
<td>0.3244</td>
<td>0.1052</td>
<td>0.7517</td>
<td>1.4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>13.8852</td>
<td>0.6348</td>
<td>0.4030</td>
<td>0.8047</td>
<td>2.3439</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>65</td>
<td>154.17</td>
<td>154.17</td>
<td>0</td>
<td>3.2832</td>
<td>12.8442</td>
<td>9.5524</td>
</tr>
</tbody>
</table>
<p>Calculations for fitted values:</p>
<pre><code>For X = 2:
Ŷ = 17.6296 + (-0.3404 × 2) = 16.9488

For X = 3:
Ŷ = 17.6296 + (-0.3404 × 3) = 16.6084

[... continue for all values]</code></pre>
</section>
<section id="step-3-calculate-goodness-of-fit-measures" class="level3">
<h3 class="anchored" data-anchor-id="step-3-calculate-goodness-of-fit-measures">Step 3: Calculate Goodness-of-Fit Measures</h3>
<p>Sum of Squared Errors (SSE): <span class="math inline">SSE = \sum e_i^2</span></p>
<pre><code>SSE = 3.2832</code></pre>
<p>Sum of Squared Total (SST): <span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<pre><code>SST = 12.8442</code></pre>
<p>Sum of Squared Regression (SSR): <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<pre><code>SSR = 9.5524</code></pre>
<p>Verify decomposition: <span class="math inline">SST = SSR + SSE</span></p>
<pre><code>12.8442 = 9.5524 + 3.2832 (within rounding error)</code></pre>
<p>R-squared calculation: <span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<pre><code>R² = 9.5524 ÷ 12.8442
   = 0.7438</code></pre>
</section>
<section id="step-4-r-verification" class="level3">
<h3 class="anchored" data-anchor-id="step-4-r-verification">Step 4: R Verification</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear model</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View summary statistics</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 0.000000000467 ***
DM          -0.34042    0.07053  -4.827        0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate R-squared manually</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="step-5-residual-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-5-residual-analysis">Step 5: Residual Analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create residual plots</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-6-predicted-vs-actual-values-plot" class="level3">
<h3 class="anchored" data-anchor-id="step-6-predicted-vs-actual-values-plot">Step 6: Predicted vs Actual Values Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create predicted vs actual plot</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actual =</span> GH,</span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Predicted, <span class="at">y =</span> Actual)) <span class="sc">+</span></span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb307-9"><a href="#cb307-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted vs Actual Values"</span>,</span>
<span id="cb307-10"><a href="#cb307-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predicted Gallagher Index"</span>,</span>
<span id="cb307-11"><a href="#cb307-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Actual Gallagher Index"</span></span>
<span id="cb307-12"><a href="#cb307-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb307-13"><a href="#cb307-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="log-transformed-models" class="level3">
<h3 class="anchored" data-anchor-id="log-transformed-models">Log-Transformed Models</h3>
</section>
<section id="step-1-data-transformation" class="level3">
<h3 class="anchored" data-anchor-id="step-1-data-transformation">Step 1: Data Transformation</h3>
<p>First, calculate natural logarithms of variables:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\ln(X_i)</span></th>
<th><span class="math inline">\ln(Y_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18.2</td>
<td>0.6931</td>
<td>2.9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16.7</td>
<td>1.0986</td>
<td>2.8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15.8</td>
<td>1.3863</td>
<td>2.7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15.3</td>
<td>1.6094</td>
<td>2.7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15.0</td>
<td>1.7918</td>
<td>2.7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14.8</td>
<td>1.9459</td>
<td>2.6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14.7</td>
<td>2.0794</td>
<td>2.6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14.6</td>
<td>2.1972</td>
<td>2.6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14.55</td>
<td>2.3026</td>
<td>2.6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14.52</td>
<td>2.3979</td>
<td>2.6757</td>
</tr>
</tbody>
</table>
</section>
<section id="step-2-compare-different-model-specifications" class="level3">
<h3 class="anchored" data-anchor-id="step-2-compare-different-model-specifications">Step 2: Compare Different Model Specifications</h3>
<p>We estimate three alternative specifications:</p>
<ol type="1">
<li>Log-linear model: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i</span></li>
<li>Linear-log model: <span class="math inline">Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
<li>Log-log model: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create transformed variables</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare R-squared values</span></span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb308-13"><a href="#cb308-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Log-linear"</span>, <span class="st">"Linear-log"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb308-14"><a href="#cb308-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb308-15"><a href="#cb308-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb308-16"><a href="#cb308-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb308-17"><a href="#cb308-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb308-18"><a href="#cb308-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb308-19"><a href="#cb308-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb308-20"><a href="#cb308-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb308-21"><a href="#cb308-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-22"><a href="#cb308-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display comparison</span></span>
<span id="cb308-23"><a href="#cb308-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Model R_squared
1     Linear 0.7443793
2 Log-linear 0.7670346
3 Linear-log 0.9141560
4    Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="step-3-visual-comparison" class="level3">
<h3 class="anchored" data-anchor-id="step-3-visual-comparison">Step 3: Visual Comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots for each model</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb310-4"><a href="#cb310-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb310-5"><a href="#cb310-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear Model"</span>) <span class="sc">+</span></span>
<span id="cb310-6"><a href="#cb310-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb310-7"><a href="#cb310-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-8"><a href="#cb310-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb310-9"><a href="#cb310-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb310-10"><a href="#cb310-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb310-11"><a href="#cb310-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-linear Model"</span>) <span class="sc">+</span></span>
<span id="cb310-12"><a href="#cb310-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb310-13"><a href="#cb310-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-14"><a href="#cb310-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb310-15"><a href="#cb310-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb310-16"><a href="#cb310-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb310-17"><a href="#cb310-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear-log Model"</span>) <span class="sc">+</span></span>
<span id="cb310-18"><a href="#cb310-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb310-19"><a href="#cb310-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-20"><a href="#cb310-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb310-21"><a href="#cb310-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb310-22"><a href="#cb310-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb310-23"><a href="#cb310-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-log Model"</span>) <span class="sc">+</span></span>
<span id="cb310-24"><a href="#cb310-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb310-25"><a href="#cb310-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-26"><a href="#cb310-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in a grid</span></span>
<span id="cb310-27"><a href="#cb310-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb310-28"><a href="#cb310-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-4-residual-analysis-for-best-model" class="level3">
<h3 class="anchored" data-anchor-id="step-4-residual-analysis-for-best-model">Step 4: Residual Analysis for Best Model</h3>
<p>Based on R-squared values, analyze residuals for the best-fitting model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual plots for best model</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-5-interpretation-of-best-model" class="level3">
<h3 class="anchored" data-anchor-id="step-5-interpretation-of-best-model">Step 5: Interpretation of Best Model</h3>
<p>The linear-log model coefficients:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value        Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 0.0000000000494 ***
log_DM       -2.0599     0.2232   -9.23 0.0000153880425 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 0.00001539</code></pre>
</div>
</div>
<p>Interpretation: - <span class="math inline">\hat{\beta_0}</span> represents the expected Gallagher Index when ln(DM) = 0 (i.e., when DM = 1) - <span class="math inline">\hat{\beta_1}</span> represents the change in Gallagher Index associated with a one-unit increase in ln(DM)</p>
</section>
<section id="step-6-model-predictions" class="level3">
<h3 class="anchored" data-anchor-id="step-6-model-predictions">Step 6: Model Predictions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction plot for best model</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Linear-log Model: Gallagher Index vs ln(District Magnitude)"</span>,</span>
<span id="cb315-7"><a href="#cb315-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(District Magnitude)"</span>,</span>
<span id="cb315-8"><a href="#cb315-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span></span>
<span id="cb315-9"><a href="#cb315-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb315-10"><a href="#cb315-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-7-elasticity-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-7-elasticity-analysis">Step 7: Elasticity Analysis</h3>
<p>For the log-log model, coefficients represent elasticities directly. Calculate average elasticity for the linear-log model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate elasticity at means</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>elasticity <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>elasticity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>This represents the percentage change in the Gallagher Index for a 1% change in District Magnitude.</p>
</section>
</section>
<section id="appendix-a.3-understanding-pearson-spearman-and-kendall" class="level2" data-number="9.30">
<h2 data-number="9.30" class="anchored" data-anchor-id="appendix-a.3-understanding-pearson-spearman-and-kendall"><span class="header-section-number">9.30</span> Appendix A.3: Understanding Pearson, Spearman, and Kendall</h2>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">Dataset</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>),</span>
<span id="cb319-3"><a href="#cb319-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb319-4"><a href="#cb319-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pearson-correlation" class="level3">
<h3 class="anchored" data-anchor-id="pearson-correlation">Pearson Correlation</h3>
<p><span class="math display"> r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}} </span></p>
<section id="step-by-step-calculations" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-calculations">Step-by-Step Calculations:</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>-2.4</td>
<td>-1.6</td>
<td>3.84</td>
<td>5.76</td>
<td>2.56</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>-0.4</td>
<td>0.4</td>
<td>-0.16</td>
<td>0.16</td>
<td>0.16</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>0.6</td>
<td>-0.6</td>
<td>-0.36</td>
<td>0.36</td>
<td>0.36</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>-1.4</td>
<td>-0.6</td>
<td>0.84</td>
<td>1.96</td>
<td>0.36</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>3.6</td>
<td>2.4</td>
<td>8.64</td>
<td>12.96</td>
<td>5.76</td>
</tr>
<tr class="even">
<td>Sum</td>
<td>22</td>
<td>23</td>
<td>0</td>
<td>0</td>
<td>12.8</td>
<td>21.2</td>
<td>9.2</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\bar{x} = 4.4</span> <span class="math inline">\bar{y} = 4.6</span></p>
<p><span class="math display"> r = \frac{12.8}{\sqrt{21.2 \times 9.2}} = \frac{12.8}{\sqrt{195.04}} = \frac{12.8}{13.97} = 0.92 </span></p>
</section>
</section>
<section id="spearman-correlation" class="level3">
<h3 class="anchored" data-anchor-id="spearman-correlation">Spearman Correlation</h3>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} </span></p>
<section id="step-by-step-calculations-1" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-calculations-1">Step-by-Step Calculations:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th>Rank <span class="math inline">x_i</span></th>
<th>Rank <span class="math inline">y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>2.5</td>
<td>1.5</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>2.5</td>
<td>-0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>5</td>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Sum</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>7.5</td>
</tr>
</tbody>
</table>
<p><span class="math display"> \rho = 1 - \frac{6(7.5)}{5(25-1)} = 1 - \frac{45}{120} = 0.82 </span></p>
</section>
</section>
<section id="kendalls-tau" class="level3">
<h3 class="anchored" data-anchor-id="kendalls-tau">Kendall’s Tau</h3>
<p><span class="math display"> \tau = \frac{\text{number of concordant pairs} - \text{number of discordant pairs}}{\frac{1}{2}n(n-1)} </span></p>
<section id="step-by-step-calculations-2" class="level4">
<h4 class="anchored" data-anchor-id="step-by-step-calculations-2">Step-by-Step Calculations:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pair (i,j)</th>
<th><span class="math inline">x_i,x_j</span></th>
<th><span class="math inline">y_i,y_j</span></th>
<th><span class="math inline">x_j-x_i</span></th>
<th><span class="math inline">y_j-y_i</span></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(1,2)</td>
<td>2,4</td>
<td>3,5</td>
<td>+2</td>
<td>+2</td>
<td>C</td>
</tr>
<tr class="even">
<td>(1,3)</td>
<td>2,5</td>
<td>3,4</td>
<td>+3</td>
<td>+1</td>
<td>C</td>
</tr>
<tr class="odd">
<td>(1,4)</td>
<td>2,3</td>
<td>3,4</td>
<td>+1</td>
<td>+1</td>
<td>C</td>
</tr>
<tr class="even">
<td>(1,5)</td>
<td>2,8</td>
<td>3,7</td>
<td>+6</td>
<td>+4</td>
<td>C</td>
</tr>
<tr class="odd">
<td>(2,3)</td>
<td>4,5</td>
<td>5,4</td>
<td>+1</td>
<td>-1</td>
<td>D</td>
</tr>
<tr class="even">
<td>(2,4)</td>
<td>4,3</td>
<td>5,4</td>
<td>-1</td>
<td>-1</td>
<td>C</td>
</tr>
<tr class="odd">
<td>(2,5)</td>
<td>4,8</td>
<td>5,7</td>
<td>+4</td>
<td>+2</td>
<td>C</td>
</tr>
<tr class="even">
<td>(3,4)</td>
<td>5,3</td>
<td>4,4</td>
<td>-2</td>
<td>0</td>
<td>D</td>
</tr>
<tr class="odd">
<td>(3,5)</td>
<td>5,8</td>
<td>4,7</td>
<td>+3</td>
<td>+3</td>
<td>C</td>
</tr>
<tr class="even">
<td>(4,5)</td>
<td>3,8</td>
<td>4,7</td>
<td>+5</td>
<td>+3</td>
<td>C</td>
</tr>
</tbody>
</table>
<p>Number of concordant pairs = 8 Number of discordant pairs = 2 <span class="math display"> \tau = \frac{8-2}{10} = 0.74 </span></p>
</section>
</section>
<section id="verification-in-r" class="level3">
<h3 class="anchored" data-anchor-id="verification-in-r">Verification in R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"pearson"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson: 0.92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Spearman:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"spearman"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spearman: 0.82 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kendall:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(data<span class="sc">$</span>x, data<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"kendall"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall: 0.74 </code></pre>
</div>
</div>
</section>
<section id="interpretation-of-results" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-of-results">Interpretation of Results</h3>
<ol type="1">
<li><strong>Pearson Correlation (r = 0.92)</strong>
<ul>
<li>Strong positive linear correlation</li>
<li>Indicates a very strong linear relationship between variables</li>
</ul></li>
<li><strong>Spearman Correlation (ρ = 0.82)</strong>
<ul>
<li>Also strong positive correlation</li>
<li>Slightly lower than Pearson’s, suggesting some deviations from monotonicity</li>
</ul></li>
<li><strong>Kendall’s Tau (τ = 0.74)</strong>
<ul>
<li>Lowest of the three values, but still indicates strong association</li>
<li>More robust to outliers</li>
</ul></li>
</ol>
</section>
<section id="comparison-of-measures" class="level3">
<h3 class="anchored" data-anchor-id="comparison-of-measures">Comparison of Measures</h3>
<ol type="1">
<li><strong>Differences in Values:</strong>
<ul>
<li>Pearson (0.92) - highest value, strong linearity</li>
<li>Spearman (0.82) - considers only ranking</li>
<li>Kendall (0.74) - most conservative measure</li>
</ul></li>
<li><strong>Practical Application:</strong>
<ul>
<li>All measures confirm strong positive association</li>
<li>Differences between measures indicate slight deviations from perfect linearity</li>
<li>Kendall provides the most conservative estimate of relationship strength</li>
</ul></li>
</ol>
</section>
<section id="exercises" class="level3">
<h3 class="anchored" data-anchor-id="exercises">Exercises</h3>
<ol type="1">
<li>Change y[3] from 4 to 6 and recalculate all three correlations</li>
<li>Add an outlier (x=10, y=2) and recalculate correlations</li>
<li>Compare which measure is most sensitive to changes in the data</li>
</ol>
</section>
<section id="key-points-to-remember" class="level3">
<h3 class="anchored" data-anchor-id="key-points-to-remember">Key Points to Remember</h3>
<ol type="1">
<li><strong>Pearson Correlation:</strong>
<ul>
<li>Measures linear relationship</li>
<li>Most sensitive to outliers</li>
<li>Requires interval or ratio data</li>
</ul></li>
<li><strong>Spearman Correlation:</strong>
<ul>
<li>Measures monotonic relationship</li>
<li>Less sensitive to outliers</li>
<li>Works with ordinal data</li>
</ul></li>
<li><strong>Kendall’s Tau:</strong>
<ul>
<li>Measures ordinal association</li>
<li>Most robust to outliers</li>
<li>Best for small samples and tied ranks</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-b-bias-in-ols-estimation-with-endogenous-regressors" class="level2" data-number="9.31">
<h2 data-number="9.31" class="anchored" data-anchor-id="appendix-b-bias-in-ols-estimation-with-endogenous-regressors"><span class="header-section-number">9.31</span> Appendix B: Bias in OLS Estimation with Endogenous Regressors</h2>
<p>In this tutorial, we will explore the bias in Ordinary Least Squares (OLS) estimation when the error term is correlated with the explanatory variable, a situation known as endogeneity. We will first derive the bias mathematically and then illustrate it using a simulated dataset in R.</p>
</section>
<section id="theoretical-derivation" class="level2" data-number="9.32">
<h2 data-number="9.32" class="anchored" data-anchor-id="theoretical-derivation"><span class="header-section-number">9.32</span> Theoretical Derivation</h2>
<p>Consider a data generating process (DGP) where the true relationship between <span class="math inline">x</span> and <span class="math inline">y</span> is:</p>
<p><span class="math display"> y = 2x + e </span></p>
<p>However, there is an endogeneity problem because the error term <span class="math inline">e</span> is correlated with <span class="math inline">x</span> in the following way:</p>
<p><span class="math display"> e = 1x + u </span></p>
<p>where <span class="math inline">u</span> is an independent error term.</p>
<p>If we estimate the simple linear model <span class="math inline">y = \hat{\beta_0} + \hat{\beta_1}x + \varepsilon</span> using OLS, the OLS estimator of <span class="math inline">\hat{\beta_1}</span> will be biased due to the endogeneity issue.</p>
<p>To understand the bias, let’s derive the expected value of the OLS estimator <span class="math inline">\hat{\beta}_1</span>:</p>
<p><span class="math display">\begin{align*}
E[\hat{\beta}_1] &amp;= E[(X'X)^{-1}X'y] \\
                 &amp;= E[(X'X)^{-1}X'(2x + 1x + u)] \\
                 &amp;= E[(X'X)^{-1}X'(3x + u)] \\
                 &amp;= 3 + E[(X'X)^{-1}X'u]
\end{align*}</span></p>
<p>If the error term <span class="math inline">u</span> is uncorrelated with <span class="math inline">x</span>, then <span class="math inline">E[(X'X)^{-1}X'u] = 0</span>, and the OLS estimator would be unbiased: <span class="math inline">E[\hat{\beta}_1] = 3</span>. However, in this case, the original error term <span class="math inline">e</span> is correlated with <span class="math inline">x</span>, so <span class="math inline">u</span> is also likely to be correlated with <span class="math inline">x</span>.</p>
<p>Assuming <span class="math inline">E[(X'X)^{-1}X'u] \neq 0</span>, the OLS estimator will be biased:</p>
<p><span class="math display">\begin{align*}
\text{Bias}(\hat{\beta}_1) &amp;= E[\hat{\beta}_1] - \beta_{1,\text{true}} \\
                           &amp;= 3 + E[(X'X)^{-1}X'u] - 2 \\
                           &amp;= 1 + E[(X'X)^{-1}X'u]
\end{align*}</span></p>
<p>The direction and magnitude of the bias will depend on the correlation between <span class="math inline">x</span> and <span class="math inline">u</span>. If <span class="math inline">x</span> and <span class="math inline">u</span> are positively correlated, the bias will be positive, and the OLS estimator will overestimate the true coefficient. Conversely, if <span class="math inline">x</span> and <span class="math inline">u</span> are negatively correlated, the bias will be negative, and the OLS estimator will underestimate the true coefficient.</p>
</section>
<section id="simulation-in-r" class="level2" data-number="9.33">
<h2 data-number="9.33" class="anchored" data-anchor-id="simulation-in-r"><span class="header-section-number">9.33</span> Simulation in R</h2>
<p>Let’s create a simple dataset with 10 observations where <span class="math inline">x</span> is in the interval 1:10, and generate <span class="math inline">y</span> values based on the given DGP: <span class="math inline">y = 2x + e</span>, where <span class="math inline">e = 1x + u</span>, and <span class="math inline">u</span> is a random error term.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>x <span class="sc">+</span> u</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="co"># e &lt;- 1*x</span></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> e</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the data frame</span></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the OLS model</span></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1348 -0.5624 -0.1393  0.3854  1.6814 

Coefficients:
            Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept)   0.5255     0.6673   0.787         0.454    
x             2.9180     0.1075  27.134 0.00000000367 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9768 on 8 degrees of freedom
Multiple R-squared:  0.9893,    Adjusted R-squared:  0.9879 
F-statistic: 736.3 on 1 and 8 DF,  p-value: 0.000000003666</code></pre>
</div>
</div>
<p>In this example, the true relationship is <span class="math inline">y = 2x + e</span>, where <span class="math inline">e = 1x + u</span>. However, when we estimate the OLS model, we get:</p>
<p><span class="math display"> \hat{y} = 0.18376 + 3.05874x </span></p>
<p>The estimated coefficient for <span class="math inline">x</span> is 3.05874, which is biased upward from the true value of 2. This bias is due to the correlation between the error term <span class="math inline">e</span> and the explanatory variable <span class="math inline">x</span>.</p>
<p>To visualize the bias using ggplot2, we can plot the true relationship (<span class="math inline">y = 2x</span>) and the estimated OLS relationship:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"True vs. Estimated Relationship"</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb328-9"><a href="#cb328-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb328-10"><a href="#cb328-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Lines"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), </span>
<span id="cb328-11"><a href="#cb328-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"True"</span>, <span class="st">"OLS"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot will show that the estimated OLS line (red) is steeper than the true relationship line (blue), illustrating the upward bias in the estimated coefficient.</p>
</section>
<section id="conclusion" class="level2" data-number="9.34">
<h2 data-number="9.34" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">9.34</span> Conclusion</h2>
<p>In summary, when the error term is correlated with the explanatory variable (endogeneity), the OLS estimator will be biased. The direction and magnitude of the bias depend on the nature of the correlation between the error term and the explanatory variable. This tutorial demonstrated the bias both mathematically and through a simulated example in R, using ggplot2 for visualization.</p>
<hr>
</section>
<section id="appendix-c.-ols---worked-examples" class="level2" data-number="9.35">
<h2 data-number="9.35" class="anchored" data-anchor-id="appendix-c.-ols---worked-examples"><span class="header-section-number">9.35</span> Appendix C. OLS - Worked Examples</h2>
</section>
<section id="example-1.-practice-hours-vs.-skill-rating-visual-guide-to-ols-and-r-squared" class="level2" data-number="9.36">
<h2 data-number="9.36" class="anchored" data-anchor-id="example-1.-practice-hours-vs.-skill-rating-visual-guide-to-ols-and-r-squared"><span class="header-section-number">9.36</span> Example 1. Practice Hours vs.&nbsp;Skill Rating: Visual Guide to OLS and R-squared</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Our simple dataset</span></span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>practice <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a>skill <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">9</span>)</span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Practice =</span> practice,</span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skill =</span> skill</span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb329-15"><a href="#cb329-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-16"><a href="#cb329-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Practice Skill
1       1        1     3
2       2        2     7
3       3        3     5
4       4        4     8
5       5        5    10
6       6        6     9</code></pre>
</div>
</div>
<section id="manual-calculations" class="level3">
<h3 class="anchored" data-anchor-id="manual-calculations">Manual Calculations</h3>
<section id="step-1-calculate-the-means-1" class="level4">
<h4 class="anchored" data-anchor-id="step-1-calculate-the-means-1">Step 1: Calculate the Means</h4>
<p>The mean is the average value, calculated by summing all observations and dividing by the number of observations.</p>
<p><strong>Mean of Practice Hours (X̄):</strong></p>
<p><span class="math inline">\bar{X} = \frac{\sum_{i=1}^{n} X_i}{n} = \frac{1 + 2 + 3 + 4 + 5 + 6}{6} = \frac{21}{6} = 3.5</span></p>
<p><strong>Mean of Skill Ratings (Ȳ):</strong></p>
<p><span class="math inline">\bar{Y} = \frac{\sum_{i=1}^{n} Y_i}{n} = \frac{3 + 7 + 5 + 8 + 10 + 9}{6} = \frac{42}{6} = 7</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate means</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(practice)</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(skill)</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Practice Hours:"</span>, mean_x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Practice Hours: 3.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Skill Rating:"</span>, mean_y, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Skill Rating: 7 </code></pre>
</div>
</div>
</section>
<section id="step-2-calculate-variance-and-standard-deviation" class="level4">
<h4 class="anchored" data-anchor-id="step-2-calculate-variance-and-standard-deviation">Step 2: Calculate Variance and Standard Deviation</h4>
<p>Variance measures how spread out the data is from the mean. We use the sample variance formula (dividing by n-1).</p>
<p><strong>Variance of X (Practice Hours):</strong></p>
<p>First, calculate deviations from the mean <span class="math inline">(X_i - \bar{X})</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td><span class="math inline">1 - 3.5 = -2.5</span></td>
<td><span class="math inline">(-2.5)^2 = 6.25</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td><span class="math inline">2 - 3.5 = -1.5</span></td>
<td><span class="math inline">(-1.5)^2 = 2.25</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td><span class="math inline">3 - 3.5 = -0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td><span class="math inline">4 - 3.5 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td><span class="math inline">5 - 3.5 = 1.5</span></td>
<td><span class="math inline">(1.5)^2 = 2.25</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6</td>
<td><span class="math inline">6 - 3.5 = 2.5</span></td>
<td><span class="math inline">(2.5)^2 = 6.25</span></td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td><strong>17.5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1} = \frac{17.5}{5} = 3.5</span></p>
<p><span class="math inline">s_X = \sqrt{3.5} = 1.871</span></p>
<p><strong>Variance of Y (Skill Ratings):</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>3</td>
<td><span class="math inline">3 - 7 = -4</span></td>
<td><span class="math inline">(-4)^2 = 16</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
<td><span class="math inline">7 - 7 = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td><span class="math inline">5 - 7 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td><span class="math inline">8 - 7 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td><span class="math inline">10 - 7 = 3</span></td>
<td><span class="math inline">(3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>9</td>
<td><span class="math inline">9 - 7 = 2</span></td>
<td><span class="math inline">(2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td><strong>34</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">s^2_Y = \frac{\sum(Y_i - \bar{Y})^2}{n-1} = \frac{34}{5} = 6.8</span></p>
<p><span class="math inline">s_Y = \sqrt{6.8} = 2.608</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify variance and standard deviation</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance of Practice:"</span>, <span class="fu">var</span>(practice), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variance of Practice: 3.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD of Practice:"</span>, <span class="fu">sd</span>(practice), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of Practice: 1.870829 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance of Skill:"</span>, <span class="fu">var</span>(skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variance of Skill: 6.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD of Skill:"</span>, <span class="fu">sd</span>(skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of Skill: 2.607681 </code></pre>
</div>
</div>
</section>
<section id="step-3-calculate-covariance-1" class="level4">
<h4 class="anchored" data-anchor-id="step-3-calculate-covariance-1">Step 3: Calculate Covariance</h4>
<p>Covariance measures how two variables vary together. A positive covariance indicates that as one variable increases, the other tends to increase.</p>
<p><span class="math inline">s_{XY} = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Let’s calculate the products for each observation:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-2.5</td>
<td>-4</td>
<td><span class="math inline">(-2.5) \times (-4) = 10.0</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>-1.5</td>
<td>0</td>
<td><span class="math inline">(-1.5) \times (0) = 0.0</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>-0.5</td>
<td>-2</td>
<td><span class="math inline">(-0.5) \times (-2) = 1.0</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>0.5</td>
<td>1</td>
<td><span class="math inline">(0.5) \times (1) = 0.5</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>1.5</td>
<td>3</td>
<td><span class="math inline">(1.5) \times (3) = 4.5</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>2.5</td>
<td>2</td>
<td><span class="math inline">(2.5) \times (2) = 5.0</span></td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td><strong>21.0</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">s_{XY} = \frac{21.0}{5} = 4.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify covariance</span></span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Covariance:"</span>, <span class="fu">cov</span>(practice, skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Covariance: 4.2 </code></pre>
</div>
</div>
</section>
<section id="step-4-calculate-pearson-correlation-coefficient" class="level4">
<h4 class="anchored" data-anchor-id="step-4-calculate-pearson-correlation-coefficient">Step 4: Calculate Pearson Correlation Coefficient</h4>
<p>The correlation coefficient standardizes the covariance to a scale from -1 to +1:</p>
<p><span class="math inline">r = \frac{s_{XY}}{s_X \cdot s_Y} = \frac{4.2}{1.871 \times 2.608} = \frac{4.2}{4.879} = 0.861</span></p>
<p>This gives us a correlation of <strong>0.861</strong>, indicating a strong positive relationship between practice hours and skill rating.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify correlation</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation:"</span>, <span class="fu">cor</span>(practice, skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation: 0.8609161 </code></pre>
</div>
</div>
</section>
<section id="step-5-calculate-ols-regression-coefficients" class="level4">
<h4 class="anchored" data-anchor-id="step-5-calculate-ols-regression-coefficients">Step 5: Calculate OLS Regression Coefficients</h4>
<p>The Ordinary Least Squares (OLS) method finds the values of <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> that minimize the sum of squared errors.</p>
<p><strong>Slope estimator:</strong></p>
<p><span class="math inline">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p>Using our calculated values:</p>
<p><span class="math inline">\hat{\beta_1} = \frac{4.2}{3.5} = 1.2</span></p>
<p><strong>Intercept estimator:</strong></p>
<p><span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math inline">\hat{\beta_0} = 7 - (1.2 \times 3.5) = 7 - 4.2 = 2.8</span></p>
<p><strong>Our regression equation is:</strong></p>
<p><span class="math inline">\hat{Y} = 2.8 + 1.2X</span></p>
<p>This means:</p>
<ul>
<li><p>When practice hours = 0, predicted skill = 2.8</p></li>
<li><p>For each 1-hour increase in practice, skill rating increases by 1.2 points</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(skill <span class="sc">~</span> practice)</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>coef_model <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Intercept (β₀):"</span>, coef_model[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Intercept (β₀): 2.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Slope (β₁):"</span>, coef_model[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Slope (β₁): 1.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residual <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-6-calculate-predicted-values-and-residuals" class="level4">
<h4 class="anchored" data-anchor-id="step-6-calculate-predicted-values-and-residuals">Step 6: Calculate Predicted Values and Residuals</h4>
<p>Using <span class="math inline">\hat{Y} = 2.8 + 1.2X</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 2.8 + 1.2X_i</span></th>
<th>Residual <span class="math inline">(Y_i - \hat{Y}_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>3</td>
<td><span class="math inline">2.8 + 1.2(1) = 4.0</span></td>
<td><span class="math inline">3 - 4.0 = -1.0</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>7</td>
<td><span class="math inline">2.8 + 1.2(2) = 5.2</span></td>
<td><span class="math inline">7 - 5.2 = 1.8</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>5</td>
<td><span class="math inline">2.8 + 1.2(3) = 6.4</span></td>
<td><span class="math inline">5 - 6.4 = -1.4</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>8</td>
<td><span class="math inline">2.8 + 1.2(4) = 7.6</span></td>
<td><span class="math inline">8 - 7.6 = 0.4</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td>10</td>
<td><span class="math inline">2.8 + 1.2(5) = 8.8</span></td>
<td><span class="math inline">10 - 8.8 = 1.2</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6</td>
<td>9</td>
<td><span class="math inline">2.8 + 1.2(6) = 10.0</span></td>
<td><span class="math inline">9 - 10.0 = -1.0</span></td>
</tr>
</tbody>
</table>
</section>
<section id="step-7-calculate-sum-of-squares" class="level4">
<h4 class="anchored" data-anchor-id="step-7-calculate-sum-of-squares">Step 7: Calculate Sum of Squares</h4>
<p><strong>SST (Total Sum of Squares) - Total variation in Y:</strong></p>
<p><span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<p>From our earlier variance calculation:</p>
<p><span class="math inline">SST = (n-1) \times s^2_Y = 5 \times 6.8 = 34</span></p>
<p><strong>SSE (Sum of Squared Errors) - Unexplained variation:</strong></p>
<p><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 17%">
<col style="width: 28%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">(Y_i - \hat{Y}_i)</span></th>
<th><span class="math inline">(Y_i - \hat{Y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>3</td>
<td>4.0</td>
<td>-1.0</td>
<td>1.00</td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
<td>5.2</td>
<td>1.8</td>
<td>3.24</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>6.4</td>
<td>-1.4</td>
<td>1.96</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>7.6</td>
<td>0.4</td>
<td>0.16</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>8.8</td>
<td>1.2</td>
<td>1.44</td>
</tr>
<tr class="even">
<td>6</td>
<td>9</td>
<td>10.0</td>
<td>-1.0</td>
<td>1.00</td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>8.80</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SSE = 8.80</span></p>
<p><strong>SSR (Sum of Squares Regression) - Explained variation:</strong></p>
<p><span class="math inline">SSR = SST - SSE = 34 - 8.80 = 25.20</span></p>
</section>
<section id="step-8-calculate-r-squared" class="level4">
<h4 class="anchored" data-anchor-id="step-8-calculate-r-squared">Step 8: Calculate R-squared</h4>
<p>R-squared tells us what proportion of the total variation in Y is explained by our model:</p>
<p><span class="math inline">R^2 = \frac{SSR}{SST} = \frac{25.20}{34} = 0.741</span></p>
<p><strong>Alternative formula:</strong></p>
<p><span class="math inline">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{8.80}{34} = 1 - 0.259 = 0.741</span></p>
<p><strong>Or simply:</strong></p>
<p><span class="math inline">R^2 = r^2 = (0.861)^2 = 0.741</span></p>
<p>This means our model explains <strong>74.1%</strong> of the variation in skill ratings!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify sum of squares and R-squared</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((skill <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>predicted <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Total):"</span>, SST, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Total): 34 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Explained):"</span>, SSR, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Explained): 25.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Unexplained):"</span>, SSE, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Unexplained): 8.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, r_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.7411765 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared (from correlation):"</span>, <span class="fu">cor</span>(practice, skill)<span class="sc">^</span><span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared (from correlation): 0.7411765 </code></pre>
</div>
</div>
</section>
</section>
<section id="visualization-1-the-ols-best-fit-line" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1-the-ols-best-fit-line">Visualization 1: The OLS Best-Fit Line</h3>
<p>This plot shows how OLS minimizes the <strong>sum of squared residuals</strong> (vertical distances from points to the line).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice, <span class="at">y =</span> Skill)) <span class="sc">+</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Practice, <span class="at">yend =</span> predicted), </span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> mean_y <span class="sc">+</span> <span class="fl">0.3</span>, </span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean (ȳ = "</span>, mean_y, <span class="st">")"</span>), </span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb362-12"><a href="#cb362-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">4</span>, </span>
<span id="cb362-13"><a href="#cb362-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Residuals (errors)</span><span class="sc">\n</span><span class="st">OLS minimizes Σ(residuals²)"</span>, </span>
<span id="cb362-14"><a href="#cb362-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb362-15"><a href="#cb362-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">10.5</span>, </span>
<span id="cb362-16"><a href="#cb362-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ŷ = "</span>, <span class="fu">round</span>(coef_model[<span class="dv">1</span>], <span class="dv">1</span>), </span>
<span id="cb362-17"><a href="#cb362-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">" + "</span>, <span class="fu">round</span>(coef_model[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"x"</span>), </span>
<span id="cb362-18"><a href="#cb362-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb362-19"><a href="#cb362-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb362-20"><a href="#cb362-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"OLS Regression: Minimizing Squared Residuals"</span>,</span>
<span id="cb362-21"><a href="#cb362-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Blue triangles are predicted values; red lines show residuals"</span>,</span>
<span id="cb362-22"><a href="#cb362-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Practice Hours"</span>,</span>
<span id="cb362-23"><a href="#cb362-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Skill Rating"</span></span>
<span id="cb362-24"><a href="#cb362-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb362-25"><a href="#cb362-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb362-26"><a href="#cb362-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Insight:</strong> OLS finds the unique line that makes the sum of squared red distances as small as possible!</p>
</section>
<section id="visualization-2-variance-decomposition-sst-ssr-sse" class="level3">
<h3 class="anchored" data-anchor-id="visualization-2-variance-decomposition-sst-ssr-sse">Visualization 2: Variance Decomposition (SST = SSR + SSE)</h3>
<p>This shows how total variation is split into explained and unexplained components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the decomposition plot</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice)) <span class="sc">+</span></span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total deviation (SST)</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_y, <span class="at">yend =</span> Skill, <span class="at">xend =</span> Practice), </span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explained deviation (SSR)</span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_y, <span class="at">yend =</span> predicted, <span class="at">xend =</span> Practice), </span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unexplained deviation (SSE)</span></span>
<span id="cb364-13"><a href="#cb364-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">yend =</span> Skill, <span class="at">xend =</span> Practice), </span>
<span id="cb364-14"><a href="#cb364-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb364-15"><a href="#cb364-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb364-16"><a href="#cb364-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-17"><a href="#cb364-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mean line</span></span>
<span id="cb364-18"><a href="#cb364-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb364-19"><a href="#cb364-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb364-20"><a href="#cb364-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-21"><a href="#cb364-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Regression line</span></span>
<span id="cb364-22"><a href="#cb364-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> Skill), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb364-23"><a href="#cb364-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb364-24"><a href="#cb364-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-25"><a href="#cb364-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Points</span></span>
<span id="cb364-26"><a href="#cb364-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Skill), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb364-27"><a href="#cb364-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb364-28"><a href="#cb364-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-29"><a href="#cb364-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Annotations</span></span>
<span id="cb364-30"><a href="#cb364-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> mean_y, </span>
<span id="cb364-31"><a href="#cb364-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Mean"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb364-32"><a href="#cb364-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> <span class="fl">9.5</span>, </span>
<span id="cb364-33"><a href="#cb364-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Regression Line"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb364-34"><a href="#cb364-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-35"><a href="#cb364-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Legend</span></span>
<span id="cb364-36"><a href="#cb364-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">yend =</span> <span class="fl">3.5</span>,</span>
<span id="cb364-37"><a href="#cb364-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, </span>
<span id="cb364-38"><a href="#cb364-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.12</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb364-39"><a href="#cb364-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">2.75</span>, </span>
<span id="cb364-40"><a href="#cb364-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Total (SST)"</span>, <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb364-41"><a href="#cb364-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb364-42"><a href="#cb364-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-43"><a href="#cb364-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">yend =</span> <span class="fl">5.5</span>,</span>
<span id="cb364-44"><a href="#cb364-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb364-45"><a href="#cb364-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="dv">5</span>, </span>
<span id="cb364-46"><a href="#cb364-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Explained (SSR)"</span>, <span class="at">color =</span> <span class="st">"green"</span>, </span>
<span id="cb364-47"><a href="#cb364-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb364-48"><a href="#cb364-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-49"><a href="#cb364-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">6.5</span>, <span class="at">yend =</span> <span class="fl">7.5</span>,</span>
<span id="cb364-50"><a href="#cb364-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb364-51"><a href="#cb364-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="dv">7</span>, </span>
<span id="cb364-52"><a href="#cb364-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Unexplained (SSE)"</span>, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb364-53"><a href="#cb364-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb364-54"><a href="#cb364-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb364-55"><a href="#cb364-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb364-56"><a href="#cb364-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Variance Decomposition: SST = SSR + SSE"</span>,</span>
<span id="cb364-57"><a href="#cb364-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Purple = total deviation | Green = explained by model | Red = residual error"</span>,</span>
<span id="cb364-58"><a href="#cb364-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Practice Hours"</span>,</span>
<span id="cb364-59"><a href="#cb364-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Skill Rating"</span></span>
<span id="cb364-60"><a href="#cb364-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb364-61"><a href="#cb364-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb364-62"><a href="#cb364-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb364-63"><a href="#cb364-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">7.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Mathematical Decomposition:</strong></p>
<p>For each observation: <span class="math inline">(Y_i - \bar{Y})^2 = (\hat{Y}_i - \bar{Y})^2 + (Y_i - \hat{Y}_i)^2</span></p>
<ul>
<li><p><strong>Purple arrows:</strong> Total deviation from mean = <span class="math inline">(Y_i - \bar{Y})</span></p></li>
<li><p><strong>Green bars:</strong> Model’s explanation = <span class="math inline">(\hat{Y}_i - \bar{Y})</span></p></li>
<li><p><strong>Red dashed:</strong> What’s left over = <span class="math inline">(Y_i - \hat{Y}_i)</span></p></li>
</ul>
</section>
<section id="visualization-3-r-squared-as-a-proportion" class="level3">
<h3 class="anchored" data-anchor-id="visualization-3-r-squared-as-a-proportion">Visualization 3: R-squared as a Proportion</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate sum of squares</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((skill <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>predicted <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create bar chart data</span></span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a>ss_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Total (SST)"</span>, <span class="st">"Explained (SSR)"</span>, <span class="st">"Unexplained (SSE)"</span>),</span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(SST, SSR, SSE),</span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Color =</span> <span class="fu">c</span>(<span class="st">"purple"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-14"><a href="#cb366-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ss_data, <span class="fu">aes</span>(<span class="at">x =</span> Component, <span class="at">y =</span> Value, <span class="at">fill =</span> Component)) <span class="sc">+</span></span>
<span id="cb366-15"><a href="#cb366-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb366-16"><a href="#cb366-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Value, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb366-17"><a href="#cb366-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>)) <span class="sc">+</span></span>
<span id="cb366-18"><a href="#cb366-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb366-19"><a href="#cb366-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Sum of Squares Breakdown"</span>,</span>
<span id="cb366-20"><a href="#cb366-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sum of Squares"</span>,</span>
<span id="cb366-21"><a href="#cb366-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span></span>
<span id="cb366-22"><a href="#cb366-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb366-23"><a href="#cb366-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb366-24"><a href="#cb366-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb366-25"><a href="#cb366-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb366-26"><a href="#cb366-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-27"><a href="#cb366-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create proportion visualization</span></span>
<span id="cb366-28"><a href="#cb366-28" aria-hidden="true" tabindex="-1"></a>prop_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb366-29"><a href="#cb366-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Explained</span><span class="sc">\n</span><span class="st">(SSR)"</span>, <span class="st">"Unexplained</span><span class="sc">\n</span><span class="st">(SSE)"</span>),</span>
<span id="cb366-30"><a href="#cb366-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Proportion =</span> <span class="fu">c</span>(SSR<span class="sc">/</span>SST, SSE<span class="sc">/</span>SST),</span>
<span id="cb366-31"><a href="#cb366-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">Percentage =</span> <span class="fu">c</span>(SSR<span class="sc">/</span>SST <span class="sc">*</span> <span class="dv">100</span>, SSE<span class="sc">/</span>SST <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb366-32"><a href="#cb366-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb366-33"><a href="#cb366-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-34"><a href="#cb366-34" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prop_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> Proportion, <span class="at">fill =</span> Component)) <span class="sc">+</span></span>
<span id="cb366-35"><a href="#cb366-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb366-36"><a href="#cb366-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb366-37"><a href="#cb366-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green3"</span>, <span class="st">"red3"</span>)) <span class="sc">+</span></span>
<span id="cb366-38"><a href="#cb366-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb366-39"><a href="#cb366-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb366-40"><a href="#cb366-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">6</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb366-41"><a href="#cb366-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r_squared, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb366-42"><a href="#cb366-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb366-43"><a href="#cb366-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb366-44"><a href="#cb366-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb366-45"><a href="#cb366-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb366-46"><a href="#cb366-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-47"><a href="#cb366-47" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p><strong>R-squared Formulas:</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{25.20}{34} = 0.74</span></p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{8.80}{34} = 0.74</span></p>
<p><strong>Interpretation:</strong> Our model explains 74% of the variation in skill ratings!</p>
</section>
<section id="visualization-4-r²-as-correlation-between-deviations" class="level3">
<h3 class="anchored" data-anchor-id="visualization-4-r²-as-correlation-between-deviations">Visualization 4: R² as Correlation Between Deviations</h3>
<p>This shows the <strong>geometric interpretation</strong> of R²: how well predicted deviations from the mean match actual deviations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate deviations</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>actual_dev <span class="ot">&lt;-</span> skill <span class="sc">-</span> mean_y</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>predicted <span class="sc">-</span> mean_y</span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Side-by-side comparison</span></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice)) <span class="sc">+</span></span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> actual_dev, <span class="at">xend =</span> Practice), </span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> actual_dev), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb367-13"><a href="#cb367-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Actual Deviations from Mean"</span>,</span>
<span id="cb367-14"><a href="#cb367-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">expression</span>(Y[i] <span class="sc">-</span> <span class="fu">bar</span>(Y)),</span>
<span id="cb367-15"><a href="#cb367-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Practice Hours"</span>,</span>
<span id="cb367-16"><a href="#cb367-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Deviation from Mean"</span></span>
<span id="cb367-17"><a href="#cb367-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb367-18"><a href="#cb367-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb367-19"><a href="#cb367-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb367-20"><a href="#cb367-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-21"><a href="#cb367-21" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice)) <span class="sc">+</span></span>
<span id="cb367-22"><a href="#cb367-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb367-23"><a href="#cb367-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> predicted_dev, <span class="at">xend =</span> Practice), </span>
<span id="cb367-24"><a href="#cb367-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb367-25"><a href="#cb367-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb367-26"><a href="#cb367-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted_dev), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb367-27"><a href="#cb367-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb367-28"><a href="#cb367-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Predicted Deviations from Mean"</span>,</span>
<span id="cb367-29"><a href="#cb367-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Y)[i] <span class="sc">-</span> <span class="fu">bar</span>(Y)),</span>
<span id="cb367-30"><a href="#cb367-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Practice Hours"</span>,</span>
<span id="cb367-31"><a href="#cb367-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Deviation from Mean"</span></span>
<span id="cb367-32"><a href="#cb367-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb367-33"><a href="#cb367-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb367-34"><a href="#cb367-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb367-35"><a href="#cb367-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-36"><a href="#cb367-36" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualization-5-scatterplot-of-deviations-r²-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="visualization-5-scatterplot-of-deviations-r²-interpretation">Visualization 5: Scatterplot of Deviations (R² Interpretation)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> predicted_dev, <span class="at">y =</span> actual_dev)) <span class="sc">+</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, </span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">2.5</span>, </span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"If perfect fit:</span><span class="sc">\n</span><span class="st">all points on this line</span><span class="sc">\n</span><span class="st">(R² = 1)"</span>), </span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span>, </span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Correlation = "</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(r_squared), <span class="dv">3</span>), </span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"</span><span class="sc">\n</span><span class="st">R² = "</span>, <span class="fu">round</span>(r_squared, <span class="dv">3</span>)), </span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"R² Measures How Well Predicted Deviations Match Actual Deviations"</span>,</span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Each point compares model's prediction to reality (both relative to mean)"</span>,</span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Predicted Deviation: "</span>, <span class="fu">hat</span>(Y)[i] <span class="sc">-</span> <span class="fu">bar</span>(Y))),</span>
<span id="cb368-18"><a href="#cb368-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Actual Deviation: "</span>, Y[i] <span class="sc">-</span> <span class="fu">bar</span>(Y)))</span>
<span id="cb368-19"><a href="#cb368-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb368-20"><a href="#cb368-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb368-21"><a href="#cb368-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Insight:</strong></p>
<p>R² is literally the square of the correlation between:</p>
<ul>
<li><p>What the model predicts (relative to mean)</p></li>
<li><p>What actually happened (relative to mean)</p></li>
</ul>
<p>If <span class="math inline">R^2 = 1</span>: all points fall exactly on the diagonal (perfect predictions)</p>
<p>If <span class="math inline">R^2 = 0</span>: no relationship between predicted and actual deviations</p>
</section>
<section id="summary-table" class="level3">
<h3 class="anchored" data-anchor-id="summary-table">Summary Table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Sample Size (n)"</span>, </span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Mean Practice (X̄)"</span>, </span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Mean Skill (Ȳ)"</span>,</span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Correlation (r)"</span>,</span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Intercept (β₀)"</span>,</span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Slope (β₁)"</span>,</span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"R-squared"</span>,</span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"SST (Total)"</span>,</span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"SSR (Explained)"</span>,</span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"SSE (Unexplained)"</span>),</span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(<span class="dv">6</span>,</span>
<span id="cb370-14"><a href="#cb370-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(mean_x, <span class="dv">2</span>),</span>
<span id="cb370-15"><a href="#cb370-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(mean_y, <span class="dv">2</span>),</span>
<span id="cb370-16"><a href="#cb370-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">cor</span>(practice, skill), <span class="dv">3</span>),</span>
<span id="cb370-17"><a href="#cb370-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(coef_model[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb370-18"><a href="#cb370-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(coef_model[<span class="dv">2</span>], <span class="dv">2</span>),</span>
<span id="cb370-19"><a href="#cb370-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(r_squared, <span class="dv">3</span>),</span>
<span id="cb370-20"><a href="#cb370-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(SST, <span class="dv">2</span>),</span>
<span id="cb370-21"><a href="#cb370-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(SSR, <span class="dv">2</span>),</span>
<span id="cb370-22"><a href="#cb370-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(SSE, <span class="dv">2</span>))</span>
<span id="cb370-23"><a href="#cb370-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb370-24"><a href="#cb370-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-25"><a href="#cb370-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Statistic</th>
<th style="text-align: right;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sample Size (n)</td>
<td style="text-align: right;">6.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mean Practice (X̄)</td>
<td style="text-align: right;">3.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mean Skill (Ȳ)</td>
<td style="text-align: right;">7.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Correlation (r)</td>
<td style="text-align: right;">0.861</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Intercept (β₀)</td>
<td style="text-align: right;">2.800</td>
</tr>
<tr class="even">
<td style="text-align: left;">Slope (β₁)</td>
<td style="text-align: right;">1.200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R-squared</td>
<td style="text-align: right;">0.741</td>
</tr>
<tr class="even">
<td style="text-align: left;">SST (Total)</td>
<td style="text-align: right;">34.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SSR (Explained)</td>
<td style="text-align: right;">25.200</td>
</tr>
<tr class="even">
<td style="text-align: left;">SSE (Unexplained)</td>
<td style="text-align: right;">8.800</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="key-takeaways" class="level3">
<h3 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h3>
<p><strong>OLS Regression:</strong></p>
<ul>
<li><p>Finds the line that minimizes the sum of squared residuals</p></li>
<li><p>Produces unbiased estimates with minimum variance (BLUE)</p></li>
</ul>
<p><strong>R-squared (0.74) means:</strong></p>
<ol type="1">
<li><p>74% of variation in skill is explained by practice hours</p></li>
<li><p>The correlation between predicted and actual deviations is <span class="math inline">\sqrt{0.74} = 0.86</span></p></li>
<li><p>SSR is 74% of SST; SSE is 26% of SST</p></li>
</ol>
<p><strong>Geometric Interpretation:</strong></p>
<ul>
<li><p>Total variation = distance of each point from the mean</p></li>
<li><p>Model captures 74% of these distances through the regression line</p></li>
<li><p>Remaining 26% is unexplained (residuals)</p></li>
</ul>
<p><strong>Practical Implication:</strong></p>
<p>Each additional hour of practice increases expected skill by <strong>1.2 points</strong>, and this relationship explains most (but not all) of the variation we observe!</p>
</section>
</section>
<section id="example-2.-income-and-voter-turnout" class="level2" data-number="9.37">
<h2 data-number="9.37" class="anchored" data-anchor-id="example-2.-income-and-voter-turnout"><span class="header-section-number">9.37</span> Example 2. Income and Voter Turnout</h2>
<p><strong>Background</strong></p>
<p>In preparation for upcoming municipal elections, the Electoral Commission of a mid-sized European city conducted research on voter participation patterns across different city districts. A key question emerged:</p>
<p>Does economic prosperity of a district correlate with civic engagement, specifically voter turnout?</p>
<p><strong>Data Collection</strong></p>
<p>Sample: 5 representative districts</p>
<p>Time Period: Data from recent municipal elections</p>
<p>Variables:</p>
<ul>
<li>Income: Average annual household income per capita (thousands €)</li>
<li>Turnout: Percentage of registered voters who voted in the election</li>
</ul>
<section id="initial-r-output-for-reference" class="level3">
<h3 class="anchored" data-anchor-id="initial-r-output-for-reference">Initial R Output for Reference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>)  <span class="co"># thousands €</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>turnout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># %</span></span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model check</span></span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnout <span class="sc">~</span> income)</span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = turnout ~ income)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
income       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
</div>
</section>
<section id="dispersion-measures" class="level3">
<h3 class="anchored" data-anchor-id="dispersion-measures">Dispersion Measures</h3>
<p><strong>Means:</strong></p>
<p><span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n} = \frac{50 + 45 + 56 + 40 + 60}{5} = \frac{251}{5} = 50.2</span></p>
<p><span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n} = \frac{60 + 56 + 70 + 50 + 75}{5} = \frac{311}{5} = 62.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)  <span class="co"># 50.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(turnout) <span class="co"># 62.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.2</code></pre>
</div>
</div>
<p><strong>Variances:</strong></p>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X: <span class="math inline">(-0.2, -5.2, 5.8, -10.2, 9.8)</span></p>
<p><span class="math display">s^2_X = \frac{0.04 + 27.04 + 33.64 + 104.04 + 96.04}{4} = \frac{260.8}{4} = 65.2</span></p>
<p>Deviations for Y: <span class="math inline">(-2.2, -6.2, 7.8, -12.2, 12.8)</span></p>
<p><span class="math display">s^2_Y = \frac{4.84 + 38.44 + 60.84 + 148.84 + 163.84}{4} = \frac{416.8}{4} = 104.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(income)  <span class="co"># 65.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(turnout) <span class="co"># 104.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.2</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-correlation">Covariance and Correlation</h3>
<p><strong>Covariance:</strong></p>
<p><span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-0.2 \times -2.2) = 0.44</span> <span class="math display">(-5.2 \times -6.2) = 32.24</span> <span class="math display">(5.8 \times 7.8) = 45.24</span> <span class="math display">(-10.2 \times -12.2) = 124.44</span> <span class="math display">(9.8 \times 12.8) = 125.44</span></p>
<p><span class="math display">s_{XY} = \frac{327.8}{4} = 81.95</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(income, turnout) <span class="co"># 81.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.95</code></pre>
</div>
</div>
<p><strong>Correlation:</strong></p>
<p><span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{81.95}{\sqrt{65.2}\sqrt{104.2}} = 0.994</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(income, turnout) <span class="co"># 0.994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9942402</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong></p>
<p><span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{81.95}{65.2} = 1.2571429</span></p>
<p><strong>Intercept:</strong></p>
<p><span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p>Step by step:</p>
<ol type="1">
<li><span class="math display">1.2571429 \times 50.2 = 63.1085714</span></li>
<li><span class="math display">\hat{\beta_0} = 62.2 - 63.1085714 = -0.9085714</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)  <span class="co"># Exact coefficients from R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
 -0.8964724   1.2569018 </code></pre>
</div>
</div>
</section>
<section id="detailed-decomposition-of-variance-and-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="detailed-decomposition-of-variance-and-r-squared">Detailed Decomposition of Variance and R-squared</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display"> \hat{Y} = -0.9085714 + 1.2571429X</span></p>
<p>The predicted values <span class="math inline">\hat{Y}</span> for each <span class="math inline">X</span> value:</p>
<p>For <span class="math inline">X = 50</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (50)
</span> <span class="math display">\hat{Y} = -0.9085714 + 62.857145</span> <span class="math display">\hat{Y} = 61.9485736</span></p>
<p>For <span class="math inline">X = 45</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (45)
</span> <span class="math display">\hat{Y} = -0.9085714 + 56.5714305</span> <span class="math display">\hat{Y} = 55.6535591</span></p>
<p>For <span class="math inline">X = 56</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (56)
</span> <span class="math display">\hat{Y} = -0.9085714 + 70.4200024</span> <span class="math display">\hat{Y} = 69.5114310</span></p>
<p>For <span class="math inline">X = 40</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (40)
</span> <span class="math display">\hat{Y} = -0.9085714 + 50.2657160</span> <span class="math display">\hat{Y} = 49.3571446</span></p>
<p>For <span class="math inline">X = 60</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (60)
</span> <span class="math display">\hat{Y} = -0.9085714 + 75.4285740</span> <span class="math display">\hat{Y} = 74.5200026</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification of predicted values</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9085714</span> <span class="sc">+</span> <span class="fl">1.2571429</span> <span class="sc">*</span> income</span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> income,</span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> turnout,</span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_hat =</span> y_hat,</span>
<span id="cb387-7"><a href="#cb387-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb387-8"><a href="#cb387-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y    Y_hat
1 50 60 61.94857
2 45 56 55.66286
3 56 70 69.49143
4 40 50 49.37714
5 60 75 74.52000</code></pre>
</div>
</div>
<p><strong>Step 2: Calculate SST (Total Sum of Squares)</strong></p>
<p><span class="math display">SST = \sum(Y_i - \bar{Y})^2 \text{ where } \bar{Y} = 62.2</span></p>
<p><span class="math display">(60 - 62.2)^2 = (-2.2)^2 = 4.84</span> <span class="math display">(56 - 62.2)^2 = (-6.2)^2 = 38.44</span> <span class="math display">(70 - 62.2)^2 = (7.8)^2 = 60.84</span> <span class="math display">(50 - 62.2)^2 = (-12.2)^2 = 148.84</span> <span class="math display">(75 - 62.2)^2 = (12.8)^2 = 163.84</span></p>
<p><span class="math display">SST = 4.84 + 38.44 + 60.84 + 148.84 + 163.84 = 416.8</span></p>
<p><strong>Step 3: Calculate SSR (Regression Sum of Squares)</strong></p>
<p><span class="math display">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<p><span class="math display">(61.9485736 - 62.2)^2 = (-0.2514264)^2 = 0.0632151</span> <span class="math display">(55.6535591 - 62.2)^2 = (-6.5464409)^2 = 42.8558689</span> <span class="math display">(69.5114310 - 62.2)^2 = (7.3114310)^2 = 53.4570178</span> <span class="math display">(49.3571446 - 62.2)^2 = (-12.8428554)^2 = 164.9389370</span> <span class="math display">(74.5200026 - 62.2)^2 = (12.3200026)^2 = 151.7824640</span></p>
<p><span class="math display">SSR = 413.0975028</span></p>
<p><strong>Step 4: Calculate SSE (Error Sum of Squares)</strong></p>
<p><span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<p><span class="math display">(60 - 61.9485736)^2 = (-1.9485736)^2 = 3.7969384</span> <span class="math display">(56 - 55.6535591)^2 = (0.3464409)^2 = 0.1200212</span> <span class="math display">(70 - 69.5114310)^2 = (0.4885690)^2 = 0.2387198</span> <span class="math display">(50 - 49.3571446)^2 = (0.6428554)^2 = 0.4132631</span> <span class="math display">(75 - 74.5200026)^2 = (0.4799974)^2 = 0.2303975</span></p>
<p><span class="math display">SSE = 4.7024972</span></p>
<p><strong>Step 5: Verify decomposition</strong></p>
<p><span class="math display">SST = SSR + SSE</span> <span class="math display">416.8 = 413.0975028 + 4.7024972</span></p>
<p><strong>Step 6: Calculate R-squared</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{413.0975028}{416.8} = 0.9916</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared  <span class="co"># Should match our calculation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9885135</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization">Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> income, <span class="at">turnout =</span> turnout)</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> turnout)) <span class="sc">+</span></span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb391-7"><a href="#cb391-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb391-8"><a href="#cb391-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Voter Turnout vs Income per Capita"</span>,</span>
<span id="cb391-9"><a href="#cb391-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Income per Capita (thousands €)"</span>,</span>
<span id="cb391-10"><a href="#cb391-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Voter Turnout (%)"</span></span>
<span id="cb391-11"><a href="#cb391-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb391-12"><a href="#cb391-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb391-13"><a href="#cb391-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb391-14"><a href="#cb391-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb391-15"><a href="#cb391-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb391-16"><a href="#cb391-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<p>The analysis shows:</p>
<ol type="1">
<li><p>A very strong positive correlation (<span class="math inline">r = 0.994</span>) between income and voter turnout</p></li>
<li><p>The regression equation <span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span> indicates that:</p>
<ul>
<li>For each €1,000 increase in income, turnout increases by about 1.26 percentage points</li>
<li>The intercept (<span class="math inline">-0.9086</span>) has little practical meaning as income is never zero</li>
</ul></li>
<li><p>The R-squared of 0.9916 indicates that 99.16% of the variance in turnout is explained by income</p></li>
</ol>
</section>
</section>
<section id="example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="level2" data-number="9.38">
<h2 data-number="9.38" class="anchored" data-anchor-id="example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">9.38</span> Example 3. Anxiety Levels and Cognitive Performance: A Laboratory Study</h2>
<section id="data-and-context" class="level3">
<h3 class="anchored" data-anchor-id="data-and-context">Data and Context</h3>
<p>In a psychology experiment, researchers measured the relationship between anxiety levels (measured by galvanic skin response, GSR) and cognitive performance (score on a working memory task).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.4</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>, <span class="fl">6.4</span>, <span class="fl">7.2</span>, <span class="fl">8.0</span>)  <span class="co"># GSR readings</span></span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">62</span>)      <span class="co"># Working memory scores</span></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8993 -0.6660  0.2162  0.6106  1.5262 

Coefficients:
            Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept) 105.3248     1.3189   79.86 0.00000000026 ***
anxiety      -5.4407     0.2359  -23.06 0.00000043549 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.236 on 6 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.987 
F-statistic: 531.9 on 1 and 6 DF,  p-value: 0.0000004355</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{2.1 + 3.4 + 4.2 + 5.1 + 5.8 + 6.4 + 7.2 + 8.0}{8} = \frac{42.2}{8} = 5.275</span></p>
<p><span class="math display">\bar{Y} = \frac{92 + 88 + 84 + 78 + 74 + 70 + 65 + 62}{8} = \frac{613}{8} = 76.625</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.625</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li><span class="math inline">(2.1 - 5.275) = -3.175</span></li>
<li><span class="math inline">(3.4 - 5.275) = -1.875</span></li>
<li><span class="math inline">(4.2 - 5.275) = -1.075</span></li>
<li><span class="math inline">(5.1 - 5.275) = -0.175</span></li>
<li><span class="math inline">(5.8 - 5.275) = 0.525</span></li>
<li><span class="math inline">(6.4 - 5.275) = 1.125</span></li>
<li><span class="math inline">(7.2 - 5.275) = 1.925</span></li>
<li><span class="math inline">(8.0 - 5.275) = 2.725</span></li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">10.08063 + 3.51563 + 1.15563 + 0.03063 + 0.27563 + 1.26563 + 3.70563 +
7.42563 = 27.45500</span></p>
<p><span class="math display">s^2_X = \frac{27.45500}{7} = 3.922143</span></p>
<p>Similarly for Y: Deviations:</p>
<p><span class="math display">15.375, 11.375, 7.375, 1.375, -2.625, -6.625, -11.625, -14.625</span></p>
<p><span class="math display">s^2_Y = \frac{236.875 + 129.391 + 54.391 + 1.891 + 6.891 + 43.891 + 135.141 + 213.891}{7} = \frac{822.362}{7} = 117.4803</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.922143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.4107</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-1" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-correlation-1">Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-3.175 × 15.375) = -48.815625</span></p>
<p><span class="math display">(-1.875 × 11.375) = -21.328125</span></p>
<p><span class="math display">(-1.075 × 7.375) = -7.928125</span></p>
<p><span class="math display">(-0.175 × 1.375) = -0.240625</span></p>
<p><span class="math display">(0.525 × -2.625) = -1.378125</span></p>
<p><span class="math display">(1.125 × -6.625) = -7.453125</span></p>
<p><span class="math display">(1.925 × -11.625) = -22.378125</span></p>
<p><span class="math display">(2.725 × -14.625) = -39.853125</span></p>
<p>Sum <span class="math inline">= -149.375</span></p>
<p><span class="math display">s_{XY} = \frac{-149.375}{7} = -21.33929</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -21.33929</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-21.33929}{\sqrt{3.922143}\sqrt{117.4803}} = -0.9932</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9944073</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-1">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-21.33929}{3.922143} = -5.4407</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-5.4407 × 5.275 = -28.6997</span></li>
<li><span class="math inline">\hat{\beta_0} = 76.625 - (-28.6997) = 105.3247</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
 105.324804   -5.440721 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-calculation">R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>: <span class="math display">\hat{Y} = 105.3247 - 5.4407X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">105.3247</span> <span class="sc">-</span> <span class="fl">5.4407</span> <span class="sc">*</span> anxiety</span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance,</span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Anxiety Performance Predicted
1     2.1          92  93.89923
2     3.4          88  86.82632
3     4.2          84  82.47376
4     5.1          78  77.57713
5     5.8          74  73.76864
6     6.4          70  70.50422
7     7.2          65  66.15166
8     8.0          62  61.79910</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong></p>
<p><span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 822.362</span></p>
<p><span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 816.3094</span></p>
<p><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 6.0526</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{816.3094}{822.362} = 0.9926</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9888459</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1">Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb412-6"><a href="#cb412-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb412-7"><a href="#cb412-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cognitive Performance vs. Anxiety Levels"</span>,</span>
<span id="cb412-8"><a href="#cb412-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Anxiety (GSR)"</span>,</span>
<span id="cb412-9"><a href="#cb412-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Performance Score"</span></span>
<span id="cb412-10"><a href="#cb412-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb412-11"><a href="#cb412-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-2" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-2">Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.993) between anxiety and cognitive performance</li>
<li>For each unit increase in GSR (anxiety), performance decreases by approximately 5.44 points</li>
<li>The model explains 99.26% of the variance in performance scores</li>
<li>The relationship appears to be strongly linear, suggesting a reliable anxiety-performance relationship</li>
<li>The high intercept (105.32) represents the theoretical maximum performance at zero anxiety</li>
</ol>
</section>
<section id="study-limitations" class="level3">
<h3 class="anchored" data-anchor-id="study-limitations">Study Limitations</h3>
<ol type="1">
<li>Small sample size (n=8)</li>
<li>Possible other confounding variables</li>
<li>Limited range of anxiety levels</li>
<li>Cross-sectional rather than longitudinal data</li>
</ol>
</section>
</section>
<section id="example-4.-anxiety-vs.-performance-correlation-and-regression-analysis" class="level2" data-number="9.39">
<h2 data-number="9.39" class="anchored" data-anchor-id="example-4.-anxiety-vs.-performance-correlation-and-regression-analysis"><span class="header-section-number">9.39</span> Example 4. Anxiety vs.&nbsp;Performance: Correlation and Regression Analysis</h2>
<p>In this tutorial, we’ll explore the relationship between test anxiety levels and exam performance among university students. Research suggests that while a small amount of anxiety can be motivating, excessive anxiety typically impairs performance through reduced concentration, working memory interference, and physical symptoms (Yerkes-Dodson law). We’ll analyze data from 8 students to understand this relationship mathematically.</p>
</section>
<section id="data-presentation" class="level2" data-number="9.40">
<h2 data-number="9.40" class="anchored" data-anchor-id="data-presentation"><span class="header-section-number">9.40</span> Data Presentation</h2>
<section id="the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="the-dataset">The Dataset</h3>
<p>We collected data from 8 students, measuring:</p>
<ul>
<li><strong>X</strong>: Test anxiety score (1-10 scale, where 1 = very low, 10 = very high)</li>
<li><strong>Y</strong>: Exam performance (percentage score)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our data</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.2</span>, <span class="fl">4.1</span>, <span class="fl">4.8</span>, <span class="fl">5.6</span>, <span class="fl">6.3</span>, <span class="fl">7.0</span>, <span class="fl">7.9</span>)  <span class="co"># Anxiety scores</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">77</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>)      <span class="co"># Exam scores (%)</span></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for easy viewing</span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance</span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Anxiety Performance
1       1     2.5          80
2       2     3.2          85
3       3     4.1          78
4       4     4.8          82
5       5     5.6          77
6       6     6.3          74
7       7     7.0          68
8       8     7.9          72</code></pre>
</div>
</div>
</section>
<section id="initial-visualization" class="level3">
<h3 class="anchored" data-anchor-id="initial-visualization">Initial Visualization</h3>
<p>Let’s first visualize our data to get an intuitive sense of the relationship:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot</span></span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Anxiety, <span class="at">y =</span> Performance)) <span class="sc">+</span></span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Test Anxiety vs. Exam Performance"</span>,</span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Test Anxiety Score"</span>,</span>
<span id="cb415-9"><a href="#cb415-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Exam Performance (%)"</span></span>
<span id="cb415-10"><a href="#cb415-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb415-11"><a href="#cb415-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb415-12"><a href="#cb415-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb415-13"><a href="#cb415-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summary-statistics" class="level2" data-number="9.41">
<h2 data-number="9.41" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">9.41</span> Summary Statistics</h2>
<section id="calculating-the-means" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-means">Calculating the Means</h3>
<p>The mean is the average value, calculated by summing all observations and dividing by the number of observations.</p>
<p><strong>Mean of Anxiety Scores (X):</strong> <span class="math display">\bar{X} = \frac{\sum_{i=1}^{n} X_i}{n} = \frac{2.5 + 3.2 + 4.1 + 4.8 + 5.6 + 6.3 + 7.0 + 7.9}{8}</span></p>
<p><span class="math display">\bar{X} = \frac{41.4}{8} = 5.175</span></p>
<p><strong>Mean of Performance Scores (Y):</strong> <span class="math display">\bar{Y} = \frac{\sum_{i=1}^{n} Y_i}{n} = \frac{80 + 85 + 78 + 82 + 77 + 74 + 68 + 72}{8}</span></p>
<p><span class="math display">\bar{Y} = \frac{616}{8} = 77</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify our calculations</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(anxiety)</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(performance)</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Anxiety:"</span>, mean_x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Anxiety: 5.175 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean Performance:"</span>, mean_y, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean Performance: 77 </code></pre>
</div>
</div>
</section>
<section id="calculating-variance-and-standard-deviation" class="level3">
<h3 class="anchored" data-anchor-id="calculating-variance-and-standard-deviation">Calculating Variance and Standard Deviation</h3>
<p>Variance measures how spread out the data is from the mean. We use the sample variance formula (dividing by n-1).</p>
<p><strong>Variance of X:</strong></p>
<p>First, calculate deviations from the mean <span class="math inline">(X_i - \bar{X})</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2.5</td>
<td><span class="math inline">2.5 - 5.175 = -2.675</span></td>
<td><span class="math inline">(-2.675)^2 = 7.1556</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>3.2</td>
<td><span class="math inline">3.2 - 5.175 = -1.975</span></td>
<td><span class="math inline">(-1.975)^2 = 3.9006</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>4.1</td>
<td><span class="math inline">4.1 - 5.175 = -1.075</span></td>
<td><span class="math inline">(-1.075)^2 = 1.1556</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4.8</td>
<td><span class="math inline">4.8 - 5.175 = -0.375</span></td>
<td><span class="math inline">(-0.375)^2 = 0.1406</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5.6</td>
<td><span class="math inline">5.6 - 5.175 = 0.425</span></td>
<td><span class="math inline">(0.425)^2 = 0.1806</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6.3</td>
<td><span class="math inline">6.3 - 5.175 = 1.125</span></td>
<td><span class="math inline">(1.125)^2 = 1.2656</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>7.0</td>
<td><span class="math inline">7.0 - 5.175 = 1.825</span></td>
<td><span class="math inline">(1.825)^2 = 3.3306</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>7.9</td>
<td><span class="math inline">7.9 - 5.175 = 2.725</span></td>
<td><span class="math inline">(2.725)^2 = 7.4256</span></td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td><strong>24.555</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1} = \frac{24.555}{7} = 3.5079</span></p>
<p><span class="math display">s_X = \sqrt{3.5079} = 1.8730</span></p>
<p><strong>Variance of Y:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>80</td>
<td><span class="math inline">80 - 77 = 3</span></td>
<td><span class="math inline">(3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>85</td>
<td><span class="math inline">85 - 77 = 8</span></td>
<td><span class="math inline">(8)^2 = 64</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>78</td>
<td><span class="math inline">78 - 77 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>82</td>
<td><span class="math inline">82 - 77 = 5</span></td>
<td><span class="math inline">(5)^2 = 25</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>77</td>
<td><span class="math inline">77 - 77 = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>74</td>
<td><span class="math inline">74 - 77 = -3</span></td>
<td><span class="math inline">(-3)^2 = 9</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>68</td>
<td><span class="math inline">68 - 77 = -9</span></td>
<td><span class="math inline">(-9)^2 = 81</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>72</td>
<td><span class="math inline">72 - 77 = -5</span></td>
<td><span class="math inline">(-5)^2 = 25</span></td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td><strong>214</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_Y = \frac{\sum(Y_i - \bar{Y})^2}{n-1} = \frac{214}{7} = 30.5714</span></p>
<p><span class="math display">s_Y = \sqrt{30.5714} = 5.5291</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify variance and standard deviation</span></span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance of Anxiety:"</span>, <span class="fu">var</span>(anxiety), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variance of Anxiety: 3.507857 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD of Anxiety:"</span>, <span class="fu">sd</span>(anxiety), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of Anxiety: 1.872927 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Variance of Performance:"</span>, <span class="fu">var</span>(performance), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variance of Performance: 30.57143 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SD of Performance:"</span>, <span class="fu">sd</span>(performance), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of Performance: 5.529144 </code></pre>
</div>
</div>
</section>
</section>
<section id="covariance-and-correlation-2" class="level2" data-number="9.42">
<h2 data-number="9.42" class="anchored" data-anchor-id="covariance-and-correlation-2"><span class="header-section-number">9.42</span> Covariance and Correlation</h2>
<section id="calculating-covariance" class="level3">
<h3 class="anchored" data-anchor-id="calculating-covariance">Calculating Covariance</h3>
<p>Covariance measures how two variables vary together. A negative covariance indicates that as one variable increases, the other tends to decrease.</p>
<p><span class="math display">s_{XY} = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Let’s calculate the products for each observation:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-2.675</td>
<td>3</td>
<td><span class="math inline">(-2.675) \times (3) = -8.025</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>-1.975</td>
<td>8</td>
<td><span class="math inline">(-1.975) \times (8) = -15.800</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>-1.075</td>
<td>1</td>
<td><span class="math inline">(-1.075) \times (1) = -1.075</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>-0.375</td>
<td>5</td>
<td><span class="math inline">(-0.375) \times (5) = -1.875</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>0.425</td>
<td>0</td>
<td><span class="math inline">(0.425) \times (0) = 0</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>1.125</td>
<td>-3</td>
<td><span class="math inline">(1.125) \times (-3) = -3.375</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>1.825</td>
<td>-9</td>
<td><span class="math inline">(1.825) \times (-9) = -16.425</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>2.725</td>
<td>-5</td>
<td><span class="math inline">(2.725) \times (-5) = -13.625</span></td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td><strong>-60.2</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s_{XY} = \frac{-60.2}{7} = -8.6</span></p>
</section>
<section id="calculating-pearson-correlation-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="calculating-pearson-correlation-coefficient">Calculating Pearson Correlation Coefficient</h3>
<p>The correlation coefficient standardizes the covariance to a scale from -1 to +1:</p>
<p><span class="math display">r = \frac{s_{XY}}{s_X \cdot s_Y} = \frac{-8.6}{1.8730 \times 5.5291} = \frac{-8.6}{10.3560} = -0.831</span></p>
<p>This gives us a correlation of <strong>-0.831</strong>, indicating a strong negative relationship between anxiety and performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify correlation</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>actual_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(anxiety, performance)</span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson correlation coefficient:"</span>, actual_cor, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson correlation coefficient: -0.8304618 </code></pre>
</div>
</div>
</section>
</section>
<section id="simple-ols-regression" class="level2" data-number="9.43">
<h2 data-number="9.43" class="anchored" data-anchor-id="simple-ols-regression"><span class="header-section-number">9.43</span> Simple OLS Regression</h2>
<section id="the-problem-of-modeling-relationships" class="level3">
<h3 class="anchored" data-anchor-id="the-problem-of-modeling-relationships">The Problem of Modeling Relationships</h3>
<p>When we observe a relationship between two variables, we want to find a mathematical model that:</p>
<ol type="1">
<li>Describes the relationship</li>
<li>Allows us to make predictions</li>
<li>Quantifies the strength of the relationship</li>
</ol>
<p>The simplest model is a straight line: <span class="math display">Y = \beta_0 + \beta_1 X + \epsilon</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">Y</span> is the outcome variable (performance)</li>
<li><span class="math inline">X</span> is the predictor variable (anxiety)</li>
<li><span class="math inline">\beta_0</span> is the intercept (performance when anxiety = 0)</li>
<li><span class="math inline">\beta_1</span> is the slope (change in performance per unit change in anxiety)</li>
<li><span class="math inline">\epsilon</span> is the error term (unexplained variation)</li>
</ul>
</section>
<section id="the-idea-of-sum-of-squared-errors-sse" class="level3">
<h3 class="anchored" data-anchor-id="the-idea-of-sum-of-squared-errors-sse">The Idea of Sum of Squared Errors (SSE)</h3>
<section id="why-do-we-need-a-criterion" class="level4">
<h4 class="anchored" data-anchor-id="why-do-we-need-a-criterion">Why Do We Need a Criterion?</h4>
<p>Imagine trying to draw a line through our data points. There are infinitely many lines we could draw! Some would go through the middle of the points, others might be too high or too low, too steep or too flat. We need a systematic way to determine which line is “best.”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize multiple possible lines</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create different possible lines</span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad line 1: Too steep</span></span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">100</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad line 2: Too flat</span></span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">78</span>, <span class="at">slope =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bad line 3: Wrong direction</span></span>
<span id="cb430-12"><a href="#cb430-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">65</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb430-13"><a href="#cb430-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Good line (we'll calculate this properly)</span></span>
<span id="cb430-14"><a href="#cb430-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb430-15"><a href="#cb430-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb430-16"><a href="#cb430-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Which Line Best Fits Our Data?"</span>,</span>
<span id="cb430-17"><a href="#cb430-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Gray dashed lines show poor fits, red line shows the optimal fit"</span>,</span>
<span id="cb430-18"><a href="#cb430-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Test Anxiety Score"</span>,</span>
<span id="cb430-19"><a href="#cb430-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Exam Performance (%)"</span></span>
<span id="cb430-20"><a href="#cb430-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb430-21"><a href="#cb430-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-are-errors-residuals" class="level4">
<h4 class="anchored" data-anchor-id="what-are-errors-residuals">What Are Errors (Residuals)?</h4>
<p>For any line we draw, each data point will have an <strong>error</strong> or <strong>residual</strong> - the vertical distance from the point to the line. This represents how “wrong” our prediction is for that point.</p>
<ul>
<li><strong>Positive error</strong>: The actual value is above the predicted value (we underestimated)</li>
<li><strong>Negative error</strong>: The actual value is below the predicted value (we overestimated)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize errors for the regression line</span></span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance, predicted), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb431-7"><a href="#cb431-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb431-8"><a href="#cb431-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> anxiety, <span class="at">yend =</span> predicted), </span>
<span id="cb431-9"><a href="#cb431-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb431-10"><a href="#cb431-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels for a few errors</span></span>
<span id="cb431-11"><a href="#cb431-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.2</span>, <span class="at">y =</span> <span class="dv">86</span>, <span class="at">label =</span> <span class="st">"Error = +4.9"</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb431-12"><a href="#cb431-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">7.0</span>, <span class="at">y =</span> <span class="dv">69</span>, <span class="at">label =</span> <span class="st">"Error = -1.4"</span>), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb431-13"><a href="#cb431-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb431-14"><a href="#cb431-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Visualizing Errors (Residuals) in Regression"</span>,</span>
<span id="cb431-15"><a href="#cb431-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Dashed lines show the vertical distance from each point to the regression line"</span>,</span>
<span id="cb431-16"><a href="#cb431-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Test Anxiety Score"</span>,</span>
<span id="cb431-17"><a href="#cb431-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Exam Performance (%)"</span></span>
<span id="cb431-18"><a href="#cb431-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb431-19"><a href="#cb431-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="why-square-the-errors" class="level4">
<h4 class="anchored" data-anchor-id="why-square-the-errors">Why Square the Errors?</h4>
<p>Simply adding up the errors won’t work because positive and negative errors cancel out. We could use absolute values, but squaring has several advantages:</p>
<ol type="1">
<li><strong>Mathematical convenience</strong>: Squared functions are differentiable, making it easier to find the minimum using calculus</li>
<li><strong>Penalizes large errors more</strong>: A few large errors are worse than many small errors
<ul>
<li>Error of 4: squared = 16</li>
<li>Two errors of 2: squared = 4 + 4 = 8</li>
<li>Four errors of 1: squared = 1 + 1 + 1 + 1 = 4</li>
</ul></li>
<li><strong>Creates a smooth, bowl-shaped function</strong>: This guarantees a unique minimum</li>
</ol>
</section>
<section id="the-sse-formula" class="level4">
<h4 class="anchored" data-anchor-id="the-sse-formula">The SSE Formula</h4>
<p>The Sum of Squared Errors is: <span class="math display">SSE = \sum_{i=1}^{n}(Y_i - \hat{Y_i})^2 = \sum_{i=1}^{n}(Y_i - (\beta_0 + \beta_1 X_i))^2</span></p>
<p><span class="math display">
\min_{\beta}\ \sum_{i=1}^n\bigl(Y_i-\hat{Y}_i(\beta)\bigr)^2,
\quad\text{where } \hat{Y}_i(\beta)=\beta_0+\beta_1X_i.
</span></p>
<p>This formula:</p>
<ul>
<li>Takes each actual value (<span class="math inline">Y_i</span>)</li>
<li>Subtracts the predicted value (<span class="math inline">\hat{Y}_i(\beta)=\beta_0+\beta_1X_i</span>)</li>
<li>Squares the difference</li>
<li>Adds them all up</li>
</ul>
</section>
<section id="finding-the-best-line" class="level4">
<h4 class="anchored" data-anchor-id="finding-the-best-line">Finding the Best Line</h4>
<p>The “best” line is the one that minimizes SSE. Using calculus (taking derivatives with respect to <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> and setting them to zero), we get the OLS formulas.</p>
</section>
</section>
<section id="ols-estimators" class="level3">
<h3 class="anchored" data-anchor-id="ols-estimators">OLS Estimators</h3>
<p>The Ordinary Least Squares (OLS) method finds the values of <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> that minimize SSE:</p>
<p><strong>Slope estimator:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><strong>Intercept estimator:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
</section>
<section id="calculating-the-ols-parameters" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-ols-parameters">Calculating the OLS Parameters</h3>
<p>Using our calculated values:</p>
<ul>
<li><span class="math inline">s_{XY} = -8.6</span></li>
<li><span class="math inline">s^2_X = 3.5079</span></li>
<li><span class="math inline">\bar{X} = 5.175</span></li>
<li><span class="math inline">\bar{Y} = 77</span></li>
</ul>
<p><strong>Step 1: Calculate the slope</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-8.6}{3.5079} = -2.451</span></p>
<p><strong>Step 2: Calculate the intercept</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X} = 77 - (-2.451 \times 5.175) = 77 + 12.684 = 89.684</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify with R</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
  89.687233   -2.451639 </code></pre>
</div>
</div>
<p><strong>Our regression equation is:</strong> <span class="math display">\hat{Y} = 89.684 - 2.451X</span></p>
<p>This means:</p>
<ul>
<li>When anxiety = 0, predicted performance = 89.68%</li>
<li>For each 1-point increase in anxiety, performance decreases by 2.45%</li>
</ul>
</section>
</section>
<section id="plotting-the-model" class="level2" data-number="9.44">
<h2 data-number="9.44" class="anchored" data-anchor-id="plotting-the-model"><span class="header-section-number">9.44</span> Plotting the Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive plot</span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb434-4"><a href="#cb434-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb434-5"><a href="#cb434-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(anxiety, <span class="dv">1</span>), <span class="st">", "</span>, performance, <span class="st">")"</span>)),</span>
<span id="cb434-6"><a href="#cb434-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb434-7"><a href="#cb434-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">70</span>, </span>
<span id="cb434-8"><a href="#cb434-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ŷ = "</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">" - "</span>, </span>
<span id="cb434-9"><a href="#cb434-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">abs</span>(<span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">2</span>)), <span class="st">"x"</span>),</span>
<span id="cb434-10"><a href="#cb434-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb434-11"><a href="#cb434-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb434-12"><a href="#cb434-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Regression Line: Performance vs. Anxiety"</span>,</span>
<span id="cb434-13"><a href="#cb434-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Higher anxiety is associated with lower exam performance"</span>,</span>
<span id="cb434-14"><a href="#cb434-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Test Anxiety Score"</span>,</span>
<span id="cb434-15"><a href="#cb434-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Exam Performance (%)"</span></span>
<span id="cb434-16"><a href="#cb434-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb434-17"><a href="#cb434-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb434-18"><a href="#cb434-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb434-19"><a href="#cb434-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-evaluation" class="level2" data-number="9.45">
<h2 data-number="9.45" class="anchored" data-anchor-id="model-evaluation"><span class="header-section-number">9.45</span> Model Evaluation</h2>
<section id="variance-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="variance-decomposition">Variance Decomposition</h3>
<p>The total variation in Y can be decomposed into two parts:</p>
<p><span class="math display">SST = SSE + SSR</span></p>
<p>Where:</p>
<ul>
<li><strong>SST (Total Sum of Squares)</strong>: Total variation in Y</li>
<li><strong>SSE (Sum of Squared Errors)</strong>: Unexplained variation<br>
</li>
<li><strong>SSR (Sum of Squares Regression)</strong>: Explained variation</li>
</ul>
<p>Let’s calculate each sum:</p>
<p><strong>Step 1: Calculate predicted values</strong></p>
<p>Using <span class="math inline">\hat{Y} = 89.684 - 2.451X</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 89.684 - 2.451X_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2.5</td>
<td>80</td>
<td><span class="math inline">89.684 - 2.451(2.5) = 83.556</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>3.2</td>
<td>85</td>
<td><span class="math inline">89.684 - 2.451(3.2) = 81.841</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>4.1</td>
<td>78</td>
<td><span class="math inline">89.684 - 2.451(4.1) = 79.635</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4.8</td>
<td>82</td>
<td><span class="math inline">89.684 - 2.451(4.8) = 77.919</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5.6</td>
<td>77</td>
<td><span class="math inline">89.684 - 2.451(5.6) = 75.968</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6.3</td>
<td>74</td>
<td><span class="math inline">89.684 - 2.451(6.3) = 74.253</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>7.0</td>
<td>68</td>
<td><span class="math inline">89.684 - 2.451(7.0) = 72.527</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>7.9</td>
<td>72</td>
<td><span class="math inline">89.684 - 2.451(7.9) = 70.321</span></td>
</tr>
</tbody>
</table>
<p><strong>Step 2: Calculate sum of squares</strong></p>
<p><strong>SST</strong> (Total variation): <span class="math display">SST = \sum(Y_i - \bar{Y})^2</span></p>
<p>From our earlier variance calculation: <span class="math display">SST = (n-1) \times s^2_Y = 7 \times 30.5714 = 214</span></p>
<p><strong>SSE</strong> (Unexplained variation): <span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 26%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">(Y_i - \hat{Y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>80</td>
<td>83.556</td>
<td>-3.556</td>
<td>12.645</td>
</tr>
<tr class="even">
<td>2</td>
<td>85</td>
<td>81.841</td>
<td>3.159</td>
<td>9.979</td>
</tr>
<tr class="odd">
<td>3</td>
<td>78</td>
<td>79.635</td>
<td>-1.635</td>
<td>2.673</td>
</tr>
<tr class="even">
<td>4</td>
<td>82</td>
<td>77.919</td>
<td>4.081</td>
<td>16.655</td>
</tr>
<tr class="odd">
<td>5</td>
<td>77</td>
<td>75.968</td>
<td>1.032</td>
<td>1.065</td>
</tr>
<tr class="even">
<td>6</td>
<td>74</td>
<td>74.253</td>
<td>-0.253</td>
<td>0.064</td>
</tr>
<tr class="odd">
<td>7</td>
<td>68</td>
<td>72.527</td>
<td>-4.527</td>
<td>20.494</td>
</tr>
<tr class="even">
<td>8</td>
<td>72</td>
<td>70.321</td>
<td>1.679</td>
<td>2.819</td>
</tr>
<tr class="odd">
<td><strong>Sum</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>66.394</strong></td>
</tr>
</tbody>
</table>
<p><strong>SSR</strong> (Explained variation): <span class="math display">SSR = SST - SSE = 214 - 66.394 = 147.606</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify calculations</span></span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a>anova_table <span class="ot">&lt;-</span> <span class="fu">anova</span>(model)</span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Regression):"</span>, anova_table<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Regression): 147.5887 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Residual):"</span>, anova_table<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Residual): 66.41132 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Total):"</span>, <span class="fu">sum</span>(anova_table<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Total): 214 </code></pre>
</div>
</div>
</section>
<section id="r-squared-coefficient-of-determination" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-coefficient-of-determination">R-squared (Coefficient of Determination)</h3>
<p>R-squared tells us what proportion of the total variation in Y is explained by our model:</p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{147.606}{214} = 0.690</span></p>
<p>This means our model explains <strong>69.0%</strong> of the variation in exam performance.</p>
<p><strong>Alternative formula using correlation:</strong> <span class="math display">R^2 = r^2 = (-0.831)^2 = 0.691</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify R-squared</span></span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.6896667 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Correlation squared:"</span>, <span class="fu">cor</span>(anxiety, performance)<span class="sc">^</span><span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Correlation squared: 0.6896667 </code></pre>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Variance Decomposition - summary
</div>
</div>
<div class="callout-body-container callout-body">
<p>Imagine you’re trying to understand why people have different salaries at a company. Some people make $40,000, others make $80,000, and some make $120,000. There’s <strong>variation</strong> in salaries - they’re not all the same.</p>
<section id="the-total-variation-sst" class="level4">
<h4 class="anchored" data-anchor-id="the-total-variation-sst">The Total Variation (SST)</h4>
<p>This is simply asking: “How spread out are all the salaries from the average salary?”</p>
<p>If the average salary is $70,000, then SST measures how far each person’s salary differs from $70,000, squares those differences (to make them all positive), and adds them up. It’s the <strong>total amount of variation we’re trying to understand</strong>.</p>
</section>
<section id="the-explained-variation-ssr" class="level4">
<h4 class="anchored" data-anchor-id="the-explained-variation-ssr">The Explained Variation (SSR)</h4>
<p>Now suppose we build a model that predicts salary based on years of experience. Our model might say: - 2 years experience → predicts $50,000 - 5 years experience → predicts $70,000<br>
- 10 years experience → predicts $100,000</p>
<p>SSR measures how much these <strong>predictions vary from the average</strong>. It’s the variation that our model successfully “explains” through the relationship with experience. It’s like saying “this much of the salary differences between people is because they have different amounts of experience.”</p>
</section>
<section id="the-unexplained-variation-sse" class="level4">
<h4 class="anchored" data-anchor-id="the-unexplained-variation-sse">The Unexplained Variation (SSE)</h4>
<p>This is what’s <strong>left over</strong> - the part our model can’t explain.</p>
<p>Maybe two people both have 5 years of experience, but one makes $65,000 and another makes $75,000. Our model predicted $70,000 for both. These differences from our predictions (the errors) represent variation due to other factors we haven’t captured - maybe education, performance, negotiation skills, or just random luck.</p>
<blockquote class="blockquote">
<p>Note: <strong>Total Variation = Explained Variation + Unexplained Variation</strong> (<strong>SST = SSR + SSE</strong>)</p>
</blockquote>
</section>
<section id="why-this-matters" class="level4">
<h4 class="anchored" data-anchor-id="why-this-matters">Why This Matters</h4>
<p>This decomposition lets us calculate <strong>R-squared</strong> (R²), which is simply: <span class="math display">R^2 = \frac{SSR}{SST} = \frac{\text{Explained Variation}}{\text{Total Variation}}</span></p>
<p>If R² = 0.70, it means our model explains 70% of why the Y values differ from each other. The remaining 30% is due to factors we haven’t captured or random noise.</p>
<p>Think of it like solving a mystery: SST is the total mystery to solve, SSR is how much of the mystery you’ve solved, and SSE is what remains unsolved!</p>
</section>
</div>
</div>
<hr>
</section>
</section>
<section id="effect-size" class="level2" data-number="9.46">
<h2 data-number="9.46" class="anchored" data-anchor-id="effect-size"><span class="header-section-number">9.46</span> Effect Size</h2>
<p>The slope coefficient <span class="math inline">\hat{\beta_1} = -2.451</span> is our effect size. It tells us:</p>
<ul>
<li><strong>Magnitude</strong>: Each 1-point increase in anxiety is associated with a 2.45% decrease in performance</li>
<li><strong>Practical significance</strong>: A student moving from low anxiety (3) to high anxiety (7) would see an expected performance decrease of <span class="math inline">2.451 \times 4 = 9.80\%</span></li>
</ul>
<p><strong>Standardized effect size (correlation coefficient):</strong> The correlation <span class="math inline">r = -0.831</span> indicates a <strong>strong negative relationship</strong>.</p>
<p>Cohen’s guidelines for interpreting correlation:</p>
<ul>
<li>Small effect: <span class="math inline">|r| = 0.10</span></li>
<li>Medium effect: <span class="math inline">|r| = 0.30</span></li>
<li>Large effect: <span class="math inline">|r| = 0.50</span></li>
</ul>
<p>Our <span class="math inline">|r| = 0.831</span> represents a large effect size.</p>
</section>
<section id="confidence-intervals-and-statistical-significance" class="level2" data-number="9.47">
<h2 data-number="9.47" class="anchored" data-anchor-id="confidence-intervals-and-statistical-significance"><span class="header-section-number">9.47</span> Confidence Intervals and Statistical Significance</h2>
<section id="standard-error-of-the-regression" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-of-the-regression">Standard Error of the Regression</h3>
<p>First, we need the standard error of the residuals:</p>
<p><span class="math display">s_e = \sqrt{\frac{SSE}{n-2}} = \sqrt{\frac{66.394}{6}} = \sqrt{11.066} = 3.327</span></p>
</section>
<section id="standard-error-of-the-slope" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-of-the-slope">Standard Error of the Slope</h3>
<p>The standard error of <span class="math inline">\hat{\beta_1}</span> is:</p>
<p><span class="math display">SE(\hat{\beta_1}) = \frac{s_e}{\sqrt{\sum(X_i - \bar{X})^2}} = \frac{3.327}{\sqrt{24.555}} = \frac{3.327}{4.955} = 0.671</span></p>
</section>
<section id="confidence-interval-for-the-slope" class="level3">
<h3 class="anchored" data-anchor-id="confidence-interval-for-the-slope">95% Confidence Interval for the Slope</h3>
<p><strong>In plain English:</strong> A confidence interval gives us a range of plausible values for our true slope. If we repeated this study many times, 95% of the intervals we calculate would contain the true slope value.</p>
<p>The formula uses a critical value (approximately 2.45 for 6 degrees of freedom):</p>
<p><span class="math display">CI = \hat{\beta_1} \pm (critical\_value \times SE(\hat{\beta_1}))</span> <span class="math display">CI = -2.451 \pm (2.45 \times 0.671)</span> <span class="math display">CI = -2.451 \pm 1.644</span> <span class="math display">CI = [-4.095, -0.807]</span></p>
<p><strong>Interpretation:</strong> We are 95% confident that the true change in performance per unit change in anxiety is between -4.10% and -0.81%.</p>
</section>
<section id="statistical-significance" class="level3">
<h3 class="anchored" data-anchor-id="statistical-significance">Statistical Significance</h3>
<p>To test if the relationship is statistically significant (i.e., not due to chance), we calculate a t-statistic:</p>
<p><span class="math display">t = \frac{\hat{\beta_1}}{SE(\hat{\beta_1})} = \frac{-2.451}{0.671} = -3.653</span></p>
<p><strong>In plain English:</strong> This t-value tells us how many standard errors our slope is away from zero. An absolute value of 3.65 is quite large (typically, values beyond ±2.45 are considered significant for our sample size), providing strong evidence of a real negative relationship between anxiety and performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify calculations with R</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
   Min     1Q Median     3Q    Max 
-4.526 -2.116  0.400  2.050  4.081 

Coefficients:
            Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)  89.6872     3.6682  24.450 0.000000308 ***
anxiety      -2.4516     0.6714  -3.652      0.0107 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.327 on 6 degrees of freedom
Multiple R-squared:  0.6897,    Adjusted R-squared:  0.6379 
F-statistic: 13.33 on 1 and 6 DF,  p-value: 0.01069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 80.711582 98.6628838
anxiety     -4.094474 -0.8088048</code></pre>
</div>
</div>
</section>
</section>
<section id="summary-and-interpretation" class="level2" data-number="9.48">
<h2 data-number="9.48" class="anchored" data-anchor-id="summary-and-interpretation"><span class="header-section-number">9.48</span> Summary and Interpretation</h2>
<section id="what-weve-learned" class="level3">
<h3 class="anchored" data-anchor-id="what-weve-learned">What We’ve Learned</h3>
<ol type="1">
<li><strong>There is a negative relationship</strong> between test anxiety and exam performance (r = -0.831)</li>
<li><strong>The relationship is moderately strong</strong> - anxiety explains 69.0% of the variation in performance</li>
<li><strong>The effect is substantial</strong> - each 1-point increase in anxiety is associated with about a 2.5% decrease in performance</li>
<li><strong>The relationship is statistically significant</strong> - very unlikely to be due to chance</li>
</ol>
</section>
<section id="practical-implications" class="level3">
<h3 class="anchored" data-anchor-id="practical-implications">Practical Implications</h3>
<p>Our analysis suggests that high test anxiety impairs performance, possibly through:</p>
<ul>
<li>Cognitive interference (worrying thoughts compete for working memory)</li>
<li>Physical symptoms (sweating, rapid heartbeat) that distract from the task</li>
<li>Negative self-talk reducing confidence and motivation</li>
<li>Test-taking behaviors (rushing, second-guessing answers)</li>
</ul>
</section>
<section id="recommendations-based-on-findings" class="level3">
<h3 class="anchored" data-anchor-id="recommendations-based-on-findings">Recommendations Based on Findings</h3>
<p>Given the strong negative relationship, interventions might include:</p>
<ul>
<li>Teaching anxiety management techniques (deep breathing, progressive muscle relaxation)</li>
<li>Cognitive restructuring to address catastrophic thinking</li>
<li>Study skills training to increase preparation confidence</li>
<li>Practice tests to reduce fear of the unknown</li>
</ul>
</section>
<section id="limitations-of-our-analysis" class="level3">
<h3 class="anchored" data-anchor-id="limitations-of-our-analysis">Limitations of Our Analysis</h3>
<ol type="1">
<li><strong>Small sample size</strong> (n = 8) limits generalizability</li>
<li><strong>Linear assumption</strong> - the relationship might be curved (optimal anxiety might exist)</li>
<li><strong>Other variables</strong> not considered (preparation time, ability, sleep, etc.)</li>
<li><strong>Causation vs.&nbsp;correlation</strong> - we cannot prove anxiety causes poor performance</li>
<li><strong>Self-reported anxiety</strong> - subjective measures may not reflect physiological arousal</li>
</ol>
</section>
<section id="complete-r-code" class="level3">
<h3 class="anchored" data-anchor-id="complete-r-code">Complete R Code</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete analysis code</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.2</span>, <span class="fl">4.1</span>, <span class="fl">4.8</span>, <span class="fl">5.6</span>, <span class="fl">6.3</span>, <span class="fl">7.0</span>, <span class="fl">7.9</span>)</span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">77</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>)</span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive statistics</span></span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety); <span class="fu">sd</span>(anxiety)</span>
<span id="cb449-7"><a href="#cb449-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance); <span class="fu">sd</span>(performance)</span>
<span id="cb449-8"><a href="#cb449-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-9"><a href="#cb449-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation</span></span>
<span id="cb449-10"><a href="#cb449-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span>
<span id="cb449-11"><a href="#cb449-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-12"><a href="#cb449-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression</span></span>
<span id="cb449-13"><a href="#cb449-13" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb449-14"><a href="#cb449-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb449-15"><a href="#cb449-15" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span>
<span id="cb449-16"><a href="#cb449-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-17"><a href="#cb449-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb449-18"><a href="#cb449-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb449-19"><a href="#cb449-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb449-20"><a href="#cb449-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb449-21"><a href="#cb449-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb449-22"><a href="#cb449-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb449-23"><a href="#cb449-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-24"><a href="#cb449-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics</span></span>
<span id="cb449-25"><a href="#cb449-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span>
<span id="cb449-26"><a href="#cb449-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-27"><a href="#cb449-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA table</span></span>
<span id="cb449-28"><a href="#cb449-28" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="level2" data-number="9.49">
<h2 data-number="9.49" class="anchored" data-anchor-id="example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">9.49</span> Example 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis</h2>
<section id="data-generating-process" class="level3">
<h3 class="anchored" data-anchor-id="data-generating-process">Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<p><span class="math display">\begin{aligned}
&amp; Y_{\text{Gallagher}} = 12 - 0.8X_{\text{DM}} + \varepsilon \\
&amp; \varepsilon \sim \mathcal{N}(0, 1) \\
&amp; X_{\text{DM}} \in \{3, 5, 7, 10, 12, 15\}
\end{aligned}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb450-11"><a href="#cb450-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb450-12"><a href="#cb450-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb450-13"><a href="#cb450-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-1" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics-1">Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667</span></p>
<p><span class="math display">\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">
32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332
</span></p>
<p><span class="math display">s^2_X = \frac{101.3332}{5} = 20.2666</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">s^2_Y = \frac{56.3483}{5} = 11.2697</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-3" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-correlation-3">Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">s_{XY} = \frac{-70.3670}{5} = -14.0734</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-2">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-0.6944 × 8.6667 = -6.0181</span></li>
<li><span class="math inline">\hat{\beta_0} = 5.7167 - (-6.0181) = 11.7348</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation-1" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-calculation-1">R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 11.7348 - 0.6944X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb468-5"><a href="#cb468-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb468-6"><a href="#cb468-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb468-7"><a href="#cb468-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb468-8"><a href="#cb468-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 56.3483</span> <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271</span> <span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters">Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-3"><a href="#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb472-4"><a href="#cb472-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb472-5"><a href="#cb472-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb472-6"><a href="#cb472-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb472-7"><a href="#cb472-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb472-8"><a href="#cb472-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-9"><a href="#cb472-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb472-10"><a href="#cb472-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb472-11"><a href="#cb472-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-12"><a href="#cb472-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb472-13"><a href="#cb472-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb472-14"><a href="#cb472-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb472-15"><a href="#cb472-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-16"><a href="#cb472-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb472-17"><a href="#cb472-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb472-18"><a href="#cb472-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb472-19"><a href="#cb472-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb472-20"><a href="#cb472-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb472-21"><a href="#cb472-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb472-22"><a href="#cb472-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-23"><a href="#cb472-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb472-24"><a href="#cb472-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb472-25"><a href="#cb472-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb472-26"><a href="#cb472-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb472-27"><a href="#cb472-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb472-28"><a href="#cb472-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb472-29"><a href="#cb472-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb472-30"><a href="#cb472-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb472-31"><a href="#cb472-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb472-32"><a href="#cb472-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb472-33"><a href="#cb472-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb472-34"><a href="#cb472-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb472-35"><a href="#cb472-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb472-36"><a href="#cb472-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb472-37"><a href="#cb472-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb472-38"><a href="#cb472-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb472-39"><a href="#cb472-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb472-40"><a href="#cb472-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb472-41"><a href="#cb472-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb472-42"><a href="#cb472-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb472-43"><a href="#cb472-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb472-44"><a href="#cb472-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb472-45"><a href="#cb472-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_en_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="observations-about-model-fit">Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation-3" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-3">Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3">
<h3 class="anchored" data-anchor-id="study-context">Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>
<hr>
</section>
</section>
<section id="appendix-d-ols-regression-in-matrix-form---manual-calculations" class="level2" data-number="9.50">
<h2 data-number="9.50" class="anchored" data-anchor-id="appendix-d-ols-regression-in-matrix-form---manual-calculations"><span class="header-section-number">9.50</span> Appendix D: OLS Regression in Matrix Form - Manual Calculations (*)</h2>
<section id="a.1-essential-linear-algebra-concepts" class="level3">
<h3 class="anchored" data-anchor-id="a.1-essential-linear-algebra-concepts">A.1 Essential Linear Algebra Concepts</h3>
<p>Before diving into OLS regression, we need to understand some fundamental linear algebra concepts.</p>
<section id="a.1.1-matrix-transpose" class="level4">
<h4 class="anchored" data-anchor-id="a.1.1-matrix-transpose">A.1.1 Matrix Transpose</h4>
<p>The transpose of a matrix <span class="math inline">\mathbf{A}</span>, denoted <span class="math inline">\mathbf{A}^T</span>, is obtained by swapping rows and columns:</p>
<p><span class="math display">
\mathbf{A} = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \\ 5 &amp; 6 \end{bmatrix} \implies \mathbf{A}^T = \begin{bmatrix} 1 &amp; 3 &amp; 5 \\ 2 &amp; 4 &amp; 6 \end{bmatrix}
</span></p>
<p><strong>Properties:</strong></p>
<ul>
<li><p><span class="math inline">(A^T)^T = A</span></p></li>
<li><p><span class="math inline">(AB)^T = B^T A^T</span></p></li>
<li><p><span class="math inline">(A + B)^T = A^T + B^T</span></p></li>
</ul>
</section>
<section id="a.1.2-matrix-multiplication" class="level4">
<h4 class="anchored" data-anchor-id="a.1.2-matrix-multiplication">A.1.2 Matrix Multiplication</h4>
<p>For matrices <span class="math inline">\mathbf{A}</span> (of size <span class="math inline">m \times n</span>) and <span class="math inline">\mathbf{B}</span> (of size <span class="math inline">n \times p</span>), the product <span class="math inline">\mathbf{AB}</span> is an <span class="math inline">m \times p</span> matrix where element <span class="math inline">(i,j)</span> is:</p>
<p><span class="math display">
(\mathbf{AB})_{ij} = \sum_{k=1}^n a_{ik}b_{kj}
</span></p>
<p><strong>Example:</strong></p>
<p><span class="math display">
\begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix} \begin{bmatrix} 5 &amp; 6 \\ 7 &amp; 8 \end{bmatrix} = \begin{bmatrix} 1(5)+2(7) &amp; 1(6)+2(8) \\ 3(5)+4(7) &amp; 3(6)+4(8) \end{bmatrix} = \begin{bmatrix} 19 &amp; 22 \\ 43 &amp; 50 \end{bmatrix}
</span></p>
</section>
<section id="a.1.3-identity-matrix" class="level4">
<h4 class="anchored" data-anchor-id="a.1.3-identity-matrix">A.1.3 Identity Matrix</h4>
<p>The identity matrix <span class="math inline">\mathbf{I}_n</span> is an <span class="math inline">n \times n</span> matrix with 1’s on the diagonal and 0’s elsewhere:</p>
<p><span class="math display">
\mathbf{I}_3 = \begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}
</span></p>
<p><strong>Property:</strong> <span class="math inline">\mathbf{AI} = \mathbf{IA} = \mathbf{A}</span></p>
</section>
<section id="a.1.4-determinant" class="level4">
<h4 class="anchored" data-anchor-id="a.1.4-determinant">A.1.4 Determinant</h4>
<p>The determinant is a scalar value that characterizes certain properties of a square matrix. It indicates whether a matrix is invertible.</p>
<p><strong>For a</strong> <span class="math inline">2 \times 2</span> matrix:</p>
<p><span class="math display">
\det\begin{bmatrix} a &amp; b \\ c &amp; d \end{bmatrix} = ad - bc
</span></p>
<p><strong>Example:</strong></p>
<p><span class="math display">
\det\begin{bmatrix} 3 &amp; 8 \\ 4 &amp; 6 \end{bmatrix} = 3(6) - 8(4) = 18 - 32 = -14
</span></p>
<p><strong>For a</strong> <span class="math inline">3 \times 3</span> matrix (cofactor expansion along first row):</p>
<p><span class="math display">
\det\begin{bmatrix} a &amp; b &amp; c \\ d &amp; e &amp; f \\ g &amp; h &amp; i \end{bmatrix} = a\begin{vmatrix} e &amp; f \\ h &amp; i \end{vmatrix} - b\begin{vmatrix} d &amp; f \\ g &amp; i \end{vmatrix} + c\begin{vmatrix} d &amp; e \\ g &amp; h \end{vmatrix}
</span></p>
<p><strong>Properties:</strong></p>
<ul>
<li><p>If <span class="math inline">\det(\mathbf{A}) = 0</span>, the matrix is <strong>singular</strong> (not invertible)</p></li>
<li><p>If <span class="math inline">\det(\mathbf{A}) \neq 0</span>, the matrix is <strong>non-singular</strong> (invertible)</p></li>
<li><p><span class="math inline">\det(\mathbf{AB}) = \det(\mathbf{A})\det(\mathbf{B})</span></p></li>
<li><p><span class="math inline">\det(\mathbf{A}^T) = \det(\mathbf{A})</span></p></li>
</ul>
</section>
<section id="a.1.5-matrix-inverse" class="level4">
<h4 class="anchored" data-anchor-id="a.1.5-matrix-inverse">A.1.5 Matrix Inverse</h4>
<p>The inverse of matrix <span class="math inline">\mathbf{A}</span>, denoted <span class="math inline">\mathbf{A}^{-1}</span>, satisfies:</p>
<p><span class="math display">
\mathbf{AA}^{-1} = \mathbf{A}^{-1}\mathbf{A} = \mathbf{I}
</span></p>
<p><strong>For a</strong> <span class="math inline">2 \times 2</span> matrix:</p>
<p><span class="math display">
\begin{bmatrix} a &amp; b \\ c &amp; d \end{bmatrix}^{-1} = \frac{1}{ad-bc}\begin{bmatrix} d &amp; -b \\ -c &amp; a \end{bmatrix}
</span></p>
<p><strong>For larger matrices</strong>, the inverse can be computed as:</p>
<p><span class="math display">
\mathbf{A}^{-1} = \frac{1}{\det(\mathbf{A})}\text{adj}(\mathbf{A})
</span></p>
<p>where <span class="math inline">\text{adj}(\mathbf{A})</span> is the adjugate (transpose of the cofactor matrix).</p>
<p><strong>Properties:</strong></p>
<ul>
<li><p><span class="math inline">(A^{-1})^{-1} = A</span></p></li>
<li><p><span class="math inline">(AB)^{-1} = B^{-1}A^{-1}</span></p></li>
<li><p><span class="math inline">(A^T)^{-1} = (A^{-1})^T</span></p></li>
</ul>
</section>
<section id="a.1.6-matrix-rank" class="level4">
<h4 class="anchored" data-anchor-id="a.1.6-matrix-rank">A.1.6 Matrix Rank</h4>
<p>The rank of a matrix is the maximum number of linearly independent rows (or columns). A matrix <span class="math inline">\mathbf{X}</span> of size <span class="math inline">n \times p</span> has:</p>
<ul>
<li><p><strong>Full column rank</strong> if <span class="math inline">\text{rank}(\mathbf{X}) = p</span> (all columns are independent)</p></li>
<li><p><strong>Rank deficiency</strong> if <span class="math inline">\text{rank}(\mathbf{X}) &lt; p</span> (multicollinearity exists)</p></li>
</ul>
<p>Full column rank is required for <span class="math inline">\mathbf{X}^T\mathbf{X}</span> to be invertible in regression.</p>
</section>
<section id="a.1.7-quadratic-forms" class="level4">
<h4 class="anchored" data-anchor-id="a.1.7-quadratic-forms">A.1.7 Quadratic Forms</h4>
<p>A quadratic form is an expression of the type:</p>
<p><span class="math display">
\mathbf{x}^T\mathbf{A}\mathbf{x} = \sum_{i=1}^n\sum_{j=1}^n a_{ij}x_ix_j
</span></p>
<p>For a vector <span class="math inline">\mathbf{x} = \begin{bmatrix} x_1 \\ x_2 \end{bmatrix}</span> and matrix <span class="math inline">\mathbf{A} = \begin{bmatrix} a_{11} &amp; a_{12} \\ a_{21} &amp; a_{22} \end{bmatrix}</span>:</p>
<p><span class="math display">
\mathbf{x}^T\mathbf{A}\mathbf{x} = a_{11}x_1^2 + (a_{12}+a_{21})x_1x_2 + a_{22}x_2^2
</span></p>
<p>This is crucial for understanding the OLS objective function.</p>
</section>
</section>
<section id="a.2-ols-minimization-problem-and-derivation" class="level3">
<h3 class="anchored" data-anchor-id="a.2-ols-minimization-problem-and-derivation">A.2 OLS Minimization Problem and Derivation</h3>
<section id="a.2.1-the-objective-function" class="level4">
<h4 class="anchored" data-anchor-id="a.2.1-the-objective-function">A.2.1 The Objective Function</h4>
<p>In matrix notation, the linear regression model is:</p>
<p><span class="math display">
\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}
</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\mathbf{y}</span> is an <span class="math inline">n \times 1</span> vector of observed responses</p></li>
<li><p><span class="math inline">\mathbf{X}</span> is an <span class="math inline">n \times (p+1)</span> design matrix of predictors (including intercept)</p></li>
<li><p><span class="math inline">\boldsymbol{\beta}</span> is a <span class="math inline">(p+1) \times 1</span> vector of regression coefficients</p></li>
<li><p><span class="math inline">\boldsymbol{\epsilon}</span> is an <span class="math inline">n \times 1</span> vector of errors</p></li>
</ul>
<p>The <strong>sum of squared residuals (SSR)</strong> is:</p>
<p><span class="math display">
S(\boldsymbol{\beta}) = \sum_{i=1}^n (y_i - \mathbf{x}_i^T\boldsymbol{\beta})^2
</span></p>
<p>In matrix form, this becomes:</p>
<p><span class="math display">
S(\boldsymbol{\beta}) = (\mathbf{y} - \mathbf{X}\boldsymbol{\beta})^T(\mathbf{y} - \mathbf{X}\boldsymbol{\beta})
</span></p>
</section>
<section id="a.2.2-expanding-the-objective-function" class="level4">
<h4 class="anchored" data-anchor-id="a.2.2-expanding-the-objective-function">A.2.2 Expanding the Objective Function</h4>
<p>Let’s expand the expression:</p>
<p><span class="math display">
S(\boldsymbol{\beta}) = (\mathbf{y}^T - \boldsymbol{\beta}^T\mathbf{X}^T)(\mathbf{y} - \mathbf{X}\boldsymbol{\beta})
</span></p>
<p><span class="math display">
= \mathbf{y}^T\mathbf{y} - \mathbf{y}^T\mathbf{X}\boldsymbol{\beta} - \boldsymbol{\beta}^T\mathbf{X}^T\mathbf{y} + \boldsymbol{\beta}^T\mathbf{X}^T\mathbf{X}\boldsymbol{\beta}
</span></p>
<p>Note that <span class="math inline">\mathbf{y}^T\mathbf{X}\boldsymbol{\beta}</span> is a scalar, so it equals its transpose:</p>
<p><span class="math display">
\mathbf{y}^T\mathbf{X}\boldsymbol{\beta} = (\mathbf{y}^T\mathbf{X}\boldsymbol{\beta})^T = \boldsymbol{\beta}^T\mathbf{X}^T\mathbf{y}
</span></p>
<p>Therefore:</p>
<p><span class="math display">
S(\boldsymbol{\beta}) = \mathbf{y}^T\mathbf{y} - 2\boldsymbol{\beta}^T\mathbf{X}^T\mathbf{y} + \boldsymbol{\beta}^T\mathbf{X}^T\mathbf{X}\boldsymbol{\beta}
</span></p>
</section>
<section id="a.2.3-taking-the-derivative" class="level4">
<h4 class="anchored" data-anchor-id="a.2.3-taking-the-derivative">A.2.3 Taking the Derivative</h4>
<p>To minimize <span class="math inline">S(\boldsymbol{\beta})</span>, we take the derivative with respect to <span class="math inline">\boldsymbol{\beta}</span> and set it equal to zero.</p>
<p><strong>Matrix calculus rules needed:</strong></p>
<ul>
<li><p><span class="math inline">\frac{\partial}{\partial \boldsymbol{\beta}}(\mathbf{a}^T\boldsymbol{\beta}) = \mathbf{a}</span></p></li>
<li><p><span class="math inline">\frac{\partial}{\partial \boldsymbol{\beta}}(\boldsymbol{\beta}^T\mathbf{A}\boldsymbol{\beta}) = 2\mathbf{A}\boldsymbol{\beta}</span> (when <span class="math inline">\mathbf{A}</span> is symmetric)</p></li>
</ul>
<p>Applying these rules:</p>
<p><span class="math display">
\frac{\partial S}{\partial \boldsymbol{\beta}} = -2\mathbf{X}^T\mathbf{y} + 2\mathbf{X}^T\mathbf{X}\boldsymbol{\beta}
</span></p>
</section>
<section id="a.2.4-setting-the-derivative-to-zero-normal-equations" class="level4">
<h4 class="anchored" data-anchor-id="a.2.4-setting-the-derivative-to-zero-normal-equations">A.2.4 Setting the Derivative to Zero (Normal Equations)</h4>
<p>Set <span class="math inline">\frac{\partial S}{\partial \boldsymbol{\beta}} = \mathbf{0}</span>:</p>
<p><span class="math display">
-2\mathbf{X}^T\mathbf{y} + 2\mathbf{X}^T\mathbf{X}\boldsymbol{\beta} = \mathbf{0}
</span></p>
<p>Simplify:</p>
<p><span class="math display">
\mathbf{X}^T\mathbf{X}\boldsymbol{\beta} = \mathbf{X}^T\mathbf{y}
</span></p>
<p>These are called the <strong>normal equations</strong>.</p>
</section>
<section id="a.2.5-solving-for-hatboldsymbolbeta" class="level4">
<h4 class="anchored" data-anchor-id="a.2.5-solving-for-hatboldsymbolbeta">A.2.5 Solving for <span class="math inline">\hat{\boldsymbol{\beta}}</span></h4>
<p>Assuming <span class="math inline">\mathbf{X}^T\mathbf{X}</span> is invertible (full rank assumption), multiply both sides by <span class="math inline">(\mathbf{X}^T\mathbf{X})^{-1}</span>:</p>
<p><span class="math display">
\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}
</span></p>
<p>This is the <strong>OLS estimator</strong>.</p>
</section>
<section id="a.2.6-verifying-this-is-a-minimum" class="level4">
<h4 class="anchored" data-anchor-id="a.2.6-verifying-this-is-a-minimum">A.2.6 Verifying This is a Minimum</h4>
<p>To confirm this is a minimum (not maximum or saddle point), we check the second derivative:</p>
<p><span class="math display">
\frac{\partial^2 S}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^T} = 2\mathbf{X}^T\mathbf{X}
</span></p>
<p>This is the <strong>Hessian matrix</strong>. Since <span class="math inline">\mathbf{X}^T\mathbf{X}</span> is positive definite (when <span class="math inline">\mathbf{X}</span> has full column rank), the Hessian is positive definite, confirming we have a minimum.</p>
</section>
</section>
<section id="a.3-case-1-simple-linear-regression-one-predictor" class="level3">
<h3 class="anchored" data-anchor-id="a.3-case-1-simple-linear-regression-one-predictor">A.3 Case 1: Simple Linear Regression (One Predictor)</h3>
<section id="a.3.1-setting-up-the-problem" class="level4">
<h4 class="anchored" data-anchor-id="a.3.1-setting-up-the-problem">A.3.1 Setting Up the Problem</h4>
<p>Consider the following dataset with <span class="math inline">n = 5</span> observations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Observation</th>
<th><span class="math inline">x</span></th>
<th><span class="math inline">y</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>5</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Our model is: <span class="math inline">y_i = \beta_0 + \beta_1 x_i + \epsilon_i</span></p>
</section>
<section id="a.3.2-constructing-the-design-matrix" class="level4">
<h4 class="anchored" data-anchor-id="a.3.2-constructing-the-design-matrix">A.3.2 Constructing the Design Matrix</h4>
<p>The design matrix <span class="math inline">\mathbf{X}</span> includes a column of ones for the intercept:</p>
<p><span class="math display">
\mathbf{X} = \begin{bmatrix}
1 &amp; 1 \\
1 &amp; 2 \\
1 &amp; 3 \\
1 &amp; 4 \\
1 &amp; 5
\end{bmatrix}, \quad
\mathbf{y} = \begin{bmatrix}
2 \\
4 \\
5 \\
4 \\
5
\end{bmatrix}
</span></p>
</section>
<section id="a.3.3-step-1-calculate-mathbfxtmathbfx" class="level4">
<h4 class="anchored" data-anchor-id="a.3.3-step-1-calculate-mathbfxtmathbfx">A.3.3 Step 1: Calculate <span class="math inline">\mathbf{X}^T\mathbf{X}</span></h4>
<p><span class="math display">
\mathbf{X}^T = \begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5
\end{bmatrix}
</span></p>
<p><span class="math display">
\mathbf{X}^T\mathbf{X} = \begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5
\end{bmatrix}
\begin{bmatrix}
1 &amp; 1 \\
1 &amp; 2 \\
1 &amp; 3 \\
1 &amp; 4 \\
1 &amp; 5
\end{bmatrix}
</span></p>
<p><strong>Element-by-element calculation:</strong></p>
<ul>
<li><p><span class="math inline">(1,1)</span> element: <span class="math inline">1(1) + 1(1) + 1(1) + 1(1) + 1(1) = 5</span></p></li>
<li><p><span class="math inline">(1,2)</span> element: <span class="math inline">1(1) + 1(2) + 1(3) + 1(4) + 1(5) = 15</span></p></li>
<li><p><span class="math inline">(2,1)</span> element: <span class="math inline">1(1) + 2(1) + 3(1) + 4(1) + 5(1) = 15</span></p></li>
<li><p><span class="math inline">(2,2)</span> element: <span class="math inline">1(1) + 2(2) + 3(3) + 4(4) + 5(5) = 1 + 4 + 9 + 16 + 25 = 55</span></p></li>
</ul>
<p><span class="math display">
\mathbf{X}^T\mathbf{X} = \begin{bmatrix}
5 &amp; 15 \\
15 &amp; 55
\end{bmatrix}
</span></p>
</section>
<section id="a.3.4-step-2-calculate-mathbfxtmathbfx-1" class="level4">
<h4 class="anchored" data-anchor-id="a.3.4-step-2-calculate-mathbfxtmathbfx-1">A.3.4 Step 2: Calculate <span class="math inline">(\mathbf{X}^T\mathbf{X})^{-1}</span></h4>
<p>For a <span class="math inline">2 \times 2</span> matrix <span class="math inline">\mathbf{A} = \begin{bmatrix} a &amp; b \\ c &amp; d \end{bmatrix}</span>, the inverse is:</p>
<p><span class="math display">
\mathbf{A}^{-1} = \frac{1}{ad - bc}\begin{bmatrix} d &amp; -b \\ -c &amp; a \end{bmatrix}
</span></p>
<p><strong>Calculate the determinant:</strong></p>
<p><span class="math display">
\det(\mathbf{X}^T\mathbf{X}) = 5(55) - 15(15) = 275 - 225 = 50
</span></p>
<p><strong>Calculate the inverse:</strong></p>
<p><span class="math display">
(\mathbf{X}^T\mathbf{X})^{-1} = \frac{1}{50}\begin{bmatrix}
55 &amp; -15 \\
-15 &amp; 5
\end{bmatrix} = \begin{bmatrix}
1.1 &amp; -0.3 \\
-0.3 &amp; 0.1
\end{bmatrix}
</span></p>
</section>
<section id="a.3.5-step-3-calculate-mathbfxtmathbfy" class="level4">
<h4 class="anchored" data-anchor-id="a.3.5-step-3-calculate-mathbfxtmathbfy">A.3.5 Step 3: Calculate <span class="math inline">\mathbf{X}^T\mathbf{y}</span></h4>
<p><span class="math display">
\mathbf{X}^T\mathbf{y} = \begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5
\end{bmatrix}
\begin{bmatrix}
2 \\
4 \\
5 \\
4 \\
5
\end{bmatrix}
</span></p>
<p><strong>Element-by-element calculation:</strong></p>
<ul>
<li><p>First element: <span class="math inline">1(2) + 1(4) + 1(5) + 1(4) + 1(5) = 20</span></p></li>
<li><p>Second element: <span class="math inline">1(2) + 2(4) + 3(5) + 4(4) + 5(5) = 2 + 8 + 15 + 16 + 25 = 66</span></p></li>
</ul>
<p><span class="math display">
\mathbf{X}^T\mathbf{y} = \begin{bmatrix}
20 \\
66
\end{bmatrix}
</span></p>
</section>
<section id="a.3.6-step-4-calculate-hatboldsymbolbeta" class="level4">
<h4 class="anchored" data-anchor-id="a.3.6-step-4-calculate-hatboldsymbolbeta">A.3.6 Step 4: Calculate <span class="math inline">\hat{\boldsymbol{\beta}}</span></h4>
<p><span class="math display">
\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y} = \begin{bmatrix}
1.1 &amp; -0.3 \\
-0.3 &amp; 0.1
\end{bmatrix}
\begin{bmatrix}
20 \\
66
\end{bmatrix}
</span></p>
<p><strong>Element-by-element calculation:</strong></p>
<ul>
<li><p><span class="math inline">\hat{\beta}_0</span>: <span class="math inline">1.1(20) + (-0.3)(66) = 22 - 19.8 = 2.2</span></p></li>
<li><p><span class="math inline">\hat{\beta}_1</span>: <span class="math inline">(-0.3)(20) + 0.1(66) = -6 + 6.6 = 0.6</span></p></li>
</ul>
<p><span class="math display">
\hat{\boldsymbol{\beta}} = \begin{bmatrix}
2.2 \\
0.6
\end{bmatrix}
</span></p>
<p><strong>Result:</strong> The fitted regression line is <span class="math inline">\hat{y} = 2.2 + 0.6x</span></p>
</section>
</section>
<section id="a.4-case-2-multiple-linear-regression-two-predictors" class="level3">
<h3 class="anchored" data-anchor-id="a.4-case-2-multiple-linear-regression-two-predictors">A.4 Case 2: Multiple Linear Regression (Two Predictors)</h3>
<section id="a.4.1-setting-up-the-problem" class="level4">
<h4 class="anchored" data-anchor-id="a.4.1-setting-up-the-problem">A.4.1 Setting Up the Problem</h4>
<p>Consider a dataset with <span class="math inline">n = 5</span> observations and two predictors:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Observation</th>
<th><span class="math inline">x_1</span></th>
<th><span class="math inline">x_2</span></th>
<th><span class="math inline">y</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>2</td>
<td>5</td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>5</td>
<td>7</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>4</td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td>7</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>Our model is: <span class="math inline">y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \epsilon_i</span></p>
</section>
<section id="a.4.2-constructing-the-design-matrix" class="level4">
<h4 class="anchored" data-anchor-id="a.4.2-constructing-the-design-matrix">A.4.2 Constructing the Design Matrix</h4>
<p><span class="math display">
\mathbf{X} = \begin{bmatrix}
1 &amp; 1 &amp; 3 \\
1 &amp; 2 &amp; 2 \\
1 &amp; 3 &amp; 5 \\
1 &amp; 4 &amp; 4 \\
1 &amp; 5 &amp; 7
\end{bmatrix}, \quad
\mathbf{y} = \begin{bmatrix}
3 \\
5 \\
7 \\
9 \\
10
\end{bmatrix}
</span></p>
</section>
<section id="a.4.3-step-1-calculate-mathbfxtmathbfx" class="level4">
<h4 class="anchored" data-anchor-id="a.4.3-step-1-calculate-mathbfxtmathbfx">A.4.3 Step 1: Calculate <span class="math inline">\mathbf{X}^T\mathbf{X}</span></h4>
<p><span class="math display">
\mathbf{X}^T = \begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 \\
3 &amp; 2 &amp; 5 &amp; 4 &amp; 7
\end{bmatrix}
</span></p>
<p><span class="math display">
\mathbf{X}^T\mathbf{X} = \begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 \\
3 &amp; 2 &amp; 5 &amp; 4 &amp; 7
\end{bmatrix}
\begin{bmatrix}
1 &amp; 1 &amp; 3 \\
1 &amp; 2 &amp; 2 \\
1 &amp; 3 &amp; 5 \\
1 &amp; 4 &amp; 4 \\
1 &amp; 5 &amp; 7
\end{bmatrix}
</span></p>
<p><strong>Element-by-element calculation:</strong></p>
<p>Row 1:</p>
<ul>
<li><p><span class="math inline">(1,1)</span>: <span class="math inline">1 + 1 + 1 + 1 + 1 = 5</span></p></li>
<li><p><span class="math inline">(1,2)</span>: <span class="math inline">1 + 2 + 3 + 4 + 5 = 15</span></p></li>
<li><p><span class="math inline">(1,3)</span>: <span class="math inline">3 + 2 + 5 + 4 + 7 = 21</span></p></li>
</ul>
<p>Row 2:</p>
<ul>
<li><p><span class="math inline">(2,1)</span>: <span class="math inline">1 + 2 + 3 + 4 + 5 = 15</span></p></li>
<li><p><span class="math inline">(2,2)</span>: <span class="math inline">1 + 4 + 9 + 16 + 25 = 55</span></p></li>
<li><p><span class="math inline">(2,3)</span>: <span class="math inline">3 + 4 + 15 + 16 + 35 = 73</span></p></li>
</ul>
<p>Row 3:</p>
<ul>
<li><p><span class="math inline">(3,1)</span>: <span class="math inline">3 + 2 + 5 + 4 + 7 = 21</span></p></li>
<li><p><span class="math inline">(3,2)</span>: <span class="math inline">3 + 4 + 15 + 16 + 35 = 73</span></p></li>
<li><p><span class="math inline">(3,3)</span>: <span class="math inline">9 + 4 + 25 + 16 + 49 = 103</span></p></li>
</ul>
<p><span class="math display">
\mathbf{X}^T\mathbf{X} = \begin{bmatrix}
5 &amp; 15 &amp; 21 \\
15 &amp; 55 &amp; 73 \\
21 &amp; 73 &amp; 103
\end{bmatrix}
</span></p>
</section>
<section id="a.4.4-step-2-calculate-mathbfxtmathbfx-1" class="level4">
<h4 class="anchored" data-anchor-id="a.4.4-step-2-calculate-mathbfxtmathbfx-1">A.4.4 Step 2: Calculate <span class="math inline">(\mathbf{X}^T\mathbf{X})^{-1}</span></h4>
<p>For a <span class="math inline">3 \times 3</span> matrix, we use: <span class="math inline">\mathbf{A}^{-1} = \frac{1}{\det(\mathbf{A})}\text{adj}(\mathbf{A})</span></p>
<p><strong>Step 2a: Calculate the determinant using cofactor expansion along the first row:</strong></p>
<p><span class="math display">
\det(\mathbf{X}^T\mathbf{X}) = 5\begin{vmatrix}55 &amp; 73 \\ 73 &amp; 103\end{vmatrix} - 15\begin{vmatrix}15 &amp; 73 \\ 21 &amp; 103\end{vmatrix} + 21\begin{vmatrix}15 &amp; 55 \\ 21 &amp; 73\end{vmatrix}
</span></p>
<p>Calculate each <span class="math inline">2 \times 2</span> determinant:</p>
<ul>
<li><p><span class="math inline">\begin{vmatrix}55 &amp; 73 \\ 73 &amp; 103\end{vmatrix} = 55(103) - 73(73) = 5665 - 5329 = 336</span></p></li>
<li><p><span class="math inline">\begin{vmatrix}15 &amp; 73 \\ 21 &amp; 103\end{vmatrix} = 15(103) - 73(21) = 1545 - 1533 = 12</span></p></li>
<li><p><span class="math inline">\begin{vmatrix}15 &amp; 55 \\ 21 &amp; 73\end{vmatrix} = 15(73) - 55(21) = 1095 - 1155 = -60</span></p></li>
</ul>
<p><span class="math display">
\det(\mathbf{X}^T\mathbf{X}) = 5(336) - 15(12) + 21(-60) = 1680 - 180 - 1260 = 240
</span></p>
<p><strong>Step 2b: Calculate the cofactor matrix</strong></p>
<p>The cofactor <span class="math inline">C_{ij}</span> is <span class="math inline">(-1)^{i+j}</span> times the determinant of the matrix obtained by deleting row <span class="math inline">i</span> and column <span class="math inline">j</span>.</p>
<p><span class="math inline">C_{11} = (+1)\begin{vmatrix}55 &amp; 73 \\ 73 &amp; 103\end{vmatrix} = 336</span></p>
<p><span class="math inline">C_{12} = (-1)\begin{vmatrix}15 &amp; 73 \\ 21 &amp; 103\end{vmatrix} = -12</span></p>
<p><span class="math inline">C_{13} = (+1)\begin{vmatrix}15 &amp; 55 \\ 21 &amp; 73\end{vmatrix} = -60</span></p>
<p><span class="math inline">C_{21} = (-1)\begin{vmatrix}15 &amp; 21 \\ 73 &amp; 103\end{vmatrix} = -(15 \times 103 - 21 \times 73) = -(1545 - 1533) = -12</span></p>
<p><span class="math inline">C_{22} = (+1)\begin{vmatrix}5 &amp; 21 \\ 21 &amp; 103\end{vmatrix} = 5(103) - 21(21) = 515 - 441 = 74</span></p>
<p><span class="math inline">C_{23} = (-1)\begin{vmatrix}5 &amp; 15 \\ 21 &amp; 73\end{vmatrix} = -(5 \times 73 - 15 \times 21) = -(365 - 315) = -50</span></p>
<p><span class="math inline">C_{31} = (+1)\begin{vmatrix}15 &amp; 21 \\ 55 &amp; 73\end{vmatrix} = 15(73) - 21(55) = 1095 - 1155 = -60</span></p>
<p><span class="math inline">C_{32} = (-1)\begin{vmatrix}5 &amp; 21 \\ 15 &amp; 73\end{vmatrix} = -(5 \times 73 - 21 \times 15) = -(365 - 315) = -50</span></p>
<p><span class="math inline">C_{33} = (+1)\begin{vmatrix}5 &amp; 15 \\ 15 &amp; 55\end{vmatrix} = 5(55) - 15(15) = 275 - 225 = 50</span></p>
<p>Cofactor matrix:</p>
<p><span class="math display">
\mathbf{C} = \begin{bmatrix}
336 &amp; -12 &amp; -60 \\
-12 &amp; 74 &amp; -50 \\
-60 &amp; -50 &amp; 50
\end{bmatrix}
</span></p>
<p><strong>Step 2c: Calculate the adjugate (transpose of cofactor matrix):</strong></p>
<p><span class="math display">
\text{adj}(\mathbf{X}^T\mathbf{X}) = \mathbf{C}^T = \begin{bmatrix}
336 &amp; -12 &amp; -60 \\
-12 &amp; 74 &amp; -50 \\
-60 &amp; -50 &amp; 50
\end{bmatrix}
</span></p>
<p><strong>Step 2d: Calculate the inverse:</strong></p>
<p><span class="math display">
(\mathbf{X}^T\mathbf{X})^{-1} = \frac{1}{240}\begin{bmatrix}
336 &amp; -12 &amp; -60 \\
-12 &amp; 74 &amp; -50 \\
-60 &amp; -50 &amp; 50
\end{bmatrix} = \begin{bmatrix}
1.4 &amp; -0.05 &amp; -0.25 \\
-0.05 &amp; 0.308\overline{3} &amp; -0.208\overline{3} \\
-0.25 &amp; -0.208\overline{3} &amp; 0.208\overline{3}
\end{bmatrix}
</span></p>
<p>For simplicity in calculations, we’ll use:</p>
<p><span class="math display">
(\mathbf{X}^T\mathbf{X})^{-1} \approx \begin{bmatrix}
1.400 &amp; -0.050 &amp; -0.250 \\
-0.050 &amp; 0.308 &amp; -0.208 \\
-0.250 &amp; -0.208 &amp; 0.208
\end{bmatrix}
</span></p>
</section>
<section id="a.4.5-step-3-calculate-mathbfxtmathbfy" class="level4">
<h4 class="anchored" data-anchor-id="a.4.5-step-3-calculate-mathbfxtmathbfy">A.4.5 Step 3: Calculate <span class="math inline">\mathbf{X}^T\mathbf{y}</span></h4>
<p><span class="math display">
\mathbf{X}^T\mathbf{y} = \begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 \\
3 &amp; 2 &amp; 5 &amp; 4 &amp; 7
\end{bmatrix}
\begin{bmatrix}
3 \\
5 \\
7 \\
9 \\
10
\end{bmatrix}
</span></p>
<p><strong>Element-by-element calculation:</strong></p>
<ul>
<li><p>First: <span class="math inline">3 + 5 + 7 + 9 + 10 = 34</span></p></li>
<li><p>Second: <span class="math inline">3 + 10 + 21 + 36 + 50 = 120</span></p></li>
<li><p>Third: <span class="math inline">9 + 10 + 35 + 36 + 70 = 160</span></p></li>
</ul>
<p><span class="math display">
\mathbf{X}^T\mathbf{y} = \begin{bmatrix}
34 \\
120 \\
160
\end{bmatrix}
</span></p>
</section>
<section id="a.4.6-step-4-calculate-hatboldsymbolbeta" class="level4">
<h4 class="anchored" data-anchor-id="a.4.6-step-4-calculate-hatboldsymbolbeta">A.4.6 Step 4: Calculate <span class="math inline">\hat{\boldsymbol{\beta}}</span></h4>
<p><span class="math display">
\hat{\boldsymbol{\beta}} = \begin{bmatrix}
1.400 &amp; -0.050 &amp; -0.250 \\
-0.050 &amp; 0.308 &amp; -0.208 \\
-0.250 &amp; -0.208 &amp; 0.208
\end{bmatrix}
\begin{bmatrix}
34 \\
120 \\
160
\end{bmatrix}
</span></p>
<p><strong>Element-by-element calculation:</strong></p>
<ul>
<li><p><span class="math inline">\hat{\beta}_0 = 1.400(34) - 0.050(120) - 0.250(160) = 47.6 - 6.0 - 40.0 = 1.6</span></p></li>
<li><p><span class="math inline">\hat{\beta}_1 = -0.050(34) + 0.308(120) - 0.208(160) = -1.7 + 37.0 - 33.3 = 2.0</span></p></li>
<li><p><span class="math inline">\hat{\beta}_2 = -0.250(34) - 0.208(120) + 0.208(160) = -8.5 - 25.0 + 33.3 = -0.2</span></p></li>
</ul>
<p><span class="math display">
\hat{\boldsymbol{\beta}} = \begin{bmatrix}
1.6 \\
2.0 \\
-0.2
\end{bmatrix}
</span></p>
<p><strong>Result:</strong> The fitted regression is <span class="math inline">\hat{y} = 1.6 + 2.0x_1 - 0.2x_2</span></p>
<p>(Note: With exact fractions, the result would be slightly different, but this illustrates the manual calculation process.)</p>
</section>
</section>
<section id="a.5-the-gauss-markov-theorem" class="level3">
<h3 class="anchored" data-anchor-id="a.5-the-gauss-markov-theorem">A.5 The Gauss-Markov Theorem</h3>
<section id="a.5.1-statement-of-the-theorem" class="level4">
<h4 class="anchored" data-anchor-id="a.5.1-statement-of-the-theorem">A.5.1 Statement of the Theorem</h4>
<p>Under the classical linear regression assumptions, the OLS estimator <span class="math inline">\hat{\boldsymbol{\beta}}</span> is the <strong>Best Linear Unbiased Estimator (BLUE)</strong> of <span class="math inline">\boldsymbol{\beta}</span>.</p>
<p><strong>“Best”</strong> means it has the minimum variance among all linear unbiased estimators.</p>
</section>
<section id="a.5.2-required-assumptions" class="level4">
<h4 class="anchored" data-anchor-id="a.5.2-required-assumptions">A.5.2 Required Assumptions</h4>
<ol type="1">
<li><p><strong>Linearity:</strong> <span class="math inline">\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}</span></p></li>
<li><p><strong>Strict Exogeneity:</strong> <span class="math inline">E[\boldsymbol{\epsilon}|\mathbf{X}] = \mathbf{0}</span></p></li>
<li><p><strong>No Perfect Multicollinearity:</strong> <span class="math inline">\mathbf{X}</span> has full column rank, i.e., <span class="math inline">\text{rank}(\mathbf{X}) = p+1</span></p></li>
<li><p><strong>Spherical Errors:</strong> <span class="math inline">\text{Var}(\boldsymbol{\epsilon}|\mathbf{X}) = \sigma^2\mathbf{I}_n</span></p>
<ul>
<li><p>Homoscedasticity: <span class="math inline">\text{Var}(\epsilon_i) = \sigma^2</span> for all <span class="math inline">i</span></p></li>
<li><p>No autocorrelation: <span class="math inline">\text{Cov}(\epsilon_i, \epsilon_j) = 0</span> for <span class="math inline">i \neq j</span></p></li>
</ul></li>
</ol>
</section>
<section id="a.5.3-proof-that-ols-is-unbiased" class="level4">
<h4 class="anchored" data-anchor-id="a.5.3-proof-that-ols-is-unbiased">A.5.3 Proof that OLS is Unbiased</h4>
<p>Starting with: <span class="math inline">\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}</span></p>
<p>Substitute <span class="math inline">\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}</span>:</p>
<p><span class="math display">
\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T(\mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon})
</span></p>
<p><span class="math display">
= (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{X}\boldsymbol{\beta} + (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\boldsymbol{\epsilon}
</span></p>
<p><span class="math display">
= \mathbf{I}\boldsymbol{\beta} + (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\boldsymbol{\epsilon}
</span></p>
<p><span class="math display">
= \boldsymbol{\beta} + (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\boldsymbol{\epsilon}
</span></p>
<p>Taking expectations:</p>
<p><span class="math display">
E[\hat{\boldsymbol{\beta}}|\mathbf{X}] = \boldsymbol{\beta} + (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T E[\boldsymbol{\epsilon}|\mathbf{X}]
</span></p>
<p>Since <span class="math inline">E[\boldsymbol{\epsilon}|\mathbf{X}] = \mathbf{0}</span>:</p>
<p><span class="math display">
E[\hat{\boldsymbol{\beta}}|\mathbf{X}] = \boldsymbol{\beta}
</span></p>
<p><strong>Therefore, OLS is unbiased.</strong></p>
</section>
<section id="a.5.4-variance-of-the-ols-estimator" class="level4">
<h4 class="anchored" data-anchor-id="a.5.4-variance-of-the-ols-estimator">A.5.4 Variance of the OLS Estimator</h4>
<p>From <span class="math inline">\hat{\boldsymbol{\beta}} = \boldsymbol{\beta} + (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\boldsymbol{\epsilon}</span>:</p>
<p><span class="math display">
\text{Var}(\hat{\boldsymbol{\beta}}|\mathbf{X}) = \text{Var}[(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\boldsymbol{\epsilon}|\mathbf{X}]
</span></p>
<p>Since <span class="math inline">(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T</span> is non-random conditional on <span class="math inline">\mathbf{X}</span>:</p>
<p><span class="math display">
= (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T \text{Var}(\boldsymbol{\epsilon}|\mathbf{X}) \mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}
</span></p>
<p>With spherical errors <span class="math inline">\text{Var}(\boldsymbol{\epsilon}|\mathbf{X}) = \sigma^2\mathbf{I}</span>:</p>
<p><span class="math display">
= (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T (\sigma^2\mathbf{I}) \mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}
</span></p>
<p><span class="math display">
= \sigma^2(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{X}(\mathbf{X}^T\mathbf{X})^{-1}
</span></p>
<p><span class="math display">
= \sigma^2(\mathbf{X}^T\mathbf{X})^{-1}
</span></p>
<p>This is the <strong>variance-covariance matrix</strong> of <span class="math inline">\hat{\boldsymbol{\beta}}</span>.</p>
</section>
<section id="a.5.5-example-variance-calculation-for-simple-regression" class="level4">
<h4 class="anchored" data-anchor-id="a.5.5-example-variance-calculation-for-simple-regression">A.5.5 Example: Variance Calculation for Simple Regression</h4>
<p>From Case 1, we had:</p>
<p><span class="math display">
(\mathbf{X}^T\mathbf{X})^{-1} = \begin{bmatrix}
1.1 &amp; -0.3 \\
-0.3 &amp; 0.1
\end{bmatrix}
</span></p>
<p>We estimate <span class="math inline">\sigma^2</span> using the residual sum of squares:</p>
<p><span class="math display">
\hat{\sigma}^2 = \frac{\text{RSS}}{n - (p + 1)} = \frac{\sum_{i=1}^n (y_i - \hat{y}_i)^2}{n - 2}
</span></p>
<p>For our example, the fitted values are: <span class="math inline">\hat{y}_i = 2.2 + 0.6x_i</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 19%">
<col style="width: 28%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">\hat{y}_i</span></th>
<th><span class="math inline">y_i - \hat{y}_i</span></th>
<th><span class="math inline">(y_i - \hat{y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>2.8</td>
<td>-0.8</td>
<td>0.64</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>3.4</td>
<td>0.6</td>
<td>0.36</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4.0</td>
<td>1.0</td>
<td>1.00</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>4.6</td>
<td>-0.6</td>
<td>0.36</td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td>5.2</td>
<td>-0.2</td>
<td>0.04</td>
</tr>
</tbody>
</table>
<p><span class="math display">
\text{RSS} = 0.64 + 0.36 + 1.00 + 0.36 + 0.04 = 2.4
</span></p>
<p><span class="math display">
\hat{\sigma}^2 = \frac{2.4}{5 - 2} = \frac{2.4}{3} = 0.8
</span></p>
<p>The variance-covariance matrix of <span class="math inline">\hat{\boldsymbol{\beta}}</span> is:</p>
<p><span class="math display">
\text{Var}(\hat{\boldsymbol{\beta}}) = 0.8 \begin{bmatrix}
1.1 &amp; -0.3 \\
-0.3 &amp; 0.1
\end{bmatrix} = \begin{bmatrix}
0.88 &amp; -0.24 \\
-0.24 &amp; 0.08
\end{bmatrix}
</span></p>
<p><strong>Standard errors:</strong></p>
<ul>
<li><p><span class="math inline">\text{SE}(\hat{\beta}_0) = \sqrt{0.88} = 0.938</span></p></li>
<li><p><span class="math inline">\text{SE}(\hat{\beta}_1) = \sqrt{0.08} = 0.283</span></p></li>
</ul>
<p>These standard errors are used for hypothesis testing and confidence intervals.</p>
</section>
<section id="a.5.6-why-ols-is-best-sketch-of-proof" class="level4">
<h4 class="anchored" data-anchor-id="a.5.6-why-ols-is-best-sketch-of-proof">A.5.6 Why OLS is “Best” (Sketch of Proof)</h4>
<p>The Gauss-Markov theorem states that among all linear unbiased estimators, OLS has the minimum variance.</p>
<p>Consider any other linear unbiased estimator:</p>
<p><span class="math display">
\tilde{\boldsymbol{\beta}} = \mathbf{C}\mathbf{y}
</span></p>
<p>where <span class="math inline">\mathbf{C}</span> is some matrix. For unbiasedness:</p>
<p><span class="math display">
E[\tilde{\boldsymbol{\beta}}] = \mathbf{C}E[\mathbf{y}] = \mathbf{C}\mathbf{X}\boldsymbol{\beta} = \boldsymbol{\beta}
</span></p>
<p>This requires <span class="math inline">\mathbf{C}\mathbf{X} = \mathbf{I}</span>.</p>
<p>We can write <span class="math inline">\mathbf{C} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T + \mathbf{D}</span> for some matrix <span class="math inline">\mathbf{D}</span> where <span class="math inline">\mathbf{D}\mathbf{X} = \mathbf{0}</span>.</p>
<p>The variance of <span class="math inline">\tilde{\boldsymbol{\beta}}</span> is:</p>
<p><span class="math display">
\text{Var}(\tilde{\boldsymbol{\beta}}) = \sigma^2\mathbf{C}\mathbf{C}^T
</span></p>
<p><span class="math display">
= \sigma^2[(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T + \mathbf{D}][(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T + \mathbf{D}]^T
</span></p>
<p><span class="math display">
= \sigma^2(\mathbf{X}^T\mathbf{X})^{-1} + \sigma^2\mathbf{D}\mathbf{D}^T
</span></p>
<p>Since <span class="math inline">\mathbf{D}\mathbf{D}^T</span> is positive semi-definite:</p>
<p><span class="math display">
\text{Var}(\tilde{\boldsymbol{\beta}}) - \text{Var}(\hat{\boldsymbol{\beta}}) = \sigma^2\mathbf{D}\mathbf{D}^T \geq \mathbf{0}
</span></p>
<p>Therefore, OLS has the smallest variance among all linear unbiased estimators.</p>
</section>
</section>
<section id="a.6-key-takeaways" class="level3">
<h3 class="anchored" data-anchor-id="a.6-key-takeaways">A.6 Key Takeaways</h3>
<ol type="1">
<li><p><strong>Matrix notation</strong> provides an elegant and scalable framework for regression that extends naturally from simple to multiple regression.</p></li>
<li><p>The <strong>OLS minimization</strong> derives from setting <span class="math inline">\frac{\partial S}{\partial \boldsymbol{\beta}} = \mathbf{0}</span>, yielding the normal equations <span class="math inline">\mathbf{X}^T\mathbf{X}\boldsymbol{\beta} = \mathbf{X}^T\mathbf{y}</span>.</p></li>
<li><p>The <strong>OLS solution</strong> <span class="math inline">\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}</span> requires that <span class="math inline">\mathbf{X}^T\mathbf{X}</span> be invertible (no perfect multicollinearity).</p></li>
<li><p>Under the Gauss-Markov assumptions, <strong>OLS is BLUE</strong>: Best (minimum variance), Linear, Unbiased Estimator.</p></li>
<li><p>The <strong>variance of OLS estimates</strong> is <span class="math inline">\sigma^2(\mathbf{X}^T\mathbf{X})^{-1}</span>, which can be used for inference.</p></li>
<li><p><strong>Key linear algebra tools</strong> include matrix transpose, multiplication, determinant, inverse, and rank—all essential for understanding OLS.</p></li>
<li><p><strong>Assumption violations</strong> (e.g., heteroscedasticity, autocorrelation) don’t make OLS biased, but they invalidate the “best” property and standard inference procedures.</p></li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./rozdzial6.html" class="pagination-link" aria-label="Wizualizacja Danych: z przykładami w R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./correg_pl.html" class="pagination-link" aria-label="Wprowadzenie do Analizy Korelacji i Regresji">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>