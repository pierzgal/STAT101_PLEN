<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Wprowadzenie do Analizy Korelacji i Regresji – Social Data Analysis: An Introduction (Wprowadzenie do Analizy Danych Społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./probability_en.html" rel="next">
<link href="./correg_en.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_pl.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do Analizy Danych Społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Pobierania Próby i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#kowariancja-covariance" id="toc-kowariancja-covariance" class="nav-link active" data-scroll-target="#kowariancja-covariance"><span class="header-section-number">16.0.1</span> Kowariancja (Covariance)</a></li>
  <li><a href="#współczynnik-korelacji-correlation-coefficient" id="toc-współczynnik-korelacji-correlation-coefficient" class="nav-link" data-scroll-target="#współczynnik-korelacji-correlation-coefficient"><span class="header-section-number">16.0.2</span> Współczynnik korelacji (Correlation Coefficient)</a></li>
  <li><a href="#kontekst-historyczny" id="toc-kontekst-historyczny" class="nav-link" data-scroll-target="#kontekst-historyczny"><span class="header-section-number">16.0.3</span> Kontekst historyczny</a></li>
  <li><a href="#rodzaje-korelacji" id="toc-rodzaje-korelacji" class="nav-link" data-scroll-target="#rodzaje-korelacji"><span class="header-section-number">16.1</span> Rodzaje korelacji</a></li>
  <li><a href="#analiza-regresji---wprowadzenie" id="toc-analiza-regresji---wprowadzenie" class="nav-link" data-scroll-target="#analiza-regresji---wprowadzenie"><span class="header-section-number">16.2</span> Analiza Regresji - wprowadzenie</a>
  <ul class="collapse">
  <li><a href="#model-regresji-liniowej" id="toc-model-regresji-liniowej" class="nav-link" data-scroll-target="#model-regresji-liniowej"><span class="header-section-number">16.2.1</span> Model Regresji Liniowej</a></li>
  <li><a href="#intuicyjne-zrozumienie-najlepszego-dopasowania-best-fit-modelu-do-danych-w-regresji-ols-ordinary-least-squares" id="toc-intuicyjne-zrozumienie-najlepszego-dopasowania-best-fit-modelu-do-danych-w-regresji-ols-ordinary-least-squares" class="nav-link" data-scroll-target="#intuicyjne-zrozumienie-najlepszego-dopasowania-best-fit-modelu-do-danych-w-regresji-ols-ordinary-least-squares"><span class="header-section-number">16.2.2</span> Intuicyjne Zrozumienie “Najlepszego Dopasowania” (“Best Fit”) Modelu do Danych w Regresji OLS (Ordinary Least Squares)</a></li>
  <li><a href="#koncepcja-sumy-kwadratów-błędów-sse" id="toc-koncepcja-sumy-kwadratów-błędów-sse" class="nav-link" data-scroll-target="#koncepcja-sumy-kwadratów-błędów-sse"><span class="header-section-number">16.2.3</span> Koncepcja Sumy Kwadratów Błędów (SSE)</a></li>
  <li><a href="#wizualizacja-sumy-kwadratów-błędów-w-regresji-liniowej" id="toc-wizualizacja-sumy-kwadratów-błędów-w-regresji-liniowej" class="nav-link" data-scroll-target="#wizualizacja-sumy-kwadratów-błędów-w-regresji-liniowej"><span class="header-section-number">16.2.4</span> Wizualizacja Sumy Kwadratów Błędów w Regresji Liniowej</a></li>
  <li><a href="#wizualizacja-ols-poprzez-różne-linie" id="toc-wizualizacja-ols-poprzez-różne-linie" class="nav-link" data-scroll-target="#wizualizacja-ols-poprzez-różne-linie"><span class="header-section-number">16.2.5</span> Wizualizacja OLS Poprzez Różne Linie</a></li>
  <li><a href="#ulepszona-wizualizacja-kwadratów-reszt" id="toc-ulepszona-wizualizacja-kwadratów-reszt" class="nav-link" data-scroll-target="#ulepszona-wizualizacja-kwadratów-reszt"><span class="header-section-number">16.2.6</span> Ulepszona Wizualizacja Kwadratów Reszt</a></li>
  <li><a href="#kluczowe-punkty-do-zapamiętania" id="toc-kluczowe-punkty-do-zapamiętania" class="nav-link" data-scroll-target="#kluczowe-punkty-do-zapamiętania"><span class="header-section-number">16.2.7</span> Kluczowe Punkty Do Zapamiętania</a></li>
  <li><a href="#alternatywna-wizualizacja-sse-pionowe-odległości" id="toc-alternatywna-wizualizacja-sse-pionowe-odległości" class="nav-link" data-scroll-target="#alternatywna-wizualizacja-sse-pionowe-odległości"><span class="header-section-number">16.2.8</span> Alternatywna Wizualizacja SSE: Pionowe Odległości</a></li>
  <li><a href="#estymator-ols" id="toc-estymator-ols" class="nav-link" data-scroll-target="#estymator-ols"><span class="header-section-number">16.2.9</span> Estymator OLS</a></li>
  <li><a href="#interpretacja-modelu-przewodnik-dla-początkujących" id="toc-interpretacja-modelu-przewodnik-dla-początkujących" class="nav-link" data-scroll-target="#interpretacja-modelu-przewodnik-dla-początkujących"><span class="header-section-number">16.2.10</span> Interpretacja Modelu: Przewodnik dla Początkujących</a></li>
  </ul></li>
  <li><a href="#korelacja-pozorna-przyczyny-i-przykłady" id="toc-korelacja-pozorna-przyczyny-i-przykłady" class="nav-link" data-scroll-target="#korelacja-pozorna-przyczyny-i-przykłady"><span class="header-section-number">16.3</span> Korelacja pozorna: Przyczyny i przykłady</a>
  <ul class="collapse">
  <li><a href="#przypadkowa-zbieżność-przypadek" id="toc-przypadkowa-zbieżność-przypadek" class="nav-link" data-scroll-target="#przypadkowa-zbieżność-przypadek"><span class="header-section-number">16.3.1</span> Przypadkowa Zbieżność (Przypadek)</a></li>
  <li><a href="#zmienne-zakłócające-ukryte-czynniki-trzecie" id="toc-zmienne-zakłócające-ukryte-czynniki-trzecie" class="nav-link" data-scroll-target="#zmienne-zakłócające-ukryte-czynniki-trzecie"><span class="header-section-number">16.3.2</span> Zmienne zakłócające (ukryte czynniki trzecie)</a></li>
  <li><a href="#odwrócona-przyczynowość" id="toc-odwrócona-przyczynowość" class="nav-link" data-scroll-target="#odwrócona-przyczynowość"><span class="header-section-number">16.3.3</span> Odwrócona przyczynowość</a></li>
  <li><a href="#błąd-kolidera-błąd-selekcji" id="toc-błąd-kolidera-błąd-selekcji" class="nav-link" data-scroll-target="#błąd-kolidera-błąd-selekcji"><span class="header-section-number">16.3.4</span> Błąd kolidera (błąd selekcji)</a></li>
  <li><a href="#niewłaściwa-analiza" id="toc-niewłaściwa-analiza" class="nav-link" data-scroll-target="#niewłaściwa-analiza"><span class="header-section-number">16.3.5</span> Niewłaściwa analiza</a></li>
  <li><a href="#endogeniczność-i-jej-źródła" id="toc-endogeniczność-i-jej-źródła" class="nav-link" data-scroll-target="#endogeniczność-i-jej-źródła"><span class="header-section-number">16.3.6</span> Endogeniczność i jej źródła</a></li>
  </ul></li>
  <li><a href="#metody-przeciwdziałania-korelacjom-pozornym" id="toc-metody-przeciwdziałania-korelacjom-pozornym" class="nav-link" data-scroll-target="#metody-przeciwdziałania-korelacjom-pozornym"><span class="header-section-number">16.4</span> Metody przeciwdziałania korelacjom pozornym</a></li>
  <li><a href="#podsumowanie" id="toc-podsumowanie" class="nav-link" data-scroll-target="#podsumowanie"><span class="header-section-number">16.5</span> Podsumowanie</a>
  <ul class="collapse">
  <li><a href="#korelacja-pearsona" id="toc-korelacja-pearsona" class="nav-link" data-scroll-target="#korelacja-pearsona"><span class="header-section-number">16.5.5</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana" id="toc-korelacja-spearmana" class="nav-link" data-scroll-target="#korelacja-spearmana"><span class="header-section-number">16.5.6</span> Korelacja Spearmana</a></li>
  <li><a href="#tabela-krzyżowa" id="toc-tabela-krzyżowa" class="nav-link" data-scroll-target="#tabela-krzyżowa"><span class="header-section-number">16.5.9</span> Tabela Krzyżowa</a></li>
  <li><a href="#wybór-odpowiedniej-miary" id="toc-wybór-odpowiedniej-miary" class="nav-link" data-scroll-target="#wybór-odpowiedniej-miary"><span class="header-section-number">16.5.10</span> Wybór Odpowiedniej Miary</a></li>
  </ul></li>
  <li><a href="#analiza-regresji" id="toc-analiza-regresji" class="nav-link" data-scroll-target="#analiza-regresji"><span class="header-section-number">16.6</span> Analiza Regresji</a>
  <ul class="collapse">
  <li><a href="#regresja-jako-model-stochastyczny" id="toc-regresja-jako-model-stochastyczny" class="nav-link" data-scroll-target="#regresja-jako-model-stochastyczny"><span class="header-section-number">16.6.1</span> Regresja jako Model Stochastyczny</a></li>
  <li><a href="#podstawowe-pojęcia-i-terminologia" id="toc-podstawowe-pojęcia-i-terminologia" class="nav-link" data-scroll-target="#podstawowe-pojęcia-i-terminologia"><span class="header-section-number">16.6.7</span> Podstawowe Pojęcia i Terminologia</a></li>
  <li><a href="#główna-idea" id="toc-główna-idea" class="nav-link" data-scroll-target="#główna-idea"><span class="header-section-number">16.6.8</span> Główna Idea</a></li>
  </ul></li>
  <li><a href="#model-regresji-liniowej-1" id="toc-model-regresji-liniowej-1" class="nav-link" data-scroll-target="#model-regresji-liniowej-1"><span class="header-section-number">16.7</span> Model Regresji Liniowej</a>
  <ul class="collapse">
  <li><a href="#model-populacyjny-vs.-oszacowania-z-próby" id="toc-model-populacyjny-vs.-oszacowania-z-próby" class="nav-link" data-scroll-target="#model-populacyjny-vs.-oszacowania-z-próby"><span class="header-section-number">16.7.1</span> Model Populacyjny vs.&nbsp;Oszacowania z Próby</a></li>
  </ul></li>
  <li><a href="#kluczowe-założenia-regresji-liniowej" id="toc-kluczowe-założenia-regresji-liniowej" class="nav-link" data-scroll-target="#kluczowe-założenia-regresji-liniowej"><span class="header-section-number">16.8</span> Kluczowe Założenia Regresji Liniowej</a>
  <ul class="collapse">
  <li><a href="#ścisła-egzogeniczność-podstawowe-założenie" id="toc-ścisła-egzogeniczność-podstawowe-założenie" class="nav-link" data-scroll-target="#ścisła-egzogeniczność-podstawowe-założenie"><span class="header-section-number">16.8.1</span> Ścisła Egzogeniczność: Podstawowe Założenie</a></li>
  <li><a href="#liniowość-założenie-o-formie" id="toc-liniowość-założenie-o-formie" class="nav-link" data-scroll-target="#liniowość-założenie-o-formie"><span class="header-section-number">16.8.2</span> Liniowość: Założenie o Formie</a></li>
  <li><a href="#zrozumienie-naruszeń-i-rozwiązania" id="toc-zrozumienie-naruszeń-i-rozwiązania" class="nav-link" data-scroll-target="#zrozumienie-naruszeń-i-rozwiązania"><span class="header-section-number">16.8.3</span> Zrozumienie Naruszeń i Rozwiązania</a></li>
  </ul></li>
  <li><a href="#ocena-dopasowania-modelu" id="toc-ocena-dopasowania-modelu" class="nav-link" data-scroll-target="#ocena-dopasowania-modelu"><span class="header-section-number">16.9</span> Ocena Dopasowania Modelu</a>
  <ul class="collapse">
  <li><a href="#dekompozycja-wariancji" id="toc-dekompozycja-wariancji" class="nav-link" data-scroll-target="#dekompozycja-wariancji"><span class="header-section-number">16.9.1</span> Dekompozycja Wariancji</a></li>
  <li><a href="#trzy-komponenty-wariancji" id="toc-trzy-komponenty-wariancji" class="nav-link" data-scroll-target="#trzy-komponenty-wariancji"><span class="header-section-number">16.9.2</span> Trzy Komponenty Wariancji</a></li>
  <li><a href="#współczynnik-r²---wyjaśnienie" id="toc-współczynnik-r²---wyjaśnienie" class="nav-link" data-scroll-target="#współczynnik-r²---wyjaśnienie"><span class="header-section-number">16.9.3</span> Współczynnik R² - Wyjaśnienie</a></li>
  <li><a href="#kiedy-zachować-ostrożność" id="toc-kiedy-zachować-ostrożność" class="nav-link" data-scroll-target="#kiedy-zachować-ostrożność"><span class="header-section-number">16.9.4</span> Kiedy Zachować Ostrożność</a></li>
  <li><a href="#praktyczne-wskazówki-do-analizy" id="toc-praktyczne-wskazówki-do-analizy" class="nav-link" data-scroll-target="#praktyczne-wskazówki-do-analizy"><span class="header-section-number">16.9.5</span> Praktyczne Wskazówki do Analizy</a></li>
  <li><a href="#kluczowe-wnioski-1" id="toc-kluczowe-wnioski-1" class="nav-link" data-scroll-target="#kluczowe-wnioski-1"><span class="header-section-number">16.9.6</span> Kluczowe Wnioski</a></li>
  <li><a href="#miary-dopasowania" id="toc-miary-dopasowania" class="nav-link" data-scroll-target="#miary-dopasowania"><span class="header-section-number">16.9.7</span> Miary Dopasowania</a></li>
  </ul></li>
  <li><a href="#regresja-wieloraka" id="toc-regresja-wieloraka" class="nav-link" data-scroll-target="#regresja-wieloraka"><span class="header-section-number">16.10</span> Regresja Wieloraka (*)</a>
  <ul class="collapse">
  <li><a href="#rozszerzenie-do-wielu-predyktorów" id="toc-rozszerzenie-do-wielu-predyktorów" class="nav-link" data-scroll-target="#rozszerzenie-do-wielu-predyktorów"><span class="header-section-number">16.10.1</span> Rozszerzenie do Wielu Predyktorów</a></li>
  <li><a href="#interpretacja-współczynników" id="toc-interpretacja-współczynników" class="nav-link" data-scroll-target="#interpretacja-współczynników"><span class="header-section-number">16.10.2</span> Interpretacja Współczynników</a></li>
  <li><a href="#współliniowość" id="toc-współliniowość" class="nav-link" data-scroll-target="#współliniowość"><span class="header-section-number">16.10.3</span> Współliniowość</a></li>
  </ul></li>
  <li><a href="#tematy-zaawansowane" id="toc-tematy-zaawansowane" class="nav-link" data-scroll-target="#tematy-zaawansowane"><span class="header-section-number">16.11</span> Tematy Zaawansowane</a>
  <ul class="collapse">
  <li><a href="#efekty-interakcji" id="toc-efekty-interakcji" class="nav-link" data-scroll-target="#efekty-interakcji"><span class="header-section-number">16.11.1</span> Efekty Interakcji</a></li>
  <li><a href="#wyrazy-wielomianowe" id="toc-wyrazy-wielomianowe" class="nav-link" data-scroll-target="#wyrazy-wielomianowe"><span class="header-section-number">16.11.2</span> Wyrazy Wielomianowe</a></li>
  </ul></li>
  <li><a href="#praktyczne-wskazówki-do-analizy-regresji" id="toc-praktyczne-wskazówki-do-analizy-regresji" class="nav-link" data-scroll-target="#praktyczne-wskazówki-do-analizy-regresji"><span class="header-section-number">16.12</span> Praktyczne Wskazówki do Analizy Regresji</a>
  <ul class="collapse">
  <li><a href="#proces-budowy-modelu" id="toc-proces-budowy-modelu" class="nav-link" data-scroll-target="#proces-budowy-modelu"><span class="header-section-number">16.12.1</span> Proces Budowy Modelu</a></li>
  <li><a href="#typowe-pułapki-i-rozwiązania" id="toc-typowe-pułapki-i-rozwiązania" class="nav-link" data-scroll-target="#typowe-pułapki-i-rozwiązania"><span class="header-section-number">16.12.2</span> Typowe Pułapki i Rozwiązania</a></li>
  </ul></li>
  <li><a href="#najlepsze-praktyki" id="toc-najlepsze-praktyki" class="nav-link" data-scroll-target="#najlepsze-praktyki"><span class="header-section-number">16.13</span> Najlepsze Praktyki</a>
  <ul class="collapse">
  <li><a href="#walidacja-modelu" id="toc-walidacja-modelu" class="nav-link" data-scroll-target="#walidacja-modelu"><span class="header-section-number">16.13.1</span> Walidacja Modelu</a></li>
  <li><a href="#prezentacja-wyników" id="toc-prezentacja-wyników" class="nav-link" data-scroll-target="#prezentacja-wyników"><span class="header-section-number">16.13.2</span> Prezentacja Wyników</a></li>
  </ul></li>
  <li><a href="#podsumowanie-1" id="toc-podsumowanie-1" class="nav-link" data-scroll-target="#podsumowanie-1"><span class="header-section-number">16.14</span> Podsumowanie</a>
  <ul class="collapse">
  <li><a href="#kluczowe-wnioski-3" id="toc-kluczowe-wnioski-3" class="nav-link" data-scroll-target="#kluczowe-wnioski-3"><span class="header-section-number">16.14.1</span> Kluczowe Wnioski</a></li>
  <li><a href="#literatura-uzupełniająca" id="toc-literatura-uzupełniająca" class="nav-link" data-scroll-target="#literatura-uzupełniająca">Literatura Uzupełniająca</a></li>
  </ul></li>
  <li><a href="#appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" id="toc-appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" class="nav-link" data-scroll-target="#appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami"><span class="header-section-number">16.15</span> Appendix A.1: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład z obliczeniami</a>
  <ul class="collapse">
  <li><a href="#krok-1-obliczanie-podstawowych-statystyk" id="toc-krok-1-obliczanie-podstawowych-statystyk" class="nav-link" data-scroll-target="#krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.15.1</span> Krok 1: Obliczanie Podstawowych Statystyk</a></li>
  <li><a href="#krok-2-szczegółowe-obliczenia-kowariancji" id="toc-krok-2-szczegółowe-obliczenia-kowariancji" class="nav-link" data-scroll-target="#krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.15.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</a></li>
  <li><a href="#krok-3-obliczanie-odchylenia-standardowego" id="toc-krok-3-obliczanie-odchylenia-standardowego" class="nav-link" data-scroll-target="#krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.15.3</span> Krok 3: Obliczanie Odchylenia Standardowego</a></li>
  <li><a href="#krok-4-obliczanie-korelacji-pearsona" id="toc-krok-4-obliczanie-korelacji-pearsona" class="nav-link" data-scroll-target="#krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.15.4</span> Krok 4: Obliczanie Korelacji Pearsona</a></li>
  <li><a href="#krok-5-obliczanie-korelacji-rangowej-spearmana" id="toc-krok-5-obliczanie-korelacji-rangowej-spearmana" class="nav-link" data-scroll-target="#krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.15.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</a></li>
  <li><a href="#krok-6-weryfikacja-w-r" id="toc-krok-6-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-6-weryfikacja-w-r"><span class="header-section-number">16.15.6</span> Krok 6: Weryfikacja w R</a></li>
  <li><a href="#krok-7-podstawowa-wizualizacja" id="toc-krok-7-podstawowa-wizualizacja" class="nav-link" data-scroll-target="#krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.15.7</span> Krok 7: Podstawowa Wizualizacja</a></li>
  <li><a href="#estymacja-ols-i-miary-dopasowania-modelu" id="toc-estymacja-ols-i-miary-dopasowania-modelu" class="nav-link" data-scroll-target="#estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.15.8</span> Estymacja OLS i Miary Dopasowania Modelu</a></li>
  <li><a href="#krok-1-obliczanie-estymatorów-ols" id="toc-krok-1-obliczanie-estymatorów-ols" class="nav-link" data-scroll-target="#krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.15.9</span> Krok 1: Obliczanie Estymatorów OLS</a></li>
  <li><a href="#krok-2-obliczanie-wartości-dopasowanych-i-reszt" id="toc-krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="nav-link" data-scroll-target="#krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.15.10</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</a></li>
  <li><a href="#krok-3-obliczanie-miar-dopasowania" id="toc-krok-3-obliczanie-miar-dopasowania" class="nav-link" data-scroll-target="#krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.15.11</span> Krok 3: Obliczanie Miar Dopasowania</a></li>
  <li><a href="#krok-4-weryfikacja-w-r" id="toc-krok-4-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-4-weryfikacja-w-r"><span class="header-section-number">16.15.12</span> Krok 4: Weryfikacja w R</a></li>
  <li><a href="#krok-5-analiza-reszt" id="toc-krok-5-analiza-reszt" class="nav-link" data-scroll-target="#krok-5-analiza-reszt"><span class="header-section-number">16.15.13</span> Krok 5: Analiza Reszt</a></li>
  <li><a href="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" id="toc-krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="nav-link" data-scroll-target="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.15.14</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</a></li>
  <li><a href="#modele-z-transformacją-logarytmiczną" id="toc-modele-z-transformacją-logarytmiczną" class="nav-link" data-scroll-target="#modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.15.15</span> Modele z Transformacją Logarytmiczną</a></li>
  <li><a href="#krok-1-transformacja-danych" id="toc-krok-1-transformacja-danych" class="nav-link" data-scroll-target="#krok-1-transformacja-danych"><span class="header-section-number">16.15.16</span> Krok 1: Transformacja Danych</a></li>
  <li><a href="#krok-2-porównanie-różnych-specyfikacji-modelu" id="toc-krok-2-porównanie-różnych-specyfikacji-modelu" class="nav-link" data-scroll-target="#krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.15.17</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</a></li>
  <li><a href="#krok-3-porównanie-wizualne" id="toc-krok-3-porównanie-wizualne" class="nav-link" data-scroll-target="#krok-3-porównanie-wizualne"><span class="header-section-number">16.15.18</span> Krok 3: Porównanie Wizualne</a></li>
  <li><a href="#krok-4-analiza-reszt-dla-najlepszego-modelu" id="toc-krok-4-analiza-reszt-dla-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.15.19</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</a></li>
  <li><a href="#krok-5-interpretacja-najlepszego-modelu" id="toc-krok-5-interpretacja-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.15.20</span> Krok 5: Interpretacja Najlepszego Modelu</a></li>
  <li><a href="#krok-6-predykcje-modelu" id="toc-krok-6-predykcje-modelu" class="nav-link" data-scroll-target="#krok-6-predykcje-modelu"><span class="header-section-number">16.15.21</span> Krok 6: Predykcje Modelu</a></li>
  <li><a href="#krok-7-analiza-elastyczności" id="toc-krok-7-analiza-elastyczności" class="nav-link" data-scroll-target="#krok-7-analiza-elastyczności"><span class="header-section-number">16.15.22</span> Krok 7: Analiza Elastyczności</a></li>
  </ul></li>
  <li><a href="#appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" id="toc-appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="nav-link" data-scroll-target="#appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.16</span> Appendix A.2: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</a>
  <ul class="collapse">
  <li><a href="#zbiór-danych" id="toc-zbiór-danych" class="nav-link" data-scroll-target="#zbiór-danych"><span class="header-section-number">16.16.1</span> Zbiór Danych</a></li>
  <li><a href="#korelacja-pearsona-1" id="toc-korelacja-pearsona-1" class="nav-link" data-scroll-target="#korelacja-pearsona-1"><span class="header-section-number">16.16.2</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana-1" id="toc-korelacja-spearmana-1" class="nav-link" data-scroll-target="#korelacja-spearmana-1"><span class="header-section-number">16.16.3</span> Korelacja Spearmana</a></li>
  <li><a href="#tau-kendalla" id="toc-tau-kendalla" class="nav-link" data-scroll-target="#tau-kendalla"><span class="header-section-number">16.16.4</span> Tau Kendalla</a></li>
  <li><a href="#weryfikacja-w-r" id="toc-weryfikacja-w-r" class="nav-link" data-scroll-target="#weryfikacja-w-r"><span class="header-section-number">16.16.5</span> Weryfikacja w R</a></li>
  <li><a href="#interpretacja-wyników" id="toc-interpretacja-wyników" class="nav-link" data-scroll-target="#interpretacja-wyników"><span class="header-section-number">16.16.6</span> Interpretacja Wyników</a></li>
  <li><a href="#porównanie-miar" id="toc-porównanie-miar" class="nav-link" data-scroll-target="#porównanie-miar"><span class="header-section-number">16.16.7</span> Porównanie Miar</a></li>
  </ul></li>
  <li><a href="#appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady" id="toc-appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady" class="nav-link" data-scroll-target="#appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady"><span class="header-section-number">16.17</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - podstawowe przykłady</a></li>
  <li><a href="#przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" id="toc-przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="nav-link" data-scroll-target="#przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">16.18</span> Przykład 1. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</a>
  <ul class="collapse">
  <li><a href="#dane" id="toc-dane" class="nav-link" data-scroll-target="#dane"><span class="header-section-number">16.18.1</span> Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh"><span class="header-section-number">16.18.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych"><span class="header-section-number">16.18.3</span> Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh"><span class="header-section-number">16.18.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</a></li>
  <li><a href="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.18.5</span> Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout" id="toc-example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout" class="nav-link" data-scroll-target="#example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">16.19</span> Example 2. Descriptive Statistics and OLS Example - Income and Voter Turnout</a>
  <ul class="collapse">
  <li><a href="#initial-r-output-for-reference" id="toc-initial-r-output-for-reference" class="nav-link" data-scroll-target="#initial-r-output-for-reference"><span class="header-section-number">16.19.1</span> Initial R Output for Reference</a></li>
  <li><a href="#dispersion-measures" id="toc-dispersion-measures" class="nav-link" data-scroll-target="#dispersion-measures"><span class="header-section-number">16.19.2</span> Dispersion Measures</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation"><span class="header-section-number">16.19.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">16.19.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#detailed-decomposition-of-variance-and-r-squared" id="toc-detailed-decomposition-of-variance-and-r-squared" class="nav-link" data-scroll-target="#detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">16.19.5</span> Detailed Decomposition of Variance and R-squared</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">16.19.6</span> Visualization</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">16.19.7</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" id="toc-example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="nav-link" data-scroll-target="#example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">16.20</span> Example 3. Anxiety Levels and Cognitive Performance: A Laboratory Study</a>
  <ul class="collapse">
  <li><a href="#data-and-context" id="toc-data-and-context" class="nav-link" data-scroll-target="#data-and-context"><span class="header-section-number">16.20.1</span> Data and Context</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">16.20.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-1" id="toc-covariance-and-correlation-1" class="nav-link" data-scroll-target="#covariance-and-correlation-1"><span class="header-section-number">16.20.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-1" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">16.20.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation" id="toc-r-squared-calculation" class="nav-link" data-scroll-target="#r-squared-calculation"><span class="header-section-number">16.20.5</span> 4. R-squared Calculation</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1"><span class="header-section-number">16.20.6</span> Visualization</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1"><span class="header-section-number">16.20.7</span> Interpretation</a></li>
  <li><a href="#study-limitations" id="toc-study-limitations" class="nav-link" data-scroll-target="#study-limitations"><span class="header-section-number">16.20.8</span> Study Limitations</a></li>
  </ul></li>
  <li><a href="#przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" id="toc-przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="nav-link" data-scroll-target="#przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">16.21</span> Przykład 4. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</a>
  <ul class="collapse">
  <li><a href="#dane-1" id="toc-dane-1" class="nav-link" data-scroll-target="#dane-1"><span class="header-section-number">16.21.1</span> Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1"><span class="header-section-number">16.21.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych"><span class="header-section-number">16.21.3</span> Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh"><span class="header-section-number">16.21.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</a></li>
  <li><a href="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.21.5</span> Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" id="toc-example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="nav-link" data-scroll-target="#example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">16.22</span> Example 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*)</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process"><span class="header-section-number">16.22.1</span> Data Generating Process</a></li>
  <li><a href="#descriptive-statistics-1" id="toc-descriptive-statistics-1" class="nav-link" data-scroll-target="#descriptive-statistics-1"><span class="header-section-number">16.22.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-2" id="toc-covariance-and-correlation-2" class="nav-link" data-scroll-target="#covariance-and-correlation-2"><span class="header-section-number">16.22.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-2" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">16.22.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation-1" id="toc-r-squared-calculation-1" class="nav-link" data-scroll-target="#r-squared-calculation-1"><span class="header-section-number">16.22.5</span> R-squared Calculation</a></li>
  <li><a href="#visualization---true-vs.-estimated-parameters" id="toc-visualization---true-vs.-estimated-parameters" class="nav-link" data-scroll-target="#visualization---true-vs.-estimated-parameters"><span class="header-section-number">16.22.6</span> Visualization - True vs.&nbsp;Estimated Parameters</a></li>
  <li><a href="#observations-about-model-fit" id="toc-observations-about-model-fit" class="nav-link" data-scroll-target="#observations-about-model-fit"><span class="header-section-number">16.22.7</span> Observations about Model Fit</a></li>
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2"><span class="header-section-number">16.22.8</span> Interpretation</a></li>
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context"><span class="header-section-number">16.22.9</span> Study Context</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">16.22.10</span> Limitations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Rozróżnienie między korelacją a przyczynowością (correlation vs.&nbsp;causation) stanowi fundamentalne wyzwanie w analizie statystycznej. Podczas gdy korelacja mierzy statystyczny związek między zmiennymi, przyczynowość oznacza bezpośredni wpływ jednej zmiennej na drugą. Ten rozdział bada to rozróżnienie i analizuje typowe problemy prowadzące do pozornych korelacji w badaniach empirycznych.</p>
<p>Zależności statystyczne stanowią podstawę podejmowania decyzji opartych na danych w różnych dyscyplinach – od ekonomii i zdrowia publicznego po psychologię i nauki o środowisku. Zrozumienie, kiedy zależność wskazuje na zwykłe powiązanie, a kiedy na rzeczywistą przyczynowość, jest kluczowe dla prawidłowego wnioskowania i skutecznych rekomendacji politycznych.</p>
<section id="kowariancja-covariance" class="level3" data-number="16.0.1">
<h3 data-number="16.0.1" class="anchored" data-anchor-id="kowariancja-covariance"><span class="header-section-number">16.0.1</span> Kowariancja (Covariance)</h3>
<p>Kowariancja mierzy, jak dwie zmienne zmieniają się razem, wskazując zarówno kierunek, jak i wielkość ich liniowej zależności.</p>
<p><strong>Wzór:</strong> <span class="math inline">cov(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">x_i</span> i <span class="math inline">y_i</span> to poszczególne punkty danych</li>
<li><span class="math inline">\bar{x}</span> i <span class="math inline">\bar{y}</span> to średnie zmiennych X i Y</li>
<li><span class="math inline">n</span> to liczba obserwacji</li>
</ul>
<p>Kowariancja przyjmuje wartości dodatnie, gdy zmienne mają tendencję do wzrostu razem, wartości ujemne, gdy jedna rośnie, a druga maleje, oraz wartości bliskie zeru, gdy między nimi istnieje niewielka zależność liniowa. Jednakże zależność kowariancji od skali utrudnia interpretację w przypadku różnych jednostek miary.</p>
</section>
<section id="współczynnik-korelacji-correlation-coefficient" class="level3" data-number="16.0.2">
<h3 data-number="16.0.2" class="anchored" data-anchor-id="współczynnik-korelacji-correlation-coefficient"><span class="header-section-number">16.0.2</span> Współczynnik korelacji (Correlation Coefficient)</h3>
<p>Aby rozwiązać problem zależności kowariancji od skali, współczynnik korelacji standaryzuje miarę do zakresu od -1 do 1.</p>
<p><strong>Wzór korelacji Pearsona:</strong> <span class="math inline">r = \frac{cov(X,Y)}{s_X s_Y} = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^n (x_i - \bar{x})^2 \sum_{i=1}^n (y_i - \bar{y})^2}}</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">s_X</span> i <span class="math inline">s_Y</span> to odchylenia standardowe X i Y</li>
</ul>
<p>Współczynnik korelacji zapewnia standaryzowaną miarę zależności liniowej, która ułatwia porównanie między różnymi parami zmiennych i zbiorami danych.</p>
</section>
<section id="kontekst-historyczny" class="level3" data-number="16.0.3">
<h3 data-number="16.0.3" class="anchored" data-anchor-id="kontekst-historyczny"><span class="header-section-number">16.0.3</span> Kontekst historyczny</h3>
<p>Pojęcia korelacji i regresji zostały sformalizowane pod koniec XIX wieku przez Sir Francisa Galtona, a następnie rozwinięte przez Karla Pearsona. Ich praca zrewolucjonizowała analizę danych, dostarczając matematycznych ram do ilościowego określania relacji między zmiennymi. Obecnie techniki te pozostają fundamentalne w dziedzinach od genomiki po finanse, stanowiąc podstawę dla bardziej zaawansowanych metod statystycznych.</p>
<p>W kolejnych sekcjach dogłębnie zbadamy korelację i regresję, analizując ich założenia, ograniczenia oraz zastosowania w rzeczywistych wyzwaniach analizy danych.</p>
</section>
<section id="rodzaje-korelacji" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="rodzaje-korelacji"><span class="header-section-number">16.1</span> Rodzaje korelacji</h2>
<p>Korelacja mierzy siłę i kierunek liniowej zależności między dwiema zmiennymi. Wpółczynnik korelacji Pearsona (r) przyjmuje wartości od -1 do +1:</p>
<ul>
<li>+1 oznacza idealną dodatnią korelację</li>
<li>0 oznacza brak korelacji</li>
<li>-1 oznacza idealną ujemną korelację</li>
</ul>
<p>Poniższe wizualizacje przedstawiają różne typy zależności:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data with different correlation patterns</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># sample size</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Positive linear correlation (education and income)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>years_education <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">3</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>annual_income <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="sc">+</span> <span class="dv">3500</span> <span class="sc">*</span> years_education <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Negative linear correlation (screen time and sleep)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>screen_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>sleep_hours <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> screen_time <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># No correlation (random data)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>x_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>y_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-linear correlation (quadratic relationship)</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>hours_studied <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">12</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>test_score <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (hours_studied <span class="sc">-</span> <span class="dv">6</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">90</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frames</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>positive_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> years_education, <span class="at">y =</span> annual_income, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">label =</span> <span class="st">"Korelacja dodatnia: Edukacja i dochód"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>negative_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> screen_time, <span class="at">y =</span> sleep_hours, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">label =</span> <span class="st">"Korelacja ujemna: Czas przed ekranem i sen"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>no_corr_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_random, <span class="at">y =</span> y_random, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">label =</span> <span class="st">"Brak korelacji: Zmienne losowe"</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>nonlinear_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> hours_studied, <span class="at">y =</span> test_score, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">label =</span> <span class="st">"Korelacja nieliniowa: Czas nauki i wyniki"</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data for faceted plot</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  positive_data,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  negative_data,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  no_corr_data,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  nonlinear_data</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create faceted plot</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Różne typy korelacji"</span>,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/correlation_types-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>W przypadku zależności nieliniowej model liniowy jest nieodpowiedni. Model kwadratowy lepiej odzwierciedla rzeczywistą zależność:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nonlinear_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Korelacja nieliniowa: Czas nauki a wyniki testów"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model liniowy (czerwony) vs. Model kwadratowy (zielony)"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Godziny nauki"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Wynik testu"</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/nonlinear_correlation-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="analiza-regresji---wprowadzenie" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="analiza-regresji---wprowadzenie"><span class="header-section-number">16.2</span> Analiza Regresji - wprowadzenie</h2>
<p>Analiza regresji stanowi metodologię modelowania zależności między zmienną objaśnianą a jedną lub wieloma zmiennymi objaśniającymi. Metoda najmniejszych kwadratów (OLS - Ordinary Least Squares) minimalizuje sumę kwadratów reszt w celu znalezienia najlepiej dopasowanej linii trendu.</p>
<section id="model-regresji-liniowej" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="model-regresji-liniowej"><span class="header-section-number">16.2.1</span> Model Regresji Liniowej</h3>
<p>Prosty model regresji liniowej można wyrazić jako:</p>
<p><span class="math inline">Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i</span></p>
<p>Gdzie:</p>
<ul>
<li><p><span class="math inline">Y_i</span> to zmienna objaśniana dla obserwacji <span class="math inline">i</span></p></li>
<li><p><span class="math inline">X_i</span> to zmienna objaśniająca dla obserwacji <span class="math inline">i</span></p></li>
<li><p><span class="math inline">\beta_0</span> to wyraz wolny (intercept)</p></li>
<li><p><span class="math inline">\beta_1</span> to współczynnik kierunkowy (slope coefficient)</p></li>
<li><p><span class="math inline">\varepsilon_i</span> to składnik losowy (error term, residuals)</p></li>
</ul>
<p>Regresja wieloraka rozszerza ten model o większą liczbę predyktorów:</p>
<p><span class="math display">
Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + ... + \beta_k X_{ki} + \varepsilon_i
</span></p>
</section>
<section id="intuicyjne-zrozumienie-najlepszego-dopasowania-best-fit-modelu-do-danych-w-regresji-ols-ordinary-least-squares" class="level3" data-number="16.2.2">
<h3 data-number="16.2.2" class="anchored" data-anchor-id="intuicyjne-zrozumienie-najlepszego-dopasowania-best-fit-modelu-do-danych-w-regresji-ols-ordinary-least-squares"><span class="header-section-number">16.2.2</span> Intuicyjne Zrozumienie “Najlepszego Dopasowania” (“Best Fit”) Modelu do Danych w Regresji OLS (Ordinary Least Squares)</h3>
<section id="co-właściwie-oznacza-najlepsze-dopasowanie" class="level4" data-number="16.2.2.1">
<h4 data-number="16.2.2.1" class="anchored" data-anchor-id="co-właściwie-oznacza-najlepsze-dopasowanie"><span class="header-section-number">16.2.2.1</span> Co właściwie oznacza “najlepsze dopasowanie”?</h4>
<p>W analizie regresji chcemy znaleźć linię, która najlepiej reprezentuje związek między naszymi zmiennymi. Ale co sprawia, że linia jest “najlepsza”?</p>
<p>Wyobraź sobie wykres rozrzutu punktów danych. Istnieje nieskończenie wiele linii, które można poprowadzić przez te punkty. <strong>Linia najlepszego dopasowania</strong> (line of best fit) to ta, która minimalizuje całkowitą odległość między linią a wszystkimi punktami danych.</p>
</section>
<section id="dlaczego-używamy-sumy-kwadratów-błędów-sse---sum-of-squared-errors" class="level4" data-number="16.2.2.2">
<h4 data-number="16.2.2.2" class="anchored" data-anchor-id="dlaczego-używamy-sumy-kwadratów-błędów-sse---sum-of-squared-errors"><span class="header-section-number">16.2.2.2</span> Dlaczego używamy sumy kwadratów błędów (SSE - Sum of Squared Errors)?</h4>
<p>Metoda OLS definiuje “najlepsze dopasowanie” jako linię, która minimalizuje sumę kwadratów błędów:</p>
<p><span class="math display">
SSE = \sum_{i=1}^{n} (Y_i - \hat{Y}_i)^2 = \sum_{i=1}^{n} \varepsilon_i^2
</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y_i</span> to rzeczywista zaobserwowana wartość</li>
<li><span class="math inline">\hat{Y}_i</span> to wartość przewidywana z naszej linii regresji</li>
<li><span class="math inline">\varepsilon_i</span> to reszta (błąd) dla każdej obserwacji</li>
</ul>
<p>Ale dlaczego podnosimy błędy do kwadratu? Istnieją cztery główne powody:</p>
<ol type="1">
<li><p><strong>Równe traktowanie błędów dodatnich i ujemnych</strong>: Przez podnoszenie do kwadratu zapewniamy, że punkty powyżej i poniżej linii w równym stopniu przyczyniają się do naszej miary dopasowania.</p></li>
<li><p><strong>Unikanie wzajemnego znoszenia się błędów</strong>: Jeśli użylibyśmy zwykłej sumy błędów <span class="math inline">\sum (Y_i - \hat{Y}_i)</span>, otrzymalibyśmy zawsze wartość zero dla linii regresji OLS, ponieważ dodatnie i ujemne odchylenia wzajemnie się znoszą. Faktycznie, można matematycznie udowodnić, że dla linii regresji OLS suma reszt zawsze wynosi zero: <span class="math inline">\sum \varepsilon_i = 0</span>. Podnoszenie do kwadratu zapobiega temu efektowi.</p></li>
<li><p><strong>Większa kara za duże błędy</strong>: Podnoszenie do kwadratu nadaje większą wagę dużym błędom, sprawiając, że linia jest bardziej wrażliwa na wartości odstające.</p></li>
<li><p><strong>Zalety matematyczne</strong>: Kwadratowa funkcja celu ma szereg zalet matematycznych:</p>
<ul>
<li>Tworzy funkcję wypukłą (convex function) z pojedynczym globalnym minimum</li>
<li>Pochodna funkcji kwadratowej jest liniowa, co prowadzi do rozwiązań w postaci jawnej (closed-form solutions)</li>
<li>Pozwala to na bezpośrednie analityczne wyprowadzenie współczynników regresji</li>
<li>Inne miary błędów (jak np. suma wartości bezwzględnych odchyleń) nie mają takich właściwości i często wymagają metod iteracyjnych do znalezienia rozwiązania</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create base plot</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">col=</span><span class="st">"darkblue"</span>, </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Wizualizacja Najmniejszych Kwadratów (OLS)"</span>, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"X"</span>, <span class="at">ylab=</span><span class="st">"Y"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add regression line</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add residual lines</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(x, y, x, <span class="fu">fitted</span>(model), <span class="at">col=</span><span class="st">"green"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Punkty danych"</span>, <span class="st">"Linia regresji"</span>, <span class="st">"Reszty (residuals)"</span>), </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="fl">1.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/ols-visualization-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ta wizualizacja pokazuje, jak metoda najmniejszych kwadratów minimalizuje kwadraty długości zielonych linii (reszt). Linia czerwona została tak dobrana, że suma kwadratów tych odchyleń jest najmniejsza ze wszystkich możliwych linii prostych.</p>
</section>
</section>
<section id="koncepcja-sumy-kwadratów-błędów-sse" class="level3" data-number="16.2.3">
<h3 data-number="16.2.3" class="anchored" data-anchor-id="koncepcja-sumy-kwadratów-błędów-sse"><span class="header-section-number">16.2.3</span> Koncepcja Sumy Kwadratów Błędów (SSE)</h3>
<p>Suma kwadratów błędów (SSE) jest fundamentalnym konceptem w regresji liniowej metodą najmniejszych kwadratów (OLS). Aby lepiej zrozumieć tę koncepcję:</p>
<ol type="1">
<li><strong>Reszty</strong>: Każdy błąd (reszta, <span class="math inline">\varepsilon_i</span>) to pionowa odległość między punktem danych a linią regresji</li>
<li><strong>Kwadraty błędów</strong>: Podnosimy każdą resztę do kwadratu, co:
<ul>
<li>Eliminuje problem znaków (dodatnie i ujemne błędy nie znoszą się wzajemnie)</li>
<li>Penalizuje większe błędy bardziej niż mniejsze (błąd 2 razy większy ma 4 razy większy wpływ)</li>
</ul></li>
<li><strong>Suma</strong>: Sumujemy wszystkie kwadraty błędów, otrzymując miarę dopasowania modelu</li>
<li><strong>Minimalizacja</strong>: Linia regresji OLS jest tą, która minimalizuje tę sumę</li>
</ol>
</section>
<section id="wizualizacja-sumy-kwadratów-błędów-w-regresji-liniowej" class="level3" data-number="16.2.4">
<h3 data-number="16.2.4" class="anchored" data-anchor-id="wizualizacja-sumy-kwadratów-błędów-w-regresji-liniowej"><span class="header-section-number">16.2.4</span> Wizualizacja Sumy Kwadratów Błędów w Regresji Liniowej</h3>
<p>Aby zrozumieć tę koncepcję wizualnie:</p>
<ol type="1">
<li>Wyobraź sobie każdy błąd jako pionową linię od punktu danych do linii regresji</li>
<li>Każda z tych linii reprezentuje resztę (rezyduum, <span class="math inline">\varepsilon_i</span>)</li>
<li>Podnosimy do kwadratu każdą resztę (tworząc kwadratową powierzchnię)</li>
<li>Suma wszystkich tych kwadratowych powierzchni to właśnie to, co staramy się zminimalizować</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)  <span class="co"># For better label placement</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(model)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residuals</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> preds</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> preds</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only a few points to label (to reduce clutter)</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>points_to_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add light gray grid for better reference</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray85"</span>)</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> coef[<span class="dv">1</span>], <span class="at">slope =</span> coef[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add residual lines with higher visibility</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> predicted), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add squared error visualization - clearer squares</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> x <span class="sc">-</span> <span class="fu">abs</span>(residuals)<span class="sc">/</span><span class="dv">2</span>, <span class="at">xmax =</span> x <span class="sc">+</span> <span class="fu">abs</span>(residuals)<span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> predicted, <span class="at">ymax =</span> predicted <span class="sc">+</span> <span class="fu">sign</span>(residuals) <span class="sc">*</span> <span class="fu">abs</span>(residuals)),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"tomato"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data points on top</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add labels for selected residuals with better visibility</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data[points_to_label, ], </span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"ε ="</span>, <span class="fu">round</span>(residuals, <span class="dv">1</span>))),</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">4.5</span>,</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"white"</span>,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.r =</span> <span class="fl">0.15</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">0.5</span>,</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">point.padding =</span> <span class="fl">0.5</span>,</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">force =</span> <span class="dv">10</span>,</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkred"</span>,</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add annotation for squared errors with better visibility</span></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data[points_to_label, ], </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> predicted <span class="sc">+</span> <span class="fu">sign</span>(residuals) <span class="sc">*</span> <span class="fu">abs</span>(residuals)<span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"ε² ="</span>, <span class="fu">round</span>(residuals<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>))),</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">4.5</span>,</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.color =</span> <span class="st">"white"</span>,</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">bg.r =</span> <span class="fl">0.15</span>,</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"darkred"</span>,</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">0.5</span>,</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">force =</span> <span class="dv">5</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add prominent SSE annotation with box</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fu">max</span>(x) <span class="sc">-</span> <span class="dv">7</span>, <span class="at">xmax =</span> <span class="fu">max</span>(x), </span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">ymin =</span> <span class="fu">min</span>(y) <span class="sc">+</span> <span class="dv">3</span>, <span class="at">ymax =</span> <span class="fu">min</span>(y) <span class="sc">+</span> <span class="dv">7</span>,</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"lightyellow"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fl">3.5</span>, <span class="at">y =</span> <span class="fu">min</span>(y) <span class="sc">+</span> <span class="dv">5</span>, </span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Suma SSE ="</span>, <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>), <span class="dv">1</span>)),</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Improved titles</span></span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wizualizacja Sumy Kwadratów Błędów"</span>,</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Czerwone kwadraty reprezentują kwadraty błędów (powierzchnia = ε²)"</span>,</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>) <span class="sc">+</span></span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/visualize-sse-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Wizualizacja Sumy Kwadratów Błędów</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="wizualizacja-ols-poprzez-różne-linie" class="level3" data-number="16.2.5">
<h3 data-number="16.2.5" class="anchored" data-anchor-id="wizualizacja-ols-poprzez-różne-linie"><span class="header-section-number">16.2.5</span> Wizualizacja OLS Poprzez Różne Linie</h3>
<p>Prosty, ale skuteczny sposób wizualizacji koncepcji “najlepszego dopasowania” to porównanie wielu linii i wynikających z nich wartości SSE:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(model)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define different lines: optimal and sub-optimal with clearer differences</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>lines <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Najlepsze Dopasowanie (OLS)"</span>, <span class="st">"Linia A"</span>, <span class="st">"Linia B"</span>, <span class="st">"Linia C"</span>),</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">c</span>(coef[<span class="dv">1</span>], coef[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">8</span>, coef[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">8</span>, coef[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">4</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">c</span>(coef[<span class="dv">2</span>], coef[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.2</span>, coef[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.8</span>, coef[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.7</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate SSE for each line</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>lines<span class="sc">$</span>sse <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(lines), <span class="cf">function</span>(i) {</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> lines<span class="sc">$</span>intercept[i] <span class="sc">+</span> lines<span class="sc">$</span>slope[i] <span class="sc">*</span> x</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((y <span class="sc">-</span> predicted)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add percentage increase over optimal SSE</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>lines<span class="sc">$</span>pct_increase <span class="ot">&lt;-</span> <span class="fu">round</span>((lines<span class="sc">$</span>sse <span class="sc">/</span> lines<span class="sc">$</span>sse[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>lines<span class="sc">$</span>pct_text <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lines<span class="sc">$</span>label <span class="sc">==</span> <span class="st">"Najlepsze Dopasowanie (OLS)"</span>, </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Optymalne"</span>, </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">"+"</span>, lines<span class="sc">$</span>pct_increase, <span class="st">"%"</span>))</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign distinct colors for better visibility</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>line_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Najlepsze Dopasowanie (OLS)"</span> <span class="ot">=</span> <span class="st">"blue"</span>, </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Linia A"</span> <span class="ot">=</span> <span class="st">"red"</span>, </span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Linia B"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Linia C"</span> <span class="ot">=</span> <span class="st">"purple"</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data for mini residual plots</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>mini_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(lines)) {</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  line_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">predicted =</span> lines<span class="sc">$</span>intercept[i] <span class="sc">+</span> lines<span class="sc">$</span>slope[i] <span class="sc">*</span> x,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">residuals =</span> y <span class="sc">-</span> (lines<span class="sc">$</span>intercept[i] <span class="sc">+</span> lines<span class="sc">$</span>slope[i] <span class="sc">*</span> x),</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">line =</span> lines<span class="sc">$</span>label[i]</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  mini_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mini_data, line_data)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Create main comparison plot with improved visibility</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add background grid for reference</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray85"</span>),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data points</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add lines with improved visibility</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> lines, </span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope, </span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> label, <span class="at">linetype =</span> label <span class="sc">==</span> <span class="st">"Najlepsze Dopasowanie (OLS)"</span>),</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use custom colors</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> line_colors) <span class="sc">+</span></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span> <span class="ot">=</span> <span class="st">"solid"</span>, <span class="st">"FALSE"</span> <span class="ot">=</span> <span class="st">"dashed"</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Better legends</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porównanie Różnych Linii Regresji"</span>,</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Linia OLS minimalizuje sumę kwadratów błędów"</span>,</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>,</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Linia Regresji"</span>) <span class="sc">+</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)))</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mini residual plots with improved visibility</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>p_mini <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(lines)) {</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  line_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(mini_data, line <span class="sc">==</span> lines<span class="sc">$</span>label[i])</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  p_mini[[i]] <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(line_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add reference line</span></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add residual points with line color</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> line_colors[lines<span class="sc">$</span>label[i]], <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add squares to represent squared errors</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> x <span class="sc">-</span> <span class="fl">0.3</span>, <span class="at">xmax =</span> x <span class="sc">+</span> <span class="fl">0.3</span>,</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> residuals),</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> line_colors[lines<span class="sc">$</span>label[i]], <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Improved titles</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> lines<span class="sc">$</span>label[i],</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"SSE ="</span>, <span class="fu">round</span>(lines<span class="sc">$</span>sse[i], <span class="dv">1</span>), </span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(i <span class="sc">==</span> <span class="dv">1</span>, <span class="st">" (Optymalne)"</span>, </span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">paste0</span>(<span class="st">" (+"</span>, lines<span class="sc">$</span>pct_increase[i], <span class="st">"%)"</span>))),</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> line_colors[lines<span class="sc">$</span>label[i]]),</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Create SSE comparison table with better visibility</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>sse_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(lines)),</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">nrow</span>(lines)<span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(lines<span class="sc">$</span>label, <span class="st">": SSE = "</span>, <span class="fu">round</span>(lines<span class="sc">$</span>sse, <span class="dv">1</span>), <span class="st">" ("</span>, lines<span class="sc">$</span>pct_text, <span class="st">")"</span>),</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> line_colors[lines<span class="sc">$</span>label]</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>sse_table <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sse_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label, <span class="at">color =</span> color)) <span class="sc">+</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.5</span>, <span class="fu">nrow</span>(lines) <span class="sc">+</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Porównanie Sumy Kwadratów Błędów (SSE)"</span>) <span class="sc">+</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>))</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the plots with better spacing</span></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>  p1, </span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrangeGrob</span>(p_mini[[<span class="dv">1</span>]], p_mini[[<span class="dv">2</span>]], p_mini[[<span class="dv">3</span>]], p_mini[[<span class="dv">4</span>]], </span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>              <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">padding =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>)),</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>  sse_table, </span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, </span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/compare-lines-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Porównanie różnych linii regresji</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ulepszona-wizualizacja-kwadratów-reszt" class="level3" data-number="16.2.6">
<h3 data-number="16.2.6" class="anchored" data-anchor-id="ulepszona-wizualizacja-kwadratów-reszt"><span class="header-section-number">16.2.6</span> Ulepszona Wizualizacja Kwadratów Reszt</h3>
<p>Ta wizualizacja wyraźnie pokazuje, jak kwadraty reszt przyczyniają się do SSE:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate residuals for OLS line</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create classification for residual sizes</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>res_category <span class="ot">&lt;-</span> <span class="fu">cut</span>(<span class="fu">abs</span>(data<span class="sc">$</span>residuals), </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">breaks =</span> <span class="fu">quantile</span>(<span class="fu">abs</span>(data<span class="sc">$</span>residuals), <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>)), </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Małe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Duże"</span>, <span class="st">"Bardzo duże"</span>),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Create better color palette for residual categories</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>res_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Małe"</span> <span class="ot">=</span> <span class="st">"#FEE5D9"</span>, <span class="st">"Średnie"</span> <span class="ot">=</span> <span class="st">"#FCAE91"</span>, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Duże"</span> <span class="ot">=</span> <span class="st">"#FB6A4A"</span>, <span class="st">"Bardzo duże"</span> <span class="ot">=</span> <span class="st">"#CB181D"</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create SSE contribution information</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>contribution_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Category =</span> <span class="fu">c</span>(<span class="st">"Małe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Duże"</span>, <span class="st">"Bardzo duże"</span>),</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Contribution =</span> <span class="fu">c</span>(</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residuals[data<span class="sc">$</span>res_category <span class="sc">==</span> <span class="st">"Małe"</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residuals[data<span class="sc">$</span>res_category <span class="sc">==</span> <span class="st">"Średnie"</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residuals[data<span class="sc">$</span>res_category <span class="sc">==</span> <span class="st">"Duże"</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residuals[data<span class="sc">$</span>res_category <span class="sc">==</span> <span class="st">"Bardzo duże"</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(data<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Select fewer points to label to reduce overlap</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>points_to_label <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">18</span>)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create main plot with enhanced visibility</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>main_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add light grid for better reference</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray90"</span>),</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray85"</span>),</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line first (bottom layer)</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> coef[<span class="dv">1</span>], <span class="at">slope =</span> coef[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add residual lines with better visibility</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> predicted, <span class="at">color =</span> res_category), </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create actual squares with outlines for better visibility</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> x <span class="sc">-</span> <span class="fu">abs</span>(residuals)<span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> x <span class="sc">+</span> <span class="fu">abs</span>(residuals)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> predicted <span class="sc">-</span> <span class="fu">abs</span>(residuals)<span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> predicted <span class="sc">+</span> <span class="fu">abs</span>(residuals)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> res_category),</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add original data points on top</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enhanced labels with more separation and better repulsion parameters</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data[points_to_label, ],</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ε = "</span>, <span class="fu">round</span>(residuals, <span class="dv">1</span>), </span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"</span><span class="sc">\n</span><span class="st">ε² = "</span>, <span class="fu">round</span>(residuals<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span>))),</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">box.padding =</span> <span class="fl">0.8</span>,         <span class="co"># Increased padding for better separation</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">point.padding =</span> <span class="fl">0.7</span>,       <span class="co"># Increased point padding</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="fl">0.2</span>,  <span class="co"># Force segments</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">force =</span> <span class="dv">15</span>,                <span class="co"># Increased repulsion force</span></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"both"</span>,        <span class="co"># Allow repulsion in all directions</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">segment.color =</span> <span class="st">"gray50"</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Better color scales</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> res_colors) <span class="sc">+</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> res_colors) <span class="sc">+</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Better titles and labels</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wizualizacja Sumy Kwadratów Błędów (SSE)"</span>,</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Powierzchnie kwadratów reprezentują kwadraty reszt (powierzchnia = ε²)"</span>,</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>,</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Wielkość Reszty"</span>,</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Wielkość Reszty"</span>)</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Create separate plot for SSE values and contribution</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>sse_value <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a formatted table for contribution data</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>sse_table <span class="ot">&lt;-</span> <span class="fu">tableGrob</span>(</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>  contribution_data,</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">rows =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Kategoria Reszt"</span>, <span class="st">"Udział (%)"</span>),</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">ttheme_minimal</span>(</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_size =</span> <span class="dv">11</span>,</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">core =</span> <span class="fu">list</span>(<span class="at">fg_params =</span> <span class="fu">list</span>(<span class="at">fontface =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"plain"</span>, <span class="dv">4</span>), <span class="st">"bold"</span>)),</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>                <span class="at">bg_params =</span> <span class="fu">list</span>(<span class="at">fill =</span> <span class="fu">c</span>(res_colors, <span class="st">"white"</span>))),</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">colhead =</span> <span class="fu">list</span>(<span class="at">fg_params =</span> <span class="fu">list</span>(<span class="at">fontface =</span> <span class="st">"bold"</span>))</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Add sum row at the bottom of the table</span></span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>sum_row <span class="ot">&lt;-</span> <span class="fu">tableGrob</span>(</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">Category =</span> <span class="st">"SUMA"</span>, <span class="at">Contribution =</span> <span class="st">"100.0"</span>),</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">rows =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">""</span>),</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">ttheme_minimal</span>(</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_size =</span> <span class="dv">11</span>,</span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">core =</span> <span class="fu">list</span>(<span class="at">fg_params =</span> <span class="fu">list</span>(<span class="at">fontface =</span> <span class="st">"bold"</span>)),</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">colhead =</span> <span class="fu">list</span>(<span class="at">fg_params =</span> <span class="fu">list</span>(<span class="at">fontface =</span> <span class="st">"bold"</span>))</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine contribution table and sum row</span></span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>combined_table <span class="ot">&lt;-</span> gtable<span class="sc">:::</span><span class="fu">rbind_gtable</span>(sse_table, sum_row, <span class="st">"first"</span>)</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Create title for the table</span></span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>sse_title <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">"Suma Kwadratów Błędów ="</span>, <span class="fu">round</span>(sse_value, <span class="dv">2</span>)),</span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">fontsize =</span> <span class="dv">14</span>, <span class="at">col =</span> <span class="st">"darkred"</span>),</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">hjust =</span> <span class="dv">0</span></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine title and table</span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>sse_grob <span class="ot">&lt;-</span> <span class="fu">arrangeGrob</span>(</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>  sse_title,</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>  combined_table,</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine main plot and SSE table into one composition</span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>  main_plot,</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>  sse_grob,</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>)</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/residual-squares-1.png" class="img-fluid figure-img" width="864"></p>
<figcaption>Wizualizacja kwadratów reszt</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="kluczowe-punkty-do-zapamiętania" class="level3" data-number="16.2.7">
<h3 data-number="16.2.7" class="anchored" data-anchor-id="kluczowe-punkty-do-zapamiętania"><span class="header-section-number">16.2.7</span> Kluczowe Punkty Do Zapamiętania</h3>
<ul>
<li>Suma Kwadratów Błędów (SSE) to właśnie to, co minimalizuje regresja metodą Najmniejszych Kwadratów (OLS)</li>
<li>Każda reszta przyczynia się swoją wartością podniesioną do kwadratu do całkowitej SSE</li>
<li>Linia OLS ma niższą wartość SSE niż każda inna możliwa linia</li>
<li>Duże reszty nieproporcjonalnie mocno wpływają na SSE z powodu operacji podnoszenia do kwadratu</li>
<li>Dlatego wartości odstające mogą mieć tak silny wpływ na linie regresji</li>
</ul>
</section>
<section id="alternatywna-wizualizacja-sse-pionowe-odległości" class="level3" data-number="16.2.8">
<h3 data-number="16.2.8" class="anchored" data-anchor-id="alternatywna-wizualizacja-sse-pionowe-odległości"><span class="header-section-number">16.2.8</span> Alternatywna Wizualizacja SSE: Pionowe Odległości</h3>
<p>Ta wizualizacja pokazuje tradycyjne podejście do SSE, gdzie błędy są reprezentowane jako pionowe odległości od punktów do linii regresji:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu regresji</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(model)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu z lepszym formatowaniem</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Siatka pomocnicza dla lepszej czytelności</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">10</span>), <span class="at">color =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>) <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Punkty danych z lepszym kontrastem</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia regresji z opisem</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> coef[<span class="dv">1</span>], <span class="at">slope =</span> coef[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">"forestgreen"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linie reszt</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> predicted, <span class="at">color =</span> <span class="fu">abs</span>(residuals)), </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prostokąty reprezentujące obszar reszt (nie kwadraty!)</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> x <span class="sc">-</span> <span class="fl">0.2</span>, <span class="at">xmax =</span> x <span class="sc">+</span> <span class="fl">0.2</span>, </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="fu">pmin</span>(y, predicted), </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymax =</span> <span class="fu">pmax</span>(y, predicted),</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="fu">abs</span>(residuals)),</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Skala kolorów dla reszt</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">name =</span> <span class="st">"Wielkość błędu"</span>, <span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">name =</span> <span class="st">"Wielkość błędu"</span>, <span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Lepsza anotacja i etykiety</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wizualizacja Pionowych Odległości (Reszt)"</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Czerwone obszary pokazują wielkość błędów, które po podniesieniu do kwadratu sumujemy w SSE"</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna niezależna (X)"</span>,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna zależna (Y)"</span>) <span class="sc">+</span></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">15</span>, <span class="at">y =</span> <span class="dv">20</span>, </span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Równanie: y ="</span>, <span class="fu">round</span>(coef[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">"+"</span>, <span class="fu">round</span>(coef[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">"* x"</span>),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"forestgreen"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">"gray30"</span>),</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/wizualizacja-sse-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Wizualizacja pionowych odległości</figcaption>
</figure>
</div>
</div>
</div>
<section id="krok-po-kroku-minimalizacja-sse" class="level4" data-number="16.2.8.1">
<h4 data-number="16.2.8.1" class="anchored" data-anchor-id="krok-po-kroku-minimalizacja-sse"><span class="header-section-number">16.2.8.1</span> Krok po Kroku Minimalizacja SSE</h4>
<p>Aby zilustrować proces znajdowania minimum SSE, możemy stworzyć sekwencję przechodzącą przez punkt optymalny, pokazując jak SSE najpierw zmniejsza się do minimum, a następnie znów rośnie:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu regresji</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>coef <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(model)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie sekwencji kroków przechodzącej przez optymalną linię OLS</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>steps <span class="ot">&lt;-</span> <span class="dv">9</span>  <span class="co"># Użyj nieparzystej liczby, aby mieć środkowy punkt w optimum</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>step_seq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">step =</span> <span class="dv">1</span><span class="sc">:</span>steps,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">seq</span>(coef[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">8</span>, coef[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">8</span>, <span class="at">length.out =</span> steps),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">seq</span>(coef[<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.5</span>, coef[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">length.out =</span> steps)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Oznaczenie środkowego kroku (optymalne rozwiązanie OLS)</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>optimal_step <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(steps<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie SSE dla każdego kroku</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>step_seq<span class="sc">$</span>sse <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(step_seq), <span class="cf">function</span>(i) {</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> step_seq<span class="sc">$</span>intercept[i] <span class="sc">+</span> step_seq<span class="sc">$</span>slope[i] <span class="sc">*</span> x</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((y <span class="sc">-</span> predicted)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie wykresu "podróży przez dolinę SSE"</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> step_seq, </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope, </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> sse, <span class="at">group =</span> step),</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Podświetlenie optymalnej linii</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> step_seq<span class="sc">$</span>intercept[optimal_step], </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> step_seq<span class="sc">$</span>slope[optimal_step],</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Podróż Przez Dolinę SSE"</span>,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Zielona linia reprezentuje rozwiązanie OLS z minimalnym SSE"</span>,</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Wartość SSE"</span>) <span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie wykresu doliny SSE</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(step_seq, <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> sse)) <span class="sc">+</span></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">color =</span> sse)) <span class="sc">+</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Podświetlenie optymalnego punktu</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> step_seq[optimal_step, ], <span class="fu">aes</span>(<span class="at">x =</span> step, <span class="at">y =</span> sse), </span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dodanie adnotacji</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> optimal_step, <span class="at">y =</span> step_seq<span class="sc">$</span>sse[optimal_step] <span class="sc">*</span> <span class="fl">1.1</span>, </span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Minimum SSE"</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dolina SSE: Zmniejszenie, a Następnie Zwiększenie"</span>,</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"SSE osiąga minimum w rozwiązaniu OLS"</span>,</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Krok"</span>,</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Suma Kwadratów Błędów"</span>) <span class="sc">+</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie obu wykresów</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p2, p3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/dolina-sse-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Wizualizacja minimalizacji SSE</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="estymator-ols" class="level3" data-number="16.2.9">
<h3 data-number="16.2.9" class="anchored" data-anchor-id="estymator-ols"><span class="header-section-number">16.2.9</span> Estymator OLS</h3>
<p>Estymator OLS dla współczynników minimalizuje:</p>
<p><span class="math display">
\sum_{i=1}^{n} (Y_i - \hat{Y}_i)^2
</span></p>
<p>Gdzie <span class="math inline">\hat{Y}_i</span> to przewidywana wartość dla obserwacji <span class="math inline">i</span>.</p>
<p>Aby OLS dawał nieobciążone estymatory, musi być spełnionych kilka założeń:</p>
<ol type="1">
<li><p><strong>Liniowość</strong> (Linearity): Zależność między X i Y jest liniowa</p></li>
<li><p><strong>Niezależność</strong> (Independence): Obserwacje są niezależne od siebie</p></li>
<li><p><strong>Homoskedastyczność</strong> (Homoscedasticity): Wariancja błędu jest stała dla wszystkich poziomów X</p></li>
<li><p><strong>Normalność</strong> (Normality): Błędy mają rozkład normalny</p></li>
<li><p><strong>Brak multikolinearności</strong> (No multicollinearity): Predyktory nie są doskonale skorelowane</p></li>
<li><p><strong>Egzogeniczność</strong> (Exogeneity): Składnik losowy nie jest skorelowany z predyktorami</p></li>
</ol>
<p>Ostatnie założenie jest szczególnie ważne dla naszej dyskusji o pozornych korelacjach. Naruszenia założenia egzogeniczności prowadzą do problemów endogeniczności, które omówimy później.</p>
<p>W R funkcja <code>lm()</code> dopasowuje modele regresji liniowej:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> ramka_danych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpretacja-modelu-przewodnik-dla-początkujących" class="level3" data-number="16.2.10">
<h3 data-number="16.2.10" class="anchored" data-anchor-id="interpretacja-modelu-przewodnik-dla-początkujących"><span class="header-section-number">16.2.10</span> Interpretacja Modelu: Przewodnik dla Początkujących</h3>
<p>Stwórzmy prosty zbiór danych, aby lepiej zrozumieć wyniki regresji. Wyobraźmy sobie, że badamy, jak lata edukacji wpływają na miesięczne dochody:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie prostego zbioru danych - to nasz Proces Generujący Dane (DGP)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># Dla powtarzalności</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>lata_edukacji <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>  <span class="co"># Edukacja od 10 do 20 lat</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(lata_edukacji)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Prawdziwe parametry w naszym modelu - używamy realistycznych wartości dla Polski</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>prawdziwy_wyraz_wolny <span class="ot">&lt;-</span> <span class="dv">3000</span>   <span class="co"># Bazowy miesięczny dochód bez edukacji (w PLN)</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>prawdziwe_nachylenie <span class="ot">&lt;-</span> <span class="dv">250</span>     <span class="co"># Każdy rok edukacji zwiększa miesięczny dochód o 250 PLN</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie miesięcznych dochodów z losowym szumem</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>dochod <span class="ot">&lt;-</span> prawdziwy_wyraz_wolny <span class="sc">+</span> prawdziwe_nachylenie <span class="sc">*</span> lata_edukacji <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">300</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie naszego zbioru danych</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>edukacja_dochod <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">edukacja =</span> lata_edukacji,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> dochod</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja danych</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(edukacja_dochod, <span class="fu">aes</span>(<span class="at">x =</span> edukacja, <span class="at">y =</span> dochod)) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">8500</span>), </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5000</span>, <span class="dv">8500</span>, <span class="at">by =</span> <span class="dv">500</span>),</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Zależność między wykształceniem a dochodem w Polsce"</span>,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lata edukacji"</span>,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miesięczny dochód (PLN)"</span>,</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Czerwona linia pokazuje oszacowaną zależność liniową"</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">11</span>, <span class="at">y =</span> <span class="dv">8000</span>, </span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Każdy punkt reprezentuje</span><span class="sc">\n</span><span class="st">dane jednej osoby"</span>, </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/tworzenie-danych-przykladowych-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="dopasowanie-modelu" class="level4" data-number="16.2.10.1">
<h4 data-number="16.2.10.1" class="anchored" data-anchor-id="dopasowanie-modelu"><span class="header-section-number">16.2.10.1</span> Dopasowanie Modelu</h4>
<p>Teraz dopasujmy model regresji liniowej do tych danych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie prostego modelu regresji</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>model_edu_dochod <span class="ot">&lt;-</span> <span class="fu">lm</span>(dochod <span class="sc">~</span> edukacja, <span class="at">data =</span> edukacja_dochod)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie wyników</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>podsumowanie_modelu <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_edu_dochod)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>podsumowanie_modelu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dochod ~ edukacja, data = edukacja_dochod)

Residuals:
    Min      1Q  Median      3Q     Max 
-427.72 -206.04  -38.12  207.32  460.78 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3095.3      447.6   6.915 6.95e-05 ***
edukacja       247.2       29.2   8.467 1.40e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 306.3 on 9 degrees of freedom
Multiple R-squared:  0.8885,    Adjusted R-squared:  0.8761 
F-statistic: 71.69 on 1 and 9 DF,  p-value: 1.403e-05</code></pre>
</div>
</div>
</section>
<section id="zrozumienie-wyników-regresji-krok-po-kroku" class="level4" data-number="16.2.10.2">
<h4 data-number="16.2.10.2" class="anchored" data-anchor-id="zrozumienie-wyników-regresji-krok-po-kroku"><span class="header-section-number">16.2.10.2</span> Zrozumienie Wyników Regresji Krok po Kroku</h4>
<p>Przeanalizujmy, co oznacza każda część tego wyniku w prostych słowach:</p>
<section id="formuła" class="level5" data-number="16.2.10.2.1">
<h5 data-number="16.2.10.2.1" class="anchored" data-anchor-id="formuła"><span class="header-section-number">16.2.10.2.1</span> 1. Formuła</h5>
<p>Na górze widać <code>dochod ~ edukacja</code>, co oznacza, że przewidujemy dochód na podstawie edukacji.</p>
</section>
<section id="reszty" class="level5" data-number="16.2.10.2.2">
<h5 data-number="16.2.10.2.2" class="anchored" data-anchor-id="reszty"><span class="header-section-number">16.2.10.2.2</span> 2. Reszty</h5>
<p>Pokazują, jak daleko nasze przewidywania są od rzeczywistych wartości. Idealnie powinny być skupione wokół zera.</p>
</section>
<section id="tabela-współczynników" class="level5" data-number="16.2.10.2.3">
<h5 data-number="16.2.10.2.3" class="anchored" data-anchor-id="tabela-współczynników"><span class="header-section-number">16.2.10.2.3</span> 3. Tabela Współczynników</h5>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Oszacowania współczynników</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Wartość</th>
<th style="text-align: right;">Błąd standardowy</th>
<th style="text-align: right;">Wartość t</th>
<th style="text-align: right;">Wartość p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">3095.27</td>
<td style="text-align: right;">447.63</td>
<td style="text-align: right;">6.91</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">edukacja</td>
<td style="text-align: right;">247.23</td>
<td style="text-align: right;">29.20</td>
<td style="text-align: right;">8.47</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Wyraz wolny</strong> (<span class="math inline">\beta_0</span>):</p>
<ul>
<li><p>Wartość: Około 3095</p></li>
<li><p>Interpretacja: To przewidywany miesięczny dochód dla kogoś z 0 latami edukacji</p></li>
<li><p>Uwaga: Czasami wyraz wolny nie ma sensownej interpretacji w rzeczywistym świecie, szczególnie jeśli x=0 jest poza zakresem danych</p></li>
</ul>
<p><strong>Edukacja</strong> (<span class="math inline">\beta_1</span>):</p>
<ul>
<li><p>Wartość: Około 247</p></li>
<li><p>Interpretacja: Za każdy dodatkowy rok edukacji spodziewamy się, że miesięczny dochód wzrośnie o tę kwotę w PLN</p></li>
<li><p>To nasz główny współczynnik zainteresowania!</p></li>
</ul>
<p><strong>Błąd standardowy</strong> (Standard Error):</p>
<ul>
<li><p>Mierzy precyzję naszych oszacowań</p></li>
<li><p>Mniejsze błędy standardowe oznaczają bardziej precyzyjne oszacowania</p></li>
<li><p>Można o tym myśleć jako o “plus minus ile” dla naszych współczynników</p></li>
</ul>
<p><strong>Wartość t</strong> (t value):</p>
<ul>
<li><p>To współczynnik podzielony przez jego błąd standardowy</p></li>
<li><p>Mówi nam, o ile błędów standardowych nasz współczynnik jest oddalony od zera</p></li>
<li><p>Większe bezwzględne wartości t (powyżej 2) sugerują, że efekt jest statystycznie istotny</p></li>
</ul>
<p><strong>Wartość p</strong> (p-value):</p>
<ul>
<li><p>Prawdopodobieństwo zaobserwowania naszego wyniku (lub czegoś bardziej ekstremalnego), jeśli w rzeczywistości nie byłoby zależności</p></li>
<li><p>Zazwyczaj p &lt; 0,05 jest uważane za statystycznie istotne</p></li>
<li><p>Dla edukacji, p = 1.4e-05, co jest istotne!</p></li>
</ul>
</section>
<section id="statystyki-dopasowania-modelu" class="level5" data-number="16.2.10.2.4">
<h5 data-number="16.2.10.2.4" class="anchored" data-anchor-id="statystyki-dopasowania-modelu"><span class="header-section-number">16.2.10.2.4</span> 4. Statystyki Dopasowania Modelu</h5>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Statystyki dopasowania modelu</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Statystyka</th>
<th style="text-align: right;">Wartość</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R-kwadrat</td>
<td style="text-align: right;">0.888</td>
</tr>
<tr class="even">
<td style="text-align: left;">Skorygowany R-kwadrat</td>
<td style="text-align: right;">0.876</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Statystyka F</td>
<td style="text-align: right;">71.686</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wartość p</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>R-kwadrat</strong> (R-squared):</p>
<ul>
<li><p>Wartość: 0.888</p></li>
<li><p>Interpretacja: 89% zmienności dochodu jest wyjaśnione przez edukację</p></li>
<li><p>Wyższy jest lepszy, ale należy zachować ostrożność w przypadku bardzo wysokich wartości (może wskazywać na przeuczenie)</p></li>
</ul>
<p><strong>Statystyka F</strong> (F-statistic):</p>
<ul>
<li><p>Testuje, czy model jako całość jest statystycznie istotny</p></li>
<li><p>Wysoka statystyka F z niską wartością p wskazuje na istotny model</p></li>
</ul>
</section>
</section>
<section id="wizualizacja-wyników-modelu" class="level4" data-number="16.2.10.3">
<h4 data-number="16.2.10.3" class="anchored" data-anchor-id="wizualizacja-wyników-modelu"><span class="header-section-number">16.2.10.3</span> Wizualizacja Wyników Modelu</h4>
<p>Zwizualizujmy, co nasz model faktycznie nam mówi:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przewidywane wartości</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>edukacja_dochod<span class="sc">$</span>przewidywane <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_edu_dochod)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>edukacja_dochod<span class="sc">$</span>reszty <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_edu_dochod)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie bardziej informatywnego wykresu</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(edukacja_dochod, <span class="fu">aes</span>(<span class="at">x =</span> edukacja, <span class="at">y =</span> dochod)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rzeczywiste punkty danych</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia regresji</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> przewidywane), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linie reszt</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> edukacja, <span class="at">yend =</span> przewidywane), </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"darkgray"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ustawienie odpowiednich skal</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">8500</span>), </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">5000</span>, <span class="dv">8500</span>, <span class="at">by =</span> <span class="dv">500</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adnotacje</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">19</span>, <span class="at">y =</span> <span class="dv">7850</span>, </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Nachylenie ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model_edu_dochod)[<span class="dv">2</span>]), <span class="st">"PLN za rok"</span>),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">10.5</span>, <span class="at">y =</span> <span class="dv">5500</span>, </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Wyraz wolny ="</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model_edu_dochod)[<span class="dv">1</span>]), <span class="st">"PLN"</span>),</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">14</span>, <span class="at">y =</span> <span class="dv">8200</span>, </span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"R² ="</span>, <span class="fu">round</span>(podsumowanie_modelu<span class="sc">$</span>r.squared, <span class="dv">2</span>)),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Etykiety</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Interpretacja Modelu Regresji Edukacja-Dochód"</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Czerwona linia pokazuje przewidywany dochód dla każdego poziomu edukacji"</span>,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lata edukacji"</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Miesięczny dochód (PLN)"</span>,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Szare przerywane linie reprezentują reszty (błędy przewidywania)"</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/wizualizacja-modelu-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretacja-w-kontekście-rzeczywistym" class="level4" data-number="16.2.10.4">
<h4 data-number="16.2.10.4" class="anchored" data-anchor-id="interpretacja-w-kontekście-rzeczywistym"><span class="header-section-number">16.2.10.4</span> Interpretacja w Kontekście Rzeczywistym</h4>
<ul>
<li><p>Osoba z 16 latami edukacji (absolwent studiów) według naszego modelu zarabiałaby około: <span class="math inline">\hat{Y} = 3095 + 247 \times 16 = 7051 \text{ PLN miesięcznie}</span></p></li>
<li><p>Model sugeruje, że każdy dodatkowy rok edukacji wiąże się ze wzrostem miesięcznego dochodu o 247 PLN.</p></li>
<li><p>Nasz model wyjaśnia około 89% zmienności dochodu w naszej próbie.</p></li>
<li><p>Zależność jest statystycznie istotna (p &lt; 0,001), co oznacza, że bardzo mało prawdopodobne jest zaobserwowanie takiej zależności, jeśli edukacja naprawdę nie miałaby wpływu na dochód.</p></li>
</ul>
</section>
<section id="ważne-przestrogi-dla-początkujących" class="level4" data-number="16.2.10.5">
<h4 data-number="16.2.10.5" class="anchored" data-anchor-id="ważne-przestrogi-dla-początkujących"><span class="header-section-number">16.2.10.5</span> Ważne Przestrogi dla Początkujących</h4>
<ol type="1">
<li><p><strong>Korelacja ≠ Przyczynowość</strong> (Correlation ≠ Causation): Nasz model pokazuje związek, niekoniecznie przyczynowość</p></li>
<li><p><strong>Pominięte Zmienne</strong> (Omitted Variables): Inne czynniki mogą wpływać zarówno na edukację, jak i dochód</p></li>
<li><p><strong>Ekstrapolacja</strong> (Extrapolation): Należy zachować ostrożność przy przewidywaniu poza zakresem danych</p></li>
<li><p><strong>Zależność Liniowa</strong> (Linear Relationship): Założyliśmy, że zależność jest liniowa, co nie zawsze musi być prawdą</p></li>
</ol>
</section>
<section id="następne-kroki-w-analizie" class="level4" data-number="16.2.10.6">
<h4 data-number="16.2.10.6" class="anchored" data-anchor-id="następne-kroki-w-analizie"><span class="header-section-number">16.2.10.6</span> Następne Kroki w Analizie</h4>
<ul>
<li><p>Sprawdzenie założeń modelu (liniowość, normalność reszt itp.)</p></li>
<li><p>Rozważenie dodania większej liczby zmiennych (regresja wieloraka)</p></li>
<li><p>Wypróbowanie transformacji, jeśli zależności nie są liniowe</p></li>
<li><p>Zbadanie efektów interakcji</p></li>
</ul>
</section>
</section>
</section>
<section id="korelacja-pozorna-przyczyny-i-przykłady" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="korelacja-pozorna-przyczyny-i-przykłady"><span class="header-section-number">16.3</span> Korelacja pozorna: Przyczyny i przykłady</h2>
<p>Korelacja pozorna (ang. <em>spurious correlation</em>) występuje, gdy zmienne wydają się być powiązane, ale związek ten nie ma charakteru przyczynowego. Te mylące korelacje wynikają z kilku źródeł:</p>
<ul>
<li>Przypadkowa zbieżność (przypadek)</li>
<li>Zmienne zakłócające (ukryte czynniki trzecie)</li>
<li>Błędy selekcji</li>
<li>Niewłaściwa analiza statystyczna</li>
<li>Odwrócona przyczynowość</li>
<li>Problemy endogeniczności (w tym symultaniczność)</li>
</ul>
<section id="przypadkowa-zbieżność-przypadek" class="level3" data-number="16.3.1">
<h3 data-number="16.3.1" class="anchored" data-anchor-id="przypadkowa-zbieżność-przypadek"><span class="header-section-number">16.3.1</span> Przypadkowa Zbieżność (Przypadek)</h3>
<p>Przy wystarczającej ilości analizowanych danych lub małych próbach badawczych, pozornie znaczące korelacje mogą pojawić się wyłącznie przez przypadek. Jest to szczególnie problematyczne, gdy badacze przeprowadzają wielokrotne analizy bez odpowiednich korekt dla wielokrotnych porównań, praktyka znana jako “p-hacking”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie realistycznego przykładu pozornej korelacji opartej na rzeczywistych danych krajowych</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykorzystanie danych o spożyciu czekolady i laureatach Nagrody Nobla</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykład inspirowany opublikowaną korelacją (Messerli, 2012)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>kraje <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Szwajcaria"</span>, <span class="st">"Szwecja"</span>, <span class="st">"Dania"</span>, <span class="st">"Belgia"</span>, <span class="st">"Austria"</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Norwegia"</span>, <span class="st">"Niemcy"</span>, <span class="st">"Holandia"</span>, <span class="st">"Wielka Brytania"</span>, <span class="st">"Finlandia"</span>, </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Francja"</span>, <span class="st">"Włochy"</span>, <span class="st">"Hiszpania"</span>, <span class="st">"Polska"</span>, <span class="st">"Grecja"</span>, <span class="st">"Portugalia"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie realistycznych danych: Spożycie czekolady koreluje z PKB per capita</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Kraje o wyższym PKB zazwyczaj konsumują więcej czekolady i mają lepsze finansowanie badań</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>pkb_per_capita <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">87097</span>, <span class="dv">58977</span>, <span class="dv">67218</span>, <span class="dv">51096</span>, <span class="dv">53879</span>, <span class="dv">89154</span>, <span class="dv">51860</span>, <span class="dv">57534</span>, </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">46510</span>, <span class="dv">53982</span>, <span class="dv">43659</span>, <span class="dv">35551</span>, <span class="dv">30416</span>, <span class="dv">17841</span>, <span class="dv">20192</span>, <span class="dv">24567</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalizacja wartości PKB, aby były łatwiejsze w zarządzaniu</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>pkb_znormalizowane <span class="ot">&lt;-</span> (pkb_per_capita <span class="sc">-</span> <span class="fu">min</span>(pkb_per_capita)) <span class="sc">/</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>                     (<span class="fu">max</span>(pkb_per_capita) <span class="sc">-</span> <span class="fu">min</span>(pkb_per_capita))</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Bardziej realistyczne spożycie czekolady - luźno oparte na rzeczywistych wzorcach konsumpcji</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plus pewna losowość, ale pod wpływem PKB</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>spozycie_czekolady <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">+</span> <span class="dv">8</span> <span class="sc">*</span> pkb_znormalizowane <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="fl">0.8</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Nagrody Nobla - również pod wpływem PKB (finansowanie badań) z szumem</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Relacja jest nieliniowa, ale pokaże się jako skorelowana</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>nagrody_nobla <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">12</span> <span class="sc">*</span> pkb_znormalizowane<span class="sc">^</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>dane_krajowe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">kraj =</span> kraje,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">czekolada =</span> <span class="fu">round</span>(spozycie_czekolady, <span class="dv">1</span>),</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">nobel =</span> <span class="fu">round</span>(nagrody_nobla, <span class="dv">1</span>),</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">pkb =</span> pkb_per_capita</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu regresji - czekolada vs nobel bez kontrolowania PKB</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>model_czekolada_nobel <span class="ot">&lt;-</span> <span class="fu">lm</span>(nobel <span class="sc">~</span> czekolada, <span class="at">data =</span> dane_krajowe)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Lepszy model, który ujawnia zmienną zakłócającą</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>pelny_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(nobel <span class="sc">~</span> czekolada <span class="sc">+</span> pkb, <span class="at">data =</span> dane_krajowe)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres pozornej relacji</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane_krajowe, <span class="fu">aes</span>(<span class="at">x =</span> czekolada, <span class="at">y =</span> nobel)) <span class="sc">+</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> kraj), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Pozorna Korelacja: Spożycie Czekolady vs. Nagrody Nobla"</span>,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Pokazuje jak zmienne zakłócające tworzą pozorne korelacje"</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Spożycie Czekolady (kg na osobę)"</span>,</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Nagrody Nobla na 10 mln Mieszkańców"</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/random_correlation-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie wyników regresji</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_czekolada_nobel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = nobel ~ czekolada, data = dane_krajowe)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9080 -1.4228  0.0294  0.5962  3.2977 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -4.0518     1.3633  -2.972   0.0101 *  
czekolada     1.3322     0.1682   7.921 1.54e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.626 on 14 degrees of freedom
Multiple R-squared:  0.8176,    Adjusted R-squared:  0.8045 
F-statistic: 62.75 on 1 and 14 DF,  p-value: 1.536e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstracja problemu wielokrotnego testowania</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>wartosci_p <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generowanie dwóch całkowicie losowych zmiennych z n=20</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Test korelacji i przechowywanie wartości p</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  wartosci_p[i] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)<span class="sc">$</span>p.value</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ile "istotnych" wyników przy alfa = 0.05?</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(wartosci_p <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja zjawiska wielokrotnego testowania</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wartosci_p, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Wartości p ze 100 testów losowych danych"</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość p"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"white"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.15</span>, <span class="dv">20</span>, <span class="fu">paste</span>(<span class="st">"Około"</span>, <span class="fu">sum</span>(wartosci_p <span class="sc">&lt;</span> <span class="fl">0.05</span>),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"testów jest 'istotnych'</span><span class="sc">\n</span><span class="st">wyłącznie przez przypadek!"</span>), </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"darkred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/random_correlation-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ten przykład pokazuje, jak pozornie przekonujące korelacje mogą pojawić się między niezwiązanymi zmiennymi z powodu czynników zakłócających i przypadku. Korelacja między spożyciem czekolady a liczbą Nagród Nobla wydaje się istotna statystycznie (p &lt; 0.05) przy bezpośredniej analizie, mimo że jest wyjaśniana przez trzecią zmienną - bogactwo narodowe (PKB per capita).</p>
<p>Bogatsze kraje zazwyczaj konsumują więcej czekolady i jednocześnie więcej inwestują w edukację i badania, co prowadzi do większej liczby Nagród Nobla. Bez kontrolowania tego czynnika zakłócającego, błędnie wnioskowalibyśmy o bezpośrednim związku między czekoladą a Nagrodami Nobla.</p>
<p>Demonstracja wielokrotnego testowania dodatkowo ilustruje, dlaczego pozorne korelacje pojawiają się tak często w badaniach. Przeprowadzając 100 testów statystycznych na całkowicie losowych danych, oczekujemy około 5 “istotnych” wyników przy α = 0.05 wyłącznie przez przypadek. W rzeczywistych warunkach badawczych, gdzie analizowane są setki zmiennych, prawdopodobieństwo znalezienia fałszywie pozytywnych korelacji dramatycznie wzrasta.</p>
<p>Ten przykład podkreśla trzy kluczowe punkty:</p>
<ol type="1">
<li>Małe próby (16 krajów) są szczególnie podatne na przypadkowe korelacje</li>
<li>Zmienne zakłócające mogą tworzyć silne pozorne związki między niezwiązanymi czynnikami</li>
<li>Wielokrotne testowanie bez odpowiednich korekt praktycznie gwarantuje znalezienie “istotnych”, ale pozbawionych znaczenia wzorców</li>
</ol>
<p>Takie odkrycia wyjaśniają, dlaczego replikacja jest niezbędna w badaniach naukowych i dlaczego większość początkowych “odkryć” nie utrzymuje się w kolejnych badaniach.</p>
</section>
<section id="zmienne-zakłócające-ukryte-czynniki-trzecie" class="level3" data-number="16.3.2">
<h3 data-number="16.3.2" class="anchored" data-anchor-id="zmienne-zakłócające-ukryte-czynniki-trzecie"><span class="header-section-number">16.3.2</span> Zmienne zakłócające (ukryte czynniki trzecie)</h3>
<p>Zjawisko konfundowania (ang. <em>confounding</em>) występuje, gdy zewnętrzna zmienna wpływa zarówno na zmienną niezależną, jak i zależną, tworząc pozorną relację, która może zniknąć po uwzględnieniu zmiennej zakłócającej.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ability <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">100</span>, <span class="dv">15</span>)                       <span class="co"># Natural ability </span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> ability <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># Education affected by ability</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="sc">+</span> <span class="dv">2000</span> <span class="sc">*</span> education <span class="sc">+</span> <span class="dv">100</span> <span class="sc">*</span> ability <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5000</span>)  <span class="co"># Income affected by both</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>omitted_var_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ability =</span> ability,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">education =</span> education,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> income</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Model without accounting for ability</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education, <span class="at">data =</span> omitted_var_data)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Model accounting for ability</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(income <span class="sc">~</span> education <span class="sc">+</span> ability, <span class="at">data =</span> omitted_var_data)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_naive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = income ~ education, data = omitted_var_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-14422.9  -3362.1    142.7   3647.7  14229.6 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  18982.0     2410.5   7.875 2.21e-13 ***
education     2050.9      158.7  12.926  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5066 on 198 degrees of freedom
Multiple R-squared:  0.4576,    Adjusted R-squared:  0.4549 
F-statistic: 167.1 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = income ~ education + ability, data = omitted_var_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-12739.9  -3388.7    -41.1   3572.1  14976.8 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 13203.84    3018.85   4.374 1.98e-05 ***
education    1871.43     166.03  11.272  &lt; 2e-16 ***
ability        85.60      27.87   3.071  0.00243 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4961 on 197 degrees of freedom
Multiple R-squared:  0.4824,    Adjusted R-squared:  0.4772 
F-statistic: 91.81 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization with ability shown through color</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(omitted_var_data, <span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">y =</span> income, <span class="at">color =</span> ability)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Zdolności"</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Dochód a wykształcenie, z uwzględnieniem zdolności"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Wizualizacja zmiennej zakłócającej"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lata edukacji"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Roczny dochód (PLN)"</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/confounding_vis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ten przykład ilustruje błąd pominiętej zmiennej (ang. <em>omitted variable bias</em>): bez uwzględnienia zdolności, szacowany wpływ edukacji na dochód jest zawyżony (2 423 PLN rocznie vs.&nbsp;1 962 PLN rocznie). Konfundowanie występuje, ponieważ zdolności wpływają zarówno na edukację, jak i dochód, tworząc pozorny komponent w obserwowanej korelacji.</p>
<section id="klasyczny-przykład-sprzedaż-lodów-a-utonięcia" class="level4" data-number="16.3.2.1">
<h4 data-number="16.3.2.1" class="anchored" data-anchor-id="klasyczny-przykład-sprzedaż-lodów-a-utonięcia"><span class="header-section-number">16.3.2.1</span> Klasyczny przykład: Sprzedaż lodów a utonięcia</h4>
<p>Klasyczny przykład konfundowania dotyczy korelacji między sprzedażą lodów a przypadkami utonięć, na które wpływa temperatura:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">5</span>, <span class="dv">35</span>)  <span class="co"># Temperature in Celsius</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Both ice cream sales and drownings are influenced by temperature</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>ice_cream_sales <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">20</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>drownings <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>confounding_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">temperature =</span> temperature,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ice_cream_sales =</span> ice_cream_sales,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">drownings =</span> drownings</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Model without controlling for temperature</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>model_naive <span class="ot">&lt;-</span> <span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream_sales, <span class="at">data =</span> confounding_data)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Model controlling for temperature</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>model_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream_sales <span class="sc">+</span> temperature, <span class="at">data =</span> confounding_data)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_naive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = drownings ~ ice_cream_sales, data = confounding_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.8163 -0.7597  0.0118  0.7846  2.5797 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -1.503063   0.370590  -4.056    1e-04 ***
ice_cream_sales  0.028074   0.001205  23.305   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.088 on 98 degrees of freedom
Multiple R-squared:  0.8471,    Adjusted R-squared:  0.8456 
F-statistic: 543.1 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = drownings ~ ice_cream_sales + temperature, data = confounding_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.85074 -0.61169  0.01186  0.60556  2.01776 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      1.243785   0.530123   2.346    0.021 *  
ice_cream_sales -0.002262   0.004839  -0.467    0.641    
temperature      0.317442   0.049515   6.411 5.24e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9169 on 97 degrees of freedom
Multiple R-squared:  0.8926,    Adjusted R-squared:  0.8904 
F-statistic: 403.2 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(confounding_data, <span class="fu">aes</span>(<span class="at">x =</span> ice_cream_sales, <span class="at">y =</span> drownings, <span class="at">color =</span> temperature)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">name =</span> <span class="st">"Temperatura (°C)"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Korelacja: Sprzedaż lodów a utonięcia"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Temperatura jako zmienna zakłócająca"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sprzedaż lodów"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Liczba utonięć"</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/ice_cream_drownings-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Naiwny model pokazuje statystycznie istotną zależność między sprzedażą lodów a utonięciami. Jednak po uwzględnieniu temperatury, współczynnik dla sprzedaży lodów zmniejsza się znacznie i staje się statystycznie nieistotny. Pokazuje to, jak brak uwzględnienia zmiennych zakłócających może prowadzić do korelacji pozornych.</p>
</section>
</section>
<section id="odwrócona-przyczynowość" class="level3" data-number="16.3.3">
<h3 data-number="16.3.3" class="anchored" data-anchor-id="odwrócona-przyczynowość"><span class="header-section-number">16.3.3</span> Odwrócona przyczynowość</h3>
<p>Odwrócona przyczynowość (ang. <em>reverse causality</em>) występuje, gdy zakładany kierunek przyczynowości jest nieprawidłowy. Rozważmy przykład lęku i technik relaksacyjnych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>anxiety_level <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">10</span>)  <span class="co"># Anxiety level (1-10)</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># People with higher anxiety tend to use more relaxation techniques</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>relaxation_techniques <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.7</span> <span class="sc">*</span> anxiety_level <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>reverse_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">anxiety =</span> anxiety_level,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">relaxation =</span> relaxation_techniques</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models in both directions</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>model_incorrect <span class="ot">&lt;-</span> <span class="fu">lm</span>(anxiety <span class="sc">~</span> relaxation, <span class="at">data =</span> reverse_data)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>model_correct <span class="ot">&lt;-</span> <span class="fu">lm</span>(relaxation <span class="sc">~</span> anxiety, <span class="at">data =</span> reverse_data)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Show regression results</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_incorrect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = anxiety ~ relaxation, data = reverse_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9651 -0.7285 -0.0923  0.7247  3.7996 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.09482    0.21973  -0.432    0.667    
relaxation   1.15419    0.04105  28.114   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.182 on 198 degrees of freedom
Multiple R-squared:  0.7997,    Adjusted R-squared:  0.7987 
F-statistic: 790.4 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_correct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = relaxation ~ anxiety, data = reverse_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-3.15178 -0.51571 -0.00222  0.55513  2.04334 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.05726    0.15286   6.917 6.24e-11 ***
anxiety      0.69284    0.02464  28.114  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9161 on 198 degrees of freedom
Multiple R-squared:  0.7997,    Adjusted R-squared:  0.7987 
F-statistic: 790.4 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reverse_data, <span class="fu">aes</span>(<span class="at">x =</span> relaxation, <span class="at">y =</span> anxiety)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Poziom lęku a techniki relaksacyjne"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Przykład odwróconej przyczynowości"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Korzystanie z technik relaksacyjnych (częstotliwość/tydzień)"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Poziom lęku (skala 1-10)"</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/reverse_causality-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Oba modele regresji pokazują statystycznie istotne zależności, ale sugerują różne mechanizmy przyczynowe. Nieprawidłowy model sugeruje, że techniki relaksacyjne zwiększają lęk, podczas gdy prawidłowy model odzwierciedla rzeczywisty proces generowania danych: to lęk skłania do korzystania z technik relaksacyjnych.</p>
</section>
<section id="błąd-kolidera-błąd-selekcji" class="level3" data-number="16.3.4">
<h3 data-number="16.3.4" class="anchored" data-anchor-id="błąd-kolidera-błąd-selekcji"><span class="header-section-number">16.3.4</span> Błąd kolidera (błąd selekcji)</h3>
<p>Błąd kolidera (ang. <em>collider bias</em>) występuje, gdy warunkujemy na zmiennej, na którą wpływają zarówno zmienna niezależna, jak i zależna, tworząc sztuczną relację między zmiennymi, które w rzeczywistości są niezależne.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate two independent variables (no relationship between them)</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>intelligence <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">100</span>, <span class="dv">15</span>)  <span class="co"># IQ score</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>family_wealth <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">15</span>)  <span class="co"># Wealth score (independent from intelligence)</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># True data-generating process: admission depends on both intelligence and wealth</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>admission_score <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="sc">*</span> intelligence <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> family_wealth <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>admitted <span class="ot">&lt;-</span> admission_score <span class="sc">&gt;</span> <span class="fu">median</span>(admission_score)  <span class="co"># Binary admission variable</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create full dataset</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>full_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">intelligence =</span> intelligence,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">wealth =</span> family_wealth,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">admission_score =</span> admission_score,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">admitted =</span> admitted</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression in full population (true model)</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(intelligence <span class="sc">~</span> wealth, <span class="at">data =</span> full_data)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(full_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = intelligence ~ wealth, data = full_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-49.608 -10.115   0.119  10.832  55.581 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 101.42330    1.73139   58.58   &lt;2e-16 ***
wealth       -0.02701    0.03334   -0.81    0.418    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.41 on 998 degrees of freedom
Multiple R-squared:  0.0006569, Adjusted R-squared:  -0.0003444 
F-statistic: 0.656 on 1 and 998 DF,  p-value: 0.4182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get just the admitted students</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>admitted_only <span class="ot">&lt;-</span> full_data[full_data<span class="sc">$</span>admitted, ]</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression in admitted students (conditioning on the collider)</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>admitted_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(intelligence <span class="sc">~</span> wealth, <span class="at">data =</span> admitted_only)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(admitted_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = intelligence ~ wealth, data = admitted_only)

Residuals:
    Min      1Q  Median      3Q     Max 
-38.511  -9.064   0.721   8.965  48.267 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 115.4750     2.6165  44.133  &lt; 2e-16 ***
wealth       -0.1704     0.0462  -3.689  0.00025 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.91 on 498 degrees of freedom
Multiple R-squared:  0.0266,    Adjusted R-squared:  0.02464 
F-statistic: 13.61 on 1 and 498 DF,  p-value: 0.0002501</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional analysis - regression with the collider as a control variable</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This demonstrates how controlling for a collider introduces bias</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>collider_control_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(intelligence <span class="sc">~</span> wealth <span class="sc">+</span> admitted, <span class="at">data =</span> full_data)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(collider_control_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = intelligence ~ wealth + admitted, data = full_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.729  -8.871   0.700   8.974  48.044 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  102.90069    1.56858  65.601  &lt; 2e-16 ***
wealth        -0.19813    0.03224  -6.145 1.16e-09 ***
admittedTRUE  14.09944    0.94256  14.959  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.93 on 997 degrees of freedom
Multiple R-squared:  0.1838,    Adjusted R-squared:  0.1822 
F-statistic: 112.3 on 2 and 997 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for full population</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(full_data, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> intelligence)) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Pełna populacja"</span>,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Korelacja:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(full_data<span class="sc">$</span>intelligence, full_data<span class="sc">$</span>wealth), <span class="dv">3</span>)),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Zamożność rodziny"</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Inteligencja"</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for admitted students</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(admitted_only, <span class="fu">aes</span>(<span class="at">x =</span> wealth, <span class="at">y =</span> intelligence)) <span class="sc">+</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Tylko przyjęci studenci"</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Korelacja:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(admitted_only<span class="sc">$</span>intelligence, admitted_only<span class="sc">$</span>wealth), <span class="dv">3</span>)),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Zamożność rodziny"</span>,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Inteligencja"</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plots side by side</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/collider_visualization-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ten przykład pokazuje błąd kolidera na trzy sposoby:</p>
<ol type="1">
<li>W pełnej populacji, inteligencja i zamożność nie mają związku (współczynnik bliski zeru, p-wartość = 0,87)</li>
<li>Wśród przyjętych studentów (warunkowanie na koliderze), pojawia się istotna negatywna zależność (współczynnik = -0,39, p-wartość &lt; 0,001)</li>
<li>Gdy kontrolujemy status przyjęcia w regresji, wprowadzamy pozorną zależność (współczynnik = -0,16, p-wartość &lt; 0,001)</li>
</ol>
<p>Błąd kolidera tworzy relacje między zmiennymi, które są naprawdę niezależne. Można to przedstawić za pomocą grafu skierowanego (DAG):</p>
<p><span class="math display">\text{Inteligencja} \rightarrow \text{Przyjęcie} \leftarrow \text{Zamożność}</span></p>
<p>Gdy warunkujemy na przyjęciu (koliderze), tworzymy pozorny związek między inteligencją a zamożnością.</p>
</section>
<section id="niewłaściwa-analiza" class="level3" data-number="16.3.5">
<h3 data-number="16.3.5" class="anchored" data-anchor-id="niewłaściwa-analiza"><span class="header-section-number">16.3.5</span> Niewłaściwa analiza</h3>
<p>Nieodpowiednie metody statystyczne mogą prowadzić do korelacji pozornych. Typowe problemy obejmują stosowanie modeli liniowych do relacji nieliniowych, ignorowanie grupowania danych czy niewłaściwe postępowanie z szeregami czasowymi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with a true non-linear relationship</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> n)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># Quadratic relationship</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>improper_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit incorrect linear model</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>wrong_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> improper_data)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit correct quadratic model</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>correct_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> improper_data)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wrong_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = improper_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.2176 -2.1477 -0.6468  2.4365  7.3457 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.14689    0.28951  10.870   &lt;2e-16 ***
x            0.08123    0.16548   0.491    0.625    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.895 on 98 degrees of freedom
Multiple R-squared:  0.002453,  Adjusted R-squared:  -0.007726 
F-statistic: 0.2409 on 1 and 98 DF,  p-value: 0.6246</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(correct_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x + I(x^2), data = improper_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.81022 -0.65587  0.01935  0.61168  2.68894 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.12407    0.14498   0.856    0.394    
x            0.08123    0.05524   1.470    0.145    
I(x^2)       0.98766    0.03531  27.972   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9664 on 97 degrees of freedom
Multiple R-squared:   0.89, Adjusted R-squared:  0.8877 
F-statistic: 392.3 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(improper_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Przykład niewłaściwej analizy"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model liniowy (czerwony) vs. Model kwadratowy (zielony)"</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Zmienna X"</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Zmienna Y"</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/improper_analysis-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Model liniowy błędnie sugeruje brak związku między x a y (współczynnik bliski zeru, p-wartość = 0,847), podczas gdy model kwadratowy ujawnia prawdziwą zależność (<span class="math inline">R^2 = 0,90</span>). Pokazuje to, jak błędna specyfikacja modelu może tworzyć pozorne braki korelacji, maskując rzeczywiste relacje, które istnieją w innych formach.</p>
</section>
<section id="endogeniczność-i-jej-źródła" class="level3" data-number="16.3.6">
<h3 data-number="16.3.6" class="anchored" data-anchor-id="endogeniczność-i-jej-źródła"><span class="header-section-number">16.3.6</span> Endogeniczność i jej źródła</h3>
<p>Endogeniczność (ang. <em>endogeneity</em>) występuje, gdy zmienna objaśniająca jest skorelowana ze składnikiem losowym w modelu regresji. Narusza to założenie egzogeniczności regresji OLS i prowadzi do obciążonych estymatorów. Istnieje kilka źródeł endogeniczności:</p>
<section id="błąd-pominiętej-zmiennej" class="level4" data-number="16.3.6.1">
<h4 data-number="16.3.6.1" class="anchored" data-anchor-id="błąd-pominiętej-zmiennej"><span class="header-section-number">16.3.6.1</span> Błąd pominiętej zmiennej</h4>
<p>Jak pokazano w przykładzie edukacja-dochód, gdy ważne zmienne są pominięte w modelu, ich efekty są absorbowane przez składnik losowy, który staje się skorelowany z uwzględnionymi zmiennymi.</p>
</section>
<section id="błąd-pomiaru" class="level4" data-number="16.3.6.2">
<h4 data-number="16.3.6.2" class="anchored" data-anchor-id="błąd-pomiaru"><span class="header-section-number">16.3.6.2</span> Błąd pomiaru</h4>
<p>Gdy zmienne są mierzone z błędem, obserwowane wartości różnią się od prawdziwych wartości, tworząc korelację między składnikiem losowym a predyktorami.</p>
</section>
<section id="symultaniczność-dwukierunkowa-przyczynowość" class="level4" data-number="16.3.6.3">
<h4 data-number="16.3.6.3" class="anchored" data-anchor-id="symultaniczność-dwukierunkowa-przyczynowość"><span class="header-section-number">16.3.6.3</span> Symultaniczność (dwukierunkowa przyczynowość)</h4>
<p>Występuje, gdy zmienna zależna również wpływa na zmienną niezależną, tworząc pętlę sprzężenia zwrotnego. Zobaczmy to na przykładzie:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data with mutual influence</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize variables</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>economic_growth <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>employment_rate <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">60</span>, <span class="dv">5</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create mutual influence through iterations</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  economic_growth <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> employment_rate <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  employment_rate <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> economic_growth <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>simultaneity_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">growth =</span> economic_growth,</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">employment =</span> employment_rate</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimating effect of growth on employment</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>model_growth_on_emp <span class="ot">&lt;-</span> <span class="fu">lm</span>(employment <span class="sc">~</span> growth, <span class="at">data =</span> simultaneity_data)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimating effect of employment on growth</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>model_emp_on_growth <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> employment, <span class="at">data =</span> simultaneity_data)</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Show results</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_growth_on_emp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = employment ~ growth, data = simultaneity_data)

Residuals:
   Min     1Q Median     3Q    Max 
-3.603 -1.500 -0.099  1.387  5.673 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  49.9665     2.0717   24.12   &lt;2e-16 ***
growth        5.0151     0.3528   14.22   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.045 on 98 degrees of freedom
Multiple R-squared:  0.6734,    Adjusted R-squared:  0.6701 
F-statistic: 202.1 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_emp_on_growth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = growth ~ employment, data = simultaneity_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.11417 -0.20626 -0.02185  0.22646  0.72941 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -4.801257   0.749557  -6.405 5.23e-09 ***
employment   0.134283   0.009446  14.216  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3346 on 98 degrees of freedom
Multiple R-squared:  0.6734,    Adjusted R-squared:  0.6701 
F-statistic: 202.1 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(simultaneity_data, <span class="fu">aes</span>(<span class="at">x =</span> growth, <span class="at">y =</span> employment)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Symultaniczność: Wzrost gospodarczy a zatrudnienie"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wzrost gospodarczy (%)"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Stopa zatrudnienia (%)"</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/simultaneity-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Prawdziwy proces generowania danych to system równań symultanicznych:</p>
<p><span class="math display">\text{Wzrost}_i = \alpha_0 + \alpha_1 \text{Zatrudnienie}_i + u_i</span> <span class="math display">\text{Zatrudnienie}_i = \beta_0 + \beta_1 \text{Wzrost}_i + v_i</span></p>
<p>Standardowa regresja OLS nie może konsekwentnie oszacować żadnego z równań, ponieważ każda zmienna objaśniająca jest skorelowana ze składnikiem losowym w odpowiednim równaniu.</p>
</section>
<section id="błąd-selekcji" class="level4" data-number="16.3.6.4">
<h4 data-number="16.3.6.4" class="anchored" data-anchor-id="błąd-selekcji"><span class="header-section-number">16.3.6.4</span> Błąd selekcji</h4>
<p>Gdy próba nie jest losowo wybrana z populacji, proces selekcji może wprowadzić korelację między składnikiem losowym a predyktorami. Przykład błędu kolidera demonstruje formę błędu selekcji.</p>
<p>Konsekwencje endogeniczności obejmują: - Obciążone estymatory współczynników - Nieprawidłowe błędy standardowe - Nieważne testy hipotez - Mylące interpretacje przyczynowe</p>
<p>Rozwiązanie problemu endogeniczności wymaga specjalistycznych metod, takich jak zmienne instrumentalne, estymacja systemowa, metody danych panelowych lub projekty eksperymentalne.</p>
</section>
</section>
</section>
<section id="metody-przeciwdziałania-korelacjom-pozornym" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="metody-przeciwdziałania-korelacjom-pozornym"><span class="header-section-number">16.4</span> Metody przeciwdziałania korelacjom pozornym</h2>
<p>Kilka podejść może zmniejszyć ryzyko korelacji pozornych:</p>
<ol type="1">
<li><p><strong>Kontrolowanie zmiennych zakłócających</strong>: Uwzględnienie potencjalnych zmiennych zakłócających w modelach regresji</p></li>
<li><p><strong>Eksperymenty randomizowane</strong>: Losowy przydział eliminuje błąd selekcji i wiele efektów konfundowania</p></li>
<li><p><strong>Zmienne instrumentalne</strong>: Zmienne, które wpływają na predyktor, ale nie bezpośrednio na wynik</p></li>
<li><p><strong>Modele efektów stałych</strong>: Kontrolowanie niezmiennych w czasie zmiennych zakłócających w danych panelowych</p></li>
<li><p><strong>Metoda różnicy w różnicach</strong>: Wykorzystanie naturalnych eksperymentów</p></li>
<li><p><strong>Regresja nieciągła</strong>: Wykorzystanie arbitralnych punktów odcięcia do tworzenia quasi-losowego przydziału</p></li>
<li><p><strong>Walidacja krzyżowa</strong>: Testowanie zależności w oddzielnych próbach, aby uniknąć przypadkowych znalezisk</p></li>
<li><p><strong>Wiarygodność teoretyczna</strong>: Ocena, czy zależności mają sens teoretyczny</p></li>
</ol>
</section>
<section id="podsumowanie" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="podsumowanie"><span class="header-section-number">16.5</span> Podsumowanie</h2>
<p>Zrozumienie różnicy między korelacją a przyczynowością jest niezbędne dla prawidłowego wnioskowania statystycznego. Korelacje pozorne mogą wynikać z różnych źródeł:</p>
<ol type="1">
<li>Przypadkowa zbieżność</li>
<li>Zmienne zakłócające (ukryte czynniki trzecie)</li>
<li>Odwrócona przyczynowość</li>
<li>Błędy selekcji (w tym błąd kolidera)</li>
<li>Niewłaściwa analiza statystyczna</li>
<li>Problemy endogeniczności (w tym pominiętej zmiennej, błędu pomiaru, symultaniczności i błędu selekcji)</li>
</ol>
<p>Analiza regresji dostarcza narzędzi do kwantyfikacji zależności i kontrolowania zmiennych zakłócających, ale ustalenie przyczynowości wymaga starannego projektowania badań i odpowiednich metod statystycznych. Interpretując korelacje, badacze powinni systematycznie rozważać alternatywne wyjaśnienia i potencjalne źródła błędów.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/EmIodcqXEAMRW83.jpeg" class="img-fluid figure-img"></p>
<figcaption>https://x.com/EUFIC/status/1324667630238814209?prefetchTimestamp=1732463940216</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4580.png" class="img-fluid figure-img"></p>
<figcaption>https://sitn.hms.harvard.edu/flash/2021/when-correlation-does-not-imply-causation-why-your-gut-microbes-may-not-yet-be-a-silver-bullet-to-all-your-problems/</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Od Kowariancji do Różnych Miar Korelacji
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie różnych typów zależności</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność liniowa</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x1, <span class="at">y=</span>y1, <span class="at">type=</span><span class="st">"Zależność Liniowa"</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność monotoniczna nieliniowa</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">sign</span>(x2)<span class="sc">*</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x2, <span class="at">y=</span>y2, <span class="at">type=</span><span class="st">"Monotoniczna Nieliniowa"</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność niemonotoniczna</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out=</span>n)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> x3<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x3, <span class="at">y=</span>y3, <span class="at">type=</span><span class="st">"Niemonotoniczna"</span>)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Łączenie danych</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data1, data2, data3)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Różne Typy Zależności Między Zmiennymi"</span>,</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna X"</span>,</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Y"</span>) <span class="sc">+</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="pojęcie-korelacji" class="level3" data-number="16.5.1">
<h3 data-number="16.5.1" class="anchored" data-anchor-id="pojęcie-korelacji"><span class="header-section-number">16.5.1</span> Pojęcie Korelacji</h3>
<p>Korelacja to szerokie pojęcie opisujące, jak zmienne są ze sobą powiązane. Jak widać na wykresach, zależności te mogą przybierać różne formy.</p>
</section>
<section id="rozpoczynając-od-kowariancji" class="level3" data-number="16.5.2">
<h3 data-number="16.5.2" class="anchored" data-anchor-id="rozpoczynając-od-kowariancji"><span class="header-section-number">16.5.2</span> Rozpoczynając od Kowariancji</h3>
<p>Kowariancja jest podstawową miarą wspólnej zmienności zmiennych:</p>
<p><span class="math display">Cov(X,Y) = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{n-1}</span></p>
<p>Informuje nas o tym:</p>
<ul>
<li>Czy zmienne zmieniają się w tym samym kierunku (kowariancja dodatnia)</li>
<li>Czy zmieniają się w przeciwnych kierunkach (kowariancja ujemna)</li>
<li>Czy brak wyraźnego wzorca liniowego (kowariancja bliska zeru)</li>
</ul>
<p>Jednak kowariancja ma ograniczenie: jej wartość zależy od jednostek pomiaru. Na przykład:</p>
<ul>
<li>Wzrost w metrach vs waga w kg daje jedną wartość kowariancji</li>
<li>Wzrost w centymetrach vs waga w kg daje inną wartość</li>
<li>Ta sama zależność, różne skale!</li>
</ul>
</section>
<section id="standaryzacja-i-miary-korelacji" class="level3" data-number="16.5.3">
<h3 data-number="16.5.3" class="anchored" data-anchor-id="standaryzacja-i-miary-korelacji"><span class="header-section-number">16.5.3</span> Standaryzacja i Miary Korelacji</h3>
<ol type="1">
<li>Współczynnik korelacji Pearsona standaryzuje kowariancję: <span class="math display">r = \frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}}</span></li>
</ol>
<ul>
<li>Eliminuje zależność od jednostek</li>
<li>Zawsze między -1 a 1</li>
<li>Mierzy zależności liniowe</li>
</ul>
<ol start="2" type="1">
<li>Współczynnik korelacji rangowej Spearmana:</li>
</ol>
<ul>
<li>Bazuje na rangach zamiast surowych wartości</li>
<li>Wychwytuje zależności monotoniczne (także nieliniowe)</li>
<li>Również przyjmuje wartości od -1 do 1</li>
</ul>
</section>
<section id="kluczowe-wnioski" class="level3" data-number="16.5.4">
<h3 data-number="16.5.4" class="anchored" data-anchor-id="kluczowe-wnioski"><span class="header-section-number">16.5.4</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Kowariancja pokazuje wspólną zmienność</li>
<li>Miary korelacji dają standaryzowane wartości</li>
<li>Wybór miary korelacji zależy od:
<ul>
<li>Spodziewanego typu zależności</li>
<li>Charakteru danych</li>
<li>Pytania badawczego</li>
</ul></li>
<li>Zawsze wizualizuj dane</li>
</ol>
</section>
</div>
</div>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Obliczmy kowariancję dla dwóch zmiennych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 2, 4, 5, 4, 5</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz średnie</td>
<td><span class="math inline">\bar{x} = 3, \bar{y} = 4</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz <span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span> dla każdej pary</td>
<td><span class="math inline">(-2)(-2) = 4</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(-1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(0)(1) = 0</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(2)(1) = 2</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Zsumuj wyniki</td>
<td><span class="math inline">4 + 0 + 0 + 0 + 2 = 6</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>Podziel przez (n-1)</td>
<td><span class="math inline">6 / 4 = 1,5</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Dodatnia kowariancja (1,5) wskazuje, że x i y mają tendencję do wzrostu razem.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Dostarcza informacji o kierunku związku (dodatni lub ujemny)</li>
<li>Przydatna w obliczaniu innych miar, takich jak korelacja</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Zależna od skali, co utrudnia porównywanie między różnymi parami zmiennych</li>
<li>Nie dostarcza informacji o sile związku</li>
</ul>
<section id="korelacja-pearsona" class="level3" data-number="16.5.5">
<h3 data-number="16.5.5" class="anchored" data-anchor-id="korelacja-pearsona"><span class="header-section-number">16.5.5</span> Korelacja Pearsona</h3>
<p>Korelacja Pearsona mierzy siłę i kierunek liniowego związku między dwiema zmiennymi ciągłymi.</p>
<p><strong>Wzór:</strong> <span class="math inline">r = \frac{cov(X,Y)}{s_X s_Y} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}</span></p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Używając tych samych danych co wyżej:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz kowariancję</td>
<td>(Z poprzedniego obliczenia) 1,5</td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz odchylenia standardowe</td>
<td><span class="math inline">s_X = \sqrt{\frac{10}{4}} = 1,58, s_Y = \sqrt{\frac{6}{4}} = 1,22</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Podziel kowariancję przez iloczyn odchyleń standardowych</td>
<td><span class="math inline">1,5 / (1,58 * 1,22) = 0,7746</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7745967</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Współczynnik korelacji 0,7746 wskazuje na silny dodatni związek liniowy między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Niezależna od skali, zawsze między -1 a 1</li>
<li>Szeroko rozumiana i stosowana</li>
<li>Testuje związki liniowe</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Wrażliwa na wartości odstające</li>
<li>Mierzy tylko związki liniowe</li>
<li>Zakłada normalnie rozłożone zmienne</li>
</ul>
</section>
<section id="korelacja-spearmana" class="level3" data-number="16.5.6">
<h3 data-number="16.5.6" class="anchored" data-anchor-id="korelacja-spearmana"><span class="header-section-number">16.5.6</span> Korelacja Spearmana</h3>
<p>Korelacja Spearmana mierzy siłę i kierunek monotonicznego związku między dwiema zmiennymi, które mogą być ciągłe lub porządkowe.</p>
<p><strong>Wzór:</strong> <span class="math inline">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}</span>, gdzie <span class="math inline">d_i</span> to różnica między rangami.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rangi: Pozycje w Uporządkowanym Ciągu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rangi to po prostu numery pozycji w uporządkowanym zbiorze danych:</p>
<section id="jak-wyznaczyć-rangi" class="level3" data-number="16.5.7">
<h3 data-number="16.5.7" class="anchored" data-anchor-id="jak-wyznaczyć-rangi"><span class="header-section-number">16.5.7</span> Jak Wyznaczyć Rangi?</h3>
<ol type="1">
<li><p>Porządkujemy dane od najmniejszej do największej wartości</p></li>
<li><p>Przypisujemy kolejne liczby naturalne:</p>
<ul>
<li>Najmniejsza wartość → ranga 1</li>
<li>Kolejne wartości → kolejne rangi</li>
<li>Największa wartość → ranga n (liczba obserwacji)</li>
<li>Dla remisów → średnia rang</li>
</ul></li>
</ol>
</section>
<section id="przykład" class="level3" data-number="16.5.8">
<h3 data-number="16.5.8" class="anchored" data-anchor-id="przykład"><span class="header-section-number">16.5.8</span> Przykład</h3>
<p>Mamy 5 studentów o wzroście:</p>
<pre><code>Wzrost:   165, 182, 170, 168, 175
Rangi:     1,   5,   3,   2,   4</code></pre>
<p>Dla danych z remisami (np. oceny):</p>
<pre><code>Oceny:     2,   3,   3,   4,   5
Rangi:     1,  2.5, 2.5,  4,   5</code></pre>
</section>
</div>
</div>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Użyjmy nieco innych danych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 1, 3, 2, 5, 4</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Przypisz rangi obu zmiennym</td>
<td>x_ranga: 1, 2, 3, 4, 5</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>y_ranga: 1, 3, 2, 5, 4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Oblicz różnice w rangach (d)</td>
<td>0, -1, 1, -1, 1</td>
</tr>
<tr class="even">
<td>3</td>
<td>Podnieś różnice do kwadratu</td>
<td>0, 1, 1, 1, 1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Zsumuj kwadraty różnic</td>
<td><span class="math inline">\sum d_i^2 = 4</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>Zastosuj wzór</td>
<td><span class="math inline">\rho = 1 - \frac{6(4)}{5(5^2 - 1)} = 0,8</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Korelacja Spearmana 0,8 wskazuje na silny dodatni związek monotoniczny między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Odporna na wartości odstające</li>
<li>Może wykrywać nieliniowe związki monotoniczne</li>
<li>Odpowiednia dla danych porządkowych</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Mniej odporna niż korelacja Pearsona do wykrywania związków liniowych w normalnie rozłożonych danych</li>
<li>Nie dostarcza informacji o kształcie związku poza monotonicznością</li>
</ul>
</section>
<section id="tabela-krzyżowa" class="level3" data-number="16.5.9">
<h3 data-number="16.5.9" class="anchored" data-anchor-id="tabela-krzyżowa"><span class="header-section-number">16.5.9</span> Tabela Krzyżowa</h3>
<p>Tabela krzyżowa (tabela kontyngencji) pokazuje związek między dwiema zmiennymi kategorycznymi.</p>
<p><strong>Przykład:</strong></p>
<p>Stwórzmy tabelę krzyżową dla dwóch zmiennych: - Poziom wykształcenia: Średnie, Wyższe, Podyplomowe - Status zatrudnienia: Zatrudniony, Bezrobotny</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>wyksztalcenie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>zatrudnienie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wyksztalcenie, zatrudnienie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             zatrudnienie
wyksztalcenie Bezrobotny Zatrudniony
  Podyplomowe          0           3
  Średnie              2           1
  Wyższe               1           2</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Ta tabela pokazuje liczbę osób w każdej kombinacji poziomu wykształcenia i statusu zatrudnienia.</li>
<li>Na przykład, możemy zobaczyć, ilu absolwentów szkół średnich jest zatrudnionych, a ilu bezrobotnych.</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Zapewnia jasną wizualną reprezentację związku między zmiennymi kategorycznymi</li>
<li>Łatwa do zrozumienia i interpretacji</li>
<li>Podstawa dla wielu testów statystycznych (np. test chi-kwadrat niezależności)</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Ograniczona do danych kategorycznych</li>
<li>Może stać się nieporęczna przy wielu kategoriach</li>
<li>Nie dostarcza pojedynczej statystyki podsumowującej siłę związku</li>
</ul>
</section>
<section id="wybór-odpowiedniej-miary" class="level3" data-number="16.5.10">
<h3 data-number="16.5.10" class="anchored" data-anchor-id="wybór-odpowiedniej-miary"><span class="header-section-number">16.5.10</span> Wybór Odpowiedniej Miary</h3>
<p>Przy wyborze statystyki dwuwymiarowej należy wziąć pod uwagę:</p>
<ol type="1">
<li><p>Typ danych:</p>
<ul>
<li>Dane ciągłe: Kowariancja, korelacja Pearsona</li>
<li>Dane porządkowe: Korelacja Spearmana</li>
<li>Dane kategoryczne: Tabela krzyżowa</li>
</ul></li>
<li><p>Typ związku:</p>
<ul>
<li>Liniowy: Korelacja Pearsona</li>
<li>Monotoniczny, ale potencjalnie nieliniowy: Korelacja Spearmana</li>
</ul></li>
<li><p>Obecność wartości odstających:</p>
<ul>
<li>Jeśli wartości odstające są problemem, korelacja Spearmana jest bardziej odporna</li>
</ul></li>
<li><p>Rozkład:</p>
<ul>
<li>Dla normalnie rozłożonych danych korelacja Pearsona jest najbardziej odporna (robust)</li>
<li>Dla rozkładów “nienormalnych” rozważ korelację Spearmana</li>
</ul></li>
<li><p>Wielkość próby:</p>
<ul>
<li>Dla bardzo małych prób metody nieparametryczne, takie jak korelacja Spearmana, mogą być preferowane</li>
</ul></li>
</ol>
<p>Pamiętaj, że często wartościowe jest użycie wielu miar i wizualizacji (takich jak wykresy rozrzutu), aby uzyskać kompleksowe zrozumienie związku między zmiennymi.</p>
</section>
</section>
<section id="analiza-regresji" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="analiza-regresji"><span class="header-section-number">16.6</span> Analiza Regresji</h2>
<p>Analiza regresji to metoda statystyczna, która bada i modeluje zależności między zmiennymi w celu zrozumienia, jak zmiany w jednej lub kilku zmiennych niezależnych wpływają na zmienną zależną.</p>
<p>W swojej istocie analiza regresji pomaga odpowiedzieć na pytania dotyczące przyczyny i skutku, przewidywania oraz prognozowania. Na przykład, przedsiębiorstwo może wykorzystać analizę regresji do zrozumienia, jak wydatki na reklamę wpływają na sprzedaż lub jak liczba godzin szkoleń pracowników przekłada się na produktywność.</p>
<p>Proces rozpoczyna się od zbierania danych o interesujących nas zmiennych. Następnie analiza dopasowuje model matematyczny - zazwyczaj linię lub krzywą - który najlepiej reprezentuje zależność między tymi zmiennymi. Model ten pozwala:</p>
<ul>
<li>Określić siłę i kierunek zależności między zmiennymi</li>
<li>Dokonywać przewidywań dotyczących przyszłych wyników</li>
<li>Zrozumieć, które czynniki mają największy wpływ na nasze rezultaty</li>
</ul>
<section id="regresja-jako-model-stochastyczny" class="level3" data-number="16.6.1">
<h3 data-number="16.6.1" class="anchored" data-anchor-id="regresja-jako-model-stochastyczny"><span class="header-section-number">16.6.1</span> Regresja jako Model Stochastyczny</h3>
<p>W modelowaniu matematycznym spotykamy dwa podstawowe podejścia do opisywania relacji między zmiennymi:</p>
<ul>
<li>modele deterministyczne,</li>
<li>modele stochastyczne.</li>
</ul>
<section id="modele-deterministyczne-a-stochastyczne" class="level4" data-number="16.6.1.1">
<h4 data-number="16.6.1.1" class="anchored" data-anchor-id="modele-deterministyczne-a-stochastyczne"><span class="header-section-number">16.6.1.1</span> Modele Deterministyczne a Stochastyczne</h4>
<p>Model deterministyczny zakłada precyzyjną, ustaloną relację między danymi wejściowymi a wyjściowymi. W takich modelach, znając dane wejściowe, możemy z całkowitą pewnością obliczyć dokładny wynik. Weźmy pod uwagę klasyczne równanie fizyczne dotyczące drogi:</p>
<p><span class="math display">\text{Droga} = \text{Prędkość} × \text{Czas}</span></p>
<p>Przy określonych wartościach prędkości i czasu, równanie to zawsze da tę samą drogę. Nie ma tu miejsca na jakąkolwiek zmienność wyniku.</p>
<p>W przeciwieństwie do tego, analiza regresji uwzględnia naturalną zmienność danych. Podstawowa struktura modelu regresji to:</p>
<p><span class="math display">Y = f(X) + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y</span> reprezentuje wynik, który chcemy przewidzieć</li>
<li><span class="math inline">f(X)</span> reprezentuje systematyczną relację między naszymi predyktorami (X) a wynikiem</li>
<li><span class="math inline">\epsilon</span> reprezentuje losową zmienność naturalnie występującą w rzeczywistych danych</li>
</ul>
</section>
<section id="natura-modeli-stochastycznych-w-regresji" class="level4" data-number="16.6.1.2">
<h4 data-number="16.6.1.2" class="anchored" data-anchor-id="natura-modeli-stochastycznych-w-regresji"><span class="header-section-number">16.6.1.2</span> Natura Modeli Stochastycznych w Regresji</h4>
<p>Włączenie składnika błędu <span class="math inline">\epsilon</span> uznaje, że rzeczywiste relacje między zmiennymi rzadko są idealne. Na przykład, badając wpływ czasu nauki na wyniki testów, wiele czynników przyczynia się do końcowego rezultatu:</p>
<p>Część systematyczna <span class="math inline">f(X)</span> wychwytuje ogólną tendencję: więcej czasu nauki zazwyczaj prowadzi do wyższych wyników.</p>
<p>Składnik błędu <span class="math inline">\epsilon</span> uwzględnia wszystkie inne czynniki:</p>
<ul>
<li>Różne style uczenia się</li>
<li>Środowisko nauki</li>
<li>Stan fizyczny i psychiczny podczas testu</li>
<li>Jakość materiałów dydaktycznych</li>
</ul>
</section>
<section id="struktura-matematyczna" class="level4" data-number="16.6.1.3">
<h4 data-number="16.6.1.3" class="anchored" data-anchor-id="struktura-matematyczna"><span class="header-section-number">16.6.1.3</span> Struktura Matematyczna</h4>
<p>W swojej najprostszej formie regresja liniowa może być wyrażona jako:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> reprezentuje wartość bazową (gdy X = 0)</li>
<li><span class="math inline">\beta_1</span> reprezentuje zmianę Y dla każdej jednostkowej zmiany X</li>
<li><span class="math inline">\epsilon</span> reprezentuje naturalną zmienność wokół tej relacji</li>
</ul>
</section>
<section id="implikacje-praktyczne" class="level4" data-number="16.6.1.4">
<h4 data-number="16.6.1.4" class="anchored"><span class="header-section-number">16.6.1.4</span> Implikacje Praktyczne</h4>
<p>Zrozumienie regresji jako modelu stochastycznego ma istotne implikacje praktyczne:</p>
<ol type="1">
<li><p>Przewidywania: Uznajemy, że nasze przewidywania będą charakteryzować się pewną naturalną zmiennością. Zamiast twierdzić, że wynik będzie dokładny, uznajemy zakres prawdopodobnych wartości.</p></li>
<li><p>Ocena Modelu: Oceniamy modele na podstawie tego, jak dobrze ujmują zarówno ogólną tendencję, jak i typową wielkość zmienności w danych.</p></li>
<li><p>Podejmowanie Decyzji: Zrozumienie naturalnej zmienności w naszych przewidywaniach pomaga nam podejmować bardziej realistyczne plany i decyzje.</p></li>
</ol>
<p><strong>Zastosowania w Rzeczywistości</strong></p>
<p>Rozważmy przewidywanie cen domów na podstawie metrażu. Model deterministyczny mógłby stwierdzić: “Dom o powierzchni 186 metrów kwadratowych będzie kosztować dokładnie 1 200 000 złotych”</p>
<p>Model regresji natomiast uznaje, że:</p>
<ul>
<li>Istnieje ogólna relacja między wielkością a ceną</li>
<li>Ale wiele innych czynników wpływa na końcową cenę</li>
<li>Podobne domy mogą być sprzedawane po nieco różnych cenach</li>
<li>Nasze przewidywania powinny odzwierciedlać tę naturalną zmienność</li>
</ul>
<p><strong>Podsumowanie</strong></p>
<p>Stochastyczna natura analizy regresji zapewnia bardziej realistyczne ramy do zrozumienia rzeczywistych relacji między zmiennymi.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Regresji Liniowej (MNK): Szybki Start
</div>
</div>
<div class="callout-body-container callout-body">
<section id="koncepcja-modelu" class="level3" data-number="16.6.2">
<h3 data-number="16.6.2" class="anchored" data-anchor-id="koncepcja-modelu"><span class="header-section-number">16.6.2</span> Koncepcja Modelu</h3>
<p>Regresja MNK (Metoda Najmniejszych Kwadratów) to model statystyczny opisujący związek między zmiennymi. Dwa kluczowe założenia definiują ten model:</p>
<ol type="1">
<li>Związek można opisać linią prostą (liniowość)</li>
<li>Błędy w naszych przewidywaniach nie są systematycznie powiązane ze zmienną x (ścisła egzogeniczność)</li>
</ol>
</section>
<section id="przykład-edukacja-i-wynagrodzenia" class="level3" data-number="16.6.3">
<h3 data-number="16.6.3" class="anchored" data-anchor-id="przykład-edukacja-i-wynagrodzenia"><span class="header-section-number">16.6.3</span> Przykład: Edukacja i Wynagrodzenia</h3>
<p>Rozważmy badanie wpływu edukacji (x) na wynagrodzenia (y). Powiedzmy, że szacujemy:</p>
<p><span class="math display">wynagrodzenia = \beta_0 + \beta_1 \cdot edukacja + \epsilon</span></p>
<p>Składnik błędu <span class="math inline">\epsilon</span> zawiera wszystkie inne czynniki wpływające na wynagrodzenia. Ścisła egzogeniczność jest naruszona, jeśli pominiemy ważną zmienną, jak “zdolności”, która wpływa zarówno na edukację, jak i wynagrodzenia. Dlaczego? Ponieważ bardziej zdolni ludzie mają tendencję do zdobywania lepszego wykształcenia I wyższych wynagrodzeń, co powoduje zawyżenie szacowanego efektu edukacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate OLS parameters</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(x, y) <span class="sc">/</span> <span class="fu">var</span>(x)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(x)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create alternative lines</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>lines_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">c</span>(beta0, beta0 <span class="sc">+</span> <span class="dv">1</span>, beta0 <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">c</span>(beta1, beta1 <span class="sc">+</span> <span class="fl">0.3</span>, beta1 <span class="sc">-</span> <span class="fl">0.3</span>),</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">line_type =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span>, <span class="st">"Suboptimal 1"</span>, <span class="st">"Suboptimal 2"</span>)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> lines_data,</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, </span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> slope,</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> line_type,</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linetype =</span> line_type),</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span> <span class="ot">=</span> <span class="st">"#FF4500"</span>,</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 1"</span> <span class="ot">=</span> <span class="st">"#4169E1"</span>,</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 2"</span> <span class="ot">=</span> <span class="st">"#228B22"</span>)) <span class="sc">+</span></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Finding the Best-Fitting Line"</span>,</span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Orange line minimizes the sum of squared errors"</span>,</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X Variable"</span>,</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Y Variable"</span>,</span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Line Type"</span>,</span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Line Type"</span>) <span class="sc">+</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="problem-optymalizacji-metoda-najmniejszych-kwadratów-ols" class="level3" data-number="16.6.4">
<h3 data-number="16.6.4" class="anchored" data-anchor-id="problem-optymalizacji-metoda-najmniejszych-kwadratów-ols"><span class="header-section-number">16.6.4</span> Problem Optymalizacji: Metoda Najmniejszych Kwadratów (OLS)</h3>
<p>Kiedy analizujemy zależności między zmiennymi, takimi jak poziom wykształcenia a wynagrodzenie, potrzebujemy systematycznej metody znalezienia linii, która najlepiej odzwierciedla tę relację w naszych danych. Metoda Najmniejszych Kwadratów (OLS - Ordinary Least Squares) dostarcza nam takiego rozwiązania poprzez precyzyjne podejście matematyczne.</p>
<p>Spójrzmy na nasz wykres poziomów wykształcenia i wynagrodzeń. Każdy punkt reprezentuje rzeczywiste dane - poziom wykształcenia danej osoby i odpowiadające mu wynagrodzenie. Naszym celem jest znalezienie pojedynczej linii, która najdokładniej uchwyci podstawową zależność między tymi zmiennymi.</p>
<p>Dla każdej obserwacji <span class="math inline">i</span> możemy wyrazić tę relację jako:</p>
<p><span class="math display">y_i = \beta_0 + \beta_1x_i + \epsilon_i</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">y_i</span> to rzeczywiste zaobserwowane wynagrodzenie</li>
<li><span class="math inline">\hat{y_i} = \beta_0 + \beta_1x_i</span> to przewidywane wynagrodzenie</li>
<li><span class="math inline">\epsilon_i = y_i - \hat{y_i}</span> to składnik błędu (reszta)</li>
</ul>
<p>Metoda OLS znajduje optymalne wartości dla <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> poprzez minimalizację sumy kwadratów błędów:</p>
<p><span class="math display">\min_{\beta_0, \beta_1} \sum \epsilon_i^2 = \min_{\beta_0, \beta_1} \sum(y_i - \hat{y_i})^2 = \min_{\beta_0, \beta_1} \sum(y_i - (\beta_0 + \beta_1x_i))^2</span></p>
<p>Analizując naszą wizualizację:</p>
<ul>
<li>Rozproszone punkty pokazują rzeczywiste obserwacje <span class="math inline">(x_i, y_i)</span></li>
<li>Czerwona linia reprezentuje dopasowane wartości <span class="math inline">\hat{y_i}</span>, które minimalizują <span class="math inline">\sum \epsilon_i^2</span></li>
<li>Niebieska i zielona linia przedstawiają alternatywne dopasowania o większych sumach kwadratów błędów</li>
<li>Pionowe odległości od każdego punktu do tych linii reprezentują błędy <span class="math inline">\epsilon_i</span></li>
</ul>
<p>Rozwiązanie OLS dostarcza nam estymatorów <span class="math inline">\hat{\beta_0}</span> i <span class="math inline">\hat{\beta_1}</span> nieznanych parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>, które minimalizują całkowity błąd kwadratowy, dając nam najdokładniejszą liniową reprezentację zależności między poziomem wykształcenia a wynagrodzeniem na podstawie dostępnych danych.</p>
</section>
<section id="znalezienie-najlepszej-linii" class="level3" data-number="16.6.5">
<h3 data-number="16.6.5" class="anchored" data-anchor-id="znalezienie-najlepszej-linii"><span class="header-section-number">16.6.5</span> Znalezienie Najlepszej Linii</h3>
<p>Rozwiązanie tego problemu minimalizacji daje nam:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sum(x_i - \bar{x})^2} = \frac{cov(X, Y)}{var(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
</section>
<section id="kluczowe-punkty" class="level3" data-number="16.6.6">
<h3 data-number="16.6.6" class="anchored" data-anchor-id="kluczowe-punkty"><span class="header-section-number">16.6.6</span> Kluczowe Punkty</h3>
<ol type="1">
<li>MNK znajduje linię, która minimalizuje kwadraty błędów predykcji</li>
<li>Ta linia jest “najlepsza” pod względem dopasowania, ale może nie ujmować prawdziwych relacji, jeśli pominięto ważne zmienne</li>
<li>W przykładzie edukacja-wynagrodzenia, pominięcie zdolności oznacza, że przypisujemy cały wzrost wynagrodzeń samej edukacji</li>
</ol>
</section>
</div>
</div>
</section>
</section>
<section id="podstawowe-pojęcia-i-terminologia" class="level3" data-number="16.6.7">
<h3 data-number="16.6.7" class="anchored" data-anchor-id="podstawowe-pojęcia-i-terminologia"><span class="header-section-number">16.6.7</span> Podstawowe Pojęcia i Terminologia</h3>
<p>Ustalmy kluczowe terminy:</p>
<ul>
<li><strong>Zmienna Zależna (Y)</strong>:
<ul>
<li>Wynik, który chcemy zrozumieć lub przewidzieć</li>
<li>Nazywana również: zmienna odpowiedzi, zmienna docelowa</li>
<li>Przykłady: wynagrodzenie, sprzedaż, wyniki egzaminów</li>
</ul></li>
<li><strong>Zmienna Niezależna (X)</strong>:
<ul>
<li>Zmienna, która naszym zdaniem wpływa na Y</li>
<li>Nazywana również: predyktor, zmienna objaśniająca, regresor</li>
<li>Przykłady: lata edukacji, budżet reklamowy, godziny nauki</li>
</ul></li>
<li><strong>Parametry Populacji (</strong><span class="math inline">\beta</span>):
<ul>
<li>Prawdziwe podstawowe zależności, które chcemy zrozumieć</li>
<li>Zazwyczaj nieznane w praktyce</li>
<li>Przykłady: <span class="math inline">\beta_0</span> (prawdziwy wyraz wolny), <span class="math inline">\beta_1</span> (prawdziwe nachylenie)</li>
</ul></li>
<li><strong>Oszacowania Parametrów (</strong><span class="math inline">\hat{\beta}</span>):
<ul>
<li>Nasze najlepsze przypuszczenia dotyczące prawdziwych parametrów na podstawie danych</li>
<li>Obliczane na podstawie danych próby</li>
<li>Przykłady: <span class="math inline">\hat{\beta}_0</span> (oszacowany wyraz wolny), <span class="math inline">\hat{\beta}_1</span> (oszacowane nachylenie)</li>
</ul></li>
</ul>
</section>
<section id="główna-idea" class="level3" data-number="16.6.8">
<h3 data-number="16.6.8" class="anchored" data-anchor-id="główna-idea"><span class="header-section-number">16.6.8</span> Główna Idea</h3>
<p>Zobaczmy na przykładzie, co robi regresja:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate some example data</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Przykład Prostej Regresji Liniowej"</span>,</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Punkty reprezentują dane, czerwona linia pokazuje dopasowanie regresji"</span>,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna Niezależna (X)"</span>,</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Zależna (Y)"</span>) <span class="sc">+</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-basic-idea" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-basic-idea-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Podstawowa Idea Regresji: Dopasowanie Linii do Danych
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ten wykres pokazuje istotę regresji:</p>
<ul>
<li>Każdy punkt reprezentuje obserwację (X, Y)</li>
<li>Linia reprezentuje nasze najlepsze przypuszczenie dotyczące zależności</li>
<li>Rozproszenie punktów wokół linii pokazuje niepewność</li>
</ul>
</section>
</section>
<section id="model-regresji-liniowej-1" class="level2" data-number="16.7">
<h2 data-number="16.7" class="anchored" data-anchor-id="model-regresji-liniowej-1"><span class="header-section-number">16.7</span> Model Regresji Liniowej</h2>
<section id="model-populacyjny-vs.-oszacowania-z-próby" class="level3" data-number="16.7.1">
<h3 data-number="16.7.1" class="anchored" data-anchor-id="model-populacyjny-vs.-oszacowania-z-próby"><span class="header-section-number">16.7.1</span> Model Populacyjny vs.&nbsp;Oszacowania z Próby</h3>
<p>W teorii istnieje prawdziwa zależność populacyjna:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \varepsilon</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to prawdziwy wyraz wolny populacji</li>
<li><span class="math inline">\beta_1</span> to prawdziwe nachylenie populacji</li>
<li><span class="math inline">\varepsilon</span> to składnik losowy błędu</li>
</ul>
<p>W praktyce pracujemy z danymi próby, aby oszacować tę zależność:</p>
<p><span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X</span></p>
<p>Zobaczmy wizualizację różnicy między zależnościami populacyjnymi a próbkowymi:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate population data</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>x_pop <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>true_relationship <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_pop  <span class="co"># True β₀=2, β₁=3</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>y_pop <span class="ot">&lt;-</span> true_relationship <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x_pop), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create several samples</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">sample</span>(x_pop, sample_size), <span class="dv">3</span>),</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> sample_size)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>samples<span class="sc">$</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(samples), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models to each sample</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> samples <span class="sc">%&gt;%</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">1</span>],</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">2</span>]</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> samples, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="fu">factor</span>(sample)), </span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> models, </span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope, </span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="fu">factor</span>(sample)),</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_pop, <span class="at">y =</span> true_relationship), </span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linie Regresji: Populacyjna vs. Próbkowe"</span>,</span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Czarna linia: prawdziwa zależność populacyjna</span><span class="sc">\n</span><span class="st">Linie przerywane: oszacowania próbkowe"</span>,</span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>,</span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Próba"</span>) <span class="sc">+</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pop-vs-sample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-pop-vs-sample-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: Linie Regresji: Populacyjna vs.&nbsp;Próbkowe
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ta wizualizacja pokazuje:</p>
<ul>
<li>Prawdziwą linię populacyjną (czarną), którą próbujemy odkryć</li>
<li>Różne oszacowania próbkowe (linie przerywane) oparte na różnych próbach</li>
<li>Jak oszacowania próbkowe różnią się wokół prawdziwej zależności</li>
</ul>
</section>
</section>
<section id="kluczowe-założenia-regresji-liniowej" class="level2" data-number="16.8">
<h2 data-number="16.8" class="anchored" data-anchor-id="kluczowe-założenia-regresji-liniowej"><span class="header-section-number">16.8</span> Kluczowe Założenia Regresji Liniowej</h2>
<section id="ścisła-egzogeniczność-podstawowe-założenie" class="level3" data-number="16.8.1">
<h3 data-number="16.8.1" class="anchored" data-anchor-id="ścisła-egzogeniczność-podstawowe-założenie"><span class="header-section-number">16.8.1</span> Ścisła Egzogeniczność: Podstawowe Założenie</h3>
<p>Najważniejszym założeniem w regresji jest ścisła egzogeniczność:</p>
<p><span class="math display">E[\varepsilon|X] = 0</span></p>
<p>Oznacza to:</p>
<ol type="1">
<li>Wartość oczekiwana składnika błędu warunkowego względem X wynosi zero</li>
<li>X nie zawiera informacji o przeciętnym błędzie</li>
<li>Nie ma systematycznych wzorców w tym, jak nasze przewidywania są błędne</li>
</ol>
<p>Zobaczmy wizualizację sytuacji, gdy to założenie jest spełnione i gdy nie jest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: Exogenous errors</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>y_exog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2: Non-exogenous errors (error variance increases with x)</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>y_nonexog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>data_exog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_exog,</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Błędy Egzogeniczne</span><span class="sc">\n</span><span class="st">(Założenie Spełnione)"</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>data_nonexog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_nonexog,</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Błędy Nieegzogeniczne</span><span class="sc">\n</span><span class="st">(Założenie Niespełnione)"</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_exog, data_nonexog)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots with residuals</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>plot_residuals <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title)</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Reszty"</span>)</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1, p2)</span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate plots</span></span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a>plots_exog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_exog, <span class="st">"Błędy Egzogeniczne"</span>)</span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a>plots_nonexog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_nonexog, <span class="st">"Błędy Nieegzogeniczne"</span>)</span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a>  plots_exog[[<span class="dv">1</span>]], plots_exog[[<span class="dv">2</span>]],</span>
<span id="cb81-54"><a href="#cb81-54" aria-hidden="true" tabindex="-1"></a>  plots_nonexog[[<span class="dv">1</span>]], plots_nonexog[[<span class="dv">2</span>]],</span>
<span id="cb81-55"><a href="#cb81-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb81-56"><a href="#cb81-56" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exogeneity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-exogeneity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.3: Przykłady Egzogeniczności vs.&nbsp;Nieegzogeniczności
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="liniowość-założenie-o-formie" class="level3" data-number="16.8.2">
<h3 data-number="16.8.2" class="anchored" data-anchor-id="liniowość-założenie-o-formie"><span class="header-section-number">16.8.2</span> Liniowość: Założenie o Formie</h3>
<p>Zależność między X a Y powinna być liniowa w parametrach:</p>
<p><span class="math display">E[Y|X] = \beta_0 + \beta_1X</span></p>
<p>Zauważ, że nie oznacza to, że X i Y muszą mieć zależność w postaci linii prostej - możemy transformować zmienne. Zobaczmy różne rodzaje zależności:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Different relationships</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>data_relationships <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Linear</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Quadratic</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exponential</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Liniowa"</span>, <span class="st">"Kwadratowa"</span>, <span class="st">"Wykładnicza"</span>), <span class="at">each =</span> <span class="fu">length</span>(x))</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_relationships, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Czerwona: dopasowanie liniowe, Niebieska: prawdziwa zależność"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-linearity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.4: Zależności Liniowe i Nieliniowe
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zrozumienie-naruszeń-i-rozwiązania" class="level3" data-number="16.8.3">
<h3 data-number="16.8.3" class="anchored" data-anchor-id="zrozumienie-naruszeń-i-rozwiązania"><span class="header-section-number">16.8.3</span> Zrozumienie Naruszeń i Rozwiązania</h3>
<p>Gdy założenie liniowości jest naruszone:</p>
<ol type="1">
<li>Transformacja zmiennych:
<ul>
<li>Transformacja logarytmiczna: dla zależności wykładniczych</li>
<li>Pierwiastek kwadratowy: dla umiarkowanej nieliniowości</li>
<li>Transformacje potęgowe: dla bardziej złożonych zależności</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate exponential data</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">102</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>data_trans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_y =</span> <span class="fu">log</span>(y)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(y): NaNs produced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original scale plot</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Skala Oryginalna"</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale plot</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> log_y)) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y po Transformacji Logarytmicznej"</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-transformations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-transformations-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.5: Efekt Transformacji Zmiennych
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Intuicyjne zrozumienie Metody Najmniejszych Kwadratów (MNK)
</div>
</div>
<div class="callout-body-container callout-body">
<section id="podstawowy-problem" class="level3" data-number="16.8.4">
<h3 data-number="16.8.4" class="anchored" data-anchor-id="podstawowy-problem"><span class="header-section-number">16.8.4</span> Podstawowy Problem</h3>
<p>Zacznijmy od rzeczywistego scenariusza: chcemy zrozumieć, jak czas nauki wpływa na wyniki egzaminu. Zbieramy dane z Twojej klasy, gdzie:</p>
<ul>
<li>Każdy student zapisuje swoje godziny nauki (<span class="math inline">x</span>), oraz swój końcowy wynik egzaminu (<span class="math inline">y</span>)</li>
<li>Więc student 1 mógł się uczyć <span class="math inline">x_1 = 3</span> godziny i uzyskać <span class="math inline">y_1 = 75</span> punktów</li>
<li>Student 2 mógł się uczyć <span class="math inline">x_2 = 5</span> godzin i uzyskać <span class="math inline">y_2 = 82</span> punkty</li>
<li>I tak dalej dla wszystkich <span class="math inline">n</span> studentów w klasie</li>
</ul>
<p>Naszym celem jest znalezienie prostej, która najlepiej opisuje tę zależność. Próbujemy oszacować prawdziwą zależność (której nigdy nie znamy dokładnie) używając naszej próby danych. Przeanalizujmy to krok po kroku.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>godziny_nauki <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>wyniki_egzaminu <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> godziny_nauki <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(godziny_nauki, wyniki_egzaminu)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Podstawowy wykres punktowy</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Dane z Twojej klasy: Godziny nauki vs. Wyniki egzaminu"</span>) <span class="sc">+</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="co-sprawia-że-prosta-jest-dobra" class="level3" data-number="16.8.5">
<h3 data-number="16.8.5" class="anchored" data-anchor-id="co-sprawia-że-prosta-jest-dobra"><span class="header-section-number">16.8.5</span> Co sprawia, że prosta jest “dobra”?</h3>
<p>Każdą prostą można zapisać w postaci:</p>
<p><span class="math inline">y = \hat{\beta}_0 + \hat{\beta}_1x</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\hat{\beta}_0</span> to nasza estymata wyrazu wolnego (przewidywany wynik dla zero godzin nauki)</li>
<li><span class="math inline">\hat{\beta}_1</span> to nasza estymata nachylenia (ile punktów zyskujemy za każdą dodatkową godzinę nauki)</li>
<li>Daszki (^) wskazują, że są to nasze estymaty prawdziwych (nieznanych) parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span></li>
</ul>
<p>Spójrzmy na trzy możliwe proste przechodzące przez nasze dane:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">50</span>, <span class="at">slope =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Trzy różne proste: Która jest najlepsza?"</span>) <span class="sc">+</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">label =</span> <span class="st">"Prosta A: Za stroma"</span>) <span class="sc">+</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">85</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">label =</span> <span class="st">"Prosta B: Za płaska"</span>) <span class="sc">+</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">label =</span> <span class="st">"Prosta C: W sam raz"</span>) <span class="sc">+</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="zrozumienie-błędów-przewidywania-reszt" class="level3" data-number="16.8.6">
<h3 data-number="16.8.6" class="anchored" data-anchor-id="zrozumienie-błędów-przewidywania-reszt"><span class="header-section-number">16.8.6</span> Zrozumienie błędów przewidywania (reszt)</h3>
<p>Dla każdego studenta w naszych danych:</p>
<ol type="1">
<li>Patrzymy na jego rzeczywisty wynik egzaminu (<span class="math inline">y_i</span>)</li>
<li>Obliczamy przewidywany wynik używając naszej prostej (<span class="math inline">\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1x_i</span>)</li>
<li>Różnica między nimi nazywana jest resztą:</li>
</ol>
<p><span class="math inline">\text{reszta}_i = y_i - \hat{y}_i = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></p>
<p>Zobaczmy wizualizację tych reszt dla jednej prostej:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu i pokazanie reszt</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(wyniki_egzaminu <span class="sc">~</span> godziny_nauki, <span class="at">data =</span> dane)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> godziny_nauki, </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">yend =</span> <span class="fu">predict</span>(model, dane)),</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Zrozumienie reszt: Różnice między przewidywaniami a rzeczywistością"</span>) <span class="sc">+</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pomarańczowe pionowe linie pokazują, jak bardzo nasze przewidywania odbiegają od rzeczywistości dla każdego studenta. Niektóre przewidywania są za wysokie (dodatnie reszty), inne za niskie (ujemne reszty).</p>
</section>
<section id="dlaczego-podnosimy-reszty-do-kwadratu" class="level3" data-number="16.8.7">
<h3 data-number="16.8.7" class="anchored" data-anchor-id="dlaczego-podnosimy-reszty-do-kwadratu"><span class="header-section-number">16.8.7</span> Dlaczego podnosimy reszty do kwadratu?</h3>
<p>To kluczowa koncepcja! Przeanalizujmy to na prostym przykładzie:</p>
<p>Wyobraź sobie, że mamy tylko dwoje studentów:</p>
<ol type="1">
<li>Ala: Przewidywane 80, rzeczywisty wynik 85 (reszta = +5)</li>
<li>Bob: Przewidywane 90, rzeczywisty wynik 85 (reszta = -5)</li>
</ol>
<p>Jeśli po prostu dodamy te reszty: <span class="math inline">(+5) + (-5) = 0</span></p>
<p>To sugerowałoby, że nasza prosta jest idealna (całkowity błąd = 0), ale wiemy, że tak nie jest! Oba przewidywania były nietrafne o 5 punktów.</p>
<p>Rozwiązanie: Podnosimy reszty do kwadratu przed dodaniem:</p>
<ul>
<li>Kwadrat reszty Ali: <span class="math inline">(+5)^2 = 25</span></li>
<li>Kwadrat reszty Boba: <span class="math inline">(-5)^2 = 25</span></li>
<li>Całkowity błąd kwadratowy: <span class="math inline">25 + 25 = 50</span></li>
</ul>
<p>To daje nam znacznie lepszą miarę tego, jak bardzo nasze przewidywania są błędne!</p>
</section>
<section id="suma-kwadratów-reszt-sse" class="level3" data-number="16.8.8">
<h3 data-number="16.8.8" class="anchored" data-anchor-id="suma-kwadratów-reszt-sse"><span class="header-section-number">16.8.8</span> Suma kwadratów reszt (SSE)</h3>
<p>Suma kwadratów reszt (SSE - Sum of Squared Errors) jest fundamentalną miarą dopasowania modelu regresji liniowej. Możemy ją wyrazić matematycznie jako:</p>
<p><span class="math display">SSE = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">y_i</span> to rzeczywista wartość zmiennej zależnej dla i-tej obserwacji</li>
<li><span class="math inline">\hat{\beta}_0</span> to oszacowany wyraz wolny (punkt przecięcia z osią Y)</li>
<li><span class="math inline">\hat{\beta}_1</span> to oszacowany współczynnik nachylenia prostej</li>
<li><span class="math inline">x_i</span> to wartość zmiennej niezależnej dla i-tej obserwacji</li>
</ul>
<p>Proces obliczania SSE można przedstawić w następujących krokach:</p>
<ol type="1">
<li><p>Dla każdej obserwacji obliczamy różnicę między wartością rzeczywistą (<span class="math inline">y_i</span>) a wartością przewidywaną przez model (<span class="math inline">\hat{\beta}_0 + \hat{\beta}_1x_i</span>). Ta różnica nazywana jest resztą.</p></li>
<li><p>Każdą resztę podnosimy do kwadratu, co powoduje, że:</p>
<ul>
<li>wszystkie wartości stają się dodatnie</li>
<li>większe błędy są silniej “karane” niż małe</li>
<li>jednostki miary są podnoszone do kwadratu</li>
</ul></li>
<li><p>Sumujemy wszystkie kwadraty reszt, otrzymując jedną liczbę reprezentującą całkowity błąd modelu.</p></li>
</ol>
<p><strong>Im mniejsza wartość SSE, tym lepsze dopasowanie modelu do danych empirycznych</strong>.</p>
<p>Wartość SSE = 0 oznaczałaby idealne dopasowanie, gdzie wszystkie punkty leżą dokładnie na prostej regresji. W praktyce tak doskonałe dopasowanie występuje niezwykle rzadko i może sugerować problem przeuczenia modelu.</p>
<p>SSE stanowi podstawę do obliczania innych ważnych miar jakości dopasowania modelu, takich jak współczynnik determinacji R² czy błąd standardowy estymacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie dobrego i złego dopasowania</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>zle_przewidywania <span class="ot">&lt;-</span> <span class="dv">70</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> dane<span class="sc">$</span>godziny_nauki</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>dobre_przewidywania <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, dane)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>zle_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((dane<span class="sc">$</span>wyniki_egzaminu <span class="sc">-</span> zle_przewidywania)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>dobre_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((dane<span class="sc">$</span>wyniki_egzaminu <span class="sc">-</span> dobre_przewidywania)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">95</span>, </span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Czerwona prosta: Błąd ="</span>, <span class="fu">round</span>(zle_sse)), </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">90</span>, </span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Fioletowa prosta: Błąd ="</span>, <span class="fu">round</span>(dobre_sse)), </span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Porównanie całkowitych błędów przewidywania"</span>) <span class="sc">+</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dlaczego-nazywamy-to-metodą-najmniejszych-kwadratów" class="level3" data-number="16.8.9">
<h3 data-number="16.8.9" class="anchored" data-anchor-id="dlaczego-nazywamy-to-metodą-najmniejszych-kwadratów"><span class="header-section-number">16.8.9</span> Dlaczego nazywamy to “Metodą Najmniejszych Kwadratów”?</h3>
<p>Przeanalizujmy nazwę:</p>
<ul>
<li>“Kwadratów”: Podnosimy reszty do kwadratu</li>
<li>“Najmniejszych”: Chcemy najmniejszej możliwej sumy</li>
<li>“Zwykłych” (w angielskim “Ordinary”): To podstawowa wersja (istnieją bardziej zaawansowane warianty!)</li>
</ul>
<p>Prosta MNK ma kilka ciekawych właściwości:</p>
<ol type="1">
<li>Średnia wszystkich reszt równa się zero</li>
<li>Prosta zawsze przechodzi przez punkt (<span class="math inline">\bar{x}</span>, <span class="math inline">\bar{y}</span>) - średnie godziny nauki i średni wynik</li>
<li>Małe zmiany w danych prowadzą do małych zmian w prostej (jest “stabilna”)</li>
<li>Nasze estymaty <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> są najlepszymi możliwymi estymatorami prawdziwych parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span></li>
</ol>
</section>
<section id="ważne-uwagi" class="level3" data-number="16.8.10">
<h3 data-number="16.8.10" class="anchored" data-anchor-id="ważne-uwagi"><span class="header-section-number">16.8.10</span> Ważne uwagi</h3>
<ol type="1">
<li><p>Oznaczenie z daszkiem (<span class="math inline">\hat{\beta}_0</span>, <span class="math inline">\hat{\beta}_1</span>) przypomina nam, że estymujemy prawdziwą zależność z naszej próby. Nigdy nie znamy prawdziwych <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> - możemy je tylko oszacować z naszych danych.</p></li>
<li><p>MNK daje nam najlepsze możliwe estymaty, gdy spełnione są pewne warunki (jak losowo pobrana próba i rzeczywiście liniowa zależność).</p></li>
</ol>
</section>
</div>
</div>
</section>
</section>
<section id="ocena-dopasowania-modelu" class="level2" data-number="16.9">
<h2 data-number="16.9" class="anchored" data-anchor-id="ocena-dopasowania-modelu"><span class="header-section-number">16.9</span> Ocena Dopasowania Modelu</h2>
<section id="dekompozycja-wariancji" class="level3" data-number="16.9.1">
<h3 data-number="16.9.1" class="anchored" data-anchor-id="dekompozycja-wariancji"><span class="header-section-number">16.9.1</span> Dekompozycja Wariancji</h3>
<p>Całkowita zmienność Y może być rozłożona na komponenty wyjaśnione i niewyjaśnione:</p>
<p><span class="math display">\underbrace{\sum_{i=1}^n (Y_i - \bar{Y})^2}_{SST} = \underbrace{\sum_{i=1}^n (\hat{Y}_i - \bar{Y})^2}_{SSR} + \underbrace{\sum_{i=1}^n (Y_i - \hat{Y}_i)^2}_{SSE}</span></p>
<p>gdzie:</p>
<ul>
<li>SST (Całkowita Suma Kwadratów): Całkowita zmienność Y</li>
<li>SSR (Regresyjna Suma Kwadratów): Zmienność wyjaśniona przez regresję</li>
<li>SSE (Suma Kwadratów Błędów): Zmienność niewyjaśniona</li>
</ul>
</section>
<section id="trzy-komponenty-wariancji" class="level3" data-number="16.9.2">
<h3 data-number="16.9.2" class="anchored" data-anchor-id="trzy-komponenty-wariancji"><span class="header-section-number">16.9.2</span> Trzy Komponenty Wariancji</h3>
<ol type="1">
<li><strong>Wariancja Całkowita (SST - Suma Kwadratów Całkowita)</strong>
<ul>
<li>Pytanie: “Jak bardzo obserwacje różnią się od średniej?”</li>
<li>Wzór: <span class="math inline">SST = \sum(y_i - \bar{y})^2</span></li>
<li>Intuicja: “Rozrzut” naszych danych wokół ich średniej</li>
</ul></li>
<li><strong>Wariancja Wyjaśniona (SSR - Suma Kwadratów Regresji)</strong>
<ul>
<li>Pytanie: “Ile wariancji wyjaśnił nasz model?”</li>
<li>Wzór: <span class="math inline">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li>Intuicja: Poprawa, którą uzyskaliśmy dzięki użyciu X</li>
</ul></li>
<li><strong>Wariancja Niewyjaśniona (SSE - Suma Kwadratów Błędów)</strong>
<ul>
<li>Pytanie: “Jaka wariancja pozostaje niewyjaśniona?”</li>
<li>Wzór: <span class="math inline">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li>Intuicja: Błędy, które pozostają po użyciu X</li>
</ul></li>
</ol>
</section>
<section id="współczynnik-r²---wyjaśnienie" class="level3" data-number="16.9.3">
<h3 data-number="16.9.3" class="anchored" data-anchor-id="współczynnik-r²---wyjaśnienie"><span class="header-section-number">16.9.3</span> Współczynnik R² - Wyjaśnienie</h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span> Współczynnik R² odpowiada na pytanie: “Jaki procent pierwotnej zmienności Y możemy wyjaśnić za pomocą X?”</p>
<section id="intuicyjne-przykłady" class="level4" data-number="16.9.3.1">
<h4 data-number="16.9.3.1" class="anchored" data-anchor-id="intuicyjne-przykłady"><span class="header-section-number">16.9.3.1</span> Intuicyjne Przykłady:</h4>
<ul>
<li>R² = 0,80: Wykorzystanie X wyeliminowało 80% błędów predykcji</li>
<li>R² = 0,25: Wykorzystanie X wyeliminowało 25% błędów predykcji</li>
<li>R² = 0,00: Wykorzystanie X nie przyniosło żadnej poprawy</li>
</ul>
</section>
</section>
<section id="kiedy-zachować-ostrożność" class="level3" data-number="16.9.4">
<h3 data-number="16.9.4" class="anchored" data-anchor-id="kiedy-zachować-ostrożność"><span class="header-section-number">16.9.4</span> Kiedy Zachować Ostrożność</h3>
<ol type="1">
<li><strong>Wysoki R² Nie Jest Wszystkim</strong>
<ul>
<li>Wysoki R² może wskazywać na przeuczenie modelu</li>
<li>Zawsze sprawdzaj, czy model ma sens praktyczny</li>
<li>Weź pod uwagę kontekst swojej dziedziny</li>
</ul></li>
<li><strong>Niski R² Nie Zawsze Jest Zły</strong>
<ul>
<li>W niektórych dziedzinach R² = 0,30 może być imponujący</li>
<li>Nauki społeczne często mają niższe wartości R²</li>
<li>Skup się na znaczeniu praktycznym</li>
</ul></li>
</ol>
</section>
<section id="praktyczne-wskazówki-do-analizy" class="level3" data-number="16.9.5">
<h3 data-number="16.9.5" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy"><span class="header-section-number">16.9.5</span> Praktyczne Wskazówki do Analizy</h3>
<ol type="1">
<li><strong>Inspekcja Wizualna</strong>
<ul>
<li>Zawsze wizualizuj swoje dane</li>
<li>Szukaj wzorców w resztach</li>
<li>Sprawdzaj punkty wpływowe</li>
</ul></li>
<li><strong>Uwzględnienie Kontekstu</strong>
<ul>
<li>Co jest “dobrym” R² w twojej dziedzinie?</li>
<li>Jaki jest praktyczny wpływ twoich błędów?</li>
<li>Czy twoje predyktory są znaczące?</li>
</ul></li>
<li><strong>Diagnostyka Modelu</strong>
<ul>
<li>Sprawdź normalność reszt</li>
<li>Szukaj heteroskedastyczności</li>
<li>Badaj punkty wpływowe</li>
</ul></li>
</ol>
</section>
<section id="kluczowe-wnioski-1" class="level3" data-number="16.9.6">
<h3 data-number="16.9.6" class="anchored" data-anchor-id="kluczowe-wnioski-1"><span class="header-section-number">16.9.6</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Dekompozycja wariancji pomaga zrozumieć poprawę predykcji</li>
<li>R² określa proporcję wyjaśnionej wariancji</li>
<li>Zrozumienie wizualne jest kluczowe dla interpretacji</li>
<li>Kontekst jest ważniejszy niż bezwzględne wartości R²</li>
<li>Zawsze łącz R² z innymi narzędziami diagnostycznymi</li>
</ol>
</section>
<section id="miary-dopasowania" class="level3" data-number="16.9.7">
<h3 data-number="16.9.7" class="anchored" data-anchor-id="miary-dopasowania"><span class="header-section-number">16.9.7</span> Miary Dopasowania</h3>
<ol type="1">
<li><p><strong>R-kwadrat (</strong><span class="math inline">R^2</span>): <span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p></li>
<li><p><strong>Pierwiastek Błędu Średniokwadratowego (RMSE)</strong>: <span class="math display">RMSE = \sqrt{\frac{SSE}{n}}</span></p></li>
<li><p><strong>Średni Błąd Bezwzględny (MAE)</strong>: <span class="math display">MAE = \frac{1}{n}\sum_{i=1}^n |Y_i - \hat{Y}_i|</span></p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dekompozycja Wariancji w Regresji Liniowej
</div>
</div>
<div class="callout-body-container callout-body">
<section id="dlaczego-to-jest-ważne-zrozumienie-poprawy-prognoz-poprzez-dodatkowe-informacje" class="level3" data-number="16.9.8">
<h3 data-number="16.9.8" class="anchored" data-anchor-id="dlaczego-to-jest-ważne-zrozumienie-poprawy-prognoz-poprzez-dodatkowe-informacje"><span class="header-section-number">16.9.8</span> Dlaczego To Jest Ważne: Zrozumienie Poprawy Prognoz Poprzez Dodatkowe Informacje</h3>
<p>Rozważmy prbem zwizany z przewidywaniem cen nieruchomości na rynku mieszkaniowym. Na najbardziej podstawowym poziomie można oszacować cenę dowolnego domu, używając średniej ceny rynkowej. Jednakże takie podejście pomija potencjalnie wartościowe informacje. Gdy uwzględnimy dodatkowe zmienne, takie jak powierzchnia użytkowa, lokalizacja czy liczba sypialni, nasze prognozy zazwyczaj stają się bardziej precyzyjne.</p>
<p><strong>Dekompozycja wariancji</strong> dostarcza matematycznych ram do dokładnego określenia, o ile poprawia się trafność prognoz, gdy włączamy takie dodatkowe informacje.</p>
</section>
<section id="udoskonalenie-estymacji" class="level3" data-number="16.9.9">
<h3 data-number="16.9.9" class="anchored" data-anchor-id="udoskonalenie-estymacji"><span class="header-section-number">16.9.9</span> Udoskonalenie Estymacji</h3>
<section id="podejście-początkowe-uniwersalna-średnia" class="level4" data-number="16.9.9.1">
<h4 data-number="16.9.9.1" class="anchored" data-anchor-id="podejście-początkowe-uniwersalna-średnia"><span class="header-section-number">16.9.9.1</span> Podejście Początkowe: Uniwersalna Średnia</h4>
<p>Zaczynamy od najprostszej możliwej prognozy: średniej wszystkich cen domów (<span class="math inline">\bar{y}</span>). Stanowi to nasz punkt wyjścia – prognozę dokonaną bez żadnych szczególnych informacji o poszczególnych nieruchomościach. Choć podejście to zapewnia rozsądny punkt odniesienia, traktuje każdy dom identycznie, prowadząc do tzw. <strong>błędów bazowych</strong>. Błędy te powstają właśnie dlatego, że ignorujemy unikalne cechy każdej nieruchomości.</p>
</section>
<section id="podejście-zaawansowane-włączenie-informacji-szczegółowych" class="level4" data-number="16.9.9.2">
<h4 data-number="16.9.9.2" class="anchored" data-anchor-id="podejście-zaawansowane-włączenie-informacji-szczegółowych"><span class="header-section-number">16.9.9.2</span> Podejście Zaawansowane: Włączenie Informacji Szczegółowych</h4>
<p>Gdy wprowadzamy charakterystyki specyficzne dla nieruchomości (oznaczone jako <span class="math inline">X</span>), takie jak powierzchnia użytkowa, możemy udoskonalić nasze prognozy. To udoskonalenie pozwala nam różnicować między nieruchomościami, tworząc spersonalizowane prognozy odzwierciedlające indywidualne cechy domów. Wynikające z tego błędy prognoz zazwyczaj maleją, demonstrując wartość włączenia dodatkowych informacji.</p>
</section>
</section>
<section id="zrozumienie-komponentów-wariancji" class="level3" data-number="16.9.10">
<h3 data-number="16.9.10" class="anchored" data-anchor-id="zrozumienie-komponentów-wariancji"><span class="header-section-number">16.9.10</span> Zrozumienie Komponentów Wariancji</h3>
<ol type="1">
<li><strong>Wariancja Całkowita (SST)</strong> Wariancja całkowita określa ogólną zmienność cen domów wokół średniej rynkowej.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SST = \sum(y_i - \bar{y})^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Zobrazowana przez fioletowe pionowe linie na wykresie, pokazujące odległość każdej rzeczywistej ceny domu od średniej ogólnej</li>
<li><strong>Ramy Koncepcyjne:</strong> Można to rozumieć jako pomiar tego, jak bardzo ceny domów różnią się od siebie na rynku</li>
<li><strong>Interpretacja Praktyczna:</strong> Większe SST wskazuje na bardziej zróżnicowany rynek mieszkaniowy z większą zmiennością cen</li>
</ul></li>
<li><strong>Wariancja Wyjaśniona (SSR)</strong> Ten komponent reprezentuje część zmienności cen, którą nasz model skutecznie wychwytuje poprzez uwzględnione zmienne.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Pokazana przez zielone przerywane linie, reprezentujące jak bardzo prognozy naszego modelu odbiegają od średniej</li>
<li><strong>Ramy Koncepcyjne:</strong> Mierzy to, o ile lepsze stają się nasze prognozy, gdy uwzględniamy szczególne cechy domów</li>
<li><strong>Interpretacja Praktyczna:</strong> Większe SSR w stosunku do SST wskazuje, że wybrane przez nas zmienne (jak powierzchnia użytkowa) silnie wpływają na ceny domów</li>
</ul></li>
<li><strong>Wariancja Niewyjaśniona (SSE)</strong> Reprezentuje pozostałą zmienność cen, której nasz model nie może wyjaśnić przy użyciu uwzględnionych zmiennych.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Zobrazowana przez pomarańczowe przerywane linie, pokazujące pozostałe błędy między naszymi prognozami a rzeczywistymi cenami</li>
<li><strong>Ramy Koncepcyjne:</strong> Są to błędy prognoz, które utrzymują się nawet po uwzględnieniu wszystkich wybranych zmiennych</li>
<li><strong>Interpretacja Praktyczna:</strong> Mniejsze SSE sugeruje, że nasz model wychwytuje większość głównych czynników wpływających na cenę</li>
</ul></li>
</ol>
<p>SST = SSR + SSE. Ta zależność mówi nam, że cała zmienność cen musi być albo wyjaśniona przez nasz model (SSR), albo pozostać niewyjaśniona (SSE), dostarczając kompleksowych ram do zrozumienia poprawy prognoz. Kolorowe linie na wykresie stanowią wizualne potwierdzenie tej zależności, pomagając zrozumieć, jak te komponenty współdziałają w praktyce.</p>
<section id="wizualizacja-dekompozycji-wariancji" class="level4" data-number="16.9.10.1">
<h4 data-number="16.9.10.1" class="anchored" data-anchor-id="wizualizacja-dekompozycji-wariancji"><span class="header-section-number">16.9.10.1</span> Wizualizacja Dekompozycji Wariancji</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with clearer pattern</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model and calculations</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, data)</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific points for demonstration that are well-spaced</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>demonstration_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">25</span>, <span class="dv">42</span>)  <span class="co"># Changed points for better spacing</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create main plot with improved aesthetics</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add background grid for better readability</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line and mean line</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"longdash"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data points</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"#4A4A4A"</span>) <span class="sc">+</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add decomposition segments with improved colors and positioning</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total deviation (purple)</span></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> y, <span class="at">yend =</span> mean_y),</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#984EA3"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explained component (green)</span></span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> mean_y, <span class="at">yend =</span> predicted),</span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#4DAF4A"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unexplained component (orange)</span></span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> predicted, <span class="at">yend =</span> y),</span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#FF7F00"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add annotations for better understanding</span></span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], <span class="at">y =</span> mean_y <span class="sc">-</span> <span class="fl">0.2</span>,</span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Mean"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], </span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> data<span class="sc">$</span>predicted[demonstration_points[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Regression Line"</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Improve theme and labels</span></span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Variance Decomposition in Linear Regression"</span>,</span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decomposing total variance into explained and unexplained components"</span>,</span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predictor (X)"</span>,</span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Response (Y)"</span></span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Create error distribution plot with improved aesthetics</span></span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>mean_error <span class="ot">&lt;-</span> y <span class="sc">-</span> mean_y</span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>regression_error <span class="ot">&lt;-</span> y <span class="sc">-</span> data<span class="sc">$</span>predicted</span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_error, <span class="at">fill =</span> <span class="st">"Deviation from Mean"</span>), </span>
<span id="cb98-74"><a href="#cb98-74" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb98-75"><a href="#cb98-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> regression_error, <span class="at">fill =</span> <span class="st">"Regression Residuals"</span>), </span>
<span id="cb98-76"><a href="#cb98-76" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb98-77"><a href="#cb98-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb98-78"><a href="#cb98-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb98-79"><a href="#cb98-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb98-80"><a href="#cb98-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb98-81"><a href="#cb98-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-82"><a href="#cb98-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb98-83"><a href="#cb98-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Error Distribution Comparison"</span>,</span>
<span id="cb98-84"><a href="#cb98-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error Magnitude"</span>,</span>
<span id="cb98-85"><a href="#cb98-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb98-86"><a href="#cb98-86" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-87"><a href="#cb98-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb98-88"><a href="#cb98-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377EB8"</span>, <span class="st">"#E41A1C"</span>)</span>
<span id="cb98-89"><a href="#cb98-89" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-90"><a href="#cb98-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-91"><a href="#cb98-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend explaining the decomposition components</span></span>
<span id="cb98-92"><a href="#cb98-92" aria-hidden="true" tabindex="-1"></a>legend_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb98-93"><a href="#cb98-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb98-94"><a href="#cb98-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb98-95"><a href="#cb98-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb98-96"><a href="#cb98-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span></span>
<span id="cb98-97"><a href="#cb98-97" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb98-98"><a href="#cb98-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb98-99"><a href="#cb98-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb98-100"><a href="#cb98-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Variance Components"</span>,</span>
<span id="cb98-101"><a href="#cb98-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#984EA3"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#FF7F00"</span>),</span>
<span id="cb98-102"><a href="#cb98-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Total Deviation"</span>, <span class="st">"Explained Variance"</span>, <span class="st">"Unexplained Variance"</span>)</span>
<span id="cb98-103"><a href="#cb98-103" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb98-104"><a href="#cb98-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-105"><a href="#cb98-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots with adjusted heights</span></span>
<span id="cb98-106"><a href="#cb98-106" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (p1 <span class="sc">/</span> p2) <span class="sc">+</span></span>
<span id="cb98-107"><a href="#cb98-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb98-108"><a href="#cb98-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-109"><a href="#cb98-109" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb98-110"><a href="#cb98-110" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="r²-wyjaśnione" class="level3" data-number="16.9.11">
<h3 data-number="16.9.11" class="anchored" data-anchor-id="r²-wyjaśnione"><span class="header-section-number">16.9.11</span> R² Wyjaśnione</h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>Myśl o R² jako o odpowiedzi na pytanie: “Jaki procent pierwotnej wariancji Y możemy wyjaśnić używając X?”</p>
<section id="intuicyjne-przykłady-1" class="level4" data-number="16.9.11.1">
<h4 data-number="16.9.11.1" class="anchored" data-anchor-id="intuicyjne-przykłady-1"><span class="header-section-number">16.9.11.1</span> Intuicyjne Przykłady:</h4>
<ul>
<li>R² = 0,80: Użycie X wyeliminowało 80% naszych błędów predykcji</li>
<li>R² = 0,25: Użycie X wyeliminowało 25% naszych błędów predykcji</li>
<li>R² = 0,00: Użycie X wcale nie pomogło</li>
</ul>
</section>
</section>
<section id="kiedy-zachować-ostrożność-1" class="level3" data-number="16.9.12">
<h3 data-number="16.9.12" class="anchored" data-anchor-id="kiedy-zachować-ostrożność-1"><span class="header-section-number">16.9.12</span> Kiedy Zachować Ostrożność</h3>
<ol type="1">
<li><strong>Wysoki R² To Nie Wszystko</strong>
<ul>
<li>Wysoki R² może wskazywać na przeuczenie</li>
<li>Zawsze sprawdzaj, czy twój model ma praktyczny sens</li>
<li>Weź pod uwagę kontekst swojej dziedziny</li>
</ul></li>
<li><strong>Niski R² Nie Zawsze Jest Zły</strong>
<ul>
<li>W niektórych dziedzinach R² = 0,30 może być imponujący</li>
<li>Nauki społeczne często mają niższe wartości R²</li>
<li>Skup się na znaczeniu praktycznym</li>
</ul></li>
<li><strong>Wielkość Próby Ma Znaczenie</strong>
<ul>
<li>Używaj skorygowanego R² dla regresji wielorakiej: <span class="math inline">R^2_{adj} = 1 - \frac{SSE/(n-p)}{SST/(n-1)}</span></li>
<li>Penalizuje dodawanie niepotrzebnych predyktorów</li>
</ul></li>
</ol>
</section>
<section id="praktyczne-wskazówki-do-analizy-1" class="level3" data-number="16.9.13">
<h3 data-number="16.9.13" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy-1"><span class="header-section-number">16.9.13</span> Praktyczne Wskazówki do Analizy</h3>
<ol type="1">
<li><strong>Inspekcja Wizualna</strong>
<ul>
<li>Zawsze wizualizuj swoje dane</li>
<li>Szukaj wzorców w resztach</li>
<li>Sprawdzaj punkty wpływowe</li>
</ul></li>
<li><strong>Uwzględnienie Kontekstu</strong>
<ul>
<li>Co jest “dobrym” R² w twojej dziedzinie?</li>
<li>Jaki jest praktyczny wpływ twoich błędów?</li>
<li>Czy twoje predyktory są znaczące?</li>
</ul></li>
<li><strong>Diagnostyka Modelu</strong>
<ul>
<li>Sprawdź normalność reszt</li>
<li>Szukaj heteroskedastyczności</li>
<li>Badaj punkty wpływowe</li>
</ul></li>
</ol>
</section>
<section id="kluczowe-wnioski-2" class="level3" data-number="16.9.14">
<h3 data-number="16.9.14" class="anchored" data-anchor-id="kluczowe-wnioski-2"><span class="header-section-number">16.9.14</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Dekompozycja wariancji pomaga zrozumieć poprawę predykcji</li>
<li>R² określa ilościowo proporcję wyjaśnionej wariancji</li>
<li>Zrozumienie wizualne jest kluczowe dla interpretacji</li>
<li>Kontekst jest ważniejszy niż bezwzględne wartości R²</li>
<li>Zawsze łącz R² z innymi narzędziami diagnostycznymi</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formalne wyprowadzenie estymatorów MNK
</div>
</div>
<div class="callout-body-container callout-body">
<section id="założenia-wstępne" class="level3" data-number="16.9.15">
<h3 data-number="16.9.15" class="anchored" data-anchor-id="założenia-wstępne"><span class="header-section-number">16.9.15</span> Założenia wstępne</h3>
<p>Chcemy znaleźć prostą <span class="math inline">y = \hat{\beta}_0 + \hat{\beta}_1x</span>, która minimalizuje sumę kwadratów reszt. Wyprowadźmy to krok po kroku:</p>
<ol type="1">
<li><p>Najpierw zapisujemy funkcję, którą chcemy zminimalizować:</p>
<p><span class="math inline">SSE = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p></li>
<li><p>Aby znaleźć minimum, musimy obliczyć pochodne cząstkowe względem <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> oraz przyrównać je do zera:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = 0</span> oraz <span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = 0</span></p></li>
</ol>
</section>
<section id="krok-1-znalezienie-hatbeta_0" class="level3" data-number="16.9.16">
<h3 data-number="16.9.16" class="anchored" data-anchor-id="krok-1-znalezienie-hatbeta_0"><span class="header-section-number">16.9.16</span> Krok 1: Znalezienie <span class="math inline">\hat{\beta}_0</span></h3>
<p>Obliczmy pochodną cząstkową względem <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = \frac{\partial}{\partial \hat{\beta}_0} \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)^2</span></p>
<p>Korzystając z reguły łańcuchowej:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)(-1) = 0</span></p>
<p>Upraszczając:</p>
<p><span class="math inline">-2\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p>
<p><span class="math inline">\sum_{i=1}^n y_i - n\hat{\beta}_0 - \hat{\beta}_1\sum_{i=1}^n x_i = 0</span></p>
<p>Rozwiązując względem <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">\hat{\beta}_0 = \frac{\sum_{i=1}^n y_i}{n} - \hat{\beta}_1\frac{\sum_{i=1}^n x_i}{n} = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Gdzie <span class="math inline">\bar{y}</span> i <span class="math inline">\bar{x}</span> to średnie z próby.</p>
</section>
<section id="krok-2-znalezienie-hatbeta_1" class="level3" data-number="16.9.17">
<h3 data-number="16.9.17" class="anchored" data-anchor-id="krok-2-znalezienie-hatbeta_1"><span class="header-section-number">16.9.17</span> Krok 2: Znalezienie <span class="math inline">\hat{\beta}_1</span></h3>
<p>Teraz obliczamy pochodną cząstkową względem <span class="math inline">\hat{\beta}_1</span>:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = \frac{\partial}{\partial \hat{\beta}_1} \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)^2</span></p>
<p>Korzystając z reguły łańcuchowej:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)(-x_i) = 0</span></p>
<p>Upraszczając:</p>
<p><span class="math inline">-2\sum_{i=1}^n x_i(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p>
<p>Podstawiając nasze wyrażenie na <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">-2\sum_{i=1}^n x_i(y_i - (\bar{y} - \hat{\beta}_1\bar{x}) - \hat{\beta}_1x_i) = 0</span></p>
<p><span class="math inline">\sum_{i=1}^n x_i(y_i - \bar{y} + \hat{\beta}_1\bar{x} - \hat{\beta}_1x_i) = 0</span></p>
<p>Po przekształceniach algebraicznych (rozwinięciu i zgrupowaniu wyrazów):</p>
<p><span class="math inline">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}</span></p>
</section>
<section id="wyniki-końcowe" class="level3" data-number="16.9.18">
<h3 data-number="16.9.18" class="anchored" data-anchor-id="wyniki-końcowe"><span class="header-section-number">16.9.18</span> Wyniki końcowe</h3>
<p>Wyprowadziliśmy estymatory MNK:</p>
<p><span class="math inline">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}</span></p>
<p><span class="math inline">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Zrozummy, co oznaczają te wzory:</p>
<ol type="1">
<li><p>Estymator nachylenia <span class="math inline">\hat{\beta}_1</span>:</p>
<ul>
<li>Licznik: Mierzy, jak <span class="math inline">x</span> i <span class="math inline">y</span> zmieniają się razem (kowariancja)</li>
<li>Mianownik: Mierzy, jak bardzo zmienia się <span class="math inline">x</span> (wariancja)</li>
<li>Więc <span class="math inline">\hat{\beta}_1</span> jest zasadniczo stosunkiem kowariancji do wariancji</li>
</ul></li>
<li><p>Estymator wyrazu wolnego <span class="math inline">\hat{\beta}_0</span>:</p>
<ul>
<li>Zapewnia, że prosta przechodzi przez punkt <span class="math inline">(\bar{x}, \bar{y})</span></li>
<li>Dostosowuje wysokość prostej na podstawie nachylenia</li>
</ul></li>
</ol>
</section>
<section id="weryfikacja-drugie-pochodne" class="level3" data-number="16.9.19">
<h3 data-number="16.9.19" class="anchored" data-anchor-id="weryfikacja-drugie-pochodne"><span class="header-section-number">16.9.19</span> Weryfikacja: Drugie pochodne</h3>
<p>Aby potwierdzić, że znaleźliśmy minimum (a nie maksimum), sprawdzamy drugie pochodne:</p>
<p><span class="math inline">\frac{\partial^2 SSE}{\partial \hat{\beta}_0^2} = 2n &gt; 0</span></p>
<p><span class="math inline">\frac{\partial^2 SSE}{\partial \hat{\beta}_1^2} = 2\sum_{i=1}^n x_i^2 &gt; 0</span></p>
<p>Ponieważ obie drugie pochodne są dodatnie, rzeczywiście znaleźliśmy minimum.</p>
</section>
<section id="postać-macierzowa-temat-zaawansowany-opcjonalny" class="level3" data-number="16.9.20">
<h3 data-number="16.9.20" class="anchored" data-anchor-id="postać-macierzowa-temat-zaawansowany-opcjonalny"><span class="header-section-number">16.9.20</span> Postać macierzowa (Temat zaawansowany, opcjonalny)</h3>
<p>Dla osób znających algebrę liniową, możemy zapisać to zwięźlej:</p>
<p><span class="math inline">\mathbf{X} = \begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ \vdots &amp; \vdots \\ 1 &amp; x_n \end{bmatrix}</span></p>
<p><span class="math inline">\mathbf{y} = \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix}</span></p>
<p>Wtedy estymator MNK w postaci macierzowej to:</p>
<p><span class="math inline">\hat{\boldsymbol{\beta}} = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{y}</span></p>
<p>To daje nam zarówno <span class="math inline">\hat{\beta}_0</span> jak i <span class="math inline">\hat{\beta}_1</span> w jednym eleganckim wyrażeniu.</p>
</section>
<section id="wizualizacja-wyprowadzenia" class="level3" data-number="16.9.21">
<h3 data-number="16.9.21" class="anchored" data-anchor-id="wizualizacja-wyprowadzenia"><span class="header-section-number">16.9.21</span> Wizualizacja wyprowadzenia</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie średnich</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>x_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>y_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wizualizacji odchyleń</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> y_srednia, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x_srednia, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> y_srednia), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> y, <span class="at">xend =</span> x_srednia), <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wizualizacja odchyleń od średnich"</span>,</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Zielone: Odchylenia w y, Fioletowe: Odchylenia w x"</span>,</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Powyższy wykres pokazuje, jak działają estymatory MNK z odchyleniami od średnich. Iloczyn tych odchyleń (zielone × fioletowe) dla każdego punktu, zsumowany i znormalizowany, daje nam nasz estymator nachylenia <span class="math inline">\hat{\beta}_1</span>.</p>
</section>
<section id="ważne-uwagi-1" class="level3" data-number="16.9.22">
<h3 data-number="16.9.22" class="anchored" data-anchor-id="ważne-uwagi-1"><span class="header-section-number">16.9.22</span> Ważne uwagi</h3>
<ol type="1">
<li><p>Wyprowadzone estymatory są BLUE (Best Linear Unbiased Estimators - Najlepsze Liniowe Nieobciążone Estymatory) przy spełnieniu założeń Gaussa-Markowa.</p></li>
<li><p>Założenia te obejmują:</p>
<ul>
<li>Liniowość zależności</li>
<li>Losowość próby</li>
<li>Brak współliniowości idealnej</li>
<li>Homoskedastyczność (stała wariancja reszt)</li>
<li>Niezależność obserwacji</li>
</ul></li>
<li><p>Metoda ta minimalizuje sumę kwadratów reszt w kierunku pionowym (odchylenia w <span class="math inline">y</span>), a nie prostopadłym do prostej.</p></li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Endogeniczność w Regresji
</div>
</div>
<div class="callout-body-container callout-body">
<p>Endogeniczność to kluczowe pojęcie w analizie statystycznej, występujące gdy zmienna objaśniająca w modelu regresji jest skorelowana ze składnikiem resztowym. Stwarza to wyzwania w dokładnym zrozumieniu związków przyczynowo-skutkowych w badaniach. Przyjrzyjmy się trzem głównym typom endogeniczności i ich wpływowi na wyniki badań.</p>
<section id="obciążenie-zmiennej-pominiętej-ovb" class="level3" data-number="16.9.23">
<h3 data-number="16.9.23" class="anchored" data-anchor-id="obciążenie-zmiennej-pominiętej-ovb"><span class="header-section-number">16.9.23</span> 1. Obciążenie Zmiennej Pominiętej (OVB)</h3>
<p>Obciążenie zmiennej pominiętej występuje, gdy ważna zmienna wpływająca zarówno na zmienną zależną, jak i niezależną, zostaje pominięta w analizie. To pominięcie prowadzi do błędnych wniosków o relacji między badanymi zmiennymi.</p>
<p>Rozważmy badanie związku między wykształceniem a dochodami:</p>
<p><strong>Przykład: Wykształcenie i Dochody</strong> Obserwowana relacja pokazuje, że wyższe wykształcenie koreluje z wyższymi dochodami. Jednak naturalne zdolności jednostki wpływają zarówno na poziom wykształcenia, jak i na potencjał zarobkowy. Bez uwzględnienia zdolności możemy przeszacować bezpośredni wpływ edukacji na dochody.</p>
<p>Reprezentacja statystyczna pokazuje, dlaczego to jest istotne:</p>
<p><span class="math inline">y_i = \beta_0 + \beta_1x_i + \beta_2z_i + \epsilon_i</span> (Model pełny)</p>
<p><span class="math inline">y_i = \beta_0 + \beta_1x_i + u_i</span> (Model niepełny)</p>
<p>Gdy pomijamy istotną zmienną, nasze oszacowania pozostałych relacji stają się obciążone i niewiarygodne.</p>
</section>
<section id="jednoczesność" class="level3" data-number="16.9.24">
<h3 data-number="16.9.24" class="anchored" data-anchor-id="jednoczesność"><span class="header-section-number">16.9.24</span> 2. Jednoczesność</h3>
<p>Jednoczesność występuje, gdy dwie zmienne wzajemnie na siebie wpływają, co utrudnia określenie kierunku przyczynowości. Tworzy to pętlę sprzężenia zwrotnego komplikującą analizę statystyczną.</p>
<p><strong>Typowe Przykłady Jednoczesności:</strong></p>
<p>Wyniki w nauce i nawyki uczenia się stanowią wyraźny przypadek jednoczesności. Wyniki akademickie wpływają na ilość czasu, który studenci poświęcają na naukę, podczas gdy czas nauki wpływa na wyniki akademickie. Ta dwukierunkowa relacja utrudnia pomiar izolowanego wpływu każdej zmiennej.</p>
<p>Dynamika rynkowa dostarcza kolejnego przykładu. Ceny wpływają na popyt, podczas gdy popyt wpływa na ceny. Ta równoczesna relacja wymaga specjalnych podejść analitycznych.</p>
</section>
<section id="błąd-pomiaru-1" class="level3" data-number="16.9.25">
<h3 data-number="16.9.25" class="anchored" data-anchor-id="błąd-pomiaru-1"><span class="header-section-number">16.9.25</span> 3. Błąd Pomiaru</h3>
<p>Błąd pomiaru występuje, gdy nie możemy dokładnie zmierzyć naszych zmiennych. Ta niedokładność może znacząco wpłynąć na naszą analizę i wnioski.</p>
<p><strong>Typowe Źródła Błędu Pomiaru:</strong></p>
<p>Dane samodzielnie raportowane stanowią znaczące wyzwanie. Gdy uczestnicy raportują własne zachowania lub cechy, na przykład czas nauki, zgłaszane wartości często różnią się od rzeczywistych. Ta rozbieżność wpływa na naszą zdolność do pomiaru prawdziwych relacji.</p>
<p>Ograniczenia techniczne również przyczyniają się do błędu pomiaru poprzez niedokładne narzędzia pomiarowe, niespójne warunki pomiaru oraz błędy zapisu lub wprowadzania danych.</p>
</section>
<section id="rozwiązywanie-problemu-endogeniczności-w-badaniach" class="level3" data-number="16.9.26">
<h3 data-number="16.9.26" class="anchored" data-anchor-id="rozwiązywanie-problemu-endogeniczności-w-badaniach"><span class="header-section-number">16.9.26</span> Rozwiązywanie Problemu Endogeniczności w Badaniach</h3>
<section id="strategie-identyfikacji" class="level4" data-number="16.9.26.1">
<h4 data-number="16.9.26.1" class="anchored" data-anchor-id="strategie-identyfikacji"><span class="header-section-number">16.9.26.1</span> Strategie Identyfikacji</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykład kontrolowania zmiennych pominiętych</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>model_prosty <span class="ot">&lt;-</span> <span class="fu">lm</span>(dochod <span class="sc">~</span> wyksztalcenie, <span class="at">data =</span> df)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>model_pelny <span class="ot">&lt;-</span> <span class="fu">lm</span>(dochod <span class="sc">~</span> wyksztalcenie <span class="sc">+</span> zdolnosci <span class="sc">+</span> doswiadczenie <span class="sc">+</span> region, <span class="at">data =</span> df)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie współczynników</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_prosty)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_pelny)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><p>Włączenie Dodatkowych Zmiennych: Zbieranie danych o potencjalnie ważnych pominiętych zmiennych i uwzględnianie odpowiednich zmiennych kontrolnych w analizie. Na przykład, uwzględnienie miar zdolności przy badaniu wpływu edukacji na dochody.</p></li>
<li><p>Wykorzystanie Danych Panelowych: Zbieranie danych w wielu okresach czasu w celu kontrolowania nieobserwowanych stałych charakterystyk i analizy zmian w czasie.</p></li>
<li><p>Zmienne Instrumentalne: Znalezienie zmiennych, które wpływają na zmienną niezależną, ale nie na zależną, aby wyizolować badaną relację.</p></li>
</ol>
</section>
<section id="poprawa-pomiaru" class="level4" data-number="16.9.26.2">
<h4 data-number="16.9.26.2" class="anchored" data-anchor-id="poprawa-pomiaru"><span class="header-section-number">16.9.26.2</span> Poprawa Pomiaru</h4>
<ol type="1">
<li><p>Wielokrotne Pomiary: Wykonywanie kilku pomiarów kluczowych zmiennych, używanie uśredniania do redukcji błędu losowego i porównywanie różnych metod pomiaru.</p></li>
<li><p>Lepsza Metoda Zbierania Danych: Używanie zwalidowanych instrumentów pomiarowych, wdrażanie procedur kontroli jakości i dokumentowanie potencjalnych źródeł błędu.</p></li>
</ol>
</section>
</section>
<section id="najlepsze-praktyki-dla-badaczy" class="level3" data-number="16.9.27">
<h3 data-number="16.9.27" class="anchored" data-anchor-id="najlepsze-praktyki-dla-badaczy"><span class="header-section-number">16.9.27</span> Najlepsze Praktyki dla Badaczy</h3>
<p>Projekt badania fundamentalnie kształtuje możliwość rozwiązania problemu endogeniczności. Należy planować potencjalne problemy endogeniczności przed zbieraniem danych, uwzględniać miary potencjalnie ważnych zmiennych kontrolnych i rozważać wykorzystanie wielu podejść pomiarowych.</p>
<p>Analiza powinna obejmować testowanie endogeniczności gdy to możliwe, stosowanie odpowiednich metod statystycznych dla konkretnej sytuacji i dokumentowanie założeń oraz ograniczeń.</p>
<p>Raportowanie musi jasno opisywać potencjalne problemy endogeniczności, wyjaśniać jak zostały one rozwiązane i omawiać implikacje dla wniosków.</p>
</section>
</div>
</div>
</section>
</section>
<section id="regresja-wieloraka" class="level2" data-number="16.10">
<h2 data-number="16.10" class="anchored" data-anchor-id="regresja-wieloraka"><span class="header-section-number">16.10</span> Regresja Wieloraka (*)</h2>
<section id="rozszerzenie-do-wielu-predyktorów" class="level3" data-number="16.10.1">
<h3 data-number="16.10.1" class="anchored" data-anchor-id="rozszerzenie-do-wielu-predyktorów"><span class="header-section-number">16.10.1</span> Rozszerzenie do Wielu Predyktorów</h3>
<p>Model regresji wielorakiej rozszerza nasz prosty model o kilka predyktorów:</p>
<p>Model Populacyjny: <span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + ... + \beta_kX_k + \varepsilon</span></p>
<p>Oszacowanie Próbkowe: <span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X_1 + \hat{\beta}_2X_2 + ... + \hat{\beta}_kX_k</span></p>
<p>Stwórzmy przykład z wieloma predyktorami:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data with two predictors</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">105</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>data_multiple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2)</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit multiple regression model</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>model_multiple <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_multiple)</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 3D visualization using scatter plots</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X1"</span>)</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X2"</span>)</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/multiple-regression-example-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Regresji Wielorakiej</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_multiple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X1 + X2, data = data_multiple)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.8598  -3.6005   0.1166   3.0892  14.6102 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.77567    4.01351   2.934  0.00418 ** 
X1           0.45849    0.05992   7.651 1.47e-11 ***
X2           0.81639    0.11370   7.180 1.42e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.122 on 97 degrees of freedom
Multiple R-squared:  0.5062,    Adjusted R-squared:  0.4961 
F-statistic: 49.72 on 2 and 97 DF,  p-value: 1.367e-15</code></pre>
</div>
</div>
</section>
<section id="interpretacja-współczynników" class="level3" data-number="16.10.2">
<h3 data-number="16.10.2" class="anchored" data-anchor-id="interpretacja-współczynników"><span class="header-section-number">16.10.2</span> Interpretacja Współczynników</h3>
<p>W regresji wielorakiej, każdy <span class="math inline">\hat{\beta}_k</span> reprezentuje oczekiwaną zmianę w Y przy jednostkowym wzroście <span class="math inline">X_k</span>, przy utrzymaniu wszystkich innych zmiennych na stałym poziomie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X1 (holding X2 at its mean)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>X1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X1), <span class="fu">max</span>(X1), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>pred_data_X1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_grid,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">mean</span>(X2)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>pred_data_X1<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X1)</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X2 (holding X1 at its mean)</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>X2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2), <span class="fu">max</span>(X2), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>pred_data_X2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> <span class="fu">mean</span>(X1),</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_grid</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>pred_data_X2<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X2)</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot partial effects</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X1, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y_pred), </span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Cząstkowy X1"</span>,</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X2 utrzymane na średniej ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X2), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X2, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred), </span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Cząstkowy X2"</span>,</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X1 utrzymane na średniej ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X1), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/coefficient-interpretation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efekty Cząstkowe w Regresji Wielorakiej</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="współliniowość" class="level3" data-number="16.10.3">
<h3 data-number="16.10.3" class="anchored" data-anchor-id="współliniowość"><span class="header-section-number">16.10.3</span> Współliniowość</h3>
<p>Współliniowość występuje, gdy predyktory są silnie skorelowane. Zobaczmy jej efekty:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with multicollinearity</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>X1_new <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>X2_new <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)  <span class="co"># X2 silnie skorelowane z X1</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>Y_new <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>data_collinear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y_new, <span class="at">X1 =</span> X1_new, <span class="at">X2 =</span> X2_new)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with multicollinearity</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>model_collinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_collinear)</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate VIF</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>vif_results <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_collinear)</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_collinear, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2)) <span class="sc">+</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Korelacja między Predyktorami"</span>,</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Korelacja ="</span>, </span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">round</span>(<span class="fu">cor</span>(X1_new, X2_new), <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/multicollinearity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efekty Współliniowości</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="tematy-zaawansowane" class="level2" data-number="16.11">
<h2 data-number="16.11" class="anchored" data-anchor-id="tematy-zaawansowane"><span class="header-section-number">16.11</span> Tematy Zaawansowane</h2>
<section id="efekty-interakcji" class="level3" data-number="16.11.1">
<h3 data-number="16.11.1" class="anchored" data-anchor-id="efekty-interakcji"><span class="header-section-number">16.11.1</span> Efekty Interakcji</h3>
<p>Efekty interakcji pozwalają na to, by wpływ jednego predyktora zależał od innego:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \beta_3(X_1 \times X_2) + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with interaction</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>X1_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>X2_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>Y_int <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X1_int <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X2_int <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>X1_int<span class="sc">*</span>X2_int <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>data_int <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> X1_int, <span class="at">X2 =</span> X2_int, <span class="at">Y =</span> Y_int)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>model_int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">*</span> X2, <span class="at">data =</span> data_int)</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction plot</span></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>X1_levels <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X1_int, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>X2_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2_int), <span class="fu">max</span>(X2_int), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_levels,</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_seq</span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_int, <span class="at">newdata =</span> pred_data)</span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>X1_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_data<span class="sc">$</span>X1, </span>
<span id="cb109-20"><a href="#cb109-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Niskie X1"</span>, <span class="st">"Wysokie X1"</span>))</span>
<span id="cb109-21"><a href="#cb109-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-22"><a href="#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred, <span class="at">color =</span> X1_level)) <span class="sc">+</span></span>
<span id="cb109-23"><a href="#cb109-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb109-24"><a href="#cb109-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb109-25"><a href="#cb109-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Interakcji"</span>,</span>
<span id="cb109-26"><a href="#cb109-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wpływ X2 zależy od poziomu X1"</span>,</span>
<span id="cb109-27"><a href="#cb109-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Poziom X1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/interactions-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wizualizacja Efektów Interakcji</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="wyrazy-wielomianowe" class="level3" data-number="16.11.2">
<h3 data-number="16.11.2" class="anchored" data-anchor-id="wyrazy-wielomianowe"><span class="header-section-number">16.11.2</span> Wyrazy Wielomianowe</h3>
<p>Gdy zależności są nieliniowe, możemy dodać wyrazy wielomianowe:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \beta_2X^2 + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with quadratic relationship</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">108</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>X_poly <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>Y_poly <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>X_poly <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X_poly<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(X_poly), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>data_poly <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X_poly, <span class="at">Y =</span> Y_poly)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear and quadratic models</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data_poly)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>model_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data_poly)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_linear <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_linear)</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_quad <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_quad)</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_poly, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_linear, <span class="at">color =</span> <span class="st">"Liniowy"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_quad, <span class="at">color =</span> <span class="st">"Kwadratowy"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dopasowanie Liniowe vs Kwadratowe"</span>,</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Typ Modelu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/polynomial-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Regresji Wielomianowej</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="praktyczne-wskazówki-do-analizy-regresji" class="level2" data-number="16.12">
<h2 data-number="16.12" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy-regresji"><span class="header-section-number">16.12</span> Praktyczne Wskazówki do Analizy Regresji</h2>
<section id="proces-budowy-modelu" class="level3" data-number="16.12.1">
<h3 data-number="16.12.1" class="anchored" data-anchor-id="proces-budowy-modelu"><span class="header-section-number">16.12.1</span> Proces Budowy Modelu</h3>
<ol type="1">
<li><strong>Eksploracja Danych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example dataset</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>data_example <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x3 =</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>data_example<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>data_example<span class="sc">$</span>x1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>data_example<span class="sc">$</span>x2 <span class="sc">-</span> </span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fl">0.3</span><span class="sc">*</span>data_example<span class="sc">$</span>x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix plot</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_example) <span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Analiza Eksploracyjna Danych"</span>,</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Macierz korelacji i rozkłady"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/data-exploration-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Eksploracji Danych</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Wybór Zmiennych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models with different variables</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> data_example)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data_example)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"y ~ x1"</span>, <span class="st">"y ~ x1 + x2"</span>, <span class="st">"y ~ x1 + x2 + x3"</span>),</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>r.squared,</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model2)<span class="sc">$</span>r.squared,</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model3)<span class="sc">$</span>r.squared),</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skorygowany_R_kwadrat =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model3)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(models_comparison, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Podsumowanie Porównania Modeli"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Podsumowanie Porównania Modeli</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">R_kwadrat</th>
<th style="text-align: right;">Skorygowany_R_kwadrat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ x1</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.316</td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ x1 + x2</td>
<td style="text-align: right;">0.433</td>
<td style="text-align: right;">0.421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y ~ x1 + x2 + x3</td>
<td style="text-align: right;">0.893</td>
<td style="text-align: right;">0.890</td>
</tr>
</tbody>
</table>
<p>Proces Wyboru Zmiennych</p>
</div>
</div>
</section>
<section id="typowe-pułapki-i-rozwiązania" class="level3" data-number="16.12.2">
<h3 data-number="16.12.2" class="anchored" data-anchor-id="typowe-pułapki-i-rozwiązania"><span class="header-section-number">16.12.2</span> Typowe Pułapki i Rozwiązania</h3>
<ol type="1">
<li><strong>Wartości Odstające i Punkty Wpływowe</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with outlier</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>x_clean <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>y_clean <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_clean <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_clean, <span class="at">y =</span> y_clean)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add outlier</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>data_outlier <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_clean,</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>))</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>model_clean <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_clean)</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>model_outlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_outlier)</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_clean, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_outlier[<span class="dv">51</span>,], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_clean, </span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_clean), </span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Bez Wartości Odstającej"</span>)) <span class="sc">+</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_outlier, </span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_outlier), </span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Z Wartością Odstającą"</span>)) <span class="sc">+</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wpływ Wartości Odstających na Regresję"</span>,</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/outliers-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Identyfikacja i Obsługa Wartości Odstających</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Wzorce Brakujących Danych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with missing values</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>data_missing <span class="ot">&lt;-</span> data_example</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x2[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">15</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x3[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">20</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing patterns</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_missing) <span class="sc">+</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wzorce Brakujących Danych"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/missing-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wzorce Brakujących Danych</figcaption>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li><strong>Heteroskedastyczność</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate heteroscedastic data</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>x_hetero <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>y_hetero <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x_hetero <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fu">abs</span>(x_hetero)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>data_hetero <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_hetero, <span class="at">y =</span> y_hetero)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>model_hetero <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_hetero)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dane Heteroskedastyczne"</span>)</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model_hetero), </span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="fu">residuals</span>(model_hetero))) <span class="sc">+</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wykres Reszt"</span>,</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wartości dopasowane"</span>,</span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reszty"</span>)</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/heteroscedasticity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wykrywanie i Wizualizacja Heteroskedastyczności</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="najlepsze-praktyki" class="level2" data-number="16.13">
<h2 data-number="16.13" class="anchored" data-anchor-id="najlepsze-praktyki"><span class="header-section-number">16.13</span> Najlepsze Praktyki</h2>
<section id="walidacja-modelu" class="level3" data-number="16.13.1">
<h3 data-number="16.13.1" class="anchored" data-anchor-id="walidacja-modelu"><span class="header-section-number">16.13.1</span> Walidacja Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple cross-validation example</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">113</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create training and test sets</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_example), <span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(data_example))</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_example[train_index, ]</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_example[<span class="sc">-</span>train_index, ]</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model on training data</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>model_train <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> train_data)</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_train, <span class="at">newdata =</span> test_data)</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> test_data<span class="sc">$</span>y</span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate performance metrics</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> actual))</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(predictions, actual)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predictions vs actual</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>data_validation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> predictions,</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> actual</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_validation, <span class="fu">aes</span>(<span class="at">x =</span> Rzeczywiste, <span class="at">y =</span> Przewidywane)) <span class="sc">+</span></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Walidacja Modelu: Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE = %.2f, MAE = %.2f, R² = %.2f"</span>, </span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>                         rmse, mae, r2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/model-validation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Walidacji Krzyżowej</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="prezentacja-wyników" class="level3" data-number="16.13.2">
<h3 data-number="16.13.2" class="anchored" data-anchor-id="prezentacja-wyników"><span class="header-section-number">16.13.2</span> Prezentacja Wyników</h3>
<p>Przykład profesjonalnej tabeli wyników regresji:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create regression results table</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>model_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model_final, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(results, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Podsumowanie Wyników Regresji"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Podsumowanie Wyników Regresji</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">9.116</td>
<td style="text-align: right;">2.835</td>
<td style="text-align: right;">3.216</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">3.489</td>
<td style="text-align: right;">14.743</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">12.756</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.574</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">10.468</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">1.077</td>
</tr>
<tr class="even">
<td style="text-align: left;">x3</td>
<td style="text-align: right;">-0.324</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-20.322</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.356</td>
<td style="text-align: right;">-0.292</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="podsumowanie-1" class="level2" data-number="16.14">
<h2 data-number="16.14" class="anchored" data-anchor-id="podsumowanie-1"><span class="header-section-number">16.14</span> Podsumowanie</h2>
<section id="kluczowe-wnioski-3" class="level3" data-number="16.14.1">
<h3 data-number="16.14.1" class="anchored" data-anchor-id="kluczowe-wnioski-3"><span class="header-section-number">16.14.1</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Zawsze zaczynaj od eksploracyjnej analizy danych</li>
<li>Sprawdzaj założenia przed interpretacją wyników</li>
<li>Bądź świadomy typowych pułapek:
<ul>
<li>Wartości odstające</li>
<li>Brakujące dane</li>
<li>Współliniowość</li>
<li>Heteroskedastyczność</li>
</ul></li>
<li>Waliduj swój model używając:
<ul>
<li>Wykresów diagnostycznych</li>
<li>Walidacji krzyżowej</li>
<li>Analizy reszt</li>
</ul></li>
<li>Prezentuj wyniki jasno i kompletnie</li>
</ol>
</section>
<section id="literatura-uzupełniająca" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="literatura-uzupełniająca">Literatura Uzupełniająca</h3>
<p>Dla głębszego zrozumienia:</p>
<ul>
<li>Wooldridge, J.M. “Wprowadzenie do Ekonometrii: Współczesne Ujęcie”</li>
<li>Fox, J. “Analiza Regresji Stosowana i Uogólnione Modele Liniowe”</li>
<li>Angrist, J.D. i Pischke, J.S. “W Większości Nieszkodliwa Ekonometria”</li>
<li>Stock &amp; Watson “Wprowadzenie do Ekonometrii”</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zrozumienie Regresji Metodą Najmniejszych Kwadratów (OLS): Podsumowanie dla Studentów
</div>
</div>
<div class="callout-body-container callout-body">
<p>Analiza regresji to podstawowa metoda statystyczna, która bada i modeluje zależności między zmiennymi w celu zrozumienia, jak zmiany w jednej lub kilku zmiennych niezależnych wpływają na zmienną zależną.</p>
<p>W swojej istocie analiza regresji pomaga odpowiedzieć na pytania dotyczące przyczyny i skutku, przewidywania oraz prognozowania. Na przykład, przedsiębiorstwo może wykorzystać analizę regresji do zrozumienia, jak wydatki na reklamę wpływają na sprzedaż lub jak liczba godzin szkoleń pracowników przekłada się na produktywność.</p>
<section id="regresja-jako-model-stochastyczny-1" class="level3" data-number="16.14.2">
<h3 data-number="16.14.2" class="anchored" data-anchor-id="regresja-jako-model-stochastyczny-1"><span class="header-section-number">16.14.2</span> Regresja jako Model Stochastyczny</h3>
<p>W modelowaniu matematycznym spotykamy dwa podstawowe podejścia do opisywania relacji między zmiennymi:</p>
<ul>
<li>modele deterministyczne,</li>
<li>modele stochastyczne.</li>
</ul>
<section id="modele-deterministyczne-a-stochastyczne-1" class="level4" data-number="16.14.2.1">
<h4 data-number="16.14.2.1" class="anchored" data-anchor-id="modele-deterministyczne-a-stochastyczne-1"><span class="header-section-number">16.14.2.1</span> Modele Deterministyczne a Stochastyczne</h4>
<p>Model deterministyczny zakłada precyzyjną, ustaloną relację między danymi wejściowymi a wyjściowymi. W takich modelach, znając dane wejściowe, możemy z całkowitą pewnością obliczyć dokładny wynik. Weźmy pod uwagę klasyczne równanie fizyczne dotyczące drogi:</p>
<p><span class="math display">\text{Droga} = \text{Prędkość} × \text{Czas}</span></p>
<p>Przy określonych wartościach prędkości i czasu, równanie to zawsze da tę samą drogę. Nie ma tu miejsca na jakąkolwiek zmienność wyniku.</p>
<p>W przeciwieństwie do tego, analiza regresji uwzględnia naturalną zmienność danych. Podstawowa struktura modelu regresji to:</p>
<p><span class="math display">Y = f(X) + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y</span> reprezentuje wynik, który chcemy przewidzieć</li>
<li><span class="math inline">f(X)</span> reprezentuje systematyczną relację między naszymi predyktorami (X) a wynikiem</li>
<li><span class="math inline">\epsilon</span> reprezentuje losową zmienność naturalnie występującą w rzeczywistych danych</li>
</ul>
</section>
</section>
<section id="czym-jest-prosta-regresja-liniowa" class="level3" data-number="16.14.3">
<h3 data-number="16.14.3" class="anchored" data-anchor-id="czym-jest-prosta-regresja-liniowa"><span class="header-section-number">16.14.3</span> Czym jest Prosta Regresja Liniowa?</h3>
<p>Rozważmy związek między <strong>czasem poświęconym na naukę</strong> (predyktor, zmienna niezależna) a <strong>wynikami egzaminów</strong> (zmienna objaśniana, outcome/response variable). Prosta regresja liniowa tworzy optymalną linię prostą przechodzącą przez punkty danych, modelującą tę relację. Linia ta służy dwóm celom: prognozowaniu oraz kwantyfikacji związku między zmiennymi.</p>
<p>Zależność matematyczna jest wyrażona jako:</p>
<p><span class="math display"> Y_i = \beta_0 + \beta_1X_i + \epsilon_i </span></p>
<p>Używając naszego przykładu z czasem nauki do zilustrowania każdego składnika:</p>
<ul>
<li><span class="math inline">Y_i</span> reprezentuje zmienną zależną (wyniki egzaminów)</li>
<li><span class="math inline">X_i</span> reprezentuje zmienną niezależną (godziny nauki)</li>
<li><span class="math inline">\beta_0</span> reprezentuje wyraz wolny - oczekiwany wynik egzaminu przy zerowym czasie nauki</li>
<li><span class="math inline">\beta_1</span> reprezentuje nachylenie - zmianę wyniku egzaminu na każdą dodatkową godzinę nauki</li>
<li><span class="math inline">\epsilon_i</span> reprezentuje składnik błędu, uwzględniający nieobserwowane czynniki</li>
</ul>
<p>Naszym celem jest znalezienie oszacowań <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span>, które najlepiej przybliżają prawdziwe parametry <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>. Dopasowana linia regresji jest wtedy wyrażona jako:</p>
<p><span class="math display"> \hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1X_i </span></p>
</section>
<section id="metoda-najmniejszych-kwadratów-mnkols" class="level3" data-number="16.14.4">
<h3 data-number="16.14.4" class="anchored" data-anchor-id="metoda-najmniejszych-kwadratów-mnkols"><span class="header-section-number">16.14.4</span> Metoda Najmniejszych Kwadratów (MNK/OLS)</h3>
<p>Metoda “Najmniejszych Kwadratów” określa optymalne wartości dla <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> poprzez metodyczny proces. Choć współczesne oprogramowanie statystyczne wykonuje te obliczenia automatycznie, zrozumienie podstawowego procesu jest kluczowe:</p>
<ol type="1">
<li>Rozpocznij od wstępnego oszacowania linii regresji
<ul>
<li>Zazwyczaj zaczynamy od linii poziomej na poziomie <span class="math inline">\bar{Y}</span> (średnia Y)</li>
<li>Służy to jako punkt odniesienia, reprezentujący brak związku między X a Y</li>
</ul></li>
<li>Oblicz odległości pionowe (reszty) od każdego obserwowanego punktu do tej linii
<ul>
<li>Te reszty <span class="math inline">\hat{\epsilon}_i = e_i = Y_i - \hat{Y}_i</span> reprezentują nasze błędy predykcji</li>
<li>Dodatnia reszta oznacza, że nasza linia niedoszacowuje prawdziwej wartości</li>
<li>Ujemna reszta oznacza, że nasza linia przeszacowuje prawdziwą wartość</li>
</ul></li>
<li>Podnieś te odległości do kwadratu, aby:
<ul>
<li>Zapewnić, że dodatnie i ujemne odchylenia się nie znoszą</li>
<li>Przypisać większą wagę większym odchyleniom</li>
</ul></li>
<li>Zsumuj wszystkie kwadraty odległości, aby otrzymać Sumę Kwadratów Błędów (SSE)
<ul>
<li><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2</span></li>
<li>Reprezentuje to całkowite kwadratowe odchylenie obserwowanych wartości od naszych przewidywanych wartości</li>
</ul></li>
<li>Systematycznie dostosowuj nachylenie i wyraz wolny linii, aby zminimalizować SSE:</li>
</ol>
<ul>
<li>Proces polega na stopniowym modyfikowaniu nachylenia i położenia linii, obserwując jak zmienia się suma kwadratów odchyłek (SSE) [formalnie wymaga to zastosowania pojęć z rachunku różniczkowego]</li>
<li>Gdy SSE przestaje się zmniejszać przy kolejnych niewielkich zmianach parametrów linii, oznacza to znalezienie optymalnego dopasowania</li>
<li>To miejsce odpowiada najmniejszej możliwej wartości SSE, czyli najlepszemu dopasowaniu linii do danych</li>
</ul>
<p>Bardziej formalnie, MNK (Metoda Najmniejszych Kwadratów) znajduje optymalne wartości dla <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> poprzez minimalizację sumy kwadratów błędów:</p>
<p><span class="math display">\min_{\beta_0, \beta_1} \sum \epsilon_i^2 = \min_{\beta_0, \beta_1} \sum(y_i - \hat{y_i})^2 = \min_{\beta_0, \beta_1} \sum(y_i - (\beta_0 + \beta_1x_i))^2</span></p>
<p>Rozwiązanie tego problemu minimalizacji daje nam:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sum(x_i - \bar{x})^2} = \frac{cov(X, Y)}{var(X)}</span> <span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Warto zauważyć, że w powyższych wzorach <span class="math inline">\hat{\beta}_1</span> reprezentuje nachylenie linii regresji i jest wyrażone jako stosunek kowariancji zmiennych X i Y do wariancji zmiennej X. Natomiast <span class="math inline">\hat{\beta}_0</span> to wyraz wolny (punkt przecięcia z osią Y), który możemy obliczyć używając średnich wartości zmiennych X i Y oraz już oszacowanego nachylenia. Symbol <span class="math inline">\bar{x}</span> oznacza średnią wartość zmiennej X, a <span class="math inline">\bar{y}</span> średnią wartość zmiennej Y.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estymacja-parametrów" class="level3" data-number="16.14.5">
<h3 data-number="16.14.5" class="anchored" data-anchor-id="estymacja-parametrów"><span class="header-section-number">16.14.5</span> Estymacja Parametrów</h3>
<p>Formuły do oszacowania parametrów wykorzystują podstawowe miary statystyczne:</p>
<p><span class="math display"> \hat{\beta}_1 = \frac{Cov(X,Y)}{Var(X)} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2} </span></p>
<p>Ta formuła zawiera dwa istotne pojęcia statystyczne:</p>
<ul>
<li>Kowariancja (<span class="math inline">Cov</span>) kwantyfikuje wspólny ruch X i Y</li>
<li>Wariancja (<span class="math inline">Var</span>) mierzy rozproszenie wartości X wokół ich średniej</li>
<li><span class="math inline">\bar{X}</span> i <span class="math inline">\bar{Y}</span> reprezentują odpowiednio średnie X i Y</li>
</ul>
<p>Po obliczeniu <span class="math inline">\hat{\beta}_1</span> określamy <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math display"> \hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X} </span></p>
<p>Zapewnia to, że linia regresji przechodzi przez punkt średnich (<span class="math inline">\bar{X}</span>, <span class="math inline">\bar{Y}</span>).</p>
</section>
<section id="dekompozycja-wariancji-w-regresji" class="level3" data-number="16.14.6">
<h3 data-number="16.14.6" class="anchored" data-anchor-id="dekompozycja-wariancji-w-regresji"><span class="header-section-number">16.14.6</span> Dekompozycja Wariancji w Regresji</h3>
<p>W analizie regresji rozkładamy wariancję w naszych danych na odrębne składniki, aby zrozumieć, jak dobrze nasz model wyjaśnia zmienną zależną. Przyjrzyjmy się każdemu składnikowi wariancji szczegółowo.</p>
<section id="przegląd-składników-wariancji" class="level4" data-number="16.14.6.1">
<h4 data-number="16.14.6.1" class="anchored" data-anchor-id="przegląd-składników-wariancji"><span class="header-section-number">16.14.6.1</span> Przegląd Składników Wariancji</h4>
<p>Całkowita Suma Kwadratów (SST, z ang. Total Sum of Squares) reprezentuje całkowitą zmienność obecną w naszej zmiennej zależnej. Regresyjna Suma Kwadratów (SSR, z ang. Regression Sum of Squares) obejmuje zmienność wyjaśnioną przez nasz model. Resztowa Suma Kwadratów (SSE, z ang. Error Sum of Squares) przedstawia pozostałą, niewyjaśnioną zmienność. Przeanalizujmy każdy z tych elementów.</p>
</section>
<section id="całkowita-suma-kwadratów-sst" class="level4" data-number="16.14.6.2">
<h4 data-number="16.14.6.2" class="anchored" data-anchor-id="całkowita-suma-kwadratów-sst"><span class="header-section-number">16.14.6.2</span> Całkowita Suma Kwadratów (SST)</h4>
<p>SST mierzy całkowitą zmienność w zmiennej zależnej, obliczając, jak bardzo każda obserwacja odbiega od średniej ogólnej:</p>
<p><span class="math display"> SST = \sum(y_i - \bar{y})^2 </span></p>
<p>W tym wzorze <span class="math inline">y_i</span> reprezentuje każdą pojedynczą obserwację, a <span class="math inline">\bar{y}</span> reprezentuje średnią wszystkich obserwacji. Kwadraty różnic ujmują całkowitą rozpiętość naszych danych wokół ich wartości średniej.</p>
</section>
<section id="regresyjna-suma-kwadratów-ssr" class="level4" data-number="16.14.6.3">
<h4 data-number="16.14.6.3" class="anchored" data-anchor-id="regresyjna-suma-kwadratów-ssr"><span class="header-section-number">16.14.6.3</span> Regresyjna Suma Kwadratów (SSR)</h4>
<p>SSR określa ilościowo zmienność, którą nasz model wyjaśnia poprzez zmienne objaśniające:</p>
<p><span class="math display"> SSR = \sum(\hat{y}_i - \bar{y})^2 </span></p>
<p>Tutaj <span class="math inline">\hat{y}_i</span> reprezentuje wartości przewidywane przez nasz model. Ten wzór mierzy, jak daleko nasze przewidywania odbiegają od średniej, reprezentując zmienność uchwyconą przez nasz model.</p>
</section>
<section id="resztowa-suma-kwadratów-sse" class="level4" data-number="16.14.6.4">
<h4 data-number="16.14.6.4" class="anchored" data-anchor-id="resztowa-suma-kwadratów-sse"><span class="header-section-number">16.14.6.4</span> Resztowa Suma Kwadratów (SSE)</h4>
<p>SSE mierzy zmienność, która pozostaje niewyjaśniona przez nasz model:</p>
<p><span class="math display"> SSE = \sum(y_i - \hat{y}_i)^2 </span></p>
<p>Ten wzór oblicza różnice między wartościami rzeczywistymi (<span class="math inline">y_i</span>) a wartościami przewidywanymi (<span class="math inline">\hat{y}_i</span>), pokazując nam, ile zmienności nasz model nie zdołał wyjaśnić.</p>
</section>
<section id="podstawowa-zależność" class="level4" data-number="16.14.6.5">
<h4 data-number="16.14.6.5" class="anchored" data-anchor-id="podstawowa-zależność"><span class="header-section-number">16.14.6.5</span> Podstawowa Zależność</h4>
<p>Te trzy składniki są powiązane poprzez kluczowe równanie:</p>
<p><span class="math display"> SST = SSR + SSE </span></p>
<p>To równanie pokazuje, że całkowita zmienność (SST) równa się sumie zmienności wyjaśnionej (SSR) i niewyjaśnionej (SSE). Ta zależność stanowi podstawę do pomiaru wydajności modelu.</p>
</section>
<section id="współczynnik-determinacji-r²" class="level4" data-number="16.14.6.6">
<h4 data-number="16.14.6.6" class="anchored" data-anchor-id="współczynnik-determinacji-r²"><span class="header-section-number">16.14.6.6</span> Współczynnik Determinacji (R²)</h4>
<p>Statystyka R², wyprowadzona z tych składników, mówi nam, jaką proporcję zmienności wyjaśnia nasz model:</p>
<p><span class="math display"> R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST} </span></p>
<p>Gdy R² równa się 0,75, oznacza to, że nasz model wyjaśnia 75% zmienności w zmiennej zależnej. Pozostałe 25% reprezentuje zmienność niewyjaśnioną.</p>
</section>
<section id="istotne-aspekty" class="level4" data-number="16.14.6.7">
<h4 data-number="16.14.6.7" class="anchored" data-anchor-id="istotne-aspekty"><span class="header-section-number">16.14.6.7</span> Istotne Aspekty</h4>
<p>Zrozumienie tych składników pomaga nam:</p>
<ol type="1">
<li>Ocenić wydajność modelu poprzez proporcję wyjaśnionej zmienności</li>
<li>Zidentyfikować, ile zmienności pozostaje niewyjaśnione</li>
<li>Podejmować decyzje dotyczące ulepszania modelu</li>
<li>Porównywać moc wyjaśniającą różnych modeli</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="współczynnik-determinacji-r2" class="level3" data-number="16.14.7">
<h3 data-number="16.14.7" class="anchored" data-anchor-id="współczynnik-determinacji-r2"><span class="header-section-number">16.14.7</span> Współczynnik Determinacji (<span class="math inline">R^2</span>)</h3>
<p><span class="math inline">R^2</span> służy jako miara dopasowania modelu, reprezentująca proporcję wariancji wyjaśnionej przez naszą regresję:</p>
<p><span class="math display"> R^2 = \frac{SSR}{SST} = \frac{SSR}{SSR + SSE} = 1 - \frac{SSE}{SST} </span></p>
<p>Aby zinterpretować <span class="math inline">R^2</span>:</p>
<ul>
<li><span class="math inline">R^2</span> równe 0,75 wskazuje, że model wyjaśnia 75% wariancji (np. wyników egzaminów)</li>
<li><span class="math inline">R^2</span> równe 0,20 sugeruje, że predyktory (np. godziny nauki) odpowiadają za 20% zmienności wyników</li>
<li><span class="math inline">R^2</span> równe 1,00 reprezentuje doskonałą predykcję (rzadko obserwowane w praktyce)</li>
<li><span class="math inline">R^2</span> równe 0,00 wskazuje na brak mocy wyjaśniającej</li>
</ul>
<p>Uwaga: Niższa wartość <span class="math inline">R^2</span> niekoniecznie oznacza gorszy model - może po prostu odzwierciedlać złożoność badanej relacji.</p>
</section>
<section id="kluczowy-wniosek" class="level3" data-number="16.14.8">
<h3 data-number="16.14.8" class="anchored" data-anchor-id="kluczowy-wniosek"><span class="header-section-number">16.14.8</span> Kluczowy Wniosek</h3>
<p>Regresja liniowa ustala relacje między zmiennymi poprzez identyfikację optymalnego dopasowania liniowego przez punkty danych. Ta optymalizacja zachodzi poprzez minimalizację kwadratów reszt. Współczynnik determinacji (<span class="math inline">R^2</span>) kwantyfikuje następnie moc wyjaśniającą modelu poprzez porównanie wyjaśnionej zmienności z całkowitą zmiennością w naszych danych.</p>
</section>
</div>
</div>
</section>
</section>
<section id="appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" class="level2" data-number="16.15">
<h2 data-number="16.15" class="anchored" data-anchor-id="appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami"><span class="header-section-number">16.15</span> Appendix A.1: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład z obliczeniami</h2>
<p>Studentka politologii bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Gallaghera (GH) w wyborach parlamentarnych w 10 losowo wybranych demokracjach.</p>
<p>Dane dotyczące wielkości okręgu wyborczego (<span class="math inline">\text{DM}</span>) i indeksu Gallaghera:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\text{DM}</span> (<span class="math inline">X</span>)</th>
<th>Gallagher (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18,2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16,7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15,8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15,3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15,0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14,8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14,7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14,6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14,55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14,52</td>
</tr>
</tbody>
</table>
<section id="krok-1-obliczanie-podstawowych-statystyk" class="level3" data-number="16.15.1">
<h3 data-number="16.15.1" class="anchored" data-anchor-id="krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.15.1</span> Krok 1: Obliczanie Podstawowych Statystyk</h3>
<p>Obliczanie średnich:</p>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65</span> <span class="math display">\bar{x} = \frac{65}{10} = 6,5</span></p>
<p>Dla indeksu Gallaghera (<span class="math inline">Y</span>): <span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">18,2 + 16,7 + 15,8 + 15,3 + 15,0 + 14,8 + 14,7 + 14,6 + 14,55 + 14,52 = 154,17</span> <span class="math display">\bar{y} = \frac{154,17}{10} = 15,417</span></p>
</section>
<section id="krok-2-szczegółowe-obliczenia-kowariancji" class="level3" data-number="16.15.2">
<h3 data-number="16.15.2" class="anchored" data-anchor-id="krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.15.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</h3>
<p>Pełna tabela robocza ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td><span class="math inline">-4,5</span></td>
<td>2,783</td>
<td><span class="math inline">-12,5235</span></td>
<td>20,25</td>
<td>7,7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td><span class="math inline">-3,5</span></td>
<td>1,283</td>
<td><span class="math inline">-4,4905</span></td>
<td>12,25</td>
<td>1,6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td><span class="math inline">-2,5</span></td>
<td>0,383</td>
<td><span class="math inline">-0,9575</span></td>
<td>6,25</td>
<td>0,1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td><span class="math inline">-1,5</span></td>
<td><span class="math inline">-0,117</span></td>
<td>0,1755</td>
<td>2,25</td>
<td>0,0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td><span class="math inline">-0,5</span></td>
<td><span class="math inline">-0,417</span></td>
<td>0,2085</td>
<td>0,25</td>
<td>0,1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>0,5</td>
<td><span class="math inline">-0,617</span></td>
<td><span class="math inline">-0,3085</span></td>
<td>0,25</td>
<td>0,3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>1,5</td>
<td><span class="math inline">-0,717</span></td>
<td><span class="math inline">-1,0755</span></td>
<td>2,25</td>
<td>0,5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,5</td>
<td><span class="math inline">-0,817</span></td>
<td><span class="math inline">-2,0425</span></td>
<td>6,25</td>
<td>0,6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>3,5</td>
<td><span class="math inline">-0,867</span></td>
<td><span class="math inline">-3,0345</span></td>
<td>12,25</td>
<td>0,7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>4,5</td>
<td><span class="math inline">-0,897</span></td>
<td><span class="math inline">-4,0365</span></td>
<td>20,25</td>
<td>0,8047</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>0</td>
<td>0</td>
<td><span class="math inline">-28,085</span></td>
<td>82,5</td>
<td>12,8442</td>
</tr>
</tbody>
</table>
<p>Obliczanie kowariancji: <span class="math display">\text{Cov}(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p><span class="math display">\text{Cov}(X,Y) = \frac{-28,085}{9} = -3,120556</span></p>
</section>
<section id="krok-3-obliczanie-odchylenia-standardowego" class="level3" data-number="16.15.3">
<h3 data-number="16.15.3" class="anchored" data-anchor-id="krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.15.3</span> Krok 3: Obliczanie Odchylenia Standardowego</h3>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_x = \sqrt{\frac{82,5}{9}} = \sqrt{9,1667} = 3,026582</span></p>
<p>Dla Gallaghera (<span class="math inline">Y</span>): <span class="math display">\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_y = \sqrt{\frac{12,8442}{9}} = \sqrt{1,4271} = 1,194612</span></p>
</section>
<section id="krok-4-obliczanie-korelacji-pearsona" class="level3" data-number="16.15.4">
<h3 data-number="16.15.4" class="anchored" data-anchor-id="krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.15.4</span> Krok 4: Obliczanie Korelacji Pearsona</h3>
<p><span class="math display">r = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y}</span></p>
<p><span class="math display">r = \frac{-3,120556}{3,026582 \times 1,194612} = \frac{-3,120556}{3,615752} = -0,863044</span></p>
</section>
<section id="krok-5-obliczanie-korelacji-rangowej-spearmana" class="level3" data-number="16.15.5">
<h3 data-number="16.15.5" class="anchored" data-anchor-id="krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.15.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</h3>
<p>Pełna tabela rangowa ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th>Ranga <span class="math inline">X_i</span></th>
<th>Ranga <span class="math inline">Y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>1</td>
<td>10</td>
<td><span class="math inline">-9</span></td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>2</td>
<td>9</td>
<td><span class="math inline">-7</span></td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>3</td>
<td>8</td>
<td><span class="math inline">-5</span></td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>4</td>
<td>7</td>
<td><span class="math inline">-3</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>5</td>
<td>6</td>
<td><span class="math inline">-1</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Obliczanie korelacji Spearmana: <span class="math display">\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></p>
<p><span class="math display">\rho = 1 - \frac{6 \times 330}{10(100 - 1)} = 1 - \frac{1980}{990} = 1 - 2 = -1</span></p>
</section>
<section id="krok-6-weryfikacja-w-r" class="level3" data-number="16.15.6">
<h3 data-number="16.15.6" class="anchored" data-anchor-id="krok-6-weryfikacja-w-r"><span class="header-section-number">16.15.6</span> Krok 6: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wektorów</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie kowariancji</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="krok-7-podstawowa-wizualizacja" class="level3" data-number="16.15.7">
<h3 data-number="16.15.7" class="anchored" data-anchor-id="krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.15.7</span> Krok 7: Podstawowa Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu rozrzutu</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wielkość Okręgu vs Indeks Gallaghera"</span>,</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wielkość Okręgu (DM)"</span>,</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera (GH)"</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estymacja-ols-i-miary-dopasowania-modelu" class="level3" data-number="16.15.8">
<h3 data-number="16.15.8" class="anchored" data-anchor-id="estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.15.8</span> Estymacja OLS i Miary Dopasowania Modelu</h3>
</section>
<section id="krok-1-obliczanie-estymatorów-ols" class="level3" data-number="16.15.9">
<h3 data-number="16.15.9" class="anchored" data-anchor-id="krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.15.9</span> Krok 1: Obliczanie Estymatorów OLS</h3>
<p>Korzystając z wcześniej obliczonych wartości:</p>
<ul>
<li><span class="math inline">\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28,085</span></li>
<li><span class="math inline">\sum(X_i - \bar{X})^2 = 82,5</span></li>
<li><span class="math inline">\bar{X} = 6,5</span></li>
<li><span class="math inline">\bar{Y} = 15,417</span></li>
</ul>
<p>Obliczanie nachylenia (<span class="math inline">\hat{\beta_1}</span>):</p>
<p><span class="math inline">\hat{\beta_1} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta_1} = -28,085 ÷ 82,5 = -0,3404</span></p>
<p>Obliczanie wyrazu wolnego (<span class="math inline">\hat{\beta_0}</span>): <span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</span></p>
<p>Zatem równanie regresji OLS ma postać: <span class="math inline">\hat{Y} = 17,6296 - 0,3404X</span></p>
</section>
<section id="krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="level3" data-number="16.15.10">
<h3 data-number="16.15.10" class="anchored" data-anchor-id="krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.15.10</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</h3>
<p>Pełna tabela ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">e_i^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>16,9488</td>
<td>1,2512</td>
<td>1,5655</td>
<td>7,7451</td>
<td>2,3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>16,6084</td>
<td>0,0916</td>
<td>0,0084</td>
<td>1,6461</td>
<td>1,4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>16,2680</td>
<td>-0,4680</td>
<td>0,2190</td>
<td>0,1467</td>
<td>0,7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>15,9276</td>
<td>-0,6276</td>
<td>0,3939</td>
<td>0,0137</td>
<td>0,2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>15,5872</td>
<td>-0,5872</td>
<td>0,3448</td>
<td>0,1739</td>
<td>0,0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>15,2468</td>
<td>-0,4468</td>
<td>0,1996</td>
<td>0,3807</td>
<td>0,0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>14,9064</td>
<td>-0,2064</td>
<td>0,0426</td>
<td>0,5141</td>
<td>0,2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>14,5660</td>
<td>0,0340</td>
<td>0,0012</td>
<td>0,6675</td>
<td>0,7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>14,2256</td>
<td>0,3244</td>
<td>0,1052</td>
<td>0,7517</td>
<td>1,4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>13,8852</td>
<td>0,6348</td>
<td>0,4030</td>
<td>0,8047</td>
<td>2,3439</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>154,17</td>
<td>0</td>
<td>3,2832</td>
<td>12,8442</td>
<td>9,5524</td>
</tr>
</tbody>
</table>
<p>Obliczenia dla wartości dopasowanych:</p>
<pre><code>Dla X = 2:
Ŷ = 17,6296 + (-0,3404 × 2) = 16,9488

Dla X = 3:
Ŷ = 17,6296 + (-0,3404 × 3) = 16,6084

[... kontynuacja dla wszystkich wartości]</code></pre>
</section>
<section id="krok-3-obliczanie-miar-dopasowania" class="level3" data-number="16.15.11">
<h3 data-number="16.15.11" class="anchored" data-anchor-id="krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.15.11</span> Krok 3: Obliczanie Miar Dopasowania</h3>
<p>Suma kwadratów reszt (SSE): <span class="math inline">SSE = \sum e_i^2</span></p>
<pre><code>SSE = 3,2832</code></pre>
<p>Całkowita suma kwadratów (SST): <span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<pre><code>SST = 12,8442</code></pre>
<p>Suma kwadratów regresji (SSR): <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<pre><code>SSR = 9,5524</code></pre>
<p>Weryfikacja dekompozycji: <span class="math inline">SST = SSR + SSE</span></p>
<pre><code>12,8442 = 9,5524 + 3,2832 (w granicach błędu zaokrąglenia)</code></pre>
<p>Obliczanie współczynnika determinacji R-kwadrat: <span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<pre><code>R² = 9,5524 ÷ 12,8442
   = 0,7438</code></pre>
</section>
<section id="krok-4-weryfikacja-w-r" class="level3" data-number="16.15.12">
<h3 data-number="16.15.12" class="anchored" data-anchor-id="krok-4-weryfikacja-w-r"><span class="header-section-number">16.15.12</span> Krok 4: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu liniowego</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie statystyk</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 4.67e-10 ***
DM          -0.34042    0.07053  -4.827  0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ręczne obliczenie R-kwadrat</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="krok-5-analiza-reszt" class="level3" data-number="16.15.13">
<h3 data-number="16.15.13" class="anchored" data-anchor-id="krok-5-analiza-reszt"><span class="header-section-number">16.15.13</span> Krok 5: Analiza Reszt</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów reszt</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="level3" data-number="16.15.14">
<h3 data-number="16.15.14" class="anchored" data-anchor-id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.15.14</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu wartości przewidywanych vs rzeczywistych</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> GH,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Przewidywane, <span class="at">y =</span> Rzeczywiste)) <span class="sc">+</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wartości Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Przewidywany Indeks Gallaghera"</span>,</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rzeczywisty Indeks Gallaghera"</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modele-z-transformacją-logarytmiczną" class="level3" data-number="16.15.15">
<h3 data-number="16.15.15" class="anchored" data-anchor-id="modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.15.15</span> Modele z Transformacją Logarytmiczną</h3>
</section>
<section id="krok-1-transformacja-danych" class="level3" data-number="16.15.16">
<h3 data-number="16.15.16" class="anchored" data-anchor-id="krok-1-transformacja-danych"><span class="header-section-number">16.15.16</span> Krok 1: Transformacja Danych</h3>
<p>Najpierw obliczamy logarytmy naturalne zmiennych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\ln(X_i)</span></th>
<th><span class="math inline">\ln(Y_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>0,6931</td>
<td>2,9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>1,0986</td>
<td>2,8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>1,3863</td>
<td>2,7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>1,6094</td>
<td>2,7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>1,7918</td>
<td>2,7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>1,9459</td>
<td>2,6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>2,0794</td>
<td>2,6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,1972</td>
<td>2,6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>2,3026</td>
<td>2,6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>2,3979</td>
<td>2,6757</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-2-porównanie-różnych-specyfikacji-modelu" class="level3" data-number="16.15.17">
<h3 data-number="16.15.17" class="anchored" data-anchor-id="krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.15.17</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</h3>
<p>Szacujemy trzy alternatywne specyfikacje:</p>
<ol type="1">
<li>Model log-liniowy: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i</span></li>
<li>Model liniowo-logarytmiczny: <span class="math inline">Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
<li>Model log-log: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie zmiennych transformowanych</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modeli</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie wartości R-kwadrat</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Liniowy"</span>, <span class="st">"Log-liniowy"</span>, <span class="st">"Liniowo-logarytmiczny"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Model R_kwadrat
1               Liniowy 0.7443793
2           Log-liniowy 0.7670346
3 Liniowo-logarytmiczny 0.9141560
4               Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="krok-3-porównanie-wizualne" class="level3" data-number="16.15.18">
<h3 data-number="16.15.18" class="anchored" data-anchor-id="krok-3-porównanie-wizualne"><span class="header-section-number">16.15.18</span> Krok 3: Porównanie Wizualne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów dla każdego modelu</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowy"</span>) <span class="sc">+</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-liniowy"</span>) <span class="sc">+</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny"</span>) <span class="sc">+</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-log"</span>) <span class="sc">+</span></span>
<span id="cb146-24"><a href="#cb146-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb146-25"><a href="#cb146-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-26"><a href="#cb146-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Układanie wykresów w siatkę</span></span>
<span id="cb146-27"><a href="#cb146-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb146-28"><a href="#cb146-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-4-analiza-reszt-dla-najlepszego-modelu" class="level3" data-number="16.15.19">
<h3 data-number="16.15.19" class="anchored" data-anchor-id="krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.15.19</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</h3>
<p>Na podstawie wartości R-kwadrat, analiza reszt dla najlepiej dopasowanego modelu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykresy reszt dla najlepszego modelu</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-5-interpretacja-najlepszego-modelu" class="level3" data-number="16.15.20">
<h3 data-number="16.15.20" class="anchored" data-anchor-id="krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.15.20</span> Krok 5: Interpretacja Najlepszego Modelu</h3>
<p>Współczynniki modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 4.94e-11 ***
log_DM       -2.0599     0.2232   -9.23 1.54e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 1.539e-05</code></pre>
</div>
</div>
<p>Interpretacja:</p>
<ul>
<li><span class="math inline">\hat{\beta_0}</span> reprezentuje oczekiwany Indeks Gallaghera, gdy ln(DM) = 0 (czyli gdy DM = 1)</li>
<li><span class="math inline">\hat{\beta_1}</span> reprezentuje zmianę Indeksu Gallaghera związaną z jednostkowym wzrostem ln(DM)</li>
</ul>
</section>
<section id="krok-6-predykcje-modelu" class="level3" data-number="16.15.21">
<h3 data-number="16.15.21" class="anchored" data-anchor-id="krok-6-predykcje-modelu"><span class="header-section-number">16.15.21</span> Krok 6: Predykcje Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu predykcji dla najlepszego modelu</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny: Indeks Gallaghera vs ln(Wielkość Okręgu)"</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(Wielkość Okręgu)"</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera"</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-7-analiza-elastyczności" class="level3" data-number="16.15.22">
<h3 data-number="16.15.22" class="anchored" data-anchor-id="krok-7-analiza-elastyczności"><span class="header-section-number">16.15.22</span> Krok 7: Analiza Elastyczności</h3>
<p>Dla modelu log-log współczynniki bezpośrednio reprezentują elastyczności. Obliczenie średniej elastyczności dla modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie elastyczności przy wartościach średnich</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>elastycznosc <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>elastycznosc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>Wartość ta reprezentuje procentową zmianę Indeksu Gallaghera przy jednoprocentowej zmianie Wielkości Okręgu.</p>
</section>
</section>
<section id="appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="level2" data-number="16.16">
<h2 data-number="16.16" class="anchored" data-anchor-id="appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.16</span> Appendix A.2: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</h2>
<section id="zbiór-danych" class="level3" data-number="16.16.1">
<h3 data-number="16.16.1" class="anchored" data-anchor-id="zbiór-danych"><span class="header-section-number">16.16.1</span> Zbiór Danych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>),</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="korelacja-pearsona-1" class="level3" data-number="16.16.2">
<h3 data-number="16.16.2" class="anchored" data-anchor-id="korelacja-pearsona-1"><span class="header-section-number">16.16.2</span> Korelacja Pearsona</h3>
<p><span class="math display"> r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}} </span></p>
<section id="obliczenia-krok-po-kroku" class="level4" data-number="16.16.2.1">
<h4 data-number="16.16.2.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku"><span class="header-section-number">16.16.2.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>-2,4</td>
<td>-1,6</td>
<td>3,84</td>
<td>5,76</td>
<td>2,56</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>-0,4</td>
<td>0,4</td>
<td>-0,16</td>
<td>0,16</td>
<td>0,16</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>0,6</td>
<td>-0,6</td>
<td>-0,36</td>
<td>0,36</td>
<td>0,36</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>-1,4</td>
<td>-0,6</td>
<td>0,84</td>
<td>1,96</td>
<td>0,36</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>3,6</td>
<td>2,4</td>
<td>8,64</td>
<td>12,96</td>
<td>5,76</td>
</tr>
<tr class="even">
<td>Suma</td>
<td>22</td>
<td>23</td>
<td>0</td>
<td>0</td>
<td>12,8</td>
<td>21,2</td>
<td>9,2</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\bar{x} = 4,4</span> <span class="math inline">\bar{y} = 4,6</span></p>
<p><span class="math display"> r = \frac{12,8}{\sqrt{21,2 \times 9,2}} = \frac{12,8}{\sqrt{195,04}} = \frac{12,8}{13,97} = 0,92 </span></p>
</section>
</section>
<section id="korelacja-spearmana-1" class="level3" data-number="16.16.3">
<h3 data-number="16.16.3" class="anchored" data-anchor-id="korelacja-spearmana-1"><span class="header-section-number">16.16.3</span> Korelacja Spearmana</h3>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} </span></p>
<section id="obliczenia-krok-po-kroku-1" class="level4" data-number="16.16.3.1">
<h4 data-number="16.16.3.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-1"><span class="header-section-number">16.16.3.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th>Ranga <span class="math inline">x_i</span></th>
<th>Ranga <span class="math inline">y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>2,5</td>
<td>1,5</td>
<td>2,25</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>2,5</td>
<td>-0,5</td>
<td>0,25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>5</td>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>7,5</td>
</tr>
</tbody>
</table>
<p><span class="math display"> \rho = 1 - \frac{6(7,5)}{5(25-1)} = 1 - \frac{45}{120} = 0,82 </span></p>
</section>
</section>
<section id="tau-kendalla" class="level3" data-number="16.16.4">
<h3 data-number="16.16.4" class="anchored" data-anchor-id="tau-kendalla"><span class="header-section-number">16.16.4</span> Tau Kendalla</h3>
<p><span class="math display"> \tau = \frac{\text{liczba par zgodnych} - \text{liczba par niezgodnych}}{\frac{1}{2}n(n-1)} </span></p>
<section id="obliczenia-krok-po-kroku-2" class="level4" data-number="16.16.4.1">
<h4 data-number="16.16.4.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-2"><span class="header-section-number">16.16.4.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Para (i,j)</th>
<th><span class="math inline">x_i,x_j</span></th>
<th><span class="math inline">y_i,y_j</span></th>
<th><span class="math inline">x_j-x_i</span></th>
<th><span class="math inline">y_j-y_i</span></th>
<th>Wynik</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(1,2)</td>
<td>2,4</td>
<td>3,5</td>
<td>+2</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,3)</td>
<td>2,5</td>
<td>3,4</td>
<td>+3</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(1,4)</td>
<td>2,3</td>
<td>3,4</td>
<td>+1</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,5)</td>
<td>2,8</td>
<td>3,7</td>
<td>+6</td>
<td>+4</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,3)</td>
<td>4,5</td>
<td>5,4</td>
<td>+1</td>
<td>-1</td>
<td>N</td>
</tr>
<tr class="even">
<td>(2,4)</td>
<td>4,3</td>
<td>5,4</td>
<td>-1</td>
<td>-1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,5)</td>
<td>4,8</td>
<td>5,7</td>
<td>+4</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(3,4)</td>
<td>5,3</td>
<td>4,4</td>
<td>-2</td>
<td>0</td>
<td>N</td>
</tr>
<tr class="odd">
<td>(3,5)</td>
<td>5,8</td>
<td>4,7</td>
<td>+3</td>
<td>+3</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(4,5)</td>
<td>3,8</td>
<td>4,7</td>
<td>+5</td>
<td>+3</td>
<td>Z</td>
</tr>
</tbody>
</table>
<p>Liczba par zgodnych = 8 Liczba par niezgodnych = 2 <span class="math display"> \tau = \frac{8-2}{10} = 0,74 </span></p>
</section>
</section>
<section id="weryfikacja-w-r" class="level3" data-number="16.16.5">
<h3 data-number="16.16.5" class="anchored" data-anchor-id="weryfikacja-w-r"><span class="header-section-number">16.16.5</span> Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"pearson"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson: 0.92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Spearman:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"spearman"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spearman: 0.82 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kendall:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"kendall"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall: 0.74 </code></pre>
</div>
</div>
</section>
<section id="interpretacja-wyników" class="level3" data-number="16.16.6">
<h3 data-number="16.16.6" class="anchored" data-anchor-id="interpretacja-wyników"><span class="header-section-number">16.16.6</span> Interpretacja Wyników</h3>
<ol type="1">
<li><strong>Korelacja Pearsona (r = 0,92)</strong>
<ul>
<li>Silna dodatnia korelacja liniowa</li>
<li>Wskazuje na bardzo silny liniowy związek między zmiennymi</li>
</ul></li>
<li><strong>Korelacja Spearmana (ρ = 0,82)</strong>
<ul>
<li>Również silna dodatnia korelacja</li>
<li>Nieco niższa niż Pearsona, co sugeruje pewne odchylenia od monotoniczności</li>
</ul></li>
<li><strong>Tau Kendalla (τ = 0,74)</strong>
<ul>
<li>Najniższa z trzech wartości, ale wciąż wskazuje na silną zależność</li>
<li>Bardziej odporna na wartości odstające</li>
</ul></li>
</ol>
</section>
<section id="porównanie-miar" class="level3" data-number="16.16.7">
<h3 data-number="16.16.7" class="anchored" data-anchor-id="porównanie-miar"><span class="header-section-number">16.16.7</span> Porównanie Miar</h3>
<ol type="1">
<li><strong>Różnice w wartościach:</strong>
<ul>
<li>Pearson (0,92) - najwyższa wartość, silna liniowość</li>
<li>Spearman (0,82) - uwzględnia tylko uporządkowanie</li>
<li>Kendall (0,74) - najbardziej konserwatywna miara</li>
</ul></li>
<li><strong>Praktyczne zastosowanie:</strong>
<ul>
<li>Wszystkie miary potwierdzają silną dodatnią zależność</li>
<li>Różnice między miarami wskazują na nieznaczne odchylenia od idealnej liniowości</li>
<li>Kendall daje najbardziej ostrożną ocenę siły związku</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady" class="level2" data-number="16.17">
<h2 data-number="16.17" class="anchored" data-anchor-id="appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady"><span class="header-section-number">16.17</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - podstawowe przykłady</h2>
</section>
<section id="przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="level2" data-number="16.18">
<h2 data-number="16.18" class="anchored" data-anchor-id="przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">16.18</span> Przykład 1. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</h2>
<p>Ta analiza bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Indeks Loosemore-Hanby mierzy dysproporcjonalność wyborczą, gdzie wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane" class="level3" data-number="16.18.1">
<h3 data-number="16.18.1" class="anchored" data-anchor-id="dane"><span class="header-section-number">16.18.1</span> Dane</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość Okręgu i Indeks LH według Kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">12.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="level3" data-number="16.18.2">
<h3 data-number="16.18.2" class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh"><span class="header-section-number">16.18.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm" class="level4" data-number="16.18.2.1">
<h4 data-number="16.18.2.1" class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm"><span class="header-section-number">16.18.2.1</span> Obliczenia dla Wielkości Okręgu (DM)</h4>
<p>Najpierw obliczam średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{3 + 4 + 5 + 6 + 7 + 8}{6} = \frac{33}{6} = 5.5</span></p>
<p>Następnie obliczam wariancję używając formuły z korektą Bessela:</p>
<p><span class="math display">\sigma^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td><span class="math inline">3 - 5.5 = -2.5</span></td>
<td><span class="math inline">(-2.5)^2 = 6.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td><span class="math inline">4 - 5.5 = -1.5</span></td>
<td><span class="math inline">(-1.5)^2 = 2.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td><span class="math inline">5 - 5.5 = -0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td><span class="math inline">6 - 5.5 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 5.5 = 1.5</span></td>
<td><span class="math inline">(1.5)^2 = 2.25</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td><span class="math inline">8 - 5.5 = 2.5</span></td>
<td><span class="math inline">(2.5)^2 = 6.25</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>17.5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{DM} = \frac{17.5}{6-1} = \frac{17.5}{5} = 3.5</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">\sigma_{DM} = \sqrt{\sigma^2_{DM}} = \sqrt{3.5} = 1.871</span></p>
</section>
<section id="obliczenia-dla-indeksu-lh" class="level4" data-number="16.18.2.2">
<h4 data-number="16.18.2.2" class="anchored" data-anchor-id="obliczenia-dla-indeksu-lh"><span class="header-section-number">16.18.2.2</span> Obliczenia dla Indeksu LH</h4>
<p>Najpierw obliczam średnią wartości LH:</p>
<p><span class="math display">\bar{x}_{LH} = \frac{15.5 + 14.25 + 13.5 + 13.5 + 13 + 12.75}{6} = \frac{82.5}{6} = 13.75</span></p>
<p>Następnie obliczam wariancję:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td><span class="math inline">15.5 - 13.75 = 1.75</span></td>
<td><span class="math inline">(1.75)^2 = 3.0625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td><span class="math inline">14.25 - 13.75 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td><span class="math inline">12.75 - 13.75 = -1</span></td>
<td><span class="math inline">(-1)^2 = 1</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{LH} = \frac{5}{6-1} = \frac{5}{5} = 1</span></p>
<p>Odchylenie standardowe wynosi:</p>
<p><span class="math display">\sigma_{LH} = \sqrt{\sigma^2_{LH}} = \sqrt{1} = 1</span></p>
<p><strong>Podsumowanie Zadania 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 3.5</li>
<li>Odchylenie Standardowe DM: 1.871</li>
<li>Wariancja LH (z korektą Bessela): 1</li>
<li>Odchylenie Standardowe LH: 1</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="level3" data-number="16.18.3">
<h3 data-number="16.18.3" class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych"><span class="header-section-number">16.18.3</span> Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu formuły z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td>-2.5</td>
<td>1.75</td>
<td><span class="math inline">(-2.5)(1.75) = -4.375</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td>-1.5</td>
<td>0.5</td>
<td><span class="math inline">(-1.5)(0.5) = -0.75</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td>-0.5</td>
<td>-0.25</td>
<td><span class="math inline">(-0.5)(-0.25) = 0.125</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td>0.5</td>
<td>-0.25</td>
<td><span class="math inline">(0.5)(-0.25) = -0.125</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td>1.5</td>
<td>-0.75</td>
<td><span class="math inline">(1.5)(-0.75) = -1.125</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td>2.5</td>
<td>-1</td>
<td><span class="math inline">(2.5)(-1) = -2.5</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-8.75</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-8.75}{5} = -1.75</span></p>
<p><strong>Kowariancja między DM i LH: -1.75</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: gdy wielkość okręgu wzrasta, indeks dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="level3" data-number="16.18.4">
<h3 data-number="16.18.4" class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh"><span class="header-section-number">16.18.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</h3>
<p>Współczynnik korelacji Pearsona obliczany jest przy użyciu formuły:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{\sigma_{DM} \cdot \sigma_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -1.75</span></li>
<li><span class="math inline">\sigma_{DM} = 1.871</span></li>
<li><span class="math inline">\sigma_{LH} = 1</span></li>
</ul>
<p><span class="math display">r = \frac{-1.75}{1.871 \cdot 1} = \frac{-1.75}{1.871} = -0.935</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.935</strong></p>
<section id="interpretacja" class="level4" data-number="16.18.4.1">
<h4 data-number="16.18.4.1" class="anchored" data-anchor-id="interpretacja"><span class="header-section-number">16.18.4.1</span> Interpretacja:</h4>
<p>Współczynnik korelacji -0.935 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Znak ujemny pokazuje odwrotną zależność między wielkością okręgu a indeksem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.935 wskazuje na bardzo silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości indeksu LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że gdy wielkość okręgu wzrasta, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami (więcej przedstawicieli wybieranych z jednego okręgu) zwykle dają bardziej proporcjonalne wyniki (niższa dysproporcjonalność).</p></li>
</ol>
<p>Odkrycie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi zapewniają więcej możliwości mniejszym partiom, aby uzyskać reprezentację, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="level3" data-number="16.18.5">
<h3 data-number="16.18.5" class="anchored" data-anchor-id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.18.5</span> Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</h3>
<p>Formuła dla regresji liniowej prostej:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny (przecięcie)</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Formuła do obliczenia <span class="math inline">\beta_1</span> to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{\sigma^2_{DM}} = \frac{-1.75}{3.5} = -0.5</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, używam:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 13.75 - (-0.5) \cdot 5.5 = 13.75 + 2.75 = 16.5</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.5 - 0.5 \cdot DM</span></p>
<section id="obliczanie-wartości-przewidywanych-i-błędów" class="level4" data-number="16.18.5.1">
<h4 data-number="16.18.5.1" class="anchored" data-anchor-id="obliczanie-wartości-przewidywanych-i-błędów"><span class="header-section-number">16.18.5.1</span> Obliczanie wartości przewidywanych i błędów</h4>
<p>Używając naszego równania regresji, obliczam przewidywane wartości LH:</p>
<p><span class="math inline">\hat{LH} = 16.5 - 0.5 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 24%">
<col style="width: 14%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.5 - 0.5x_i</span>)</th>
<th>Błąd (<span class="math inline">y_i - \hat{y}_i</span>)</th>
<th>Błąd bezwzględny (<span class="math inline">|y_i - \hat{y}_i|</span>)</th>
<th>Błąd kwadratowy (<span class="math inline">[y_i - \hat{y}_i]^2</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td><span class="math inline">16.5 - 0.5(3) = 16.5 - 1.5 = 15</span></td>
<td><span class="math inline">15.5 - 15 = 0.5</span></td>
<td><span class="math inline">|0.5| = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td><span class="math inline">16.5 - 0.5(4) = 16.5 - 2 = 14.5</span></td>
<td><span class="math inline">14.25 - 14.5 = -0.25</span></td>
<td><span class="math inline">|-0.25| = 0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(5) = 16.5 - 2.5 = 14</span></td>
<td><span class="math inline">13.5 - 14 = -0.5</span></td>
<td><span class="math inline">|-0.5| = 0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(6) = 16.5 - 3 = 13.5</span></td>
<td><span class="math inline">13.5 - 13.5 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td><span class="math inline">16.5 - 0.5(7) = 16.5 - 3.5 = 13</span></td>
<td><span class="math inline">13 - 13 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td><span class="math inline">16.5 - 0.5(8) = 16.5 - 4 = 12.5</span></td>
<td><span class="math inline">12.75 - 12.5 = 0.25</span></td>
<td><span class="math inline">|0.25| = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>1.5</strong></td>
<td><strong>0.625</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="obliczanie-r-kwadrat" class="level4" data-number="16.18.5.2">
<h4 data-number="16.18.5.2" class="anchored" data-anchor-id="obliczanie-r-kwadrat"><span class="header-section-number">16.18.5.2</span> Obliczanie R-kwadrat</h4>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Obliczyliśmy już te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td>1.75</td>
<td>3.0625</td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td>0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td>-0.75</td>
<td>0.5625</td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SST = 5</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math inline">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 32%">
<col style="width: 28%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15</td>
<td><span class="math inline">15 - 13.75 = 1.25</span></td>
<td><span class="math inline">(1.25)^2 = 1.5625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.5</td>
<td><span class="math inline">14.5 - 13.75 = 0.75</span></td>
<td><span class="math inline">(0.75)^2 = 0.5625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>14</td>
<td><span class="math inline">14 - 13.75 = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.5</td>
<td><span class="math inline">12.5 - 13.75 = -1.25</span></td>
<td><span class="math inline">(-1.25)^2 = 1.5625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>4.375</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SSR = 4.375</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math inline">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<p>Z tabeli powyżej, suma kwadratów błędów wynosi:</p>
<p><span class="math inline">SSE = 0.625</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia sprawdzając, czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math inline">5 = 4.375 + 0.625 = 5 \checkmark</span></p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math inline">R^2 = \frac{SSR}{SST} = \frac{4.375}{5} = 0.875</span></p>
</section>
<section id="obliczanie-rmse-root-mean-square-error" class="level4" data-number="16.18.5.3">
<h4 data-number="16.18.5.3" class="anchored" data-anchor-id="obliczanie-rmse-root-mean-square-error"><span class="header-section-number">16.18.5.3</span> Obliczanie RMSE (Root Mean Square Error)</h4>
<p>RMSE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Używając naszego obliczonego SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{0.625}{6}} = \sqrt{0.104} \approx 0.323</span></p>
</section>
<section id="obliczanie-mae-mean-absolute-error" class="level4" data-number="16.18.5.4">
<h4 data-number="16.18.5.4" class="anchored" data-anchor-id="obliczanie-mae-mean-absolute-error"><span class="header-section-number">16.18.5.4</span> Obliczanie MAE (Mean Absolute Error)</h4>
<p>MAE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">MAE = \frac{\sum_{i=1}^{n}|y_i - \hat{y}_i|}{n}</span></p>
<p>Używając sum z tabeli:</p>
<p><span class="math inline">MAE = \frac{1.5}{6} = 0.25</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.5 - 0.5 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.875</p>
<p><strong>RMSE</strong>: 0.323</p>
<p><strong>MAE</strong>: 0.25</p>
</section>
<section id="interpretacja-1" class="level4" data-number="16.18.5.5">
<h4 data-number="16.18.5.5" class="anchored" data-anchor-id="interpretacja-1"><span class="header-section-number">16.18.5.5</span> Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego wzrostu jednostkowego wielkości okręgu, indeks dysproporcjonalności LH jest oczekiwany spadek o 0.5 jednostki. Wyraz wolny (16.5) reprezentuje oczekiwany indeks LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.875 wskazuje, że około 87.5% wariancji w dysproporcjonalności wyborczej (indeks LH) może być wyjaśnione przez wielkość okręgu. Jest to wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej.</p></li>
<li><p><strong>RMSE i MAE</strong>: Niskie wartości RMSE (0.323) i MAE (0.25) wskazują, że model dobrze dopasowuje się do danych, z małymi błędami predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Odkrycia sugerują, że zwiększanie wielkości okręgu mogłoby być skuteczną strategią reformy wyborczej dla krajów dążących do zmniejszenia dysproporcjonalności między głosami a mandatami. Jednak korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać w wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout" class="level2" data-number="16.19">
<h2 data-number="16.19" class="anchored" data-anchor-id="example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">16.19</span> Example 2. Descriptive Statistics and OLS Example - Income and Voter Turnout</h2>
<p><strong>Background</strong></p>
<p>In preparation for the 2024 municipal elections, the Amsterdam Electoral Commission conducted research on voter participation patterns across different city neighborhoods. A key question emerged:</p>
<p>Does economic prosperity of a neighborhood correlate with civic engagement, specifically voter turnout?</p>
<p><strong>Data Collection</strong></p>
<p>Sample: 5 representative neighborhoods in Amsterdam</p>
<p>Time Period: Data from the 2022 municipal elections</p>
<p>Variables:</p>
<ul>
<li>Income: Average annual household income per capita (thousands €)</li>
<li>Turnout: Percentage of registered voters who voted in the election</li>
</ul>
<section id="initial-r-output-for-reference" class="level3" data-number="16.19.1">
<h3 data-number="16.19.1" class="anchored" data-anchor-id="initial-r-output-for-reference"><span class="header-section-number">16.19.1</span> Initial R Output for Reference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>)  <span class="co"># thousands €</span></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>turnout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># %</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model check</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnout <span class="sc">~</span> income)</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = turnout ~ income)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
income       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
</div>
</section>
<section id="dispersion-measures" class="level3" data-number="16.19.2">
<h3 data-number="16.19.2" class="anchored" data-anchor-id="dispersion-measures"><span class="header-section-number">16.19.2</span> Dispersion Measures</h3>
<p><strong>Means:</strong></p>
<p><span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n} = \frac{50 + 45 + 56 + 40 + 60}{5} = \frac{251}{5} = 50.2</span></p>
<p><span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n} = \frac{60 + 56 + 70 + 50 + 75}{5} = \frac{311}{5} = 62.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)  <span class="co"># 50.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(turnout) <span class="co"># 62.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.2</code></pre>
</div>
</div>
<p><strong>Variances:</strong></p>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X: <span class="math inline">(-0.2, -5.2, 5.8, -10.2, 9.8)</span></p>
<p><span class="math display">s^2_X = \frac{0.04 + 27.04 + 33.64 + 104.04 + 96.04}{4} = \frac{260.8}{4} = 65.2</span></p>
<p>Deviations for Y: <span class="math inline">(-2.2, -6.2, 7.8, -12.2, 12.8)</span></p>
<p><span class="math display">s^2_Y = \frac{4.84 + 38.44 + 60.84 + 148.84 + 163.84}{4} = \frac{416.8}{4} = 104.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(income)  <span class="co"># 65.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(turnout) <span class="co"># 104.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.2</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3" data-number="16.19.3">
<h3 data-number="16.19.3" class="anchored" data-anchor-id="covariance-and-correlation"><span class="header-section-number">16.19.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong></p>
<p><span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-0.2 \times -2.2) = 0.44</span> <span class="math display">(-5.2 \times -6.2) = 32.24</span> <span class="math display">(5.8 \times 7.8) = 45.24</span> <span class="math display">(-10.2 \times -12.2) = 124.44</span> <span class="math display">(9.8 \times 12.8) = 125.44</span></p>
<p><span class="math display">s_{XY} = \frac{327.8}{4} = 81.95</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(income, turnout) <span class="co"># 81.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.95</code></pre>
</div>
</div>
<p><strong>Correlation:</strong></p>
<p><span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{81.95}{\sqrt{65.2}\sqrt{104.2}} = 0.994</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(income, turnout) <span class="co"># 0.994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9942402</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x" class="level3" data-number="16.19.4">
<h3 data-number="16.19.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">16.19.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong></p>
<p><span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{81.95}{65.2} = 1.2571429</span></p>
<p><strong>Intercept:</strong></p>
<p><span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p>Step by step:</p>
<ol type="1">
<li><span class="math display">1.2571429 \times 50.2 = 63.1085714</span></li>
<li><span class="math display">\hat{\beta_0} = 62.2 - 63.1085714 = -0.9085714</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)  <span class="co"># Exact coefficients from R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
 -0.8964724   1.2569018 </code></pre>
</div>
</div>
</section>
<section id="detailed-decomposition-of-variance-and-r-squared" class="level3" data-number="16.19.5">
<h3 data-number="16.19.5" class="anchored" data-anchor-id="detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">16.19.5</span> Detailed Decomposition of Variance and R-squared</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span></p>
<p>The predicted values <span class="math inline">\hat{Y}</span> for each <span class="math inline">X</span> value:</p>
<p>For <span class="math inline">X = 50</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (50)
</span> <span class="math display">\hat{Y} = -0.9085714 + 62.857145</span> <span class="math display">\hat{Y} = 61.9485736</span></p>
<p>For <span class="math inline">X = 45</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (45)
</span> <span class="math display">\hat{Y} = -0.9085714 + 56.5714305</span> <span class="math display">\hat{Y} = 55.6535591</span></p>
<p>For <span class="math inline">X = 56</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (56)
</span> <span class="math display">\hat{Y} = -0.9085714 + 70.4200024</span> <span class="math display">\hat{Y} = 69.5114310</span></p>
<p>For <span class="math inline">X = 40</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (40)
</span> <span class="math display">\hat{Y} = -0.9085714 + 50.2657160</span> <span class="math display">\hat{Y} = 49.3571446</span></p>
<p>For <span class="math inline">X = 60</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (60)
</span> <span class="math display">\hat{Y} = -0.9085714 + 75.4285740</span> <span class="math display">\hat{Y} = 74.5200026</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification of predicted values</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9085714</span> <span class="sc">+</span> <span class="fl">1.2571429</span> <span class="sc">*</span> income</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> income,</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> turnout,</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_hat =</span> y_hat,</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y    Y_hat
1 50 60 61.94857
2 45 56 55.66286
3 56 70 69.49143
4 40 50 49.37714
5 60 75 74.52000</code></pre>
</div>
</div>
<p><strong>Step 2: Calculate SST (Total Sum of Squares)</strong></p>
<p><span class="math display">SST = \sum(Y_i - \bar{Y})^2 \text{ where } \bar{Y} = 62.2</span></p>
<p><span class="math display">(60 - 62.2)^2 = (-2.2)^2 = 4.84</span> <span class="math display">(56 - 62.2)^2 = (-6.2)^2 = 38.44</span> <span class="math display">(70 - 62.2)^2 = (7.8)^2 = 60.84</span> <span class="math display">(50 - 62.2)^2 = (-12.2)^2 = 148.84</span> <span class="math display">(75 - 62.2)^2 = (12.8)^2 = 163.84</span></p>
<p><span class="math display">SST = 4.84 + 38.44 + 60.84 + 148.84 + 163.84 = 416.8</span></p>
<p><strong>Step 3: Calculate SSR (Regression Sum of Squares)</strong></p>
<p><span class="math display">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<p><span class="math display">(61.9485736 - 62.2)^2 = (-0.2514264)^2 = 0.0632151</span> <span class="math display">(55.6535591 - 62.2)^2 = (-6.5464409)^2 = 42.8558689</span> <span class="math display">(69.5114310 - 62.2)^2 = (7.3114310)^2 = 53.4570178</span> <span class="math display">(49.3571446 - 62.2)^2 = (-12.8428554)^2 = 164.9389370</span> <span class="math display">(74.5200026 - 62.2)^2 = (12.3200026)^2 = 151.7824640</span></p>
<p><span class="math display">SSR = 413.0975028</span></p>
<p><strong>Step 4: Calculate SSE (Error Sum of Squares)</strong></p>
<p><span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<p><span class="math display">(60 - 61.9485736)^2 = (-1.9485736)^2 = 3.7969384</span> <span class="math display">(56 - 55.6535591)^2 = (0.3464409)^2 = 0.1200212</span> <span class="math display">(70 - 69.5114310)^2 = (0.4885690)^2 = 0.2387198</span> <span class="math display">(50 - 49.3571446)^2 = (0.6428554)^2 = 0.4132631</span> <span class="math display">(75 - 74.5200026)^2 = (0.4799974)^2 = 0.2303975</span></p>
<p><span class="math display">SSE = 4.7024972</span></p>
<p><strong>Step 5: Verify decomposition</strong></p>
<p><span class="math display">SST = SSR + SSE</span> <span class="math display">416.8 = 413.0975028 + 4.7024972</span></p>
<p><strong>Step 6: Calculate R-squared</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{413.0975028}{416.8} = 0.9916</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared  <span class="co"># Should match our calculation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9885135</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3" data-number="16.19.6">
<h3 data-number="16.19.6" class="anchored" data-anchor-id="visualization"><span class="header-section-number">16.19.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> income, <span class="at">turnout =</span> turnout)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> turnout)) <span class="sc">+</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Voter Turnout vs Income per Capita"</span>,</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Income per Capita (thousands €)"</span>,</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Voter Turnout (%)"</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation" class="level3" data-number="16.19.7">
<h3 data-number="16.19.7" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">16.19.7</span> Interpretation</h3>
<p>The analysis shows:</p>
<ol type="1">
<li><p>A very strong positive correlation (<span class="math inline">r = 0.994</span>) between income and voter turnout</p></li>
<li><p>The regression equation <span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span> indicates that:</p>
<ul>
<li>For each €1,000 increase in income, turnout increases by about 1.26 percentage points</li>
<li>The intercept (<span class="math inline">-0.9086</span>) has little practical meaning as income is never zero</li>
</ul></li>
<li><p>The R-squared of 0.9916 indicates that 99.16% of the variance in turnout is explained by income</p></li>
</ol>
</section>
</section>
<section id="example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="level2" data-number="16.20">
<h2 data-number="16.20" class="anchored" data-anchor-id="example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">16.20</span> Example 3. Anxiety Levels and Cognitive Performance: A Laboratory Study</h2>
<section id="data-and-context" class="level3" data-number="16.20.1">
<h3 data-number="16.20.1" class="anchored" data-anchor-id="data-and-context"><span class="header-section-number">16.20.1</span> Data and Context</h3>
<p>In a psychology experiment, researchers measured the relationship between anxiety levels (measured by galvanic skin response, GSR) and cognitive performance (score on a working memory task).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.4</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>, <span class="fl">6.4</span>, <span class="fl">7.2</span>, <span class="fl">8.0</span>)  <span class="co"># GSR readings</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">62</span>)      <span class="co"># Working memory scores</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8993 -0.6660  0.2162  0.6106  1.5262 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 105.3248     1.3189   79.86 2.60e-10 ***
anxiety      -5.4407     0.2359  -23.06 4.35e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.236 on 6 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.987 
F-statistic: 531.9 on 1 and 6 DF,  p-value: 4.355e-07</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3" data-number="16.20.2">
<h3 data-number="16.20.2" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">16.20.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{2.1 + 3.4 + 4.2 + 5.1 + 5.8 + 6.4 + 7.2 + 8.0}{8} = \frac{42.2}{8} = 5.275</span></p>
<p><span class="math display">\bar{Y} = \frac{92 + 88 + 84 + 78 + 74 + 70 + 65 + 62}{8} = \frac{613}{8} = 76.625</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.625</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li><span class="math inline">(2.1 - 5.275) = -3.175</span></li>
<li><span class="math inline">(3.4 - 5.275) = -1.875</span></li>
<li><span class="math inline">(4.2 - 5.275) = -1.075</span></li>
<li><span class="math inline">(5.1 - 5.275) = -0.175</span></li>
<li><span class="math inline">(5.8 - 5.275) = 0.525</span></li>
<li><span class="math inline">(6.4 - 5.275) = 1.125</span></li>
<li><span class="math inline">(7.2 - 5.275) = 1.925</span></li>
<li><span class="math inline">(8.0 - 5.275) = 2.725</span></li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">10.08063 + 3.51563 + 1.15563 + 0.03063 + 0.27563 + 1.26563 + 3.70563 +
7.42563 = 27.45500</span></p>
<p><span class="math display">s^2_X = \frac{27.45500}{7} = 3.922143</span></p>
<p>Similarly for Y: Deviations:</p>
<p><span class="math display">15.375, 11.375, 7.375, 1.375, -2.625, -6.625, -11.625, -14.625</span></p>
<p><span class="math display">s^2_Y = \frac{236.875 + 129.391 + 54.391 + 1.891 + 6.891 + 43.891 + 135.141 + 213.891}{7} = \frac{822.362}{7} = 117.4803</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.922143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.4107</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-1" class="level3" data-number="16.20.3">
<h3 data-number="16.20.3" class="anchored" data-anchor-id="covariance-and-correlation-1"><span class="header-section-number">16.20.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-3.175 × 15.375) = -48.815625</span></p>
<p><span class="math display">(-1.875 × 11.375) = -21.328125</span></p>
<p><span class="math display">(-1.075 × 7.375) = -7.928125</span></p>
<p><span class="math display">(-0.175 × 1.375) = -0.240625</span></p>
<p><span class="math display">(0.525 × -2.625) = -1.378125</span></p>
<p><span class="math display">(1.125 × -6.625) = -7.453125</span></p>
<p><span class="math display">(1.925 × -11.625) = -22.378125</span></p>
<p><span class="math display">(2.725 × -14.625) = -39.853125</span></p>
<p>Sum <span class="math inline">= -149.375</span></p>
<p><span class="math display">s_{XY} = \frac{-149.375}{7} = -21.33929</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -21.33929</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-21.33929}{\sqrt{3.922143}\sqrt{117.4803}} = -0.9932</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9944073</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="level3" data-number="16.20.4">
<h3 data-number="16.20.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">16.20.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-21.33929}{3.922143} = -5.4407</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-5.4407 × 5.275 = -28.6997</span></li>
<li><span class="math inline">\hat{\beta_0} = 76.625 - (-28.6997) = 105.3247</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
 105.324804   -5.440721 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3" data-number="16.20.5">
<h3 data-number="16.20.5" class="anchored" data-anchor-id="r-squared-calculation"><span class="header-section-number">16.20.5</span> 4. R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>: <span class="math display">\hat{Y} = 105.3247 - 5.4407X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">105.3247</span> <span class="sc">-</span> <span class="fl">5.4407</span> <span class="sc">*</span> anxiety</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance,</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Anxiety Performance Predicted
1     2.1          92  93.89923
2     3.4          88  86.82632
3     4.2          84  82.47376
4     5.1          78  77.57713
5     5.8          74  73.76864
6     6.4          70  70.50422
7     7.2          65  66.15166
8     8.0          62  61.79910</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong></p>
<p><span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 822.362</span></p>
<p><span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 816.3094</span></p>
<p><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 6.0526</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{816.3094}{822.362} = 0.9926</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9888459</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3" data-number="16.20.6">
<h3 data-number="16.20.6" class="anchored" data-anchor-id="visualization-1"><span class="header-section-number">16.20.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cognitive Performance vs. Anxiety Levels"</span>,</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Anxiety (GSR)"</span>,</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Performance Score"</span></span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-1" class="level3" data-number="16.20.7">
<h3 data-number="16.20.7" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">16.20.7</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.993) between anxiety and cognitive performance</li>
<li>For each unit increase in GSR (anxiety), performance decreases by approximately 5.44 points</li>
<li>The model explains 99.26% of the variance in performance scores</li>
<li>The relationship appears to be strongly linear, suggesting a reliable anxiety-performance relationship</li>
<li>The high intercept (105.32) represents the theoretical maximum performance at zero anxiety</li>
</ol>
</section>
<section id="study-limitations" class="level3" data-number="16.20.8">
<h3 data-number="16.20.8" class="anchored" data-anchor-id="study-limitations"><span class="header-section-number">16.20.8</span> Study Limitations</h3>
<ol type="1">
<li>Small sample size (n=8)</li>
<li>Possible other confounding variables</li>
<li>Limited range of anxiety levels</li>
<li>Cross-sectional rather than longitudinal data</li>
</ol>
</section>
</section>
<section id="przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="level2" data-number="16.21">
<h2 data-number="16.21" class="anchored" data-anchor-id="przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">16.21</span> Przykład 4. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</h2>
<p>Ta analiza bada związek między wielkością okręgu (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Wskaźnik Loosemore-Hanby mierzy dysproporcjonalność wyborczą, przy czym wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane-1" class="level3" data-number="16.21.1">
<h3 data-number="16.21.1" class="anchored" data-anchor-id="dane-1"><span class="header-section-number">16.21.1</span> Dane</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość okręgu i wskaźnik LH według kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Kraj</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="level3" data-number="16.21.2">
<h3 data-number="16.21.2" class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1"><span class="header-section-number">16.21.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm-1" class="level4" data-number="16.21.2.1">
<h4 data-number="16.21.2.1" class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm-1"><span class="header-section-number">16.21.2.1</span> Obliczenia dla wielkości okręgu (DM)</h4>
<p>Najpierw obliczę średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{4 + 10 + 3 + 8 + 7 + 4}{6} = \frac{36}{6} = 6</span></p>
<p>Następnie obliczę wariancję z korektą Bessela, korzystając z wzoru:</p>
<p><span class="math display">s^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td><span class="math inline">10 - 6 = 4</span></td>
<td><span class="math inline">(4)^2 = 16</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td><span class="math inline">3 - 6 = -3</span></td>
<td><span class="math inline">(-3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td><span class="math inline">8 - 6 = 2</span></td>
<td><span class="math inline">(2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 6 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>38</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{DM} = \frac{38}{6-1} = \frac{38}{5} = 7.6</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">s_{DM} = \sqrt{s^2_{DM}} = \sqrt{7.6} = 2.757</span></p>
</section>
<section id="obliczenia-dla-wskaźnika-lh" class="level4" data-number="16.21.2.2">
<h4 data-number="16.21.2.2" class="anchored" data-anchor-id="obliczenia-dla-wskaźnika-lh"><span class="header-section-number">16.21.2.2</span> Obliczenia dla wskaźnika LH</h4>
<p>Najpierw obliczę średnią wartości LH:</p>
<p><span class="math display">\bar{y}_{LH} = \frac{12 + 8 + 15 + 10 + 6 + 13}{6} = \frac{64}{6} = 10.667</span></p>
<p>Następnie obliczę wariancję z korektą Bessela:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 28%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td><span class="math inline">12 - 10.667 = 1.333</span></td>
<td><span class="math inline">(1.333)^2 = 1.777</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td><span class="math inline">8 - 10.667 = -2.667</span></td>
<td><span class="math inline">(-2.667)^2 = 7.113</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td><span class="math inline">15 - 10.667 = 4.333</span></td>
<td><span class="math inline">(4.333)^2 = 18.775</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td><span class="math inline">10 - 10.667 = -0.667</span></td>
<td><span class="math inline">(-0.667)^2 = 0.445</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td><span class="math inline">6 - 10.667 = -4.667</span></td>
<td><span class="math inline">(-4.667)^2 = 21.781</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td><span class="math inline">13 - 10.667 = 2.333</span></td>
<td><span class="math inline">(2.333)^2 = 5.443</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{LH} = \frac{55.334}{6-1} = \frac{55.334}{5} = 11.067</span></p>
<p>Odchylenie standardowe to:</p>
<p><span class="math display">s_{LH} = \sqrt{s^2_{LH}} = \sqrt{11.067} = 3.327</span></p>
<p><strong>Podsumowanie kroku 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 7.6</li>
<li>Odchylenie standardowe DM: 2.757</li>
<li>Wariancja LH (z korektą Bessela): 11.067</li>
<li>Odchylenie standardowe LH: 3.327</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="level3" data-number="16.21.3">
<h3 data-number="16.21.3" class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych"><span class="header-section-number">16.21.3</span> Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu wzoru z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td>-2</td>
<td>1.333</td>
<td><span class="math inline">(-2)(1.333) = -2.666</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td>4</td>
<td>-2.667</td>
<td><span class="math inline">(4)(-2.667) = -10.668</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td>-3</td>
<td>4.333</td>
<td><span class="math inline">(-3)(4.333) = -12.999</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td>2</td>
<td>-0.667</td>
<td><span class="math inline">(2)(-0.667) = -1.334</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td>1</td>
<td>-4.667</td>
<td><span class="math inline">(1)(-4.667) = -4.667</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td>-2</td>
<td>2.333</td>
<td><span class="math inline">(-2)(2.333) = -4.666</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-37</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-37}{6-1} = \frac{-37}{5} = -7.4</span></p>
<p><strong>Kowariancja między DM a LH: -7.4</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: wraz ze wzrostem wielkości okręgu wskaźnik dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="level3" data-number="16.21.4">
<h3 data-number="16.21.4" class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh"><span class="header-section-number">16.21.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</h3>
<p>Współczynnik korelacji Pearsona oblicza się przy użyciu wzoru:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{s_{DM} \cdot s_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -7.4</span></li>
<li><span class="math inline">s_{DM} = 2.757</span></li>
<li><span class="math inline">s_{LH} = 3.327</span></li>
</ul>
<p><span class="math display">r = \frac{-7.4}{2.757 \cdot 3.327} = \frac{-7.4}{9.172} = -0.807</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.807</strong></p>
<section id="interpretacja-2" class="level4" data-number="16.21.4.1">
<h4 data-number="16.21.4.1" class="anchored" data-anchor-id="interpretacja-2"><span class="header-section-number">16.21.4.1</span> Interpretacja:</h4>
<p>Współczynnik korelacji -0.807 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Ujemny znak pokazuje odwrotną zależność między wielkością okręgu a wskaźnikiem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.807 wskazuje na silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości wskaźnika LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że wraz ze wzrostem wielkości okręgu, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami wyborczymi (więcej przedstawicieli wybieranych w okręgu) mają tendencję do generowania bardziej proporcjonalnych wyników (mniejsza dysproporcjonalność).</p></li>
</ol>
<p>Ustalenie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi wyborcze zapewniają mniejszym partiom więcej możliwości uzyskania reprezentacji, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="level3" data-number="16.21.5">
<h3 data-number="16.21.5" class="anchored" data-anchor-id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.21.5</span> Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</h3>
<p>Użyję wzoru na prostą regresję liniową:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Wzór na obliczenie <span class="math inline">\beta_1</span> z korektą Bessela to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{s^2_{DM}} = \frac{-7.4}{7.6} = -0.974</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, użyję:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 10.667 - (-0.974) \cdot 6 = 10.667 + 5.844 = 16.511</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.511 - 0.974 \cdot DM</span></p>
<section id="obliczanie-r-kwadrat-1" class="level4" data-number="16.21.5.1">
<h4 data-number="16.21.5.1" class="anchored" data-anchor-id="obliczanie-r-kwadrat-1"><span class="header-section-number">16.21.5.1</span> Obliczanie R-kwadrat</h4>
<p>Aby właściwie obliczyć R-kwadrat, muszę obliczyć następujące sumy kwadratów:</p>
<ul>
<li>SST (Całkowita suma kwadratów): Mierzy całkowitą zmienność zmiennej zależnej (LH)</li>
<li>SSR (Suma kwadratów regresji): Mierzy zmienność wyjaśnioną przez model regresji</li>
<li>SSE (Suma kwadratów błędów): Mierzy niewyjaśnioną zmienność modelu</li>
</ul>
<p>Najpierw obliczę przewidywane wartości LH, używając naszego równania regresji:</p>
<p><span class="math display">\hat{LH} = 16.511 - 0.974 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.511 - 0.974x_i</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td><span class="math inline">16.511 - 0.974(10) = 16.511 - 9.74 = 6.771</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td><span class="math inline">16.511 - 0.974(3) = 16.511 - 2.922 = 13.589</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td><span class="math inline">16.511 - 0.974(8) = 16.511 - 7.792 = 8.719</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td><span class="math inline">16.511 - 0.974(7) = 16.511 - 6.818 = 9.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
</tbody>
</table>
<p>Teraz, obliczę każdą sumę kwadratów:</p>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Już obliczyliśmy te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>1.333</td>
<td>1.777</td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>-2.667</td>
<td>7.113</td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>4.333</td>
<td>18.775</td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>-0.667</td>
<td>0.445</td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>-4.667</td>
<td>21.781</td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>2.333</td>
<td>5.443</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SST = 55.334</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math display">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 31%">
<col style="width: 27%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>6.771</td>
<td><span class="math inline">6.771 - 10.667 = -3.896</span></td>
<td><span class="math inline">(-3.896)^2 = 15.178</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.589</td>
<td><span class="math inline">13.589 - 10.667 = 2.922</span></td>
<td><span class="math inline">(2.922)^2 = 8.538</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8.719</td>
<td><span class="math inline">8.719 - 10.667 = -1.948</span></td>
<td><span class="math inline">(-1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>9.693</td>
<td><span class="math inline">9.693 - 10.667 = -0.974</span></td>
<td><span class="math inline">(-0.974)^2 = 0.949</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>36.05</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSR = 36.05</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math display">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 20%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">y_i - \hat{y}_i</span></th>
<th><span class="math inline">(y_i - \hat{y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">12 - 12.615 = -0.615</span></td>
<td><span class="math inline">(-0.615)^2 = 0.378</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">8 - 6.771 = 1.229</span></td>
<td><span class="math inline">(1.229)^2 = 1.510</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">15 - 13.589 = 1.411</span></td>
<td><span class="math inline">(1.411)^2 = 1.991</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">10 - 8.719 = 1.281</span></td>
<td><span class="math inline">(1.281)^2 = 1.641</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">6 - 9.693 = -3.693</span></td>
<td><span class="math inline">(-3.693)^2 = 13.638</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">13 - 12.615 = 0.385</span></td>
<td><span class="math inline">(0.385)^2 = 0.148</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>19.306</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSE = 19.306</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia, sprawdzając czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math display">55.334 \approx 36.05 + 19.306 = 55.356</span></p>
<p>Niewielka różnica (0.022) wynika z zaokrągleń w obliczeniach.</p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{36.05}{55.334} = 0.652</span></p>
<p>Alternatywnie, możemy też obliczyć:</p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{19.306}{55.334} = 1 - 0.349 = 0.651</span></p>
<p>Drobna różnica wynika z zaokrągleń.</p>
</section>
<section id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego" class="level4" data-number="16.21.5.2">
<h4 data-number="16.21.5.2" class="anchored" data-anchor-id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego"><span class="header-section-number">16.21.5.2</span> Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</h4>
<p>Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</p>
<p>RMSE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Korzystając z naszej obliczonej SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{19.306}{6}} = \sqrt{3.218} = 1.794</span></p>
<p>Korekta Bessela (dzielenie przez n-1 zamiast n) stosuje się do estymacji wariancji próby, ale nie jest standardowo stosowana przy obliczaniu RMSE, gdyż RMSE jest miarą błędu predykcji, a nie estymatorem parametru populacji.</p>
</section>
<section id="obliczanie-mae-średni-błąd-bezwzględny" class="level4" data-number="16.21.5.3">
<h4 data-number="16.21.5.3" class="anchored" data-anchor-id="obliczanie-mae-średni-błąd-bezwzględny"><span class="header-section-number">16.21.5.3</span> Obliczanie MAE (Średni błąd bezwzględny)</h4>
<p>MAE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">MAE = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 41%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">|y_i - \hat{y}_i|</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">|12 - 12.615| = 0.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">|8 - 6.771| = 1.229</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">|15 - 13.589| = 1.411</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">|10 - 8.719| = 1.281</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">|6 - 9.693| = 3.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">|13 - 12.615| = 0.385</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>8.614</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">MAE = \frac{8.614}{6} = 1.436</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.511 - 0.974 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.651</p>
<p><strong>RMSE</strong>: 1.794</p>
<p><strong>MAE</strong>: 1.436</p>
</section>
<section id="interpretacja-3" class="level4" data-number="16.21.5.4">
<h4 data-number="16.21.5.4" class="anchored" data-anchor-id="interpretacja-3"><span class="header-section-number">16.21.5.4</span> Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego jednostkowego wzrostu wielkości okręgu, wskaźnik dysproporcjonalności LH zmniejsza się o 0.974 jednostki. Wyraz wolny (16.511) reprezentuje oczekiwany wskaźnik LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.651 wskazuje, że około 65.1% wariancji dysproporcjonalności wyborczej (wskaźnik LH) może być wyjaśnione przez wielkość okręgu. Jest to dość wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej, choć mniejszym niż w poprzednim zestawie danych.</p></li>
<li><p><strong>RMSE</strong>: Wartość 1.794 informuje nas o przeciętnym błędzie prognozy modelu. Jest to miara dokładności przewidywań modelu wyrażona w jednostkach zmiennej zależnej (LH).</p></li>
<li><p><strong>MAE</strong>: Wartość 1.436 informuje nas o przeciętnym bezwzględnym błędzie prognozy modelu. W porównaniu z RMSE, MAE jest mniej czuły na wartości odstające, co potwierdza, że niektóre obserwacje (np. dla kraju E) mają stosunkowo duży błąd predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Wyniki sugerują, że zwiększenie wielkości okręgu mogłoby być skuteczną strategią reform wyborczych dla krajów starających się zmniejszyć dysproporcjonalność między głosami a mandatami. Jednakże, korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać we wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="level2" data-number="16.22">
<h2 data-number="16.22" class="anchored" data-anchor-id="example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">16.22</span> Example 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*)</h2>
<section id="data-generating-process" class="level3" data-number="16.22.1">
<h3 data-number="16.22.1" class="anchored" data-anchor-id="data-generating-process"><span class="header-section-number">16.22.1</span> Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<p><span class="math display">\begin{aligned}
&amp; Y_{\text{Gallagher}} = 12 - 0.8X_{\text{DM}} + \varepsilon \\
&amp; \varepsilon \sim \mathcal{N}(0, 1) \\
&amp; X_{\text{DM}} \in \{3, 5, 7, 10, 12, 15\}
\end{aligned}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-1" class="level3" data-number="16.22.2">
<h3 data-number="16.22.2" class="anchored" data-anchor-id="descriptive-statistics-1"><span class="header-section-number">16.22.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667</span></p>
<p><span class="math display">\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">
32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332
</span></p>
<p><span class="math display">s^2_X = \frac{101.3332}{5} = 20.2666</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">s^2_Y = \frac{56.3483}{5} = 11.2697</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-2" class="level3" data-number="16.22.3">
<h3 data-number="16.22.3" class="anchored" data-anchor-id="covariance-and-correlation-2"><span class="header-section-number">16.22.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">s_{XY} = \frac{-70.3670}{5} = -14.0734</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="level3" data-number="16.22.4">
<h3 data-number="16.22.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">16.22.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-0.6944 × 8.6667 = -6.0181</span></li>
<li><span class="math inline">\hat{\beta_0} = 5.7167 - (-6.0181) = 11.7348</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation-1" class="level3" data-number="16.22.5">
<h3 data-number="16.22.5" class="anchored" data-anchor-id="r-squared-calculation-1"><span class="header-section-number">16.22.5</span> R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 11.7348 - 0.6944X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 56.3483</span> <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271</span> <span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3" data-number="16.22.6">
<h3 data-number="16.22.6" class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters"><span class="header-section-number">16.22.6</span> Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-23"><a href="#cb226-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb226-24"><a href="#cb226-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb226-25"><a href="#cb226-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb226-26"><a href="#cb226-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb226-27"><a href="#cb226-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb226-28"><a href="#cb226-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb226-29"><a href="#cb226-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb226-30"><a href="#cb226-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb226-31"><a href="#cb226-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb226-32"><a href="#cb226-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb226-33"><a href="#cb226-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb226-34"><a href="#cb226-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb226-35"><a href="#cb226-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb226-36"><a href="#cb226-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb226-37"><a href="#cb226-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb226-38"><a href="#cb226-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb226-39"><a href="#cb226-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb226-40"><a href="#cb226-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb226-41"><a href="#cb226-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb226-42"><a href="#cb226-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb226-43"><a href="#cb226-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb226-44"><a href="#cb226-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb226-45"><a href="#cb226-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3" data-number="16.22.7">
<h3 data-number="16.22.7" class="anchored" data-anchor-id="observations-about-model-fit"><span class="header-section-number">16.22.7</span> Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation-2" class="level3" data-number="16.22.8">
<h3 data-number="16.22.8" class="anchored" data-anchor-id="interpretation-2"><span class="header-section-number">16.22.8</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3" data-number="16.22.9">
<h3 data-number="16.22.9" class="anchored" data-anchor-id="study-context"><span class="header-section-number">16.22.9</span> Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3" data-number="16.22.10">
<h3 data-number="16.22.10" class="anchored" data-anchor-id="limitations"><span class="header-section-number">16.22.10</span> Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./correg_en.html" class="pagination-link" aria-label="Introduction to Correlation and Regression Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./probability_en.html" class="pagination-link" aria-label="Introduction to (Discrete) Probability">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>