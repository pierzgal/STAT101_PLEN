<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Wprowadzenie do analizy korelacji i regresji (Correlation and Regression Analysis) – Social Data Analysis: An Introduction (PL: Wprowadzenie do Analizy Danych Społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./probability_en.html" rel="next">
<link href="./correg_en.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c27fdc8e5b00b532d2d5a75ada188648.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_pl.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wprowadzenie do analizy korelacji i regresji <em>(Correlation and Regression Analysis)</em></span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (PL: Wprowadzenie do Analizy Danych Społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistics and Data Analysis for Political Science</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do statystyki i analizy danych dla politologii</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wprowadzenie do analizy korelacji i regresji <em>(Correlation and Regression Analysis)</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#wprowadzenie-introduction" id="toc-wprowadzenie-introduction" class="nav-link active" data-scroll-target="#wprowadzenie-introduction"><span class="header-section-number">14.1</span> Wprowadzenie <em>(Introduction)</em></a></li>
  <li><a href="#kowariancja-covariance" id="toc-kowariancja-covariance" class="nav-link" data-scroll-target="#kowariancja-covariance"><span class="header-section-number">14.2</span> Kowariancja <em>(Covariance)</em></a>
  <ul class="collapse">
  <li><a href="#obliczenia-ręczne-krok-po-kroku-step-by-step-manual-calculation-process" id="toc-obliczenia-ręczne-krok-po-kroku-step-by-step-manual-calculation-process" class="nav-link" data-scroll-target="#obliczenia-ręczne-krok-po-kroku-step-by-step-manual-calculation-process">Obliczenia ręczne krok po kroku <em>(Step-by-Step Manual Calculation Process)</em></a></li>
  <li><a href="#zadanie-ćwiczeniowe-z-rozwiązaniem-practice-problem-with-solution" id="toc-zadanie-ćwiczeniowe-z-rozwiązaniem-practice-problem-with-solution" class="nav-link" data-scroll-target="#zadanie-ćwiczeniowe-z-rozwiązaniem-practice-problem-with-solution">Zadanie ćwiczeniowe z rozwiązaniem <em>(Practice Problem with Solution)</em></a></li>
  </ul></li>
  <li><a href="#współczynnik-korelacji-correlation-coefficient" id="toc-współczynnik-korelacji-correlation-coefficient" class="nav-link" data-scroll-target="#współczynnik-korelacji-correlation-coefficient"><span class="header-section-number">14.3</span> Współczynnik korelacji <em>(Correlation Coefficient)</em></a>
  <ul class="collapse">
  <li><a href="#wskazówki-interpretacyjne-interpretation-guidelines" id="toc-wskazówki-interpretacyjne-interpretation-guidelines" class="nav-link" data-scroll-target="#wskazówki-interpretacyjne-interpretation-guidelines">Wskazówki interpretacyjne <em>(Interpretation Guidelines)</em></a></li>
  <li><a href="#wizualizacja-typów-zależności-korelacyjnych-types-of-correlations-visualization" id="toc-wizualizacja-typów-zależności-korelacyjnych-types-of-correlations-visualization" class="nav-link" data-scroll-target="#wizualizacja-typów-zależności-korelacyjnych-types-of-correlations-visualization">Wizualizacja typów zależności korelacyjnych <em>(Types of Correlations Visualization)</em></a></li>
  </ul></li>
  <li><a href="#korelacja-pearsona-pearson-correlation" id="toc-korelacja-pearsona-pearson-correlation" class="nav-link" data-scroll-target="#korelacja-pearsona-pearson-correlation"><span class="header-section-number">14.4</span> Korelacja Pearsona <em>(Pearson Correlation)</em></a>
  <ul class="collapse">
  <li><a href="#pełny-przykład-obliczeń-ręcznych-complete-manual-calculation-example" id="toc-pełny-przykład-obliczeń-ręcznych-complete-manual-calculation-example" class="nav-link" data-scroll-target="#pełny-przykład-obliczeń-ręcznych-complete-manual-calculation-example">Pełny przykład obliczeń ręcznych <em>(Complete Manual Calculation Example)</em></a></li>
  </ul></li>
  <li><a href="#korelacja-rang-spearmana-spearman-rank-correlation" id="toc-korelacja-rang-spearmana-spearman-rank-correlation" class="nav-link" data-scroll-target="#korelacja-rang-spearmana-spearman-rank-correlation"><span class="header-section-number">14.5</span> Korelacja rang Spearmana <em>(Spearman Rank Correlation)</em></a>
  <ul class="collapse">
  <li><a href="#pełny-przykład-obliczeń-ręcznych-complete-manual-example" id="toc-pełny-przykład-obliczeń-ręcznych-complete-manual-example" class="nav-link" data-scroll-target="#pełny-przykład-obliczeń-ręcznych-complete-manual-example">Pełny przykład obliczeń ręcznych <em>(Complete Manual Example)</em></a></li>
  </ul></li>
  <li><a href="#tabele-krzyżowe-cross-tabulation-i-dane-kategoryczne" id="toc-tabele-krzyżowe-cross-tabulation-i-dane-kategoryczne" class="nav-link" data-scroll-target="#tabele-krzyżowe-cross-tabulation-i-dane-kategoryczne"><span class="header-section-number">14.6</span> Tabele krzyżowe <em>(Cross-tabulation)</em> i dane kategoryczne</a></li>
  <li><a href="#ćwiczenia-praktyczne-z-rozwiązaniami-practical-exercises-with-solutions" id="toc-ćwiczenia-praktyczne-z-rozwiązaniami-practical-exercises-with-solutions" class="nav-link" data-scroll-target="#ćwiczenia-praktyczne-z-rozwiązaniami-practical-exercises-with-solutions"><span class="header-section-number">14.7</span> Ćwiczenia praktyczne z rozwiązaniami <em>(Practical Exercises with Solutions)</em></a>
  <ul class="collapse">
  <li><a href="#ćwiczenie-1-ręczne-obliczenie-korelacji-pearsona-calculate-pearson-correlation-manually" id="toc-ćwiczenie-1-ręczne-obliczenie-korelacji-pearsona-calculate-pearson-correlation-manually" class="nav-link" data-scroll-target="#ćwiczenie-1-ręczne-obliczenie-korelacji-pearsona-calculate-pearson-correlation-manually">Ćwiczenie 1: Ręczne obliczenie korelacji Pearsona <em>(Calculate Pearson Correlation Manually)</em></a></li>
  <li><a href="#ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana-calculate-spearman-correlation-manually" id="toc-ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana-calculate-spearman-correlation-manually" class="nav-link" data-scroll-target="#ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana-calculate-spearman-correlation-manually">Ćwiczenie 2: Ręczne obliczenie korelacji Spearmana <em>(Calculate Spearman Correlation Manually)</em></a></li>
  <li><a href="#ćwiczenie-3-interpretacja-wyników-interpretation-practice" id="toc-ćwiczenie-3-interpretacja-wyników-interpretation-practice" class="nav-link" data-scroll-target="#ćwiczenie-3-interpretacja-wyników-interpretation-practice">Ćwiczenie 3: Interpretacja wyników <em>(Interpretation Practice)</em></a></li>
  </ul></li>
  <li><a href="#najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember" id="toc-najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember" class="nav-link" data-scroll-target="#najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember"><span class="header-section-number">14.8</span> Najważniejsze rzeczy do zapamiętania <em>(Important Points to Remember)</em></a></li>
  <li><a href="#podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis" id="toc-podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis" class="nav-link" data-scroll-target="#podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis"><span class="header-section-number">14.9</span> Podsumowanie: drzewko decyzyjne do analizy korelacji <em>(Summary: Decision Tree for Correlation Analysis)</em></a></li>
  <li><a href="#dodatkowe-zadania-additional-practice-problems" id="toc-dodatkowe-zadania-additional-practice-problems" class="nav-link" data-scroll-target="#dodatkowe-zadania-additional-practice-problems"><span class="header-section-number">14.10</span> Dodatkowe zadania <em>(Additional Practice Problems)</em></a>
  <ul class="collapse">
  <li><a href="#zestaw-zadań-a-obliczenia-ręczne-problem-set-a-manual-calculations" id="toc-zestaw-zadań-a-obliczenia-ręczne-problem-set-a-manual-calculations" class="nav-link" data-scroll-target="#zestaw-zadań-a-obliczenia-ręczne-problem-set-a-manual-calculations">Zestaw zadań A: obliczenia ręczne <em>(Problem Set A: Manual Calculations)</em></a></li>
  <li><a href="#zestaw-zadań-b-interpretacja-problem-set-b-interpretation" id="toc-zestaw-zadań-b-interpretacja-problem-set-b-interpretation" class="nav-link" data-scroll-target="#zestaw-zadań-b-interpretacja-problem-set-b-interpretation">Zestaw zadań B: interpretacja <em>(Problem Set B: Interpretation)</em></a></li>
  <li><a href="#ściąga-quick-reference-card" id="toc-ściąga-quick-reference-card" class="nav-link" data-scroll-target="#ściąga-quick-reference-card">Ściąga <em>(Quick Reference Card)</em></a></li>
  </ul></li>
  <li><a href="#analiza-regresji-ols-ordinary-least-squares-przewodnik-na-start-a-quick-start-guide" id="toc-analiza-regresji-ols-ordinary-least-squares-przewodnik-na-start-a-quick-start-guide" class="nav-link" data-scroll-target="#analiza-regresji-ols-ordinary-least-squares-przewodnik-na-start-a-quick-start-guide"><span class="header-section-number">14.11</span> Analiza regresji OLS <em>(Ordinary Least Squares)</em>: przewodnik na start <em>(A Quick-start Guide)</em></a></li>
  <li><a href="#appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający" id="toc-appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający" class="nav-link" data-scroll-target="#appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający"><span class="header-section-number">14.15</span> Appendix A: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład wprowadzający</a>
  <ul class="collapse">
  <li><a href="#krok-1-obliczanie-podstawowych-statystyk" id="toc-krok-1-obliczanie-podstawowych-statystyk" class="nav-link" data-scroll-target="#krok-1-obliczanie-podstawowych-statystyk">Krok 1: Obliczanie Podstawowych Statystyk</a></li>
  <li><a href="#krok-2-szczegółowe-obliczenia-kowariancji" id="toc-krok-2-szczegółowe-obliczenia-kowariancji" class="nav-link" data-scroll-target="#krok-2-szczegółowe-obliczenia-kowariancji">Krok 2: Szczegółowe Obliczenia Kowariancji</a></li>
  <li><a href="#krok-3-obliczanie-odchylenia-standardowego" id="toc-krok-3-obliczanie-odchylenia-standardowego" class="nav-link" data-scroll-target="#krok-3-obliczanie-odchylenia-standardowego">Krok 3: Obliczanie Odchylenia Standardowego</a></li>
  <li><a href="#krok-4-obliczanie-korelacji-pearsona" id="toc-krok-4-obliczanie-korelacji-pearsona" class="nav-link" data-scroll-target="#krok-4-obliczanie-korelacji-pearsona">Krok 4: Obliczanie Korelacji Pearsona</a></li>
  <li><a href="#krok-5-obliczanie-korelacji-rangowej-spearmana" id="toc-krok-5-obliczanie-korelacji-rangowej-spearmana" class="nav-link" data-scroll-target="#krok-5-obliczanie-korelacji-rangowej-spearmana">Krok 5: Obliczanie Korelacji Rangowej Spearmana</a></li>
  <li><a href="#krok-6-weryfikacja-w-r" id="toc-krok-6-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-6-weryfikacja-w-r">Krok 6: Weryfikacja w R</a></li>
  <li><a href="#krok-7-podstawowa-wizualizacja" id="toc-krok-7-podstawowa-wizualizacja" class="nav-link" data-scroll-target="#krok-7-podstawowa-wizualizacja">Krok 7: Podstawowa Wizualizacja</a></li>
  <li><a href="#estymacja-ols-i-miary-dopasowania-modelu" id="toc-estymacja-ols-i-miary-dopasowania-modelu" class="nav-link" data-scroll-target="#estymacja-ols-i-miary-dopasowania-modelu">Estymacja OLS i Miary Dopasowania Modelu</a></li>
  <li><a href="#krok-1-obliczanie-estymatorów-ols" id="toc-krok-1-obliczanie-estymatorów-ols" class="nav-link" data-scroll-target="#krok-1-obliczanie-estymatorów-ols">Krok 1: Obliczanie Estymatorów OLS</a></li>
  <li><a href="#krok-2-obliczanie-wartości-dopasowanych-i-reszt" id="toc-krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="nav-link" data-scroll-target="#krok-2-obliczanie-wartości-dopasowanych-i-reszt">Krok 2: Obliczanie Wartości Dopasowanych i Reszt</a></li>
  <li><a href="#krok-3-obliczanie-miar-dopasowania" id="toc-krok-3-obliczanie-miar-dopasowania" class="nav-link" data-scroll-target="#krok-3-obliczanie-miar-dopasowania">Krok 3: Obliczanie Miar Dopasowania</a></li>
  <li><a href="#krok-4-weryfikacja-w-r" id="toc-krok-4-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-4-weryfikacja-w-r">Krok 4: Weryfikacja w R</a></li>
  <li><a href="#krok-5-analiza-reszt" id="toc-krok-5-analiza-reszt" class="nav-link" data-scroll-target="#krok-5-analiza-reszt">Krok 5: Analiza Reszt</a></li>
  <li><a href="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" id="toc-krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="nav-link" data-scroll-target="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych">Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</a></li>
  <li><a href="#modele-z-transformacją-logarytmiczną" id="toc-modele-z-transformacją-logarytmiczną" class="nav-link" data-scroll-target="#modele-z-transformacją-logarytmiczną">Modele z Transformacją Logarytmiczną</a></li>
  <li><a href="#krok-1-transformacja-danych" id="toc-krok-1-transformacja-danych" class="nav-link" data-scroll-target="#krok-1-transformacja-danych">Krok 1: Transformacja Danych</a></li>
  <li><a href="#krok-2-porównanie-różnych-specyfikacji-modelu" id="toc-krok-2-porównanie-różnych-specyfikacji-modelu" class="nav-link" data-scroll-target="#krok-2-porównanie-różnych-specyfikacji-modelu">Krok 2: Porównanie Różnych Specyfikacji Modelu</a></li>
  <li><a href="#krok-3-porównanie-wizualne" id="toc-krok-3-porównanie-wizualne" class="nav-link" data-scroll-target="#krok-3-porównanie-wizualne">Krok 3: Porównanie Wizualne</a></li>
  <li><a href="#krok-4-analiza-reszt-dla-najlepszego-modelu" id="toc-krok-4-analiza-reszt-dla-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-4-analiza-reszt-dla-najlepszego-modelu">Krok 4: Analiza Reszt dla Najlepszego Modelu</a></li>
  <li><a href="#krok-5-interpretacja-najlepszego-modelu" id="toc-krok-5-interpretacja-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-5-interpretacja-najlepszego-modelu">Krok 5: Interpretacja Najlepszego Modelu</a></li>
  <li><a href="#krok-6-predykcje-modelu" id="toc-krok-6-predykcje-modelu" class="nav-link" data-scroll-target="#krok-6-predykcje-modelu">Krok 6: Predykcje Modelu</a></li>
  <li><a href="#krok-7-analiza-elastyczności" id="toc-krok-7-analiza-elastyczności" class="nav-link" data-scroll-target="#krok-7-analiza-elastyczności">Krok 7: Analiza Elastyczności</a></li>
  </ul></li>
  <li><a href="#appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne" id="toc-appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne" class="nav-link" data-scroll-target="#appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne"><span class="header-section-number">14.16</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - przykłady różne</a></li>
  <li><a href="#przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą" id="toc-przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą" class="nav-link" data-scroll-target="#przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą"><span class="header-section-number">14.17</span> Przykład 1. Analiza związku między dobrobytem ekonomicznym a frekwencją wyborczą</a>
  <ul class="collapse">
  <li><a href="#dane" id="toc-dane" class="nav-link" data-scroll-target="#dane">Dane</a></li>
  <li><a href="#część-1-statystyki-opisowe" id="toc-część-1-statystyki-opisowe" class="nav-link" data-scroll-target="#część-1-statystyki-opisowe">Część 1: Statystyki opisowe</a></li>
  <li><a href="#część-2-analiza-korelacji" id="toc-część-2-analiza-korelacji" class="nav-link" data-scroll-target="#część-2-analiza-korelacji">Część 2: Analiza korelacji</a></li>
  <li><a href="#część-3-model-regresji-liniowej" id="toc-część-3-model-regresji-liniowej" class="nav-link" data-scroll-target="#część-3-model-regresji-liniowej">Część 3: Model regresji liniowej</a></li>
  <li><a href="#część-4-wizualizacja" id="toc-część-4-wizualizacja" class="nav-link" data-scroll-target="#część-4-wizualizacja">Część 4: Wizualizacja</a></li>
  <li><a href="#część-5-interpretacja-wyników" id="toc-część-5-interpretacja-wyników" class="nav-link" data-scroll-target="#część-5-interpretacja-wyników">Część 5: Interpretacja wyników</a></li>
  <li><a href="#wnioski" id="toc-wnioski" class="nav-link" data-scroll-target="#wnioski">Wnioski</a></li>
  </ul></li>
  <li><a href="#przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" id="toc-przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="nav-link" data-scroll-target="#przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">14.18</span> Przykład 2. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</a>
  <ul class="collapse">
  <li><a href="#dane-1" id="toc-dane-1" class="nav-link" data-scroll-target="#dane-1">Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</a></li>
  <li><a href="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#przykład-3.-descriptive-statistics-and-ols-example---income-and-voter-turnout-en" id="toc-przykład-3.-descriptive-statistics-and-ols-example---income-and-voter-turnout-en" class="nav-link" data-scroll-target="#przykład-3.-descriptive-statistics-and-ols-example---income-and-voter-turnout-en"><span class="header-section-number">14.19</span> Przykład 3. Descriptive Statistics and OLS Example - Income and Voter Turnout [EN]</a>
  <ul class="collapse">
  <li><a href="#initial-r-output-for-reference" id="toc-initial-r-output-for-reference" class="nav-link" data-scroll-target="#initial-r-output-for-reference">Initial R Output for Reference</a></li>
  <li><a href="#dispersion-measures" id="toc-dispersion-measures" class="nav-link" data-scroll-target="#dispersion-measures">Dispersion Measures</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation">Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#detailed-decomposition-of-variance-and-r-squared" id="toc-detailed-decomposition-of-variance-and-r-squared" class="nav-link" data-scroll-target="#detailed-decomposition-of-variance-and-r-squared">Detailed Decomposition of Variance and R-squared</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  </ul></li>
  <li><a href="#przykład-4.-anxiety-levels-and-cognitive-performance-a-laboratory-study-en" id="toc-przykład-4.-anxiety-levels-and-cognitive-performance-a-laboratory-study-en" class="nav-link" data-scroll-target="#przykład-4.-anxiety-levels-and-cognitive-performance-a-laboratory-study-en"><span class="header-section-number">14.20</span> Przykład 4. Anxiety Levels and Cognitive Performance: A Laboratory Study [EN]</a>
  <ul class="collapse">
  <li><a href="#data-and-context" id="toc-data-and-context" class="nav-link" data-scroll-target="#data-and-context">Data and Context</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-1" id="toc-covariance-and-correlation-1" class="nav-link" data-scroll-target="#covariance-and-correlation-1">Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-1" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-1">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation" id="toc-r-squared-calculation" class="nav-link" data-scroll-target="#r-squared-calculation">4. R-squared Calculation</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1">Visualization</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  <li><a href="#study-limitations" id="toc-study-limitations" class="nav-link" data-scroll-target="#study-limitations">Study Limitations</a></li>
  </ul></li>
  <li><a href="#przykład-5.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" id="toc-przykład-5.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="nav-link" data-scroll-target="#przykład-5.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">14.21</span> Przykład 5. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</a>
  <ul class="collapse">
  <li><a href="#dane-2" id="toc-dane-2" class="nav-link" data-scroll-target="#dane-2">Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</a></li>
  <li><a href="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#przykład-6.-analiza-korelacji-i-regresji-podejście-z-obliczeniami-manualnymi" id="toc-przykład-6.-analiza-korelacji-i-regresji-podejście-z-obliczeniami-manualnymi" class="nav-link" data-scroll-target="#przykład-6.-analiza-korelacji-i-regresji-podejście-z-obliczeniami-manualnymi"><span class="header-section-number">14.22</span> Przykład 6. Analiza Korelacji i Regresji: Podejście z Obliczeniami Manualnymi</a>
  <ul class="collapse">
  <li><a href="#prezentacja-danych" id="toc-prezentacja-danych" class="nav-link" data-scroll-target="#prezentacja-danych">Prezentacja Danych</a></li>
  <li><a href="#statystyki-opisowe" id="toc-statystyki-opisowe" class="nav-link" data-scroll-target="#statystyki-opisowe">Statystyki Opisowe</a></li>
  <li><a href="#kowariancja-i-korelacja" id="toc-kowariancja-i-korelacja" class="nav-link" data-scroll-target="#kowariancja-i-korelacja">Kowariancja i Korelacja</a></li>
  <li><a href="#prosta-regresja-mnk" id="toc-prosta-regresja-mnk" class="nav-link" data-scroll-target="#prosta-regresja-mnk">Prosta Regresja MNK</a></li>
  <li><a href="#wykres-modelu" id="toc-wykres-modelu" class="nav-link" data-scroll-target="#wykres-modelu">Wykres Modelu</a></li>
  <li><a href="#ocena-modelu" id="toc-ocena-modelu" class="nav-link" data-scroll-target="#ocena-modelu">Ocena Modelu</a></li>
  <li><a href="#wielkość-efektu" id="toc-wielkość-efektu" class="nav-link" data-scroll-target="#wielkość-efektu">Wielkość Efektu</a></li>
  <li><a href="#przedziały-ufności-i-istotność-statystyczna" id="toc-przedziały-ufności-i-istotność-statystyczna" class="nav-link" data-scroll-target="#przedziały-ufności-i-istotność-statystyczna">Przedziały Ufności i Istotność Statystyczna</a></li>
  <li><a href="#podsumowanie-i-interpretacja" id="toc-podsumowanie-i-interpretacja" class="nav-link" data-scroll-target="#podsumowanie-i-interpretacja">Podsumowanie i Interpretacja</a></li>
  <li><a href="#dodatek-kompletny-kod-r" id="toc-dodatek-kompletny-kod-r" class="nav-link" data-scroll-target="#dodatek-kompletny-kod-r">Dodatek: Kompletny Kod R</a></li>
  </ul></li>
  <li><a href="#przykład-7.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en" id="toc-przykład-7.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en" class="nav-link" data-scroll-target="#przykład-7.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en"><span class="header-section-number">14.23</span> Przykład 7. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*) [EN]</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process">Data Generating Process</a></li>
  <li><a href="#descriptive-statistics-1" id="toc-descriptive-statistics-1" class="nav-link" data-scroll-target="#descriptive-statistics-1">Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-2" id="toc-covariance-and-correlation-2" class="nav-link" data-scroll-target="#covariance-and-correlation-2">Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-2" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-2">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation-1" id="toc-r-squared-calculation-1" class="nav-link" data-scroll-target="#r-squared-calculation-1">R-squared Calculation</a></li>
  <li><a href="#visualization---true-vs.-estimated-parameters" id="toc-visualization---true-vs.-estimated-parameters" class="nav-link" data-scroll-target="#visualization---true-vs.-estimated-parameters">Visualization - True vs.&nbsp;Estimated Parameters</a></li>
  <li><a href="#observations-about-model-fit" id="toc-observations-about-model-fit" class="nav-link" data-scroll-target="#observations-about-model-fit">Observations about Model Fit</a></li>
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2">Interpretation</a></li>
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context">Study Context</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wprowadzenie do analizy korelacji i regresji <em>(Correlation and Regression Analysis)</em></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="wprowadzenie-introduction" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="wprowadzenie-introduction"><span class="header-section-number">14.1</span> Wprowadzenie <em>(Introduction)</em></h2>
<p>Różnica między <strong>korelacją (correlation)</strong> a <strong>przyczynowością/kausalnością (causation)</strong> to jedno z podstawowych wyzwań w analizie statystycznej. Korelacja mierzy statystyczny związek między zmiennymi, natomiast przyczynowość oznacza bezpośredni wpływ jednej zmiennej na drugą.</p>
<p>Zależności statystyczne stanowią fundament podejmowania decyzji opartych na danych w wielu dyscyplinach — od ekonomii i zdrowia publicznego po psychologię i nauki o środowisku. Zrozumienie, kiedy związek wskazuje jedynie na <strong>asocjację (association)</strong>, a kiedy na <strong>prawdziwą kausalność (genuine causality)</strong>, jest kluczowe dla poprawnych wniosków i skutecznych rekomendacji politycznych.</p>
</section>
<section id="kowariancja-covariance" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="kowariancja-covariance"><span class="header-section-number">14.2</span> Kowariancja <em>(Covariance)</em></h2>
<p><strong>Kowariancja (covariance)</strong> mierzy, w jaki sposób dwie zmienne współzmieniają się, wskazując zarówno <strong>kierunek</strong>, jak i <strong>siłę</strong> ich <strong>liniowego</strong> związku.</p>
<p><strong>Wzór (z próby):</strong></p>
<p><span class="math display">
\operatorname{cov}(X,Y)
= \frac{\sum_{i=1}^{n} (x_i - \bar x)(y_i - \bar y)}{n - 1}.
</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">x_i</span> i <span class="math inline">y_i</span> to poszczególne obserwacje,</li>
<li><span class="math inline">\bar{x}</span> i <span class="math inline">\bar{y}</span> to średnie odpowiednio zmiennych <span class="math inline">X</span> i <span class="math inline">Y</span>,</li>
<li><span class="math inline">n</span> to liczba obserwacji,</li>
<li>dzielimy przez <span class="math inline">(n-1)</span>, ponieważ liczymy <strong>kowariancję z próby</strong> (tzw. poprawka Bessela; <em>Bessel’s correction</em>).</li>
</ul>
<section id="obliczenia-ręczne-krok-po-kroku-step-by-step-manual-calculation-process" class="level3">
<h3 class="anchored" data-anchor-id="obliczenia-ręczne-krok-po-kroku-step-by-step-manual-calculation-process">Obliczenia ręczne krok po kroku <em>(Step-by-Step Manual Calculation Process)</em></h3>
<p><strong>Przykład 1: Godziny nauki a wyniki testu</strong></p>
<p>Dane:</p>
<ul>
<li>Godziny nauki (X): 2, 4, 6, 8, 10</li>
<li>Wyniki testu (Y): 65, 70, 80, 85, 95</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 61%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Krok</th>
<th>Opis</th>
<th>Obliczenia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>Oblicz średnie</td>
<td><span class="math inline">\bar{x}=\frac{2+4+6+8+10}{5}=6</span> godz.</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td><span class="math inline">\bar{y}=\frac{65+70+80+85+95}{5}=79</span> pkt</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td>Odchylenia od średnich</td>
<td><span class="math inline">(x_i-\bar{x})</span>: -4, -2, 0, 2, 4</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td><span class="math inline">(y_i-\bar{y})</span>: -14, -9, 1, 6, 16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>Iloczyny odchyleń</td>
<td><span class="math inline">(x_i-\bar{x})(y_i-\bar{y})</span>: 56, 18, 0, 12, 64</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>Suma iloczynów</td>
<td><span class="math inline">\sum = 56+18+0+12+64=150</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>Podziel przez <span class="math inline">(n-1)</span></td>
<td><span class="math inline">\operatorname{cov}(X,Y)=\frac{150}{5-1}=\frac{150}{4}=37.5</span></td>
</tr>
</tbody>
</table>
<p><strong>Weryfikacja w R (R Verification):</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definicja danych</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>test_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Kowariancja</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cov_manual <span class="ot">&lt;-</span> <span class="fu">cov</span>(study_hours, test_scores)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Covariance:"</span>, <span class="fu">round</span>(cov_manual, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Covariance: 37.5"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja krok po kroku</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(study_hours)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(test_scores)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_dev <span class="ot">&lt;-</span> study_hours <span class="sc">-</span> x_mean</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>y_dev <span class="ot">&lt;-</span> test_scores <span class="sc">-</span> y_mean</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>products <span class="ot">&lt;-</span> x_dev <span class="sc">*</span> y_dev</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>cov_calculated <span class="ot">&lt;-</span> <span class="fu">sum</span>(products) <span class="sc">/</span> (<span class="fu">length</span>(study_hours) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela obliczeń</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> study_hours,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> test_scores,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_deviation =</span> x_dev,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_deviation =</span> y_dev,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product =</span> products</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y X_deviation Y_deviation Product
1  2 65          -4         -14      56
2  4 70          -2          -9      18
3  6 80           0           1       0
4  8 85           2           6      12
5 10 95           4          16      64</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> Dodatnia kowariancja (37.5) wskazuje, że wraz ze wzrostem liczby godzin nauki rosną także wyniki testu — zmienne mają tendencję do wspólnego wzrostu.</p>
</section>
<section id="zadanie-ćwiczeniowe-z-rozwiązaniem-practice-problem-with-solution" class="level3">
<h3 class="anchored" data-anchor-id="zadanie-ćwiczeniowe-z-rozwiązaniem-practice-problem-with-solution">Zadanie ćwiczeniowe z rozwiązaniem <em>(Practice Problem with Solution)</em></h3>
<p><strong>Policz ręcznie kowariancję dla:</strong></p>
<ul>
<li>Temperatura (°F): 32, 50, 68, 86, 95</li>
<li>Sprzedaż lodów ($): 100, 200, 400, 600, 800</li>
</ul>
<p><strong>Rozwiązanie:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Krok</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1. Średnie</td>
<td><span class="math inline">\bar{x}=\frac{32+50+68+86+95}{5}=66.2^{\circ}\mathrm{F}</span></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td><span class="math inline">\bar{y}=\frac{100+200+400+600+800}{5}=420</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2. Odchylenia</td>
<td>X: -34.2, -16.2, 1.8, 19.8, 28.8</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td>Y: -320, -220, -20, 180, 380</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3. Iloczyny</td>
<td>10944, 3564, -36, 3564, 10944</td>
</tr>
<tr class="even">
<td style="text-align: right;">4. Suma</td>
<td>28980</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5. Kowariancja</td>
<td><span class="math inline">\frac{28980}{4}=7245</span></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja zadania</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">50</span>, <span class="dv">68</span>, <span class="dv">86</span>, <span class="dv">95</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>sales <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">600</span>, <span class="dv">800</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Covariance for practice problem:"</span>, <span class="fu">round</span>(<span class="fu">cov</span>(temp, sales), <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Covariance for practice problem: 7245"</code></pre>
</div>
</div>
</section>
</section>
<section id="współczynnik-korelacji-correlation-coefficient" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="współczynnik-korelacji-correlation-coefficient"><span class="header-section-number">14.3</span> Współczynnik korelacji <em>(Correlation Coefficient)</em></h2>
<p><strong>Współczynnik korelacji (correlation coefficient)</strong> standaryzuje kowariancję, usuwając zależność od skali i przyjmując wartości od -1 do +1.</p>
<section id="wskazówki-interpretacyjne-interpretation-guidelines" class="level3">
<h3 class="anchored" data-anchor-id="wskazówki-interpretacyjne-interpretation-guidelines">Wskazówki interpretacyjne <em>(Interpretation Guidelines)</em></h3>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 23%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Wartość korelacji</th>
<th style="text-align: left;">Siła</th>
<th style="text-align: left;">Interpretacja</th>
<th style="text-align: left;">Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">±0.90 do ±1.00</td>
<td style="text-align: left;">Bardzo silna</td>
<td style="text-align: left;">Niemal doskonały związek</td>
<td style="text-align: left;">Wzrost rodziców i dzieci</td>
</tr>
<tr class="even">
<td style="text-align: left;">±0.70 do ±0.89</td>
<td style="text-align: left;">Silna</td>
<td style="text-align: left;">Zmienne silnie powiązane</td>
<td style="text-align: left;">Czas nauki i oceny</td>
</tr>
<tr class="odd">
<td style="text-align: left;">±0.50 do ±0.69</td>
<td style="text-align: left;">Umiarkowana</td>
<td style="text-align: left;">Umiarkowany związek</td>
<td style="text-align: left;">Ćwiczenia a spadek masy</td>
</tr>
<tr class="even">
<td style="text-align: left;">±0.30 do ±0.49</td>
<td style="text-align: left;">Słaba</td>
<td style="text-align: left;">Słaby związek</td>
<td style="text-align: left;">Rozmiar buta a umiejętność czytania</td>
</tr>
<tr class="odd">
<td style="text-align: left;">±0.00 do ±0.29</td>
<td style="text-align: left;">Bardzo słaba/brak</td>
<td style="text-align: left;">Znikomy lub brak związku</td>
<td style="text-align: left;">Miesiąc urodzenia a inteligencja</td>
</tr>
</tbody>
</table>
</section>
<section id="wizualizacja-typów-zależności-korelacyjnych-types-of-correlations-visualization" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-typów-zależności-korelacyjnych-types-of-correlations-visualization">Wizualizacja typów zależności korelacyjnych <em>(Types of Correlations Visualization)</em></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie przykładowych danych dla różnych wzorców korelacji</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodatnia zależność liniowa</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>years_education <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">3</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>annual_income <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="sc">+</span> <span class="dv">3500</span> <span class="sc">*</span> years_education <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>pos_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(years_education, annual_income), <span class="dv">3</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ujemna zależność liniowa</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>screen_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>sleep_hours <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> screen_time <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>neg_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(screen_time, sleep_hours), <span class="dv">3</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Brak korelacji</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>x_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>y_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>no_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(x_random, y_random), <span class="dv">3</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Nieliniowa zależność (kwadratowa)</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>hours_studied <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">12</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>test_score <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (hours_studied <span class="sc">-</span> <span class="dv">6</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">90</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>nonlin_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(hours_studied, test_score), <span class="dv">3</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Ramki danych z wartościami korelacji</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>positive_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> years_education, </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> annual_income,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Dodatnia liniowa (r = "</span>, pos_cor, <span class="st">")"</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>negative_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> screen_time, </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> sleep_hours,</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Ujemna liniowa (r = "</span>, neg_cor, <span class="st">")"</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>no_corr_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_random, </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_random,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Brak korelacji (r = "</span>, no_cor, <span class="st">")"</span>)</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>nonlinear_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> hours_studied, </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> test_score,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Nieliniowa (Pearson r = "</span>, nonlin_cor, <span class="st">")"</span>)</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Połączenie danych</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(positive_data, negative_data, no_corr_data, nonlinear_data)</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres fasetowy</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Różne typy korelacji"</span>,</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Linia regresji liniowej (na czerwono) z pasmem ufności"</span>,</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>)</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/correlation_types-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="korelacja-pearsona-pearson-correlation" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="korelacja-pearsona-pearson-correlation"><span class="header-section-number">14.4</span> Korelacja Pearsona <em>(Pearson Correlation)</em></h2>
<p><strong>Wzór:</strong></p>
<p><span class="math display">
r
= \frac{\operatorname{cov}(X,Y)}{s_X\, s_Y}
= \frac{\sum_{i=1}^n(x_i - \bar{x})(y_i - \bar{y})}
{\sqrt{\sum_{i=1}^n(x_i - \bar{x})^2}\,\sqrt{\sum_{i=1}^n(y_i - \bar{y})^2}}.
</span></p>
<section id="pełny-przykład-obliczeń-ręcznych-complete-manual-calculation-example" class="level3">
<h3 class="anchored" data-anchor-id="pełny-przykład-obliczeń-ręcznych-complete-manual-calculation-example">Pełny przykład obliczeń ręcznych <em>(Complete Manual Calculation Example)</em></h3>
<p>Na danych o godzinach nauki:</p>
<ul>
<li>Godziny nauki (X): 2, 4, 6, 8, 10</li>
<li>Wyniki testu (Y): 65, 70, 80, 85, 95</li>
</ul>
<p><strong>Szczegółowe kroki:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Krok</th>
<th>Opis</th>
<th>Obliczenia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>Kowariancja</td>
<td>Z powyżej: <span class="math inline">\operatorname{cov}(X,Y) = 37.5</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>Kwadraty odchyleń</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>Dla X</td>
<td><span class="math inline">(x_i-\bar{x})^2</span>: 16, 4, 0, 4, 16</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td>Suma = 40</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td>Dla Y</td>
<td><span class="math inline">(y_i-\bar{y})^2</span>: 196, 81, 1, 36, 256</td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td></td>
<td>Suma = 570</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>Odchylenia standardowe <em>(standard deviations)</em></td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: right;"></td>
<td><span class="math inline">s_X</span></td>
<td><span class="math inline">s_X=\sqrt{\frac{40}{4}}=\sqrt{10}=3.162</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td><span class="math inline">s_Y</span></td>
<td><span class="math inline">s_Y=\sqrt{\frac{570}{4}}=\sqrt{142.5}=11.937</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>Korelacja</td>
<td><span class="math inline">r=\frac{37.5}{3.162 \times 11.937}</span></td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td></td>
<td><span class="math inline">r=\frac{37.5}{37.73}\approx 0.994</span></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja obliczeń</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>test_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Współczynnik korelacji Pearsona</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>r_value <span class="ot">&lt;-</span> <span class="fu">cor</span>(study_hours, test_scores, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Pearson correlation coefficient:"</span>, <span class="fu">round</span>(r_value, <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pearson correlation coefficient: 0.993"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenia szczegółowe</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(study_hours)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(test_scores)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>x_dev <span class="ot">&lt;-</span> study_hours <span class="sc">-</span> x_mean</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>y_dev <span class="ot">&lt;-</span> test_scores <span class="sc">-</span> y_mean</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela obliczeń</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>calc_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> study_hours,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> test_scores,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_dev =</span> x_dev,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_dev =</span> y_dev,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_dev_sq =</span> x_dev<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_dev_sq =</span> y_dev<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product =</span> x_dev <span class="sc">*</span> y_dev</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calc_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y X_dev Y_dev X_dev_sq Y_dev_sq Product
1  2 65    -4   -14       16      196      56
2  4 70    -2    -9        4       81      18
3  6 80     0     1        0        1       0
4  8 85     2     6        4       36      12
5 10 95     4    16       16      256      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki podsumowujące</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Summary:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Summary:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of (X-mean)^2:"</span>, <span class="fu">sum</span>(x_dev<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of (X-mean)^2: 40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of (Y-mean)^2:"</span>, <span class="fu">sum</span>(y_dev<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of (Y-mean)^2: 570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of products:"</span>, <span class="fu">sum</span>(x_dev <span class="sc">*</span> y_dev))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of products: 150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviation of X:"</span>, <span class="fu">sd</span>(study_hours))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviation of X: 3.162278</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviation of Y:"</span>, <span class="fu">sd</span>(test_scores))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviation of Y: 11.93734</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przedział ufności i p-value</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(study_hours, test_scores, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  study_hours and test_scores
t = 15, df = 3, p-value = 0.0006431
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8994446 0.9995859
sample estimates:
      cor 
0.9933993 </code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> <span class="math inline">r \approx 0.994</span> wskazuje na niemal doskonały dodatni <strong>liniowy</strong> związek między godzinami nauki a wynikiem testu. Wartość <em>p</em> &lt; 0.05 sugeruje statystyczną istotność tej zależności.</p>
</section>
</section>
<section id="korelacja-rang-spearmana-spearman-rank-correlation" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="korelacja-rang-spearmana-spearman-rank-correlation"><span class="header-section-number">14.5</span> Korelacja rang Spearmana <em>(Spearman Rank Correlation)</em></h2>
<p><strong>Korelacja Spearmana</strong> mierzy <strong>monotoniczne</strong> zależności, używając rang zamiast surowych wartości.</p>
<p><strong>Wzór:</strong></p>
<p><span class="math display">
\rho = 1 - \frac{6 \sum_{i=1}^n d_i^2}{n(n^2 - 1)},
</span></p>
<p>gdzie <span class="math inline">d_i</span> to różnica rang dla obserwacji <span class="math inline">i</span>.</p>
<section id="pełny-przykład-obliczeń-ręcznych-complete-manual-example" class="level3">
<h3 class="anchored" data-anchor-id="pełny-przykład-obliczeń-ręcznych-complete-manual-example">Pełny przykład obliczeń ręcznych <em>(Complete Manual Example)</em></h3>
<p><strong>Dane: Wyniki z matematyki i angielskiego</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Uczeń</th>
<th style="text-align: center;">Matematyka</th>
<th style="text-align: center;">Angielski</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">82</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">90</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">88</td>
<td style="text-align: center;">88</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">94</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">96</td>
</tr>
</tbody>
</table>
<p><strong>Rangowanie i obliczenia:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 28%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Uczeń</th>
<th style="text-align: center;">Wynik z mat.</th>
<th style="text-align: center;">Ranga mat.</th>
<th style="text-align: center;">Wynik z ang.</th>
<th style="text-align: center;">Ranga ang.</th>
<th style="text-align: center;"><span class="math inline">d = \text{ranga mat.} - \text{ranga ang.}</span></th>
<th style="text-align: center;"><span class="math inline">d^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">82</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">88</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">88</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">94</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><strong>Suma:</strong></td>
<td style="text-align: center;"><strong>2</strong></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie:</strong></p>
<p><span class="math display">
\rho = 1 - \frac{6 \times 2}{5(25-1)} = 1 - \frac{12}{120} = 0.9.
</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dane</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>math_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">92</span>, <span class="dv">95</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>english_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">82</span>, <span class="dv">90</span>, <span class="dv">88</span>, <span class="dv">94</span>, <span class="dv">96</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rangi</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>rank_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math_Score =</span> math_scores,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math_Rank =</span> <span class="fu">rank</span>(math_scores),</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">English_Score =</span> english_scores,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">English_Rank =</span> <span class="fu">rank</span>(english_scores)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>rank_table<span class="sc">$</span>d <span class="ot">&lt;-</span> rank_table<span class="sc">$</span>Math_Rank <span class="sc">-</span> rank_table<span class="sc">$</span>English_Rank</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>rank_table<span class="sc">$</span>d_squared <span class="ot">&lt;-</span> rank_table<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rank_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Math_Score Math_Rank English_Score English_Rank  d d_squared
1       A         78         1            82            1  0         0
2       B         85         2            90            3 -1         1
3       C         88         3            88            2  1         1
4       D         92         4            94            4  0         0
5       E         95         5            96            5  0         0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of d^2:"</span>, <span class="fu">sum</span>(rank_table<span class="sc">$</span>d_squared))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of d^2: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja Spearmana</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">cor</span>(math_scores, english_scores, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (R):"</span>, <span class="fu">round</span>(rho, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (R): 0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie ręczne</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(math_scores)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>rho_manual <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">6</span> <span class="sc">*</span> <span class="fu">sum</span>(rank_table<span class="sc">$</span>d_squared)) <span class="sc">/</span> (n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (manual):"</span>, <span class="fu">round</span>(rho_manual, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (manual): 0.9</code></pre>
</div>
</div>
</section>
</section>
<section id="tabele-krzyżowe-cross-tabulation-i-dane-kategoryczne" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="tabele-krzyżowe-cross-tabulation-i-dane-kategoryczne"><span class="header-section-number">14.6</span> Tabele krzyżowe <em>(Cross-tabulation)</em> i dane kategoryczne</h2>
<p><strong>Tabela krzyżowa (cross-tabulation, contingency table)</strong> pokazuje zależności między zmiennymi kategorycznymi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bardziej realistyczne dane przykładowe</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Poziom edukacji a zatrudnienie</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"High School"</span>, <span class="dv">40</span>), </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"College"</span>, <span class="dv">50</span>), </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"Graduate"</span>, <span class="dv">30</span>)),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"Graduate"</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Status zatrudnienia z prawdopodobieństwami zależnymi od edukacji</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>employment <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># High School: 75% employed</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Employed"</span>, <span class="dv">30</span>), <span class="fu">rep</span>(<span class="st">"Unemployed"</span>, <span class="dv">10</span>)), <span class="dv">40</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># College: 90% employed  </span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Employed"</span>, <span class="dv">45</span>), <span class="fu">rep</span>(<span class="st">"Unemployed"</span>, <span class="dv">5</span>)), <span class="dv">50</span>),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Graduate: 95% employed</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Employed"</span>, <span class="dv">28</span>), <span class="fu">rep</span>(<span class="st">"Unemployed"</span>, <span class="dv">2</span>)), <span class="dv">30</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela kontyngencji</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>contingency_table <span class="ot">&lt;-</span> <span class="fu">table</span>(education, employment)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Contingency Table:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Contingency Table:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(contingency_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             employment
education     Employed Unemployed
  High School       30         10
  College           45          5
  Graduate          28          2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Procenty w wierszach</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Row Percentages (% within each education level):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\nRow Percentages (% within each education level):"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">prop.table</span>(contingency_table, <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             employment
education     Employed Unemployed
  High School     75.0       25.0
  College         90.0       10.0
  Graduate        93.3        6.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test niezależności chi-kwadrat (Chi-square test)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(contingency_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(contingency_table): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  contingency_table
X-squared = 5.9623, df = 2, p-value = 0.05073</code></pre>
</div>
</div>
</section>
<section id="ćwiczenia-praktyczne-z-rozwiązaniami-practical-exercises-with-solutions" class="level2" data-number="14.7">
<h2 data-number="14.7" class="anchored" data-anchor-id="ćwiczenia-praktyczne-z-rozwiązaniami-practical-exercises-with-solutions"><span class="header-section-number">14.7</span> Ćwiczenia praktyczne z rozwiązaniami <em>(Practical Exercises with Solutions)</em></h2>
<section id="ćwiczenie-1-ręczne-obliczenie-korelacji-pearsona-calculate-pearson-correlation-manually" class="level3">
<h3 class="anchored" data-anchor-id="ćwiczenie-1-ręczne-obliczenie-korelacji-pearsona-calculate-pearson-correlation-manually">Ćwiczenie 1: Ręczne obliczenie korelacji Pearsona <em>(Calculate Pearson Correlation Manually)</em></h3>
<p><strong>Dane:</strong></p>
<ul>
<li>Wzrost (cale): 66, 68, 70, 72, 74</li>
<li>Waga (funty): 140, 155, 170, 185, 200</li>
</ul>
<p><strong>Rozwiązanie:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dane</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">66</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">72</span>, <span class="dv">74</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">140</span>, <span class="dv">155</span>, <span class="dv">170</span>, <span class="dv">185</span>, <span class="dv">200</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 1: Średnie</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>h_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(height)  <span class="co"># 70</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>w_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(weight)  <span class="co"># 170</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 2: Odchylenia i iloczyny</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>calculation_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Height =</span> height,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Weight =</span> weight,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">H_dev =</span> height <span class="sc">-</span> h_mean,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">W_dev =</span> weight <span class="sc">-</span> w_mean,</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">H_dev_sq =</span> (height <span class="sc">-</span> h_mean)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">W_dev_sq =</span> (weight <span class="sc">-</span> w_mean)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">Product =</span> (height <span class="sc">-</span> h_mean) <span class="sc">*</span> (weight <span class="sc">-</span> w_mean)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calculation_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Height Weight H_dev W_dev H_dev_sq W_dev_sq Product
1     66    140    -4   -30       16      900     120
2     68    155    -2   -15        4      225      30
3     70    170     0     0        0        0       0
4     72    185     2    15        4      225      30
5     74    200     4    30       16      900     120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 3: Korelacja</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>cov_hw <span class="ot">&lt;-</span> <span class="fu">sum</span>(calculation_df<span class="sc">$</span>Product) <span class="sc">/</span> (<span class="fu">length</span>(height) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>sd_h <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(calculation_df<span class="sc">$</span>H_dev_sq) <span class="sc">/</span> (<span class="fu">length</span>(height) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>sd_w <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(calculation_df<span class="sc">$</span>W_dev_sq) <span class="sc">/</span> (<span class="fu">length</span>(weight) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>r_manual <span class="ot">&lt;-</span> cov_hw <span class="sc">/</span> (sd_h <span class="sc">*</span> sd_w)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Manual calculation:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Manual calculation:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Covariance:"</span>, <span class="fu">round</span>(cov_hw, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Covariance: 75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">SD Height:"</span>, <span class="fu">round</span>(sd_h, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SD Height: 3.16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">SD Weight:"</span>, <span class="fu">round</span>(sd_w, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SD Weight: 23.72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Correlation:"</span>, <span class="fu">round</span>(r_manual, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Correlation: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja w R</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">R calculation:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(height, weight), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

R calculation: 1</code></pre>
</div>
</div>
</section>
<section id="ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana-calculate-spearman-correlation-manually" class="level3">
<h3 class="anchored" data-anchor-id="ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana-calculate-spearman-correlation-manually">Ćwiczenie 2: Ręczne obliczenie korelacji Spearmana <em>(Calculate Spearman Correlation Manually)</em></h3>
<p><strong>Dane:</strong></p>
<ul>
<li>Rangi uczniów z matematyki: 1, 3, 2, 5, 4</li>
<li>Rangi uczniów z nauk ścisłych (science): 2, 4, 1, 5, 3</li>
</ul>
<p><strong>Rozwiązanie:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rangi (już zrankowane)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>math_rank <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>science_rank <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Różnice</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> math_rank <span class="sc">-</span> science_rank</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>d_squared <span class="ot">&lt;-</span> d<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>rank_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Math_Rank =</span> math_rank,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Science_Rank =</span> science_rank,</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> d,</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_squared =</span> d_squared</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rank_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Math_Rank Science_Rank  d d_squared
1       1         1            2 -1         1
2       2         3            4 -1         1
3       3         2            1  1         1
4       4         5            5  0         0
5       5         4            3  1         1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja Spearmana</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(math_rank)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>sum_d_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(d_squared)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>rho_manual <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">6</span> <span class="sc">*</span> sum_d_sq) <span class="sc">/</span> (n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of d^2:"</span>, sum_d_sq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of d^2: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (manual):"</span>, <span class="fu">round</span>(rho_manual, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (manual): 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Spearman correlation (R):"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(math_rank, science_rank, <span class="at">method =</span> <span class="st">"spearman"</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Spearman correlation (R): 0.8</code></pre>
</div>
</div>
</section>
<section id="ćwiczenie-3-interpretacja-wyników-interpretation-practice" class="level3">
<h3 class="anchored" data-anchor-id="ćwiczenie-3-interpretacja-wyników-interpretation-practice">Ćwiczenie 3: Interpretacja wyników <em>(Interpretation Practice)</em></h3>
<p>Zinterpretuj następujące wartości korelacji:</p>
<ol type="1">
<li><p><strong>r = 0.85</strong> między godzinami treningu a wynikiem sprawdzianu sprawności <strong>Odpowiedź:</strong> Silny dodatni związek. Wraz ze wzrostem liczby godzin treningu wyniki istotnie rosną.</p></li>
<li><p><strong>r = -0.72</strong> między temperaturą na zewnątrz a kosztami ogrzewania <strong>Odpowiedź:</strong> Silny ujemny związek. Wraz ze wzrostem temperatury koszty ogrzewania wyraźnie maleją.</p></li>
<li><p><strong>r = 0.12</strong> między rozmiarem buta a inteligencją <strong>Odpowiedź:</strong> Bardzo słaby/brak istotnego związku. Zmienne są praktycznie niezależne.</p></li>
</ol>
</section>
</section>
<section id="najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember" class="level2" data-number="14.8">
<h2 data-number="14.8" class="anchored" data-anchor-id="najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember"><span class="header-section-number">14.8</span> Najważniejsze rzeczy do zapamiętania <em>(Important Points to Remember)</em></h2>
<ol type="1">
<li><p><strong>Korelacja mierzy siłę związku:</strong> Wartości od -1 do +1.</p></li>
<li><p><strong>Korelacja ≠ przyczynowość (Correlation ≠ Causation):</strong> Wysoka korelacja nie dowodzi wpływu jednej zmiennej na drugą.</p></li>
<li><p><strong>Dobierz właściwą metodę:</strong></p>
<ul>
<li><strong>Pearson:</strong> Związki <strong>liniowe</strong> dla danych ciągłych.</li>
<li><strong>Spearman:</strong> Związki <strong>monotoniczne</strong> lub dane rangowe.</li>
</ul></li>
<li><p><strong>Sprawdź założenia:</strong></p>
<ul>
<li>Pearson: liniowość i (w praktyce) rozkład zbliżony do normalnego.</li>
<li>Spearman: wymagana jedynie monotoniczność.</li>
</ul></li>
<li><p><strong>Uwaga na obserwacje odstające (outliers):</strong> Mogą silnie wpływać na korelację Pearsona.</p></li>
<li><p><strong>Zawsze wizualizuj dane:</strong> Wykresy pomagają ocenić kształt zależności.</p></li>
</ol>
</section>
<section id="podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis" class="level2" data-number="14.9">
<h2 data-number="14.9" class="anchored" data-anchor-id="podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis"><span class="header-section-number">14.9</span> Podsumowanie: drzewko decyzyjne do analizy korelacji <em>(Summary: Decision Tree for Correlation Analysis)</em></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
WYBÓR WŁAŚCIWEJ MIARY KORELACJI:

Czy dane są liczbowe (numeryczne)?
├─ TAK → Czy związek jest liniowy?
│   ├─ TAK → Użyj korelacji PEARSONA
│   └─ NIE → Czy związek jest monotoniczny?
│       ├─ TAK → Użyj korelacji SPEARMANA
│       └─ NIE → Rozważ metody nieliniowe
└─ NIE → Czy dane są porządkowe (rangi)?
    ├─ TAK → Użyj korelacji SPEARMANA
    └─ NIE → Użyj TABEL KRZYŻOWYCH dla danych kategorycznych</code></pre>
</div>
</div>
</section>
<section id="dodatkowe-zadania-additional-practice-problems" class="level2" data-number="14.10">
<h2 data-number="14.10" class="anchored" data-anchor-id="dodatkowe-zadania-additional-practice-problems"><span class="header-section-number">14.10</span> Dodatkowe zadania <em>(Additional Practice Problems)</em></h2>
<section id="zestaw-zadań-a-obliczenia-ręczne-problem-set-a-manual-calculations" class="level3">
<h3 class="anchored" data-anchor-id="zestaw-zadań-a-obliczenia-ręczne-problem-set-a-manual-calculations">Zestaw zadań A: obliczenia ręczne <em>(Problem Set A: Manual Calculations)</em></h3>
<ol type="1">
<li><p><strong>Policz kowariancję i korelację Pearsona dla:</strong></p>
<ul>
<li>X: 10, 20, 30, 40, 50</li>
<li>Y: 15, 25, 35, 45, 55 <em>Rozwiązanie:</em> <span class="math inline">\operatorname{cov}(X,Y)=250</span>, <span class="math inline">r=1.0</span> (idealna dodatnia korelacja).</li>
</ul></li>
<li><p><strong>Policz korelację Spearmana dla ocen filmów:</strong></p>
<ul>
<li>Oceny filmu A: 8, 6, 9, 7, 5</li>
<li>Oceny filmu B: 7, 8, 9, 6, 4 <em>Rozwiązanie:</em> <span class="math inline">\rho \approx 0.3</span> (słaba dodatnia korelacja).</li>
</ul></li>
</ol>
</section>
<section id="zestaw-zadań-b-interpretacja-problem-set-b-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="zestaw-zadań-b-interpretacja-problem-set-b-interpretation">Zestaw zadań B: interpretacja <em>(Problem Set B: Interpretation)</em></h3>
<ol start="3" type="1">
<li><p><strong>Badanie wykazuje</strong> <span class="math inline">r = 0.91</span> między godzinami snu a wynikami testów. <em>Interpretacja: Bardzo silny dodatni związek — więcej snu wiąże się z lepszymi wynikami. Nie dowodzi to jednak kausalności; możliwe czynniki uboczne.</em></p></li>
<li><p><strong>Inne badanie:</strong> <span class="math inline">r = -0.03</span> między miesiącem urodzenia a IQ. <em>Interpretacja: Brak istotnego związku. Miesiąc urodzenia i IQ są w praktyce niezależne.</em></p></li>
</ol>
</section>
<section id="ściąga-quick-reference-card" class="level3">
<h3 class="anchored" data-anchor-id="ściąga-quick-reference-card">Ściąga <em>(Quick Reference Card)</em></h3>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 38%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Miara</th>
<th>Kiedy używać <em>(Use When)</em></th>
<th>Wzór <em>(Formula)</em></th>
<th>Zakres <em>(Range)</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kowariancja (Covariance)</strong></td>
<td>Wstępne badanie związku</td>
<td><span class="math inline">\displaystyle \frac{\sum_{i=1}^n (x_i-\bar{x})(y_i-\bar{y})}{n-1}</span></td>
<td><span class="math inline">-\infty</span> do <span class="math inline">+\infty</span></td>
</tr>
<tr class="even">
<td><strong>Pearson</strong> <span class="math inline">r</span></td>
<td>Związki liniowe, dane ciągłe</td>
<td><span class="math inline">\displaystyle \frac{\operatorname{cov}(X,Y)}{s_X s_Y}</span></td>
<td><span class="math inline">-1</span> do <span class="math inline">+1</span></td>
</tr>
<tr class="odd">
<td><strong>Spearman</strong> <span class="math inline">\rho</span></td>
<td>Związki monotoniczne, rangi</td>
<td><span class="math inline">\displaystyle 1-\frac{6\sum d_i^2}{n(n^2-1)}</span></td>
<td><span class="math inline">-1</span> do <span class="math inline">+1</span></td>
</tr>
<tr class="even">
<td><strong>Tabele krzyżowe (Cross-tabs)</strong></td>
<td>Zmienne kategoryczne</td>
<td>Zliczenia częstości</td>
<td>n/d</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="analiza-regresji-ols-ordinary-least-squares-przewodnik-na-start-a-quick-start-guide" class="level2" data-number="14.11">
<h2 data-number="14.11" class="anchored" data-anchor-id="analiza-regresji-ols-ordinary-least-squares-przewodnik-na-start-a-quick-start-guide"><span class="header-section-number">14.11</span> Analiza regresji OLS <em>(Ordinary Least Squares)</em>: przewodnik na start <em>(A Quick-start Guide)</em></h2>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Analiza regresji OLS: przewodnik na start
</div>
</div>
<div class="callout-body-container callout-body">
<section id="wprowadzenie-czym-jest-analiza-regresji" class="level3">
<h3 class="anchored" data-anchor-id="wprowadzenie-czym-jest-analiza-regresji">Wprowadzenie: czym jest analiza regresji?</h3>
<p><strong>Analiza regresji (regression analysis)</strong> pomaga zrozumieć i <strong>mierzyć zależności</strong> między obserwowalnymi wielkościami. To zestaw narzędzi matematycznych do identyfikowania wzorców w danych, które umożliwiają <strong>prognozowanie (prediction)</strong>.</p>
<p>Rozważ pytania badawcze:</p>
<ul>
<li>Jak <strong>czas nauki</strong> wpływa na <strong>wynik testu</strong>?</li>
<li>Jak <strong>doświadczenie</strong> wpływa na <strong>wynagrodzenie</strong>?</li>
<li>Jak <strong>wydatki na reklamę</strong> oddziałują na <strong>sprzedaż</strong>?</li>
</ul>
<p>Regresja dostarcza systematycznych metod, by na te pytania odpowiadać na podstawie <strong>realnych danych</strong>.</p>
</section>
<section id="punkt-wyjścia-prosty-przykład" class="level3">
<h3 class="anchored" data-anchor-id="punkt-wyjścia-prosty-przykład">Punkt wyjścia: prosty przykład</h3>
<p>Zacznijmy od konkretu. Zebrano dane o 20 studentach z Twojej klasy:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Study Hours</th>
<th>Exam Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Alex</td>
<td>2</td>
<td>68</td>
</tr>
<tr class="even">
<td>Beth</td>
<td>4</td>
<td>74</td>
</tr>
<tr class="odd">
<td>Carlos</td>
<td>6</td>
<td>85</td>
</tr>
<tr class="even">
<td>Diana</td>
<td>8</td>
<td>91</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>Po narysowaniu <strong>wykresu punktowego (scatter plot)</strong> chcesz znaleźć <strong>prostą</strong>, która <strong>najlepiej</strong> opisuje związek między godzinami nauki a wynikiem.</p>
<p>Ale co znaczy „najlepiej”? Właśnie to odkryjemy.</p>
</section>
<section id="dlaczego-prawdziwe-dane-nie-układają-się-w-idealną-linię" class="level3">
<h3 class="anchored" data-anchor-id="dlaczego-prawdziwe-dane-nie-układają-się-w-idealną-linię">Dlaczego prawdziwe dane nie układają się w idealną linię</h3>
<p>Zanim przejdziemy do rachunków, zrozummy, dlaczego punkty zwykle <strong>nie leżą</strong> na jednej prostej.</p>
<section id="modele-deterministyczne-vs.-stochastyczne" class="level4">
<h4 class="anchored" data-anchor-id="modele-deterministyczne-vs.-stochastyczne">Modele deterministyczne vs.&nbsp;stochastyczne</h4>
<p><strong>Modele deterministyczne (deterministic models)</strong> opisują związki <strong>bez niepewności</strong>. Przykład z fizyki:</p>
<p><span class="math display">\text{Distance} = \text{Speed} \times \text{Time}</span></p>
<p>Jedziesz dokładnie 60 mph przez 2 godziny → zawsze 120 mil. Zero odchyleń.</p>
<p><strong>Modele stochastyczne (stochastic models)</strong> uznają, że w danych naturalnie występuje <strong>losowość</strong>. Ogólna postać to:</p>
<p><span class="math display">Y = f(X) + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y</span> — wielkość, którą prognozujemy (np. wynik testu),</li>
<li><span class="math inline">f(X)</span> — <strong>wzorzec systematyczny</strong> (jak godziny nauki <strong>typowo</strong> wpływają na wyniki),</li>
<li><span class="math inline">\epsilon</span> — „reszta”/<strong>szum</strong>: wszystko, czego nie mierzymy.</li>
</ul>
<p>W naszym przykładzie dwoje studentów może uczyć się po 5 godzin, a jednak dostać różne oceny, bo:</p>
<ul>
<li>jedno lepiej spało,</li>
<li>jedno ma talent do testów,</li>
<li>jedno miało hałas na sali,</li>
<li>pytania trafiły bardziej/mniej pod ich przygotowanie.</li>
</ul>
<p>Ta losowość jest naturalna — tym zajmuje się <span class="math inline">\epsilon</span>.</p>
</section>
</section>
<section id="prosty-model-regresji-liniowej" class="level3">
<h3 class="anchored" data-anchor-id="prosty-model-regresji-liniowej">Prosty model regresji liniowej</h3>
<p>Zależność między godzinami nauki a wynikiem zapisujemy jako:</p>
<p><span class="math display">Y_i = \beta_0 + \beta_1 X_i + \epsilon_i</span></p>
<p>Rozszyfrujmy:</p>
<ul>
<li><span class="math inline">Y_i</span> — wynik testu studenta <span class="math inline">i</span>,</li>
<li><span class="math inline">X_i</span> — godziny nauki studenta <span class="math inline">i</span>,</li>
<li><span class="math inline">\beta_0</span> — wyraz wolny (<strong>intercept</strong>, „poziom bazowy” przy 0 godzin),</li>
<li><span class="math inline">\beta_1</span> — <strong>nachylenie</strong> (<strong>slope</strong>, przyrost punktów na godzinę),</li>
<li><span class="math inline">\epsilon_i</span> — „wszystko inne” wpływające na wynik <span class="math inline">i</span>.</li>
</ul>
<p><strong>Ważne:</strong> Prawdziwych wartości <span class="math inline">\beta_0, \beta_1</span> <strong>nie znamy</strong>. <strong>Szacujemy</strong> je z danych i oznaczamy „z daszkiem”: <span class="math inline">\hat{\beta}_0</span>, <span class="math inline">\hat{\beta}_1</span>.</p>
</section>
<section id="reszty-jak-bardzo-mylimy-się-w-przewidywaniach" class="level3">
<h3 class="anchored" data-anchor-id="reszty-jak-bardzo-mylimy-się-w-przewidywaniach">Reszty: jak bardzo mylimy się w przewidywaniach?</h3>
<p>Po dopasowaniu prostej możemy przewidzieć wyniki. Dla każdej obserwacji:</p>
<ol type="1">
<li><strong>Wartość rzeczywista</strong> (<span class="math inline">y_i</span>): faktyczny wynik,</li>
<li><strong>Wartość przewidziana</strong> (<span class="math inline">\hat{y}_i</span>): co „mówi” nasza prosta,</li>
<li><strong>Reszta</strong> (<span class="math inline">e_i</span>): różnica = Rzeczywista − Przewidziana.</li>
</ol>
<p><strong>Przykład:</strong></p>
<pre><code>Diana: 8 h nauki, wynik 91
Linia przewiduje: 88
Reszta: 91 − 88 = +3 (zaniżyliśmy)

Eric: 5 h nauki, wynik 70
Linia przewiduje: 79
Reszta: 70 − 79 = −9 (zawyżyliśmy)</code></pre>
</section>
<section id="kluczowy-pomysł-dlaczego-kwadratujemy-reszty" class="level3">
<h3 class="anchored" data-anchor-id="kluczowy-pomysł-dlaczego-kwadratujemy-reszty">Kluczowy pomysł: dlaczego <strong>kwadratujemy</strong> reszty?</h3>
<p>Załóżmy reszty czterech studentów:</p>
<ul>
<li>A: +5</li>
<li>B: −5</li>
<li>C: +3</li>
<li>D: −3</li>
</ul>
<p>Suma: <span class="math inline">(+5) + (-5) + (+3) + (-3) = 0</span>.</p>
<p>To <strong>nie</strong> znaczy, że przewidywania są idealne — błędy się <strong>znoszą</strong>.</p>
<p><strong>Rozwiązanie:</strong> sumujemy <strong>kwadraty</strong> reszt:</p>
<ul>
<li><span class="math inline">(+5)^2 = 25</span></li>
<li><span class="math inline">(-5)^2 = 25</span></li>
<li><span class="math inline">(+3)^2 = 9</span></li>
<li><span class="math inline">(-3)^2 = 9</span></li>
<li><strong>Suma kwadratów błędów = 68</strong></li>
</ul>
<p>Dlaczego to działa:</p>
<ol type="1">
<li><strong>Brak znoszenia znaków,</strong> bo kwadraty są dodatnie,</li>
<li><strong>Duże błędy ważą mocniej</strong> (10 punktów to 4× więcej niż 5 punktów),</li>
<li><strong>Wygoda matematyczna:</strong> funkcje kwadratowe są gładkie i różniczkowalne.</li>
</ol>
</section>
<section id="metoda-zwykłych-najmniejszych-kwadratów-ols" class="level3">
<h3 class="anchored" data-anchor-id="metoda-zwykłych-najmniejszych-kwadratów-ols">Metoda zwykłych najmniejszych kwadratów (OLS)</h3>
<p><strong>OLS</strong> wybiera taką prostą, która <strong>minimalizuje sumę kwadratów reszt</strong> <strong>(SSE — Sum of Squared Errors)</strong>:</p>
<p><span class="math display">\text{SSE} = \sum_{i=1}^n e_i^2 = \sum_{i=1}^n (y_i - \hat{y}_i)^2</span></p>
<p>Czyli:</p>
<p><span class="math display">\min_{\beta_0,\beta_1} \sum_{i=1}^n \big(y_i - (\beta_0 + \beta_1 x_i)\big)^2</span></p>
<p><strong>„Po ludzku”:</strong> Znajdź takie <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>, by <strong>łączny błąd</strong> (w kwadracie) przewidywań był <strong>jak najmniejszy</strong>.</p>
</section>
<section id="rozwiązanie-matematyczne" class="level3">
<h3 class="anchored" data-anchor-id="rozwiązanie-matematyczne">Rozwiązanie matematyczne</h3>
<p>Minimalizujemy SSE rachunkiem różniczkowym. Warunki pierwszego rzędu:</p>
<p><span class="math display">\frac{\partial SSE}{\partial \beta_0} = -2\sum_{i=1}^n (y_i - \beta_0 - \beta_1x_i) = 0</span></p>
<p><span class="math display">\frac{\partial SSE}{\partial \beta_1} = -2\sum_{i=1}^n x_i(y_i - \beta_0 - \beta_1x_i) = 0</span></p>
<p>Rozwiązanie układu:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum_{i=1}^n(x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n(x_i - \bar{x})^2} = \frac{\text{Cov}(X,Y)}{\text{Var}(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}</span></p>
<p>Wnioski:</p>
<ul>
<li><strong>Nachylenie</strong> zależy od tego, <strong>jak współzmieniają się</strong> <span class="math inline">X</span> i <span class="math inline">Y</span> (kowariancja) względem <strong>zmienności samego</strong> <span class="math inline">X</span> (wariancja),</li>
<li>Linia <strong>przechodzi przez punkt średnich</strong> <span class="math inline">(\bar{x}, \bar{y})</span>.</li>
</ul>
</section>
<section id="skąd-wiemy-że-linia-jest-dobra-rozkład-zmienności" class="level3">
<h3 class="anchored" data-anchor-id="skąd-wiemy-że-linia-jest-dobra-rozkład-zmienności">Skąd wiemy, że linia jest „dobra”? Rozkład zmienności</h3>
<p>Rozbijamy całkowitą zmienność wyników:</p>
<p><strong>Całkowita suma kwadratów (SST — Total Sum of Squares)</strong><br>
„Jak bardzo <strong>ogólnie</strong> różnią się wyniki?”</p>
<p><span class="math display">SST = \sum_{i=1}^n (y_i - \bar{y})^2</span></p>
<p><strong>Suma kwadratów regresji (SSR — Regression Sum of Squares)</strong><br>
„Ile zmienności wyjaśnia <strong>nasza linia</strong>?”</p>
<p><span class="math display">SSR = \sum_{i=1}^n (\hat{y}_i - \bar{y})^2</span></p>
<p><strong>Suma kwadratów błędów (SSE — Error Sum of Squares)</strong><br>
„Ile <strong>nie wyjaśniamy</strong>?”</p>
<p><span class="math display">SSE = \sum_{i=1}^n (y_i - \hat{y}_i)^2</span></p>
<p><strong>Tożsamość wariancyjna:</strong></p>
<p><span class="math display">SST = SSR + SSE \quad\Rightarrow\quad \text{Całkowita} = \text{Wyjaśniona} + \text{Niewyjaśniona}</span></p>
</section>
<section id="r2-ocena-dopasowania" class="level3">
<h3 class="anchored" data-anchor-id="r2-ocena-dopasowania"><span class="math inline">R^2</span>: ocena dopasowania</h3>
<p><strong>Współczynnik determinacji (</strong><span class="math inline">R^2</span>) mówi, <strong>jaki odsetek zmienności</strong> wyjaśnia model:</p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>Interpretacja:</p>
<ul>
<li><span class="math inline">R^2 = 0.75</span>: „Godziny nauki wyjaśniają <strong>75%</strong> zróżnicowania wyników”,</li>
<li><span class="math inline">R^2 = 0.30</span>: „Model wyjaśnia <strong>30%</strong> tego, czym różnią się wyniki”,</li>
<li><span class="math inline">R^2 = 1.00</span>: perfekcyjne dopasowanie (w realu prawie nigdy),</li>
<li><span class="math inline">R^2 = 0.00</span>: nie lepiej niż zgadywanie średniej.</li>
</ul>
<p><strong>Uwaga kontekstowa:</strong> w naukach społecznych <strong>0.30</strong> bywa świetne; w inżynierii oczekuje się bardzo wysokich <span class="math inline">R^2</span>.</p>
</section>
<section id="interpretacja-wyników" class="level3">
<h3 class="anchored" data-anchor-id="interpretacja-wyników">Interpretacja wyników</h3>
<p>Załóżmy, że oszacowaliśmy <span class="math inline">\hat{\beta}_0 = 60</span> i <span class="math inline">\hat{\beta}_1 = 4</span>.</p>
<p><strong>Nachylenie (</strong><span class="math inline">\hat{\beta}_1 = 4</span>):</p>
<ul>
<li>„Każda dodatkowa godzina nauki wiąże się średnio z <strong>+4</strong> punktami”,</li>
<li>To <strong>efekt przeciętny</strong>, nie obietnica dla konkretnej osoby.</li>
</ul>
<p><strong>Wyraz wolny (</strong><span class="math inline">\hat{\beta}_0 = 60</span>):</p>
<ul>
<li>„Przy 0 godzinach nauki przewidujemy <strong>60</strong> punktów”,</li>
<li>Często to tylko <strong>kotwica matematyczna</strong> — może nie mieć sensu praktycznego.</li>
</ul>
<p><strong>Równanie predykcji:</strong></p>
<p><span class="math display">\widehat{\text{Wynik}} = 60 + 4 \times \text{Godziny nauki}</span></p>
<p>5 godzin → <span class="math inline">60 + 4 \cdot 5 = 80</span> punktów.</p>
</section>
<section id="wielkość-efektu-i-istotność-praktyczna" class="level3">
<h3 class="anchored" data-anchor-id="wielkość-efektu-i-istotność-praktyczna">Wielkość efektu i istotność praktyczna</h3>
<p><strong>Istotność statystyczna</strong> mówi, czy efekt <strong>istnieje</strong>; <strong>istotność praktyczna</strong> — czy <strong>ma znaczenie</strong>. Potrzebujemy obu.</p>
<section id="surowa-wielkość-efektu" class="level4">
<h4 class="anchored" data-anchor-id="surowa-wielkość-efektu">Surowa wielkość efektu</h4>
<p>To po prostu <strong>nachylenie</strong> <span class="math inline">\hat{\beta}_1</span>.</p>
<p>Przykład: <span class="math inline">\hat{\beta}_1 = 4</span> pkt/godz.<br>
Czy to „dużo”? Zależy od:</p>
<ol type="1">
<li><strong>Skali</strong> wyniku (4/100 = 4% vs 4/500 = 0,8%),</li>
<li><strong>Kosztu interwencji</strong> (czy 1h nauki warta 4 pkt?),</li>
<li><strong>Progów decyzyjnych</strong> (czy 4 pkt zmienia ocenę?).</li>
</ol>
</section>
<section id="standaryzowana-wielkość-efektu" class="level4">
<h4 class="anchored" data-anchor-id="standaryzowana-wielkość-efektu">Standaryzowana wielkość efektu</h4>
<p>Ułatwia porównania między badaniami:</p>
<p><span class="math display">\beta_{\text{std}} = \hat{\beta}_1 \times \frac{s_X}{s_Y}</span></p>
<p>gdzie <span class="math inline">s_X</span> i <span class="math inline">s_Y</span> to odchylenia standardowe <span class="math inline">X</span> i <span class="math inline">Y</span>.</p>
<p>Przykład: jeśli <span class="math inline">s_X = 2.5</span> h, <span class="math inline">s_Y = 12</span> pkt i <span class="math inline">\hat{\beta}_1 = 4</span>:</p>
<p><span class="math display">\beta_{\text{std}} = 4 \cdot \frac{2.5}{12} = 0.83</span></p>
<p>„Przy wzroście <span class="math inline">X</span> o 1 SD, <span class="math inline">Y</span> rośnie o <strong>0.83 SD</strong>”.</p>
</section>
<section id="wskazówki-cohena" class="level4">
<h4 class="anchored" data-anchor-id="wskazówki-cohena">Wskazówki Cohena</h4>
<p>Dla <strong>standaryzowanych współczynników</strong>:</p>
<ul>
<li><strong>mały</strong>: <span class="math inline">|\beta| \approx 0.10</span> (~1% wariancji),</li>
<li><strong>średni</strong>: <span class="math inline">|\beta| \approx 0.30</span> (~9%),</li>
<li><strong>duży</strong>: <span class="math inline">|\beta| \approx 0.50</span> (~25%).</li>
</ul>
<p>Dla <span class="math inline">R^2</span>:</p>
<ul>
<li><strong>mały</strong>: <span class="math inline">R^2 \approx 0.02</span>,</li>
<li><strong>średni</strong>: <span class="math inline">R^2 \approx 0.13</span>,</li>
<li><strong>duży</strong>: <span class="math inline">R^2 \approx 0.26</span>.</li>
</ul>
<p><strong>Uwaga:</strong> to ogólne progi — normy różnią się między dziedzinami.</p>
</section>
<section id="przedziały-ufności-dla-wielkości-efektu" class="level4">
<h4 class="anchored" data-anchor-id="przedziały-ufności-dla-wielkości-efektu">Przedziały ufności dla wielkości efektu</h4>
<p>Dla surowego współczynnika:</p>
<p><span class="math display">CI = \hat{\beta}_1 \pm t_{\text{critical}} \cdot SE(\hat{\beta}_1)</span></p>
<p>Jeśli 95% CI = [3.2, 4.8], mówimy: „Z 95% pewnością <strong>prawdziwy</strong> efekt mieści się między 3.2 a 4.8 pkt/godz.”</p>
</section>
<section id="ocena-istotności-praktycznej" class="level4">
<h4 class="anchored" data-anchor-id="ocena-istotności-praktycznej">Ocena istotności praktycznej</h4>
<p>Weź pod uwagę:</p>
<ol type="1">
<li><strong>Minimalnie istotną różnicę</strong> (MID),</li>
<li><strong>Ile trzeba zmienić</strong> <span class="math inline">X</span>, by osiągnąć <strong>sensowną</strong> zmianę <span class="math inline">Y</span>,</li>
<li><strong>Koszt-efektywność</strong>:</li>
</ol>
<p><span class="math display">\text{Efektywność} = \frac{\text{Wielkość efektu}}{\text{Koszt interwencji}}</span></p>
<p><strong>Przykład:</strong><br>
Efekt: 4 pkt/godz.<br>
Próg zaliczenia: 70; średnia: 68 → <strong>30 min</strong> nauki może zmienić <strong>niezal</strong> na <strong>zal</strong> → <strong>istotne praktycznie</strong>.</p>
</section>
</section>
<section id="niepewność" class="level3">
<h3 class="anchored" data-anchor-id="niepewność">Niepewność</h3>
<p>Szacunki pochodzą z <strong>próby</strong>, nie z całej populacji → <strong>niepewność</strong>.</p>
<section id="skąd-niepewność" class="level4">
<h4 class="anchored" data-anchor-id="skąd-niepewność">Skąd niepewność?</h4>
<ul>
<li>Masz <strong>20 studentów</strong>, nie wszystkich,</li>
<li>Próba może być <strong>nietypowa</strong>,</li>
<li><strong>Pomiary</strong> nie są doskonałe (raportowanie godzin nauki).</li>
</ul>
</section>
<section id="przedziały-ufności" class="level4">
<h4 class="anchored" data-anchor-id="przedziały-ufności">Przedziały ufności</h4>
<p>Zamiast „efekt to dokładnie 4”, mówimy:</p>
<ul>
<li>„Szacujemy 4”,</li>
<li>„95% CI: [3.2, 4.8]“.</li>
</ul>
<p>Znaczenie: w wielu powtórzeniach 95% takich przedziałów zawiera prawdziwą wartość.</p>
</section>
<section id="testowanie-istnienia-zależności" class="level4">
<h4 class="anchored" data-anchor-id="testowanie-istnienia-zależności">Testowanie istnienia zależności</h4>
<p>Pytamy: „Gdyby <strong>prawdziwie</strong> nie było związku, jak <strong>mało prawdopodobny</strong> byłby obserwowany wzorzec?”</p>
<ul>
<li><strong>p = 0.03</strong>: przy braku efektu tylko <strong>3%</strong> szans na tak silny wzorzec „z przypadku”,</li>
<li><strong>p = 0.40</strong>: wzorzec „mógłby się łatwo zdarzyć” bez efektu.</li>
</ul>
<p><strong>Reguła kciuka:</strong> <span class="math inline">p &lt; 0.05</span> → „statystycznie istotne”.</p>
</section>
</section>
<section id="gdy-coś-idzie-źle-diagnostyka-modelu" class="level3">
<h3 class="anchored" data-anchor-id="gdy-coś-idzie-źle-diagnostyka-modelu">Gdy coś idzie źle: diagnostyka modelu</h3>
<p><strong>Szybkie wizualizacje:</strong></p>
<ol type="1">
<li>Wykres punktowy: czy związek jest <strong>mniej więcej liniowy</strong>?</li>
<li>Reszty vs.&nbsp;przewidywania: powinien być <strong>losowy obłok</strong>,</li>
<li><strong>Outliery</strong>: punkty bardzo odległe?</li>
</ol>
<p><strong>Sygnały ostrzegawcze:</strong></p>
<ul>
<li><strong>Wzorzec</strong> w resztach → brak liniowości lub zmienna pominięta,</li>
<li><strong>Rozszerzający się wachlarz</strong> reszt → heteroskedastyczność,</li>
<li><strong>Wpływowe obserwacje</strong> (influential) ciągną prostą,</li>
<li><strong>Pominięte zmienne</strong> → obciążenia (bias).</li>
</ul>
</section>
<section id="założenia-kiedy-ols-działa-dobrze" class="level3">
<h3 class="anchored" data-anchor-id="założenia-kiedy-ols-działa-dobrze">Założenia: kiedy OLS działa dobrze</h3>
<ol type="1">
<li><strong>Liniowość</strong> (linearity) — zależność w przybliżeniu prosta,</li>
<li><strong>Niezależność</strong> (independence) — obserwacje od siebie niezależne,</li>
<li><strong>Stała wariancja</strong> (homoskedastyczność) — rozrzut reszt podobny w całym zakresie,</li>
<li><strong>Brak doskonałej współliniowości</strong> (no perfect multicollinearity) — w regresji wielorakiej predyktory nie są liniowo zależne „na 100%“,</li>
<li><strong>Losowy dobór próby</strong> (random sampling) — dane reprezentatywne.</li>
</ol>
</section>
<section id="podsumowanie" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie">Podsumowanie</h3>
<p><strong>Co robi OLS:</strong></p>
<ul>
<li>Dopasowuje prostą minimalizującą SSE,</li>
<li>Szacuje, o ile średnio zmienia się <span class="math inline">Y</span> przy zmianie <span class="math inline">X</span> o 1,</li>
<li>Podaje <span class="math inline">R^2</span> — ile zmienności wyjaśniamy,</li>
<li>Kwantyfikuje <strong>niepewność</strong> (SE, CI, p-values).</li>
</ul>
<p><strong>Kroki praktyczne:</strong></p>
<ol type="1">
<li>Wykres danych — czy linia ma sens?</li>
<li>Uruchom OLS → <span class="math inline">\hat{\beta}_0</span>, <span class="math inline">\hat{\beta}_1</span>,</li>
<li>Sprawdź <span class="math inline">R^2</span>,</li>
<li>Oblicz <strong>wielkości efektu</strong> (surową i standaryzowaną),</li>
<li>Oceń <strong>istotność praktyczną</strong>,</li>
<li>Sprawdź <strong>przedziały ufności</strong>,</li>
<li>Obejrzyj <strong>reszty</strong>,</li>
<li>Decyduj, łącząc istotność statystyczną i praktyczną.</li>
</ol>
</section>
<section id="kluczowe-interpretacje-key-interpretations" class="level3">
<h3 class="anchored" data-anchor-id="kluczowe-interpretacje-key-interpretations">Kluczowe interpretacje / Key interpretations</h3>
<p>Domyślny model: regresja OLS <span class="math inline">Y=\beta_0+\beta_1 X+\varepsilon</span> (lub wieloraka: <span class="math inline">Y=\beta_0+\beta_1 X_1+\cdots+\beta_p X_p+\varepsilon</span>).</p>
<ul>
<li><p><strong>Nachylenie / Slope (</strong><span class="math inline">\beta_1</span>) <strong>PL:</strong> Przy wzroście <span class="math inline">X</span> o 1 jednostkę <strong>(ceteris paribus)</strong>, przeciętna wartość <span class="math inline">Y</span> zmienia się o <span class="math inline">\beta_1</span> jednostek. <strong>ENG:</strong> When <span class="math inline">X</span> increases by 1 unit <strong>(ceteris paribus)</strong>, the expected value of <span class="math inline">Y</span> changes by <span class="math inline">\beta_1</span> units.</p></li>
<li><p><strong>Standaryzowane nachylenie / Standardized slope</strong> <span class="math inline">\big(\beta_{1}^{(\mathrm{std})}\big)</span> Definicja:</p>
<p><span class="math display">
\beta_{1}^{(\mathrm{std})} \;=\; \beta_1 \cdot \frac{s_X}{s_Y},
</span></p>
<p>gdzie <span class="math inline">s_X</span> i <span class="math inline">s_Y</span> to odchylenia standardowe <span class="math inline">X</span> i <span class="math inline">Y</span>. <strong>PL:</strong> Przy wzroście <span class="math inline">X</span> o <strong>1 odchylenie standardowe (SD)</strong>, przeciętna wartość <span class="math inline">Y</span> zmienia się o <span class="math inline">\beta_{1}^{(\mathrm{std})}</span> <strong>odchyleń standardowych</strong> <span class="math inline">Y</span>. <strong>ENG:</strong> For a <strong>1 standard deviation (SD)</strong> increase in <span class="math inline">X</span>, the expected value of <span class="math inline">Y</span> changes by <span class="math inline">\beta_{1}^{(\mathrm{std})}</span> <strong>SDs of</strong> <span class="math inline">Y</span>. <em>Uwaga/Note:</em> W regresji prostej <span class="math inline">\beta_{1}^{(\mathrm{std})} = r</span> (Pearson). / In simple regression, <span class="math inline">\beta_{1}^{(\mathrm{std})} = r</span> (Pearson).</p></li>
<li><p><strong>Współczynnik determinacji /</strong> <span class="math inline">R^2</span> Definicja:</p>
<p><span class="math display">
R^2 \;=\; 1 - \frac{SS_{\mathrm{res}}}{SS_{\mathrm{tot}}}.
</span></p>
<p><strong>PL:</strong> Model wyjaśnia <span class="math inline">100\times R^2</span>% zmienności <span class="math inline">Y</span> względem modelu tylko z wyrazem wolnym (in-sample). <strong>ENG:</strong> The model explains <span class="math inline">100\times R^2</span>% of the variance in <span class="math inline">Y</span> relative to the intercept-only model (in-sample). <em>W wielu zmiennych rozważ</em>: <span class="math inline">\text{adjusted } R^2</span>. / <em>With multiple predictors consider</em>: adjusted <span class="math inline">R^2</span>.</p></li>
<li><p><strong>Wartość p / P-value</strong> <strong>Formalnie/Formally:</strong></p>
<p><span class="math display">
p \;=\; \Pr\!\big(\,|T|\ge |t_{\mathrm{obs}}| \mid H_0\,\big),
</span></p>
<p>gdzie <span class="math inline">T</span> ma rozkład <span class="math inline">t</span> przy <span class="math inline">H_0</span>. <strong>PL:</strong> Zakładając prawdziwość <span class="math inline">H_0</span> i spełnione założenia modelu, prawdopodobieństwo uzyskania <strong>co najmniej tak ekstremalnej</strong> statystyki jak obserwowana wynosi <span class="math inline">p</span>. <strong>ENG:</strong> Assuming <span class="math inline">H_0</span> and the model assumptions hold, <span class="math inline">p</span> is the probability of observing a test statistic <strong>at least as extreme</strong> as the one obtained.</p></li>
<li><p><strong>Przedział ufności / Confidence interval (np. dla</strong> <span class="math inline">\beta_1</span>) <strong>Konstrukcja/Construction:</strong></p>
<p><span class="math display">
\hat{\beta}_1 \;\pm\; t_{1-\alpha/2,\ \mathrm{df}} \cdot \mathrm{SE}\!\left(\hat{\beta}_1\right).
</span></p>
<p><strong>PL (ściśle):</strong> W długiej serii powtórzeń 95% tak skonstruowanych przedziałów zawiera prawdziwą wartość <span class="math inline">\beta_1</span>; dla naszych danych oszacowanie mieści się w <span class="math inline">[\text{lower},\ \text{upper}]</span>. <strong>ENG (strict):</strong> Over many repetitions, 95% of such intervals would contain the true <span class="math inline">\beta_1</span>; for our data, the estimate lies within <span class="math inline">[\text{lower},\ \text{upper}]</span>. <strong>PL (skrót dydaktyczny):</strong> „Jesteśmy 95% pewni, że <span class="math inline">\beta_1</span> leży w <span class="math inline">[\text{lower},\ \text{upper}]</span>.” <strong>ENG (teaching shorthand):</strong> “We are 95% confident that <span class="math inline">\beta_1</span> lies in <span class="math inline">[\text{lower},\ \text{upper}]</span>.”</p></li>
</ul>
<section id="najczęstsze-nieporozumienia-common-pitfalls" class="level4">
<h4 class="anchored" data-anchor-id="najczęstsze-nieporozumienia-common-pitfalls">Najczęstsze nieporozumienia / Common pitfalls</h4>
<ul>
<li><strong>PL:</strong> <span class="math inline">p</span> <strong>nie</strong> jest prawdopodobieństwem, że <span class="math inline">H_0</span> jest prawdziwa. <strong>ENG:</strong> <span class="math inline">p</span> is <strong>not</strong> the probability that <span class="math inline">H_0</span> is true.</li>
<li><strong>PL:</strong> 95% CI <strong>nie</strong> zawiera 95% obserwacji (od tego jest <strong>przedział predykcji</strong>). <strong>ENG:</strong> A 95% CI <strong>does not</strong> contain 95% of observations (that’s a <strong>prediction interval</strong>).</li>
<li><strong>PL/ENG:</strong> Wysokie <span class="math inline">R^2</span> ≠ przyczynowość / High <span class="math inline">R^2</span> ≠ causality. Zawsze sprawdzaj/Always check diagnozy reszt, skalę efektu, i dopasowanie poza próbą.</li>
</ul>
<p><strong>Pamiętaj:</strong></p>
<ul>
<li><strong>Asocjacja ≠ przyczynowość</strong>,</li>
<li>Istotność statystyczna ≠ istotność praktyczna,</li>
<li>„Każdy model jest błędny, niektóre są użyteczne”,</li>
<li>Zawsze <strong>wizualizuj</strong> dane i <strong>reszty</strong>,</li>
<li>Decyzje opieraj na <strong>wielkości efektu</strong> i <strong>niepewności</strong>.</li>
</ul>
<p>OLS dostarcza uporządkowany, matematyczny sposób znajdowania wzorców w danych. Nie daje doskonałych prognoz, ale zapewnia <strong>najlepszą liniową aproksymację</strong> wraz z uczciwą oceną jej jakości i niepewności.</p>
</section>
</section>
<section id="ręczne-obliczenia-ols-krok-po-kroku" class="level2" data-number="14.12">
<h2 data-number="14.12" class="anchored" data-anchor-id="ręczne-obliczenia-ols-krok-po-kroku"><span class="header-section-number">14.12</span> Ręczne obliczenia OLS krok po kroku</h2>
<p>Badaczka chce zbadać zależność między godzinami nauki a wynikiem testu (6 studentów):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Study Hours (X)</th>
<th>Exam Score (Y)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
</tr>
</tbody>
</table>
<p>Celem jest wyznaczyć <span class="math inline">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X</span> metodą OLS.</p>
<section id="krok-1-średnie" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-średnie">Krok 1: Średnie</h3>
<p><strong>Dla</strong> <span class="math inline">X</span>:</p>
<p><span class="math display">\bar{X} = \frac{1+2+3+4+5+6}{6} = \frac{21}{6} = 3.5</span></p>
<p><strong>Dla</strong> <span class="math inline">Y</span>:</p>
<p><span class="math display">\bar{Y} = \frac{65+70+75+85+88+95}{6} = \frac{478}{6} = 79.67</span></p>
</section>
<section id="krok-2-odchylenia-od-średnich" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-odchylenia-od-średnich">Krok 2: Odchylenia od średnich</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
<td>−2.5</td>
<td>−14.67</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
<td>−1.5</td>
<td>−9.67</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
<td>−0.5</td>
<td>−4.67</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
<td>0.5</td>
<td>5.33</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
<td>1.5</td>
<td>8.33</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
<td>2.5</td>
<td>15.33</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-3-iloczyny-i-kwadraty" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-iloczyny-i-kwadraty">Krok 3: Iloczyny i kwadraty</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>36.68</td>
<td>6.25</td>
</tr>
<tr class="even">
<td>B</td>
<td>14.51</td>
<td>2.25</td>
</tr>
<tr class="odd">
<td>C</td>
<td>2.34</td>
<td>0.25</td>
</tr>
<tr class="even">
<td>D</td>
<td>2.67</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>E</td>
<td>12.50</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>F</td>
<td>38.33</td>
<td>6.25</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td><strong>107.03</strong></td>
<td><strong>17.50</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="krok-4-nachylenie-hatbeta_1" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-nachylenie-hatbeta_1">Krok 4: Nachylenie <span class="math inline">\hat{\beta}_1</span></h3>
<p><span class="math display">\hat{\beta}_1 = \frac{107.03}{17.50} = 6.12</span></p>
<p><strong>Interpretacja:</strong> +6.12 punktu za każdą dodatkową godzinę nauki.</p>
</section>
<section id="krok-5-wyraz-wolny-hatbeta_0" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-wyraz-wolny-hatbeta_0">Krok 5: Wyraz wolny <span class="math inline">\hat{\beta}_0</span></h3>
<p><span class="math display">\hat{\beta}_0 = 79.67 - 6.12 \cdot 3.5 = 58.25</span></p>
<p><strong>Interpretacja:</strong> przy 0 godzinach przewidujemy <strong>58.25</strong>.</p>
</section>
<section id="krok-6-równanie-regresji" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-równanie-regresji">Krok 6: Równanie regresji</h3>
<p><span class="math display">\hat{Y} = 58.25 + 6.12 X</span></p>
</section>
<section id="krok-7-predykcje-i-reszty" class="level3">
<h3 class="anchored" data-anchor-id="krok-7-predykcje-i-reszty">Krok 7: Predykcje i reszty</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 58.25 + 6.12X_i</span></th>
<th>Reszta <span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
<td>64.37</td>
<td>0.63</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
<td>70.49</td>
<td>−0.49</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
<td>76.61</td>
<td>−1.61</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
<td>82.73</td>
<td>2.27</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
<td>88.85</td>
<td>−0.85</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
<td>94.97</td>
<td>0.03</td>
</tr>
</tbody>
</table>
<p><strong>Kontrola:</strong> suma reszt ≈ 0 ✓</p>
</section>
<section id="krok-8-sumy-kwadratów" class="level3">
<h3 class="anchored" data-anchor-id="krok-8-sumy-kwadratów">Krok 8: Sumy kwadratów</h3>
<p><strong>SST — całkowita:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>65</td>
<td>215.21</td>
</tr>
<tr class="even">
<td>B</td>
<td>70</td>
<td>93.51</td>
</tr>
<tr class="odd">
<td>C</td>
<td>75</td>
<td>21.81</td>
</tr>
<tr class="even">
<td>D</td>
<td>85</td>
<td>28.41</td>
</tr>
<tr class="odd">
<td>E</td>
<td>88</td>
<td>69.39</td>
</tr>
<tr class="even">
<td>F</td>
<td>95</td>
<td>235.01</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td><strong>SST = 663.34</strong></td>
</tr>
</tbody>
</table>
<p><strong>SSR — wyjaśniona:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>64.37</td>
<td>234.09</td>
</tr>
<tr class="even">
<td>B</td>
<td>70.49</td>
<td>84.27</td>
</tr>
<tr class="odd">
<td>C</td>
<td>76.61</td>
<td>9.36</td>
</tr>
<tr class="even">
<td>D</td>
<td>82.73</td>
<td>9.36</td>
</tr>
<tr class="odd">
<td>E</td>
<td>88.85</td>
<td>84.27</td>
</tr>
<tr class="even">
<td>F</td>
<td>94.97</td>
<td>234.09</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td><strong>SSR = 655.44</strong></td>
</tr>
</tbody>
</table>
<p><strong>SSE — błąd:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">e_i</span></th>
<th><span class="math inline">e_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>0.63</td>
<td>0.40</td>
</tr>
<tr class="even">
<td>B</td>
<td>−0.49</td>
<td>0.24</td>
</tr>
<tr class="odd">
<td>C</td>
<td>−1.61</td>
<td>2.59</td>
</tr>
<tr class="even">
<td>D</td>
<td>2.27</td>
<td>5.15</td>
</tr>
<tr class="odd">
<td>E</td>
<td>−0.85</td>
<td>0.72</td>
</tr>
<tr class="even">
<td>F</td>
<td>0.03</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td><strong>SSE = 9.10</strong></td>
</tr>
</tbody>
</table>
<p><strong>Weryfikacja:</strong> <span class="math inline">SST \approx SSR + SSE</span><br>
<span class="math inline">663.34 \approx 655.44 + 9.10 = 664.54</span> (drobne różnice zaokrągleń).</p>
</section>
<section id="krok-9-r2" class="level3">
<h3 class="anchored" data-anchor-id="krok-9-r2">Krok 9: <span class="math inline">R^2</span></h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{655.44}{663.34} = 0.988</span></p>
<p><strong>Alternatywnie:</strong></p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{9.10}{663.34} = 0.986</span></p>
<p><strong>Interpretacja:</strong> ~98.8% zmienności wyników wyjaśniają godziny nauki — <strong>bardzo silny</strong> związek.</p>
</section>
<section id="krok-10-wielkości-efektu" class="level3">
<h3 class="anchored" data-anchor-id="krok-10-wielkości-efektu">Krok 10: Wielkości efektu</h3>
<p><strong>Surowa:</strong> <strong>6.12 pkt/godz.</strong></p>
<p><strong>Standaryzowana:</strong></p>
<ul>
<li><span class="math inline">s_X = \sqrt{17.50/5} = 1.87</span>,</li>
<li><span class="math inline">s_Y = \sqrt{663.34/5} = 11.52</span>,</li>
<li><span class="math inline">\beta_{\text{std}} = 6.12 \cdot (1.87/11.52) = 0.99</span> → <strong>bardzo duży</strong> efekt (wg Cohena).</li>
</ul>
</section>
<section id="krok-11-istotność-praktyczna" class="level3">
<h3 class="anchored" data-anchor-id="krok-11-istotność-praktyczna">Krok 11: Istotność praktyczna</h3>
<ol type="1">
<li><strong>Skala:</strong> 6.12% na 100-punktowej skali / godz.,</li>
<li><strong>Progi:</strong> zmiana oceny (10 pkt) ≈ <strong>1.63 h</strong>,</li>
<li><strong>Koszt-efekt:</strong> korzystny — sensowna inwestycja czasu.</li>
</ol>
</section>
<section id="podsumowanie-wyników" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie-wyników">Podsumowanie wyników</h3>
<ul>
<li><strong>Równanie:</strong> <span class="math inline">\hat{Y} = 58.25 + 6.12 X</span></li>
<li><strong>Nachylenie:</strong> 6.12 pkt/godz.</li>
<li><strong>Wyraz wolny:</strong> 58.25 pkt</li>
<li><span class="math inline">R^2</span>: 0.988</li>
<li><span class="math inline">\beta_{\text{std}}</span>: 0.99</li>
</ul>
<p>W praktyce: każda godzina nauki to ≈ +6 pkt; dopasowanie znakomite; efekt istotny statystycznie i praktycznie.</p>
</section>
<section id="kontrola-wyniku" class="level3">
<h3 class="anchored" data-anchor-id="kontrola-wyniku">Kontrola wyniku</h3>
<p>Sprawdź, że linia przechodzi przez <span class="math inline">(\bar{X}, \bar{Y})</span>:</p>
<p><span class="math display">58.25 + 6.12 \cdot 3.5 = 79.67 = \bar{Y}</span> ✓</p>
</section>
</section>
<section id="kod-r-do-weryfikacji-obliczeń" class="level2" data-number="14.13">
<h2 data-number="14.13" class="anchored" data-anchor-id="kod-r-do-weryfikacji-obliczeń"><span class="header-section-number">14.13</span> Kod R do weryfikacji obliczeń</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 1: Dane</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)      <span class="co"># X</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>exam_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">95</span>) <span class="co"># Y</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(study_hours)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> study_hours,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> exam_scores</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Original Data:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Original Data:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student X  Y
1       A 1 65
2       B 2 70
3       C 3 75
4       D 4 85
5       E 5 88
6       F 6 95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 2: Średnie</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(study_hours)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(exam_scores)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Means:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Means:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Mean of X (study hours): %.2f</span><span class="sc">\n</span><span class="st">"</span>, x_bar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of X (study hours): 3.50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Mean of Y (exam scores): %.2f</span><span class="sc">\n</span><span class="st">"</span>, y_bar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of Y (exam scores): 79.67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 3: Odchylenia od średnich</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>x_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>X <span class="sc">-</span> x_bar</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>Y <span class="sc">-</span> y_bar</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Deviations from means:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Deviations from means:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data[, <span class="fu">c</span>(<span class="st">"Student"</span>, <span class="st">"x_dev"</span>, <span class="st">"y_dev"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student x_dev      y_dev
1       A  -2.5 -14.666667
2       B  -1.5  -9.666667
3       C  -0.5  -4.666667
4       D   0.5   5.333333
5       E   1.5   8.333333
6       F   2.5  15.333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 4: Iloczyny i kwadraty</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>xy_product <span class="ot">&lt;-</span> data<span class="sc">$</span>x_dev <span class="sc">*</span> data<span class="sc">$</span>y_dev</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>x_dev_sq <span class="ot">&lt;-</span> data<span class="sc">$</span>x_dev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>sum_xy_product <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>xy_product)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>sum_x_dev_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>x_dev_sq)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of (Xi - X̄)(Yi - Ȳ):"</span>, <span class="fu">round</span>(sum_xy_product, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of (Xi - X̄)(Yi - Ȳ): 107 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sum of (Xi - X̄)²:"</span>, sum_x_dev_sq, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of (Xi - X̄)²: 17.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 5: Nachylenie (beta_1)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>beta_1_manual <span class="ot">&lt;-</span> sum_xy_product <span class="sc">/</span> sum_x_dev_sq</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Slope (β₁) calculated manually:"</span>, <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Slope (β₁) calculated manually: 6.11 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 6: Wyraz wolny (beta_0)</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>beta_0_manual <span class="ot">&lt;-</span> y_bar <span class="sc">-</span> beta_1_manual <span class="sc">*</span> x_bar</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Intercept (β₀) calculated manually:"</span>, <span class="fu">round</span>(beta_0_manual, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Intercept (β₀) calculated manually: 58.27 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 7: Porównanie z lm()</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Verification with R's lm() function ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Verification with R's lm() function ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error
(Intercept) 58.266667  1.4045278
X            6.114286  0.3606495</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 8: Predykcje i reszty</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Y_hat <span class="ot">&lt;-</span> beta_0_manual <span class="sc">+</span> beta_1_manual <span class="sc">*</span> data<span class="sc">$</span>X</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residual <span class="ot">&lt;-</span> data<span class="sc">$</span>Y <span class="sc">-</span> data<span class="sc">$</span>Y_hat</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted values and residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Predicted values and residuals:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data[, <span class="fu">c</span>(<span class="st">"Student"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Y_hat"</span>, <span class="st">"residual"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student X  Y    Y_hat    residual
1       A 1 65 64.38095  0.61904762
2       B 2 70 70.49524 -0.49523810
3       C 3 75 76.60952 -1.60952381
4       D 4 85 82.72381  2.27619048
5       E 5 88 88.83810 -0.83809524
6       F 6 95 94.95238  0.04761905</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sum of residuals (should be ≈ 0):"</span>, <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residual), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of residuals (should be ≈ 0): 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 9: Sumy kwadratów</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>Y <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Sum of Squares Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sum of Squares Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Total Sum of Squares):"</span>, <span class="fu">round</span>(SST, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Total Sum of Squares): 663.33 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>Y_hat <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Regression Sum of Squares):"</span>, <span class="fu">round</span>(SSR, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Regression Sum of Squares): 654.23 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Error Sum of Squares):"</span>, <span class="fu">round</span>(SSE, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Error Sum of Squares): 9.1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Verification: SST = SSR + SSE</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Verification: SST = SSR + SSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f = %.2f + %.2f</span><span class="sc">\n</span><span class="st">"</span>, SST, SSR, SSE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>663.33 = 654.23 + 9.10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (due to rounding):"</span>, <span class="fu">round</span>(SST <span class="sc">-</span> (SSR <span class="sc">+</span> SSE), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (due to rounding): 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 10: R-kwadrat</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>R_squared_method1 <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>R_squared_method2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSE <span class="sc">/</span> SST)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>R_squared_lm <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- R-squared Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- R-squared Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (Method 1: SSR/SST):"</span>, <span class="fu">round</span>(R_squared_method1, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (Method 1: SSR/SST): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (Method 2: 1 - SSE/SST):"</span>, <span class="fu">round</span>(R_squared_method2, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (Method 2: 1 - SSE/SST): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (from lm function):"</span>, <span class="fu">round</span>(R_squared_lm, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (from lm function): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 11: Wielkości efektu</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Effect Size Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Effect Size Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Raw effect size (slope):"</span>, <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"points per hour</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw effect size (slope): 6.11 points per hour</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>X)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Y)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviations:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviations:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SD of X: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sd_x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of X: 1.87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SD of Y: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sd_y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of Y: 11.52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>beta_std <span class="ot">&lt;-</span> beta_1_manual <span class="sc">*</span> (sd_x <span class="sc">/</span> sd_y)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized effect size: %.2f</span><span class="sc">\n</span><span class="st">"</span>, beta_std))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized effect size: 0.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja (dla regresji prostej |r| = sqrt(R^2))</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(data<span class="sc">$</span>X, data<span class="sc">$</span>Y)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pearson correlation coefficient:"</span>, <span class="fu">round</span>(correlation, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Pearson correlation coefficient: 0.9931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Square root of R²:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(R_squared_method1), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Square root of R²: 0.9931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"These should be equal (within rounding error)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>These should be equal (within rounding error)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 12: Wizualizacja</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Creating Visualization ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Creating Visualization ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>X, data<span class="sc">$</span>Y, </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Study Hours vs Exam Scores with OLS Regression Line"</span>,</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>,</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">100</span>))</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> beta_0_manual, <span class="at">b =</span> beta_1_manual, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Punkt średnich</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x_bar, y_bar, <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Reszty jako odcinki pionowe</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) {</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(data<span class="sc">$</span>X[i], data<span class="sc">$</span>Y[i], data<span class="sc">$</span>X[i], data<span class="sc">$</span>Y_hat[i], </span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, </span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Observed Data"</span>, <span class="st">"Regression Line"</span>, <span class="st">"Mean Point"</span>, <span class="st">"Residuals"</span>),</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"gray"</span>),</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>, <span class="dv">15</span>, <span class="cn">NA</span>),</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">1</span>))</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Równanie na wykresie</span></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>equation_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Y = %.2f + %.2f*X"</span>, beta_0_manual, beta_1_manual)</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>r2_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"R² = %.3f"</span>, R_squared_method1)</span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, <span class="dv">92</span>, equation_text, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, <span class="dv">89</span>, r2_text, <span class="at">pos =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/visualization-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Analiza regresji OLS - godziny nauki vs.&nbsp;wynik testu</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie końcowe</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">========== FINAL SUMMARY ==========</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
========== FINAL SUMMARY ==========</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Regression Equation: Y ="</span>, <span class="fu">round</span>(beta_0_manual, <span class="dv">2</span>), <span class="st">"+"</span>, </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"* X</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Regression Equation: Y = 58.27 + 6.11 * X</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(R_squared_method1, <span class="dv">4</span>), </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"(%.1f%% of variance explained)</span><span class="sc">\n</span><span class="st">"</span>, R_squared_method1 <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9863 (98.6% of variance explained)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standardized Effect Size:"</span>, <span class="fu">round</span>(beta_std, <span class="dv">2</span>), <span class="st">"(Very Large Effect)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standardized Effect Size: 0.99 (Very Large Effect)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Each additional hour of study increases exam score by"</span>, </span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Each additional hour of study increases exam score by 6.11 points</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Study hours explain"</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, R_squared_method1 <span class="sc">*</span> <span class="dv">100</span>), </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"of the variation in exam scores</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Study hours explain 98.6% of the variation in exam scores</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- The relationship is extremely strong (correlation ="</span>, </span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(correlation, <span class="dv">3</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- The relationship is extremely strong (correlation = 0.993 )</code></pre>
</div>
</div>
</section>
<section id="jak-uruchomić-kod" class="level2" data-number="14.14">
<h2 data-number="14.14" class="anchored" data-anchor-id="jak-uruchomić-kod"><span class="header-section-number">14.14</span> Jak uruchomić kod</h2>
<ol type="1">
<li>Skopiuj cały blok kodu,</li>
<li>Wklej do RStudio,</li>
<li>Uruchom chunk po chunk lub cały dokument,</li>
<li>Porównaj wyniki z obliczeniami ręcznymi.</li>
</ol>
<p><strong>Co zobaczysz:</strong></p>
<ul>
<li><strong>Nachylenie:</strong> 6.12,</li>
<li><strong>Wyraz wolny:</strong> 58.25,</li>
<li><span class="math inline">R^2</span>: ≈ 0.988,</li>
<li><strong>Efekt standaryzowany:</strong> ≈ 0.99,</li>
<li>Wykres z punktami, linią regresji i resztami.</li>
</ul>
<p>To potwierdza poprawność obliczeń manualnych.</p>
</section>
</div>
</div>
<hr>
</section>
<section id="appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający" class="level2" data-number="14.15">
<h2 data-number="14.15" class="anchored" data-anchor-id="appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający"><span class="header-section-number">14.15</span> Appendix A: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład wprowadzający</h2>
<p>Studentka politologii bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Gallaghera (GH) w wyborach parlamentarnych w 10 losowo wybranych demokracjach.</p>
<p>Dane dotyczące wielkości okręgu wyborczego (<span class="math inline">\text{DM}</span>) i indeksu Gallaghera:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\text{DM}</span> (<span class="math inline">X</span>)</th>
<th>Gallagher (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18,2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16,7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15,8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15,3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15,0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14,8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14,7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14,6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14,55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14,52</td>
</tr>
</tbody>
</table>
<section id="krok-1-obliczanie-podstawowych-statystyk" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczanie-podstawowych-statystyk">Krok 1: Obliczanie Podstawowych Statystyk</h3>
<p>Obliczanie średnich:</p>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65</span> <span class="math display">\bar{x} = \frac{65}{10} = 6,5</span></p>
<p>Dla indeksu Gallaghera (<span class="math inline">Y</span>): <span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">18,2 + 16,7 + 15,8 + 15,3 + 15,0 + 14,8 + 14,7 + 14,6 + 14,55 + 14,52 = 154,17</span> <span class="math display">\bar{y} = \frac{154,17}{10} = 15,417</span></p>
</section>
<section id="krok-2-szczegółowe-obliczenia-kowariancji" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-szczegółowe-obliczenia-kowariancji">Krok 2: Szczegółowe Obliczenia Kowariancji</h3>
<p>Pełna tabela robocza ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td><span class="math inline">-4,5</span></td>
<td>2,783</td>
<td><span class="math inline">-12,5235</span></td>
<td>20,25</td>
<td>7,7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td><span class="math inline">-3,5</span></td>
<td>1,283</td>
<td><span class="math inline">-4,4905</span></td>
<td>12,25</td>
<td>1,6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td><span class="math inline">-2,5</span></td>
<td>0,383</td>
<td><span class="math inline">-0,9575</span></td>
<td>6,25</td>
<td>0,1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td><span class="math inline">-1,5</span></td>
<td><span class="math inline">-0,117</span></td>
<td>0,1755</td>
<td>2,25</td>
<td>0,0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td><span class="math inline">-0,5</span></td>
<td><span class="math inline">-0,417</span></td>
<td>0,2085</td>
<td>0,25</td>
<td>0,1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>0,5</td>
<td><span class="math inline">-0,617</span></td>
<td><span class="math inline">-0,3085</span></td>
<td>0,25</td>
<td>0,3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>1,5</td>
<td><span class="math inline">-0,717</span></td>
<td><span class="math inline">-1,0755</span></td>
<td>2,25</td>
<td>0,5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,5</td>
<td><span class="math inline">-0,817</span></td>
<td><span class="math inline">-2,0425</span></td>
<td>6,25</td>
<td>0,6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>3,5</td>
<td><span class="math inline">-0,867</span></td>
<td><span class="math inline">-3,0345</span></td>
<td>12,25</td>
<td>0,7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>4,5</td>
<td><span class="math inline">-0,897</span></td>
<td><span class="math inline">-4,0365</span></td>
<td>20,25</td>
<td>0,8047</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>0</td>
<td>0</td>
<td><span class="math inline">-28,085</span></td>
<td>82,5</td>
<td>12,8442</td>
</tr>
</tbody>
</table>
<p>Obliczanie kowariancji: <span class="math display">\text{Cov}(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p><span class="math display">\text{Cov}(X,Y) = \frac{-28,085}{9} = -3,120556</span></p>
</section>
<section id="krok-3-obliczanie-odchylenia-standardowego" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczanie-odchylenia-standardowego">Krok 3: Obliczanie Odchylenia Standardowego</h3>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_x = \sqrt{\frac{82,5}{9}} = \sqrt{9,1667} = 3,026582</span></p>
<p>Dla Gallaghera (<span class="math inline">Y</span>): <span class="math display">\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_y = \sqrt{\frac{12,8442}{9}} = \sqrt{1,4271} = 1,194612</span></p>
</section>
<section id="krok-4-obliczanie-korelacji-pearsona" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-obliczanie-korelacji-pearsona">Krok 4: Obliczanie Korelacji Pearsona</h3>
<p><span class="math display">r = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y}</span></p>
<p><span class="math display">r = \frac{-3,120556}{3,026582 \times 1,194612} = \frac{-3,120556}{3,615752} = -0,863044</span></p>
</section>
<section id="krok-5-obliczanie-korelacji-rangowej-spearmana" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-obliczanie-korelacji-rangowej-spearmana">Krok 5: Obliczanie Korelacji Rangowej Spearmana</h3>
<p>Pełna tabela rangowa ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th>Ranga <span class="math inline">X_i</span></th>
<th>Ranga <span class="math inline">Y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>1</td>
<td>10</td>
<td><span class="math inline">-9</span></td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>2</td>
<td>9</td>
<td><span class="math inline">-7</span></td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>3</td>
<td>8</td>
<td><span class="math inline">-5</span></td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>4</td>
<td>7</td>
<td><span class="math inline">-3</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>5</td>
<td>6</td>
<td><span class="math inline">-1</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Obliczanie korelacji Spearmana: <span class="math display">\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></p>
<p><span class="math display">\rho = 1 - \frac{6 \times 330}{10(100 - 1)} = 1 - \frac{1980}{990} = 1 - 2 = -1</span></p>
</section>
<section id="krok-6-weryfikacja-w-r" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-weryfikacja-w-r">Krok 6: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wektorów</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie kowariancji</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="krok-7-podstawowa-wizualizacja" class="level3">
<h3 class="anchored" data-anchor-id="krok-7-podstawowa-wizualizacja">Krok 7: Podstawowa Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu rozrzutu</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wielkość Okręgu vs Indeks Gallaghera"</span>,</span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wielkość Okręgu (DM)"</span>,</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera (GH)"</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estymacja-ols-i-miary-dopasowania-modelu" class="level3">
<h3 class="anchored" data-anchor-id="estymacja-ols-i-miary-dopasowania-modelu">Estymacja OLS i Miary Dopasowania Modelu</h3>
</section>
<section id="krok-1-obliczanie-estymatorów-ols" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczanie-estymatorów-ols">Krok 1: Obliczanie Estymatorów OLS</h3>
<p>Korzystając z wcześniej obliczonych wartości:</p>
<ul>
<li><span class="math inline">\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28,085</span></li>
<li><span class="math inline">\sum(X_i - \bar{X})^2 = 82,5</span></li>
<li><span class="math inline">\bar{X} = 6,5</span></li>
<li><span class="math inline">\bar{Y} = 15,417</span></li>
</ul>
<p>Obliczanie nachylenia (<span class="math inline">\hat{\beta_1}</span>):</p>
<p><span class="math inline">\hat{\beta_1} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta_1} = -28,085 ÷ 82,5 = -0,3404</span></p>
<p>Obliczanie wyrazu wolnego (<span class="math inline">\hat{\beta_0}</span>): <span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</span></p>
<p>Zatem równanie regresji OLS ma postać: <span class="math inline">\hat{Y} = 17,6296 - 0,3404X</span></p>
</section>
<section id="krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-obliczanie-wartości-dopasowanych-i-reszt">Krok 2: Obliczanie Wartości Dopasowanych i Reszt</h3>
<p>Pełna tabela ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">e_i^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>16,9488</td>
<td>1,2512</td>
<td>1,5655</td>
<td>7,7451</td>
<td>2,3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>16,6084</td>
<td>0,0916</td>
<td>0,0084</td>
<td>1,6461</td>
<td>1,4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>16,2680</td>
<td>-0,4680</td>
<td>0,2190</td>
<td>0,1467</td>
<td>0,7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>15,9276</td>
<td>-0,6276</td>
<td>0,3939</td>
<td>0,0137</td>
<td>0,2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>15,5872</td>
<td>-0,5872</td>
<td>0,3448</td>
<td>0,1739</td>
<td>0,0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>15,2468</td>
<td>-0,4468</td>
<td>0,1996</td>
<td>0,3807</td>
<td>0,0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>14,9064</td>
<td>-0,2064</td>
<td>0,0426</td>
<td>0,5141</td>
<td>0,2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>14,5660</td>
<td>0,0340</td>
<td>0,0012</td>
<td>0,6675</td>
<td>0,7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>14,2256</td>
<td>0,3244</td>
<td>0,1052</td>
<td>0,7517</td>
<td>1,4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>13,8852</td>
<td>0,6348</td>
<td>0,4030</td>
<td>0,8047</td>
<td>2,3439</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>154,17</td>
<td>0</td>
<td>3,2832</td>
<td>12,8442</td>
<td>9,5524</td>
</tr>
</tbody>
</table>
<p>Obliczenia dla wartości dopasowanych:</p>
<pre><code>Dla X = 2:
Ŷ = 17,6296 + (-0,3404 × 2) = 16,9488

Dla X = 3:
Ŷ = 17,6296 + (-0,3404 × 3) = 16,6084

[... kontynuacja dla wszystkich wartości]</code></pre>
</section>
<section id="krok-3-obliczanie-miar-dopasowania" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczanie-miar-dopasowania">Krok 3: Obliczanie Miar Dopasowania</h3>
<p>Suma kwadratów reszt (SSE): <span class="math inline">SSE = \sum e_i^2</span></p>
<pre><code>SSE = 3,2832</code></pre>
<p>Całkowita suma kwadratów (SST): <span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<pre><code>SST = 12,8442</code></pre>
<p>Suma kwadratów regresji (SSR): <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<pre><code>SSR = 9,5524</code></pre>
<p>Weryfikacja dekompozycji: <span class="math inline">SST = SSR + SSE</span></p>
<pre><code>12,8442 = 9,5524 + 3,2832 (w granicach błędu zaokrąglenia)</code></pre>
<p>Obliczanie współczynnika determinacji R-kwadrat: <span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<pre><code>R² = 9,5524 ÷ 12,8442
   = 0,7438</code></pre>
</section>
<section id="krok-4-weryfikacja-w-r" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-weryfikacja-w-r">Krok 4: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu liniowego</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie statystyk</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 0.000000000467 ***
DM          -0.34042    0.07053  -4.827        0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ręczne obliczenie R-kwadrat</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="krok-5-analiza-reszt" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-analiza-reszt">Krok 5: Analiza Reszt</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów reszt</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych">Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu wartości przewidywanych vs rzeczywistych</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> GH,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Przewidywane, <span class="at">y =</span> Rzeczywiste)) <span class="sc">+</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wartości Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Przewidywany Indeks Gallaghera"</span>,</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rzeczywisty Indeks Gallaghera"</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modele-z-transformacją-logarytmiczną" class="level3">
<h3 class="anchored" data-anchor-id="modele-z-transformacją-logarytmiczną">Modele z Transformacją Logarytmiczną</h3>
</section>
<section id="krok-1-transformacja-danych" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-transformacja-danych">Krok 1: Transformacja Danych</h3>
<p>Najpierw obliczamy logarytmy naturalne zmiennych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\ln(X_i)</span></th>
<th><span class="math inline">\ln(Y_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>0,6931</td>
<td>2,9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>1,0986</td>
<td>2,8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>1,3863</td>
<td>2,7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>1,6094</td>
<td>2,7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>1,7918</td>
<td>2,7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>1,9459</td>
<td>2,6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>2,0794</td>
<td>2,6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,1972</td>
<td>2,6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>2,3026</td>
<td>2,6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>2,3979</td>
<td>2,6757</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-2-porównanie-różnych-specyfikacji-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-porównanie-różnych-specyfikacji-modelu">Krok 2: Porównanie Różnych Specyfikacji Modelu</h3>
<p>Szacujemy trzy alternatywne specyfikacje:</p>
<ol type="1">
<li>Model log-liniowy: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i</span></li>
<li>Model liniowo-logarytmiczny: <span class="math inline">Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
<li>Model log-log: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie zmiennych transformowanych</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modeli</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie wartości R-kwadrat</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Liniowy"</span>, <span class="st">"Log-liniowy"</span>, <span class="st">"Liniowo-logarytmiczny"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Model R_kwadrat
1               Liniowy 0.7443793
2           Log-liniowy 0.7670346
3 Liniowo-logarytmiczny 0.9141560
4               Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="krok-3-porównanie-wizualne" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-porównanie-wizualne">Krok 3: Porównanie Wizualne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów dla każdego modelu</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowy"</span>) <span class="sc">+</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-liniowy"</span>) <span class="sc">+</span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny"</span>) <span class="sc">+</span></span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb184-22"><a href="#cb184-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb184-23"><a href="#cb184-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-log"</span>) <span class="sc">+</span></span>
<span id="cb184-24"><a href="#cb184-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb184-25"><a href="#cb184-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-26"><a href="#cb184-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Układanie wykresów w siatkę</span></span>
<span id="cb184-27"><a href="#cb184-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb184-28"><a href="#cb184-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-4-analiza-reszt-dla-najlepszego-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-analiza-reszt-dla-najlepszego-modelu">Krok 4: Analiza Reszt dla Najlepszego Modelu</h3>
<p>Na podstawie wartości R-kwadrat, analiza reszt dla najlepiej dopasowanego modelu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykresy reszt dla najlepszego modelu</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-5-interpretacja-najlepszego-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-interpretacja-najlepszego-modelu">Krok 5: Interpretacja Najlepszego Modelu</h3>
<p>Współczynniki modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value        Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 0.0000000000494 ***
log_DM       -2.0599     0.2232   -9.23 0.0000153880425 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 0.00001539</code></pre>
</div>
</div>
<p>Interpretacja:</p>
<ul>
<li><span class="math inline">\hat{\beta_0}</span> reprezentuje oczekiwany Indeks Gallaghera, gdy ln(DM) = 0 (czyli gdy DM = 1)</li>
<li><span class="math inline">\hat{\beta_1}</span> reprezentuje zmianę Indeksu Gallaghera związaną z jednostkowym wzrostem ln(DM)</li>
</ul>
</section>
<section id="krok-6-predykcje-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-predykcje-modelu">Krok 6: Predykcje Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu predykcji dla najlepszego modelu</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny: Indeks Gallaghera vs ln(Wielkość Okręgu)"</span>,</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(Wielkość Okręgu)"</span>,</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera"</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-7-analiza-elastyczności" class="level3">
<h3 class="anchored" data-anchor-id="krok-7-analiza-elastyczności">Krok 7: Analiza Elastyczności</h3>
<p>Dla modelu log-log współczynniki bezpośrednio reprezentują elastyczności. Obliczenie średniej elastyczności dla modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie elastyczności przy wartościach średnich</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>elastycznosc <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>elastycznosc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>Wartość ta reprezentuje procentową zmianę Indeksu Gallaghera przy jednoprocentowej zmianie Wielkości Okręgu.</p>
<hr>
</section>
</section>
<section id="appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne" class="level2" data-number="14.16">
<h2 data-number="14.16" class="anchored" data-anchor-id="appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne"><span class="header-section-number">14.16</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - przykłady różne</h2>
</section>
<section id="przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą" class="level2" data-number="14.17">
<h2 data-number="14.17" class="anchored" data-anchor-id="przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą"><span class="header-section-number">14.17</span> Przykład 1. Analiza związku między dobrobytem ekonomicznym a frekwencją wyborczą</h2>
<p>Analiza związku między dobrobytem ekonomicznym a frekwencją wyborczą w dzielnicach Amsterdamu na podstawie danych z wyborów samorządowych 2022.</p>
<section id="dane" class="level3">
<h3 class="anchored" data-anchor-id="dane">Dane</h3>
<p>Próba obejmuje pięć reprezentatywnych dzielnic:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Dzielnica</th>
<th>Dochód (tys. €)</th>
<th>Frekwencja (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Noord</td>
<td>50</td>
<td>60</td>
</tr>
<tr class="even">
<td>Zuid</td>
<td>45</td>
<td>56</td>
</tr>
<tr class="odd">
<td>Centrum</td>
<td>56</td>
<td>70</td>
</tr>
<tr class="even">
<td>West</td>
<td>40</td>
<td>50</td>
</tr>
<tr class="odd">
<td>Oost</td>
<td>60</td>
<td>75</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wczytanie bibliotek</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie zbioru danych</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dzielnica =</span> <span class="fu">c</span>(<span class="st">"Noord"</span>, <span class="st">"Zuid"</span>, <span class="st">"Centrum"</span>, <span class="st">"West"</span>, <span class="st">"Oost"</span>),</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>),</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">frekwencja =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>)</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Podgląd danych</span></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a>dane</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  dzielnica dochod frekwencja
1     Noord     50         60
2      Zuid     45         56
3   Centrum     56         70
4      West     40         50
5      Oost     60         75</code></pre>
</div>
</div>
</section>
<section id="część-1-statystyki-opisowe" class="level3">
<h3 class="anchored" data-anchor-id="część-1-statystyki-opisowe">Część 1: Statystyki opisowe</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki dla dochodu</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"DOCHÓD (tys. €):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DOCHÓD (tys. €):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnia:"</span>, <span class="fu">mean</span>(dane<span class="sc">$</span>dochod), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnia: 50.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mediana:"</span>, <span class="fu">median</span>(dane<span class="sc">$</span>dochod), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mediana: 50 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odchylenie standardowe:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(dane<span class="sc">$</span>dochod), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odchylenie standardowe: 8.07 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Zakres:"</span>, <span class="fu">min</span>(dane<span class="sc">$</span>dochod), <span class="st">"-"</span>, <span class="fu">max</span>(dane<span class="sc">$</span>dochod), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zakres: 40 - 60 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki dla frekwencji</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"FREKWENCJA (%):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FREKWENCJA (%):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnia:"</span>, <span class="fu">mean</span>(dane<span class="sc">$</span>frekwencja), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnia: 62.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mediana:"</span>, <span class="fu">median</span>(dane<span class="sc">$</span>frekwencja), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mediana: 60 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odchylenie standardowe:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(dane<span class="sc">$</span>frekwencja), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odchylenie standardowe: 10.21 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Zakres:"</span>, <span class="fu">min</span>(dane<span class="sc">$</span>frekwencja), <span class="st">"-"</span>, <span class="fu">max</span>(dane<span class="sc">$</span>frekwencja))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zakres: 50 - 75</code></pre>
</div>
</div>
</section>
<section id="część-2-analiza-korelacji" class="level3">
<h3 class="anchored" data-anchor-id="część-2-analiza-korelacji">Część 2: Analiza korelacji</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test korelacji Pearsona</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>korelacja <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(dane<span class="sc">$</span>dochod, dane<span class="sc">$</span>frekwencja)</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Współczynnik korelacji (r):"</span>, <span class="fu">round</span>(korelacja<span class="sc">$</span>estimate, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Współczynnik korelacji (r): 0.994 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, <span class="fu">round</span>(korelacja<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 0.001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretacja</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (korelacja<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Wynik jest statystycznie istotny (p &lt; 0.05)"</span>)</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Wynik nie jest statystycznie istotny (p ≥ 0.05)"</span>)</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wynik jest statystycznie istotny (p &lt; 0.05)</code></pre>
</div>
</div>
</section>
<section id="część-3-model-regresji-liniowej" class="level3">
<h3 class="anchored" data-anchor-id="część-3-model-regresji-liniowej">Część 3: Model regresji liniowej</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(frekwencja <span class="sc">~</span> dochod, <span class="at">data =</span> dane)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podstawowe informacje o modelu</span></span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = frekwencja ~ dochod, data = dane)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
dochod       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared - jak dobrze model wyjaśnia dane</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model wyjaśnia"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% zmienności frekwencji"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model wyjaśnia 98.9 % zmienności frekwencji</code></pre>
</div>
</div>
</section>
<section id="część-4-wizualizacja" class="level3">
<h3 class="anchored" data-anchor-id="część-4-wizualizacja">Część 4: Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres rozrzutu z linią regresji</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> dochod, <span class="at">y =</span> frekwencja)) <span class="sc">+</span></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> dzielnica), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Dochód vs Frekwencja wyborcza"</span>,</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"r ="</span>, <span class="fu">round</span>(korelacja<span class="sc">$</span>estimate, <span class="dv">3</span>)),</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Średni dochód (tys. €)"</span>,</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frekwencja wyborcza (%)"</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="część-5-interpretacja-wyników" class="level3">
<h3 class="anchored" data-anchor-id="część-5-interpretacja-wyników">Część 5: Interpretacja wyników</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pobranie współczynników</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>wspolczynniki <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>przeciecie <span class="ot">&lt;-</span> <span class="fu">round</span>(wspolczynniki[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>nachylenie <span class="ot">&lt;-</span> <span class="fu">round</span>(wspolczynniki[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RÓWNANIE REGRESJI:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RÓWNANIE REGRESJI:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Frekwencja ="</span>, przeciecie, <span class="st">"+"</span>, nachylenie, <span class="st">"× Dochód</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frekwencja = -0.9 + 1.26 × Dochód</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTERPRETACJA:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>INTERPRETACJA:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"• Wzrost dochodu o 1000€ zwiększa frekwencję o"</span>, nachylenie, <span class="st">"punktów procentowych</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• Wzrost dochodu o 1000€ zwiększa frekwencję o 1.26 punktów procentowych</code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"• Korelacja jest"</span>, <span class="fu">ifelse</span>(korelacja<span class="sc">$</span>estimate <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"dodatnia"</span>, <span class="st">"ujemna"</span>), </span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"i"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(korelacja<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"silna"</span>, </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ifelse</span>(<span class="fu">abs</span>(korelacja<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"umiarkowana"</span>, <span class="st">"słaba"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• Korelacja jest dodatnia i silna</code></pre>
</div>
</div>
</section>
<section id="wnioski" class="level3">
<h3 class="anchored" data-anchor-id="wnioski">Wnioski</h3>
<p><strong>Główne ustalenia:</strong></p>
<ul>
<li>Istnieje silna dodatnia korelacja (r = 0.994) między dochodem a frekwencją wyborczą</li>
<li>Model wyjaśnia 98.9% zmienności w danych</li>
<li>Dzielnice z wyższymi dochodami mają wyższą frekwencję wyborczą</li>
</ul>
<p><strong>Ważne ograniczenie:</strong></p>
<p>⚠️ Mała próba (n=5) oznacza, że wyniki należy traktować ostrożnie i nie można ich generalizować na całą populację bez dodatkowych badań.</p>
<p><strong>Praktyczne zastosowanie:</strong></p>
<p>Wyniki sugerują, że działania mające na celu zwiększenie frekwencji wyborczej powinny szczególnie koncentrować się na dzielnicach o niższych dochodach.</p>
<p><strong>Ograniczenia i zastrzeżenia:</strong></p>
<p>⚠️ <strong>Krytyczne ograniczenia:</strong></p>
<ul>
<li><strong>Bardzo mała próba</strong> (n=5) znacznie ogranicza możliwość generalizacji</li>
<li><strong>Niska moc statystyczna</strong> - ryzyko błędów II rodzaju</li>
<li><strong>Brak kontroli zmiennych zakłócających</strong> (wiek, wykształcenie, gęstość zaludnienia)</li>
<li><strong>Możliwa korelacja pozorna</strong> - potrzebne dodatkowe zmienne kontrolne</li>
</ul>
<p><strong>Rekomendacje dla przyszłych badań:</strong></p>
<ul>
<li>Zwiększenie próby do wszystkich dzielnic Amsterdamu</li>
<li>Włączenie zmiennych demograficznych i socjoekonomicznych</li>
<li>Analiza danych longitudinalnych z kilku cykli wyborczych</li>
</ul>
</section>
</section>
<section id="przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="level2" data-number="14.18">
<h2 data-number="14.18" class="anchored" data-anchor-id="przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">14.18</span> Przykład 2. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</h2>
<p>Ta analiza bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Indeks Loosemore-Hanby mierzy dysproporcjonalność wyborczą, gdzie wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane-1" class="level3">
<h3 class="anchored" data-anchor-id="dane-1">Dane</h3>
<div class="cell" data-tbl-cap="Wielkość Okręgu i Indeks LH według Kraju">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'knitr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość Okręgu i Indeks LH według Kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">12.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm">Obliczenia dla Wielkości Okręgu (DM)</h4>
<p>Najpierw obliczam średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{3 + 4 + 5 + 6 + 7 + 8}{6} = \frac{33}{6} = 5.5</span></p>
<p>Następnie obliczam wariancję używając formuły z korektą Bessela:</p>
<p><span class="math display">\sigma^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td><span class="math inline">3 - 5.5 = -2.5</span></td>
<td><span class="math inline">(-2.5)^2 = 6.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td><span class="math inline">4 - 5.5 = -1.5</span></td>
<td><span class="math inline">(-1.5)^2 = 2.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td><span class="math inline">5 - 5.5 = -0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td><span class="math inline">6 - 5.5 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 5.5 = 1.5</span></td>
<td><span class="math inline">(1.5)^2 = 2.25</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td><span class="math inline">8 - 5.5 = 2.5</span></td>
<td><span class="math inline">(2.5)^2 = 6.25</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>17.5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{DM} = \frac{17.5}{6-1} = \frac{17.5}{5} = 3.5</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">\sigma_{DM} = \sqrt{\sigma^2_{DM}} = \sqrt{3.5} = 1.871</span></p>
</section>
<section id="obliczenia-dla-indeksu-lh" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-indeksu-lh">Obliczenia dla Indeksu LH</h4>
<p>Najpierw obliczam średnią wartości LH:</p>
<p><span class="math display">\bar{x}_{LH} = \frac{15.5 + 14.25 + 13.5 + 13.5 + 13 + 12.75}{6} = \frac{82.5}{6} = 13.75</span></p>
<p>Następnie obliczam wariancję:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 17%">
<col style="width: 35%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td><span class="math inline">15.5 - 13.75 = 1.75</span></td>
<td><span class="math inline">(1.75)^2 = 3.0625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td><span class="math inline">14.25 - 13.75 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td><span class="math inline">12.75 - 13.75 = -1</span></td>
<td><span class="math inline">(-1)^2 = 1</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{LH} = \frac{5}{6-1} = \frac{5}{5} = 1</span></p>
<p>Odchylenie standardowe wynosi:</p>
<p><span class="math display">\sigma_{LH} = \sqrt{\sigma^2_{LH}} = \sqrt{1} = 1</span></p>
<p><strong>Podsumowanie Zadania 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 3.5</li>
<li>Odchylenie Standardowe DM: 1.871</li>
<li>Wariancja LH (z korektą Bessela): 1</li>
<li>Odchylenie Standardowe LH: 1</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu formuły z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td>-2.5</td>
<td>1.75</td>
<td><span class="math inline">(-2.5)(1.75) = -4.375</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td>-1.5</td>
<td>0.5</td>
<td><span class="math inline">(-1.5)(0.5) = -0.75</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td>-0.5</td>
<td>-0.25</td>
<td><span class="math inline">(-0.5)(-0.25) = 0.125</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td>0.5</td>
<td>-0.25</td>
<td><span class="math inline">(0.5)(-0.25) = -0.125</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td>1.5</td>
<td>-0.75</td>
<td><span class="math inline">(1.5)(-0.75) = -1.125</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td>2.5</td>
<td>-1</td>
<td><span class="math inline">(2.5)(-1) = -2.5</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-8.75</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-8.75}{5} = -1.75</span></p>
<p><strong>Kowariancja między DM i LH: -1.75</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: gdy wielkość okręgu wzrasta, indeks dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</h3>
<p>Współczynnik korelacji Pearsona obliczany jest przy użyciu formuły:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{\sigma_{DM} \cdot \sigma_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -1.75</span></li>
<li><span class="math inline">\sigma_{DM} = 1.871</span></li>
<li><span class="math inline">\sigma_{LH} = 1</span></li>
</ul>
<p><span class="math display">r = \frac{-1.75}{1.871 \cdot 1} = \frac{-1.75}{1.871} = -0.935</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.935</strong></p>
<section id="interpretacja" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja">Interpretacja:</h4>
<p>Współczynnik korelacji -0.935 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Znak ujemny pokazuje odwrotną zależność między wielkością okręgu a indeksem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.935 wskazuje na bardzo silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości indeksu LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że gdy wielkość okręgu wzrasta, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami (więcej przedstawicieli wybieranych z jednego okręgu) zwykle dają bardziej proporcjonalne wyniki (niższa dysproporcjonalność).</p></li>
</ol>
<p>Odkrycie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi zapewniają więcej możliwości mniejszym partiom, aby uzyskać reprezentację, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</h3>
<p>Formuła dla regresji liniowej prostej:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny (przecięcie)</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Formuła do obliczenia <span class="math inline">\beta_1</span> to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{\sigma^2_{DM}} = \frac{-1.75}{3.5} = -0.5</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, używam:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 13.75 - (-0.5) \cdot 5.5 = 13.75 + 2.75 = 16.5</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.5 - 0.5 \cdot DM</span></p>
<section id="obliczanie-wartości-przewidywanych-i-błędów" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-wartości-przewidywanych-i-błędów">Obliczanie wartości przewidywanych i błędów</h4>
<p>Używając naszego równania regresji, obliczam przewidywane wartości LH:</p>
<p><span class="math inline">\hat{LH} = 16.5 - 0.5 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.5 - 0.5x_i</span>)</th>
<th>Błąd (<span class="math inline">y_i - \hat{y}_i</span>)</th>
<th>Błąd bezwzględny (<span class="math inline">|y_i - \hat{y}_i|</span>)</th>
<th>Błąd kwadratowy (<span class="math inline">[y_i - \hat{y}_i]^2</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td><span class="math inline">16.5 - 0.5(3) = 16.5 - 1.5 = 15</span></td>
<td><span class="math inline">15.5 - 15 = 0.5</span></td>
<td><span class="math inline">|0.5| = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td><span class="math inline">16.5 - 0.5(4) = 16.5 - 2 = 14.5</span></td>
<td><span class="math inline">14.25 - 14.5 = -0.25</span></td>
<td><span class="math inline">|-0.25| = 0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(5) = 16.5 - 2.5 = 14</span></td>
<td><span class="math inline">13.5 - 14 = -0.5</span></td>
<td><span class="math inline">|-0.5| = 0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(6) = 16.5 - 3 = 13.5</span></td>
<td><span class="math inline">13.5 - 13.5 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td><span class="math inline">16.5 - 0.5(7) = 16.5 - 3.5 = 13</span></td>
<td><span class="math inline">13 - 13 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td><span class="math inline">16.5 - 0.5(8) = 16.5 - 4 = 12.5</span></td>
<td><span class="math inline">12.75 - 12.5 = 0.25</span></td>
<td><span class="math inline">|0.25| = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>1.5</strong></td>
<td><strong>0.625</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="obliczanie-r-kwadrat" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-r-kwadrat">Obliczanie R-kwadrat</h4>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Obliczyliśmy już te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td>1.75</td>
<td>3.0625</td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td>0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td>-0.75</td>
<td>0.5625</td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SST = 5</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math inline">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15</td>
<td><span class="math inline">15 - 13.75 = 1.25</span></td>
<td><span class="math inline">(1.25)^2 = 1.5625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.5</td>
<td><span class="math inline">14.5 - 13.75 = 0.75</span></td>
<td><span class="math inline">(0.75)^2 = 0.5625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>14</td>
<td><span class="math inline">14 - 13.75 = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.5</td>
<td><span class="math inline">12.5 - 13.75 = -1.25</span></td>
<td><span class="math inline">(-1.25)^2 = 1.5625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>4.375</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SSR = 4.375</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math inline">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<p>Z tabeli powyżej, suma kwadratów błędów wynosi:</p>
<p><span class="math inline">SSE = 0.625</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia sprawdzając, czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math inline">5 = 4.375 + 0.625 = 5 \checkmark</span></p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math inline">R^2 = \frac{SSR}{SST} = \frac{4.375}{5} = 0.875</span></p>
</section>
<section id="obliczanie-rmse-root-mean-square-error" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-rmse-root-mean-square-error">Obliczanie RMSE (Root Mean Square Error)</h4>
<p>RMSE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Używając naszego obliczonego SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{0.625}{6}} = \sqrt{0.104} \approx 0.323</span></p>
</section>
<section id="obliczanie-mae-mean-absolute-error" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-mae-mean-absolute-error">Obliczanie MAE (Mean Absolute Error)</h4>
<p>MAE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">MAE = \frac{\sum_{i=1}^{n}|y_i - \hat{y}_i|}{n}</span></p>
<p>Używając sum z tabeli:</p>
<p><span class="math inline">MAE = \frac{1.5}{6} = 0.25</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.5 - 0.5 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.875</p>
<p><strong>RMSE</strong>: 0.323</p>
<p><strong>MAE</strong>: 0.25</p>
</section>
<section id="interpretacja-1" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja-1">Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego wzrostu jednostkowego wielkości okręgu, indeks dysproporcjonalności LH jest oczekiwany spadek o 0.5 jednostki. Wyraz wolny (16.5) reprezentuje oczekiwany indeks LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.875 wskazuje, że około 87.5% wariancji w dysproporcjonalności wyborczej (indeks LH) może być wyjaśnione przez wielkość okręgu. Jest to wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej.</p></li>
<li><p><strong>RMSE i MAE</strong>: Niskie wartości RMSE (0.323) i MAE (0.25) wskazują, że model dobrze dopasowuje się do danych, z małymi błędami predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Odkrycia sugerują, że zwiększanie wielkości okręgu mogłoby być skuteczną strategią reformy wyborczej dla krajów dążących do zmniejszenia dysproporcjonalności między głosami a mandatami. Jednak korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać w wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="przykład-3.-descriptive-statistics-and-ols-example---income-and-voter-turnout-en" class="level2" data-number="14.19">
<h2 data-number="14.19" class="anchored" data-anchor-id="przykład-3.-descriptive-statistics-and-ols-example---income-and-voter-turnout-en"><span class="header-section-number">14.19</span> Przykład 3. Descriptive Statistics and OLS Example - Income and Voter Turnout [EN]</h2>
<p><strong>Background</strong></p>
<p>In preparation for the 2024 municipal elections, the Amsterdam Electoral Commission conducted research on voter participation patterns across different city neighborhoods. A key question emerged:</p>
<p>Does economic prosperity of a neighborhood correlate with civic engagement, specifically voter turnout?</p>
<p><strong>Data Collection</strong></p>
<p>Sample: 5 representative neighborhoods in Amsterdam</p>
<p>Time Period: Data from the 2022 municipal elections</p>
<p>Variables:</p>
<ul>
<li>Income: Average annual household income per capita (thousands €)</li>
<li>Turnout: Percentage of registered voters who voted in the election</li>
</ul>
<section id="initial-r-output-for-reference" class="level3">
<h3 class="anchored" data-anchor-id="initial-r-output-for-reference">Initial R Output for Reference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>)  <span class="co"># thousands €</span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>turnout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># %</span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model check</span></span>
<span id="cb238-6"><a href="#cb238-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnout <span class="sc">~</span> income)</span>
<span id="cb238-7"><a href="#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = turnout ~ income)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
income       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
</div>
</section>
<section id="dispersion-measures" class="level3">
<h3 class="anchored" data-anchor-id="dispersion-measures">Dispersion Measures</h3>
<p><strong>Means:</strong></p>
<p><span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n} = \frac{50 + 45 + 56 + 40 + 60}{5} = \frac{251}{5} = 50.2</span></p>
<p><span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n} = \frac{60 + 56 + 70 + 50 + 75}{5} = \frac{311}{5} = 62.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)  <span class="co"># 50.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(turnout) <span class="co"># 62.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.2</code></pre>
</div>
</div>
<p><strong>Variances:</strong></p>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X: <span class="math inline">(-0.2, -5.2, 5.8, -10.2, 9.8)</span></p>
<p><span class="math display">s^2_X = \frac{0.04 + 27.04 + 33.64 + 104.04 + 96.04}{4} = \frac{260.8}{4} = 65.2</span></p>
<p>Deviations for Y: <span class="math inline">(-2.2, -6.2, 7.8, -12.2, 12.8)</span></p>
<p><span class="math display">s^2_Y = \frac{4.84 + 38.44 + 60.84 + 148.84 + 163.84}{4} = \frac{416.8}{4} = 104.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(income)  <span class="co"># 65.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(turnout) <span class="co"># 104.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.2</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-correlation">Covariance and Correlation</h3>
<p><strong>Covariance:</strong></p>
<p><span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-0.2 \times -2.2) = 0.44</span> <span class="math display">(-5.2 \times -6.2) = 32.24</span> <span class="math display">(5.8 \times 7.8) = 45.24</span> <span class="math display">(-10.2 \times -12.2) = 124.44</span> <span class="math display">(9.8 \times 12.8) = 125.44</span></p>
<p><span class="math display">s_{XY} = \frac{327.8}{4} = 81.95</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(income, turnout) <span class="co"># 81.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.95</code></pre>
</div>
</div>
<p><strong>Correlation:</strong></p>
<p><span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{81.95}{\sqrt{65.2}\sqrt{104.2}} = 0.994</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(income, turnout) <span class="co"># 0.994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9942402</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong></p>
<p><span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{81.95}{65.2} = 1.2571429</span></p>
<p><strong>Intercept:</strong></p>
<p><span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p>Step by step:</p>
<ol type="1">
<li><span class="math display">1.2571429 \times 50.2 = 63.1085714</span></li>
<li><span class="math display">\hat{\beta_0} = 62.2 - 63.1085714 = -0.9085714</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)  <span class="co"># Exact coefficients from R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
 -0.8964724   1.2569018 </code></pre>
</div>
</div>
</section>
<section id="detailed-decomposition-of-variance-and-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="detailed-decomposition-of-variance-and-r-squared">Detailed Decomposition of Variance and R-squared</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span></p>
<p>The predicted values <span class="math inline">\hat{Y}</span> for each <span class="math inline">X</span> value:</p>
<p>For <span class="math inline">X = 50</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (50)
</span> <span class="math display">\hat{Y} = -0.9085714 + 62.857145</span> <span class="math display">\hat{Y} = 61.9485736</span></p>
<p>For <span class="math inline">X = 45</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (45)
</span> <span class="math display">\hat{Y} = -0.9085714 + 56.5714305</span> <span class="math display">\hat{Y} = 55.6535591</span></p>
<p>For <span class="math inline">X = 56</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (56)
</span> <span class="math display">\hat{Y} = -0.9085714 + 70.4200024</span> <span class="math display">\hat{Y} = 69.5114310</span></p>
<p>For <span class="math inline">X = 40</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (40)
</span> <span class="math display">\hat{Y} = -0.9085714 + 50.2657160</span> <span class="math display">\hat{Y} = 49.3571446</span></p>
<p>For <span class="math inline">X = 60</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (60)
</span> <span class="math display">\hat{Y} = -0.9085714 + 75.4285740</span> <span class="math display">\hat{Y} = 74.5200026</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification of predicted values</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9085714</span> <span class="sc">+</span> <span class="fl">1.2571429</span> <span class="sc">*</span> income</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> income,</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> turnout,</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_hat =</span> y_hat,</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y    Y_hat
1 50 60 61.94857
2 45 56 55.66286
3 56 70 69.49143
4 40 50 49.37714
5 60 75 74.52000</code></pre>
</div>
</div>
<p><strong>Step 2: Calculate SST (Total Sum of Squares)</strong></p>
<p><span class="math display">SST = \sum(Y_i - \bar{Y})^2 \text{ where } \bar{Y} = 62.2</span></p>
<p><span class="math display">(60 - 62.2)^2 = (-2.2)^2 = 4.84</span> <span class="math display">(56 - 62.2)^2 = (-6.2)^2 = 38.44</span> <span class="math display">(70 - 62.2)^2 = (7.8)^2 = 60.84</span> <span class="math display">(50 - 62.2)^2 = (-12.2)^2 = 148.84</span> <span class="math display">(75 - 62.2)^2 = (12.8)^2 = 163.84</span></p>
<p><span class="math display">SST = 4.84 + 38.44 + 60.84 + 148.84 + 163.84 = 416.8</span></p>
<p><strong>Step 3: Calculate SSR (Regression Sum of Squares)</strong></p>
<p><span class="math display">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<p><span class="math display">(61.9485736 - 62.2)^2 = (-0.2514264)^2 = 0.0632151</span> <span class="math display">(55.6535591 - 62.2)^2 = (-6.5464409)^2 = 42.8558689</span> <span class="math display">(69.5114310 - 62.2)^2 = (7.3114310)^2 = 53.4570178</span> <span class="math display">(49.3571446 - 62.2)^2 = (-12.8428554)^2 = 164.9389370</span> <span class="math display">(74.5200026 - 62.2)^2 = (12.3200026)^2 = 151.7824640</span></p>
<p><span class="math display">SSR = 413.0975028</span></p>
<p><strong>Step 4: Calculate SSE (Error Sum of Squares)</strong></p>
<p><span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<p><span class="math display">(60 - 61.9485736)^2 = (-1.9485736)^2 = 3.7969384</span> <span class="math display">(56 - 55.6535591)^2 = (0.3464409)^2 = 0.1200212</span> <span class="math display">(70 - 69.5114310)^2 = (0.4885690)^2 = 0.2387198</span> <span class="math display">(50 - 49.3571446)^2 = (0.6428554)^2 = 0.4132631</span> <span class="math display">(75 - 74.5200026)^2 = (0.4799974)^2 = 0.2303975</span></p>
<p><span class="math display">SSE = 4.7024972</span></p>
<p><strong>Step 5: Verify decomposition</strong></p>
<p><span class="math display">SST = SSR + SSE</span> <span class="math display">416.8 = 413.0975028 + 4.7024972</span></p>
<p><strong>Step 6: Calculate R-squared</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{413.0975028}{416.8} = 0.9916</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared  <span class="co"># Should match our calculation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9885135</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization">Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> income, <span class="at">turnout =</span> turnout)</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> turnout)) <span class="sc">+</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Voter Turnout vs Income per Capita"</span>,</span>
<span id="cb258-9"><a href="#cb258-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Income per Capita (thousands €)"</span>,</span>
<span id="cb258-10"><a href="#cb258-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Voter Turnout (%)"</span></span>
<span id="cb258-11"><a href="#cb258-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb258-12"><a href="#cb258-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb258-13"><a href="#cb258-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb258-14"><a href="#cb258-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb258-15"><a href="#cb258-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb258-16"><a href="#cb258-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<p>The analysis shows:</p>
<ol type="1">
<li><p>A very strong positive correlation (<span class="math inline">r = 0.994</span>) between income and voter turnout</p></li>
<li><p>The regression equation <span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span> indicates that:</p>
<ul>
<li>For each €1,000 increase in income, turnout increases by about 1.26 percentage points</li>
<li>The intercept (<span class="math inline">-0.9086</span>) has little practical meaning as income is never zero</li>
</ul></li>
<li><p>The R-squared of 0.9916 indicates that 99.16% of the variance in turnout is explained by income</p></li>
</ol>
</section>
</section>
<section id="przykład-4.-anxiety-levels-and-cognitive-performance-a-laboratory-study-en" class="level2" data-number="14.20">
<h2 data-number="14.20" class="anchored" data-anchor-id="przykład-4.-anxiety-levels-and-cognitive-performance-a-laboratory-study-en"><span class="header-section-number">14.20</span> Przykład 4. Anxiety Levels and Cognitive Performance: A Laboratory Study [EN]</h2>
<section id="data-and-context" class="level3">
<h3 class="anchored" data-anchor-id="data-and-context">Data and Context</h3>
<p>In a psychology experiment, researchers measured the relationship between anxiety levels (measured by galvanic skin response, GSR) and cognitive performance (score on a working memory task).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.4</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>, <span class="fl">6.4</span>, <span class="fl">7.2</span>, <span class="fl">8.0</span>)  <span class="co"># GSR readings</span></span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">62</span>)      <span class="co"># Working memory scores</span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8993 -0.6660  0.2162  0.6106  1.5262 

Coefficients:
            Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept) 105.3248     1.3189   79.86 0.00000000026 ***
anxiety      -5.4407     0.2359  -23.06 0.00000043549 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.236 on 6 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.987 
F-statistic: 531.9 on 1 and 6 DF,  p-value: 0.0000004355</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{2.1 + 3.4 + 4.2 + 5.1 + 5.8 + 6.4 + 7.2 + 8.0}{8} = \frac{42.2}{8} = 5.275</span></p>
<p><span class="math display">\bar{Y} = \frac{92 + 88 + 84 + 78 + 74 + 70 + 65 + 62}{8} = \frac{613}{8} = 76.625</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.625</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li><span class="math inline">(2.1 - 5.275) = -3.175</span></li>
<li><span class="math inline">(3.4 - 5.275) = -1.875</span></li>
<li><span class="math inline">(4.2 - 5.275) = -1.075</span></li>
<li><span class="math inline">(5.1 - 5.275) = -0.175</span></li>
<li><span class="math inline">(5.8 - 5.275) = 0.525</span></li>
<li><span class="math inline">(6.4 - 5.275) = 1.125</span></li>
<li><span class="math inline">(7.2 - 5.275) = 1.925</span></li>
<li><span class="math inline">(8.0 - 5.275) = 2.725</span></li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">10.08063 + 3.51563 + 1.15563 + 0.03063 + 0.27563 + 1.26563 + 3.70563 +
7.42563 = 27.45500</span></p>
<p><span class="math display">s^2_X = \frac{27.45500}{7} = 3.922143</span></p>
<p>Similarly for Y: Deviations:</p>
<p><span class="math display">15.375, 11.375, 7.375, 1.375, -2.625, -6.625, -11.625, -14.625</span></p>
<p><span class="math display">s^2_Y = \frac{236.875 + 129.391 + 54.391 + 1.891 + 6.891 + 43.891 + 135.141 + 213.891}{7} = \frac{822.362}{7} = 117.4803</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.922143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.4107</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-1" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-correlation-1">Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-3.175 × 15.375) = -48.815625</span></p>
<p><span class="math display">(-1.875 × 11.375) = -21.328125</span></p>
<p><span class="math display">(-1.075 × 7.375) = -7.928125</span></p>
<p><span class="math display">(-0.175 × 1.375) = -0.240625</span></p>
<p><span class="math display">(0.525 × -2.625) = -1.378125</span></p>
<p><span class="math display">(1.125 × -6.625) = -7.453125</span></p>
<p><span class="math display">(1.925 × -11.625) = -22.378125</span></p>
<p><span class="math display">(2.725 × -14.625) = -39.853125</span></p>
<p>Sum <span class="math inline">= -149.375</span></p>
<p><span class="math display">s_{XY} = \frac{-149.375}{7} = -21.33929</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -21.33929</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-21.33929}{\sqrt{3.922143}\sqrt{117.4803}} = -0.9932</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9944073</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-1">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-21.33929}{3.922143} = -5.4407</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-5.4407 × 5.275 = -28.6997</span></li>
<li><span class="math inline">\hat{\beta_0} = 76.625 - (-28.6997) = 105.3247</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
 105.324804   -5.440721 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-calculation">4. R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>: <span class="math display">\hat{Y} = 105.3247 - 5.4407X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">105.3247</span> <span class="sc">-</span> <span class="fl">5.4407</span> <span class="sc">*</span> anxiety</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance,</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Anxiety Performance Predicted
1     2.1          92  93.89923
2     3.4          88  86.82632
3     4.2          84  82.47376
4     5.1          78  77.57713
5     5.8          74  73.76864
6     6.4          70  70.50422
7     7.2          65  66.15166
8     8.0          62  61.79910</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong></p>
<p><span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 822.362</span></p>
<p><span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 816.3094</span></p>
<p><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 6.0526</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{816.3094}{822.362} = 0.9926</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9888459</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1">Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cognitive Performance vs. Anxiety Levels"</span>,</span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Anxiety (GSR)"</span>,</span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Performance Score"</span></span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb279-11"><a href="#cb279-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.993) between anxiety and cognitive performance</li>
<li>For each unit increase in GSR (anxiety), performance decreases by approximately 5.44 points</li>
<li>The model explains 99.26% of the variance in performance scores</li>
<li>The relationship appears to be strongly linear, suggesting a reliable anxiety-performance relationship</li>
<li>The high intercept (105.32) represents the theoretical maximum performance at zero anxiety</li>
</ol>
</section>
<section id="study-limitations" class="level3">
<h3 class="anchored" data-anchor-id="study-limitations">Study Limitations</h3>
<ol type="1">
<li>Small sample size (n=8)</li>
<li>Possible other confounding variables</li>
<li>Limited range of anxiety levels</li>
<li>Cross-sectional rather than longitudinal data</li>
</ol>
</section>
</section>
<section id="przykład-5.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="level2" data-number="14.21">
<h2 data-number="14.21" class="anchored" data-anchor-id="przykład-5.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">14.21</span> Przykład 5. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</h2>
<p>Ta analiza bada związek między wielkością okręgu (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Wskaźnik Loosemore-Hanby mierzy dysproporcjonalność wyborczą, przy czym wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane-2" class="level3">
<h3 class="anchored" data-anchor-id="dane-2">Dane</h3>
<div class="cell" data-tbl-cap="Wielkość okręgu i wskaźnik LH według kraju">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość okręgu i wskaźnik LH według kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Kraj</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm-1" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm-1">Obliczenia dla wielkości okręgu (DM)</h4>
<p>Najpierw obliczę średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{4 + 10 + 3 + 8 + 7 + 4}{6} = \frac{36}{6} = 6</span></p>
<p>Następnie obliczę wariancję z korektą Bessela, korzystając z wzoru:</p>
<p><span class="math display">s^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td><span class="math inline">10 - 6 = 4</span></td>
<td><span class="math inline">(4)^2 = 16</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td><span class="math inline">3 - 6 = -3</span></td>
<td><span class="math inline">(-3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td><span class="math inline">8 - 6 = 2</span></td>
<td><span class="math inline">(2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 6 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>38</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{DM} = \frac{38}{6-1} = \frac{38}{5} = 7.6</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">s_{DM} = \sqrt{s^2_{DM}} = \sqrt{7.6} = 2.757</span></p>
</section>
<section id="obliczenia-dla-wskaźnika-lh" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-wskaźnika-lh">Obliczenia dla wskaźnika LH</h4>
<p>Najpierw obliczę średnią wartości LH:</p>
<p><span class="math display">\bar{y}_{LH} = \frac{12 + 8 + 15 + 10 + 6 + 13}{6} = \frac{64}{6} = 10.667</span></p>
<p>Następnie obliczę wariancję z korektą Bessela:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 17%">
<col style="width: 34%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td><span class="math inline">12 - 10.667 = 1.333</span></td>
<td><span class="math inline">(1.333)^2 = 1.777</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td><span class="math inline">8 - 10.667 = -2.667</span></td>
<td><span class="math inline">(-2.667)^2 = 7.113</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td><span class="math inline">15 - 10.667 = 4.333</span></td>
<td><span class="math inline">(4.333)^2 = 18.775</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td><span class="math inline">10 - 10.667 = -0.667</span></td>
<td><span class="math inline">(-0.667)^2 = 0.445</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td><span class="math inline">6 - 10.667 = -4.667</span></td>
<td><span class="math inline">(-4.667)^2 = 21.781</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td><span class="math inline">13 - 10.667 = 2.333</span></td>
<td><span class="math inline">(2.333)^2 = 5.443</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{LH} = \frac{55.334}{6-1} = \frac{55.334}{5} = 11.067</span></p>
<p>Odchylenie standardowe to:</p>
<p><span class="math display">s_{LH} = \sqrt{s^2_{LH}} = \sqrt{11.067} = 3.327</span></p>
<p><strong>Podsumowanie kroku 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 7.6</li>
<li>Odchylenie standardowe DM: 2.757</li>
<li>Wariancja LH (z korektą Bessela): 11.067</li>
<li>Odchylenie standardowe LH: 3.327</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu wzoru z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td>-2</td>
<td>1.333</td>
<td><span class="math inline">(-2)(1.333) = -2.666</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td>4</td>
<td>-2.667</td>
<td><span class="math inline">(4)(-2.667) = -10.668</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td>-3</td>
<td>4.333</td>
<td><span class="math inline">(-3)(4.333) = -12.999</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td>2</td>
<td>-0.667</td>
<td><span class="math inline">(2)(-0.667) = -1.334</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td>1</td>
<td>-4.667</td>
<td><span class="math inline">(1)(-4.667) = -4.667</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td>-2</td>
<td>2.333</td>
<td><span class="math inline">(-2)(2.333) = -4.666</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-37</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-37}{6-1} = \frac{-37}{5} = -7.4</span></p>
<p><strong>Kowariancja między DM a LH: -7.4</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: wraz ze wzrostem wielkości okręgu wskaźnik dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</h3>
<p>Współczynnik korelacji Pearsona oblicza się przy użyciu wzoru:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{s_{DM} \cdot s_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -7.4</span></li>
<li><span class="math inline">s_{DM} = 2.757</span></li>
<li><span class="math inline">s_{LH} = 3.327</span></li>
</ul>
<p><span class="math display">r = \frac{-7.4}{2.757 \cdot 3.327} = \frac{-7.4}{9.172} = -0.807</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.807</strong></p>
<section id="interpretacja-2" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja-2">Interpretacja:</h4>
<p>Współczynnik korelacji -0.807 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Ujemny znak pokazuje odwrotną zależność między wielkością okręgu a wskaźnikiem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.807 wskazuje na silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości wskaźnika LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że wraz ze wzrostem wielkości okręgu, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami wyborczymi (więcej przedstawicieli wybieranych w okręgu) mają tendencję do generowania bardziej proporcjonalnych wyników (mniejsza dysproporcjonalność).</p></li>
</ol>
<p>Ustalenie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi wyborcze zapewniają mniejszym partiom więcej możliwości uzyskania reprezentacji, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</h3>
<p>Użyję wzoru na prostą regresję liniową:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Wzór na obliczenie <span class="math inline">\beta_1</span> z korektą Bessela to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{s^2_{DM}} = \frac{-7.4}{7.6} = -0.974</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, użyję:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 10.667 - (-0.974) \cdot 6 = 10.667 + 5.844 = 16.511</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.511 - 0.974 \cdot DM</span></p>
<section id="obliczanie-r-kwadrat-1" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-r-kwadrat-1">Obliczanie R-kwadrat</h4>
<p>Aby właściwie obliczyć R-kwadrat, muszę obliczyć następujące sumy kwadratów:</p>
<ul>
<li>SST (Całkowita suma kwadratów): Mierzy całkowitą zmienność zmiennej zależnej (LH)</li>
<li>SSR (Suma kwadratów regresji): Mierzy zmienność wyjaśnioną przez model regresji</li>
<li>SSE (Suma kwadratów błędów): Mierzy niewyjaśnioną zmienność modelu</li>
</ul>
<p>Najpierw obliczę przewidywane wartości LH, używając naszego równania regresji:</p>
<p><span class="math display">\hat{LH} = 16.511 - 0.974 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.511 - 0.974x_i</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td><span class="math inline">16.511 - 0.974(10) = 16.511 - 9.74 = 6.771</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td><span class="math inline">16.511 - 0.974(3) = 16.511 - 2.922 = 13.589</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td><span class="math inline">16.511 - 0.974(8) = 16.511 - 7.792 = 8.719</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td><span class="math inline">16.511 - 0.974(7) = 16.511 - 6.818 = 9.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
</tbody>
</table>
<p>Teraz, obliczę każdą sumę kwadratów:</p>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Już obliczyliśmy te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>1.333</td>
<td>1.777</td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>-2.667</td>
<td>7.113</td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>4.333</td>
<td>18.775</td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>-0.667</td>
<td>0.445</td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>-4.667</td>
<td>21.781</td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>2.333</td>
<td>5.443</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SST = 55.334</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math display">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 25%">
<col style="width: 24%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>6.771</td>
<td><span class="math inline">6.771 - 10.667 = -3.896</span></td>
<td><span class="math inline">(-3.896)^2 = 15.178</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.589</td>
<td><span class="math inline">13.589 - 10.667 = 2.922</span></td>
<td><span class="math inline">(2.922)^2 = 8.538</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8.719</td>
<td><span class="math inline">8.719 - 10.667 = -1.948</span></td>
<td><span class="math inline">(-1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>9.693</td>
<td><span class="math inline">9.693 - 10.667 = -0.974</span></td>
<td><span class="math inline">(-0.974)^2 = 0.949</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>36.05</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSR = 36.05</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math display">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">y_i - \hat{y}_i</span></th>
<th><span class="math inline">(y_i - \hat{y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">12 - 12.615 = -0.615</span></td>
<td><span class="math inline">(-0.615)^2 = 0.378</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">8 - 6.771 = 1.229</span></td>
<td><span class="math inline">(1.229)^2 = 1.510</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">15 - 13.589 = 1.411</span></td>
<td><span class="math inline">(1.411)^2 = 1.991</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">10 - 8.719 = 1.281</span></td>
<td><span class="math inline">(1.281)^2 = 1.641</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">6 - 9.693 = -3.693</span></td>
<td><span class="math inline">(-3.693)^2 = 13.638</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">13 - 12.615 = 0.385</span></td>
<td><span class="math inline">(0.385)^2 = 0.148</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>19.306</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSE = 19.306</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia, sprawdzając czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math display">55.334 \approx 36.05 + 19.306 = 55.356</span></p>
<p>Niewielka różnica (0.022) wynika z zaokrągleń w obliczeniach.</p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{36.05}{55.334} = 0.652</span></p>
<p>Alternatywnie, możemy też obliczyć:</p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{19.306}{55.334} = 1 - 0.349 = 0.651</span></p>
<p>Drobna różnica wynika z zaokrągleń.</p>
</section>
<section id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego">Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</h4>
<p>Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</p>
<p>RMSE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Korzystając z naszej obliczonej SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{19.306}{6}} = \sqrt{3.218} = 1.794</span></p>
<p>Korekta Bessela (dzielenie przez n-1 zamiast n) stosuje się do estymacji wariancji próby, ale nie jest standardowo stosowana przy obliczaniu RMSE, gdyż RMSE jest miarą błędu predykcji, a nie estymatorem parametru populacji.</p>
</section>
<section id="obliczanie-mae-średni-błąd-bezwzględny" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-mae-średni-błąd-bezwzględny">Obliczanie MAE (Średni błąd bezwzględny)</h4>
<p>MAE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">MAE = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">|y_i - \hat{y}_i|</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">|12 - 12.615| = 0.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">|8 - 6.771| = 1.229</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">|15 - 13.589| = 1.411</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">|10 - 8.719| = 1.281</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">|6 - 9.693| = 3.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">|13 - 12.615| = 0.385</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>8.614</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">MAE = \frac{8.614}{6} = 1.436</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.511 - 0.974 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.651</p>
<p><strong>RMSE</strong>: 1.794</p>
<p><strong>MAE</strong>: 1.436</p>
</section>
<section id="interpretacja-3" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja-3">Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego jednostkowego wzrostu wielkości okręgu, wskaźnik dysproporcjonalności LH zmniejsza się o 0.974 jednostki. Wyraz wolny (16.511) reprezentuje oczekiwany wskaźnik LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.651 wskazuje, że około 65.1% wariancji dysproporcjonalności wyborczej (wskaźnik LH) może być wyjaśnione przez wielkość okręgu. Jest to dość wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej, choć mniejszym niż w poprzednim zestawie danych.</p></li>
<li><p><strong>RMSE</strong>: Wartość 1.794 informuje nas o przeciętnym błędzie prognozy modelu. Jest to miara dokładności przewidywań modelu wyrażona w jednostkach zmiennej zależnej (LH).</p></li>
<li><p><strong>MAE</strong>: Wartość 1.436 informuje nas o przeciętnym bezwzględnym błędzie prognozy modelu. W porównaniu z RMSE, MAE jest mniej czuły na wartości odstające, co potwierdza, że niektóre obserwacje (np. dla kraju E) mają stosunkowo duży błąd predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Wyniki sugerują, że zwiększenie wielkości okręgu mogłoby być skuteczną strategią reform wyborczych dla krajów starających się zmniejszyć dysproporcjonalność między głosami a mandatami. Jednakże, korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać we wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="przykład-6.-analiza-korelacji-i-regresji-podejście-z-obliczeniami-manualnymi" class="level2" data-number="14.22">
<h2 data-number="14.22" class="anchored" data-anchor-id="przykład-6.-analiza-korelacji-i-regresji-podejście-z-obliczeniami-manualnymi"><span class="header-section-number">14.22</span> Przykład 6. Analiza Korelacji i Regresji: Podejście z Obliczeniami Manualnymi</h2>
<p>W tym tutorialu zbadamy związek między poziomem lęku przed egzaminem a wynikami egzaminacyjnymi wśród studentów uniwersytetu. Badania sugerują, że podczas gdy niewielka ilość lęku może być motywująca, nadmierny lęk zazwyczaj pogarsza wyniki poprzez zmniejszoną koncentrację, zakłócenia pamięci roboczej i objawy fizyczne. Przeanalizujemy dane od 8 studentów, aby zrozumieć ten związek matematycznie.</p>
<section id="prezentacja-danych" class="level3">
<h3 class="anchored" data-anchor-id="prezentacja-danych">Prezentacja Danych</h3>
<section id="zbiór-danych" class="level4">
<h4 class="anchored" data-anchor-id="zbiór-danych">Zbiór Danych</h4>
<p>Zebraliśmy dane od 8 studentów, mierząc:</p>
<ul>
<li><strong>X</strong>: Wynik lęku przed testem (skala 1-10, gdzie 1 = bardzo niski, 10 = bardzo wysoki)</li>
<li><strong>Y</strong>: Wyniki egzaminu (wynik procentowy)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nasze dane</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>lęk <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.2</span>, <span class="fl">4.1</span>, <span class="fl">4.8</span>, <span class="fl">5.6</span>, <span class="fl">6.3</span>, <span class="fl">7.0</span>, <span class="fl">7.9</span>)      <span class="co"># Wyniki lęku</span></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>wyniki <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">77</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>)            <span class="co"># Wyniki egzaminu (%)</span></span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie ramki danych dla łatwego przeglądu</span></span>
<span id="cb280-6"><a href="#cb280-6" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb280-7"><a href="#cb280-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb280-8"><a href="#cb280-8" aria-hidden="true" tabindex="-1"></a>  Lęk <span class="ot">=</span> lęk,</span>
<span id="cb280-9"><a href="#cb280-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wyniki =</span> wyniki</span>
<span id="cb280-10"><a href="#cb280-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb280-11"><a href="#cb280-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Lęk Wyniki
1       1 2.5     80
2       2 3.2     85
3       3 4.1     78
4       4 4.8     82
5       5 5.6     77
6       6 6.3     74
7       7 7.0     68
8       8 7.9     72</code></pre>
</div>
</div>
</section>
<section id="wstępna-wizualizacja" class="level4">
<h4 class="anchored" data-anchor-id="wstępna-wizualizacja">Wstępna Wizualizacja</h4>
<p>Najpierw zwizualizujmy nasze dane, aby uzyskać intuicyjne zrozumienie związku:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie wykresu punktowego</span></span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> Lęk, <span class="at">y =</span> Wyniki)) <span class="sc">+</span></span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Lęk przed Testem vs. Wyniki Egzaminu"</span>,</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wynik Lęku przed Testem"</span>,</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Wyniki Egzaminu (%)"</span></span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="statystyki-opisowe" class="level3">
<h3 class="anchored" data-anchor-id="statystyki-opisowe">Statystyki Opisowe</h3>
<section id="obliczanie-średnich" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-średnich">Obliczanie Średnich</h4>
<p>Średnia to wartość przeciętna, obliczana przez zsumowanie wszystkich obserwacji i podzielenie przez liczbę obserwacji.</p>
<p><strong>Średnia Wyników Lęku (X):</strong> <span class="math display">\bar{X} = \frac{\sum_{i=1}^{n} X_i}{n} = \frac{2,5 + 3,2 + 4,1 + 4,8 + 5,6 + 6,3 + 7,0 + 7,9}{8}</span></p>
<p><span class="math display">\bar{X} = \frac{41,4}{8} = 5,175</span></p>
<p><strong>Średnia Wyników Egzaminu (Y):</strong> <span class="math display">\bar{Y} = \frac{\sum_{i=1}^{n} Y_i}{n} = \frac{80 + 85 + 78 + 82 + 77 + 74 + 68 + 72}{8}</span></p>
<p><span class="math display">\bar{Y} = \frac{616}{8} = 77</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja naszych obliczeń</span></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>średnia_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(lęk)</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>średnia_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(wyniki)</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średni Lęk:"</span>, średnia_x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średni Lęk: 5.175 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnie Wyniki:"</span>, średnia_y, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnie Wyniki: 77 </code></pre>
</div>
</div>
</section>
<section id="obliczanie-wariancji-i-odchylenia-standardowego" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-wariancji-i-odchylenia-standardowego">Obliczanie Wariancji i Odchylenia Standardowego</h4>
<p>Wariancja mierzy, jak bardzo rozproszone są dane od średniej. Używamy wzoru na wariancję próbkową (dzieląc przez n-1).</p>
<p><strong>Wariancja X:</strong></p>
<p>Najpierw obliczamy odchylenia od średniej <span class="math inline">(X_i - \bar{X})</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2,5</td>
<td><span class="math inline">2,5 - 5,175 = -2,675</span></td>
<td><span class="math inline">(-2,675)^2 = 7,1556</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>3,2</td>
<td><span class="math inline">3,2 - 5,175 = -1,975</span></td>
<td><span class="math inline">(-1,975)^2 = 3,9006</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>4,1</td>
<td><span class="math inline">4,1 - 5,175 = -1,075</span></td>
<td><span class="math inline">(-1,075)^2 = 1,1556</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4,8</td>
<td><span class="math inline">4,8 - 5,175 = -0,375</span></td>
<td><span class="math inline">(-0,375)^2 = 0,1406</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5,6</td>
<td><span class="math inline">5,6 - 5,175 = 0,425</span></td>
<td><span class="math inline">(0,425)^2 = 0,1806</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6,3</td>
<td><span class="math inline">6,3 - 5,175 = 1,125</span></td>
<td><span class="math inline">(1,125)^2 = 1,2656</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>7,0</td>
<td><span class="math inline">7,0 - 5,175 = 1,825</span></td>
<td><span class="math inline">(1,825)^2 = 3,3306</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>7,9</td>
<td><span class="math inline">7,9 - 5,175 = 2,725</span></td>
<td><span class="math inline">(2,725)^2 = 7,4256</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>24,555</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1} = \frac{24,555}{7} = 3,5079</span></p>
<p><span class="math display">s_X = \sqrt{3,5079} = 1,8730</span></p>
<p><strong>Wariancja Y:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>80</td>
<td><span class="math inline">80 - 77 = 3</span></td>
<td><span class="math inline">(3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>85</td>
<td><span class="math inline">85 - 77 = 8</span></td>
<td><span class="math inline">(8)^2 = 64</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>78</td>
<td><span class="math inline">78 - 77 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>82</td>
<td><span class="math inline">82 - 77 = 5</span></td>
<td><span class="math inline">(5)^2 = 25</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>77</td>
<td><span class="math inline">77 - 77 = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>74</td>
<td><span class="math inline">74 - 77 = -3</span></td>
<td><span class="math inline">(-3)^2 = 9</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>68</td>
<td><span class="math inline">68 - 77 = -9</span></td>
<td><span class="math inline">(-9)^2 = 81</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>72</td>
<td><span class="math inline">72 - 77 = -5</span></td>
<td><span class="math inline">(-5)^2 = 25</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>214</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_Y = \frac{\sum(Y_i - \bar{Y})^2}{n-1} = \frac{214}{7} = 30,5714</span></p>
<p><span class="math display">s_Y = \sqrt{30,5714} = 5,5291</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja wariancji i odchylenia standardowego</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja Lęku:"</span>, <span class="fu">var</span>(lęk), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja Lęku: 3.507857 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odch. Stand. Lęku:"</span>, <span class="fu">sd</span>(lęk), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odch. Stand. Lęku: 1.872927 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja Wyników:"</span>, <span class="fu">var</span>(wyniki), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja Wyników: 30.57143 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odch. Stand. Wyników:"</span>, <span class="fu">sd</span>(wyniki), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odch. Stand. Wyników: 5.529144 </code></pre>
</div>
</div>
</section>
</section>
<section id="kowariancja-i-korelacja" class="level3">
<h3 class="anchored" data-anchor-id="kowariancja-i-korelacja">Kowariancja i Korelacja</h3>
<section id="obliczanie-kowariancji" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-kowariancji">Obliczanie Kowariancji</h4>
<p>Kowariancja mierzy, jak dwie zmienne zmieniają się razem. Ujemna kowariancja wskazuje, że gdy jedna zmienna wzrasta, druga ma tendencję do spadku.</p>
<p><span class="math display">s_{XY} = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Obliczmy iloczyny dla każdej obserwacji:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-2,675</td>
<td>3</td>
<td><span class="math inline">(-2,675) \times (3) = -8,025</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>-1,975</td>
<td>8</td>
<td><span class="math inline">(-1,975) \times (8) = -15,800</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>-1,075</td>
<td>1</td>
<td><span class="math inline">(-1,075) \times (1) = -1,075</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>-0,375</td>
<td>5</td>
<td><span class="math inline">(-0,375) \times (5) = -1,875</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>0,425</td>
<td>0</td>
<td><span class="math inline">(0,425) \times (0) = 0</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>1,125</td>
<td>-3</td>
<td><span class="math inline">(1,125) \times (-3) = -3,375</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>1,825</td>
<td>-9</td>
<td><span class="math inline">(1,825) \times (-9) = -16,425</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>2,725</td>
<td>-5</td>
<td><span class="math inline">(2,725) \times (-5) = -13,625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>-60,2</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s_{XY} = \frac{-60,2}{7} = -8,6</span></p>
</section>
<section id="obliczanie-współczynnika-korelacji-pearsona" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-współczynnika-korelacji-pearsona">Obliczanie Współczynnika Korelacji Pearsona</h4>
<p>Współczynnik korelacji standaryzuje kowariancję do skali od -1 do +1:</p>
<p><span class="math display">r = \frac{s_{XY}}{s_X \cdot s_Y} = \frac{-8,6}{1,8730 \times 5,5291} = \frac{-8,6}{10,3560} = -0,831</span></p>
<p>To daje nam korelację <strong>-0,831</strong>, wskazującą na silny ujemny związek między lękiem a wynikami.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja korelacji</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>rzeczywista_kor <span class="ot">&lt;-</span> <span class="fu">cor</span>(lęk, wyniki)</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Współczynnik korelacji Pearsona:"</span>, rzeczywista_kor, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Współczynnik korelacji Pearsona: -0.8304618 </code></pre>
</div>
</div>
</section>
</section>
<section id="prosta-regresja-mnk" class="level3">
<h3 class="anchored" data-anchor-id="prosta-regresja-mnk">Prosta Regresja MNK</h3>
<section id="problem-modelowania-związków" class="level4">
<h4 class="anchored" data-anchor-id="problem-modelowania-związków">Problem Modelowania Związków</h4>
<p>Kiedy obserwujemy związek między dwiema zmiennymi, chcemy znaleźć model matematyczny, który:</p>
<ol type="1">
<li>Opisuje związek</li>
<li>Pozwala nam dokonywać prognoz</li>
<li>Kwantyfikuje siłę związku</li>
</ol>
<p>Najprostszym modelem jest linia prosta: <span class="math display">Y = \beta_0 + \beta_1 X + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y</span> to zmienna wynikowa (wyniki)</li>
<li><span class="math inline">X</span> to zmienna predykcyjna (lęk)</li>
<li><span class="math inline">\beta_0</span> to punkt przecięcia (wyniki gdy lęk = 0)</li>
<li><span class="math inline">\beta_1</span> to nachylenie (zmiana wyników na jednostkę zmiany lęku)</li>
<li><span class="math inline">\epsilon</span> to składnik błędu (niewyjaśniona zmienność)</li>
</ul>
</section>
<section id="idea-sumy-kwadratów-błędów-sse" class="level4">
<h4 class="anchored" data-anchor-id="idea-sumy-kwadratów-błędów-sse">Idea Sumy Kwadratów Błędów (SSE)</h4>
<p>Wyobraź sobie próbę narysowania linii przez nasze punkty danych. Jest nieskończenie wiele linii, które moglibyśmy narysować! Niektóre przeszłyby przez środek punktów, inne mogłyby być za wysokie lub za niskie, za strome lub za płaskie. Potrzebujemy systematycznego sposobu określenia, która linia jest “najlepsza”.</p>
<section id="czym-są-błędy-reszty" class="level5">
<h5 class="anchored" data-anchor-id="czym-są-błędy-reszty">Czym są Błędy (Reszty)?</h5>
<p>Dla każdej linii, którą narysujemy, każdy punkt danych będzie miał <strong>błąd</strong> lub <strong>resztę</strong> - pionową odległość od punktu do linii. To reprezentuje, jak “błędna” jest nasza prognoza dla tego punktu.</p>
<ul>
<li><strong>Błąd dodatni</strong>: Rzeczywista wartość jest powyżej przewidywanej wartości (niedoszacowaliśmy)</li>
<li><strong>Błąd ujemny</strong>: Rzeczywista wartość jest poniżej przewidywanej wartości (przeszacowaliśmy)</li>
</ul>
</section>
<section id="dlaczego-podnosimy-błędy-do-kwadratu" class="level5">
<h5 class="anchored" data-anchor-id="dlaczego-podnosimy-błędy-do-kwadratu">Dlaczego Podnosimy Błędy do Kwadratu?</h5>
<p>Proste dodawanie błędów nie zadziała, ponieważ błędy dodatnie i ujemne się znoszą. Moglibyśmy użyć wartości bezwzględnych, ale podnoszenie do kwadratu ma kilka zalet:</p>
<ol type="1">
<li><strong>Wygoda matematyczna</strong>: Funkcje kwadratowe są różniczkowalne, co ułatwia znalezienie minimum za pomocą rachunku różniczkowego</li>
<li><strong>Penalizuje większe błędy bardziej</strong>: Kilka dużych błędów jest gorsze niż wiele małych błędów</li>
<li><strong>Tworzy gładką, miskowatą funkcję</strong>: To gwarantuje unikalne minimum</li>
</ol>
</section>
<section id="wzór-sse" class="level5">
<h5 class="anchored" data-anchor-id="wzór-sse">Wzór SSE</h5>
<p>Suma Kwadratów Błędów to: <span class="math display">SSE = \sum_{i=1}^{n}(Y_i - \hat{Y_i})^2 = \sum_{i=1}^{n}(Y_i - (\beta_0 + \beta_1 X_i))^2</span></p>
</section>
<section id="znajdowanie-najlepszej-linii" class="level5">
<h5 class="anchored" data-anchor-id="znajdowanie-najlepszej-linii">Znajdowanie Najlepszej Linii</h5>
<p>“Najlepsza” linia to ta, która minimalizuje SSE. Używając rachunku różniczkowego (biorąc pochodne względem <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> i przyrównując je do zera), otrzymujemy wzory MNK.</p>
</section>
</section>
<section id="estymatory-mnk" class="level4">
<h4 class="anchored" data-anchor-id="estymatory-mnk">Estymatory MNK</h4>
<p>Metoda Najmniejszych Kwadratów (MNK) znajduje wartości <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>, które minimalizują SSE:</p>
<p><strong>Estymator nachylenia:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><strong>Estymator punktu przecięcia:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
</section>
<section id="obliczanie-parametrów-mnk" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-parametrów-mnk">Obliczanie Parametrów MNK</h4>
<p>Używając naszych obliczonych wartości:</p>
<ul>
<li><span class="math inline">s_{XY} = -8,6</span></li>
<li><span class="math inline">s^2_X = 3,5079</span></li>
<li><span class="math inline">\bar{X} = 5,175</span></li>
<li><span class="math inline">\bar{Y} = 77</span></li>
</ul>
<p><strong>Krok 1: Oblicz nachylenie</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-8,6}{3,5079} = -2,451</span></p>
<p><strong>Krok 2: Oblicz punkt przecięcia</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X} = 77 - (-2,451 \times 5,175) = 77 + 12,684 = 89,684</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja z R</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(wyniki <span class="sc">~</span> lęk)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         lęk 
  89.687233   -2.451639 </code></pre>
</div>
</div>
<p><strong>Nasze równanie regresji to:</strong> <span class="math display">\hat{Y} = 89,684 - 2,451X</span></p>
<p>To oznacza:</p>
<ul>
<li>Gdy lęk = 0, przewidywane wyniki = 89,68%</li>
<li>Za każdy wzrost lęku o 1 punkt, wyniki spadają o 2,45%</li>
</ul>
</section>
</section>
<section id="wykres-modelu" class="level3">
<h3 class="anchored" data-anchor-id="wykres-modelu">Wykres Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie kompleksowego wykresu</span></span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(lęk, wyniki), <span class="fu">aes</span>(<span class="at">x =</span> lęk, <span class="at">y =</span> wyniki)) <span class="sc">+</span></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(lęk, <span class="dv">1</span>), <span class="st">", "</span>, wyniki, <span class="st">")"</span>)),</span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">70</span>, </span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ŷ = "</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">" - "</span>, </span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">abs</span>(<span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">2</span>)), <span class="st">"x"</span>),</span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Linia Regresji: Wyniki vs. Lęk"</span>,</span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Wyższy lęk jest związany z niższymi wynikami egzaminu"</span>,</span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wynik Lęku przed Testem"</span>,</span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Wyniki Egzaminu (%)"</span></span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb299-19"><a href="#cb299-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb299-20"><a href="#cb299-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb299-21"><a href="#cb299-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ocena-modelu" class="level3">
<h3 class="anchored" data-anchor-id="ocena-modelu">Ocena Modelu</h3>
<section id="dekompozycja-wariancji" class="level4">
<h4 class="anchored" data-anchor-id="dekompozycja-wariancji">Dekompozycja Wariancji</h4>
<p>Całkowita zmienność w Y może być rozłożona na dwie części:</p>
<p><span class="math display">SST = SSE + SSR</span></p>
<p>Gdzie:</p>
<ul>
<li><strong>SST (Sum of Squares Total)</strong>: Całkowita zmienność w Y</li>
<li><strong>SSE (Sum of Squared Errors)</strong>: Niewyjaśniona zmienność<br>
</li>
<li><strong>SSR (Sum of Squares Regression)</strong>: Wyjaśniona zmienność</li>
</ul>
<p>Obliczmy każdą:</p>
<p><strong>Krok 1: Oblicz przewidywane wartości</strong></p>
<p>Używając <span class="math inline">\hat{Y} = 89,684 - 2,451X</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 89,684 - 2,451X_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2,5</td>
<td>80</td>
<td><span class="math inline">89,684 - 2,451(2,5) = 83,556</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>3,2</td>
<td>85</td>
<td><span class="math inline">89,684 - 2,451(3,2) = 81,841</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>4,1</td>
<td>78</td>
<td><span class="math inline">89,684 - 2,451(4,1) = 79,635</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4,8</td>
<td>82</td>
<td><span class="math inline">89,684 - 2,451(4,8) = 77,919</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5,6</td>
<td>77</td>
<td><span class="math inline">89,684 - 2,451(5,6) = 75,968</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6,3</td>
<td>74</td>
<td><span class="math inline">89,684 - 2,451(6,3) = 74,253</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>7,0</td>
<td>68</td>
<td><span class="math inline">89,684 - 2,451(7,0) = 72,527</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>7,9</td>
<td>72</td>
<td><span class="math inline">89,684 - 2,451(7,9) = 70,321</span></td>
</tr>
</tbody>
</table>
<p><strong>Krok 2: Oblicz sumy kwadratów</strong></p>
<p><strong>SST</strong> (Całkowita zmienność): <span class="math display">SST = \sum(Y_i - \bar{Y})^2</span></p>
<p>Z naszych wcześniejszych obliczeń wariancji: <span class="math display">SST = (n-1) \times s^2_Y = 7 \times 30,5714 = 214</span></p>
<p><strong>SSE</strong> (Niewyjaśniona zmienność): <span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">(Y_i - \hat{Y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>80</td>
<td>83,556</td>
<td>-3,556</td>
<td>12,645</td>
</tr>
<tr class="even">
<td>2</td>
<td>85</td>
<td>81,841</td>
<td>3,159</td>
<td>9,979</td>
</tr>
<tr class="odd">
<td>3</td>
<td>78</td>
<td>79,635</td>
<td>-1,635</td>
<td>2,673</td>
</tr>
<tr class="even">
<td>4</td>
<td>82</td>
<td>77,919</td>
<td>4,081</td>
<td>16,655</td>
</tr>
<tr class="odd">
<td>5</td>
<td>77</td>
<td>75,968</td>
<td>1,032</td>
<td>1,065</td>
</tr>
<tr class="even">
<td>6</td>
<td>74</td>
<td>74,253</td>
<td>-0,253</td>
<td>0,064</td>
</tr>
<tr class="odd">
<td>7</td>
<td>68</td>
<td>72,527</td>
<td>-4,527</td>
<td>20,494</td>
</tr>
<tr class="even">
<td>8</td>
<td>72</td>
<td>70,321</td>
<td>1,679</td>
<td>2,819</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>66,394</strong></td>
</tr>
</tbody>
</table>
<p><strong>SSR</strong> (Wyjaśniona zmienność): <span class="math display">SSR = SST - SSE = 214 - 66,394 = 147,606</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja obliczeń</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>tabela_anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(model)</span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Regresja):"</span>, tabela_anova<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Regresja): 147.5887 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Reszty):"</span>, tabela_anova<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Reszty): 66.41132 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Całkowita):"</span>, <span class="fu">sum</span>(tabela_anova<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Całkowita): 214 </code></pre>
</div>
</div>
</section>
<section id="r-kwadrat-współczynnik-determinacji" class="level4">
<h4 class="anchored" data-anchor-id="r-kwadrat-współczynnik-determinacji">R-kwadrat (Współczynnik Determinacji)</h4>
<p>R-kwadrat mówi nam, jaka część całkowitej zmienności w Y jest wyjaśniona przez nasz model:</p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{147,606}{214} = 0,690</span></p>
<p>To oznacza, że nasz model wyjaśnia <strong>69,0%</strong> zmienności w wynikach egzaminu.</p>
<p><strong>Alternatywny wzór używający korelacji:</strong> <span class="math display">R^2 = r^2 = (-0,831)^2 = 0,691</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja R-kwadrat</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-kwadrat:"</span>, <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-kwadrat: 0.6896667 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja do kwadratu:"</span>, <span class="fu">cor</span>(lęk, wyniki)<span class="sc">^</span><span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja do kwadratu: 0.6896667 </code></pre>
</div>
</div>
</section>
</section>
<section id="wielkość-efektu" class="level3">
<h3 class="anchored" data-anchor-id="wielkość-efektu">Wielkość Efektu</h3>
<p>Współczynnik nachylenia <span class="math inline">\hat{\beta_1} = -2,451</span> to nasza wielkość efektu. Mówi nam:</p>
<ul>
<li><strong>Wielkość</strong>: Każdy wzrost lęku o 1 punkt jest związany z 2,45% spadkiem wyników</li>
<li><strong>Znaczenie praktyczne</strong>: Student przechodzący od niskiego lęku (3) do wysokiego lęku (7) doświadczyłby oczekiwanego spadku wyników o <span class="math inline">2,451 \times 4 = 9,80\%</span></li>
</ul>
<p><strong>Standaryzowana wielkość efektu (współczynnik korelacji):</strong> Korelacja <span class="math inline">r = -0,831</span> wskazuje na <strong>silny ujemny związek</strong>.</p>
<p>Wytyczne Cohena dla interpretacji korelacji:</p>
<ul>
<li>Mały efekt: <span class="math inline">|r| = 0,10</span></li>
<li>Średni efekt: <span class="math inline">|r| = 0,30</span></li>
<li>Duży efekt: <span class="math inline">|r| = 0,50</span></li>
</ul>
<p>Nasze <span class="math inline">|r| = 0,831</span> reprezentuje dużą wielkość efektu.</p>
</section>
<section id="przedziały-ufności-i-istotność-statystyczna" class="level3">
<h3 class="anchored" data-anchor-id="przedziały-ufności-i-istotność-statystyczna">Przedziały Ufności i Istotność Statystyczna</h3>
<section id="błąd-standardowy-regresji" class="level4">
<h4 class="anchored" data-anchor-id="błąd-standardowy-regresji">Błąd Standardowy Regresji</h4>
<p>Najpierw potrzebujemy błędu standardowego reszt:</p>
<p><span class="math display">s_e = \sqrt{\frac{SSE}{n-2}} = \sqrt{\frac{66,394}{6}} = \sqrt{11,066} = 3,327</span></p>
</section>
<section id="błąd-standardowy-nachylenia" class="level4">
<h4 class="anchored" data-anchor-id="błąd-standardowy-nachylenia">Błąd Standardowy Nachylenia</h4>
<p>Błąd standardowy <span class="math inline">\hat{\beta_1}</span> to:</p>
<p><span class="math display">BE(\hat{\beta_1}) = \frac{s_e}{\sqrt{\sum(X_i - \bar{X})^2}} = \frac{3,327}{\sqrt{24,555}} = \frac{3,327}{4,955} = 0,671</span></p>
</section>
<section id="przedział-ufności-dla-nachylenia" class="level4">
<h4 class="anchored" data-anchor-id="przedział-ufności-dla-nachylenia">95% Przedział Ufności dla Nachylenia</h4>
<p><strong>Mówiąc prościej:</strong> Przedział ufności daje nam zakres prawdopodobnych wartości dla naszego prawdziwego nachylenia. Gdybyśmy powtórzyli to badanie wiele razy, 95% obliczonych przez nas przedziałów zawierałoby prawdziwą wartość nachylenia.</p>
<p>Wzór używa wartości krytycznej (około 2,45 dla 6 stopni swobody):</p>
<p><span class="math display">PU = \hat{\beta_1} \pm (wartość\_krytyczna \times BE(\hat{\beta_1}))</span> <span class="math display">PU = -2,451 \pm (2,45 \times 0,671)</span> <span class="math display">PU = -2,451 \pm 1,644</span> <span class="math display">PU = [-4,095, -0,807]</span></p>
<p><strong>Interpretacja:</strong> Jesteśmy w 95% pewni, że prawdziwa zmiana wyników na jednostkę zmiany lęku mieści się między -4,10% a -0,81%.</p>
</section>
<section id="istotność-statystyczna" class="level4">
<h4 class="anchored" data-anchor-id="istotność-statystyczna">Istotność Statystyczna</h4>
<p>Aby sprawdzić, czy związek jest statystycznie istotny (tj. nie jest przypadkowy), obliczamy statystykę t:</p>
<p><span class="math display">t = \frac{\hat{\beta_1}}{BE(\hat{\beta_1})} = \frac{-2,451}{0,671} = -3,653</span></p>
<p><strong>Mówiąc prościej:</strong> Ta wartość t mówi nam, o ile błędów standardowych nasze nachylenie odbiega od zera. Wartość bezwzględna 3,65 jest dość duża (zazwyczaj wartości przekraczające ±2,45 są uważane za istotne dla naszej wielkości próby), dostarczając silnego dowodu na rzeczywisty ujemny związek między lękiem a wynikami.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja obliczeń z R</span></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = wyniki ~ lęk)

Residuals:
   Min     1Q Median     3Q    Max 
-4.526 -2.116  0.400  2.050  4.081 

Coefficients:
            Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)  89.6872     3.6682  24.450 0.000000308 ***
lęk          -2.4516     0.6714  -3.652      0.0107 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.327 on 6 degrees of freedom
Multiple R-squared:  0.6897,    Adjusted R-squared:  0.6379 
F-statistic: 13.33 on 1 and 6 DF,  p-value: 0.01069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 80.711582 98.6628838
lęk         -4.094474 -0.8088048</code></pre>
</div>
</div>
</section>
</section>
<section id="podsumowanie-i-interpretacja" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie-i-interpretacja">Podsumowanie i Interpretacja</h3>
<section id="czego-się-nauczyliśmy" class="level4">
<h4 class="anchored" data-anchor-id="czego-się-nauczyliśmy">Czego się Nauczyliśmy</h4>
<ol type="1">
<li><strong>Istnieje ujemny związek</strong> między lękiem przed testem a wynikami egzaminu (r = -0,831)</li>
<li><strong>Związek jest umiarkowanie silny</strong> - lęk wyjaśnia 69,0% zmienności w wynikach</li>
<li><strong>Efekt jest znaczący</strong> - każdy wzrost lęku o 1 punkt jest związany z około 2,5% spadkiem wyników</li>
<li><strong>Związek jest statystycznie istotny</strong> - bardzo mało prawdopodobne, żeby był przypadkowy</li>
</ol>
</section>
<section id="implikacje-praktyczne" class="level4">
<h4 class="anchored" data-anchor-id="implikacje-praktyczne">Implikacje Praktyczne</h4>
<p>Nasza analiza sugeruje, że wysoki lęk przed testem pogarsza wyniki, prawdopodobnie poprzez:</p>
<ul>
<li>Zakłócenia poznawcze (niepokojące myśli konkurują o pamięć roboczą)</li>
<li>Objawy fizyczne (pocenie się, szybkie bicie serca), które odwracają uwagę od zadania</li>
<li>Negatywny monolog wewnętrzny zmniejszający pewność siebie i motywację</li>
<li>Zachowania podczas testu (pośpiech, podważanie odpowiedzi)</li>
</ul>
</section>
<section id="rekomendacje-na-podstawie-ustaleń" class="level4">
<h4 class="anchored" data-anchor-id="rekomendacje-na-podstawie-ustaleń">Rekomendacje na Podstawie Ustaleń</h4>
<p>Biorąc pod uwagę silny ujemny związek, interwencje mogłyby obejmować:</p>
<ul>
<li>Nauczanie technik zarządzania lękiem (głębokie oddychanie, progresywne rozluźnianie mięśni)</li>
<li>Restrukturyzację poznawczą w celu radzenia sobie z katastroficznym myśleniem</li>
<li>Trening umiejętności nauki w celu zwiększenia pewności siebie w przygotowaniu</li>
<li>Testy próbne w celu zmniejszenia strachu przed nieznanym</li>
</ul>
</section>
<section id="ograniczenia-naszej-analizy" class="level4">
<h4 class="anchored" data-anchor-id="ograniczenia-naszej-analizy">Ograniczenia Naszej Analizy</h4>
<ol type="1">
<li><strong>Mała wielkość próby</strong> (n = 8) ogranicza możliwość uogólnienia</li>
<li><strong>Założenie liniowości</strong> - związek może być krzywoliniowy (może istnieć optymalny lęk)</li>
<li><strong>Inne zmienne</strong> nieuwzględnione (czas przygotowania, zdolności, sen, itp.)</li>
<li><strong>Przyczynowość vs.&nbsp;korelacja</strong> - nie możemy udowodnić, że lęk powoduje słabe wyniki</li>
<li><strong>Samoopisowy lęk</strong> - subiektywne miary mogą nie odzwierciedlać pobudzenia fizjologicznego</li>
</ol>
</section>
</section>
<section id="dodatek-kompletny-kod-r" class="level3">
<h3 class="anchored" data-anchor-id="dodatek-kompletny-kod-r">Dodatek: Kompletny Kod R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kompletny kod analizy</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>lęk <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.2</span>, <span class="fl">4.1</span>, <span class="fl">4.8</span>, <span class="fl">5.6</span>, <span class="fl">6.3</span>, <span class="fl">7.0</span>, <span class="fl">7.9</span>)</span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>wyniki <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">77</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>)</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki opisowe</span></span>
<span id="cb315-6"><a href="#cb315-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(lęk); <span class="fu">sd</span>(lęk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.175</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.872927</code></pre>
</div>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wyniki); <span class="fu">sd</span>(wyniki)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 77</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.529144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(lęk, wyniki)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8304618</code></pre>
</div>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresja</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(wyniki <span class="sc">~</span> lęk)</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = wyniki ~ lęk)

Residuals:
   Min     1Q Median     3Q    Max 
-4.526 -2.116  0.400  2.050  4.081 

Coefficients:
            Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)  89.6872     3.6682  24.450 0.000000308 ***
lęk          -2.4516     0.6714  -3.652      0.0107 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.327 on 6 degrees of freedom
Multiple R-squared:  0.6897,    Adjusted R-squared:  0.6379 
F-statistic: 13.33 on 1 and 6 DF,  p-value: 0.01069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 80.711582 98.6628838
lęk         -4.094474 -0.8088048</code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja</span></span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(lęk, wyniki), <span class="fu">aes</span>(<span class="at">x =</span> lęk, <span class="at">y =</span> wyniki)) <span class="sc">+</span></span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostyka</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-43-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-43-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-43-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela ANOVA</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: wyniki
          Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
lęk        1 147.589 147.589  13.334 0.01069 *
Residuals  6  66.411  11.069                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="przykład-7.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en" class="level2" data-number="14.23">
<h2 data-number="14.23" class="anchored" data-anchor-id="przykład-7.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en"><span class="header-section-number">14.23</span> Przykład 7. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*) [EN]</h2>
<section id="data-generating-process" class="level3">
<h3 class="anchored" data-anchor-id="data-generating-process">Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<p><span class="math display">\begin{aligned}
&amp; Y_{\text{Gallagher}} = 12 - 0.8X_{\text{DM}} + \varepsilon \\
&amp; \varepsilon \sim \mathcal{N}(0, 1) \\
&amp; X_{\text{DM}} \in \{3, 5, 7, 10, 12, 15\}
\end{aligned}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-1" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics-1">Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667</span></p>
<p><span class="math display">\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">
32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332
</span></p>
<p><span class="math display">s^2_X = \frac{101.3332}{5} = 20.2666</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">s^2_Y = \frac{56.3483}{5} = 11.2697</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-2" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-correlation-2">Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">s_{XY} = \frac{-70.3670}{5} = -14.0734</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-2">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-0.6944 × 8.6667 = -6.0181</span></li>
<li><span class="math inline">\hat{\beta_0} = 5.7167 - (-6.0181) = 11.7348</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation-1" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-calculation-1">R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 11.7348 - 0.6944X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 56.3483</span> <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271</span> <span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters">Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb354-10"><a href="#cb354-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb354-11"><a href="#cb354-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-12"><a href="#cb354-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb354-13"><a href="#cb354-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb354-14"><a href="#cb354-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb354-15"><a href="#cb354-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-16"><a href="#cb354-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb354-17"><a href="#cb354-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb354-18"><a href="#cb354-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb354-19"><a href="#cb354-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb354-20"><a href="#cb354-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb354-21"><a href="#cb354-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb354-22"><a href="#cb354-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-23"><a href="#cb354-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb354-24"><a href="#cb354-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb354-25"><a href="#cb354-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb354-26"><a href="#cb354-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb354-27"><a href="#cb354-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb354-28"><a href="#cb354-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb354-29"><a href="#cb354-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb354-30"><a href="#cb354-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb354-31"><a href="#cb354-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb354-32"><a href="#cb354-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb354-33"><a href="#cb354-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb354-34"><a href="#cb354-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb354-35"><a href="#cb354-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb354-36"><a href="#cb354-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb354-37"><a href="#cb354-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb354-38"><a href="#cb354-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb354-39"><a href="#cb354-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb354-40"><a href="#cb354-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb354-41"><a href="#cb354-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb354-42"><a href="#cb354-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb354-43"><a href="#cb354-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb354-44"><a href="#cb354-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb354-45"><a href="#cb354-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="observations-about-model-fit">Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation-2" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-2">Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3">
<h3 class="anchored" data-anchor-id="study-context">Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./correg_en.html" class="pagination-link" aria-label="Introduction to Correlation and Regression Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./probability_en.html" class="pagination-link" aria-label="Introduction to (Discrete) Probability">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>