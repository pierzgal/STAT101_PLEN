<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Wprowadzenie do Analizy Korelacji i Regresji – Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./probability_en.html" rel="next">
<link href="./correg_en.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ffd282cb318059e0bcb130885a47f5dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_pl.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations of Statistics and Demography</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Podstawy Statystyki i Demografii</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy statystyki opisowej jednej zmiennej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference: The Logic of Statistical Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#wprowadzenie" id="toc-wprowadzenie" class="nav-link active" data-scroll-target="#wprowadzenie"><span class="header-section-number">10.1</span> Wprowadzenie</a></li>
  <li><a href="#podstawy-teoretyczne" id="toc-podstawy-teoretyczne" class="nav-link" data-scroll-target="#podstawy-teoretyczne"><span class="header-section-number">10.2</span> Podstawy Teoretyczne</a>
  <ul class="collapse">
  <li><a href="#kowariancja" id="toc-kowariancja" class="nav-link" data-scroll-target="#kowariancja">Kowariancja</a></li>
  <li><a href="#współczynnik-korelacji" id="toc-współczynnik-korelacji" class="nav-link" data-scroll-target="#współczynnik-korelacji">Współczynnik Korelacji</a></li>
  <li><a href="#współczynnik-korelacji-pearsona" id="toc-współczynnik-korelacji-pearsona" class="nav-link" data-scroll-target="#współczynnik-korelacji-pearsona">Współczynnik Korelacji Pearsona</a></li>
  <li><a href="#współczynnik-korelacji-rang-spearmana" id="toc-współczynnik-korelacji-rang-spearmana" class="nav-link" data-scroll-target="#współczynnik-korelacji-rang-spearmana">Współczynnik Korelacji Rang Spearmana</a></li>
  <li><a href="#wizualizacja-wzorców-korelacji" id="toc-wizualizacja-wzorców-korelacji" class="nav-link" data-scroll-target="#wizualizacja-wzorców-korelacji">Wizualizacja Wzorców Korelacji</a></li>
  </ul></li>
  <li><a href="#metody-obliczeń-ręcznych" id="toc-metody-obliczeń-ręcznych" class="nav-link" data-scroll-target="#metody-obliczeń-ręcznych"><span class="header-section-number">10.3</span> Metody Obliczeń Ręcznych</a>
  <ul class="collapse">
  <li><a href="#obliczanie-kowariancji-krok-po-kroku" id="toc-obliczanie-kowariancji-krok-po-kroku" class="nav-link" data-scroll-target="#obliczanie-kowariancji-krok-po-kroku">Obliczanie Kowariancji: Krok po Kroku</a></li>
  <li><a href="#obliczanie-korelacji-pearsona-krok-po-kroku" id="toc-obliczanie-korelacji-pearsona-krok-po-kroku" class="nav-link" data-scroll-target="#obliczanie-korelacji-pearsona-krok-po-kroku">Obliczanie Korelacji Pearsona: Krok po Kroku</a></li>
  <li><a href="#obliczanie-korelacji-spearmana-krok-po-kroku" id="toc-obliczanie-korelacji-spearmana-krok-po-kroku" class="nav-link" data-scroll-target="#obliczanie-korelacji-spearmana-krok-po-kroku">Obliczanie Korelacji Spearmana: Krok po Kroku</a></li>
  </ul></li>
  <li><a href="#weryfikacja-w-r-i-implementacja" id="toc-weryfikacja-w-r-i-implementacja" class="nav-link" data-scroll-target="#weryfikacja-w-r-i-implementacja"><span class="header-section-number">10.4</span> Weryfikacja w R i Implementacja</a>
  <ul class="collapse">
  <li><a href="#weryfikacja-kowariancji" id="toc-weryfikacja-kowariancji" class="nav-link" data-scroll-target="#weryfikacja-kowariancji">Weryfikacja Kowariancji</a></li>
  <li><a href="#weryfikacja-korelacji-pearsona" id="toc-weryfikacja-korelacji-pearsona" class="nav-link" data-scroll-target="#weryfikacja-korelacji-pearsona">Weryfikacja Korelacji Pearsona</a></li>
  <li><a href="#weryfikacja-korelacji-spearmana" id="toc-weryfikacja-korelacji-spearmana" class="nav-link" data-scroll-target="#weryfikacja-korelacji-spearmana">Weryfikacja Korelacji Spearmana</a></li>
  </ul></li>
  <li><a href="#ćwiczenia-praktyczne" id="toc-ćwiczenia-praktyczne" class="nav-link" data-scroll-target="#ćwiczenia-praktyczne"><span class="header-section-number">10.5</span> Ćwiczenia Praktyczne</a>
  <ul class="collapse">
  <li><a href="#ćwiczenie-1-ręczne-obliczenie-kowariancji-i-korelacji-pearsona" id="toc-ćwiczenie-1-ręczne-obliczenie-kowariancji-i-korelacji-pearsona" class="nav-link" data-scroll-target="#ćwiczenie-1-ręczne-obliczenie-kowariancji-i-korelacji-pearsona">Ćwiczenie 1: Ręczne Obliczenie Kowariancji i Korelacji Pearsona</a></li>
  <li><a href="#ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana" id="toc-ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana" class="nav-link" data-scroll-target="#ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana">Ćwiczenie 2: Ręczne Obliczenie Korelacji Spearmana</a></li>
  <li><a href="#ćwiczenie-3-porównanie-pearsona-i-spearmana" id="toc-ćwiczenie-3-porównanie-pearsona-i-spearmana" class="nav-link" data-scroll-target="#ćwiczenie-3-porównanie-pearsona-i-spearmana">Ćwiczenie 3: Porównanie Pearsona i Spearmana</a></li>
  </ul></li>
  <li><a href="#najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember" id="toc-najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember" class="nav-link" data-scroll-target="#najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember"><span class="header-section-number">10.6</span> Najważniejsze rzeczy do zapamiętania <em>(Important Points to Remember)</em></a></li>
  <li><a href="#podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis" id="toc-podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis" class="nav-link" data-scroll-target="#podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis"><span class="header-section-number">10.7</span> Podsumowanie: drzewko decyzyjne do analizy korelacji <em>(Summary: Decision Tree for Correlation Analysis)</em></a>
  <ul class="collapse">
  <li><a href="#ściąga-quick-reference-card" id="toc-ściąga-quick-reference-card" class="nav-link" data-scroll-target="#ściąga-quick-reference-card">Ściąga <em>(Quick Reference Card)</em></a></li>
  </ul></li>
  <li><a href="#wprowadzenie-do-modelowania-statystycznego-analizy-regresji-i-metody-mnk" id="toc-wprowadzenie-do-modelowania-statystycznego-analizy-regresji-i-metody-mnk" class="nav-link" data-scroll-target="#wprowadzenie-do-modelowania-statystycznego-analizy-regresji-i-metody-mnk"><span class="header-section-number">10.8</span> Wprowadzenie do Modelowania Statystycznego, Analizy Regresji i Metody MNK</a>
  <ul class="collapse">
  <li><a href="#modele-deterministyczne-a-stochastyczne" id="toc-modele-deterministyczne-a-stochastyczne" class="nav-link" data-scroll-target="#modele-deterministyczne-a-stochastyczne">Modele Deterministyczne a Stochastyczne</a></li>
  <li><a href="#wizualizacja-relacji-wykresy-rozrzutu-i-typy-wzorców" id="toc-wizualizacja-relacji-wykresy-rozrzutu-i-typy-wzorców" class="nav-link" data-scroll-target="#wizualizacja-relacji-wykresy-rozrzutu-i-typy-wzorców">Wizualizacja Relacji: Wykresy Rozrzutu i Typy Wzorców</a></li>
  <li><a href="#prosty-przykład-godziny-nauki-i-wyniki-egzaminów" id="toc-prosty-przykład-godziny-nauki-i-wyniki-egzaminów" class="nav-link" data-scroll-target="#prosty-przykład-godziny-nauki-i-wyniki-egzaminów">Prosty Przykład: Godziny Nauki i Wyniki Egzaminów</a></li>
  <li><a href="#idea-linii-najlepszego-dopasowania" id="toc-idea-linii-najlepszego-dopasowania" class="nav-link" data-scroll-target="#idea-linii-najlepszego-dopasowania">Idea Linii “Najlepszego Dopasowania”</a></li>
  <li><a href="#wizualizacja-różnych-linii-i-ich-sse" id="toc-wizualizacja-różnych-linii-i-ich-sse" class="nav-link" data-scroll-target="#wizualizacja-różnych-linii-i-ich-sse">Wizualizacja Różnych Linii i Ich SSE</a></li>
  <li><a href="#model-zerowy-przewidywanie-ze-średniej" id="toc-model-zerowy-przewidywanie-ze-średniej" class="nav-link" data-scroll-target="#model-zerowy-przewidywanie-ze-średniej">Model Zerowy: Przewidywanie ze Średniej</a></li>
  <li><a href="#dekompozycja-wariancji-jak-dobry-jest-nasz-model" id="toc-dekompozycja-wariancji-jak-dobry-jest-nasz-model" class="nav-link" data-scroll-target="#dekompozycja-wariancji-jak-dobry-jest-nasz-model">Dekompozycja Wariancji: Jak Dobry Jest Nasz Model?</a></li>
  <li><a href="#znajdowanie-współczynników-mnk-minimalizacja-sse" id="toc-znajdowanie-współczynników-mnk-minimalizacja-sse" class="nav-link" data-scroll-target="#znajdowanie-współczynników-mnk-minimalizacja-sse">Znajdowanie Współczynników MNK: Minimalizacja SSE</a></li>
  <li><a href="#ocena-jakości-modelu-r-kwadrat" id="toc-ocena-jakości-modelu-r-kwadrat" class="nav-link" data-scroll-target="#ocena-jakości-modelu-r-kwadrat">Ocena Jakości Modelu: R-kwadrat</a></li>
  <li><a href="#ocena-jakości-modelu-rmse" id="toc-ocena-jakości-modelu-rmse" class="nav-link" data-scroll-target="#ocena-jakości-modelu-rmse">Ocena Jakości Modelu: RMSE</a></li>
  <li><a href="#interpretacja-modelu-wielkość-efektu-i-diagnostyka" id="toc-interpretacja-modelu-wielkość-efektu-i-diagnostyka" class="nav-link" data-scroll-target="#interpretacja-modelu-wielkość-efektu-i-diagnostyka">Interpretacja Modelu, Wielkość Efektu i Diagnostyka</a></li>
  <li><a href="#korelacja-vs.-przyczynowość-i-relacje-pozorne" id="toc-korelacja-vs.-przyczynowość-i-relacje-pozorne" class="nav-link" data-scroll-target="#korelacja-vs.-przyczynowość-i-relacje-pozorne">Korelacja vs.&nbsp;Przyczynowość i Relacje Pozorne</a></li>
  <li><a href="#kluczowe-założenia-mnk" id="toc-kluczowe-założenia-mnk" class="nav-link" data-scroll-target="#kluczowe-założenia-mnk">Kluczowe Założenia MNK</a></li>
  <li><a href="#rozszerzenie-do-regresji-wielorakiej" id="toc-rozszerzenie-do-regresji-wielorakiej" class="nav-link" data-scroll-target="#rozszerzenie-do-regresji-wielorakiej">Rozszerzenie do Regresji Wielorakiej</a></li>
  <li><a href="#podsumowanie" id="toc-podsumowanie" class="nav-link" data-scroll-target="#podsumowanie">Podsumowanie</a></li>
  </ul></li>
  <li><a href="#ręczne-obliczenia-ols-krok-po-kroku" id="toc-ręczne-obliczenia-ols-krok-po-kroku" class="nav-link" data-scroll-target="#ręczne-obliczenia-ols-krok-po-kroku"><span class="header-section-number">10.9</span> Ręczne obliczenia OLS krok po kroku</a>
  <ul class="collapse">
  <li><a href="#krok-1-średnie" id="toc-krok-1-średnie" class="nav-link" data-scroll-target="#krok-1-średnie">Krok 1: Średnie</a></li>
  <li><a href="#krok-2-odchylenia-od-średnich" id="toc-krok-2-odchylenia-od-średnich" class="nav-link" data-scroll-target="#krok-2-odchylenia-od-średnich">Krok 2: Odchylenia od średnich</a></li>
  <li><a href="#krok-3-iloczyny-i-kwadraty" id="toc-krok-3-iloczyny-i-kwadraty" class="nav-link" data-scroll-target="#krok-3-iloczyny-i-kwadraty">Krok 3: Iloczyny i kwadraty</a></li>
  <li><a href="#krok-4-nachylenie-hatbeta_1" id="toc-krok-4-nachylenie-hatbeta_1" class="nav-link" data-scroll-target="#krok-4-nachylenie-hatbeta_1">Krok 4: Nachylenie <span class="math inline">\hat{\beta}_1</span></a></li>
  <li><a href="#krok-5-wyraz-wolny-hatbeta_0" id="toc-krok-5-wyraz-wolny-hatbeta_0" class="nav-link" data-scroll-target="#krok-5-wyraz-wolny-hatbeta_0">Krok 5: Wyraz wolny <span class="math inline">\hat{\beta}_0</span></a></li>
  <li><a href="#krok-6-równanie-regresji" id="toc-krok-6-równanie-regresji" class="nav-link" data-scroll-target="#krok-6-równanie-regresji">Krok 6: Równanie regresji</a></li>
  <li><a href="#krok-7-predykcje-i-reszty" id="toc-krok-7-predykcje-i-reszty" class="nav-link" data-scroll-target="#krok-7-predykcje-i-reszty">Krok 7: Predykcje i reszty</a></li>
  <li><a href="#krok-8-sumy-kwadratów" id="toc-krok-8-sumy-kwadratów" class="nav-link" data-scroll-target="#krok-8-sumy-kwadratów">Krok 8: Sumy kwadratów</a></li>
  <li><a href="#krok-9-r2" id="toc-krok-9-r2" class="nav-link" data-scroll-target="#krok-9-r2">Krok 9: <span class="math inline">R^2</span></a></li>
  <li><a href="#krok-10-wielkości-efektu" id="toc-krok-10-wielkości-efektu" class="nav-link" data-scroll-target="#krok-10-wielkości-efektu">Krok 10: Wielkości efektu</a></li>
  <li><a href="#krok-11-istotność-praktyczna" id="toc-krok-11-istotność-praktyczna" class="nav-link" data-scroll-target="#krok-11-istotność-praktyczna">Krok 11: Istotność praktyczna</a></li>
  <li><a href="#podsumowanie-wyników" id="toc-podsumowanie-wyników" class="nav-link" data-scroll-target="#podsumowanie-wyników">Podsumowanie wyników</a></li>
  <li><a href="#kontrola-wyniku" id="toc-kontrola-wyniku" class="nav-link" data-scroll-target="#kontrola-wyniku">Kontrola wyniku</a></li>
  </ul></li>
  <li><a href="#kod-r-do-weryfikacji-obliczeń" id="toc-kod-r-do-weryfikacji-obliczeń" class="nav-link" data-scroll-target="#kod-r-do-weryfikacji-obliczeń"><span class="header-section-number">10.10</span> Kod R do weryfikacji obliczeń</a></li>
  <li><a href="#jak-uruchomić-kod" id="toc-jak-uruchomić-kod" class="nav-link" data-scroll-target="#jak-uruchomić-kod"><span class="header-section-number">10.11</span> Jak uruchomić kod</a></li>
  <li><a href="#appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający" id="toc-appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający" class="nav-link" data-scroll-target="#appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający"><span class="header-section-number">10.12</span> Appendix A: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład wprowadzający</a>
  <ul class="collapse">
  <li><a href="#krok-1-obliczanie-podstawowych-statystyk" id="toc-krok-1-obliczanie-podstawowych-statystyk" class="nav-link" data-scroll-target="#krok-1-obliczanie-podstawowych-statystyk">Krok 1: Obliczanie Podstawowych Statystyk</a></li>
  <li><a href="#krok-2-szczegółowe-obliczenia-kowariancji" id="toc-krok-2-szczegółowe-obliczenia-kowariancji" class="nav-link" data-scroll-target="#krok-2-szczegółowe-obliczenia-kowariancji">Krok 2: Szczegółowe Obliczenia Kowariancji</a></li>
  <li><a href="#krok-3-obliczanie-odchylenia-standardowego" id="toc-krok-3-obliczanie-odchylenia-standardowego" class="nav-link" data-scroll-target="#krok-3-obliczanie-odchylenia-standardowego">Krok 3: Obliczanie Odchylenia Standardowego</a></li>
  <li><a href="#krok-4-obliczanie-korelacji-pearsona" id="toc-krok-4-obliczanie-korelacji-pearsona" class="nav-link" data-scroll-target="#krok-4-obliczanie-korelacji-pearsona">Krok 4: Obliczanie Korelacji Pearsona</a></li>
  <li><a href="#krok-5-obliczanie-korelacji-rangowej-spearmana" id="toc-krok-5-obliczanie-korelacji-rangowej-spearmana" class="nav-link" data-scroll-target="#krok-5-obliczanie-korelacji-rangowej-spearmana">Krok 5: Obliczanie Korelacji Rangowej Spearmana</a></li>
  <li><a href="#krok-6-weryfikacja-w-r" id="toc-krok-6-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-6-weryfikacja-w-r">Krok 6: Weryfikacja w R</a></li>
  <li><a href="#krok-7-podstawowa-wizualizacja" id="toc-krok-7-podstawowa-wizualizacja" class="nav-link" data-scroll-target="#krok-7-podstawowa-wizualizacja">Krok 7: Podstawowa Wizualizacja</a></li>
  <li><a href="#estymacja-ols-i-miary-dopasowania-modelu" id="toc-estymacja-ols-i-miary-dopasowania-modelu" class="nav-link" data-scroll-target="#estymacja-ols-i-miary-dopasowania-modelu">Estymacja OLS i Miary Dopasowania Modelu</a></li>
  <li><a href="#krok-1-obliczanie-estymatorów-ols" id="toc-krok-1-obliczanie-estymatorów-ols" class="nav-link" data-scroll-target="#krok-1-obliczanie-estymatorów-ols">Krok 1: Obliczanie Estymatorów OLS</a></li>
  <li><a href="#krok-2-obliczanie-wartości-dopasowanych-i-reszt" id="toc-krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="nav-link" data-scroll-target="#krok-2-obliczanie-wartości-dopasowanych-i-reszt">Krok 2: Obliczanie Wartości Dopasowanych i Reszt</a></li>
  <li><a href="#krok-3-obliczanie-miar-dopasowania" id="toc-krok-3-obliczanie-miar-dopasowania" class="nav-link" data-scroll-target="#krok-3-obliczanie-miar-dopasowania">Krok 3: Obliczanie Miar Dopasowania</a></li>
  <li><a href="#krok-4-weryfikacja-w-r" id="toc-krok-4-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-4-weryfikacja-w-r">Krok 4: Weryfikacja w R</a></li>
  <li><a href="#krok-5-analiza-reszt" id="toc-krok-5-analiza-reszt" class="nav-link" data-scroll-target="#krok-5-analiza-reszt">Krok 5: Analiza Reszt</a></li>
  <li><a href="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" id="toc-krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="nav-link" data-scroll-target="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych">Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</a></li>
  <li><a href="#modele-z-transformacją-logarytmiczną" id="toc-modele-z-transformacją-logarytmiczną" class="nav-link" data-scroll-target="#modele-z-transformacją-logarytmiczną">Modele z Transformacją Logarytmiczną</a></li>
  <li><a href="#krok-1-transformacja-danych" id="toc-krok-1-transformacja-danych" class="nav-link" data-scroll-target="#krok-1-transformacja-danych">Krok 1: Transformacja Danych</a></li>
  <li><a href="#krok-2-porównanie-różnych-specyfikacji-modelu" id="toc-krok-2-porównanie-różnych-specyfikacji-modelu" class="nav-link" data-scroll-target="#krok-2-porównanie-różnych-specyfikacji-modelu">Krok 2: Porównanie Różnych Specyfikacji Modelu</a></li>
  <li><a href="#krok-3-porównanie-wizualne" id="toc-krok-3-porównanie-wizualne" class="nav-link" data-scroll-target="#krok-3-porównanie-wizualne">Krok 3: Porównanie Wizualne</a></li>
  <li><a href="#krok-4-analiza-reszt-dla-najlepszego-modelu" id="toc-krok-4-analiza-reszt-dla-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-4-analiza-reszt-dla-najlepszego-modelu">Krok 4: Analiza Reszt dla Najlepszego Modelu</a></li>
  <li><a href="#krok-5-interpretacja-najlepszego-modelu" id="toc-krok-5-interpretacja-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-5-interpretacja-najlepszego-modelu">Krok 5: Interpretacja Najlepszego Modelu</a></li>
  <li><a href="#krok-6-predykcje-modelu" id="toc-krok-6-predykcje-modelu" class="nav-link" data-scroll-target="#krok-6-predykcje-modelu">Krok 6: Predykcje Modelu</a></li>
  <li><a href="#krok-7-analiza-elastyczności" id="toc-krok-7-analiza-elastyczności" class="nav-link" data-scroll-target="#krok-7-analiza-elastyczności">Krok 7: Analiza Elastyczności</a></li>
  </ul></li>
  <li><a href="#appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne" id="toc-appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne" class="nav-link" data-scroll-target="#appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne"><span class="header-section-number">10.13</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - przykłady różne</a></li>
  <li><a href="#przykład-0.-czas-nauki-vs.-ocena-przewodnik-po-mnk-i-r-kwadrat" id="toc-przykład-0.-czas-nauki-vs.-ocena-przewodnik-po-mnk-i-r-kwadrat" class="nav-link" data-scroll-target="#przykład-0.-czas-nauki-vs.-ocena-przewodnik-po-mnk-i-r-kwadrat"><span class="header-section-number">10.14</span> Przykład 0. Czas Nauki vs.&nbsp;Ocena: Przewodnik po MNK i R-kwadrat</a>
  <ul class="collapse">
  <li><a href="#obliczenia-ręczne" id="toc-obliczenia-ręczne" class="nav-link" data-scroll-target="#obliczenia-ręczne">Obliczenia Ręczne</a></li>
  <li><a href="#wizualizacja-1-linia-najlepszego-dopasowania-mnk" id="toc-wizualizacja-1-linia-najlepszego-dopasowania-mnk" class="nav-link" data-scroll-target="#wizualizacja-1-linia-najlepszego-dopasowania-mnk">Wizualizacja 1: Linia Najlepszego Dopasowania MNK</a></li>
  <li><a href="#wizualizacja-2-dekompozycja-wariancji-sst-ssr-sse" id="toc-wizualizacja-2-dekompozycja-wariancji-sst-ssr-sse" class="nav-link" data-scroll-target="#wizualizacja-2-dekompozycja-wariancji-sst-ssr-sse">Wizualizacja 2: Dekompozycja Wariancji (SST = SSR + SSE)</a></li>
  <li><a href="#wizualizacja-3-r-kwadrat-jako-proporcja" id="toc-wizualizacja-3-r-kwadrat-jako-proporcja" class="nav-link" data-scroll-target="#wizualizacja-3-r-kwadrat-jako-proporcja">Wizualizacja 3: R-kwadrat jako Proporcja</a></li>
  <li><a href="#wizualizacja-4-r²-jako-korelacja-między-odchyleniami" id="toc-wizualizacja-4-r²-jako-korelacja-między-odchyleniami" class="nav-link" data-scroll-target="#wizualizacja-4-r²-jako-korelacja-między-odchyleniami">Wizualizacja 4: R² jako Korelacja między Odchyleniami</a></li>
  <li><a href="#wizualizacja-5-wykres-rozrzutu-odchyleń-interpretacja-r²" id="toc-wizualizacja-5-wykres-rozrzutu-odchyleń-interpretacja-r²" class="nav-link" data-scroll-target="#wizualizacja-5-wykres-rozrzutu-odchyleń-interpretacja-r²">Wizualizacja 5: Wykres Rozrzutu Odchyleń (Interpretacja R²)</a></li>
  <li><a href="#tabela-podsumowująca" id="toc-tabela-podsumowująca" class="nav-link" data-scroll-target="#tabela-podsumowująca">Tabela Podsumowująca</a></li>
  <li><a href="#kluczowe-wnioski" id="toc-kluczowe-wnioski" class="nav-link" data-scroll-target="#kluczowe-wnioski">Kluczowe Wnioski</a></li>
  </ul></li>
  <li><a href="#przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą" id="toc-przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą" class="nav-link" data-scroll-target="#przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą"><span class="header-section-number">10.15</span> Przykład 1. Analiza związku między dobrobytem ekonomicznym a frekwencją wyborczą</a>
  <ul class="collapse">
  <li><a href="#dane" id="toc-dane" class="nav-link" data-scroll-target="#dane">Dane</a></li>
  <li><a href="#część-1-statystyki-opisowe" id="toc-część-1-statystyki-opisowe" class="nav-link" data-scroll-target="#część-1-statystyki-opisowe">Część 1: Statystyki opisowe</a></li>
  <li><a href="#część-2-analiza-korelacji" id="toc-część-2-analiza-korelacji" class="nav-link" data-scroll-target="#część-2-analiza-korelacji">Część 2: Analiza korelacji</a></li>
  <li><a href="#część-3-model-regresji-liniowej" id="toc-część-3-model-regresji-liniowej" class="nav-link" data-scroll-target="#część-3-model-regresji-liniowej">Część 3: Model regresji liniowej</a></li>
  <li><a href="#część-4-wizualizacja" id="toc-część-4-wizualizacja" class="nav-link" data-scroll-target="#część-4-wizualizacja">Część 4: Wizualizacja</a></li>
  <li><a href="#część-5-interpretacja-wyników" id="toc-część-5-interpretacja-wyników" class="nav-link" data-scroll-target="#część-5-interpretacja-wyników">Część 5: Interpretacja wyników</a></li>
  <li><a href="#wnioski" id="toc-wnioski" class="nav-link" data-scroll-target="#wnioski">Wnioski</a></li>
  </ul></li>
  <li><a href="#przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" id="toc-przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="nav-link" data-scroll-target="#przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">10.16</span> Przykład 2. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</a>
  <ul class="collapse">
  <li><a href="#dane-1" id="toc-dane-1" class="nav-link" data-scroll-target="#dane-1">Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</a></li>
  <li><a href="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#przykład-3.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" id="toc-przykład-3.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="nav-link" data-scroll-target="#przykład-3.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">10.17</span> Przykład 3. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</a>
  <ul class="collapse">
  <li><a href="#dane-2" id="toc-dane-2" class="nav-link" data-scroll-target="#dane-2">Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</a></li>
  <li><a href="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#przykład-4.-lęk-vs.-wyniki-egzaminu-analiza-korelacji-i-regresji" id="toc-przykład-4.-lęk-vs.-wyniki-egzaminu-analiza-korelacji-i-regresji" class="nav-link" data-scroll-target="#przykład-4.-lęk-vs.-wyniki-egzaminu-analiza-korelacji-i-regresji"><span class="header-section-number">10.18</span> Przykład 4. Lęk vs.&nbsp;Wyniki Egzaminu: Analiza Korelacji i Regresji</a>
  <ul class="collapse">
  <li><a href="#prezentacja-danych" id="toc-prezentacja-danych" class="nav-link" data-scroll-target="#prezentacja-danych">Prezentacja Danych</a></li>
  <li><a href="#statystyki-opisowe" id="toc-statystyki-opisowe" class="nav-link" data-scroll-target="#statystyki-opisowe">Statystyki Opisowe</a></li>
  <li><a href="#kowariancja-i-korelacja" id="toc-kowariancja-i-korelacja" class="nav-link" data-scroll-target="#kowariancja-i-korelacja">Kowariancja i Korelacja</a></li>
  <li><a href="#prosta-regresja-mnk" id="toc-prosta-regresja-mnk" class="nav-link" data-scroll-target="#prosta-regresja-mnk">Prosta Regresja MNK</a></li>
  <li><a href="#wykres-modelu" id="toc-wykres-modelu" class="nav-link" data-scroll-target="#wykres-modelu">Wykres Modelu</a></li>
  <li><a href="#ocena-modelu" id="toc-ocena-modelu" class="nav-link" data-scroll-target="#ocena-modelu">Ocena Modelu</a></li>
  <li><a href="#wielkość-efektu" id="toc-wielkość-efektu" class="nav-link" data-scroll-target="#wielkość-efektu">Wielkość Efektu</a></li>
  <li><a href="#przedziały-ufności-i-istotność-statystyczna" id="toc-przedziały-ufności-i-istotność-statystyczna" class="nav-link" data-scroll-target="#przedziały-ufności-i-istotność-statystyczna">Przedziały Ufności i Istotność Statystyczna</a></li>
  <li><a href="#podsumowanie-i-interpretacja" id="toc-podsumowanie-i-interpretacja" class="nav-link" data-scroll-target="#podsumowanie-i-interpretacja">Podsumowanie i Interpretacja</a></li>
  <li><a href="#dodatek-kompletny-kod-r" id="toc-dodatek-kompletny-kod-r" class="nav-link" data-scroll-target="#dodatek-kompletny-kod-r">Dodatek: Kompletny Kod R</a></li>
  </ul></li>
  <li><a href="#przykład-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en" id="toc-przykład-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en" class="nav-link" data-scroll-target="#przykład-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en"><span class="header-section-number">10.19</span> Przykład 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*) [EN]</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process">Data Generating Process</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation">Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation" id="toc-r-squared-calculation" class="nav-link" data-scroll-target="#r-squared-calculation">R-squared Calculation</a></li>
  <li><a href="#visualization---true-vs.-estimated-parameters" id="toc-visualization---true-vs.-estimated-parameters" class="nav-link" data-scroll-target="#visualization---true-vs.-estimated-parameters">Visualization - True vs.&nbsp;Estimated Parameters</a></li>
  <li><a href="#observations-about-model-fit" id="toc-observations-about-model-fit" class="nav-link" data-scroll-target="#observations-about-model-fit">Observations about Model Fit</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context">Study Context</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="wprowadzenie" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="wprowadzenie"><span class="header-section-number">10.1</span> Wprowadzenie</h2>
<p>Rozróżnienie między korelacją a związkiem przyczynowym stanowi fundamentalne wyzwanie w analizie statystycznej. Podczas gdy korelacja mierzy statystyczne powiązanie między zmiennymi, związek przyczynowy implikuje bezpośredni wpływ jednej zmiennej na drugą.</p>
<p>Relacje statystyczne stanowią fundament podejmowania decyzji opartych na danych w różnych dyscyplinach—od ekonomii i zdrowia publicznego po psychologię i nauki o środowisku. Zrozumienie, kiedy związek wskazuje jedynie na asocjację, a kiedy na prawdziwą przyczynowość, jest kluczowe dla trafnego wnioskowania i skutecznych rekomendacji politycznych.</p>
</section>
<section id="podstawy-teoretyczne" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="podstawy-teoretyczne"><span class="header-section-number">10.2</span> Podstawy Teoretyczne</h2>
<section id="kowariancja" class="level3">
<h3 class="anchored" data-anchor-id="kowariancja">Kowariancja</h3>
<p>Kowariancja mierzy, jak dwie zmienne zmieniają się wspólnie, wskazując zarówno kierunek, jak i wielkość ich liniowego związku. Stanowi ona podstawę do zrozumienia korelacji, ale ma kluczowe ograniczenie: jej wartość zależy od jednostek miary, co utrudnia porównania między różnymi zbiorami danych.</p>
<p><strong>Wzór:</strong></p>
<p><span class="math display">\text{cov}(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">x_i</span> i <span class="math inline">y_i</span> to poszczególne punkty danych</li>
<li><span class="math inline">\bar{x}</span> i <span class="math inline">\bar{y}</span> to średnie zmiennych X i Y</li>
<li><span class="math inline">n</span> to liczba obserwacji</li>
<li>Dzielimy przez <span class="math inline">(n-1)</span> dla kowariancji próbkowej (korekta Bessela)</li>
</ul>
<p><strong>Interpretacja:</strong></p>
<ul>
<li><strong>Kowariancja dodatnia</strong>: Zmienne mają tendencję do wzrostu razem</li>
<li><strong>Kowariancja ujemna</strong>: Gdy jedna zmienna rośnie, druga ma tendencję do spadku</li>
<li><strong>Kowariancja zerowa</strong>: Brak liniowego związku (zmienne zmieniają się niezależnie)</li>
<li><strong>Problem skali</strong>: Kowariancji 37,5 i 7245 nie można bezpośrednio porównać—skala zależy od jednostek X i Y</li>
</ul>
</section>
<section id="współczynnik-korelacji" class="level3">
<h3 class="anchored" data-anchor-id="współczynnik-korelacji">Współczynnik Korelacji</h3>
<p>Współczynnik korelacji standaryzuje kowariancję, eliminując zależność od skali i produkując wartości między -1 a +1. Ta standaryzacja sprawia, że współczynniki korelacji są porównywalne między różnymi zbiorami danych i jednostkami miary.</p>
<p><strong>Wytyczne Interpretacyjne:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Wartość Korelacji</th>
<th>Siła</th>
<th>Interpretacja</th>
<th>Przykład</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>±0,90 do ±1,00</td>
<td>Bardzo Silna</td>
<td>Niemal doskonały związek</td>
<td>Wzrost rodziców i dzieci</td>
</tr>
<tr class="even">
<td>±0,70 do ±0,89</td>
<td>Silna</td>
<td>Zmienne silnie powiązane</td>
<td>Czas nauki a oceny</td>
</tr>
<tr class="odd">
<td>±0,50 do ±0,69</td>
<td>Umiarkowana</td>
<td>Zmienne umiarkowanie powiązane</td>
<td>Ćwiczenia a utrata wagi</td>
</tr>
<tr class="even">
<td>±0,30 do ±0,49</td>
<td>Słaba</td>
<td>Zmienne słabo powiązane</td>
<td>Rozmiar buta a umiejętność czytania</td>
</tr>
<tr class="odd">
<td>±0,00 do ±0,29</td>
<td>Bardzo Słaba/Brak</td>
<td>Mały lub brak związku</td>
<td>Miesiąc urodzenia a inteligencja</td>
</tr>
</tbody>
</table>
</section>
<section id="współczynnik-korelacji-pearsona" class="level3">
<h3 class="anchored" data-anchor-id="współczynnik-korelacji-pearsona">Współczynnik Korelacji Pearsona</h3>
<p>Współczynnik <span class="math inline">r</span> Pearsona mierzy <strong>liniowy</strong> związek między dwiema zmiennymi ciągłymi. Zakłada, że związek można odpowiednio opisać linią prostą.</p>
<p><strong>Wzór:</strong></p>
<p><span class="math display">r = \frac{\text{cov}(X,Y)}{s_X s_Y} = \frac{\sum_{i=1}^n(x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum_{i=1}^n(x_i - \bar{x})^2} \cdot \sqrt{\sum_{i=1}^n(y_i - \bar{y})^2}}</span></p>
<p>Gdzie <span class="math inline">s_X</span> i <span class="math inline">s_Y</span> to próbkowe odchylenia standardowe X i Y.</p>
<p><strong>Właściwości:</strong></p>
<ul>
<li>Zakres: <span class="math inline">-1 \leq r \leq 1</span></li>
<li><span class="math inline">r = 1</span>: Doskonały dodatni związek liniowy</li>
<li><span class="math inline">r = -1</span>: Doskonały ujemny związek liniowy</li>
<li><span class="math inline">r = 0</span>: Brak liniowego związku (ale związki nieliniowe mogą nadal istnieć)</li>
<li>Wrażliwy na wartości odstające i wzorce nieliniowe</li>
</ul>
</section>
<section id="współczynnik-korelacji-rang-spearmana" class="level3">
<h3 class="anchored" data-anchor-id="współczynnik-korelacji-rang-spearmana">Współczynnik Korelacji Rang Spearmana</h3>
<p>Współczynnik <span class="math inline">\rho</span> (rho) Spearmana mierzy związki <strong>monotoniczne</strong> używając rang zamiast wartości surowych. Związek monotoniczny oznacza, że gdy jedna zmienna rośnie, druga konsekwentnie rośnie lub maleje, ale niekoniecznie w stałym tempie.</p>
<p><strong>Wzór:</strong></p>
<p><span class="math display">\rho = 1 - \frac{6 \sum_{i=1}^n d_i^2}{n(n^2 - 1)}</span></p>
<p>Gdzie <span class="math inline">d_i</span> to różnica między rangami odpowiadających obserwacji.</p>
<p><strong>Kiedy używać Spearmana vs.&nbsp;Pearsona:</strong></p>
<ul>
<li><strong>Użyj Pearsona gdy:</strong>
<ul>
<li>Obie zmienne są ciągłe</li>
<li>Związek jest liniowy</li>
<li>Dane mają w przybliżeniu rozkład normalny</li>
<li>Brak znaczących wartości odstających</li>
</ul></li>
<li><strong>Użyj Spearmana gdy:</strong>
<ul>
<li>Zmienne są porządkowe (dane rangowe)</li>
<li>Związek jest monotoniczny, ale nieliniowy</li>
<li>Dane zawierają wartości odstające</li>
<li>Rozkłady są skośne</li>
</ul></li>
</ul>
</section>
<section id="wizualizacja-wzorców-korelacji" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-wzorców-korelacji">Wizualizacja Wzorców Korelacji</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie przykładowych danych z różnymi wzorcami korelacji</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodatnia korelacja liniowa</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>lata_edukacji <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">14</span>, <span class="dv">3</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>roczny_dochod <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="sc">+</span> <span class="dv">3500</span> <span class="sc">*</span> lata_edukacji <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>pos_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(lata_edukacji, roczny_dochod), <span class="dv">3</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ujemna korelacja liniowa</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>czas_ekranu <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>godziny_snu <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> czas_ekranu <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>neg_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(czas_ekranu, godziny_snu), <span class="dv">3</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Brak korelacji</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>x_losowe <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>y_losowe <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>no_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(x_losowe, y_losowe), <span class="dv">3</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja nieliniowa (kwadratowa)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>godziny_nauki <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">12</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>wynik_testu <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> (godziny_nauki <span class="sc">-</span> <span class="dv">6</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">90</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>nonlin_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(godziny_nauki, wynik_testu), <span class="dv">3</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramek danych z wartościami korelacji</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>dane_dodatnie <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> lata_edukacji, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> roczny_dochod,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">etykieta =</span> <span class="fu">paste0</span>(<span class="st">"Liniowa Dodatnia (r = "</span>, pos_cor, <span class="st">")"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>dane_ujemne <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> czas_ekranu, </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> godziny_snu,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">etykieta =</span> <span class="fu">paste0</span>(<span class="st">"Liniowa Ujemna (r = "</span>, neg_cor, <span class="st">")"</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>dane_brak <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x_losowe, </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_losowe,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">etykieta =</span> <span class="fu">paste0</span>(<span class="st">"Brak Korelacji (r = "</span>, no_cor, <span class="st">")"</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>dane_nieliniowe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> godziny_nauki, </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> wynik_testu,</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">etykieta =</span> <span class="fu">paste0</span>(<span class="st">"Nieliniowa (Pearson r = "</span>, nonlin_cor, <span class="st">")"</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Łączenie danych</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>wszystkie_dane <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dane_dodatnie, dane_ujemne, dane_brak, dane_nieliniowe)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu wielopanelowego</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(wszystkie_dane, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> etykieta, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Różne Typy Korelacji"</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Linia regresji liniowej pokazana na czerwono z pasmem ufności"</span>,</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/correlation_types-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Ważna Uwaga:</strong> Panel w prawym dolnym rogu demonstruje, dlaczego korelacja Pearsona może być myląca dla związków nieliniowych. Pomimo wyraźnego wzorca, wartość <span class="math inline">r</span> Pearsona jest bliska zeru, ponieważ związek nie jest liniowy. W takich przypadkach bardziej odpowiednia byłaby korelacja Spearmana lub modelowanie nieliniowe.</p>
</section>
</section>
<section id="metody-obliczeń-ręcznych" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="metody-obliczeń-ręcznych"><span class="header-section-number">10.3</span> Metody Obliczeń Ręcznych</h2>
<p>Ta sekcja przedstawia krok po kroku procedury obliczeń ręcznych (na papierze) dla kowariancji i współczynników korelacji. Te ręczne obliczenia są niezbędne do zrozumienia konceptualnych podstaw tych miar.</p>
<section id="obliczanie-kowariancji-krok-po-kroku" class="level3">
<h3 class="anchored" data-anchor-id="obliczanie-kowariancji-krok-po-kroku">Obliczanie Kowariancji: Krok po Kroku</h3>
<p><strong>Przykład: Godziny Nauki Studentów vs.&nbsp;Wyniki Testów</strong></p>
<p>Dane:</p>
<ul>
<li>Godziny Nauki (X): 2, 4, 6, 8, 10</li>
<li>Wyniki Testów (Y): 65, 70, 80, 85, 95</li>
</ul>
<p><strong>Krok 1: Oblicz średnie</strong></p>
<p><span class="math display">\bar{x} = \frac{2+4+6+8+10}{5} = \frac{30}{5} = 6 \text{ godzin}</span></p>
<p><span class="math display">\bar{y} = \frac{65+70+80+85+95}{5} = \frac{395}{5} = 79 \text{ punktów}</span></p>
<p><strong>Krok 2: Oblicz odchylenia od średniej</strong></p>
<p>Dla X: <span class="math inline">(x_i - \bar{x})</span></p>
<ul>
<li><span class="math inline">2 - 6 = -4</span></li>
<li><span class="math inline">4 - 6 = -2</span></li>
<li><span class="math inline">6 - 6 = 0</span></li>
<li><span class="math inline">8 - 6 = 2</span></li>
<li><span class="math inline">10 - 6 = 4</span></li>
</ul>
<p>Dla Y: <span class="math inline">(y_i - \bar{y})</span></p>
<ul>
<li><span class="math inline">65 - 79 = -14</span></li>
<li><span class="math inline">70 - 79 = -9</span></li>
<li><span class="math inline">80 - 79 = 1</span></li>
<li><span class="math inline">85 - 79 = 6</span></li>
<li><span class="math inline">95 - 79 = 16</span></li>
</ul>
<p><strong>Krok 3: Oblicz iloczyny odchyleń</strong></p>
<p><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span>:</p>
<ul>
<li><span class="math inline">(-4)(-14) = 56</span></li>
<li><span class="math inline">(-2)(-9) = 18</span></li>
<li><span class="math inline">(0)(1) = 0</span></li>
<li><span class="math inline">(2)(6) = 12</span></li>
<li><span class="math inline">(4)(16) = 64</span></li>
</ul>
<p><strong>Krok 4: Zsumuj iloczyny</strong></p>
<p><span class="math display">\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y}) = 56 + 18 + 0 + 12 + 64 = 150</span></p>
<p><strong>Krok 5: Podziel przez <span class="math inline">(n-1)</span></strong></p>
<p><span class="math display">\text{cov}(X,Y) = \frac{150}{5-1} = \frac{150}{4} = 37,5</span></p>
<p><strong>Interpretacja:</strong> Dodatnia kowariancja (37,5) wskazuje, że godziny nauki i wyniki testów mają tendencję do wzrostu razem.</p>
</section>
<section id="obliczanie-korelacji-pearsona-krok-po-kroku" class="level3">
<h3 class="anchored" data-anchor-id="obliczanie-korelacji-pearsona-krok-po-kroku">Obliczanie Korelacji Pearsona: Krok po Kroku</h3>
<p>Używając tych samych danych o godzinach nauki, standaryzujemy teraz kowariancję, aby otrzymać współczynnik korelacji.</p>
<p><strong>Krok 1: Użyj kowariancji z powyższego przykładu</strong></p>
<p><span class="math display">\text{cov}(X,Y) = 37,5</span></p>
<p><strong>Krok 2: Oblicz sumy kwadratów odchyleń</strong></p>
<p>Dla X: <span class="math inline">\sum_{i=1}^n (x_i - \bar{x})^2</span></p>
<ul>
<li><span class="math inline">(-4)^2 = 16</span></li>
<li><span class="math inline">(-2)^2 = 4</span></li>
<li><span class="math inline">(0)^2 = 0</span></li>
<li><span class="math inline">(2)^2 = 4</span></li>
<li><span class="math inline">(4)^2 = 16</span></li>
<li><strong>Suma = 40</strong></li>
</ul>
<p>Dla Y: <span class="math inline">\sum_{i=1}^n (y_i - \bar{y})^2</span></p>
<ul>
<li><span class="math inline">(-14)^2 = 196</span></li>
<li><span class="math inline">(-9)^2 = 81</span></li>
<li><span class="math inline">(1)^2 = 1</span></li>
<li><span class="math inline">(6)^2 = 36</span></li>
<li><span class="math inline">(16)^2 = 256</span></li>
<li><strong>Suma = 570</strong></li>
</ul>
<p><strong>Krok 3: Oblicz próbkowe odchylenia standardowe</strong></p>
<p><span class="math display">s_X = \sqrt{\frac{\sum(x_i - \bar{x})^2}{n-1}} = \sqrt{\frac{40}{4}} = \sqrt{10} = 3,162</span></p>
<p><span class="math display">s_Y = \sqrt{\frac{\sum(y_i - \bar{y})^2}{n-1}} = \sqrt{\frac{570}{4}} = \sqrt{142,5} = 11,937</span></p>
<p><strong>Krok 4: Oblicz współczynnik korelacji</strong></p>
<p><span class="math display">r = \frac{\text{cov}(X,Y)}{s_X \cdot s_Y} = \frac{37,5}{3,162 \times 11,937} = \frac{37,5}{37,73} = 0,994</span></p>
<p><strong>Interpretacja:</strong> <span class="math inline">r = 0,994</span> wskazuje na niemal doskonały dodatni liniowy związek między godzinami nauki a wynikami testów.</p>
</section>
<section id="obliczanie-korelacji-spearmana-krok-po-kroku" class="level3">
<h3 class="anchored" data-anchor-id="obliczanie-korelacji-spearmana-krok-po-kroku">Obliczanie Korelacji Spearmana: Krok po Kroku</h3>
<p><strong>Przykład: Wyniki z Matematyki i Języka Angielskiego</strong></p>
<p>Dane surowe:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Wynik Matematyka</th>
<th>Wynik Angielski</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>78</td>
<td>82</td>
</tr>
<tr class="even">
<td>B</td>
<td>85</td>
<td>90</td>
</tr>
<tr class="odd">
<td>C</td>
<td>88</td>
<td>88</td>
</tr>
<tr class="even">
<td>D</td>
<td>92</td>
<td>94</td>
</tr>
<tr class="odd">
<td>E</td>
<td>95</td>
<td>96</td>
</tr>
</tbody>
</table>
<p><strong>Krok 1: Przypisz rangi każdej zmiennej osobno (od najniższej do najwyższej)</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Wynik Mat.</th>
<th>Ranga Mat.</th>
<th>Wynik Ang.</th>
<th>Ranga Ang.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>78</td>
<td>1</td>
<td>82</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>85</td>
<td>2</td>
<td>90</td>
<td>3</td>
</tr>
<tr class="odd">
<td>C</td>
<td>88</td>
<td>3</td>
<td>88</td>
<td>2</td>
</tr>
<tr class="even">
<td>D</td>
<td>92</td>
<td>4</td>
<td>94</td>
<td>4</td>
</tr>
<tr class="odd">
<td>E</td>
<td>95</td>
<td>5</td>
<td>96</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><strong>Krok 2: Oblicz różnice między rangami</strong></p>
<p><span class="math inline">d = \text{Ranga Matematyka} - \text{Ranga Angielski}</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Ranga Mat.</th>
<th>Ranga Ang.</th>
<th><span class="math inline">d</span></th>
<th><span class="math inline">d^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>3</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><strong>Suma:</strong></td>
<td><strong>2</strong></td>
</tr>
</tbody>
</table>
<p><strong>Krok 3: Zastosuj wzór Spearmana</strong></p>
<p><span class="math display">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)} = 1 - \frac{6 \times 2}{5(25-1)} = 1 - \frac{12}{120} = 1 - 0,1 = 0,9</span></p>
<p><strong>Interpretacja:</strong> <span class="math inline">\rho = 0,9</span> wskazuje na bardzo silny monotoniczny związek między wynikami z matematyki i angielskiego.</p>
</section>
</section>
<section id="weryfikacja-w-r-i-implementacja" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="weryfikacja-w-r-i-implementacja"><span class="header-section-number">10.4</span> Weryfikacja w R i Implementacja</h2>
<p>Ta sekcja dostarcza kod R do weryfikacji obliczeń ręcznych i demonstruje efektywne metody obliczeniowe dla analizy korelacji.</p>
<section id="weryfikacja-kowariancji" class="level3">
<h3 class="anchored" data-anchor-id="weryfikacja-kowariancji">Weryfikacja Kowariancji</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definicja danych</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>godziny_nauki <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>wyniki_testow <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie kowariancji używając R</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>cov_r <span class="ot">&lt;-</span> <span class="fu">cov</span>(godziny_nauki, wyniki_testow)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kowariancja (funkcja R):"</span>, <span class="fu">round</span>(cov_r, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kowariancja (funkcja R): 37.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie ręczne krok po kroku</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(godziny_nauki)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>y_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(wyniki_testow)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>x_odch <span class="ot">&lt;-</span> godziny_nauki <span class="sc">-</span> x_srednia</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>y_odch <span class="ot">&lt;-</span> wyniki_testow <span class="sc">-</span> y_srednia</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>iloczyny <span class="ot">&lt;-</span> x_odch <span class="sc">*</span> y_odch</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>cov_reczna <span class="ot">&lt;-</span> <span class="fu">sum</span>(iloczyny) <span class="sc">/</span> (<span class="fu">length</span>(godziny_nauki) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie szczegółowej tabeli obliczeń</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>tabela_obl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> godziny_nauki,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> wyniki_testow,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_odch =</span> x_odch,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_odch =</span> y_odch,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Iloczyn =</span> iloczyny</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabela_obl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y X_odch Y_odch Iloczyn
1  2 65     -4    -14      56
2  4 70     -2     -9      18
3  6 80      0      1       0
4  8 85      2      6      12
5 10 95      4     16      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Suma iloczynów:"</span>, <span class="fu">sum</span>(iloczyny))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suma iloczynów: 150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">n - 1 ="</span>, <span class="fu">length</span>(godziny_nauki) <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
n - 1 = 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Kowariancja (ręcznie):"</span>, <span class="fu">round</span>(cov_reczna, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Kowariancja (ręcznie): 37.5</code></pre>
</div>
</div>
</section>
<section id="weryfikacja-korelacji-pearsona" class="level3">
<h3 class="anchored" data-anchor-id="weryfikacja-korelacji-pearsona">Weryfikacja Korelacji Pearsona</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dane z przykładu ręcznego</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>godziny_nauki <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>wyniki_testow <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">95</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie korelacji Pearsona używając R</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>r_wartosc <span class="ot">&lt;-</span> <span class="fu">cor</span>(godziny_nauki, wyniki_testow, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja Pearsona (R):"</span>, <span class="fu">round</span>(r_wartosc, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja Pearsona (R): 0.993 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Szczegółowe obliczenie ręczne</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(godziny_nauki)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>y_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(wyniki_testow)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>x_odch <span class="ot">&lt;-</span> godziny_nauki <span class="sc">-</span> x_srednia</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>y_odch <span class="ot">&lt;-</span> wyniki_testow <span class="sc">-</span> y_srednia</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie kompleksowej tabeli obliczeń</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>tabela_szczeg <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> godziny_nauki,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> wyniki_testow,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_odch =</span> x_odch,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_odch =</span> y_odch,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X_odch_kw =</span> x_odch<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_odch_kw =</span> y_odch<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">Iloczyn =</span> x_odch <span class="sc">*</span> y_odch</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabela_szczeg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y X_odch Y_odch X_odch_kw Y_odch_kw Iloczyn
1  2 65     -4    -14        16       196      56
2  4 70     -2     -9         4        81      18
3  6 80      0      1         0         1       0
4  8 85      2      6         4        36      12
5 10 95      4     16        16       256      64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki podsumowujące</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statystyki Podsumowujące:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Statystyki Podsumowujące:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Suma (X - średnia_X)²:"</span>, <span class="fu">sum</span>(x_odch<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suma (X - średnia_X)²: 40</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Suma (Y - średnia_Y)²:"</span>, <span class="fu">sum</span>(y_odch<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suma (Y - średnia_Y)²: 570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Suma iloczynów:"</span>, <span class="fu">sum</span>(x_odch <span class="sc">*</span> y_odch))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suma iloczynów: 150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Odchylenie standardowe X:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(godziny_nauki), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Odchylenie standardowe X: 3.162</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odchylenie standardowe Y:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(wyniki_testow), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Odchylenie standardowe Y: 11.937</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Kowariancja:"</span>, <span class="fu">round</span>(<span class="fu">cov</span>(godziny_nauki, wyniki_testow), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Kowariancja: 37.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja:"</span>, <span class="fu">round</span>(r_wartosc, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja: 0.993</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test istotności statystycznej</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>test_cor <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(godziny_nauki, wyniki_testow, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Wyniki Testu Statystycznego:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Wyniki Testu Statystycznego:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Statystyka t:"</span>, <span class="fu">round</span>(test_cor<span class="sc">$</span>statistic, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Statystyka t: 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Wartość p:"</span>, <span class="fu">round</span>(test_cor<span class="sc">$</span>p.value, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Wartość p: 0.0006</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">95% Przedział Ufności: ["</span>, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(test_cor<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">","</span>, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(test_cor<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">"]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
95% Przedział Ufności: [ 0.899 , 1 ]</code></pre>
</div>
</div>
</section>
<section id="weryfikacja-korelacji-spearmana" class="level3">
<h3 class="anchored" data-anchor-id="weryfikacja-korelacji-spearmana">Weryfikacja Korelacji Spearmana</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dane z przykładu ręcznego</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>wyniki_mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">92</span>, <span class="dv">95</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>wyniki_ang <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">82</span>, <span class="dv">90</span>, <span class="dv">88</span>, <span class="dv">94</span>, <span class="dv">96</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie tabeli rangowej</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>tabela_rang <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wynik_Mat =</span> wyniki_mat,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ranga_Mat =</span> <span class="fu">rank</span>(wyniki_mat),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wynik_Ang =</span> wyniki_ang,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ranga_Ang =</span> <span class="fu">rank</span>(wyniki_ang)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>tabela_rang<span class="sc">$</span>d <span class="ot">&lt;-</span> tabela_rang<span class="sc">$</span>Ranga_Mat <span class="sc">-</span> tabela_rang<span class="sc">$</span>Ranga_Ang</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>tabela_rang<span class="sc">$</span>d_kwadrat <span class="ot">&lt;-</span> tabela_rang<span class="sc">$</span>d<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabela_rang)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Wynik_Mat Ranga_Mat Wynik_Ang Ranga_Ang  d d_kwadrat
1       A        78         1        82         1  0         0
2       B        85         2        90         3 -1         1
3       C        88         3        88         2  1         1
4       D        92         4        94         4  0         0
5       E        95         5        96         5  0         0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Suma d²:"</span>, <span class="fu">sum</span>(tabela_rang<span class="sc">$</span>d_kwadrat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suma d²: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie używając funkcji R</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>rho_r <span class="ot">&lt;-</span> <span class="fu">cor</span>(wyniki_mat, wyniki_ang, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja Spearmana (R):"</span>, <span class="fu">round</span>(rho_r, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja Spearmana (R): 0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja obliczeń ręcznych</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(wyniki_mat)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>rho_reczna <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">6</span> <span class="sc">*</span> <span class="fu">sum</span>(tabela_rang<span class="sc">$</span>d_kwadrat)) <span class="sc">/</span> (n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja Spearmana (ręcznie):"</span>, <span class="fu">round</span>(rho_reczna, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja Spearmana (ręcznie): 0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test statystyczny</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>test_spearman <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(wyniki_mat, wyniki_ang, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">Wartość p:"</span>, <span class="fu">round</span>(test_spearman<span class="sc">$</span>p.value, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Wartość p: 0.0833</code></pre>
</div>
</div>
</section>
</section>
<section id="ćwiczenia-praktyczne" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="ćwiczenia-praktyczne"><span class="header-section-number">10.5</span> Ćwiczenia Praktyczne</h2>
<section id="ćwiczenie-1-ręczne-obliczenie-kowariancji-i-korelacji-pearsona" class="level3">
<h3 class="anchored" data-anchor-id="ćwiczenie-1-ręczne-obliczenie-kowariancji-i-korelacji-pearsona">Ćwiczenie 1: Ręczne Obliczenie Kowariancji i Korelacji Pearsona</h3>
<p><strong>Dane: Temperatura i Sprzedaż Lodów</strong></p>
<ul>
<li>Temperatura (°F): 32, 50, 68, 86, 95</li>
<li>Sprzedaż Lodów ($): 100, 200, 400, 600, 800</li>
</ul>
<p><strong>Zadania:</strong></p>
<ol type="1">
<li>Oblicz kowariancję ręcznie</li>
<li>Oblicz współczynnik korelacji Pearsona ręcznie</li>
<li>Zinterpretuj wyniki</li>
</ol>
<p><strong>Rozwiązanie Ręczne:</strong></p>
<p><strong>Część 1: Kowariancja</strong></p>
<p>Krok 1: Oblicz średnie</p>
<p><span class="math display">\bar{x} = \frac{32 + 50 + 68 + 86 + 95}{5} = \frac{331}{5} = 66,2°F</span></p>
<p><span class="math display">\bar{y} = \frac{100 + 200 + 400 + 600 + 800}{5} = \frac{2100}{5} = 420 \text{ dolarów}</span></p>
<p>Krok 2: Oblicz odchylenia</p>
<p>Dla Temperatury: <span class="math inline">-34,2; -16,2; 1,8; 19,8; 28,8</span></p>
<p>Dla Sprzedaży: <span class="math inline">-320; -220; -20; 180; 380</span></p>
<p>Krok 3: Oblicz iloczyny</p>
<ul>
<li><span class="math inline">(-34,2)(-320) = 10944</span></li>
<li><span class="math inline">(-16,2)(-220) = 3564</span></li>
<li><span class="math inline">(1,8)(-20) = -36</span></li>
<li><span class="math inline">(19,8)(180) = 3564</span></li>
<li><span class="math inline">(28,8)(380) = 10944</span></li>
</ul>
<p>Krok 4: Zsumuj iloczyny i podziel</p>
<p><span class="math display">\text{cov}(X,Y) = \frac{10944 + 3564 + (-36) + 3564 + 10944}{4} = \frac{28980}{4} = 7245</span></p>
<p><strong>Część 2: Korelacja Pearsona</strong></p>
<p>Krok 1: Oblicz sumy kwadratów odchyleń</p>
<p>Dla Temperatury:</p>
<ul>
<li><span class="math inline">(-34,2)^2 = 1169,64</span></li>
<li><span class="math inline">(-16,2)^2 = 262,44</span></li>
<li><span class="math inline">(1,8)^2 = 3,24</span></li>
<li><span class="math inline">(19,8)^2 = 392,04</span></li>
<li><span class="math inline">(28,8)^2 = 829,44</span></li>
<li><strong>Suma = 2656,8</strong></li>
</ul>
<p>Dla Sprzedaży:</p>
<ul>
<li><span class="math inline">(-320)^2 = 102400</span></li>
<li><span class="math inline">(-220)^2 = 48400</span></li>
<li><span class="math inline">(-20)^2 = 400</span></li>
<li><span class="math inline">(180)^2 = 32400</span></li>
<li><span class="math inline">(380)^2 = 144400</span></li>
<li><strong>Suma = 328000</strong></li>
</ul>
<p>Krok 2: Oblicz odchylenia standardowe</p>
<p><span class="math display">s_X = \sqrt{\frac{2656,8}{4}} = \sqrt{664,2} = 25,77</span></p>
<p><span class="math display">s_Y = \sqrt{\frac{328000}{4}} = \sqrt{82000} = 286,36</span></p>
<p>Krok 3: Oblicz korelację</p>
<p><span class="math display">r = \frac{7245}{25,77 \times 286,36} = \frac{7245}{7380,14} = 0,982</span></p>
<p><strong>Interpretacja:</strong> Bardzo silna dodatnia korelacja (<span class="math inline">r = 0,982</span>) wskazuje, że wraz ze wzrostem temperatury, sprzedaż lodów rośnie proporcjonalnie. Kowariancja 7245 potwierdza ten dodatni związek, choć jej wielkość jest trudna do interpretacji bez standaryzacji.</p>
<p><strong>Weryfikacja w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dane</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">50</span>, <span class="dv">68</span>, <span class="dv">86</span>, <span class="dv">95</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>sprzedaz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">600</span>, <span class="dv">800</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Kowariancja</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kowariancja:"</span>, <span class="fu">round</span>(<span class="fu">cov</span>(temp, sprzedaz), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kowariancja: 7245 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Szczegółowa tabela obliczeń</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>temp_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>sprzedaz_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(sprzedaz)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>temp_odch <span class="ot">&lt;-</span> temp <span class="sc">-</span> temp_srednia</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>sprzedaz_odch <span class="ot">&lt;-</span> sprzedaz <span class="sc">-</span> sprzedaz_srednia</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>tabela_obl <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temperatura =</span> temp,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sprzedaz =</span> sprzedaz,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temp_odch =</span> temp_odch,</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sprzedaz_odch =</span> sprzedaz_odch,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Temp_odch_kw =</span> temp_odch<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sprzedaz_odch_kw =</span> sprzedaz_odch<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Iloczyn =</span> temp_odch <span class="sc">*</span> sprzedaz_odch</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabela_obl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Temperatura Sprzedaz Temp_odch Sprzedaz_odch Temp_odch_kw Sprzedaz_odch_kw
1          32      100     -34.2          -320      1169.64           102400
2          50      200     -16.2          -220       262.44            48400
3          68      400       1.8           -20         3.24              400
4          86      600      19.8           180       392.04            32400
5          95      800      28.8           380       829.44           144400
  Iloczyn
1   10944
2    3564
3     -36
4    3564
5   10944</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja Pearsona:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(temp, sprzedaz), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja Pearsona: 0.982</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odchylenie standardowe (Temp):"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(temp), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Odchylenie standardowe (Temp): 25.77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Odchylenie standardowe (Sprzedaż):"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(sprzedaz), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Odchylenie standardowe (Sprzedaż): 286.36</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>test_cor_zad1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(temp, sprzedaz)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Wartość p:"</span>, <span class="fu">format.pval</span>(test_cor_zad1<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Wartość p: 0.002962</code></pre>
</div>
</div>
</section>
<section id="ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana" class="level3">
<h3 class="anchored" data-anchor-id="ćwiczenie-2-ręczne-obliczenie-korelacji-spearmana">Ćwiczenie 2: Ręczne Obliczenie Korelacji Spearmana</h3>
<p><strong>Dane: Rangi Studentów w Matematyce i Fizyce</strong></p>
<p>Podane rangi (już uszeregowane od najniższego do najwyższego wyniku):</p>
<ul>
<li>Rangi studentów w Matematyce: 1, 3, 2, 5, 4</li>
<li>Rangi studentów w Fizyce: 2, 4, 1, 5, 3</li>
</ul>
<p><strong>Zadania:</strong></p>
<ol type="1">
<li>Oblicz współczynnik korelacji Spearmana ręcznie</li>
<li>Zinterpretuj wynik</li>
<li>Porównaj z korelacją Pearsona</li>
</ol>
<p><strong>Rozwiązanie Ręczne:</strong></p>
<p>Krok 1: Utwórz tabelę różnic</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Ranga Mat.</th>
<th>Ranga Fiz.</th>
<th><span class="math inline">d</span></th>
<th><span class="math inline">d^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>2</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>4</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>5</td>
<td>4</td>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td><strong>Suma:</strong></td>
<td><strong>4</strong></td>
</tr>
</tbody>
</table>
<p>Krok 2: Zastosuj wzór</p>
<p><span class="math display">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)} = 1 - \frac{6 \times 4}{5(25 - 1)} = 1 - \frac{24}{120} = 1 - 0,2 = 0,8</span></p>
<p><strong>Interpretacja:</strong> Korelacja Spearmana <span class="math inline">\rho = 0,8</span> wskazuje na silny dodatni monotoniczny związek między rangami w matematyce i fizyce. Studenci, którzy zajmują wyższą pozycję w matematyce, mają tendencję do zajmowania wyższej pozycji w fizyce.</p>
<p><strong>Weryfikacja w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rangi (dane już uszeregowane)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>ranga_mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>ranga_fiz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie tabeli</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> ranga_mat <span class="sc">-</span> ranga_fiz</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>d_kwadrat <span class="ot">&lt;-</span> d<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>tabela_rang <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ranga_Mat =</span> ranga_mat,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ranga_Fiz =</span> ranga_fiz,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> d,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_kwadrat =</span> d_kwadrat</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tabela_rang)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Ranga_Mat Ranga_Fiz  d d_kwadrat
1       1         1         2 -1         1
2       2         3         4 -1         1
3       3         2         1  1         1
4       4         5         5  0         0
5       5         4         3  1         1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenia</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ranga_mat)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>suma_d_kw <span class="ot">&lt;-</span> <span class="fu">sum</span>(d_kwadrat)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>rho_reczna <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">6</span> <span class="sc">*</span> suma_d_kw) <span class="sc">/</span> (n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Suma d²:"</span>, suma_d_kw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Suma d²: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">n(n² - 1) ="</span>, n <span class="sc">*</span> (n<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
n(n² - 1) = 120</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja Spearmana (ręcznie):"</span>, <span class="fu">round</span>(rho_reczna, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja Spearmana (ręcznie): 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja Spearmana (R):"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(ranga_mat, ranga_fiz, <span class="at">method =</span> <span class="st">"spearman"</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja Spearmana (R): 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie z Pearsonem (na rangach)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja Pearsona (na rangach):"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(ranga_mat, ranga_fiz, <span class="at">method =</span> <span class="st">"pearson"</span>), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja Pearsona (na rangach): 0.8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>test_spearman_zad2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(ranga_mat, ranga_fiz, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Wartość p:"</span>, <span class="fu">round</span>(test_spearman_zad2<span class="sc">$</span>p.value, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Wartość p: 0.1333</code></pre>
</div>
</div>
</section>
<section id="ćwiczenie-3-porównanie-pearsona-i-spearmana" class="level3">
<h3 class="anchored" data-anchor-id="ćwiczenie-3-porównanie-pearsona-i-spearmana">Ćwiczenie 3: Porównanie Pearsona i Spearmana</h3>
<p><strong>Dane: Godziny Nauki i Wyniki Egzaminu (z wartością odstającą)</strong></p>
<ul>
<li>Godziny Nauki: 2, 3, 4, 5, 20 (ostatnia wartość to obserwacja odstająca)</li>
<li>Wynik Egzaminu: 60, 65, 70, 75, 80</li>
</ul>
<p><strong>Zadania:</strong></p>
<ol type="1">
<li>Oblicz obie korelacje (Pearsona i Spearmana) ręcznie</li>
<li>Wyjaśnij, dlaczego wartości się różnią</li>
<li>Która miara jest tutaj bardziej odpowiednia?</li>
</ol>
<p><strong>Rozwiązanie Ręczne:</strong></p>
<p><strong>Część 1: Korelacja Pearsona</strong></p>
<p>Średnie: <span class="math inline">\bar{x} = 6,8</span>, <span class="math inline">\bar{y} = 70</span></p>
<p>Odchylenia i obliczenia:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>X</th>
<th>Y</th>
<th><span class="math inline">(x_i - \bar{x})</span></th>
<th><span class="math inline">(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
<th>Iloczyn</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>60</td>
<td>-4,8</td>
<td>-10</td>
<td>23,04</td>
<td>100</td>
<td>48</td>
</tr>
<tr class="even">
<td>3</td>
<td>65</td>
<td>-3,8</td>
<td>-5</td>
<td>14,44</td>
<td>25</td>
<td>19</td>
</tr>
<tr class="odd">
<td>4</td>
<td>70</td>
<td>-2,8</td>
<td>0</td>
<td>7,84</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>5</td>
<td>75</td>
<td>-1,8</td>
<td>5</td>
<td>3,24</td>
<td>25</td>
<td>-9</td>
</tr>
<tr class="odd">
<td>20</td>
<td>80</td>
<td>13,2</td>
<td>10</td>
<td>174,24</td>
<td>100</td>
<td>132</td>
</tr>
</tbody>
</table>
<p>Sumy: <span class="math inline">\sum(x - \bar{x})^2 = 222,8</span>, <span class="math inline">\sum(y - \bar{y})^2 = 250</span>, <span class="math inline">\sum \text{iloczynów} = 190</span></p>
<p><span class="math display">s_X = \sqrt{\frac{222,8}{4}} = 7,46, \quad s_Y = \sqrt{\frac{250}{4}} = 7,91</span></p>
<p><span class="math display">r = \frac{190/4}{7,46 \times 7,91} = \frac{47,5}{59,01} = 0,805</span></p>
<p><strong>Część 2: Korelacja Spearmana</strong></p>
<p>Rangi:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>X</th>
<th>Ranga(X)</th>
<th>Y</th>
<th>Ranga(Y)</th>
<th>d</th>
<th><span class="math inline">d^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>60</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>3</td>
<td>2</td>
<td>65</td>
<td>2</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>4</td>
<td>3</td>
<td>70</td>
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>5</td>
<td>4</td>
<td>75</td>
<td>4</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>20</td>
<td>5</td>
<td>80</td>
<td>5</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><span class="math display">\rho = 1 - \frac{6 \times 0}{5(24)} = 1 - 0 = 1,0</span></p>
<p><strong>Wyjaśnienie:</strong> Korelacja Pearsona (<span class="math inline">r = 0,805</span>) jest obniżona przez wartość odstającą (20 godzin), redukując siłę korelacji. Korelacja Spearmana (<span class="math inline">\rho = 1,0</span>) jest doskonała, ponieważ <strong>kolejność rang</strong> jest identyczna pomimo ekstremalnej wartości. Podejście rangowe jest odporne na wartości odstające.</p>
<p><strong>Która jest bardziej odpowiednia?</strong> Spearman jest bardziej odpowiedni tutaj, ponieważ:</p>
<ol type="1">
<li>Związek jest monotoniczny, ale potencjalnie nieliniowy</li>
<li>Wartość odstająca (20 godzin) zniekształca korelację Pearsona</li>
<li>Zależy nam bardziej na związku porządkowym niż na dokładnym dopasowaniu liniowym</li>
</ol>
<p><strong>Weryfikacja w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dane z wartością odstającą</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>godziny <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">20</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>wyniki <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obie korelacje</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>pearson_r <span class="ot">&lt;-</span> <span class="fu">cor</span>(godziny, wyniki, <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>spearman_rho <span class="ot">&lt;-</span> <span class="fu">cor</span>(godziny, wyniki, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja Pearsona:"</span>, <span class="fu">round</span>(pearson_r, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja Pearsona: 0.805</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Korelacja Spearmana:"</span>, <span class="fu">round</span>(spearman_rho, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Korelacja Spearmana: 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Różnica:"</span>, <span class="fu">round</span>(spearman_rho <span class="sc">-</span> pearson_r, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Różnica: 0.195</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pokazanie rang</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>porownanie_rang <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Godziny =</span> godziny,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ranga_Godziny =</span> <span class="fu">rank</span>(godziny),</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wyniki =</span> wyniki,</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ranga_Wyniki =</span> <span class="fu">rank</span>(wyniki)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(porownanie_rang)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Godziny Ranga_Godziny Wyniki Ranga_Wyniki
1       2             1     60            1
2       3             2     65            2
3       4             3     70            3
4       5             4     75            4
5      20             5     80            5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(godziny, wyniki, <span class="at">main =</span> <span class="st">"Dane Surowe"</span>, </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>, <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(wyniki <span class="sc">~</span> godziny), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">15</span>, <span class="dv">65</span>, <span class="fu">paste</span>(<span class="st">"Pearson r ="</span>, <span class="fu">round</span>(pearson_r, <span class="dv">3</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rank</span>(godziny), <span class="fu">rank</span>(wyniki), <span class="at">main =</span> <span class="st">"Dane Rangowe"</span>,</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Ranga (Godziny)"</span>, <span class="at">ylab =</span> <span class="st">"Ranga (Wyniki)"</span>,</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">rank</span>(wyniki) <span class="sc">~</span> <span class="fu">rank</span>(godziny)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="fu">paste</span>(<span class="st">"Spearman ρ ="</span>, <span class="fu">round</span>(spearman_rho, <span class="dv">3</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/exercise3_verification-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p><strong>Kluczowe Wnioski:</strong></p>
<ol type="1">
<li><p><strong>Kowariancja</strong> mierzy kierunek i siłę związku, ale jej wartość zależy od jednostek miary obu zmiennych—nie można porównywać kowariancji między różnymi parami zmiennych</p></li>
<li><p><strong>Korelacja Pearsona</strong> standaryzuje kowariancję do zakresu [-1, 1], mierząc siłę <strong>liniowego</strong> związku. Jest wrażliwa na wartości odstające i może być myląca przy związkach nieliniowych</p></li>
<li><p><strong>Korelacja Spearmana</strong> opiera się na rangach, mierząc <strong>monotoniczne</strong> związki (niekoniecznie liniowe). Jest odporna na wartości odstające i odpowiednia dla danych porządkowych</p></li>
<li><p><strong>Ręczne obliczenia</strong> są kluczowe dla zrozumienia, jak te miary są konstruowane—pokazują, że korelacja to zasadniczo standaryzowana średnia iloczynów odchyleń</p></li>
<li><p><strong>Wizualizacja jest niezbędna</strong>—wykres punktowy może ujawnić nieliniowość, wartości odstające lub brak związku, których same liczby nie pokażą</p></li>
<li><p><strong>Wybór miary</strong>: Używaj Pearsona dla związków liniowych między zmiennymi ciągłymi bez wartości odstających; używaj Spearmana dla danych rangowych, związków nieliniowych lub w obecności wartości odstających</p></li>
</ol>
<hr>
</section>
</section>
<section id="najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="najważniejsze-rzeczy-do-zapamiętania-important-points-to-remember"><span class="header-section-number">10.6</span> Najważniejsze rzeczy do zapamiętania <em>(Important Points to Remember)</em></h2>
<ol type="1">
<li><p><strong>Korelacja mierzy siłę związku:</strong> Wartości od -1 do +1.</p></li>
<li><p><strong>Korelacja ≠ przyczynowość (Correlation ≠ Causation):</strong> Wysoka korelacja nie dowodzi wpływu jednej zmiennej na drugą.</p></li>
<li><p><strong>Dobierz właściwą metodę:</strong></p>
<ul>
<li><strong>Pearson:</strong> Związki <strong>liniowe</strong> dla danych ciągłych.</li>
<li><strong>Spearman:</strong> Związki <strong>monotoniczne</strong> lub dane rangowe.</li>
</ul></li>
<li><p><strong>Sprawdź założenia:</strong></p>
<ul>
<li>Pearson: liniowość i (w praktyce) rozkład zbliżony do normalnego.</li>
<li>Spearman: wymagana jedynie monotoniczność.</li>
</ul></li>
<li><p><strong>Uwaga na obserwacje odstające (outliers):</strong> Mogą silnie wpływać na korelację Pearsona.</p></li>
<li><p><strong>Zawsze wizualizuj dane:</strong> Wykresy pomagają ocenić kształt zależności.</p></li>
</ol>
</section>
<section id="podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="podsumowanie-drzewko-decyzyjne-do-analizy-korelacji-summary-decision-tree-for-correlation-analysis"><span class="header-section-number">10.7</span> Podsumowanie: drzewko decyzyjne do analizy korelacji <em>(Summary: Decision Tree for Correlation Analysis)</em></h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
WYBÓR WŁAŚCIWEJ MIARY KORELACJI:

Czy dane są liczbowe (numeryczne)?
├─ TAK → Czy związek jest liniowy?
│   ├─ TAK → Użyj korelacji PEARSONA
│   └─ NIE → Czy związek jest monotoniczny?
│       ├─ TAK → Użyj korelacji SPEARMANA
│       └─ NIE → Rozważ metody nieliniowe
└─ NIE → Czy dane są porządkowe (rangi)?
    ├─ TAK → Użyj korelacji SPEARMANA
    └─ NIE → Użyj TABEL KRZYŻOWYCH dla danych kategorycznych (*)</code></pre>
</div>
</div>
<section id="ściąga-quick-reference-card" class="level3">
<h3 class="anchored" data-anchor-id="ściąga-quick-reference-card">Ściąga <em>(Quick Reference Card)</em></h3>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Miara</th>
<th>Kiedy używać <em>(Use When)</em></th>
<th>Wzór <em>(Formula)</em></th>
<th>Zakres <em>(Range)</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kowariancja (Covariance)</strong></td>
<td>Wstępne badanie związku</td>
<td><span class="math inline">\displaystyle \frac{\sum_{i=1}^n (x_i-\bar{x})(y_i-\bar{y})}{n-1}</span></td>
<td><span class="math inline">-\infty</span> do <span class="math inline">+\infty</span></td>
</tr>
<tr class="even">
<td><strong>Pearson</strong> <span class="math inline">r</span></td>
<td>Związki liniowe, dane ciągłe</td>
<td><span class="math inline">\displaystyle \frac{\operatorname{cov}(X,Y)}{s_X s_Y}</span></td>
<td><span class="math inline">-1</span> do <span class="math inline">+1</span></td>
</tr>
<tr class="odd">
<td><strong>Spearman</strong> <span class="math inline">\rho</span></td>
<td>Związki monotoniczne, rangi</td>
<td><span class="math inline">\displaystyle 1-\frac{6\sum d_i^2}{n(n^2-1)}</span></td>
<td><span class="math inline">-1</span> do <span class="math inline">+1</span></td>
</tr>
<tr class="even">
<td><strong>Tabele krzyżowe (Cross-tabs)</strong></td>
<td>Zmienne kategoryczne</td>
<td>Zliczenia częstości</td>
<td>n/d</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="wprowadzenie-do-modelowania-statystycznego-analizy-regresji-i-metody-mnk" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="wprowadzenie-do-modelowania-statystycznego-analizy-regresji-i-metody-mnk"><span class="header-section-number">10.8</span> Wprowadzenie do Modelowania Statystycznego, Analizy Regresji i Metody MNK</h2>
<section id="modele-deterministyczne-a-stochastyczne" class="level3">
<h3 class="anchored" data-anchor-id="modele-deterministyczne-a-stochastyczne">Modele Deterministyczne a Stochastyczne</h3>
<p>W naukach ścisłych i społecznych pracujemy z dwoma fundamentalnie różnymi typami modeli:</p>
<p><strong>Modele deterministyczne</strong> (ang. <em>deterministic models</em>) zakładają idealne, dokładne relacje bez żadnej losowości. Na przykład w fizyce:</p>
<p><span class="math display">d = v \cdot t</span></p>
<p>Jeśli prędkość (<span class="math inline">v</span>) wynosi 50 km/h, a czas (<span class="math inline">t</span>) wynosi 2 godziny, to odległość (<span class="math inline">d</span>) wynosi <strong>dokładnie</strong> 100 km. Bez wariacji (ang. <em>variation</em>), bez niepewności.</p>
<p><strong>Modele stochastyczne</strong> (ang. <em>stochastic models</em>) uznają, że relacje nie są idealne – zawierają losowość i niepewność. W naukach społecznych niemal zawsze pracujemy z modelami stochastycznymi, ponieważ:</p>
<ul>
<li>Ludzkie zachowanie jest złożone i zależy od wielu czynników</li>
<li>Nie możemy zmierzyć wszystkiego, co ma znaczenie</li>
<li>W procesach społecznych istnieje autentyczna losowość</li>
<li>Pomiar sam w sobie zawiera błędy (ang. <em>measurement errors</em>)</li>
</ul>
<p>Model stochastyczny zapisujemy jako:</p>
<p><span class="math display">Y_i = f(X_i) + \varepsilon_i</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">Y_i</span> to wynik (ang. <em>outcome</em>), który chcemy przewidzieć (np. frekwencja wyborcza)</li>
<li><span class="math inline">X_i</span> to nasza zmienna predykcyjna (ang. <em>predictor variable</em>) (np. PKB per capita)</li>
<li><span class="math inline">f(X_i)</span> to część systematyczna (ang. <em>systematic part</em>) – wzorzec, który możemy wyjaśnić</li>
<li><span class="math inline">\varepsilon_i</span> to część stochastyczna (ang. <em>stochastic part</em>) – błąd losowy (ang. <em>random error</em>) lub niewytłumaczona wariancja (ang. <em>unexplained variation</em>)</li>
</ul>
<p><strong>Przykład:</strong> Przewidywanie wyników egzaminów na podstawie godzin nauki. Nawet jeśli wiemy, że ktoś uczył się 5 godzin, nie możemy przewidzieć dokładnego wyniku – może miał zły dzień, może materiał był dla niego szczególnie trudny, może jest naturalnie utalentowany. Najlepsze, co możemy zrobić, to przewidzieć <strong>średni</strong> wynik dla osób, które uczyły się 5 godzin, uznając, że będzie wariancja wokół tej średniej.</p>
<p>Kluczowy wniosek: staramy się modelować <strong>systematyczną relację</strong> (ang. <em>systematic relationship</em>), jednocześnie uznając, że <strong>idealna predykcja jest niemożliwa</strong>.</p>
</section>
<section id="wizualizacja-relacji-wykresy-rozrzutu-i-typy-wzorców" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-relacji-wykresy-rozrzutu-i-typy-wzorców">Wizualizacja Relacji: Wykresy Rozrzutu i Typy Wzorców</h3>
<p>Zanim dopasujemy jakikolwiek model, zawsze powinniśmy wizualizować nasze dane. <strong>Wykres rozrzutu</strong> (ang. <em>scatterplot</em>) przedstawia relację między dwiema zmiennymi. Różne zbiory danych mogą pokazywać bardzo różne wzorce:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Silna dodatnia relacja liniowa</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Silna Dodatnia Liniowa"</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Słaba dodatnia relacja liniowa</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2, y2, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Słaba Dodatnia Liniowa"</span>,</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Ujemna relacja liniowa</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x3, y3, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Ujemna Liniowa"</span>,</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Relacja krzywoliniowa (kwadratowa)</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x4 <span class="sc">-</span> <span class="fl">0.3</span><span class="sc">*</span>x4<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x4, y4, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Krzywoliniowa (Kwadratowa)"</span>,</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Brak relacji</span></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>y5 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">30</span>, <span class="dv">8</span>)</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x5, y5, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Brak Relacji"</span>,</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Relacja nieliniowa (wykładnicza)</span></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>y6 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.35</span><span class="sc">*</span>x6) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x6, y6, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Nieliniowa (Wykładnicza)"</span>,</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-relationship-types" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-relationship-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-relationship-types-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-relationship-types-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.1: Różne typy relacji między zmiennymi
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Dlaczego skupiamy się na relacjach liniowych?</strong></p>
<p>Relacje liniowe (ang. <em>linear relationships</em>) są naszym punktem wyjścia z kilku powodów:</p>
<ul>
<li>Wiele rzeczywistych relacji jest w przybliżeniu liniowych (przynajmniej w ograniczonym zakresie)</li>
<li>Modele liniowe (ang. <em>linear models</em>) są proste, interpretowalny i matematycznie przystępne</li>
<li>Służą jako punkt odniesienia (ang. <em>baseline</em>) – jeśli model liniowy nie pasuje dobrze, wiemy, że potrzebujemy czegoś bardziej złożonego</li>
<li>Wiele relacji nieliniowych można przekształcić do postaci liniowej (np. transformacje logarytmiczne)</li>
</ul>
<p><strong>Ważne:</strong> Jeśli wykres rozrzutu pokazuje wyraźny wzorzec krzywoliniowy (ang. <em>curvilinear pattern</em>) lub nieliniowy (ang. <em>non-linear pattern</em>), linia prosta będzie słabo dopasowana. Zawsze najpierw sprawdzaj dane!</p>
</section>
<section id="prosty-przykład-godziny-nauki-i-wyniki-egzaminów" class="level3">
<h3 class="anchored" data-anchor-id="prosty-przykład-godziny-nauki-i-wyniki-egzaminów">Prosty Przykład: Godziny Nauki i Wyniki Egzaminów</h3>
<p>W dalszej części tej sekcji będziemy pracować ze zbiorem danych, który pokazuje w przybliżeniu liniową relację:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generujemy przykładowe dane</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>exam_scores <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> study_hours <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzymy wykres rozrzutu</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores,</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Wykres Rozrzutu: Godziny Nauki vs. Wyniki Egzaminów"</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter-example" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-scatter-example-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.2: Relacja między godzinami nauki a wynikami egzaminów
</figcaption>
</figure>
</div>
</div>
</div>
<p>Na tym wykresie rozrzutu możemy zauważyć ogólną <strong>dodatnią relację liniową</strong> (ang. <em>positive linear relationship</em>): studenci, którzy uczą się więcej, zwykle osiągają wyższe wyniki. Ale relacja nie jest idealna – jest rozproszenie (ang. <em>scatter</em>) wokół jakiejkolwiek wyimaginowanej linii, którą moglibyśmy narysować przez punkty.</p>
</section>
<section id="idea-linii-najlepszego-dopasowania" class="level3">
<h3 class="anchored" data-anchor-id="idea-linii-najlepszego-dopasowania">Idea Linii “Najlepszego Dopasowania”</h3>
<p>Patrząc na wykres rozrzutu, możemy chcieć podsumować relację prostą linią. Ale którą linią? Możemy narysować nieskończenie wiele linii. Potrzebujemy kryterium (ang. <em>criterion</em>), które określi, co czyni linię “najlepszą”.</p>
<p><strong>Linia regresji</strong> (ang. <em>regression line</em>) lub “linia najlepszego dopasowania” (ang. <em>best fit line</em>) to linia, która minimalizuje sumę kwadratów błędów (SSE). Zrozummy to krok po kroku.</p>
<p>Jeśli proponujemy linię z równaniem <span class="math inline">\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_i</span>, to dla każdej obserwacji <span class="math inline">i</span> możemy obliczyć:</p>
<ul>
<li><strong>Wartość przewidywaną</strong> (ang. <em>predicted value</em>): <span class="math inline">\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_i</span></li>
<li><strong>Resztę</strong> (ang. <em>residual</em>) lub błąd (ang. <em>error</em>): <span class="math inline">e_i = Y_i - \hat{Y}_i</span></li>
</ul>
<p>Reszta to pionowa odległość między rzeczywistym punktem a naszą linią. <strong>Suma kwadratów błędów</strong> (SSE, ang. <em>Sum of Squared Errors</em>) wynosi:</p>
<p><span class="math display">SSE = \sum_{i=1}^{n} e_i^2 = \sum_{i=1}^{n} (Y_i - \hat{Y}_i)^2</span></p>
<p>Podnosimy błędy do kwadratu z dwóch powodów:</p>
<ol type="1">
<li>Dodatnie i ujemne błędy się nie znoszą</li>
<li>Większe błędy są bardziej karane (błąd 4-jednostkowy liczy się jako 16 w SSE, podczas gdy dwa błędy 2-jednostkowe liczą się jako 8)</li>
</ol>
</section>
<section id="wizualizacja-różnych-linii-i-ich-sse" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-różnych-linii-i-ich-sse">Wizualizacja Różnych Linii i Ich SSE</h3>
<p>Zobaczmy, jak SSE zmienia się dla różnych linii:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wypróbujmy trzy różne linie</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Linia 1: Za płaska</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>, <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Linia 1: Za Płaska (nachylenie = 2)"</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">55</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>pred1 <span class="ot">&lt;-</span> <span class="dv">55</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> study_hours</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>sse1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((exam_scores <span class="sc">-</span> pred1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2</span>, <span class="dv">90</span>, <span class="fu">paste</span>(<span class="st">"SSE ="</span>, <span class="fu">round</span>(sse1, <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Linia 2: Za stroma</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>, <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Linia 2: Za Stroma (nachylenie = 6)"</span>)</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">45</span>, <span class="at">b =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>pred2 <span class="ot">&lt;-</span> <span class="dv">45</span> <span class="sc">+</span> <span class="dv">6</span> <span class="sc">*</span> study_hours</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>sse2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((exam_scores <span class="sc">-</span> pred2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2</span>, <span class="dv">90</span>, <span class="fu">paste</span>(<span class="st">"SSE ="</span>, <span class="fu">round</span>(sse2, <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">"orange"</span>)</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Linia 3: Linia MNK (najlepsze dopasowanie)</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>, <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Linia 3: Linia MNK (Najlepsze Dopasowanie)"</span>)</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>sse3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">2</span>, <span class="dv">90</span>, <span class="fu">paste</span>(<span class="st">"SSE ="</span>, <span class="fu">round</span>(sse3, <span class="dv">1</span>)), <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja reszt dla linii MNK</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>, <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Linia MNK z Resztami"</span>)</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>pred3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(study_hours, exam_scores, study_hours, pred3, </span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sse-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sse-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-sse-comparison-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sse-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.3: Porównanie różnych linii i ich wartości SSE
</figcaption>
</figure>
</div>
</div>
</div>
<p>Zauważ, że linia MNK ma <strong>najmniejsze SSE</strong> – to właśnie czyni ją linią “najlepszego” dopasowania (ang. <em>best fit</em>).</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Konwencje notacji w regresji
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Model populacyjny (nieznane, prawdziwe parametry):</strong></p>
<p><span class="math display">Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i</span></p>
<p>gdzie <span class="math inline">\beta_0, \beta_1</span> to parametry populacji, a <span class="math inline">\varepsilon_i</span> to składnik losowy.</p>
<p><strong>Dopasowana linia regresji (estymatory z próby):</strong></p>
<p><span class="math display">\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_i</span></p>
<p>gdzie <span class="math inline">\hat{\beta}_0, \hat{\beta}_1</span> to estymatory MNK parametrów.</p>
<p><strong>Notacja alternatywna:</strong> Niektóre podręczniki używają <span class="math inline">b_0, b_1</span> dla estymatorów zamiast <span class="math inline">\hat{\beta}_0, \hat{\beta}_1</span>, aby uniknąć nadmiaru symboli z daszkiem.</p>
<p><strong>Reszty (residua):</strong></p>
<p><span class="math display">e_i = Y_i - \hat{Y}_i = Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i</span></p>
<p><strong>Suma kwadratów reszt (SSE):</strong></p>
<p><span class="math display">SSE = \sum_{i=1}^{n} e_i^2 = \sum_{i=1}^{n}(Y_i - \hat{Y}_i)^2 = \sum_{i=1}^{n}(Y_i - \hat{\beta}_0 - \hat{\beta}_1 X_i)^2</span></p>
<p><strong>Kluczowe rozróżnienie:</strong> Daszek (<span class="math inline">\hat{~}</span>) oznacza estymator z próby; brak daszka oznacza parametr populacji.</p>
</div>
</div>
<hr>
</section>
<section id="model-zerowy-przewidywanie-ze-średniej" class="level3">
<h3 class="anchored" data-anchor-id="model-zerowy-przewidywanie-ze-średniej">Model Zerowy: Przewidywanie ze Średniej</h3>
<p>Zanim wprowadzimy predyktory, rozważmy najprostszy możliwy model: przewidywanie tej samej wartości dla wszystkich. Jaką wartość powinniśmy przewidzieć?</p>
<p><strong>Model zerowy</strong> (ang. <em>zero model</em> lub <em>intercept-only model</em>) przewiduje średnią dla wszystkich obserwacji:</p>
<p><span class="math display">\hat{Y}_i = \bar{Y}</span></p>
<p>Może się to wydawać bezużyteczne, ale służy jako <strong>punkt odniesienia</strong> (ang. <em>baseline</em>) do porównania. Każdy predyktor, który dodamy, powinien działać lepiej niż samo zgadywanie średniej.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>, <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Model Zerowy: Przewidywanie Średniej dla Wszystkich"</span>)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>mean_score <span class="ot">&lt;-</span> <span class="fu">mean</span>(exam_scores)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> mean_score, <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">5</span>, mean_score <span class="sc">+</span> <span class="dv">5</span>, <span class="fu">paste</span>(<span class="st">"Średnia ="</span>, <span class="fu">round</span>(mean_score, <span class="dv">1</span>)), </span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"purple"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-zero-model" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zero-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-zero-model-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zero-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.4: Model zerowy: przewidywanie średniej dla wszystkich
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="dekompozycja-wariancji-jak-dobry-jest-nasz-model" class="level3">
<h3 class="anchored" data-anchor-id="dekompozycja-wariancji-jak-dobry-jest-nasz-model">Dekompozycja Wariancji: Jak Dobry Jest Nasz Model?</h3>
<p>Teraz pojawia się kluczowe pytanie: czy włączenie <span class="math inline">X</span> (godziny nauki) poprawia nasze predykcje w porównaniu z modelem zerowym?</p>
<p>Możemy rozłożyć <strong>całkowitą wariancję</strong> (ang. <em>total variance</em>) w <span class="math inline">Y</span> na dwie części:</p>
<ol type="1">
<li><strong>Wariancja wyjaśniona</strong> (ang. <em>explained variance</em>): zmienność uchwycona przez nasz model</li>
<li><strong>Wariancja niewyjaśniona</strong> (ang. <em>unexplained variance</em>): zmienność rezydualna (ang. <em>residual variation</em>) – to, czego nasz model nie wyjaśnia</li>
</ol>
<p>Matematycznie, dla każdej obserwacji:</p>
<p><span class="math display">\underbrace{Y_i - \bar{Y}}_{\text{Całkowite odchylenie (total deviation)}} = \underbrace{\hat{Y}_i - \bar{Y}}_{\text{Odchylenie wyjaśnione (explained deviation)}} + \underbrace{Y_i - \hat{Y}_i}_{\text{Reszta (residual)}}</span></p>
<p>Podnosząc do kwadratu i sumując po wszystkich obserwacjach:</p>
<p><span class="math display">\underbrace{\sum (Y_i - \bar{Y})^2}_{\text{Całkowita Suma Kwadratów (SST)}} = \underbrace{\sum (\hat{Y}_i - \bar{Y})^2}_{\text{Suma Kwadratów Regresji (SSR)}} + \underbrace{\sum (Y_i - \hat{Y}_i)^2}_{\text{Suma Kwadratów Błędów (SSE)}}</span></p>
<p>Gdzie:</p>
<ul>
<li>SST = <em>Total Sum of Squares</em></li>
<li>SSR = <em>Regression Sum of Squares</em></li>
<li>SSE = <em>Sum of Squared Errors</em></li>
</ul>
<p>Lub bardziej zwięźle:</p>
<p><span class="math display">SST = SSR + SSE</span></p>
<p><strong>Przykład obliczeń ręcznych:</strong></p>
<p>Załóżmy, że mamy pięciu studentów:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Godziny Nauki (<span class="math inline">X</span>)</th>
<th>Wynik Egzaminu (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>60</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>73</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>71</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>86</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>90</td>
</tr>
</tbody>
</table>
<p><strong>Krok 1:</strong> Obliczamy średnią: <span class="math inline">\bar{Y} = \frac{60 + 73 + 71 + 86 + 90}{5} = 76</span></p>
<p><strong>Krok 2:</strong> Obliczamy <span class="math inline">\bar{X} = \frac{2 + 4 + 6 + 8 + 10}{5} = 6</span></p>
<p><strong>Krok 3:</strong> Dopasowujemy linię MNK (pokażemy wzór poniżej):</p>
<p>Najpierw obliczamy nachylenie (ang. <em>slope</em>):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 31%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>60</td>
<td>-4</td>
<td>-16</td>
<td>64</td>
<td>16</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>73</td>
<td>-2</td>
<td>-3</td>
<td>6</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>71</td>
<td>0</td>
<td>-5</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>86</td>
<td>2</td>
<td>10</td>
<td>20</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>90</td>
<td>4</td>
<td>14</td>
<td>56</td>
<td>16</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>Suma = 146</strong></td>
<td><strong>Suma = 40</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\hat{\beta}_1 = \frac{146}{40} = 3.65</span></p>
<p><span class="math display">\hat{\beta}_0 = 76 - 3.65 \times 6 = 76 - 21.9 = 54.1</span></p>
<p>Zatem nasza linia regresji to: <span class="math inline">\hat{Y}_i = 54.1 + 3.65X_i</span></p>
<p><strong>Krok 4:</strong> Obliczamy predykcje (ang. <em>predictions</em>) i komponenty wariancji:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\bar{Y}</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">\hat{Y}_i - \bar{Y}</span></th>
<th><span class="math inline">Y_i - \hat{Y}_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>60</td>
<td>76</td>
<td>61.4</td>
<td>-16</td>
<td>-14.6</td>
<td>-1.4</td>
</tr>
<tr class="even">
<td>2</td>
<td>73</td>
<td>76</td>
<td>68.7</td>
<td>-3</td>
<td>-7.3</td>
<td>4.3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>71</td>
<td>76</td>
<td>76.0</td>
<td>-5</td>
<td>0.0</td>
<td>-5.0</td>
</tr>
<tr class="even">
<td>4</td>
<td>86</td>
<td>76</td>
<td>83.3</td>
<td>10</td>
<td>7.3</td>
<td>2.7</td>
</tr>
<tr class="odd">
<td>5</td>
<td>90</td>
<td>76</td>
<td>90.6</td>
<td>14</td>
<td>14.6</td>
<td>-0.6</td>
</tr>
</tbody>
</table>
<p><strong>Krok 5:</strong> Sumy kwadratów:</p>
<ul>
<li><span class="math inline">SST = (-16)^2 + (-3)^2 + (-5)^2 + 10^2 + 14^2 = 256 + 9 + 25 + 100 + 196 = 586</span></li>
<li><span class="math inline">SSR = (-14.6)^2 + (-7.3)^2 + 0^2 + 7.3^2 + 14.6^2 = 213.16 + 53.29 + 0 + 53.29 + 213.16 = 532.9</span></li>
<li><span class="math inline">SSE = (-1.4)^2 + 4.3^2 + (-5.0)^2 + 2.7^2 + (-0.6)^2 = 1.96 + 18.49 + 25 + 7.29 + 0.36 = 53.1</span></li>
</ul>
<p>Sprawdzenie: <span class="math inline">532.9 + 53.1 = 586</span> ✓</p>
</section>
<section id="znajdowanie-współczynników-mnk-minimalizacja-sse" class="level3">
<h3 class="anchored" data-anchor-id="znajdowanie-współczynników-mnk-minimalizacja-sse">Znajdowanie Współczynników MNK: Minimalizacja SSE</h3>
<p><strong>Metoda Najmniejszych Kwadratów</strong> (MNK, ang. <em>Ordinary Least Squares</em>, OLS) znajduje współczynniki <span class="math inline">\hat{\beta}_0</span> (wyraz wolny, ang. <em>intercept</em>) i <span class="math inline">\hat{\beta}_1</span> (nachylenie, ang. <em>slope</em>), które minimalizują SSE.</p>
<p>Dla prostej regresji liniowej (ang. <em>simple linear regression</em>) <span class="math inline">Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i</span>, estymatory MNK (ang. <em>OLS estimators</em>) to:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum_{i=1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{\sum_{i=1}^{n} (X_i - \bar{X})^2} = \frac{Cov(X, Y)}{Var(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X}</span></p>
<p>Pokazaliśmy już to obliczenie w poprzedniej sekcji. Kluczowy wniosek to:</p>
<ul>
<li><span class="math inline">\hat{\beta}_1</span> mierzy <strong>średnią zmianę <span class="math inline">Y</span> na jednostkę zmiany <span class="math inline">X</span></strong></li>
<li><span class="math inline">\hat{\beta}_0</span> to <strong>przewidywana wartość <span class="math inline">Y</span>, gdy <span class="math inline">X = 0</span></strong></li>
</ul>
<p><strong>Interpretacja naszego przykładu:</strong> <span class="math inline">\hat{Y}_i = 54.1 + 3.65X_i</span></p>
<p>Każda dodatkowa godzina nauki jest związana ze wzrostem wyniku egzaminu o 3.65 punktu. Student, który w ogóle się nie uczy (<span class="math inline">X = 0</span>), uzyskałby przewidywany wynik 54.1 punktu (chociaż ta ekstrapolacja może nie być sensowna).</p>
</section>
<section id="ocena-jakości-modelu-r-kwadrat" class="level3">
<h3 class="anchored" data-anchor-id="ocena-jakości-modelu-r-kwadrat">Ocena Jakości Modelu: R-kwadrat</h3>
<p><strong>R-kwadrat</strong> (<span class="math inline">R^2</span>, współczynnik determinacji, ang. <em>coefficient of determination</em>) mówi nam, jaka proporcja wariancji w <span class="math inline">Y</span> jest wyjaśniona przez nasz model:</p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>Z naszego przykładu: <span class="math inline">R^2 = \frac{532.9}{586} = 0.909</span> lub <span class="math inline">1 - \frac{53.1}{586} = 0.909</span></p>
<p><strong>Interpretacja:</strong> 90.9% wariancji w wynikach egzaminów jest wyjaśnione przez godziny nauki. Nasz model działa dobrze, chociaż wciąż jest około 9% wariancji, która pozostaje niewyjaśniona – prawdopodobnie z powodu innych czynników, takich jak naturalne zdolności, lęk przed testem, jakość nauki lub wcześniejsza wiedza.</p>
<p>Właściwości <span class="math inline">R^2</span>:</p>
<ul>
<li>Zakres od 0 do 1</li>
<li><span class="math inline">R^2 = 0</span>: model nie lepszy niż przewidywanie średniej</li>
<li><span class="math inline">R^2 = 1</span>: idealne predykcje (wszystkie punkty na linii)</li>
<li>Wyższe <span class="math inline">R^2</span> oznacza lepsze dopasowanie (ang. <em>better fit</em>), ale nie gwarantuje związku przyczynowego ani dobrych predykcji poza próbą (ang. <em>out of sample</em>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Wysokie R-kwadrat</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Wysokie R² ="</span>, </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span> x1))<span class="sc">$</span>r.squared, <span class="dv">2</span>)))</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y1 <span class="sc">~</span> x1), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Średnie R-kwadrat</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y2, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Średnie R² ="</span>, </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y2 <span class="sc">~</span> x1))<span class="sc">$</span>r.squared, <span class="dv">2</span>)))</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y2 <span class="sc">~</span> x1), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Niskie R-kwadrat</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">30</span>)</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y3, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Niskie R² ="</span>, </span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y3 <span class="sc">~</span> x1))<span class="sc">$</span>r.squared, <span class="dv">2</span>)))</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y3 <span class="sc">~</span> x1), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-rsquared-examples" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rsquared-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-rsquared-examples-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rsquared-examples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.5: Różne wartości R-kwadrat
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="ocena-jakości-modelu-rmse" class="level3">
<h3 class="anchored" data-anchor-id="ocena-jakości-modelu-rmse">Ocena Jakości Modelu: RMSE</h3>
<p>Podczas gdy <span class="math inline">R^2</span> jest niezależne od skali, <strong>pierwiastek błędu średniokwadratowego</strong> (RMSE, ang. <em>Root Mean Squared Error</em>) podaje nam średni błąd predykcji (ang. <em>prediction error</em>) w oryginalnych jednostkach:</p>
<p><span class="math display">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(Y_i - \hat{Y}_i)^2}{n}}</span></p>
<p>Z naszego przykładu: <span class="math inline">RMSE = \sqrt{\frac{53.1}{5}} = \sqrt{10.62} = 3.26</span> punktów</p>
<p><strong>Interpretacja:</strong> Średnio nasze predykcje są błędne o około 3.3 punktu.</p>
<p>RMSE jest użyteczne do:</p>
<ul>
<li>Porównywania modeli dla tej samej zmiennej wynikowej</li>
<li>Zrozumienia dokładności predykcji (ang. <em>prediction accuracy</em>) w znaczących jednostkach</li>
<li>Karania dużych błędów (jak SSE)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczamy RMSE</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RMSE:"</span>, <span class="fu">round</span>(rmse, <span class="dv">2</span>), <span class="st">"punktów</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RMSE: 7.37 punktów</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-kwadrat:"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-kwadrat: 0.743 </code></pre>
</div>
</div>
</section>
<section id="interpretacja-modelu-wielkość-efektu-i-diagnostyka" class="level3">
<h3 class="anchored" data-anchor-id="interpretacja-modelu-wielkość-efektu-i-diagnostyka">Interpretacja Modelu, Wielkość Efektu i Diagnostyka</h3>
<p>Po dopasowaniu (ang. <em>fitting</em>) modelu regresji musimy wyjść poza <span class="math inline">R^2</span> i RMSE, aby zrozumieć, co nasz model nam mówi. Obejmuje to trzy kluczowe zadania: interpretację współczynników merytorycznie (ang. <em>substantive interpretation</em>), ocenę wielkości efektów (ang. <em>effect sizes</em>) i sprawdzanie potencjalnych problemów poprzez diagnostykę (ang. <em>diagnostics</em>).</p>
<section id="interpretacja-współczynników-regresji" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja-współczynników-regresji">Interpretacja Współczynników Regresji</h4>
<p>Współczynnik nachylenia <span class="math inline">\hat{\beta}_1</span> ma specyficzną interpretację:</p>
<blockquote class="blockquote">
<p>Wzrost <span class="math inline">X</span> o jedną jednostkę jest związany ze zmianą <span class="math inline">Y</span> o <span class="math inline">\hat{\beta}_1</span> jednostek, średnio.</p>
</blockquote>
<p>Dla naszego przykładu (<span class="math inline">\hat{Y}_i = 54.1 + 3.65X_i</span>):</p>
<ul>
<li><strong>Interpretacja nachylenia</strong>: Każda dodatkowa godzina nauki jest związana ze wzrostem wyniku egzaminu o 3.65 punktu, średnio.</li>
<li><strong>Interpretacja wyrazu wolnego</strong>: Student z zerowymi godzinami nauki otrzymałby przewidywany wynik 54.1 punktu (chociaż może to obejmować ekstrapolację (ang. <em>extrapolation</em>) poza zakres danych).</li>
</ul>
<p><strong>Ważne uwagi:</strong></p>
<ul>
<li>Współczynnik opisuje <strong>związek</strong> (ang. <em>association</em>), niekoniecznie <strong>przyczynowość</strong> (ang. <em>causation</em>)</li>
<li>Relacja jest <strong>liniowa</strong> – zakładamy, że efekt jest stały w całym zakresie <span class="math inline">X</span></li>
<li>Efekt jest <strong>średni</strong> – indywidualni studenci mogą się różnić</li>
</ul>
<p><strong>Przykład praktycznej interpretacji:</strong></p>
<p>Jeśli uczysz się 3 godziny vs.&nbsp;6 godzin (różnica 3 godzin), przewidywana różnica wyniku to:</p>
<p><span class="math display">3 \times 3.65 = 10.95 \text{ punktów}</span></p>
<p>To daje nam praktyczne poczucie wielkości relacji (ang. <em>magnitude of the relationship</em>).</p>
</section>
<section id="wielkość-efektu-współczynniki-standaryzowane" class="level4">
<h4 class="anchored" data-anchor-id="wielkość-efektu-współczynniki-standaryzowane">Wielkość Efektu: Współczynniki Standaryzowane</h4>
<p>Przy porównywaniu efektów między różnymi zmiennymi lub badaniami, surowe współczynniki (ang. <em>raw coefficients</em>) mogą być mylące, ponieważ zależą od jednostek pomiaru (ang. <em>units of measurement</em>). Czy wzrost o 3.65 punktu na godzinę jest “duży” czy “mały”?</p>
<p><strong>Współczynniki standaryzowane</strong> (współczynniki beta, ang. <em>standardized coefficients</em> lub <em>beta coefficients</em>) wyrażają efekt w jednostkach odchylenia standardowego (ang. <em>standard deviation units</em>):</p>
<p><span class="math display">\hat{\beta}_1^{*} = \hat{\beta}_1 \times \frac{SD_X}{SD_Y}</span></p>
<p>To mówi nam: wzrost <span class="math inline">X</span> o jedno odchylenie standardowe jest związany ze zmianą <span class="math inline">Y</span> o <span class="math inline">\hat{\beta}_1^{*}</span> odchylenia standardowego.</p>
<p><strong>Obliczenie ręczne dla naszego przykładu:</strong></p>
<p>Najpierw obliczamy odchylenia standardowe:</p>
<ul>
<li><span class="math inline">SD_X = \sqrt{\frac{\sum(X_i - \bar{X})^2}{n-1}} = \sqrt{\frac{40}{4}} = \sqrt{10} = 3.16</span> godzin</li>
<li><span class="math inline">SD_Y = \sqrt{\frac{\sum(Y_i - \bar{Y})^2}{n-1}} = \sqrt{\frac{586}{4}} = \sqrt{146.5} = 12.10</span> punktów</li>
</ul>
<p>Następnie:</p>
<p><span class="math display">\hat{\beta}_1^{*} = 3.65 \times \frac{3.16}{12.10} = 3.65 \times 0.261 = 0.953</span></p>
<p><strong>Interpretacja:</strong> Wzrost godzin nauki o jedno odchylenie standardowe (około 3.2 godziny) jest związany ze wzrostem wyników egzaminów o 0.953 odchylenia standardowego (około 11.5 punktu).</p>
<p><strong>Zasada kciuka dla wielkości efektów:</strong></p>
<ul>
<li>Mały efekt (ang. <em>small effect</em>): <span class="math inline">|\hat{\beta}_1^{*}| \approx 0.1</span></li>
<li>Średni efekt (ang. <em>medium effect</em>): <span class="math inline">|\hat{\beta}_1^{*}| \approx 0.3</span></li>
<li>Duży efekt (ang. <em>large effect</em>): <span class="math inline">|\hat{\beta}_1^{*}| \approx 0.5</span> lub wyższy</li>
</ul>
<p>Nasz efekt (0.953) jest bardzo duży, sugerując, że godziny nauki mają znaczący związek z wynikami egzaminów.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczamy współczynnik standaryzowany</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>beta_raw <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)[<span class="dv">2</span>]</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>beta_std <span class="ot">&lt;-</span> beta_raw <span class="sc">*</span> (<span class="fu">sd</span>(study_hours) <span class="sc">/</span> <span class="fu">sd</span>(exam_scores))</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Współczynnik surowy:"</span>, <span class="fu">round</span>(beta_raw, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Współczynnik surowy: 4.305 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Współczynnik standaryzowany:"</span>, <span class="fu">round</span>(beta_std, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Współczynnik standaryzowany: 0.862 </code></pre>
</div>
</div>
</section>
<section id="wykresy-diagnostyczne-analiza-reszt" class="level4">
<h4 class="anchored" data-anchor-id="wykresy-diagnostyczne-analiza-reszt">Wykresy Diagnostyczne: Analiza Reszt</h4>
<p>Po dopasowaniu modelu powinniśmy sprawdzić, czy nasze założenia (ang. <em>assumptions</em>) są spełnione. Najbardziej użytecznym narzędziem diagnostycznym jest <strong>wykres reszt</strong> (ang. <em>residual plot</em>): wykres reszt (<span class="math inline">e_i = Y_i - \hat{Y}_i</span>) względem wartości przewidywanych (ang. <em>fitted values</em>) (<span class="math inline">\hat{Y}_i</span>).</p>
<p><strong>Czego szukać:</strong></p>
<ol type="1">
<li><strong>Losowe rozproszenie</strong> (ang. <em>random scatter</em>): Reszty powinny być losowo rozproszone wokół zera</li>
<li><strong>Stałe rozproszenie</strong>: Rozproszenie pionowe powinno być w przybliżeniu stałe (homoskedastyczność, ang. <em>homoscedasticity</em>)</li>
<li><strong>Brak wzorców</strong> (ang. <em>no patterns</em>): Zakrzywione wzorce sugerują nieliniowość (ang. <em>non-linearity</em>)</li>
<li><strong>Brak wartości odstających</strong> (ang. <em>no outliers</em>): Ekstremalnie duże reszty mogą wskazywać problemy</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Reszty vs. Dopasowane</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(model), <span class="fu">residuals</span>(model),</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartości Dopasowane"</span>,</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Reszty"</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Reszty vs. Dopasowane"</span>,</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Histogram reszt</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(model), </span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram Reszt"</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Reszty"</span>,</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>,</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">10</span>)</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Wykres Q-Q (sprawdzanie normalności)</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(model), <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(model), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Reszty vs. Predyktor</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, <span class="fu">residuals</span>(model),</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>,</span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Reszty"</span>,</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Reszty vs. Godziny Nauki"</span>,</span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-residual-diagnostics" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-residual-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-residual-diagnostics-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-residual-diagnostics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.6: Wykresy diagnostyczne reszt
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja wykresu reszt:</strong></p>
<ul>
<li><strong>Dobre</strong>: Punkty losowo rozproszone wokół zera bez wzorca</li>
<li><strong>Złe - kształt lejka</strong> (ang. <em>funnel shape</em>): Wariancja rośnie wraz z wartościami dopasowanymi (heteroskedastyczność, ang. <em>heteroscedasticity</em>)</li>
<li><strong>Złe - zakrzywiony wzorzec</strong> (ang. <em>curved pattern</em>): Relacja nieliniowa nie uchwycona przez model</li>
<li><strong>Złe - grupowanie</strong> (ang. <em>clustering</em>): Możliwe podgrupy (ang. <em>subgroups</em>) lub brakujące zmienne (ang. <em>missing variables</em>)</li>
</ul>
</section>
<section id="identyfikacja-wartości-odstających-i-punktów-wpływowych" class="level4">
<h4 class="anchored" data-anchor-id="identyfikacja-wartości-odstających-i-punktów-wpływowych">Identyfikacja Wartości Odstających i Punktów Wpływowych</h4>
<p>Nie wszystkie punkty danych są równie ważne. Niektóre obserwacje mogą mieć nieproporcjonalny wpływ (ang. <em>disproportionate influence</em>) na linię regresji.</p>
<p><strong>Typy niezwykłych obserwacji:</strong></p>
<ol type="1">
<li><strong>Wartości odstające</strong> (ang. <em>outliers</em>): Obserwacje z dużymi resztami (daleko od linii regresji)</li>
<li><strong>Punkty o wysokiej dźwigni</strong> (ang. <em>high leverage points</em>): Obserwacje z ekstremalnymi wartościami <span class="math inline">X</span></li>
<li><strong>Punkty wpływowe</strong> (ang. <em>influential points</em>): Obserwacje, które po usunięciu znacząco zmienią linię regresji</li>
</ol>
<p><strong>Wykrywanie wartości odstających ręcznie:</strong></p>
<p>Dla naszego przykładu pięciu studentów zbadajmy reszty:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i</span></th>
<th><span class="math inline">|e_i|</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>60</td>
<td>61.4</td>
<td>-1.4</td>
<td>1.4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>73</td>
<td>68.7</td>
<td>4.3</td>
<td>4.3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>71</td>
<td>76.0</td>
<td>-5.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>86</td>
<td>83.3</td>
<td>2.7</td>
<td>2.7</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>90</td>
<td>90.6</td>
<td>-0.6</td>
<td>0.6</td>
</tr>
</tbody>
</table>
<p>Student 3 ma największą resztę (5.0 punktów poniżej przewidywanej). Czy to wartość odstająca?</p>
<p><strong>Zasada kciuka</strong>: Reszta jest niepokojąca, jeśli <span class="math inline">|e_i| &gt; 2 \times RMSE</span></p>
<p>W naszym przypadku: <span class="math inline">2 \times 3.26 = 6.52</span> punktów. Reszta Studenta 3 (5.0) jest poniżej tego progu (ang. <em>threshold</em>), więc nie jest poważną wartością odstającą.</p>
<p><strong>Wizualizacja potencjalnych wartości odstających:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres 1: Podświetlenie potencjalnych wartości odstających</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(exam_scores <span class="sc">~</span> study_hours)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(study_hours, exam_scores,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Godziny Nauki"</span>,</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Wynik Egzaminu"</span>,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Identyfikacja Wartości Odstających"</span>,</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identyfikujemy punkty z dużymi resztami</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>large_resid <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">residuals</span>(model)) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sd</span>(<span class="fu">residuals</span>(model))</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">any</span>(large_resid)) {</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(study_hours[large_resid], exam_scores[large_resid],</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(study_hours[large_resid], exam_scores[large_resid],</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels =</span> <span class="fu">which</span>(large_resid), <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"orange"</span>)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres 2: Wykres dźwigni</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hatvalues</span>(model),</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Numer Obserwacji"</span>,</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Dźwignia (Leverage)"</span>,</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Dźwignia Każdego Punktu"</span>,</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(<span class="fu">coef</span>(model)) <span class="sc">/</span> <span class="fu">length</span>(exam_scores), </span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-outlier-detection" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-outlier-detection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-outlier-detection-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-outlier-detection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.7: Identyfikacja wartości odstających i punktów wpływowych
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Co zrobić z wartościami odstającymi:</strong></p>
<ol type="1">
<li><strong>Zbadać</strong> (ang. <em>investigate</em>): Sprawdzić, czy to błąd wprowadzania danych (ang. <em>data entry error</em>)</li>
<li><strong>Zrozumieć</strong>: Co sprawia, że ta obserwacja jest niezwykła?</li>
<li><strong>Raportować</strong> (ang. <em>report</em>): Odnotować wartość odstającą i rozważyć analizę z nią i bez niej</li>
<li><strong>Nie usuwać automatycznie</strong>: Wartości odstające mogą zawierać ważne informacje</li>
</ol>
<p>Na przykład, Student 3 może mieć lęk przed testem (ang. <em>test anxiety</em>) pomimo odpowiedniego przygotowania lub może uczyć się inaczej. To są merytorycznie znaczące informacje, a nie tylko “szum”.</p>
</section>
<section id="podsumowanie-diagnostyki" class="level4">
<h4 class="anchored" data-anchor-id="podsumowanie-diagnostyki">Podsumowanie Diagnostyki</h4>
<p><strong>Wskaźniki dobrego modelu:</strong></p>
<ul>
<li>Reszty losowo rozproszone wokół zera</li>
<li>Stała wariancja w całym zakresie predykcji</li>
<li><span class="math inline">R^2</span> jest rozsądnie wysokie (zależne od kontekstu)</li>
<li>RMSE jest małe względem skali <span class="math inline">Y</span></li>
<li>Niewiele lub brak ekstremalnych wartości odstających</li>
<li>Współczynniki standaryzowane sugerują znaczące wielkości efektów</li>
</ul>
<p><strong>Sygnały ostrzegawcze</strong> (ang. <em>warning signs</em>):</p>
<ul>
<li>Systematyczne wzorce (ang. <em>systematic patterns</em>) na wykresach reszt</li>
<li>Reszty w kształcie lejka (heteroskedastyczność)</li>
<li>Wiele wpływowych wartości odstających</li>
<li>Bardzo niskie <span class="math inline">R^2</span> (model wyjaśnia niewiele wariancji)</li>
<li>Współczynniki, które nie mają sensu merytorycznego (ang. <em>substantive sense</em>)</li>
</ul>
<p>Zawsze pamiętaj: diagnostykę statystyczną należy łączyć z <strong>wiedzą merytoryczną</strong> (ang. <em>substantive knowledge</em>) o pytaniu badawczym. Model statystycznie “dobry”, który nie ma sensu teoretycznego, jest wciąż problematyczny.</p>
</section>
</section>
<section id="korelacja-vs.-przyczynowość-i-relacje-pozorne" class="level3">
<h3 class="anchored" data-anchor-id="korelacja-vs.-przyczynowość-i-relacje-pozorne">Korelacja vs.&nbsp;Przyczynowość i Relacje Pozorne</h3>
<p>Jedna z najważniejszych lekcji w statystyce to: <strong>korelacja nie implikuje przyczynowości</strong> (ang. <em>correlation does not imply causation</em>). Sama obecność związku między dwoma zmiennymi nie oznacza, że jedna powoduje drugą. Ta sekcja bada, dlaczego to rozróżnienie ma znaczenie i jak korelacje pozorne (ang. <em>spurious correlations</em>) mogą nas wprowadzać w błąd.</p>
<section id="fundamentalny-problem" class="level4">
<h4 class="anchored" data-anchor-id="fundamentalny-problem">Fundamentalny Problem</h4>
<p>Kiedy znajdujemy, że <span class="math inline">X</span> i <span class="math inline">Y</span> są skorelowane (poruszają się razem), istnieje kilka możliwych wyjaśnień:</p>
<ol type="1">
<li><strong><span class="math inline">X</span> powoduje <span class="math inline">Y</span></strong>: Zmiany w <span class="math inline">X</span> bezpośrednio powodują zmiany w <span class="math inline">Y</span></li>
<li><strong><span class="math inline">Y</span> powoduje <span class="math inline">X</span></strong>: Strzałka przyczynowa (ang. <em>causal arrow</em>) biegnie w drugą stronę</li>
<li><strong>Zakłócenie</strong> (ang. <em>confounding</em>): Trzecia zmienna <span class="math inline">Z</span> powoduje zarówno <span class="math inline">X</span>, jak i <span class="math inline">Y</span></li>
<li><strong>Przypadek</strong>: Relacja jest pozorna – tylko przypadkowy zbieg okoliczności</li>
</ol>
<p>Analiza regresji może nam powiedzieć, że <span class="math inline">X</span> i <span class="math inline">Y</span> są <strong>związane</strong> (ang. <em>associated</em>), ale nie może nam powiedzieć <strong>dlaczego</strong> są związane. Aby twierdzić o przyczynowości, potrzebujemy dodatkowych dowodów poza korelacją.</p>
</section>
<section id="klasyczne-przykłady-korelacji-bez-przyczynowości" class="level4">
<h4 class="anchored" data-anchor-id="klasyczne-przykłady-korelacji-bez-przyczynowości">Klasyczne Przykłady Korelacji Bez Przyczynowości</h4>
<p><strong>Przykład 1: Sprzedaż lodów i zgony przez utonięcie</strong></p>
<p>Obserwacja: Kraje z wyższą sprzedażą lodów mają też więcej zgonów przez utonięcie. Czy powinniśmy zakazać lodów, aby zapobiec utonięciom?</p>
<p>Nie! Zmienna zakłócająca (ang. <em>confounding variable</em> lub <em>confounder</em>) to <strong>temperatura</strong>. Gorąca pogoda powoduje zarówno:</p>
<ul>
<li>Więcej sprzedaży lodów (ludzie chłodzą się lodami)</li>
<li>Więcej zgonów przez utonięcie (ludzie częściej pływają)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">25</span>, <span class="dv">5</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>ice_cream <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>drownings <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres 1: Lody vs. utonięcia (korelacja pozorna)</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ice_cream, drownings,</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sprzedaż Lodów"</span>,</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Zgony przez Utonięcie"</span>,</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Korelacja Pozorna"</span>,</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">60</span>, <span class="dv">35</span>, <span class="fu">paste</span>(<span class="st">"R² ="</span>, <span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(drownings <span class="sc">~</span> ice_cream))<span class="sc">$</span>r.squared, <span class="dv">2</span>)),</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres 2: Obie związane z temperaturą (zakłócenie)</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(temperature, ice_cream,</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Temperatura (°C)"</span>,</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Sprzedaż Lodów / Utonięcia"</span>,</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Obie Związane z Temperaturą"</span>,</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>))</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(temperature, drownings <span class="sc">*</span> <span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(ice_cream <span class="sc">~</span> temperature), <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(<span class="fu">I</span>(drownings <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">~</span> temperature), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Lody"</span>, <span class="st">"Utonięcia (skalowane)"</span>),</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"darkgreen"</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">17</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-spurious-correlation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spurious-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-spurious-correlation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spurious-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10.8: Przykład korelacji pozornej przez zakłócenie
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Przykład 2: Rozmiar buta i umiejętność czytania u dzieci</strong></p>
<p>Obserwacja: Dzieci z większymi butami czytają lepiej. Czy rozmiar stopy poprawia poznanie?</p>
<p>Nie! Zmienna zakłócająca to <strong>wiek</strong>. Starsze dzieci mają zarówno:</p>
<ul>
<li>Większe rozmiary butów (urosły)</li>
<li>Lepsze umiejętności czytania (miały więcej edukacji)</li>
</ul>
<p><strong>Przykład 3: Liczba strażaków i szkody od pożaru</strong></p>
<p>Obserwacja: Pożary z większą liczbą obecnych strażaków zwykle mają więcej szkód majątkowych. Czy powinniśmy wysyłać mniej strażaków, aby zmniejszyć szkody?</p>
<p>Absolutnie nie! To <strong>odwrotna przyczynowość</strong> (ang. <em>reverse causation</em>) połączona z zakłóceniem:</p>
<ul>
<li>Większe pożary powodują więcej szkód (bezpośrednio)</li>
<li>Większe pożary też wymagają więcej strażaków (reakcja na dotkliwość)</li>
</ul>
<p>Liczba strażaków nie powoduje szkód; dotkliwość pożaru (ang. <em>fire severity</em>) powoduje obie rzeczy.</p>
</section>
<section id="co-czyni-relację-przyczynową" class="level4">
<h4 class="anchored" data-anchor-id="co-czyni-relację-przyczynową">Co Czyni Relację Przyczynową?</h4>
<p>Aby ustalić przyczynowość (ang. <em>establish causation</em>), zazwyczaj potrzebujemy:</p>
<ol type="1">
<li><strong>Pierwszeństwo czasowe</strong> (ang. <em>temporal precedence</em>): Przyczyna musi poprzedzać skutek</li>
<li><strong>Związek</strong> (ang. <em>association</em>): Zmienne muszą być skorelowane</li>
<li><strong>Brak wiarygodnych zmiennych zakłócających</strong>: Wykluczyliśmy alternatywne wyjaśnienia (ang. <em>alternative explanations</em>)</li>
<li><strong>Mechanizm</strong> (ang. <em>mechanism</em>): Rozumiemy, <em>jak</em> <span class="math inline">X</span> wpływa na <span class="math inline">Y</span></li>
<li><strong>Zależność dawka-odpowiedź</strong> (ang. <em>dose-response relationship</em>): Większe wartości <span class="math inline">X</span> powodują większe efekty na <span class="math inline">Y</span></li>
</ol>
<p><strong>Złoty standard</strong> (ang. <em>gold standard</em>) ustalania przyczynowości to <strong>randomizowany eksperyment kontrolowany</strong> (ang. <em>randomized controlled experiment</em>), gdzie losowo przypisujemy ludzi do otrzymania różnych wartości <span class="math inline">X</span>. To przerywa relację między <span class="math inline">X</span> a potencjalnymi zmiennymi zakłócającymi.</p>
<p>Jednak w naukach społecznych często nie możemy przeprowadzać eksperymentów (byłoby to nieetyczne lub niepraktyczne). Zamiast tego używamy:</p>
<ul>
<li>Projektów longitudinalnych (ang. <em>longitudinal designs</em>) – mierzenie zmiennych w czasie</li>
<li>Eksperymentów naturalnych (ang. <em>natural experiments</em>) – znajdowanie naturalnie występującej zmienności losowej</li>
<li>Starannej kontroli zmiennych zakłócających (ang. <em>controlling for confounders</em>) – włączanie ich do regresji wielorakiej</li>
<li>Rozumowania teoretycznego (ang. <em>theoretical reasoning</em>) i wcześniejszych dowodów</li>
</ul>
</section>
<section id="korelacje-pozorne" class="level4">
<h4 class="anchored" data-anchor-id="korelacje-pozorne">Korelacje Pozorne</h4>
<p><strong>Korelacja pozorna</strong> (ang. <em>spurious correlation</em>) to statystyczna relacja między dwiema zmiennymi, która nie wynika z żadnego związku przyczynowego między nimi. Często powstają przez:</p>
<ol type="1">
<li><strong>Wspólną przyczynę</strong> (ang. <em>common cause</em>) – zakłócenie: <span class="math inline">Z</span> powoduje zarówno <span class="math inline">X</span>, jak i <span class="math inline">Y</span></li>
<li><strong>Przypadek</strong>: Losowy zbieg okoliczności tworzy pozorne wzorce</li>
<li><strong>Błąd selekcji</strong> (ang. <em>selection bias</em>): Sposób próbkowania tworzy sztuczne relacje</li>
</ol>
<p><strong>Słynne korelacje pozorne:</strong></p>
<ul>
<li>Konsumpcja sera per capita koreluje ze zgonami przez zaplątanie się w prześcieradło (<span class="math inline">r = 0.95</span>)</li>
<li>Liczba filmów Nicolasa Cage’a koreluje z utonięciami w basenach (<span class="math inline">r = 0.67</span>)</li>
<li>Konsumpcja margaryny per capita koreluje ze wskaźnikiem rozwodów w Maine (<span class="math inline">r = 0.99</span>)</li>
</ul>
<p>To oczywiście nie są związki przyczynowe (ang. <em>causal relationships</em>) – to przypadki w danych szeregów czasowych. Lekcja: <strong>wysoka korelacja, nawet bardzo wysoka, nie dowodzi przyczynowości</strong>.</p>
</section>
<section id="implikacje-dla-analizy-regresji" class="level4">
<h4 class="anchored" data-anchor-id="implikacje-dla-analizy-regresji">Implikacje dla Analizy Regresji</h4>
<p>Kiedy interpretujemy nasze wyniki regresji, musimy być ostrożni:</p>
<p><strong>Co regresja nam mówi:</strong></p>
<ul>
<li><span class="math inline">X</span> i <span class="math inline">Y</span> są związane</li>
<li>Siła związku (ang. <em>strength of association</em>) (<span class="math inline">\hat{\beta}_1</span>)</li>
<li>Ile wariancji jest wyjaśnione (<span class="math inline">R^2</span>)</li>
<li>Czy relacja jest liniowa</li>
</ul>
<p><strong>Czego regresja NIE mówi:</strong></p>
<ul>
<li>Czy <span class="math inline">X</span> powoduje <span class="math inline">Y</span></li>
<li>Czy pominęliśmy ważne zmienne zakłócające (ang. <em>omitted confounders</em>)</li>
<li>Kierunek przyczynowości (ang. <em>direction of causation</em>)</li>
<li>Czy relacja jest pozorna</li>
</ul>
<p><strong>Nasz przykład z godzinami nauki:</strong></p>
<p>Znaleźliśmy, że godziny nauki silnie przewidują wyniki egzaminów (<span class="math inline">R^2 = 0.909</span>). Czy nauka <strong>powoduje</strong> wyższe wyniki?</p>
<p>Prawdopodobnie tak, ale powinniśmy rozważyć alternatywne wyjaśnienia:</p>
<ul>
<li><strong>Odwrotna przyczynowość</strong>: Może studenci, którzy są naturalnie dobrzy w przedmiocie (wysokie zdolności, ang. <em>high ability</em>), lubią się uczyć więcej, więc uczą się dłużej. Tutaj zdolności powodują zarówno godziny nauki, jak i wyniki egzaminów.</li>
<li><strong>Zakłócenie</strong>: Może studenci ze wspierającymi rodzicami (ang. <em>supportive parents</em>) zarówno uczą się więcej, jak i osiągają lepsze wyniki (rodzice pomagają w odrabianiu lekcji i tworzą dobre środowisko do nauki).</li>
<li><strong>Selekcja</strong>: Może w naszej próbie byli tylko zmotywowani studenci, a motywacja powoduje zarówno naukę, jak i wyniki.</li>
</ul>
<p>Aby wzmocnić twierdzenie przyczynowe (ang. <em>causal claim</em>), moglibyśmy:</p>
<ul>
<li>Kontrolować wcześniejsze zdolności (ang. <em>prior ability</em>) – włączyć poprzednie wyniki egzaminów</li>
<li>Kontrolować zaangażowanie rodziców (ang. <em>parental involvement</em>)</li>
<li>Użyć projektu eksperymentalnego (ang. <em>experimental design</em>) – losowo przypisać godziny nauki</li>
<li>Sprawdzić, czy relacja utrzymuje się w różnych kontekstach</li>
</ul>
</section>
<section id="praktyczne-rady" class="level4">
<h4 class="anchored" data-anchor-id="praktyczne-rady">Praktyczne Rady</h4>
<p>Przy raportowaniu wyników regresji:</p>
<ul>
<li>Używaj ostrożnego języka: “związane z” zamiast “powoduje” lub “prowadzi do”</li>
<li>Uznaj potencjalne zmienne zakłócające</li>
<li>Omów alternatywne wyjaśnienia</li>
<li>Bądź jawny co do ograniczeń (ang. <em>limitations</em>) projektu badania</li>
<li>Jeśli twierdzisz o przyczynowości, podaj rozumowanie teoretyczne i dodatkowe dowody</li>
</ul>
<p>Pamiętaj: <strong>korelacja jest koniecznym, ale niewystarczającym warunkiem przyczynowości</strong> (ang. <em>correlation is a necessary but not sufficient condition for causation</em>). Znalezienie związku to tylko pierwszy krok w zrozumieniu, czy jedna zmienna wpływa na drugą.</p>
</section>
</section>
<section id="kluczowe-założenia-mnk" class="level3">
<h3 class="anchored" data-anchor-id="kluczowe-założenia-mnk">Kluczowe Założenia MNK</h3>
<p>Aby MNK dostarczała znaczących oszacowań (ang. <em>meaningful estimates</em>), potrzebujemy kilku założeń:</p>
<ol type="1">
<li><p><strong>Liniowość</strong> (ang. <em>linearity</em>): Relacja między <span class="math inline">X</span> i <span class="math inline">Y</span> jest liniowa: <span class="math inline">Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i</span></p></li>
<li><p><strong>Ścisła Egzogeniczność</strong> (ang. <em>strict exogeneity</em>): Składnik błędu (ang. <em>error term</em>) ma zerową wartość oczekiwaną warunkową (ang. <em>conditional expected value</em>) na <span class="math inline">X</span>: <span class="math inline">E[\varepsilon_i | X_i] = 0</span></p>
<p>To oznacza, że <span class="math inline">X</span> jest nieskorelowane z błędem – nie ma pominiętych zmiennych (ang. <em>omitted variables</em>), które wpływają zarówno na <span class="math inline">X</span>, jak i <span class="math inline">Y</span>.</p></li>
<li><p><strong>Homoskedastyczność</strong> (ang. <em>homoscedasticity</em>) – nie ścisła, ale pożądana: Wariancja błędów jest stała: <span class="math inline">Var(\varepsilon_i | X_i) = \sigma^2</span></p></li>
<li><p><strong>Brak idealnej współliniowości</strong> (ang. <em>no perfect collinearity</em>) – ważne dla regresji wielorakiej: Zmienne predykcyjne nie są idealnie skorelowane.</p></li>
</ol>
<p><strong>Ważna uwaga:</strong> <strong>Nie</strong> zakładamy tutaj probabilistycznych założeń o rozkładzie próbkowania (ang. <em>sampling distribution</em>). Po prostu opisujemy relację w naszych danych. Dla wnioskowania (ang. <em>inference</em>) – testów hipotez (ang. <em>hypothesis tests</em>), przedziałów ufności (ang. <em>confidence intervals</em>) – potrzebowalibyśmy dodatkowych założeń, ale to wykracza poza nasz obecny zakres.</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dla Jakich Danych Możemy Stosować Regresję MNK?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Regresja MNK ma specyficzne wymagania dotyczące typów zmiennych:</p>
<p><strong>Zmienna zależna (wynikowa, <span class="math inline">Y</span>):</strong></p>
<ul>
<li><strong>Musi być ciągła</strong> (ang. <em>continuous</em>) lub <strong>quasi-ciągła</strong> (np. dyskretna z wieloma wartościami)</li>
<li>Poziom pomiaru (typologia Stevensa):
<ul>
<li><strong>Przedziałowy</strong> (ang. <em>interval</em>): różnice między wartościami mają sens, ale brak naturalnego zera (np. temperatura w °C, wyniki testów IQ)</li>
<li><strong>Ilorazowy</strong> (ang. <em>ratio</em>): jak przedziałowy, ale z naturalnym zerem (np. dochód, wiek, liczba godzin)</li>
</ul></li>
<li><strong>Nie nadaje się</strong>: Zmienne nominalne (ang. <em>nominal</em>) – kategorie bez porządku (np. kolor oczu, płeć) lub ordinalne (ang. <em>ordinal</em>) z niewielką liczbą kategorii (np. skala Likerta 1-5)</li>
</ul>
<p><strong>Zmienne niezależne (predyktory, <span class="math inline">X</span>):</strong></p>
<ul>
<li><strong>Mogą być</strong> ciągłe, dyskretne lub binarne (0/1)</li>
<li>Poziom pomiaru:
<ul>
<li><strong>Ilorazowy/Przedziałowy</strong>: idealny (np. wiek, dochód, temperatura)</li>
<li><strong>Ordinalny</strong>: akceptowalny, jeśli traktujemy jako quasi-ciągły (np. poziom wykształcenia: 1=podstawowe, 2=średnie, 3=wyższe)</li>
<li><strong>Nominalny binarny</strong>: akceptowalny (np. płeć: 0=kobieta, 1=mężczyzna)</li>
<li><strong>Nominalny wielokategorialny</strong>: wymaga przekształcenia na zmienne binarne (ang. <em>dummy variables</em>) – np. region: 3 zmienne binarne dla 4 regionów</li>
</ul></li>
</ul>
<p><strong>Przykłady poprawnych zastosowań:</strong></p>
<ul>
<li><span class="math inline">Y</span>: Wynik egzaminu (0-100 punktów, przedziałowy) ~ <span class="math inline">X</span>: Godziny nauki (ciągły, ilorazowy) ✓</li>
<li><span class="math inline">Y</span>: Dochód (ciągły, ilorazowy) ~ <span class="math inline">X_1</span>: Wiek (ciągły, ilorazowy) + <span class="math inline">X_2</span>: Płeć (binarny, nominalny) ✓</li>
<li><span class="math inline">Y</span>: Frekwencja wyborcza (%, ilorazowy) ~ <span class="math inline">X</span>: PKB per capita (ciągły, ilorazowy) ✓</li>
</ul>
<p><strong>Niepoprawne zastosowania:</strong></p>
<ul>
<li><span class="math inline">Y</span>: Kolor oczu (nominalny) ~ <span class="math inline">X</span>: Wiek – użyj regresji wielomianowej (ang. <em>multinomial regression</em>) ✗</li>
<li><span class="math inline">Y</span>: Wybór partii (nominalny, 5 opcji) ~ <span class="math inline">X</span>: Dochód – użyj regresji wielomianowej ✗</li>
<li><span class="math inline">Y</span>: Zgoda (Tak/Nie, binarny) ~ <span class="math inline">X</span>: Wiek – użyj regresji logistycznej (ang. <em>logistic regression</em>) ✗</li>
</ul>
<p><strong>Zasada praktyczna</strong>: Jeśli <span class="math inline">Y</span> ma mniej niż ~7 unikalnych wartości, rozważ inne metody (regresja logistyczna, porządkowa, Poissona).</p>
</div>
</div>
<hr>
</section>
<section id="rozszerzenie-do-regresji-wielorakiej" class="level3">
<h3 class="anchored" data-anchor-id="rozszerzenie-do-regresji-wielorakiej">Rozszerzenie do Regresji Wielorakiej</h3>
<p>Do tej pory patrzyliśmy na <strong>prostą regresję liniową</strong> (ang. <em>simple linear regression</em>) z jednym predyktorem. W rzeczywistości zjawiska społeczne są złożone i wymagają wielu predyktorów.</p>
<p><strong>Model regresji wielorakiej</strong> (ang. <em>multiple regression model</em>) rozszerza nasze ramy:</p>
<p><span class="math display">Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \cdots + \beta_k X_{ki} + \varepsilon_i</span></p>
<p>Na przykład, przewidywanie frekwencji wyborczej:</p>
<p><span class="math display">\text{Frekwencja}_i = \beta_0 + \beta_1 \text{PKB}_i + \beta_2 \text{Obowiązkowe}_i + \beta_3 \text{Wiek}_i + \varepsilon_i</span></p>
<p>Zasada MNK pozostaje ta sama: znajdź współczynniki, które minimalizują <span class="math inline">SSE = \sum (Y_i - \hat{Y}_i)^2</span>.</p>
<p>Interpretacja zmienia się nieznacznie:</p>
<ul>
<li><span class="math inline">\hat{\beta}_1</span> to efekt <span class="math inline">X_1</span> na <span class="math inline">Y</span>, <strong>przy utrzymaniu wszystkich innych zmiennych stałych</strong> (ang. <em>holding all other variables constant</em>)</li>
<li>To jest często nazywane “efektem cząstkowym” (ang. <em>partial effect</em>) lub “kontrolowaniem” (ang. <em>controlling for</em>) innych zmiennych</li>
</ul>
<p><strong>Notacja macierzowa</strong> (ang. <em>matrix notation</em>) – dla referencji:</p>
<p><span class="math display">\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}</span></p>
<p>Ale nie musisz tego zapamiętywać – oprogramowanie (jak funkcja <code>lm()</code> w R) obsługuje obliczenia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykład regresji wielorakiej</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (używając wbudowanego zbioru danych mtcars)</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt <span class="sc">+</span> cyl, <span class="at">data =</span> mtcars)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt + cyl, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.9290 -1.5598 -0.5311  1.1850  5.8986 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept) 38.75179    1.78686  21.687 &lt; 0.0000000000000002 ***
hp          -0.01804    0.01188  -1.519             0.140015    
wt          -3.16697    0.74058  -4.276             0.000199 ***
cyl         -0.94162    0.55092  -1.709             0.098480 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.512 on 28 degrees of freedom
Multiple R-squared:  0.8431,    Adjusted R-squared:  0.8263 
F-statistic: 50.17 on 3 and 28 DF,  p-value: 0.00000000002184</code></pre>
</div>
</div>
</section>
<section id="podsumowanie" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie">Podsumowanie</h3>
<p>Omówiliśmy podstawy analizy regresji:</p>
<ul>
<li>Modele deterministyczne zakładają idealne relacje; modele stochastyczne uznają niepewność</li>
<li>Modele statystyczne zawierają zarówno systematyczne wzorce, jak i losową zmienność</li>
<li>W danych istnieją różne relacje – modele liniowe działają najlepiej dla relacji liniowych</li>
<li>Metoda MNK znajduje linię, która minimalizuje sumę kwadratów błędów</li>
<li>Możemy rozłożyć wariancję: <span class="math inline">SST = SSR + SSE</span></li>
<li><span class="math inline">R^2 = SSR/SST</span> mierzy proporcję wariancji wyjaśnionej (od 0 do 1)</li>
<li>RMSE mierzy średni błąd predykcji w oryginalnych jednostkach</li>
<li>Współczynniki należy interpretować merytorycznie, uwzględniając wielkości efektów</li>
<li>Współczynniki standaryzowane pozwalają na porównanie między różnymi skalami</li>
<li>Wykresy reszt i wykrywanie wartości odstających pomagają diagnozować problemy modelu</li>
<li><strong>Korelacja nie implikuje przyczynowości</strong> – zakłócenie i relacje pozorne są powszechne</li>
<li>Aby ustalić przyczynowość, potrzebujemy pierwszeństwa czasowego, braku zmiennych zakłócających i mechanizmów teoretycznych</li>
<li>MNK wymaga założeń takich jak liniowość i ścisła egzogeniczność</li>
<li>Regresja wieloraka rozszerza te ramy o wiele predyktorów</li>
</ul>
<p>W praktyce <strong>zawsze najpierw wizualizuj swoje dane</strong>, sprawdź, czy model liniowy jest odpowiedni, zbadaj wykresy reszt pod kątem problemów, dokładnie przemyśl interpretację przyczynową i pamiętaj, że związek to nie przyczynowość – nawet wysokie <span class="math inline">R^2</span> nie dowodzi, że <span class="math inline">X</span> powoduje <span class="math inline">Y</span>.</p>
<hr>
</section>
</section>
<section id="ręczne-obliczenia-ols-krok-po-kroku" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="ręczne-obliczenia-ols-krok-po-kroku"><span class="header-section-number">10.9</span> Ręczne obliczenia OLS krok po kroku</h2>
<p>Badaczka chce zbadać zależność między godzinami nauki a wynikiem testu (6 studentów):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th>Study Hours (X)</th>
<th>Exam Score (Y)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
</tr>
</tbody>
</table>
<p>Celem jest wyznaczyć <span class="math inline">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1 X</span> metodą OLS.</p>
<section id="krok-1-średnie" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-średnie">Krok 1: Średnie</h3>
<p><strong>Dla</strong> <span class="math inline">X</span>:</p>
<p><span class="math display">\bar{X} = \frac{1+2+3+4+5+6}{6} = \frac{21}{6} = 3.5</span></p>
<p><strong>Dla</strong> <span class="math inline">Y</span>:</p>
<p><span class="math display">\bar{Y} = \frac{65+70+75+85+88+95}{6} = \frac{478}{6} = 79.67</span></p>
</section>
<section id="krok-2-odchylenia-od-średnich" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-odchylenia-od-średnich">Krok 2: Odchylenia od średnich</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
<td>−2.5</td>
<td>−14.67</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
<td>−1.5</td>
<td>−9.67</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
<td>−0.5</td>
<td>−4.67</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
<td>0.5</td>
<td>5.33</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
<td>1.5</td>
<td>8.33</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
<td>2.5</td>
<td>15.33</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-3-iloczyny-i-kwadraty" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-iloczyny-i-kwadraty">Krok 3: Iloczyny i kwadraty</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>36.68</td>
<td>6.25</td>
</tr>
<tr class="even">
<td>B</td>
<td>14.51</td>
<td>2.25</td>
</tr>
<tr class="odd">
<td>C</td>
<td>2.34</td>
<td>0.25</td>
</tr>
<tr class="even">
<td>D</td>
<td>2.67</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>E</td>
<td>12.50</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>F</td>
<td>38.33</td>
<td>6.25</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td><strong>107.03</strong></td>
<td><strong>17.50</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="krok-4-nachylenie-hatbeta_1" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-nachylenie-hatbeta_1">Krok 4: Nachylenie <span class="math inline">\hat{\beta}_1</span></h3>
<p><span class="math display">\hat{\beta}_1 = \frac{107.03}{17.50} = 6.12</span></p>
<p><strong>Interpretacja:</strong> +6.12 punktu za każdą dodatkową godzinę nauki.</p>
</section>
<section id="krok-5-wyraz-wolny-hatbeta_0" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-wyraz-wolny-hatbeta_0">Krok 5: Wyraz wolny <span class="math inline">\hat{\beta}_0</span></h3>
<p><span class="math display">\hat{\beta}_0 = 79.67 - 6.12 \cdot 3.5 = 58.25</span></p>
<p><strong>Interpretacja:</strong> przy 0 godzinach przewidujemy <strong>58.25</strong>.</p>
</section>
<section id="krok-6-równanie-regresji" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-równanie-regresji">Krok 6: Równanie regresji</h3>
<p><span class="math display">\hat{Y} = 58.25 + 6.12 X</span></p>
</section>
<section id="krok-7-predykcje-i-reszty" class="level3">
<h3 class="anchored" data-anchor-id="krok-7-predykcje-i-reszty">Krok 7: Predykcje i reszty</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 58.25 + 6.12X_i</span></th>
<th>Reszta <span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>65</td>
<td>64.37</td>
<td>0.63</td>
</tr>
<tr class="even">
<td>B</td>
<td>2</td>
<td>70</td>
<td>70.49</td>
<td>−0.49</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>75</td>
<td>76.61</td>
<td>−1.61</td>
</tr>
<tr class="even">
<td>D</td>
<td>4</td>
<td>85</td>
<td>82.73</td>
<td>2.27</td>
</tr>
<tr class="odd">
<td>E</td>
<td>5</td>
<td>88</td>
<td>88.85</td>
<td>−0.85</td>
</tr>
<tr class="even">
<td>F</td>
<td>6</td>
<td>95</td>
<td>94.97</td>
<td>0.03</td>
</tr>
</tbody>
</table>
<p><strong>Kontrola:</strong> suma reszt ≈ 0 ✓</p>
</section>
<section id="krok-8-sumy-kwadratów" class="level3">
<h3 class="anchored" data-anchor-id="krok-8-sumy-kwadratów">Krok 8: Sumy kwadratów</h3>
<p><strong>SST — całkowita:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>65</td>
<td>215.21</td>
</tr>
<tr class="even">
<td>B</td>
<td>70</td>
<td>93.51</td>
</tr>
<tr class="odd">
<td>C</td>
<td>75</td>
<td>21.81</td>
</tr>
<tr class="even">
<td>D</td>
<td>85</td>
<td>28.41</td>
</tr>
<tr class="odd">
<td>E</td>
<td>88</td>
<td>69.39</td>
</tr>
<tr class="even">
<td>F</td>
<td>95</td>
<td>235.01</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td><strong>SST = 663.34</strong></td>
</tr>
</tbody>
</table>
<p><strong>SSR — wyjaśniona:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>64.37</td>
<td>234.09</td>
</tr>
<tr class="even">
<td>B</td>
<td>70.49</td>
<td>84.27</td>
</tr>
<tr class="odd">
<td>C</td>
<td>76.61</td>
<td>9.36</td>
</tr>
<tr class="even">
<td>D</td>
<td>82.73</td>
<td>9.36</td>
</tr>
<tr class="odd">
<td>E</td>
<td>88.85</td>
<td>84.27</td>
</tr>
<tr class="even">
<td>F</td>
<td>94.97</td>
<td>234.09</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td><strong>SSR = 655.44</strong></td>
</tr>
</tbody>
</table>
<p><strong>SSE — błąd:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">e_i</span></th>
<th><span class="math inline">e_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>0.63</td>
<td>0.40</td>
</tr>
<tr class="even">
<td>B</td>
<td>−0.49</td>
<td>0.24</td>
</tr>
<tr class="odd">
<td>C</td>
<td>−1.61</td>
<td>2.59</td>
</tr>
<tr class="even">
<td>D</td>
<td>2.27</td>
<td>5.15</td>
</tr>
<tr class="odd">
<td>E</td>
<td>−0.85</td>
<td>0.72</td>
</tr>
<tr class="even">
<td>F</td>
<td>0.03</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td><strong>SSE = 9.10</strong></td>
</tr>
</tbody>
</table>
<p><strong>Weryfikacja:</strong> <span class="math inline">SST \approx SSR + SSE</span><br>
<span class="math inline">663.34 \approx 655.44 + 9.10 = 664.54</span> (drobne różnice zaokrągleń).</p>
</section>
<section id="krok-9-r2" class="level3">
<h3 class="anchored" data-anchor-id="krok-9-r2">Krok 9: <span class="math inline">R^2</span></h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{655.44}{663.34} = 0.988</span></p>
<p><strong>Alternatywnie:</strong></p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{9.10}{663.34} = 0.986</span></p>
<p><strong>Interpretacja:</strong> ~98.8% zmienności wyników wyjaśniają godziny nauki — <strong>bardzo silny</strong> związek.</p>
</section>
<section id="krok-10-wielkości-efektu" class="level3">
<h3 class="anchored" data-anchor-id="krok-10-wielkości-efektu">Krok 10: Wielkości efektu</h3>
<p><strong>Surowa:</strong> <strong>6.12 pkt/godz.</strong></p>
<p><strong>Standaryzowana:</strong></p>
<ul>
<li><span class="math inline">s_X = \sqrt{17.50/5} = 1.87</span>,</li>
<li><span class="math inline">s_Y = \sqrt{663.34/5} = 11.52</span>,</li>
<li><span class="math inline">\beta_{\text{std}} = 6.12 \cdot (1.87/11.52) = 0.99</span> → <strong>bardzo duży</strong> efekt (wg Cohena).</li>
</ul>
</section>
<section id="krok-11-istotność-praktyczna" class="level3">
<h3 class="anchored" data-anchor-id="krok-11-istotność-praktyczna">Krok 11: Istotność praktyczna</h3>
<ol type="1">
<li><strong>Skala:</strong> 6.12% na 100-punktowej skali / godz.,</li>
<li><strong>Progi:</strong> zmiana oceny (10 pkt) ≈ <strong>1.63 h</strong>,</li>
<li><strong>Koszt-efekt:</strong> korzystny — sensowna inwestycja czasu.</li>
</ol>
</section>
<section id="podsumowanie-wyników" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie-wyników">Podsumowanie wyników</h3>
<ul>
<li><strong>Równanie:</strong> <span class="math inline">\hat{Y} = 58.25 + 6.12 X</span></li>
<li><strong>Nachylenie:</strong> 6.12 pkt/godz.</li>
<li><strong>Wyraz wolny:</strong> 58.25 pkt</li>
<li><span class="math inline">R^2</span>: 0.988</li>
<li><span class="math inline">\beta_{\text{std}}</span>: 0.99</li>
</ul>
<p>W praktyce: każda godzina nauki to ≈ +6 pkt; dopasowanie znakomite; efekt istotny statystycznie i praktycznie.</p>
</section>
<section id="kontrola-wyniku" class="level3">
<h3 class="anchored" data-anchor-id="kontrola-wyniku">Kontrola wyniku</h3>
<p>Sprawdź, że linia przechodzi przez <span class="math inline">(\bar{X}, \bar{Y})</span>:</p>
<p><span class="math display">58.25 + 6.12 \cdot 3.5 = 79.67 = \bar{Y}</span> ✓</p>
</section>
</section>
<section id="kod-r-do-weryfikacji-obliczeń" class="level2" data-number="10.10">
<h2 data-number="10.10" class="anchored" data-anchor-id="kod-r-do-weryfikacji-obliczeń"><span class="header-section-number">10.10</span> Kod R do weryfikacji obliczeń</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 1: Dane</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>study_hours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)      <span class="co"># X</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>exam_scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">95</span>) <span class="co"># Y</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(study_hours)</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> study_hours,</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> exam_scores</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Original Data:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Original Data:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student X  Y
1       A 1 65
2       B 2 70
3       C 3 75
4       D 4 85
5       E 5 88
6       F 6 95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 2: Średnie</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(study_hours)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(exam_scores)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Means:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Means:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Mean of X (study hours): %.2f</span><span class="sc">\n</span><span class="st">"</span>, x_bar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of X (study hours): 3.50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Mean of Y (exam scores): %.2f</span><span class="sc">\n</span><span class="st">"</span>, y_bar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean of Y (exam scores): 79.67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 3: Odchylenia od średnich</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>x_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>X <span class="sc">-</span> x_bar</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>Y <span class="sc">-</span> y_bar</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Deviations from means:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Deviations from means:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data[, <span class="fu">c</span>(<span class="st">"Student"</span>, <span class="st">"x_dev"</span>, <span class="st">"y_dev"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student x_dev      y_dev
1       A  -2.5 -14.666667
2       B  -1.5  -9.666667
3       C  -0.5  -4.666667
4       D   0.5   5.333333
5       E   1.5   8.333333
6       F   2.5  15.333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 4: Iloczyny i kwadraty</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>xy_product <span class="ot">&lt;-</span> data<span class="sc">$</span>x_dev <span class="sc">*</span> data<span class="sc">$</span>y_dev</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>x_dev_sq <span class="ot">&lt;-</span> data<span class="sc">$</span>x_dev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>sum_xy_product <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>xy_product)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>sum_x_dev_sq <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>x_dev_sq)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Sum of (Xi - X̄)(Yi - Ȳ):"</span>, <span class="fu">round</span>(sum_xy_product, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sum of (Xi - X̄)(Yi - Ȳ): 107 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sum of (Xi - X̄)²:"</span>, sum_x_dev_sq, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of (Xi - X̄)²: 17.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 5: Nachylenie (beta_1)</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>beta_1_manual <span class="ot">&lt;-</span> sum_xy_product <span class="sc">/</span> sum_x_dev_sq</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Slope (β₁) calculated manually:"</span>, <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Slope (β₁) calculated manually: 6.11 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 6: Wyraz wolny (beta_0)</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>beta_0_manual <span class="ot">&lt;-</span> y_bar <span class="sc">-</span> beta_1_manual <span class="sc">*</span> x_bar</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Intercept (β₀) calculated manually:"</span>, <span class="fu">round</span>(beta_0_manual, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Intercept (β₀) calculated manually: 58.27 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 7: Porównanie z lm()</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Verification with R's lm() function ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Verification with R's lm() function ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error
(Intercept) 58.266667  1.4045278
X            6.114286  0.3606495</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 8: Predykcje i reszty</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Y_hat <span class="ot">&lt;-</span> beta_0_manual <span class="sc">+</span> beta_1_manual <span class="sc">*</span> data<span class="sc">$</span>X</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residual <span class="ot">&lt;-</span> data<span class="sc">$</span>Y <span class="sc">-</span> data<span class="sc">$</span>Y_hat</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Predicted values and residuals:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Predicted values and residuals:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data[, <span class="fu">c</span>(<span class="st">"Student"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Y_hat"</span>, <span class="st">"residual"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student X  Y    Y_hat    residual
1       A 1 65 64.38095  0.61904762
2       B 2 70 70.49524 -0.49523810
3       C 3 75 76.60952 -1.60952381
4       D 4 85 82.72381  2.27619048
5       E 5 88 88.83810 -0.83809524
6       F 6 95 94.95238  0.04761905</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sum of residuals (should be ≈ 0):"</span>, <span class="fu">round</span>(<span class="fu">sum</span>(data<span class="sc">$</span>residual), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sum of residuals (should be ≈ 0): 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 9: Sumy kwadratów</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>Y <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Sum of Squares Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Sum of Squares Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Total Sum of Squares):"</span>, <span class="fu">round</span>(SST, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Total Sum of Squares): 663.33 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>Y_hat <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Regression Sum of Squares):"</span>, <span class="fu">round</span>(SSR, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Regression Sum of Squares): 654.23 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Error Sum of Squares):"</span>, <span class="fu">round</span>(SSE, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Error Sum of Squares): 9.1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Verification: SST = SSR + SSE</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Verification: SST = SSR + SSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"%.2f = %.2f + %.2f</span><span class="sc">\n</span><span class="st">"</span>, SST, SSR, SSE))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>663.33 = 654.23 + 9.10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Difference (due to rounding):"</span>, <span class="fu">round</span>(SST <span class="sc">-</span> (SSR <span class="sc">+</span> SSE), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Difference (due to rounding): 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 10: R-kwadrat</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>R_squared_method1 <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>R_squared_method2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSE <span class="sc">/</span> SST)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>R_squared_lm <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- R-squared Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- R-squared Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (Method 1: SSR/SST):"</span>, <span class="fu">round</span>(R_squared_method1, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (Method 1: SSR/SST): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (Method 2: 1 - SSE/SST):"</span>, <span class="fu">round</span>(R_squared_method2, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (Method 2: 1 - SSE/SST): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R² (from lm function):"</span>, <span class="fu">round</span>(R_squared_lm, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R² (from lm function): 0.9863 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 11: Wielkości efektu</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Effect Size Calculations ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Effect Size Calculations ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Raw effect size (slope):"</span>, <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"points per hour</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Raw effect size (slope): 6.11 points per hour</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>X)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>sd_y <span class="ot">&lt;-</span> <span class="fu">sd</span>(data<span class="sc">$</span>Y)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standard deviations:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standard deviations:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SD of X: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sd_x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of X: 1.87</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"SD of Y: %.2f</span><span class="sc">\n</span><span class="st">"</span>, sd_y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SD of Y: 11.52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>beta_std <span class="ot">&lt;-</span> beta_1_manual <span class="sc">*</span> (sd_x <span class="sc">/</span> sd_y)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Standardized effect size: %.2f</span><span class="sc">\n</span><span class="st">"</span>, beta_std))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Standardized effect size: 0.99</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja (dla regresji prostej |r| = sqrt(R^2))</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(data<span class="sc">$</span>X, data<span class="sc">$</span>Y)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pearson correlation coefficient:"</span>, <span class="fu">round</span>(correlation, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Pearson correlation coefficient: 0.9931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Square root of R²:"</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(R_squared_method1), <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Square root of R²: 0.9931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"These should be equal (within rounding error)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>These should be equal (within rounding error)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Krok 12: Wizualizacja</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- Creating Visualization ---</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Creating Visualization ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>X, data<span class="sc">$</span>Y, </span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Study Hours vs Exam Scores with OLS Regression Line"</span>,</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Study Hours"</span>,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Exam Score"</span>,</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">100</span>))</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> beta_0_manual, <span class="at">b =</span> beta_1_manual, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Punkt średnich</span></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x_bar, y_bar, <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Reszty jako odcinki pionowe</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) {</span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(data<span class="sc">$</span>X[i], data<span class="sc">$</span>Y[i], data<span class="sc">$</span>X[i], data<span class="sc">$</span>Y_hat[i], </span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, </span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Observed Data"</span>, <span class="st">"Regression Line"</span>, <span class="st">"Mean Point"</span>, <span class="st">"Residuals"</span>),</span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"gray"</span>),</span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>, <span class="dv">15</span>, <span class="cn">NA</span>),</span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">1</span>))</span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Równanie na wykresie</span></span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a>equation_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"Y = %.2f + %.2f*X"</span>, beta_0_manual, beta_1_manual)</span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a>r2_text <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"R² = %.3f"</span>, R_squared_method1)</span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, <span class="dv">92</span>, equation_text, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.5</span>, <span class="dv">89</span>, r2_text, <span class="at">pos =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/visualization-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption>Analiza regresji OLS - godziny nauki vs.&nbsp;wynik testu</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie końcowe</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">========== FINAL SUMMARY ==========</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
========== FINAL SUMMARY ==========</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Regression Equation: Y ="</span>, <span class="fu">round</span>(beta_0_manual, <span class="dv">2</span>), <span class="st">"+"</span>, </span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"* X</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Regression Equation: Y = 58.27 + 6.11 * X</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(R_squared_method1, <span class="dv">4</span>), </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"(%.1f%% of variance explained)</span><span class="sc">\n</span><span class="st">"</span>, R_squared_method1 <span class="sc">*</span> <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-squared: 0.9863 (98.6% of variance explained)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standardized Effect Size:"</span>, <span class="fu">round</span>(beta_std, <span class="dv">2</span>), <span class="st">"(Very Large Effect)</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standardized Effect Size: 0.99 (Very Large Effect)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Interpretation:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Interpretation:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Each additional hour of study increases exam score by"</span>, </span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_1_manual, <span class="dv">2</span>), <span class="st">"points</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Each additional hour of study increases exam score by 6.11 points</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- Study hours explain"</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f%%"</span>, R_squared_method1 <span class="sc">*</span> <span class="dv">100</span>), </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"of the variation in exam scores</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- Study hours explain 98.6% of the variation in exam scores</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"- The relationship is extremely strong (correlation ="</span>, </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(correlation, <span class="dv">3</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>- The relationship is extremely strong (correlation = 0.993 )</code></pre>
</div>
</div>
</section>
<section id="jak-uruchomić-kod" class="level2" data-number="10.11">
<h2 data-number="10.11" class="anchored" data-anchor-id="jak-uruchomić-kod"><span class="header-section-number">10.11</span> Jak uruchomić kod</h2>
<ol type="1">
<li>Skopiuj cały blok kodu,</li>
<li>Wklej do RStudio,</li>
<li>Uruchom chunk po chunk lub cały dokument,</li>
<li>Porównaj wyniki z obliczeniami ręcznymi.</li>
</ol>
<p><strong>Co zobaczysz:</strong></p>
<ul>
<li><strong>Nachylenie:</strong> 6.12,</li>
<li><strong>Wyraz wolny:</strong> 58.25,</li>
<li><span class="math inline">R^2</span>: ≈ 0.988,</li>
<li><strong>Efekt standaryzowany:</strong> ≈ 0.99,</li>
<li>Wykres z punktami, linią regresji i resztami.</li>
</ul>
<p>To potwierdza poprawność obliczeń manualnych. :::</p>
<hr>
</section>
<section id="appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający" class="level2" data-number="10.12">
<h2 data-number="10.12" class="anchored" data-anchor-id="appendix-a-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-wprowadzający"><span class="header-section-number">10.12</span> Appendix A: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład wprowadzający</h2>
<p>Studentka politologii bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Gallaghera (GH) w wyborach parlamentarnych w 10 losowo wybranych demokracjach.</p>
<p>Dane dotyczące wielkości okręgu wyborczego (<span class="math inline">\text{DM}</span>) i indeksu Gallaghera:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\text{DM}</span> (<span class="math inline">X</span>)</th>
<th>Gallagher (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18,2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16,7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15,8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15,3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15,0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14,8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14,7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14,6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14,55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14,52</td>
</tr>
</tbody>
</table>
<section id="krok-1-obliczanie-podstawowych-statystyk" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczanie-podstawowych-statystyk">Krok 1: Obliczanie Podstawowych Statystyk</h3>
<p>Obliczanie średnich:</p>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65</span> <span class="math display">\bar{x} = \frac{65}{10} = 6,5</span></p>
<p>Dla indeksu Gallaghera (<span class="math inline">Y</span>): <span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">18,2 + 16,7 + 15,8 + 15,3 + 15,0 + 14,8 + 14,7 + 14,6 + 14,55 + 14,52 = 154,17</span> <span class="math display">\bar{y} = \frac{154,17}{10} = 15,417</span></p>
</section>
<section id="krok-2-szczegółowe-obliczenia-kowariancji" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-szczegółowe-obliczenia-kowariancji">Krok 2: Szczegółowe Obliczenia Kowariancji</h3>
<p>Pełna tabela robocza ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td><span class="math inline">-4,5</span></td>
<td>2,783</td>
<td><span class="math inline">-12,5235</span></td>
<td>20,25</td>
<td>7,7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td><span class="math inline">-3,5</span></td>
<td>1,283</td>
<td><span class="math inline">-4,4905</span></td>
<td>12,25</td>
<td>1,6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td><span class="math inline">-2,5</span></td>
<td>0,383</td>
<td><span class="math inline">-0,9575</span></td>
<td>6,25</td>
<td>0,1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td><span class="math inline">-1,5</span></td>
<td><span class="math inline">-0,117</span></td>
<td>0,1755</td>
<td>2,25</td>
<td>0,0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td><span class="math inline">-0,5</span></td>
<td><span class="math inline">-0,417</span></td>
<td>0,2085</td>
<td>0,25</td>
<td>0,1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>0,5</td>
<td><span class="math inline">-0,617</span></td>
<td><span class="math inline">-0,3085</span></td>
<td>0,25</td>
<td>0,3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>1,5</td>
<td><span class="math inline">-0,717</span></td>
<td><span class="math inline">-1,0755</span></td>
<td>2,25</td>
<td>0,5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,5</td>
<td><span class="math inline">-0,817</span></td>
<td><span class="math inline">-2,0425</span></td>
<td>6,25</td>
<td>0,6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>3,5</td>
<td><span class="math inline">-0,867</span></td>
<td><span class="math inline">-3,0345</span></td>
<td>12,25</td>
<td>0,7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>4,5</td>
<td><span class="math inline">-0,897</span></td>
<td><span class="math inline">-4,0365</span></td>
<td>20,25</td>
<td>0,8047</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>0</td>
<td>0</td>
<td><span class="math inline">-28,085</span></td>
<td>82,5</td>
<td>12,8442</td>
</tr>
</tbody>
</table>
<p>Obliczanie kowariancji: <span class="math display">\text{Cov}(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p><span class="math display">\text{Cov}(X,Y) = \frac{-28,085}{9} = -3,120556</span></p>
</section>
<section id="krok-3-obliczanie-odchylenia-standardowego" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczanie-odchylenia-standardowego">Krok 3: Obliczanie Odchylenia Standardowego</h3>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_x = \sqrt{\frac{82,5}{9}} = \sqrt{9,1667} = 3,026582</span></p>
<p>Dla Gallaghera (<span class="math inline">Y</span>): <span class="math display">\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_y = \sqrt{\frac{12,8442}{9}} = \sqrt{1,4271} = 1,194612</span></p>
</section>
<section id="krok-4-obliczanie-korelacji-pearsona" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-obliczanie-korelacji-pearsona">Krok 4: Obliczanie Korelacji Pearsona</h3>
<p><span class="math display">r = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y}</span></p>
<p><span class="math display">r = \frac{-3,120556}{3,026582 \times 1,194612} = \frac{-3,120556}{3,615752} = -0,863044</span></p>
</section>
<section id="krok-5-obliczanie-korelacji-rangowej-spearmana" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-obliczanie-korelacji-rangowej-spearmana">Krok 5: Obliczanie Korelacji Rangowej Spearmana</h3>
<p>Pełna tabela rangowa ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th>Ranga <span class="math inline">X_i</span></th>
<th>Ranga <span class="math inline">Y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>1</td>
<td>10</td>
<td><span class="math inline">-9</span></td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>2</td>
<td>9</td>
<td><span class="math inline">-7</span></td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>3</td>
<td>8</td>
<td><span class="math inline">-5</span></td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>4</td>
<td>7</td>
<td><span class="math inline">-3</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>5</td>
<td>6</td>
<td><span class="math inline">-1</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Obliczanie korelacji Spearmana: <span class="math display">\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></p>
<p><span class="math display">\rho = 1 - \frac{6 \times 330}{10(100 - 1)} = 1 - \frac{1980}{990} = 1 - 2 = -1</span></p>
</section>
<section id="krok-6-weryfikacja-w-r" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-weryfikacja-w-r">Krok 6: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wektorów</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie kowariancji</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="krok-7-podstawowa-wizualizacja" class="level3">
<h3 class="anchored" data-anchor-id="krok-7-podstawowa-wizualizacja">Krok 7: Podstawowa Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu rozrzutu</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wielkość Okręgu vs Indeks Gallaghera"</span>,</span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wielkość Okręgu (DM)"</span>,</span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera (GH)"</span></span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estymacja-ols-i-miary-dopasowania-modelu" class="level3">
<h3 class="anchored" data-anchor-id="estymacja-ols-i-miary-dopasowania-modelu">Estymacja OLS i Miary Dopasowania Modelu</h3>
</section>
<section id="krok-1-obliczanie-estymatorów-ols" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczanie-estymatorów-ols">Krok 1: Obliczanie Estymatorów OLS</h3>
<p>Korzystając z wcześniej obliczonych wartości:</p>
<ul>
<li><span class="math inline">\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28,085</span></li>
<li><span class="math inline">\sum(X_i - \bar{X})^2 = 82,5</span></li>
<li><span class="math inline">\bar{X} = 6,5</span></li>
<li><span class="math inline">\bar{Y} = 15,417</span></li>
</ul>
<p>Obliczanie nachylenia (<span class="math inline">\hat{\beta_1}</span>):</p>
<p><span class="math inline">\hat{\beta_1} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta_1} = -28,085 ÷ 82,5 = -0,3404</span></p>
<p>Obliczanie wyrazu wolnego (<span class="math inline">\hat{\beta_0}</span>): <span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</span></p>
<p>Zatem równanie regresji OLS ma postać: <span class="math inline">\hat{Y} = 17,6296 - 0,3404X</span></p>
</section>
<section id="krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-obliczanie-wartości-dopasowanych-i-reszt">Krok 2: Obliczanie Wartości Dopasowanych i Reszt</h3>
<p>Pełna tabela ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">e_i^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>16,9488</td>
<td>1,2512</td>
<td>1,5655</td>
<td>7,7451</td>
<td>2,3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>16,6084</td>
<td>0,0916</td>
<td>0,0084</td>
<td>1,6461</td>
<td>1,4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>16,2680</td>
<td>-0,4680</td>
<td>0,2190</td>
<td>0,1467</td>
<td>0,7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>15,9276</td>
<td>-0,6276</td>
<td>0,3939</td>
<td>0,0137</td>
<td>0,2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>15,5872</td>
<td>-0,5872</td>
<td>0,3448</td>
<td>0,1739</td>
<td>0,0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>15,2468</td>
<td>-0,4468</td>
<td>0,1996</td>
<td>0,3807</td>
<td>0,0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>14,9064</td>
<td>-0,2064</td>
<td>0,0426</td>
<td>0,5141</td>
<td>0,2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>14,5660</td>
<td>0,0340</td>
<td>0,0012</td>
<td>0,6675</td>
<td>0,7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>14,2256</td>
<td>0,3244</td>
<td>0,1052</td>
<td>0,7517</td>
<td>1,4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>13,8852</td>
<td>0,6348</td>
<td>0,4030</td>
<td>0,8047</td>
<td>2,3439</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>154,17</td>
<td>0</td>
<td>3,2832</td>
<td>12,8442</td>
<td>9,5524</td>
</tr>
</tbody>
</table>
<p>Obliczenia dla wartości dopasowanych:</p>
<pre><code>Dla X = 2:
Ŷ = 17,6296 + (-0,3404 × 2) = 16,9488

Dla X = 3:
Ŷ = 17,6296 + (-0,3404 × 3) = 16,6084

[... kontynuacja dla wszystkich wartości]</code></pre>
</section>
<section id="krok-3-obliczanie-miar-dopasowania" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczanie-miar-dopasowania">Krok 3: Obliczanie Miar Dopasowania</h3>
<p>Suma kwadratów reszt (SSE): <span class="math inline">SSE = \sum e_i^2</span></p>
<pre><code>SSE = 3,2832</code></pre>
<p>Całkowita suma kwadratów (SST): <span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<pre><code>SST = 12,8442</code></pre>
<p>Suma kwadratów regresji (SSR): <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<pre><code>SSR = 9,5524</code></pre>
<p>Weryfikacja dekompozycji: <span class="math inline">SST = SSR + SSE</span></p>
<pre><code>12,8442 = 9,5524 + 3,2832 (w granicach błędu zaokrąglenia)</code></pre>
<p>Obliczanie współczynnika determinacji R-kwadrat: <span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<pre><code>R² = 9,5524 ÷ 12,8442
   = 0,7438</code></pre>
</section>
<section id="krok-4-weryfikacja-w-r" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-weryfikacja-w-r">Krok 4: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu liniowego</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie statystyk</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value       Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 0.000000000467 ***
DM          -0.34042    0.07053  -4.827        0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ręczne obliczenie R-kwadrat</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="krok-5-analiza-reszt" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-analiza-reszt">Krok 5: Analiza Reszt</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów reszt</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych">Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu wartości przewidywanych vs rzeczywistych</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> GH,</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Przewidywane, <span class="at">y =</span> Rzeczywiste)) <span class="sc">+</span></span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wartości Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Przewidywany Indeks Gallaghera"</span>,</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rzeczywisty Indeks Gallaghera"</span></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modele-z-transformacją-logarytmiczną" class="level3">
<h3 class="anchored" data-anchor-id="modele-z-transformacją-logarytmiczną">Modele z Transformacją Logarytmiczną</h3>
</section>
<section id="krok-1-transformacja-danych" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-transformacja-danych">Krok 1: Transformacja Danych</h3>
<p>Najpierw obliczamy logarytmy naturalne zmiennych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\ln(X_i)</span></th>
<th><span class="math inline">\ln(Y_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>0,6931</td>
<td>2,9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>1,0986</td>
<td>2,8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>1,3863</td>
<td>2,7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>1,6094</td>
<td>2,7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>1,7918</td>
<td>2,7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>1,9459</td>
<td>2,6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>2,0794</td>
<td>2,6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,1972</td>
<td>2,6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>2,3026</td>
<td>2,6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>2,3979</td>
<td>2,6757</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-2-porównanie-różnych-specyfikacji-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-porównanie-różnych-specyfikacji-modelu">Krok 2: Porównanie Różnych Specyfikacji Modelu</h3>
<p>Szacujemy trzy alternatywne specyfikacje:</p>
<ol type="1">
<li>Model log-liniowy: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i</span></li>
<li>Model liniowo-logarytmiczny: <span class="math inline">Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
<li>Model log-log: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie zmiennych transformowanych</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modeli</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie wartości R-kwadrat</span></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Liniowy"</span>, <span class="st">"Log-liniowy"</span>, <span class="st">"Liniowo-logarytmiczny"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(</span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Model R_kwadrat
1               Liniowy 0.7443793
2           Log-liniowy 0.7670346
3 Liniowo-logarytmiczny 0.9141560
4               Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="krok-3-porównanie-wizualne" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-porównanie-wizualne">Krok 3: Porównanie Wizualne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów dla każdego modelu</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowy"</span>) <span class="sc">+</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-liniowy"</span>) <span class="sc">+</span></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny"</span>) <span class="sc">+</span></span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-log"</span>) <span class="sc">+</span></span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Układanie wykresów w siatkę</span></span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-4-analiza-reszt-dla-najlepszego-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-analiza-reszt-dla-najlepszego-modelu">Krok 4: Analiza Reszt dla Najlepszego Modelu</h3>
<p>Na podstawie wartości R-kwadrat, analiza reszt dla najlepiej dopasowanego modelu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykresy reszt dla najlepszego modelu</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-5-interpretacja-najlepszego-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-5-interpretacja-najlepszego-modelu">Krok 5: Interpretacja Najlepszego Modelu</h3>
<p>Współczynniki modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value        Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 0.0000000000494 ***
log_DM       -2.0599     0.2232   -9.23 0.0000153880425 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 0.00001539</code></pre>
</div>
</div>
<p>Interpretacja:</p>
<ul>
<li><span class="math inline">\hat{\beta_0}</span> reprezentuje oczekiwany Indeks Gallaghera, gdy ln(DM) = 0 (czyli gdy DM = 1)</li>
<li><span class="math inline">\hat{\beta_1}</span> reprezentuje zmianę Indeksu Gallaghera związaną z jednostkowym wzrostem ln(DM)</li>
</ul>
</section>
<section id="krok-6-predykcje-modelu" class="level3">
<h3 class="anchored" data-anchor-id="krok-6-predykcje-modelu">Krok 6: Predykcje Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu predykcji dla najlepszego modelu</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny: Indeks Gallaghera vs ln(Wielkość Okręgu)"</span>,</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(Wielkość Okręgu)"</span>,</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera"</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-7-analiza-elastyczności" class="level3">
<h3 class="anchored" data-anchor-id="krok-7-analiza-elastyczności">Krok 7: Analiza Elastyczności</h3>
<p>Dla modelu log-log współczynniki bezpośrednio reprezentują elastyczności. Obliczenie średniej elastyczności dla modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie elastyczności przy wartościach średnich</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>elastycznosc <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>elastycznosc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>Wartość ta reprezentuje procentową zmianę Indeksu Gallaghera przy jednoprocentowej zmianie Wielkości Okręgu.</p>
<hr>
</section>
</section>
<section id="appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne" class="level2" data-number="10.13">
<h2 data-number="10.13" class="anchored" data-anchor-id="appendix-b.-prosty-model-regresji-liniowej-mnkols---przykłady-różne"><span class="header-section-number">10.13</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - przykłady różne</h2>
</section>
<section id="przykład-0.-czas-nauki-vs.-ocena-przewodnik-po-mnk-i-r-kwadrat" class="level2" data-number="10.14">
<h2 data-number="10.14" class="anchored" data-anchor-id="przykład-0.-czas-nauki-vs.-ocena-przewodnik-po-mnk-i-r-kwadrat"><span class="header-section-number">10.14</span> Przykład 0. Czas Nauki vs.&nbsp;Ocena: Przewodnik po MNK i R-kwadrat</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Nasz prosty zbiór danych</span></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>practice <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>skill <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">9</span>)</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Practice =</span> practice,</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skill =</span> skill</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Practice Skill
1       1        1     3
2       2        2     7
3       3        3     5
4       4        4     8
5       5        5    10
6       6        6     9</code></pre>
</div>
</div>
<section id="obliczenia-ręczne" class="level3">
<h3 class="anchored" data-anchor-id="obliczenia-ręczne">Obliczenia Ręczne</h3>
<section id="krok-1-obliczenie-średnich" class="level4">
<h4 class="anchored" data-anchor-id="krok-1-obliczenie-średnich">Krok 1: Obliczenie Średnich</h4>
<p>Średnia to wartość przeciętna, obliczana przez zsumowanie wszystkich obserwacji i podzielenie przez ich liczbę.</p>
<p><strong>Średnia Godzin Ćwiczeń (X̄):</strong></p>
<p><span class="math display">\bar{X} = \frac{\sum_{i=1}^{n} X_i}{n} = \frac{1 + 2 + 3 + 4 + 5 + 6}{6} = \frac{21}{6} = 3.5</span></p>
<p><strong>Średnia Ocen Umiejętności (Ȳ):</strong></p>
<p><span class="math display">\bar{Y} = \frac{\sum_{i=1}^{n} Y_i}{n} = \frac{3 + 7 + 5 + 8 + 10 + 9}{6} = \frac{42}{6} = 7</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie średnich</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>mean_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(practice)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(skill)</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnia Godzin Ćwiczeń:"</span>, mean_x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnia Godzin Ćwiczeń: 3.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnia Oceny Umiejętności:"</span>, mean_y, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnia Oceny Umiejętności: 7 </code></pre>
</div>
</div>
</section>
<section id="krok-2-obliczenie-wariancji-i-odchylenia-standardowego" class="level4">
<h4 class="anchored" data-anchor-id="krok-2-obliczenie-wariancji-i-odchylenia-standardowego">Krok 2: Obliczenie Wariancji i Odchylenia Standardowego</h4>
<p>Wariancja mierzy, jak bardzo dane są rozproszone wokół średniej. Używamy wzoru na wariancję próbkową (dzielenie przez n-1).</p>
<p><strong>Wariancja X (Godziny Ćwiczeń):</strong></p>
<p>Najpierw obliczamy odchylenia od średniej <span class="math inline">(X_i - \bar{X})</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td><span class="math inline">1 - 3.5 = -2.5</span></td>
<td><span class="math inline">(-2.5)^2 = 6.25</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td><span class="math inline">2 - 3.5 = -1.5</span></td>
<td><span class="math inline">(-1.5)^2 = 2.25</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td><span class="math inline">3 - 3.5 = -0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td><span class="math inline">4 - 3.5 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td><span class="math inline">5 - 3.5 = 1.5</span></td>
<td><span class="math inline">(1.5)^2 = 2.25</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6</td>
<td><span class="math inline">6 - 3.5 = 2.5</span></td>
<td><span class="math inline">(2.5)^2 = 6.25</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>17.5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1} = \frac{17.5}{5} = 3.5</span></p>
<p><span class="math display">s_X = \sqrt{3.5} = 1.871</span></p>
<p><strong>Wariancja Y (Oceny Umiejętności):</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>3</td>
<td><span class="math inline">3 - 7 = -4</span></td>
<td><span class="math inline">(-4)^2 = 16</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
<td><span class="math inline">7 - 7 = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td><span class="math inline">5 - 7 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td><span class="math inline">8 - 7 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td><span class="math inline">10 - 7 = 3</span></td>
<td><span class="math inline">(3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>9</td>
<td><span class="math inline">9 - 7 = 2</span></td>
<td><span class="math inline">(2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>34</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_Y = \frac{\sum(Y_i - \bar{Y})^2}{n-1} = \frac{34}{5} = 6.8</span></p>
<p><span class="math display">s_Y = \sqrt{6.8} = 2.608</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja wariancji i odchylenia standardowego</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja Ćwiczeń:"</span>, <span class="fu">var</span>(practice), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja Ćwiczeń: 3.5 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odch. Stand. Ćwiczeń:"</span>, <span class="fu">sd</span>(practice), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odch. Stand. Ćwiczeń: 1.870829 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja Umiejętności:"</span>, <span class="fu">var</span>(skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja Umiejętności: 6.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odch. Stand. Umiejętności:"</span>, <span class="fu">sd</span>(skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odch. Stand. Umiejętności: 2.607681 </code></pre>
</div>
</div>
</section>
<section id="krok-3-obliczenie-kowariancji" class="level4">
<h4 class="anchored" data-anchor-id="krok-3-obliczenie-kowariancji">Krok 3: Obliczenie Kowariancji</h4>
<p>Kowariancja mierzy, jak dwie zmienne zmieniają się wspólnie. Dodatnia kowariancja wskazuje, że gdy jedna zmienna rośnie, druga również ma tendencję do wzrostu.</p>
<p><span class="math display">s_{XY} = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Obliczmy iloczyny dla każdej obserwacji:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-2.5</td>
<td>-4</td>
<td><span class="math inline">(-2.5) \times (-4) = 10.0</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>-1.5</td>
<td>0</td>
<td><span class="math inline">(-1.5) \times (0) = 0.0</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>-0.5</td>
<td>-2</td>
<td><span class="math inline">(-0.5) \times (-2) = 1.0</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>0.5</td>
<td>1</td>
<td><span class="math inline">(0.5) \times (1) = 0.5</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>1.5</td>
<td>3</td>
<td><span class="math inline">(1.5) \times (3) = 4.5</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>2.5</td>
<td>2</td>
<td><span class="math inline">(2.5) \times (2) = 5.0</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>21.0</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s_{XY} = \frac{21.0}{5} = 4.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja kowariancji</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kowariancja:"</span>, <span class="fu">cov</span>(practice, skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kowariancja: 4.2 </code></pre>
</div>
</div>
</section>
<section id="krok-4-obliczenie-współczynnika-korelacji-pearsona" class="level4">
<h4 class="anchored" data-anchor-id="krok-4-obliczenie-współczynnika-korelacji-pearsona">Krok 4: Obliczenie Współczynnika Korelacji Pearsona</h4>
<p>Współczynnik korelacji standaryzuje kowariancję do skali od -1 do +1:</p>
<p><span class="math display">r = \frac{s_{XY}}{s_X \cdot s_Y} = \frac{4.2}{1.871 \times 2.608} = \frac{4.2}{4.879} = 0.861</span></p>
<p>Otrzymujemy korelację wynoszącą <strong>0.861</strong>, co wskazuje na silny dodatni związek między godzinami ćwiczeń a oceną umiejętności.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja korelacji</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja:"</span>, <span class="fu">cor</span>(practice, skill), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja: 0.8609161 </code></pre>
</div>
</div>
</section>
<section id="krok-5-obliczenie-współczynników-regresji-mnk" class="level4">
<h4 class="anchored" data-anchor-id="krok-5-obliczenie-współczynników-regresji-mnk">Krok 5: Obliczenie Współczynników Regresji MNK</h4>
<p>Metoda Najmniejszych Kwadratów (MNK) znajduje wartości <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>, które minimalizują sumę kwadratów błędów.</p>
<p><strong>Estymator nachylenia:</strong></p>
<p><span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p>Używając naszych obliczonych wartości:</p>
<p><span class="math display">\hat{\beta_1} = \frac{4.2}{3.5} = 1.2</span></p>
<p><strong>Estymator wyrazu wolnego:</strong></p>
<p><span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 7 - (1.2 \times 3.5) = 7 - 4.2 = 2.8</span></p>
<p><strong>Nasze równanie regresji:</strong></p>
<p><span class="math display">\hat{Y} = 2.8 + 1.2X</span></p>
<p>To oznacza:</p>
<ul>
<li><p>Gdy godziny ćwiczeń = 0, przewidywana umiejętność = 2.8</p></li>
<li><p>Każda dodatkowa godzina ćwiczeń zwiększa ocenę umiejętności o 1.2 punktu</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(skill <span class="sc">~</span> practice)</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>coef_model <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wyraz wolny (β₀):"</span>, coef_model[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wyraz wolny (β₀): 2.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Nachylenie (β₁):"</span>, coef_model[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Nachylenie (β₁): 1.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie przewidywań</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>residual <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="krok-6-obliczenie-wartości-przewidywanych-i-reszt" class="level4">
<h4 class="anchored" data-anchor-id="krok-6-obliczenie-wartości-przewidywanych-i-reszt">Krok 6: Obliczenie Wartości Przewidywanych i Reszt</h4>
<p>Używając <span class="math inline">\hat{Y} = 2.8 + 1.2X</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 2.8 + 1.2X_i</span></th>
<th>Reszta <span class="math inline">(Y_i - \hat{Y}_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1</td>
<td>3</td>
<td><span class="math inline">2.8 + 1.2(1) = 4.0</span></td>
<td><span class="math inline">3 - 4.0 = -1.0</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>7</td>
<td><span class="math inline">2.8 + 1.2(2) = 5.2</span></td>
<td><span class="math inline">7 - 5.2 = 1.8</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>3</td>
<td>5</td>
<td><span class="math inline">2.8 + 1.2(3) = 6.4</span></td>
<td><span class="math inline">5 - 6.4 = -1.4</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>8</td>
<td><span class="math inline">2.8 + 1.2(4) = 7.6</span></td>
<td><span class="math inline">8 - 7.6 = 0.4</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5</td>
<td>10</td>
<td><span class="math inline">2.8 + 1.2(5) = 8.8</span></td>
<td><span class="math inline">10 - 8.8 = 1.2</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6</td>
<td>9</td>
<td><span class="math inline">2.8 + 1.2(6) = 10.0</span></td>
<td><span class="math inline">9 - 10.0 = -1.0</span></td>
</tr>
</tbody>
</table>
</section>
<section id="krok-7-obliczenie-sum-kwadratów" class="level4">
<h4 class="anchored" data-anchor-id="krok-7-obliczenie-sum-kwadratów">Krok 7: Obliczenie Sum Kwadratów</h4>
<p><strong>SST (Całkowita Suma Kwadratów) - Całkowita zmienność Y:</strong></p>
<p><span class="math display">SST = \sum(Y_i - \bar{Y})^2</span></p>
<p>Z naszych wcześniejszych obliczeń wariancji:</p>
<p><span class="math display">SST = (n-1) \times s^2_Y = 5 \times 6.8 = 34</span></p>
<p><strong>SSE (Suma Kwadratów Błędów) - Zmienność niewyjaśniona:</strong></p>
<p><span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 17%">
<col style="width: 28%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">(Y_i - \hat{Y}_i)</span></th>
<th><span class="math inline">(Y_i - \hat{Y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>3</td>
<td>4.0</td>
<td>-1.0</td>
<td>1.00</td>
</tr>
<tr class="even">
<td>2</td>
<td>7</td>
<td>5.2</td>
<td>1.8</td>
<td>3.24</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>6.4</td>
<td>-1.4</td>
<td>1.96</td>
</tr>
<tr class="even">
<td>4</td>
<td>8</td>
<td>7.6</td>
<td>0.4</td>
<td>0.16</td>
</tr>
<tr class="odd">
<td>5</td>
<td>10</td>
<td>8.8</td>
<td>1.2</td>
<td>1.44</td>
</tr>
<tr class="even">
<td>6</td>
<td>9</td>
<td>10.0</td>
<td>-1.0</td>
<td>1.00</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>8.80</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSE = 8.80</span></p>
<p><strong>SSR (Suma Kwadratów Regresji) - Zmienność wyjaśniona:</strong></p>
<p><span class="math display">SSR = SST - SSE = 34 - 8.80 = 25.20</span></p>
</section>
<section id="krok-8-obliczenie-r-kwadrat" class="level4">
<h4 class="anchored" data-anchor-id="krok-8-obliczenie-r-kwadrat">Krok 8: Obliczenie R-kwadrat</h4>
<p>R-kwadrat informuje nas, jaka część całkowitej zmienności Y jest wyjaśniona przez nasz model:</p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{25.20}{34} = 0.741</span></p>
<p><strong>Alternatywny wzór:</strong></p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{8.80}{34} = 1 - 0.259 = 0.741</span></p>
<p><strong>Lub po prostu:</strong></p>
<p><span class="math display">R^2 = r^2 = (0.861)^2 = 0.741</span></p>
<p>To oznacza, że nasz model wyjaśnia <strong>74.1%</strong> zmienności ocen umiejętności!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja sum kwadratów i R-kwadrat</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((skill <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>predicted <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Całkowita):"</span>, SST, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Całkowita): 34 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Wyjaśniona):"</span>, SSR, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Wyjaśniona): 25.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Niewyjaśniona):"</span>, SSE, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Niewyjaśniona): 8.8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-kwadrat:"</span>, r_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-kwadrat: 0.7411765 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-kwadrat (z korelacji):"</span>, <span class="fu">cor</span>(practice, skill)<span class="sc">^</span><span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-kwadrat (z korelacji): 0.7411765 </code></pre>
</div>
</div>
</section>
</section>
<section id="wizualizacja-1-linia-najlepszego-dopasowania-mnk" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-1-linia-najlepszego-dopasowania-mnk">Wizualizacja 1: Linia Najlepszego Dopasowania MNK</h3>
<p>Ten wykres pokazuje, jak MNK minimalizuje <strong>sumę kwadratów reszt</strong> (pionowe odległości od punktów do linii).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice, <span class="at">y =</span> Skill)) <span class="sc">+</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> Practice, <span class="at">yend =</span> predicted), </span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> mean_y <span class="sc">+</span> <span class="fl">0.3</span>, </span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Średnia (ȳ = "</span>, mean_y, <span class="st">")"</span>), </span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">4</span>, </span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Reszty (błędy)</span><span class="sc">\n</span><span class="st">MNK minimalizuje Σ(reszty²)"</span>, </span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fl">10.5</span>, </span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ŷ = "</span>, <span class="fu">round</span>(coef_model[<span class="dv">1</span>], <span class="dv">1</span>), </span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">" + "</span>, <span class="fu">round</span>(coef_model[<span class="dv">2</span>], <span class="dv">1</span>), <span class="st">"x"</span>), </span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Regresja MNK: Minimalizacja Kwadratów Reszt"</span>,</span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Niebieskie trójkąty to wartości przewidywane; czerwone linie pokazują reszty"</span>,</span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Godziny Ćwiczeń"</span>,</span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ocena Umiejętności"</span></span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Kluczowa Obserwacja:</strong> MNK znajduje unikalną linię, która czyni sumę kwadratów czerwonych odległości jak najmniejszą!</p>
</section>
<section id="wizualizacja-2-dekompozycja-wariancji-sst-ssr-sse" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-2-dekompozycja-wariancji-sst-ssr-sse">Wizualizacja 2: Dekompozycja Wariancji (SST = SSR + SSE)</h3>
<p>To pokazuje, jak całkowita zmienność jest dzielona na składniki wyjaśniony i niewyjaśniony.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu dekompozycji</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice)) <span class="sc">+</span></span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Całkowite odchylenie (SST)</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_y, <span class="at">yend =</span> Skill, <span class="at">xend =</span> Practice), </span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Odchylenie wyjaśnione (SSR)</span></span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> mean_y, <span class="at">yend =</span> predicted, <span class="at">xend =</span> Practice), </span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Odchylenie niewyjaśnione (SSE)</span></span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted, <span class="at">yend =</span> Skill, <span class="at">xend =</span> Practice), </span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>,</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia średniej</span></span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"solid"</span>, </span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Linia regresji</span></span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> Skill), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Punkty</span></span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Skill), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb262-28"><a href="#cb262-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-29"><a href="#cb262-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adnotacje</span></span>
<span id="cb262-30"><a href="#cb262-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> mean_y, </span>
<span id="cb262-31"><a href="#cb262-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Średnia"</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb262-32"><a href="#cb262-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">6.5</span>, <span class="at">y =</span> <span class="fl">9.5</span>, </span>
<span id="cb262-33"><a href="#cb262-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Linia Regresji"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb262-34"><a href="#cb262-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-35"><a href="#cb262-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Legenda</span></span>
<span id="cb262-36"><a href="#cb262-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">yend =</span> <span class="fl">3.5</span>,</span>
<span id="cb262-37"><a href="#cb262-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, </span>
<span id="cb262-38"><a href="#cb262-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.12</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb262-39"><a href="#cb262-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">2.75</span>, </span>
<span id="cb262-40"><a href="#cb262-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Całkowite (SST)"</span>, <span class="at">color =</span> <span class="st">"purple"</span>, </span>
<span id="cb262-41"><a href="#cb262-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb262-42"><a href="#cb262-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-43"><a href="#cb262-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">yend =</span> <span class="fl">5.5</span>,</span>
<span id="cb262-44"><a href="#cb262-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb262-45"><a href="#cb262-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="dv">5</span>, </span>
<span id="cb262-46"><a href="#cb262-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Wyjaśnione (SSR)"</span>, <span class="at">color =</span> <span class="st">"green"</span>, </span>
<span id="cb262-47"><a href="#cb262-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb262-48"><a href="#cb262-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-49"><a href="#cb262-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">6.5</span>, <span class="at">yend =</span> <span class="fl">7.5</span>,</span>
<span id="cb262-50"><a href="#cb262-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb262-51"><a href="#cb262-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="dv">7</span>, </span>
<span id="cb262-52"><a href="#cb262-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Niewyjaśnione (SSE)"</span>, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb262-53"><a href="#cb262-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb262-54"><a href="#cb262-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-55"><a href="#cb262-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb262-56"><a href="#cb262-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Dekompozycja Wariancji: SST = SSR + SSE"</span>,</span>
<span id="cb262-57"><a href="#cb262-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Fioletowe = odchylenie całkowite | Zielone = wyjaśnione przez model | Czerwone = błąd resztowy"</span>,</span>
<span id="cb262-58"><a href="#cb262-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Godziny Ćwiczeń"</span>,</span>
<span id="cb262-59"><a href="#cb262-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Ocena Umiejętności"</span></span>
<span id="cb262-60"><a href="#cb262-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb262-61"><a href="#cb262-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb262-62"><a href="#cb262-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb262-63"><a href="#cb262-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">7.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Dekompozycja Matematyczna:</strong></p>
<p>Dla każdej obserwacji: <span class="math inline">(Y_i - \bar{Y})^2 = (\hat{Y}_i - \bar{Y})^2 + (Y_i - \hat{Y}_i)^2</span></p>
<ul>
<li><p><strong>Fioletowe strzałki:</strong> Całkowite odchylenie od średniej = <span class="math inline">(Y_i - \bar{Y})</span></p></li>
<li><p><strong>Zielone słupki:</strong> Wyjaśnienie modelu = <span class="math inline">(\hat{Y}_i - \bar{Y})</span></p></li>
<li><p><strong>Czerwone przerywane:</strong> Co zostaje = <span class="math inline">(Y_i - \hat{Y}_i)</span></p></li>
</ul>
</section>
<section id="wizualizacja-3-r-kwadrat-jako-proporcja" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-3-r-kwadrat-jako-proporcja">Wizualizacja 3: R-kwadrat jako Proporcja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie sum kwadratów</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((skill <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((data<span class="sc">$</span>predicted <span class="sc">-</span> mean_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dane do wykresu słupkowego</span></span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>ss_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Całkowita (SST)"</span>, <span class="st">"Wyjaśniona (SSR)"</span>, <span class="st">"Niewyjaśniona (SSE)"</span>),</span>
<span id="cb264-10"><a href="#cb264-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(SST, SSR, SSE),</span>
<span id="cb264-11"><a href="#cb264-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Color =</span> <span class="fu">c</span>(<span class="st">"purple"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb264-12"><a href="#cb264-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb264-13"><a href="#cb264-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-14"><a href="#cb264-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ss_data, <span class="fu">aes</span>(<span class="at">x =</span> Component, <span class="at">y =</span> Value, <span class="at">fill =</span> Component)) <span class="sc">+</span></span>
<span id="cb264-15"><a href="#cb264-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb264-16"><a href="#cb264-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Value, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb264-17"><a href="#cb264-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"red"</span>, <span class="st">"purple"</span>)) <span class="sc">+</span></span>
<span id="cb264-18"><a href="#cb264-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb264-19"><a href="#cb264-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Rozkład Sum Kwadratów"</span>,</span>
<span id="cb264-20"><a href="#cb264-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Suma Kwadratów"</span>,</span>
<span id="cb264-21"><a href="#cb264-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span></span>
<span id="cb264-22"><a href="#cb264-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb264-23"><a href="#cb264-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb264-24"><a href="#cb264-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb264-25"><a href="#cb264-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb264-26"><a href="#cb264-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-27"><a href="#cb264-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja proporcji</span></span>
<span id="cb264-28"><a href="#cb264-28" aria-hidden="true" tabindex="-1"></a>prop_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb264-29"><a href="#cb264-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Component =</span> <span class="fu">c</span>(<span class="st">"Wyjaśniona</span><span class="sc">\n</span><span class="st">(SSR)"</span>, <span class="st">"Niewyjaśniona</span><span class="sc">\n</span><span class="st">(SSE)"</span>),</span>
<span id="cb264-30"><a href="#cb264-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Proportion =</span> <span class="fu">c</span>(SSR<span class="sc">/</span>SST, SSE<span class="sc">/</span>SST),</span>
<span id="cb264-31"><a href="#cb264-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">Percentage =</span> <span class="fu">c</span>(SSR<span class="sc">/</span>SST <span class="sc">*</span> <span class="dv">100</span>, SSE<span class="sc">/</span>SST <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb264-32"><a href="#cb264-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb264-33"><a href="#cb264-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-34"><a href="#cb264-34" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prop_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> Proportion, <span class="at">fill =</span> Component)) <span class="sc">+</span></span>
<span id="cb264-35"><a href="#cb264-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb264-36"><a href="#cb264-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb264-37"><a href="#cb264-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"green3"</span>, <span class="st">"red3"</span>)) <span class="sc">+</span></span>
<span id="cb264-38"><a href="#cb264-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage, <span class="dv">1</span>), <span class="st">"%"</span>)), </span>
<span id="cb264-39"><a href="#cb264-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb264-40"><a href="#cb264-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">6</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb264-41"><a href="#cb264-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"R² = "</span>, <span class="fu">round</span>(r_squared, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb264-42"><a href="#cb264-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb264-43"><a href="#cb264-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb264-44"><a href="#cb264-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb264-45"><a href="#cb264-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb264-46"><a href="#cb264-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-47"><a href="#cb264-47" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p><strong>Wzory na R-kwadrat:</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{25.20}{34} = 0.74</span></p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{8.80}{34} = 0.74</span></p>
<p><strong>Interpretacja:</strong> Nasz model wyjaśnia 74% zmienności ocen umiejętności!</p>
</section>
<section id="wizualizacja-4-r²-jako-korelacja-między-odchyleniami" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-4-r²-jako-korelacja-między-odchyleniami">Wizualizacja 4: R² jako Korelacja między Odchyleniami</h3>
<p>To pokazuje <strong>geometryczną interpretację</strong> R²: jak dobrze przewidywane odchylenia od średniej pasują do rzeczywistych odchyleń.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie odchyleń</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>actual_dev <span class="ot">&lt;-</span> skill <span class="sc">-</span> mean_y</span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted_dev <span class="ot">&lt;-</span> data<span class="sc">$</span>predicted <span class="sc">-</span> mean_y</span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie obok siebie</span></span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice)) <span class="sc">+</span></span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> actual_dev, <span class="at">xend =</span> Practice), </span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> actual_dev), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Rzeczywiste Odchylenia od Średniej"</span>,</span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">expression</span>(Y[i] <span class="sc">-</span> <span class="fu">bar</span>(Y)),</span>
<span id="cb265-15"><a href="#cb265-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Godziny Ćwiczeń"</span>,</span>
<span id="cb265-16"><a href="#cb265-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Odchylenie od Średniej"</span></span>
<span id="cb265-17"><a href="#cb265-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb265-18"><a href="#cb265-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb265-19"><a href="#cb265-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb265-20"><a href="#cb265-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-21"><a href="#cb265-21" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Practice)) <span class="sc">+</span></span>
<span id="cb265-22"><a href="#cb265-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb265-23"><a href="#cb265-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> predicted_dev, <span class="at">xend =</span> Practice), </span>
<span id="cb265-24"><a href="#cb265-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb265-25"><a href="#cb265-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"inches"</span>))) <span class="sc">+</span></span>
<span id="cb265-26"><a href="#cb265-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> predicted_dev), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb265-27"><a href="#cb265-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb265-28"><a href="#cb265-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Przewidywane Odchylenia od Średniej"</span>,</span>
<span id="cb265-29"><a href="#cb265-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(Y)[i] <span class="sc">-</span> <span class="fu">bar</span>(Y)),</span>
<span id="cb265-30"><a href="#cb265-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Godziny Ćwiczeń"</span>,</span>
<span id="cb265-31"><a href="#cb265-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Odchylenie od Średniej"</span></span>
<span id="cb265-32"><a href="#cb265-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb265-33"><a href="#cb265-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb265-34"><a href="#cb265-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb265-35"><a href="#cb265-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-36"><a href="#cb265-36" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="wizualizacja-5-wykres-rozrzutu-odchyleń-interpretacja-r²" class="level3">
<h3 class="anchored" data-anchor-id="wizualizacja-5-wykres-rozrzutu-odchyleń-interpretacja-r²">Wizualizacja 5: Wykres Rozrzutu Odchyleń (Interpretacja R²)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> predicted_dev, <span class="at">y =</span> actual_dev)) <span class="sc">+</span></span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, </span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fl">2.5</span>, </span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Gdyby dopasowanie idealne:</span><span class="sc">\n</span><span class="st">wszystkie punkty na tej linii</span><span class="sc">\n</span><span class="st">(R² = 1)"</span>), </span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">3</span>, </span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Korelacja = "</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(r_squared), <span class="dv">3</span>), </span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"</span><span class="sc">\n</span><span class="st">R² = "</span>, <span class="fu">round</span>(r_squared, <span class="dv">3</span>)), </span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"R² Mierzy, Jak Dobrze Przewidywane Odchylenia Pasują do Rzeczywistych"</span>,</span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Każdy punkt porównuje przewidywanie modelu z rzeczywistością (obie względem średniej)"</span>,</span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Odchylenie Przewidywane: "</span>, <span class="fu">hat</span>(Y)[i] <span class="sc">-</span> <span class="fu">bar</span>(Y))),</span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Odchylenie Rzeczywiste: "</span>, Y[i] <span class="sc">-</span> <span class="fu">bar</span>(Y)))</span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Kluczowa Obserwacja:</strong></p>
<p>R² to dosłownie kwadrat korelacji między:</p>
<ul>
<li><p>Tym, co przewiduje model (względem średniej)</p></li>
<li><p>Tym, co rzeczywiście się zdarzyło (względem średniej)</p></li>
</ul>
<p>Jeśli <span class="math inline">R^2 = 1</span>: wszystkie punkty leżą dokładnie na przekątnej (idealne przewidywania)</p>
<p>Jeśli <span class="math inline">R^2 = 0</span>: brak związku między przewidywanymi a rzeczywistymi odchyleniami</p>
</section>
<section id="tabela-podsumowująca" class="level3">
<h3 class="anchored" data-anchor-id="tabela-podsumowująca">Tabela Podsumowująca</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie tabeli podsumowującej</span></span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statystyka =</span> <span class="fu">c</span>(<span class="st">"Liczebność próby (n)"</span>, </span>
<span id="cb268-4"><a href="#cb268-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Średnia Ćwiczeń (X̄)"</span>, </span>
<span id="cb268-5"><a href="#cb268-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Średnia Umiejętności (Ȳ)"</span>,</span>
<span id="cb268-6"><a href="#cb268-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Korelacja (r)"</span>,</span>
<span id="cb268-7"><a href="#cb268-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Wyraz wolny (β₀)"</span>,</span>
<span id="cb268-8"><a href="#cb268-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Nachylenie (β₁)"</span>,</span>
<span id="cb268-9"><a href="#cb268-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"R-kwadrat"</span>,</span>
<span id="cb268-10"><a href="#cb268-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"SST (Całkowita)"</span>,</span>
<span id="cb268-11"><a href="#cb268-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"SSR (Wyjaśniona)"</span>,</span>
<span id="cb268-12"><a href="#cb268-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"SSE (Niewyjaśniona)"</span>),</span>
<span id="cb268-13"><a href="#cb268-13" aria-hidden="true" tabindex="-1"></a>  Wartość <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">6</span>,</span>
<span id="cb268-14"><a href="#cb268-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(mean_x, <span class="dv">2</span>),</span>
<span id="cb268-15"><a href="#cb268-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(mean_y, <span class="dv">2</span>),</span>
<span id="cb268-16"><a href="#cb268-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">cor</span>(practice, skill), <span class="dv">3</span>),</span>
<span id="cb268-17"><a href="#cb268-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(coef_model[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb268-18"><a href="#cb268-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(coef_model[<span class="dv">2</span>], <span class="dv">2</span>),</span>
<span id="cb268-19"><a href="#cb268-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(r_squared, <span class="dv">3</span>),</span>
<span id="cb268-20"><a href="#cb268-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(SST, <span class="dv">2</span>),</span>
<span id="cb268-21"><a href="#cb268-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(SSR, <span class="dv">2</span>),</span>
<span id="cb268-22"><a href="#cb268-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(SSE, <span class="dv">2</span>))</span>
<span id="cb268-23"><a href="#cb268-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb268-24"><a href="#cb268-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-25"><a href="#cb268-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats, <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Statystyka</th>
<th style="text-align: right;">Wartość</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Liczebność próby (n)</td>
<td style="text-align: right;">6.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Średnia Ćwiczeń (X̄)</td>
<td style="text-align: right;">3.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Średnia Umiejętności (Ȳ)</td>
<td style="text-align: right;">7.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Korelacja (r)</td>
<td style="text-align: right;">0.861</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wyraz wolny (β₀)</td>
<td style="text-align: right;">2.800</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nachylenie (β₁)</td>
<td style="text-align: right;">1.200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R-kwadrat</td>
<td style="text-align: right;">0.741</td>
</tr>
<tr class="even">
<td style="text-align: left;">SST (Całkowita)</td>
<td style="text-align: right;">34.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SSR (Wyjaśniona)</td>
<td style="text-align: right;">25.200</td>
</tr>
<tr class="even">
<td style="text-align: left;">SSE (Niewyjaśniona)</td>
<td style="text-align: right;">8.800</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="kluczowe-wnioski" class="level3">
<h3 class="anchored" data-anchor-id="kluczowe-wnioski">Kluczowe Wnioski</h3>
<p><strong>Regresja MNK:</strong></p>
<ul>
<li><p>Znajduje linię minimalizującą sumę kwadratów reszt</p></li>
<li><p>Produkuje nieobciążone estymatory o minimalnej wariancji (BLUE)</p></li>
</ul>
<p><strong>R-kwadrat (0.74) oznacza:</strong></p>
<ol type="1">
<li><p>74% zmienności umiejętności jest wyjaśnione przez godziny ćwiczeń</p></li>
<li><p>Korelacja między przewidywanymi a rzeczywistymi odchyleniami wynosi <span class="math inline">\sqrt{0.74} = 0.86</span></p></li>
<li><p>SSR stanowi 74% SST; SSE stanowi 26% SST</p></li>
</ol>
<p><strong>Interpretacja Geometryczna:</strong></p>
<ul>
<li><p>Całkowita zmienność = odległość każdego punktu od średniej</p></li>
<li><p>Model uchwytuje 74% tych odległości przez linię regresji</p></li>
<li><p>Pozostałe 26% jest niewyjaśnione (reszty)</p></li>
</ul>
<p><strong>Implikacja Praktyczna:</strong></p>
<p>Każda dodatkowa godzina ćwiczeń zwiększa oczekiwaną umiejętność o <strong>1.2 punktu</strong>, a ten związek wyjaśnia większość (ale nie całość) obserwowanej zmienności!</p>
</section>
</section>
<section id="przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą" class="level2" data-number="10.15">
<h2 data-number="10.15" class="anchored" data-anchor-id="przykład-1.-analiza-związku-między-dobrobytem-ekonomicznym-a-frekwencją-wyborczą"><span class="header-section-number">10.15</span> Przykład 1. Analiza związku między dobrobytem ekonomicznym a frekwencją wyborczą</h2>
<p>Analiza związku między dobrobytem ekonomicznym a frekwencją wyborczą w dzielnicach średniej wielkości europejskiego miasta na podstawie danych z wyborów samorządowych.</p>
<section id="dane" class="level3">
<h3 class="anchored" data-anchor-id="dane">Dane</h3>
<p>Próba obejmuje pięć reprezentatywnych dzielnic:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Dzielnica</th>
<th>Dochód (tys. €)</th>
<th>Frekwencja (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Dzielnica A</td>
<td>50</td>
<td>60</td>
</tr>
<tr class="even">
<td>Dzielnica B</td>
<td>45</td>
<td>56</td>
</tr>
<tr class="odd">
<td>Dzielnica C</td>
<td>56</td>
<td>70</td>
</tr>
<tr class="even">
<td>Dzielnica D</td>
<td>40</td>
<td>50</td>
</tr>
<tr class="odd">
<td>Dzielnica E</td>
<td>60</td>
<td>75</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wczytanie bibliotek</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Utworzenie zbioru danych</span></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dzielnica =</span> <span class="fu">c</span>(<span class="st">"Dzielnica A"</span>, <span class="st">"Dzielnica B"</span>, <span class="st">"Dzielnica C"</span>, <span class="st">"Dzielnica D"</span>, <span class="st">"Dzielnica E"</span>),</span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dochod =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>),</span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">frekwencja =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>)</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Podgląd danych</span></span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>dane</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    dzielnica dochod frekwencja
1 Dzielnica A     50         60
2 Dzielnica B     45         56
3 Dzielnica C     56         70
4 Dzielnica D     40         50
5 Dzielnica E     60         75</code></pre>
</div>
</div>
</section>
<section id="część-1-statystyki-opisowe" class="level3">
<h3 class="anchored" data-anchor-id="część-1-statystyki-opisowe">Część 1: Statystyki opisowe</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki dla dochodu</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"DOCHÓD (tys. €):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DOCHÓD (tys. €):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnia:"</span>, <span class="fu">mean</span>(dane<span class="sc">$</span>dochod), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnia: 50.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mediana:"</span>, <span class="fu">median</span>(dane<span class="sc">$</span>dochod), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mediana: 50 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odchylenie standardowe:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(dane<span class="sc">$</span>dochod), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odchylenie standardowe: 8.07 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Zakres:"</span>, <span class="fu">min</span>(dane<span class="sc">$</span>dochod), <span class="st">"-"</span>, <span class="fu">max</span>(dane<span class="sc">$</span>dochod), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zakres: 40 - 60 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki dla frekwencji</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"FREKWENCJA (%):</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FREKWENCJA (%):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnia:"</span>, <span class="fu">mean</span>(dane<span class="sc">$</span>frekwencja), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnia: 62.2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mediana:"</span>, <span class="fu">median</span>(dane<span class="sc">$</span>frekwencja), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mediana: 60 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odchylenie standardowe:"</span>, <span class="fu">round</span>(<span class="fu">sd</span>(dane<span class="sc">$</span>frekwencja), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odchylenie standardowe: 10.21 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Zakres:"</span>, <span class="fu">min</span>(dane<span class="sc">$</span>frekwencja), <span class="st">"-"</span>, <span class="fu">max</span>(dane<span class="sc">$</span>frekwencja))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Zakres: 50 - 75</code></pre>
</div>
</div>
</section>
<section id="część-2-analiza-korelacji" class="level3">
<h3 class="anchored" data-anchor-id="część-2-analiza-korelacji">Część 2: Analiza korelacji</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test korelacji Pearsona</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>korelacja <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(dane<span class="sc">$</span>dochod, dane<span class="sc">$</span>frekwencja)</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Współczynnik korelacji (r):"</span>, <span class="fu">round</span>(korelacja<span class="sc">$</span>estimate, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Współczynnik korelacji (r): 0.994 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"P-value:"</span>, <span class="fu">round</span>(korelacja<span class="sc">$</span>p.value, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P-value: 0.001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpretacja</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (korelacja<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Wynik jest statystycznie istotny (p &lt; 0.05)"</span>)</span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Wynik nie jest statystycznie istotny (p ≥ 0.05)"</span>)</span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wynik jest statystycznie istotny (p &lt; 0.05)</code></pre>
</div>
</div>
</section>
<section id="część-3-model-regresji-liniowej" class="level3">
<h3 class="anchored" data-anchor-id="część-3-model-regresji-liniowej">Część 3: Model regresji liniowej</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu</span></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(frekwencja <span class="sc">~</span> dochod, <span class="at">data =</span> dane)</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podstawowe informacje o modelu</span></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = frekwencja ~ dochod, data = dane)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
dochod       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R-squared - jak dobrze model wyjaśnia dane</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Model wyjaśnia"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% zmienności frekwencji"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model wyjaśnia 98.9 % zmienności frekwencji</code></pre>
</div>
</div>
</section>
<section id="część-4-wizualizacja" class="level3">
<h3 class="anchored" data-anchor-id="część-4-wizualizacja">Część 4: Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykres rozrzutu z linią regresji</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> dochod, <span class="at">y =</span> frekwencja)) <span class="sc">+</span></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> dzielnica), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Dochód vs Frekwencja wyborcza"</span>,</span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"r ="</span>, <span class="fu">round</span>(korelacja<span class="sc">$</span>estimate, <span class="dv">3</span>)),</span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Średni dochód (tys. €)"</span>,</span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frekwencja wyborcza (%)"</span></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/plot-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="część-5-interpretacja-wyników" class="level3">
<h3 class="anchored" data-anchor-id="część-5-interpretacja-wyników">Część 5: Interpretacja wyników</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pobranie współczynników</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>wspolczynniki <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>przeciecie <span class="ot">&lt;-</span> <span class="fu">round</span>(wspolczynniki[<span class="dv">1</span>], <span class="dv">1</span>)</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>nachylenie <span class="ot">&lt;-</span> <span class="fu">round</span>(wspolczynniki[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"RÓWNANIE REGRESJI:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RÓWNANIE REGRESJI:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Frekwencja ="</span>, przeciecie, <span class="st">"+"</span>, nachylenie, <span class="st">"× Dochód</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frekwencja = -0.9 + 1.26 × Dochód</code></pre>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"INTERPRETACJA:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>INTERPRETACJA:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"• Wzrost dochodu o 1000€ zwiększa frekwencję o"</span>, nachylenie, <span class="st">"punktów procentowych</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• Wzrost dochodu o 1000€ zwiększa frekwencję o 1.26 punktów procentowych</code></pre>
</div>
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"• Korelacja jest"</span>, <span class="fu">ifelse</span>(korelacja<span class="sc">$</span>estimate <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"dodatnia"</span>, <span class="st">"ujemna"</span>), </span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"i"</span>, <span class="fu">ifelse</span>(<span class="fu">abs</span>(korelacja<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"silna"</span>, </span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">ifelse</span>(<span class="fu">abs</span>(korelacja<span class="sc">$</span>estimate) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">"umiarkowana"</span>, <span class="st">"słaba"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>• Korelacja jest dodatnia i silna</code></pre>
</div>
</div>
</section>
<section id="wnioski" class="level3">
<h3 class="anchored" data-anchor-id="wnioski">Wnioski</h3>
<p><strong>Główne ustalenia:</strong></p>
<ul>
<li>Istnieje silna dodatnia korelacja (r = 0.994) między dochodem a frekwencją wyborczą</li>
<li>Model wyjaśnia 98.9% zmienności w danych</li>
<li>Dzielnice z wyższymi dochodami mają wyższą frekwencję wyborczą</li>
</ul>
<p><strong>Ważne ograniczenie:</strong></p>
<p>⚠️ Mała próba (n=5) oznacza, że wyniki należy traktować ostrożnie i nie można ich generalizować na całą populację bez dodatkowych badań.</p>
<p><strong>Praktyczne zastosowanie:</strong></p>
<p>Wyniki sugerują, że działania mające na celu zwiększenie frekwencji wyborczej powinny szczególnie koncentrować się na dzielnicach o niższych dochodach.</p>
<p><strong>Ograniczenia i zastrzeżenia:</strong></p>
<p>⚠️ <strong>Krytyczne ograniczenia:</strong></p>
<ul>
<li><strong>Bardzo mała próba</strong> (n=5) znacznie ogranicza możliwość generalizacji</li>
<li><strong>Niska moc statystyczna</strong> - ryzyko błędów II rodzaju</li>
<li><strong>Brak kontroli zmiennych zakłócających</strong> (wiek, wykształcenie, gęstość zaludnienia)</li>
<li><strong>Możliwa korelacja pozorna</strong> - potrzebne dodatkowe zmienne kontrolne</li>
</ul>
<p><strong>Rekomendacje dla przyszłych badań:</strong></p>
<ul>
<li>Zwiększenie próby do wszystkich dzielnic miasta</li>
<li>Włączenie zmiennych demograficznych i socjoekonomicznych</li>
<li>Analiza danych longitudinalnych z kilku cykli wyborczych</li>
</ul>
</section>
</section>
<section id="przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="level2" data-number="10.16">
<h2 data-number="10.16" class="anchored" data-anchor-id="przykład-2.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">10.16</span> Przykład 2. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</h2>
<p>Ta analiza bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Indeks Loosemore-Hanby mierzy dysproporcjonalność wyborczą, gdzie wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane-1" class="level3">
<h3 class="anchored" data-anchor-id="dane-1">Dane</h3>
<div class="cell" data-tbl-cap="Wielkość Okręgu i Indeks LH według Kraju">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'knitr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość Okręgu i Indeks LH według Kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">12.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm">Obliczenia dla Wielkości Okręgu (DM)</h4>
<p>Najpierw obliczam średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{3 + 4 + 5 + 6 + 7 + 8}{6} = \frac{33}{6} = 5.5</span></p>
<p>Następnie obliczam wariancję używając formuły z korektą Bessela:</p>
<p><span class="math display">\sigma^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td><span class="math inline">3 - 5.5 = -2.5</span></td>
<td><span class="math inline">(-2.5)^2 = 6.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td><span class="math inline">4 - 5.5 = -1.5</span></td>
<td><span class="math inline">(-1.5)^2 = 2.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td><span class="math inline">5 - 5.5 = -0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td><span class="math inline">6 - 5.5 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 5.5 = 1.5</span></td>
<td><span class="math inline">(1.5)^2 = 2.25</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td><span class="math inline">8 - 5.5 = 2.5</span></td>
<td><span class="math inline">(2.5)^2 = 6.25</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>17.5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{DM} = \frac{17.5}{6-1} = \frac{17.5}{5} = 3.5</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">\sigma_{DM} = \sqrt{\sigma^2_{DM}} = \sqrt{3.5} = 1.871</span></p>
</section>
<section id="obliczenia-dla-indeksu-lh" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-indeksu-lh">Obliczenia dla Indeksu LH</h4>
<p>Najpierw obliczam średnią wartości LH:</p>
<p><span class="math display">\bar{x}_{LH} = \frac{15.5 + 14.25 + 13.5 + 13.5 + 13 + 12.75}{6} = \frac{82.5}{6} = 13.75</span></p>
<p>Następnie obliczam wariancję:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 17%">
<col style="width: 35%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td><span class="math inline">15.5 - 13.75 = 1.75</span></td>
<td><span class="math inline">(1.75)^2 = 3.0625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td><span class="math inline">14.25 - 13.75 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td><span class="math inline">12.75 - 13.75 = -1</span></td>
<td><span class="math inline">(-1)^2 = 1</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{LH} = \frac{5}{6-1} = \frac{5}{5} = 1</span></p>
<p>Odchylenie standardowe wynosi:</p>
<p><span class="math display">\sigma_{LH} = \sqrt{\sigma^2_{LH}} = \sqrt{1} = 1</span></p>
<p><strong>Podsumowanie Zadania 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 3.5</li>
<li>Odchylenie Standardowe DM: 1.871</li>
<li>Wariancja LH (z korektą Bessela): 1</li>
<li>Odchylenie Standardowe LH: 1</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu formuły z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td>-2.5</td>
<td>1.75</td>
<td><span class="math inline">(-2.5)(1.75) = -4.375</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td>-1.5</td>
<td>0.5</td>
<td><span class="math inline">(-1.5)(0.5) = -0.75</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td>-0.5</td>
<td>-0.25</td>
<td><span class="math inline">(-0.5)(-0.25) = 0.125</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td>0.5</td>
<td>-0.25</td>
<td><span class="math inline">(0.5)(-0.25) = -0.125</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td>1.5</td>
<td>-0.75</td>
<td><span class="math inline">(1.5)(-0.75) = -1.125</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td>2.5</td>
<td>-1</td>
<td><span class="math inline">(2.5)(-1) = -2.5</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-8.75</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-8.75}{5} = -1.75</span></p>
<p><strong>Kowariancja między DM i LH: -1.75</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: gdy wielkość okręgu wzrasta, indeks dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</h3>
<p>Współczynnik korelacji Pearsona obliczany jest przy użyciu formuły:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{\sigma_{DM} \cdot \sigma_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -1.75</span></li>
<li><span class="math inline">\sigma_{DM} = 1.871</span></li>
<li><span class="math inline">\sigma_{LH} = 1</span></li>
</ul>
<p><span class="math display">r = \frac{-1.75}{1.871 \cdot 1} = \frac{-1.75}{1.871} = -0.935</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.935</strong></p>
<section id="interpretacja" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja">Interpretacja:</h4>
<p>Współczynnik korelacji -0.935 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Znak ujemny pokazuje odwrotną zależność między wielkością okręgu a indeksem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.935 wskazuje na bardzo silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości indeksu LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że gdy wielkość okręgu wzrasta, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami (więcej przedstawicieli wybieranych z jednego okręgu) zwykle dają bardziej proporcjonalne wyniki (niższa dysproporcjonalność).</p></li>
</ol>
<p>Odkrycie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi zapewniają więcej możliwości mniejszym partiom, aby uzyskać reprezentację, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</h3>
<p>Formuła dla regresji liniowej prostej:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny (przecięcie)</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Formuła do obliczenia <span class="math inline">\beta_1</span> to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{\sigma^2_{DM}} = \frac{-1.75}{3.5} = -0.5</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, używam:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 13.75 - (-0.5) \cdot 5.5 = 13.75 + 2.75 = 16.5</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.5 - 0.5 \cdot DM</span></p>
<section id="obliczanie-wartości-przewidywanych-i-błędów" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-wartości-przewidywanych-i-błędów">Obliczanie wartości przewidywanych i błędów</h4>
<p>Używając naszego równania regresji, obliczam przewidywane wartości LH:</p>
<p><span class="math inline">\hat{LH} = 16.5 - 0.5 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.5 - 0.5x_i</span>)</th>
<th>Błąd (<span class="math inline">y_i - \hat{y}_i</span>)</th>
<th>Błąd bezwzględny (<span class="math inline">|y_i - \hat{y}_i|</span>)</th>
<th>Błąd kwadratowy (<span class="math inline">[y_i - \hat{y}_i]^2</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td><span class="math inline">16.5 - 0.5(3) = 16.5 - 1.5 = 15</span></td>
<td><span class="math inline">15.5 - 15 = 0.5</span></td>
<td><span class="math inline">|0.5| = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td><span class="math inline">16.5 - 0.5(4) = 16.5 - 2 = 14.5</span></td>
<td><span class="math inline">14.25 - 14.5 = -0.25</span></td>
<td><span class="math inline">|-0.25| = 0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(5) = 16.5 - 2.5 = 14</span></td>
<td><span class="math inline">13.5 - 14 = -0.5</span></td>
<td><span class="math inline">|-0.5| = 0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(6) = 16.5 - 3 = 13.5</span></td>
<td><span class="math inline">13.5 - 13.5 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td><span class="math inline">16.5 - 0.5(7) = 16.5 - 3.5 = 13</span></td>
<td><span class="math inline">13 - 13 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td><span class="math inline">16.5 - 0.5(8) = 16.5 - 4 = 12.5</span></td>
<td><span class="math inline">12.75 - 12.5 = 0.25</span></td>
<td><span class="math inline">|0.25| = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>1.5</strong></td>
<td><strong>0.625</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="obliczanie-r-kwadrat" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-r-kwadrat">Obliczanie R-kwadrat</h4>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Obliczyliśmy już te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td>1.75</td>
<td>3.0625</td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td>0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td>-0.75</td>
<td>0.5625</td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SST = 5</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math inline">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15</td>
<td><span class="math inline">15 - 13.75 = 1.25</span></td>
<td><span class="math inline">(1.25)^2 = 1.5625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.5</td>
<td><span class="math inline">14.5 - 13.75 = 0.75</span></td>
<td><span class="math inline">(0.75)^2 = 0.5625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>14</td>
<td><span class="math inline">14 - 13.75 = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.5</td>
<td><span class="math inline">12.5 - 13.75 = -1.25</span></td>
<td><span class="math inline">(-1.25)^2 = 1.5625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>4.375</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SSR = 4.375</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math inline">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<p>Z tabeli powyżej, suma kwadratów błędów wynosi:</p>
<p><span class="math inline">SSE = 0.625</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia sprawdzając, czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math inline">5 = 4.375 + 0.625 = 5 \checkmark</span></p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math inline">R^2 = \frac{SSR}{SST} = \frac{4.375}{5} = 0.875</span></p>
</section>
<section id="obliczanie-rmse-root-mean-square-error" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-rmse-root-mean-square-error">Obliczanie RMSE (Root Mean Square Error)</h4>
<p>RMSE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Używając naszego obliczonego SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{0.625}{6}} = \sqrt{0.104} \approx 0.323</span></p>
</section>
<section id="obliczanie-mae-mean-absolute-error" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-mae-mean-absolute-error">Obliczanie MAE (Mean Absolute Error)</h4>
<p>MAE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">MAE = \frac{\sum_{i=1}^{n}|y_i - \hat{y}_i|}{n}</span></p>
<p>Używając sum z tabeli:</p>
<p><span class="math inline">MAE = \frac{1.5}{6} = 0.25</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.5 - 0.5 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.875</p>
<p><strong>RMSE</strong>: 0.323</p>
<p><strong>MAE</strong>: 0.25</p>
</section>
<section id="interpretacja-1" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja-1">Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego wzrostu jednostkowego wielkości okręgu, indeks dysproporcjonalności LH jest oczekiwany spadek o 0.5 jednostki. Wyraz wolny (16.5) reprezentuje oczekiwany indeks LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.875 wskazuje, że około 87.5% wariancji w dysproporcjonalności wyborczej (indeks LH) może być wyjaśnione przez wielkość okręgu. Jest to wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej.</p></li>
<li><p><strong>RMSE i MAE</strong>: Niskie wartości RMSE (0.323) i MAE (0.25) wskazują, że model dobrze dopasowuje się do danych, z małymi błędami predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Odkrycia sugerują, że zwiększanie wielkości okręgu mogłoby być skuteczną strategią reformy wyborczej dla krajów dążących do zmniejszenia dysproporcjonalności między głosami a mandatami. Jednak korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać w wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="przykład-3.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="level2" data-number="10.17">
<h2 data-number="10.17" class="anchored" data-anchor-id="przykład-3.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">10.17</span> Przykład 3. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</h2>
<p>Ta analiza bada związek między wielkością okręgu (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Wskaźnik Loosemore-Hanby mierzy dysproporcjonalność wyborczą, przy czym wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane-2" class="level3">
<h3 class="anchored" data-anchor-id="dane-2">Dane</h3>
<div class="cell" data-tbl-cap="Wielkość okręgu i wskaźnik LH według kraju">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość okręgu i wskaźnik LH według kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Kraj</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="level3">
<h3 class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1">Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm-1" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm-1">Obliczenia dla wielkości okręgu (DM)</h4>
<p>Najpierw obliczę średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{4 + 10 + 3 + 8 + 7 + 4}{6} = \frac{36}{6} = 6</span></p>
<p>Następnie obliczę wariancję z korektą Bessela, korzystając z wzoru:</p>
<p><span class="math display">s^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td><span class="math inline">10 - 6 = 4</span></td>
<td><span class="math inline">(4)^2 = 16</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td><span class="math inline">3 - 6 = -3</span></td>
<td><span class="math inline">(-3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td><span class="math inline">8 - 6 = 2</span></td>
<td><span class="math inline">(2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 6 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>38</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{DM} = \frac{38}{6-1} = \frac{38}{5} = 7.6</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">s_{DM} = \sqrt{s^2_{DM}} = \sqrt{7.6} = 2.757</span></p>
</section>
<section id="obliczenia-dla-wskaźnika-lh" class="level4">
<h4 class="anchored" data-anchor-id="obliczenia-dla-wskaźnika-lh">Obliczenia dla wskaźnika LH</h4>
<p>Najpierw obliczę średnią wartości LH:</p>
<p><span class="math display">\bar{y}_{LH} = \frac{12 + 8 + 15 + 10 + 6 + 13}{6} = \frac{64}{6} = 10.667</span></p>
<p>Następnie obliczę wariancję z korektą Bessela:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 17%">
<col style="width: 34%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td><span class="math inline">12 - 10.667 = 1.333</span></td>
<td><span class="math inline">(1.333)^2 = 1.777</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td><span class="math inline">8 - 10.667 = -2.667</span></td>
<td><span class="math inline">(-2.667)^2 = 7.113</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td><span class="math inline">15 - 10.667 = 4.333</span></td>
<td><span class="math inline">(4.333)^2 = 18.775</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td><span class="math inline">10 - 10.667 = -0.667</span></td>
<td><span class="math inline">(-0.667)^2 = 0.445</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td><span class="math inline">6 - 10.667 = -4.667</span></td>
<td><span class="math inline">(-4.667)^2 = 21.781</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td><span class="math inline">13 - 10.667 = 2.333</span></td>
<td><span class="math inline">(2.333)^2 = 5.443</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{LH} = \frac{55.334}{6-1} = \frac{55.334}{5} = 11.067</span></p>
<p>Odchylenie standardowe to:</p>
<p><span class="math display">s_{LH} = \sqrt{s^2_{LH}} = \sqrt{11.067} = 3.327</span></p>
<p><strong>Podsumowanie kroku 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 7.6</li>
<li>Odchylenie standardowe DM: 2.757</li>
<li>Wariancja LH (z korektą Bessela): 11.067</li>
<li>Odchylenie standardowe LH: 3.327</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="level3">
<h3 class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych">Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu wzoru z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td>-2</td>
<td>1.333</td>
<td><span class="math inline">(-2)(1.333) = -2.666</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td>4</td>
<td>-2.667</td>
<td><span class="math inline">(4)(-2.667) = -10.668</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td>-3</td>
<td>4.333</td>
<td><span class="math inline">(-3)(4.333) = -12.999</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td>2</td>
<td>-0.667</td>
<td><span class="math inline">(2)(-0.667) = -1.334</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td>1</td>
<td>-4.667</td>
<td><span class="math inline">(1)(-4.667) = -4.667</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td>-2</td>
<td>2.333</td>
<td><span class="math inline">(-2)(2.333) = -4.666</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-37</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-37}{6-1} = \frac{-37}{5} = -7.4</span></p>
<p><strong>Kowariancja między DM a LH: -7.4</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: wraz ze wzrostem wielkości okręgu wskaźnik dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="level3">
<h3 class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh">Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</h3>
<p>Współczynnik korelacji Pearsona oblicza się przy użyciu wzoru:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{s_{DM} \cdot s_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -7.4</span></li>
<li><span class="math inline">s_{DM} = 2.757</span></li>
<li><span class="math inline">s_{LH} = 3.327</span></li>
</ul>
<p><span class="math display">r = \frac{-7.4}{2.757 \cdot 3.327} = \frac{-7.4}{9.172} = -0.807</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.807</strong></p>
<section id="interpretacja-2" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja-2">Interpretacja:</h4>
<p>Współczynnik korelacji -0.807 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Ujemny znak pokazuje odwrotną zależność między wielkością okręgu a wskaźnikiem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.807 wskazuje na silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości wskaźnika LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że wraz ze wzrostem wielkości okręgu, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami wyborczymi (więcej przedstawicieli wybieranych w okręgu) mają tendencję do generowania bardziej proporcjonalnych wyników (mniejsza dysproporcjonalność).</p></li>
</ol>
<p>Ustalenie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi wyborcze zapewniają mniejszym partiom więcej możliwości uzyskania reprezentacji, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="level3">
<h3 class="anchored" data-anchor-id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat">Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</h3>
<p>Użyję wzoru na prostą regresję liniową:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Wzór na obliczenie <span class="math inline">\beta_1</span> z korektą Bessela to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{s^2_{DM}} = \frac{-7.4}{7.6} = -0.974</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, użyję:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 10.667 - (-0.974) \cdot 6 = 10.667 + 5.844 = 16.511</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.511 - 0.974 \cdot DM</span></p>
<section id="obliczanie-r-kwadrat-1" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-r-kwadrat-1">Obliczanie R-kwadrat</h4>
<p>Aby właściwie obliczyć R-kwadrat, muszę obliczyć następujące sumy kwadratów:</p>
<ul>
<li>SST (Całkowita suma kwadratów): Mierzy całkowitą zmienność zmiennej zależnej (LH)</li>
<li>SSR (Suma kwadratów regresji): Mierzy zmienność wyjaśnioną przez model regresji</li>
<li>SSE (Suma kwadratów błędów): Mierzy niewyjaśnioną zmienność modelu</li>
</ul>
<p>Najpierw obliczę przewidywane wartości LH, używając naszego równania regresji:</p>
<p><span class="math display">\hat{LH} = 16.511 - 0.974 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.511 - 0.974x_i</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td><span class="math inline">16.511 - 0.974(10) = 16.511 - 9.74 = 6.771</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td><span class="math inline">16.511 - 0.974(3) = 16.511 - 2.922 = 13.589</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td><span class="math inline">16.511 - 0.974(8) = 16.511 - 7.792 = 8.719</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td><span class="math inline">16.511 - 0.974(7) = 16.511 - 6.818 = 9.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
</tbody>
</table>
<p>Teraz, obliczę każdą sumę kwadratów:</p>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Już obliczyliśmy te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>1.333</td>
<td>1.777</td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>-2.667</td>
<td>7.113</td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>4.333</td>
<td>18.775</td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>-0.667</td>
<td>0.445</td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>-4.667</td>
<td>21.781</td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>2.333</td>
<td>5.443</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SST = 55.334</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math display">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>6.771</td>
<td><span class="math inline">6.771 - 10.667 = -3.896</span></td>
<td><span class="math inline">(-3.896)^2 = 15.178</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.589</td>
<td><span class="math inline">13.589 - 10.667 = 2.922</span></td>
<td><span class="math inline">(2.922)^2 = 8.538</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8.719</td>
<td><span class="math inline">8.719 - 10.667 = -1.948</span></td>
<td><span class="math inline">(-1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>9.693</td>
<td><span class="math inline">9.693 - 10.667 = -0.974</span></td>
<td><span class="math inline">(-0.974)^2 = 0.949</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>36.05</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSR = 36.05</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math display">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">y_i - \hat{y}_i</span></th>
<th><span class="math inline">(y_i - \hat{y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">12 - 12.615 = -0.615</span></td>
<td><span class="math inline">(-0.615)^2 = 0.378</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">8 - 6.771 = 1.229</span></td>
<td><span class="math inline">(1.229)^2 = 1.510</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">15 - 13.589 = 1.411</span></td>
<td><span class="math inline">(1.411)^2 = 1.991</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">10 - 8.719 = 1.281</span></td>
<td><span class="math inline">(1.281)^2 = 1.641</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">6 - 9.693 = -3.693</span></td>
<td><span class="math inline">(-3.693)^2 = 13.638</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">13 - 12.615 = 0.385</span></td>
<td><span class="math inline">(0.385)^2 = 0.148</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>19.306</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSE = 19.306</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia, sprawdzając czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math display">55.334 \approx 36.05 + 19.306 = 55.356</span></p>
<p>Niewielka różnica (0.022) wynika z zaokrągleń w obliczeniach.</p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{36.05}{55.334} = 0.652</span></p>
<p>Alternatywnie, możemy też obliczyć:</p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{19.306}{55.334} = 1 - 0.349 = 0.651</span></p>
<p>Drobna różnica wynika z zaokrągleń.</p>
</section>
<section id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego">Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</h4>
<p>Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</p>
<p>RMSE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Korzystając z naszej obliczonej SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{19.306}{6}} = \sqrt{3.218} = 1.794</span></p>
<p>Korekta Bessela (dzielenie przez n-1 zamiast n) stosuje się do estymacji wariancji próby, ale nie jest standardowo stosowana przy obliczaniu RMSE, gdyż RMSE jest miarą błędu predykcji, a nie estymatorem parametru populacji.</p>
</section>
<section id="obliczanie-mae-średni-błąd-bezwzględny" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-mae-średni-błąd-bezwzględny">Obliczanie MAE (Średni błąd bezwzględny)</h4>
<p>MAE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">MAE = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">|y_i - \hat{y}_i|</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">|12 - 12.615| = 0.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">|8 - 6.771| = 1.229</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">|15 - 13.589| = 1.411</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">|10 - 8.719| = 1.281</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">|6 - 9.693| = 3.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">|13 - 12.615| = 0.385</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>8.614</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">MAE = \frac{8.614}{6} = 1.436</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.511 - 0.974 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.651</p>
<p><strong>RMSE</strong>: 1.794</p>
<p><strong>MAE</strong>: 1.436</p>
</section>
<section id="interpretacja-3" class="level4">
<h4 class="anchored" data-anchor-id="interpretacja-3">Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego jednostkowego wzrostu wielkości okręgu, wskaźnik dysproporcjonalności LH zmniejsza się o 0.974 jednostki. Wyraz wolny (16.511) reprezentuje oczekiwany wskaźnik LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.651 wskazuje, że około 65.1% wariancji dysproporcjonalności wyborczej (wskaźnik LH) może być wyjaśnione przez wielkość okręgu. Jest to dość wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej, choć mniejszym niż w poprzednim zestawie danych.</p></li>
<li><p><strong>RMSE</strong>: Wartość 1.794 informuje nas o przeciętnym błędzie prognozy modelu. Jest to miara dokładności przewidywań modelu wyrażona w jednostkach zmiennej zależnej (LH).</p></li>
<li><p><strong>MAE</strong>: Wartość 1.436 informuje nas o przeciętnym bezwzględnym błędzie prognozy modelu. W porównaniu z RMSE, MAE jest mniej czuły na wartości odstające, co potwierdza, że niektóre obserwacje (np. dla kraju E) mają stosunkowo duży błąd predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Wyniki sugerują, że zwiększenie wielkości okręgu mogłoby być skuteczną strategią reform wyborczych dla krajów starających się zmniejszyć dysproporcjonalność między głosami a mandatami. Jednakże, korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać we wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="przykład-4.-lęk-vs.-wyniki-egzaminu-analiza-korelacji-i-regresji" class="level2" data-number="10.18">
<h2 data-number="10.18" class="anchored" data-anchor-id="przykład-4.-lęk-vs.-wyniki-egzaminu-analiza-korelacji-i-regresji"><span class="header-section-number">10.18</span> Przykład 4. Lęk vs.&nbsp;Wyniki Egzaminu: Analiza Korelacji i Regresji</h2>
<p>W tym tutorialu zbadamy związek między poziomem lęku przed egzaminem a wynikami egzaminacyjnymi wśród studentów uniwersytetu. Badania sugerują, że podczas gdy niewielka ilość lęku może być motywująca, nadmierny lęk zazwyczaj pogarsza wyniki poprzez zmniejszoną koncentrację, zakłócenia pamięci roboczej i objawy fizyczne (Yerkes-Dodson law). Przeanalizujemy dane od 8 studentów, aby zrozumieć ten związek matematycznie.</p>
<section id="prezentacja-danych" class="level3">
<h3 class="anchored" data-anchor-id="prezentacja-danych">Prezentacja Danych</h3>
<section id="zbiór-danych" class="level4">
<h4 class="anchored" data-anchor-id="zbiór-danych">Zbiór Danych</h4>
<p>Zebraliśmy dane od 8 studentów, mierząc:</p>
<ul>
<li><strong>X</strong>: Wynik lęku przed testem (skala 1-10, gdzie 1 = bardzo niski, 10 = bardzo wysoki)</li>
<li><strong>Y</strong>: Wyniki egzaminu (wynik procentowy)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nasze dane</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a>lęk <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.2</span>, <span class="fl">4.1</span>, <span class="fl">4.8</span>, <span class="fl">5.6</span>, <span class="fl">6.3</span>, <span class="fl">7.0</span>, <span class="fl">7.9</span>)      <span class="co"># Wyniki lęku</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a>wyniki <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">77</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>)            <span class="co"># Wyniki egzaminu (%)</span></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie ramki danych dla łatwego przeglądu</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>  Lęk <span class="ot">=</span> lęk,</span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Wyniki =</span> wyniki</span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Student Lęk Wyniki
1       1 2.5     80
2       2 3.2     85
3       3 4.1     78
4       4 4.8     82
5       5 5.6     77
6       6 6.3     74
7       7 7.0     68
8       8 7.9     72</code></pre>
</div>
</div>
</section>
<section id="wstępna-wizualizacja" class="level4">
<h4 class="anchored" data-anchor-id="wstępna-wizualizacja">Wstępna Wizualizacja</h4>
<p>Najpierw zwizualizujmy nasze dane, aby uzyskać intuicyjne zrozumienie związku:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie wykresu punktowego</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> Lęk, <span class="at">y =</span> Wyniki)) <span class="sc">+</span></span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb316-6"><a href="#cb316-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb316-7"><a href="#cb316-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Lęk przed Testem vs. Wyniki Egzaminu"</span>,</span>
<span id="cb316-8"><a href="#cb316-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wynik Lęku przed Testem"</span>,</span>
<span id="cb316-9"><a href="#cb316-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Wyniki Egzaminu (%)"</span></span>
<span id="cb316-10"><a href="#cb316-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb316-11"><a href="#cb316-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb316-12"><a href="#cb316-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb316-13"><a href="#cb316-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="statystyki-opisowe" class="level3">
<h3 class="anchored" data-anchor-id="statystyki-opisowe">Statystyki Opisowe</h3>
<section id="obliczanie-średnich" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-średnich">Obliczanie Średnich</h4>
<p>Średnia to wartość przeciętna, obliczana przez zsumowanie wszystkich obserwacji i podzielenie przez liczbę obserwacji.</p>
<p><strong>Średnia Wyników Lęku (X):</strong> <span class="math display">\bar{X} = \frac{\sum_{i=1}^{n} X_i}{n} = \frac{2,5 + 3,2 + 4,1 + 4,8 + 5,6 + 6,3 + 7,0 + 7,9}{8}</span></p>
<p><span class="math display">\bar{X} = \frac{41,4}{8} = 5,175</span></p>
<p><strong>Średnia Wyników Egzaminu (Y):</strong> <span class="math display">\bar{Y} = \frac{\sum_{i=1}^{n} Y_i}{n} = \frac{80 + 85 + 78 + 82 + 77 + 74 + 68 + 72}{8}</span></p>
<p><span class="math display">\bar{Y} = \frac{616}{8} = 77</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja naszych obliczeń</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a>średnia_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(lęk)</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a>średnia_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(wyniki)</span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średni Lęk:"</span>, średnia_x, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średni Lęk: 5.175 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnie Wyniki:"</span>, średnia_y, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnie Wyniki: 77 </code></pre>
</div>
</div>
</section>
<section id="obliczanie-wariancji-i-odchylenia-standardowego" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-wariancji-i-odchylenia-standardowego">Obliczanie Wariancji i Odchylenia Standardowego</h4>
<p>Wariancja mierzy, jak bardzo rozproszone są dane od średniej. Używamy wzoru na wariancję próbkową (dzieląc przez n-1).</p>
<p><strong>Wariancja X:</strong></p>
<p>Najpierw obliczamy odchylenia od średniej <span class="math inline">(X_i - \bar{X})</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">X_i - \bar{X}</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2,5</td>
<td><span class="math inline">2,5 - 5,175 = -2,675</span></td>
<td><span class="math inline">(-2,675)^2 = 7,1556</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>3,2</td>
<td><span class="math inline">3,2 - 5,175 = -1,975</span></td>
<td><span class="math inline">(-1,975)^2 = 3,9006</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>4,1</td>
<td><span class="math inline">4,1 - 5,175 = -1,075</span></td>
<td><span class="math inline">(-1,075)^2 = 1,1556</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4,8</td>
<td><span class="math inline">4,8 - 5,175 = -0,375</span></td>
<td><span class="math inline">(-0,375)^2 = 0,1406</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5,6</td>
<td><span class="math inline">5,6 - 5,175 = 0,425</span></td>
<td><span class="math inline">(0,425)^2 = 0,1806</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6,3</td>
<td><span class="math inline">6,3 - 5,175 = 1,125</span></td>
<td><span class="math inline">(1,125)^2 = 1,2656</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>7,0</td>
<td><span class="math inline">7,0 - 5,175 = 1,825</span></td>
<td><span class="math inline">(1,825)^2 = 3,3306</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>7,9</td>
<td><span class="math inline">7,9 - 5,175 = 2,725</span></td>
<td><span class="math inline">(2,725)^2 = 7,4256</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>24,555</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1} = \frac{24,555}{7} = 3,5079</span></p>
<p><span class="math display">s_X = \sqrt{3,5079} = 1,8730</span></p>
<p><strong>Wariancja Y:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">Y_i - \bar{Y}</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>80</td>
<td><span class="math inline">80 - 77 = 3</span></td>
<td><span class="math inline">(3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>85</td>
<td><span class="math inline">85 - 77 = 8</span></td>
<td><span class="math inline">(8)^2 = 64</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>78</td>
<td><span class="math inline">78 - 77 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>82</td>
<td><span class="math inline">82 - 77 = 5</span></td>
<td><span class="math inline">(5)^2 = 25</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>77</td>
<td><span class="math inline">77 - 77 = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>74</td>
<td><span class="math inline">74 - 77 = -3</span></td>
<td><span class="math inline">(-3)^2 = 9</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>68</td>
<td><span class="math inline">68 - 77 = -9</span></td>
<td><span class="math inline">(-9)^2 = 81</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>72</td>
<td><span class="math inline">72 - 77 = -5</span></td>
<td><span class="math inline">(-5)^2 = 25</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>214</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_Y = \frac{\sum(Y_i - \bar{Y})^2}{n-1} = \frac{214}{7} = 30,5714</span></p>
<p><span class="math display">s_Y = \sqrt{30,5714} = 5,5291</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja wariancji i odchylenia standardowego</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja Lęku:"</span>, <span class="fu">var</span>(lęk), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja Lęku: 3.507857 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odch. Stand. Lęku:"</span>, <span class="fu">sd</span>(lęk), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odch. Stand. Lęku: 1.872927 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja Wyników:"</span>, <span class="fu">var</span>(wyniki), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja Wyników: 30.57143 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odch. Stand. Wyników:"</span>, <span class="fu">sd</span>(wyniki), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odch. Stand. Wyników: 5.529144 </code></pre>
</div>
</div>
</section>
</section>
<section id="kowariancja-i-korelacja" class="level3">
<h3 class="anchored" data-anchor-id="kowariancja-i-korelacja">Kowariancja i Korelacja</h3>
<section id="obliczanie-kowariancji" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-kowariancji">Obliczanie Kowariancji</h4>
<p>Kowariancja mierzy, jak dwie zmienne zmieniają się razem. Ujemna kowariancja wskazuje, że gdy jedna zmienna wzrasta, druga ma tendencję do spadku.</p>
<p><span class="math display">s_{XY} = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Obliczmy iloczyny dla każdej obserwacji:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Student</th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>-2,675</td>
<td>3</td>
<td><span class="math inline">(-2,675) \times (3) = -8,025</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>-1,975</td>
<td>8</td>
<td><span class="math inline">(-1,975) \times (8) = -15,800</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>-1,075</td>
<td>1</td>
<td><span class="math inline">(-1,075) \times (1) = -1,075</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>-0,375</td>
<td>5</td>
<td><span class="math inline">(-0,375) \times (5) = -1,875</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>0,425</td>
<td>0</td>
<td><span class="math inline">(0,425) \times (0) = 0</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>1,125</td>
<td>-3</td>
<td><span class="math inline">(1,125) \times (-3) = -3,375</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>1,825</td>
<td>-9</td>
<td><span class="math inline">(1,825) \times (-9) = -16,425</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>2,725</td>
<td>-5</td>
<td><span class="math inline">(2,725) \times (-5) = -13,625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>-60,2</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s_{XY} = \frac{-60,2}{7} = -8,6</span></p>
</section>
<section id="obliczanie-współczynnika-korelacji-pearsona" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-współczynnika-korelacji-pearsona">Obliczanie Współczynnika Korelacji Pearsona</h4>
<p>Współczynnik korelacji standaryzuje kowariancję do skali od -1 do +1:</p>
<p><span class="math display">r = \frac{s_{XY}}{s_X \cdot s_Y} = \frac{-8,6}{1,8730 \times 5,5291} = \frac{-8,6}{10,3560} = -0,831</span></p>
<p>To daje nam korelację <strong>-0,831</strong>, wskazującą na silny ujemny związek między lękiem a wynikami.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja korelacji</span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>rzeczywista_kor <span class="ot">&lt;-</span> <span class="fu">cor</span>(lęk, wyniki)</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Współczynnik korelacji Pearsona:"</span>, rzeczywista_kor, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Współczynnik korelacji Pearsona: -0.8304618 </code></pre>
</div>
</div>
</section>
</section>
<section id="prosta-regresja-mnk" class="level3">
<h3 class="anchored" data-anchor-id="prosta-regresja-mnk">Prosta Regresja MNK</h3>
<section id="problem-modelowania-związków" class="level4">
<h4 class="anchored" data-anchor-id="problem-modelowania-związków">Problem Modelowania Związków</h4>
<p>Kiedy obserwujemy związek między dwiema zmiennymi, chcemy znaleźć model matematyczny, który:</p>
<ol type="1">
<li>Opisuje związek</li>
<li>Pozwala nam dokonywać prognoz</li>
<li>Kwantyfikuje siłę związku</li>
</ol>
<p>Najprostszym modelem jest linia prosta: <span class="math display">Y = \beta_0 + \beta_1 X + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y</span> to zmienna wynikowa (wyniki)</li>
<li><span class="math inline">X</span> to zmienna predykcyjna (lęk)</li>
<li><span class="math inline">\beta_0</span> to punkt przecięcia (wyniki gdy lęk = 0)</li>
<li><span class="math inline">\beta_1</span> to nachylenie (zmiana wyników na jednostkę zmiany lęku)</li>
<li><span class="math inline">\epsilon</span> to składnik błędu (niewyjaśniona zmienność)</li>
</ul>
</section>
<section id="idea-sumy-kwadratów-błędów-sse" class="level4">
<h4 class="anchored" data-anchor-id="idea-sumy-kwadratów-błędów-sse">Idea Sumy Kwadratów Błędów (SSE)</h4>
<p>Wyobraź sobie próbę narysowania linii przez nasze punkty danych. Jest nieskończenie wiele linii, które moglibyśmy narysować! Niektóre przeszłyby przez środek punktów, inne mogłyby być za wysokie lub za niskie, za strome lub za płaskie. Potrzebujemy systematycznego sposobu określenia, która linia jest “najlepsza”.</p>
<section id="czym-są-błędy-reszty" class="level5">
<h5 class="anchored" data-anchor-id="czym-są-błędy-reszty">Czym są Błędy (Reszty)?</h5>
<p>Dla każdej linii, którą narysujemy, każdy punkt danych będzie miał <strong>błąd</strong> lub <strong>resztę</strong> - pionową odległość od punktu do linii. To reprezentuje, jak “błędna” jest nasza prognoza dla tego punktu.</p>
<ul>
<li><strong>Błąd dodatni</strong>: Rzeczywista wartość jest powyżej przewidywanej wartości (niedoszacowaliśmy)</li>
<li><strong>Błąd ujemny</strong>: Rzeczywista wartość jest poniżej przewidywanej wartości (przeszacowaliśmy)</li>
</ul>
</section>
<section id="dlaczego-podnosimy-błędy-do-kwadratu" class="level5">
<h5 class="anchored" data-anchor-id="dlaczego-podnosimy-błędy-do-kwadratu">Dlaczego Podnosimy Błędy do Kwadratu?</h5>
<p>Proste dodawanie błędów nie zadziała, ponieważ błędy dodatnie i ujemne się znoszą. Moglibyśmy użyć wartości bezwzględnych, ale podnoszenie do kwadratu ma kilka zalet:</p>
<ol type="1">
<li><strong>Wygoda matematyczna</strong>: Funkcje kwadratowe są różniczkowalne, co ułatwia znalezienie minimum za pomocą rachunku różniczkowego</li>
<li><strong>Penalizuje większe błędy bardziej</strong>: Kilka dużych błędów jest gorsze niż wiele małych błędów</li>
<li><strong>Tworzy gładką, miskowatą funkcję</strong>: To gwarantuje unikalne minimum</li>
</ol>
</section>
<section id="wzór-sse" class="level5">
<h5 class="anchored" data-anchor-id="wzór-sse">Wzór SSE</h5>
<p>Suma Kwadratów Błędów to: <span class="math display">SSE = \sum_{i=1}^{n}(Y_i - \hat{Y_i})^2 = \sum_{i=1}^{n}(Y_i - (\beta_0 + \beta_1 X_i))^2</span></p>
</section>
<section id="znajdowanie-najlepszej-linii" class="level5">
<h5 class="anchored" data-anchor-id="znajdowanie-najlepszej-linii">Znajdowanie Najlepszej Linii</h5>
<p>“Najlepsza” linia to ta, która minimalizuje SSE. Używając rachunku różniczkowego (biorąc pochodne względem <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> i przyrównując je do zera), otrzymujemy wzory MNK.</p>
</section>
</section>
<section id="estymatory-mnk" class="level4">
<h4 class="anchored" data-anchor-id="estymatory-mnk">Estymatory MNK</h4>
<p>Metoda Najmniejszych Kwadratów (MNK) znajduje wartości <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>, które minimalizują SSE:</p>
<p><strong>Estymator nachylenia:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><strong>Estymator punktu przecięcia:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
</section>
<section id="obliczanie-parametrów-mnk" class="level4">
<h4 class="anchored" data-anchor-id="obliczanie-parametrów-mnk">Obliczanie Parametrów MNK</h4>
<p>Używając naszych obliczonych wartości:</p>
<ul>
<li><span class="math inline">s_{XY} = -8,6</span></li>
<li><span class="math inline">s^2_X = 3,5079</span></li>
<li><span class="math inline">\bar{X} = 5,175</span></li>
<li><span class="math inline">\bar{Y} = 77</span></li>
</ul>
<p><strong>Krok 1: Oblicz nachylenie</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-8,6}{3,5079} = -2,451</span></p>
<p><strong>Krok 2: Oblicz punkt przecięcia</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X} = 77 - (-2,451 \times 5,175) = 77 + 12,684 = 89,684</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja z R</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(wyniki <span class="sc">~</span> lęk)</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         lęk 
  89.687233   -2.451639 </code></pre>
</div>
</div>
<p><strong>Nasze równanie regresji to:</strong> <span class="math display">\hat{Y} = 89,684 - 2,451X</span></p>
<p>To oznacza:</p>
<ul>
<li>Gdy lęk = 0, przewidywane wyniki = 89,68%</li>
<li>Za każdy wzrost lęku o 1 punkt, wyniki spadają o 2,45%</li>
</ul>
</section>
</section>
<section id="wykres-modelu" class="level3">
<h3 class="anchored" data-anchor-id="wykres-modelu">Wykres Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stworzenie kompleksowego wykresu</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(lęk, wyniki), <span class="fu">aes</span>(<span class="at">x =</span> lęk, <span class="at">y =</span> wyniki)) <span class="sc">+</span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(lęk, <span class="dv">1</span>), <span class="st">", "</span>, wyniki, <span class="st">")"</span>)),</span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">70</span>, </span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"ŷ = "</span>, <span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">" - "</span>, </span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">abs</span>(<span class="fu">round</span>(<span class="fu">coef</span>(model)[<span class="dv">2</span>], <span class="dv">2</span>)), <span class="st">"x"</span>),</span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb333-14"><a href="#cb333-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Linia Regresji: Wyniki vs. Lęk"</span>,</span>
<span id="cb333-15"><a href="#cb333-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Wyższy lęk jest związany z niższymi wynikami egzaminu"</span>,</span>
<span id="cb333-16"><a href="#cb333-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wynik Lęku przed Testem"</span>,</span>
<span id="cb333-17"><a href="#cb333-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Wyniki Egzaminu (%)"</span></span>
<span id="cb333-18"><a href="#cb333-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb333-19"><a href="#cb333-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb333-20"><a href="#cb333-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb333-21"><a href="#cb333-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">65</span>, <span class="dv">90</span>, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ocena-modelu" class="level3">
<h3 class="anchored" data-anchor-id="ocena-modelu">Ocena Modelu</h3>
<section id="dekompozycja-wariancji" class="level4">
<h4 class="anchored" data-anchor-id="dekompozycja-wariancji">Dekompozycja Wariancji</h4>
<p>Całkowita zmienność w Y może być rozłożona na dwie części:</p>
<p><span class="math display">SST = SSE + SSR</span></p>
<p>Gdzie:</p>
<ul>
<li><strong>SST (Sum of Squares Total)</strong>: Całkowita zmienność w Y</li>
<li><strong>SSE (Sum of Squared Errors)</strong>: Niewyjaśniona zmienność</li>
<li><strong>SSR (Sum of Squares Regression)</strong>: Wyjaśniona zmienność</li>
</ul>
<p>Obliczmy każdą sumę:</p>
<p><strong>Krok 1: Oblicz przewidywane wartości</strong></p>
<p>Używając <span class="math inline">\hat{Y} = 89,684 - 2,451X</span>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i = 89,684 - 2,451X_i</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2,5</td>
<td>80</td>
<td><span class="math inline">89,684 - 2,451(2,5) = 83,556</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>3,2</td>
<td>85</td>
<td><span class="math inline">89,684 - 2,451(3,2) = 81,841</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>4,1</td>
<td>78</td>
<td><span class="math inline">89,684 - 2,451(4,1) = 79,635</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>4,8</td>
<td>82</td>
<td><span class="math inline">89,684 - 2,451(4,8) = 77,919</span></td>
</tr>
<tr class="odd">
<td>5</td>
<td>5,6</td>
<td>77</td>
<td><span class="math inline">89,684 - 2,451(5,6) = 75,968</span></td>
</tr>
<tr class="even">
<td>6</td>
<td>6,3</td>
<td>74</td>
<td><span class="math inline">89,684 - 2,451(6,3) = 74,253</span></td>
</tr>
<tr class="odd">
<td>7</td>
<td>7,0</td>
<td>68</td>
<td><span class="math inline">89,684 - 2,451(7,0) = 72,527</span></td>
</tr>
<tr class="even">
<td>8</td>
<td>7,9</td>
<td>72</td>
<td><span class="math inline">89,684 - 2,451(7,9) = 70,321</span></td>
</tr>
</tbody>
</table>
<p><strong>Krok 2: Oblicz sumy kwadratów</strong></p>
<p><strong>SST</strong> (Całkowita zmienność): <span class="math display">SST = \sum(Y_i - \bar{Y})^2</span></p>
<p>Z naszych wcześniejszych obliczeń wariancji: <span class="math display">SST = (n-1) \times s^2_Y = 7 \times 30,5714 = 214</span></p>
<p><strong>SSE</strong> (Niewyjaśniona zmienność): <span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 26%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">(Y_i - \hat{Y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>80</td>
<td>83,556</td>
<td>-3,556</td>
<td>12,645</td>
</tr>
<tr class="even">
<td>2</td>
<td>85</td>
<td>81,841</td>
<td>3,159</td>
<td>9,979</td>
</tr>
<tr class="odd">
<td>3</td>
<td>78</td>
<td>79,635</td>
<td>-1,635</td>
<td>2,673</td>
</tr>
<tr class="even">
<td>4</td>
<td>82</td>
<td>77,919</td>
<td>4,081</td>
<td>16,655</td>
</tr>
<tr class="odd">
<td>5</td>
<td>77</td>
<td>75,968</td>
<td>1,032</td>
<td>1,065</td>
</tr>
<tr class="even">
<td>6</td>
<td>74</td>
<td>74,253</td>
<td>-0,253</td>
<td>0,064</td>
</tr>
<tr class="odd">
<td>7</td>
<td>68</td>
<td>72,527</td>
<td>-4,527</td>
<td>20,494</td>
</tr>
<tr class="even">
<td>8</td>
<td>72</td>
<td>70,321</td>
<td>1,679</td>
<td>2,819</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>66,394</strong></td>
</tr>
</tbody>
</table>
<p><strong>SSR</strong> (Wyjaśniona zmienność): <span class="math display">SSR = SST - SSE = 214 - 66,394 = 147,606</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja obliczeń</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>tabela_anova <span class="ot">&lt;-</span> <span class="fu">anova</span>(model)</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSR (Regresja):"</span>, tabela_anova<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSR (Regresja): 147.5887 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SSE (Reszty):"</span>, tabela_anova<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SSE (Reszty): 66.41132 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SST (Całkowita):"</span>, <span class="fu">sum</span>(tabela_anova<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SST (Całkowita): 214 </code></pre>
</div>
</div>
</section>
<section id="r-kwadrat-współczynnik-determinacji" class="level4">
<h4 class="anchored" data-anchor-id="r-kwadrat-współczynnik-determinacji">R-kwadrat (Współczynnik Determinacji)</h4>
<p>R-kwadrat mówi nam, jaka część całkowitej zmienności w Y jest wyjaśniona przez nasz model:</p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{147,606}{214} = 0,690</span></p>
<p>To oznacza, że nasz model wyjaśnia <strong>69,0%</strong> zmienności w wynikach egzaminu.</p>
<p><strong>Alternatywny wzór używający korelacji:</strong> <span class="math display">R^2 = r^2 = (-0,831)^2 = 0,691</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja R-kwadrat</span></span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R-kwadrat:"</span>, <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R-kwadrat: 0.6896667 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Korelacja do kwadratu:"</span>, <span class="fu">cor</span>(lęk, wyniki)<span class="sc">^</span><span class="dv">2</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Korelacja do kwadratu: 0.6896667 </code></pre>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dekompozycja wariancji - podsumowanie
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wyobraź sobie, że chcesz zrozumieć, <strong>dlaczego pensje w firmie się różnią</strong>. Jedni zarabiają 40 000, inni 80 000, a jeszcze inni 120 000. Mamy więc <strong>zmienność</strong> wynagrodzeń — nie są takie same.</p>
<section id="całkowita-zmienność-sst" class="level4">
<h4 class="anchored" data-anchor-id="całkowita-zmienność-sst">Całkowita zmienność (SST)</h4>
<p>To pytanie: „<strong>Jak bardzo</strong> wszystkie pensje są rozproszone wokół <strong>średniej pensji</strong>?” Jeśli średnia to 70 000, to SST mierzy, o ile każda pensja różni się od 70 000, <strong>podnosi te różnice do kwadratu</strong> (żeby były dodatnie) i <strong>sumuje</strong>. To <strong>całkowita ilość zmienności, którą próbujemy wyjaśnić</strong>.</p>
</section>
<section id="zmienność-wyjaśniona-ssr" class="level4">
<h4 class="anchored" data-anchor-id="zmienność-wyjaśniona-ssr">Zmienność wyjaśniona (SSR)</h4>
<p>Załóżmy, że budujemy model przewidujący pensję na podstawie <strong>lat doświadczenia</strong>. Model może mówić:</p>
<ul>
<li>2 lata doświadczenia → przewiduje 50 000</li>
<li>5 lat doświadczenia → przewiduje 70 000</li>
<li>10 lat doświadczenia → przewiduje 100 000</li>
</ul>
<p><strong>SSR</strong> mierzy, jak bardzo te <strong>przewidywania różnią się od średniej</strong>. To ta część zmienności, którą model <strong>„wyjaśnia”</strong> relacją z doświadczeniem. Innymi słowy: „tę część różnic w pensjach da się przypisać różnym poziomom doświadczenia”.</p>
</section>
<section id="zmienność-niewyjaśniona-sse" class="level4">
<h4 class="anchored" data-anchor-id="zmienność-niewyjaśniona-sse">Zmienność niewyjaśniona (SSE)</h4>
<p>To to, co <strong>zostaje</strong> — część, której model nie tłumaczy. Może być tak, że dwie osoby mają po 5 lat doświadczenia, ale jedna zarabia 65 000, a druga 75 000. Model obu przewidział 70 000. Te różnice względem przewidywań (<strong>błędy</strong>) reprezentują zmienność wynikającą z innych czynników — np. edukacja, wyniki pracy, umiejętności negocjacyjne albo po prostu losowość.</p>
<blockquote class="blockquote">
<p>Uwaga: <strong>Całkowita zmienność = Zmienność wyjaśniona + Zmienność niewyjaśniona</strong> czyli <strong>SST = SSR + SSE</strong>.</p>
</blockquote>
</section>
<section id="dlaczego-to-ważne" class="level4">
<h4 class="anchored" data-anchor-id="dlaczego-to-ważne">Dlaczego to ważne</h4>
<p>Ta dekompozycja wariancji pozwala policzyć <strong>współczynnik determinacji</strong> <span class="math inline">R^2</span>:</p>
<p><span class="math display">
R^2 = \frac{\mathrm{SSR}}{\mathrm{SST}} = \frac{\text{Zmienność wyjaśniona}}{\text{Całkowita zmienność}}.
</span></p>
<p>Jeśli <span class="math inline">R^2 = 0{,}70</span>, to model <strong>wyjaśnia 70%</strong> tego, <strong>dlaczego wartości</strong> <span class="math inline">Y</span> (tu: pensje) <strong>różnią się między sobą</strong>. Pozostałe 30% to czynniki nieuwzględnione lub szum losowy.</p>
<p>Pomyśl o tym jak o <strong>rozwiązywaniu zagadki</strong>: SST to cała zagadka do rozwiązania, SSR to część już rozwiązana, a SSE to to, co wciąż pozostaje do wyjaśnienia!</p>
</section>
</div>
</div>
<hr>
</section>
</section>
<section id="wielkość-efektu" class="level3">
<h3 class="anchored" data-anchor-id="wielkość-efektu">Wielkość Efektu</h3>
<p>Współczynnik nachylenia <span class="math inline">\hat{\beta_1} = -2,451</span> to nasza wielkość efektu. Mówi nam:</p>
<ul>
<li><strong>Wielkość</strong>: Każdy wzrost lęku o 1 punkt jest związany z 2,45% spadkiem wyników</li>
<li><strong>Znaczenie praktyczne</strong>: Student przechodzący od niskiego lęku (3) do wysokiego lęku (7) doświadczyłby oczekiwanego spadku wyników o <span class="math inline">2,451 \times 4 = 9,80\%</span></li>
</ul>
<p><strong>Standaryzowana wielkość efektu (współczynnik korelacji):</strong> Korelacja <span class="math inline">r = -0,831</span> wskazuje na <strong>silny ujemny związek</strong>.</p>
<p>Wytyczne Cohena dla interpretacji korelacji:</p>
<ul>
<li>Mały efekt: <span class="math inline">|r| = 0,10</span></li>
<li>Średni efekt: <span class="math inline">|r| = 0,30</span></li>
<li>Duży efekt: <span class="math inline">|r| = 0,50</span></li>
</ul>
<p>Nasze <span class="math inline">|r| = 0,831</span> reprezentuje dużą wielkość efektu.</p>
</section>
<section id="przedziały-ufności-i-istotność-statystyczna" class="level3">
<h3 class="anchored" data-anchor-id="przedziały-ufności-i-istotność-statystyczna">Przedziały Ufności i Istotność Statystyczna</h3>
<section id="błąd-standardowy-regresji" class="level4">
<h4 class="anchored" data-anchor-id="błąd-standardowy-regresji">Błąd Standardowy Regresji</h4>
<p>Najpierw potrzebujemy błędu standardowego reszt:</p>
<p><span class="math display">s_e = \sqrt{\frac{SSE}{n-2}} = \sqrt{\frac{66,394}{6}} = \sqrt{11,066} = 3,327</span></p>
</section>
<section id="błąd-standardowy-nachylenia" class="level4">
<h4 class="anchored" data-anchor-id="błąd-standardowy-nachylenia">Błąd Standardowy Nachylenia</h4>
<p>Błąd standardowy <span class="math inline">\hat{\beta_1}</span> to:</p>
<p><span class="math display">BE(\hat{\beta_1}) = \frac{s_e}{\sqrt{\sum(X_i - \bar{X})^2}} = \frac{3,327}{\sqrt{24,555}} = \frac{3,327}{4,955} = 0,671</span></p>
</section>
<section id="przedział-ufności-dla-nachylenia" class="level4">
<h4 class="anchored" data-anchor-id="przedział-ufności-dla-nachylenia">95% Przedział Ufności dla Nachylenia</h4>
<p><strong>Mówiąc prościej:</strong> Przedział ufności daje nam zakres prawdopodobnych wartości dla naszego prawdziwego nachylenia. Gdybyśmy powtórzyli to badanie wiele razy, 95% obliczonych przez nas przedziałów zawierałoby prawdziwą wartość nachylenia.</p>
<p>Wzór używa wartości krytycznej (około 2,45 dla 6 stopni swobody):</p>
<p><span class="math display">PU = \hat{\beta_1} \pm (wartość\_krytyczna \times BE(\hat{\beta_1}))</span> <span class="math display">PU = -2,451 \pm (2,45 \times 0,671)</span> <span class="math display">PU = -2,451 \pm 1,644</span> <span class="math display">PU = [-4,095, -0,807]</span></p>
<p><strong>Interpretacja:</strong> Jesteśmy w 95% pewni, że prawdziwa zmiana wyników na jednostkę zmiany lęku mieści się między -4,10% a -0,81%.</p>
</section>
<section id="istotność-statystyczna" class="level4">
<h4 class="anchored" data-anchor-id="istotność-statystyczna">Istotność Statystyczna</h4>
<p>Aby sprawdzić, czy związek jest statystycznie istotny (tj. nie jest przypadkowy), obliczamy statystykę t:</p>
<p><span class="math display">t = \frac{\hat{\beta_1}}{BE(\hat{\beta_1})} = \frac{-2,451}{0,671} = -3,653</span></p>
<p><strong>Mówiąc prościej:</strong> Ta wartość t mówi nam, o ile błędów standardowych nasze nachylenie odbiega od zera. Wartość bezwzględna 3,65 jest dość duża (zazwyczaj wartości przekraczające ±2,45 są uważane za istotne dla naszej wielkości próby), dostarczając silnego dowodu na rzeczywisty ujemny związek między lękiem a wynikami.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weryfikacja obliczeń z R</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = wyniki ~ lęk)

Residuals:
   Min     1Q Median     3Q    Max 
-4.526 -2.116  0.400  2.050  4.081 

Coefficients:
            Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)  89.6872     3.6682  24.450 0.000000308 ***
lęk          -2.4516     0.6714  -3.652      0.0107 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.327 on 6 degrees of freedom
Multiple R-squared:  0.6897,    Adjusted R-squared:  0.6379 
F-statistic: 13.33 on 1 and 6 DF,  p-value: 0.01069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 80.711582 98.6628838
lęk         -4.094474 -0.8088048</code></pre>
</div>
</div>
</section>
</section>
<section id="podsumowanie-i-interpretacja" class="level3">
<h3 class="anchored" data-anchor-id="podsumowanie-i-interpretacja">Podsumowanie i Interpretacja</h3>
<section id="czego-się-nauczyliśmy" class="level4">
<h4 class="anchored" data-anchor-id="czego-się-nauczyliśmy">Czego się Nauczyliśmy</h4>
<ol type="1">
<li><strong>Istnieje ujemny związek</strong> między lękiem przed testem a wynikami egzaminu (r = -0,831)</li>
<li><strong>Związek jest umiarkowanie silny</strong> - lęk wyjaśnia 69,0% zmienności w wynikach</li>
<li><strong>Efekt jest znaczący</strong> - każdy wzrost lęku o 1 punkt jest związany z około 2,5% spadkiem wyników</li>
<li><strong>Związek jest statystycznie istotny</strong> - bardzo mało prawdopodobne, żeby był przypadkowy</li>
</ol>
</section>
<section id="implikacje-praktyczne" class="level4">
<h4 class="anchored" data-anchor-id="implikacje-praktyczne">Implikacje Praktyczne</h4>
<p>Nasza analiza sugeruje, że wysoki lęk przed testem pogarsza wyniki, prawdopodobnie poprzez:</p>
<ul>
<li>Zakłócenia poznawcze (niepokojące myśli konkurują o pamięć roboczą)</li>
<li>Objawy fizyczne (pocenie się, szybkie bicie serca), które odwracają uwagę od zadania</li>
<li>Negatywny monolog wewnętrzny zmniejszający pewność siebie i motywację</li>
<li>Zachowania podczas testu (pośpiech, podważanie odpowiedzi)</li>
</ul>
</section>
<section id="rekomendacje-na-podstawie-ustaleń" class="level4">
<h4 class="anchored" data-anchor-id="rekomendacje-na-podstawie-ustaleń">Rekomendacje na Podstawie Ustaleń</h4>
<p>Biorąc pod uwagę silny ujemny związek, interwencje mogłyby obejmować:</p>
<ul>
<li>Nauczanie technik zarządzania lękiem (głębokie oddychanie, progresywne rozluźnianie mięśni)</li>
<li>Restrukturyzację poznawczą w celu radzenia sobie z katastroficznym myśleniem</li>
<li>Trening umiejętności nauki w celu zwiększenia pewności siebie w przygotowaniu</li>
<li>Testy próbne w celu zmniejszenia strachu przed nieznanym</li>
</ul>
</section>
<section id="ograniczenia-naszej-analizy" class="level4">
<h4 class="anchored" data-anchor-id="ograniczenia-naszej-analizy">Ograniczenia Naszej Analizy</h4>
<ol type="1">
<li><strong>Mała wielkość próby</strong> (n = 8) ogranicza możliwość uogólnienia</li>
<li><strong>Założenie liniowości</strong> - związek może być krzywoliniowy (może istnieć optymalny lęk)</li>
<li><strong>Inne zmienne</strong> nieuwzględnione (czas przygotowania, zdolności, sen, itp.)</li>
<li><strong>Przyczynowość vs.&nbsp;korelacja</strong> - nie możemy udowodnić, że lęk powoduje słabe wyniki</li>
<li><strong>Samoopisowy lęk</strong> - subiektywne miary mogą nie odzwierciedlać pobudzenia fizjologicznego</li>
</ol>
</section>
</section>
<section id="dodatek-kompletny-kod-r" class="level3">
<h3 class="anchored" data-anchor-id="dodatek-kompletny-kod-r">Dodatek: Kompletny Kod R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kompletny kod analizy</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>lęk <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.2</span>, <span class="fl">4.1</span>, <span class="fl">4.8</span>, <span class="fl">5.6</span>, <span class="fl">6.3</span>, <span class="fl">7.0</span>, <span class="fl">7.9</span>)</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>wyniki <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">77</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">72</span>)</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Statystyki opisowe</span></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(lęk); <span class="fu">sd</span>(lęk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.175</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.872927</code></pre>
</div>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wyniki); <span class="fu">sd</span>(wyniki)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 77</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.529144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Korelacja</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(lęk, wyniki)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8304618</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresja</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(wyniki <span class="sc">~</span> lęk)</span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = wyniki ~ lęk)

Residuals:
   Min     1Q Median     3Q    Max 
-4.526 -2.116  0.400  2.050  4.081 

Coefficients:
            Estimate Std. Error t value    Pr(&gt;|t|)    
(Intercept)  89.6872     3.6682  24.450 0.000000308 ***
lęk          -2.4516     0.6714  -3.652      0.0107 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.327 on 6 degrees of freedom
Multiple R-squared:  0.6897,    Adjusted R-squared:  0.6379 
F-statistic: 13.33 on 1 and 6 DF,  p-value: 0.01069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %     97.5 %
(Intercept) 80.711582 98.6628838
lęk         -4.094474 -0.8088048</code></pre>
</div>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(lęk, wyniki), <span class="fu">aes</span>(<span class="at">x =</span> lęk, <span class="at">y =</span> wyniki)) <span class="sc">+</span></span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostyka</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-41-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-41-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-41-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tabela ANOVA</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: wyniki
          Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
lęk        1 147.589 147.589  13.334 0.01069 *
Residuals  6  66.411  11.069                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="przykład-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en" class="level2" data-number="10.19">
<h2 data-number="10.19" class="anchored" data-anchor-id="przykład-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis-en"><span class="header-section-number">10.19</span> Przykład 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*) [EN]</h2>
<section id="data-generating-process" class="level3">
<h3 class="anchored" data-anchor-id="data-generating-process">Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<p><span class="math display">\begin{aligned}
&amp; Y_{\text{Gallagher}} = 12 - 0.8X_{\text{DM}} + \varepsilon \\
&amp; \varepsilon \sim \mathcal{N}(0, 1) \\
&amp; X_{\text{DM}} \in \{3, 5, 7, 10, 12, 15\}
\end{aligned}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb366-7"><a href="#cb366-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb366-8"><a href="#cb366-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-9"><a href="#cb366-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb366-10"><a href="#cb366-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb366-11"><a href="#cb366-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb366-12"><a href="#cb366-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb366-13"><a href="#cb366-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667</span></p>
<p><span class="math display">\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">
32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332
</span></p>
<p><span class="math display">s^2_X = \frac{101.3332}{5} = 20.2666</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">s^2_Y = \frac{56.3483}{5} = 11.2697</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3">
<h3 class="anchored" data-anchor-id="covariance-and-correlation">Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">s_{XY} = \frac{-70.3670}{5} = -14.0734</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x" class="level3">
<h3 class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x">OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-0.6944 × 8.6667 = -6.0181</span></li>
<li><span class="math inline">\hat{\beta_0} = 5.7167 - (-6.0181) = 11.7348</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3">
<h3 class="anchored" data-anchor-id="r-squared-calculation">R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 11.7348 - 0.6944X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 56.3483</span> <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271</span> <span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters">Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-12"><a href="#cb388-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb388-13"><a href="#cb388-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb388-14"><a href="#cb388-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb388-15"><a href="#cb388-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-16"><a href="#cb388-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb388-17"><a href="#cb388-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb388-18"><a href="#cb388-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb388-19"><a href="#cb388-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb388-20"><a href="#cb388-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb388-21"><a href="#cb388-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb388-22"><a href="#cb388-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-23"><a href="#cb388-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb388-24"><a href="#cb388-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb388-25"><a href="#cb388-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb388-26"><a href="#cb388-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb388-27"><a href="#cb388-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb388-28"><a href="#cb388-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb388-29"><a href="#cb388-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb388-30"><a href="#cb388-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb388-31"><a href="#cb388-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb388-32"><a href="#cb388-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb388-33"><a href="#cb388-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb388-34"><a href="#cb388-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb388-35"><a href="#cb388-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb388-36"><a href="#cb388-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb388-37"><a href="#cb388-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb388-38"><a href="#cb388-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb388-39"><a href="#cb388-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb388-40"><a href="#cb388-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb388-41"><a href="#cb388-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb388-42"><a href="#cb388-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb388-43"><a href="#cb388-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb388-44"><a href="#cb388-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb388-45"><a href="#cb388-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="observations-about-model-fit">Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3">
<h3 class="anchored" data-anchor-id="study-context">Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./correg_en.html" class="pagination-link" aria-label="Introduction to Correlation and Regression Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./probability_en.html" class="pagination-link" aria-label="Introduction to Probability">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>