<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Wprowadzenie do Analizy Korelacji i Regresji – Social Data Analysis: An Introduction (Wprowadzenie do Analizy Danych Społecznych)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./probability_en.html" rel="next">
<link href="./correg_en.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correg_pl.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Data Analysis: An Introduction (Wprowadzenie do Analizy Danych Społecznych)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Data Science and Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Wprowadzenie do Nauki o Danych i Statystyki</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">From Sample to Population - Understanding Randomness, Sampling, and Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Od Próby do Populacji - Zrozumienie Losowości, Pobierania Próby i Wnioskowania</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reliability and Validity in Data Science Research</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial3b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Rzetelność i Trafność w Badaniach Nauk o Danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Research Designs: Experimental and Non-Experimental Approaches</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Projekty Badawcze: Podejścia Eksperymentalne i Nieeksperymentalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Podstawy Jednowymiarowej Statystyki Opisowej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rv_pdf_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Random Variables and Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Statistical Hypothesis Testing: A Fundamental Logic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#statystyka-dwuwymiarowa---wprowadzenie" id="toc-statystyka-dwuwymiarowa---wprowadzenie" class="nav-link active" data-scroll-target="#statystyka-dwuwymiarowa---wprowadzenie"><span class="header-section-number">16.1</span> Statystyka dwuwymiarowa - wprowadzenie</a></li>
  <li><a href="#badanie-zależności-między-zmiennymi-w-naukach-społecznych" id="toc-badanie-zależności-między-zmiennymi-w-naukach-społecznych" class="nav-link" data-scroll-target="#badanie-zależności-między-zmiennymi-w-naukach-społecznych"><span class="header-section-number">16.2</span> Badanie zależności między zmiennymi w naukach społecznych</a>
  <ul class="collapse">
  <li><a href="#analiza-zależności-między-zmiennymi" id="toc-analiza-zależności-między-zmiennymi" class="nav-link" data-scroll-target="#analiza-zależności-między-zmiennymi"><span class="header-section-number">16.2.1</span> Analiza zależności między zmiennymi</a></li>
  <li><a href="#aspekty-metodologiczne-analizy-korelacji" id="toc-aspekty-metodologiczne-analizy-korelacji" class="nav-link" data-scroll-target="#aspekty-metodologiczne-analizy-korelacji"><span class="header-section-number">16.2.2</span> Aspekty metodologiczne analizy korelacji</a></li>
  </ul></li>
  <li><a href="#rozróżnienie-między-korelacją-a-przyczynowością-zob.-np.-httpswww.tylervigen.comspurious-correlations" id="toc-rozróżnienie-między-korelacją-a-przyczynowością-zob.-np.-httpswww.tylervigen.comspurious-correlations" class="nav-link" data-scroll-target="#rozróżnienie-między-korelacją-a-przyczynowością-zob.-np.-httpswww.tylervigen.comspurious-correlations"><span class="header-section-number">16.3</span> Rozróżnienie między Korelacją a Przyczynowością [Zob. np. https://www.tylervigen.com/spurious-correlations]</a></li>
  <li><a href="#od-korelacji-do-przyczynowości" id="toc-od-korelacji-do-przyczynowości" class="nav-link" data-scroll-target="#od-korelacji-do-przyczynowości"><span class="header-section-number">16.4</span> Od korelacji do przyczynowości</a>
  <ul class="collapse">
  <li><a href="#kluczowe-zjawiska-w-problematyce-pozornych-korelacji" id="toc-kluczowe-zjawiska-w-problematyce-pozornych-korelacji" class="nav-link" data-scroll-target="#kluczowe-zjawiska-w-problematyce-pozornych-korelacji"><span class="header-section-number">16.4.1</span> Kluczowe zjawiska w problematyce pozornych korelacji</a></li>
  <li><a href="#kowariancja" id="toc-kowariancja" class="nav-link" data-scroll-target="#kowariancja"><span class="header-section-number">16.4.5</span> Kowariancja</a></li>
  <li><a href="#korelacja-pearsona" id="toc-korelacja-pearsona" class="nav-link" data-scroll-target="#korelacja-pearsona"><span class="header-section-number">16.4.12</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana" id="toc-korelacja-spearmana" class="nav-link" data-scroll-target="#korelacja-spearmana"><span class="header-section-number">16.4.13</span> Korelacja Spearmana</a></li>
  <li><a href="#tabela-krzyżowa" id="toc-tabela-krzyżowa" class="nav-link" data-scroll-target="#tabela-krzyżowa"><span class="header-section-number">16.4.14</span> Tabela Krzyżowa</a></li>
  <li><a href="#wybór-odpowiedniej-miary" id="toc-wybór-odpowiedniej-miary" class="nav-link" data-scroll-target="#wybór-odpowiedniej-miary"><span class="header-section-number">16.4.15</span> Wybór Odpowiedniej Miary</a></li>
  </ul></li>
  <li><a href="#wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" id="toc-wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" class="nav-link" data-scroll-target="#wprowadzenie-do-podstawowej-statystyki-wielowymiarowej"><span class="header-section-number">16.5</span> Wprowadzenie do Podstawowej Statystyki Wielowymiarowej (*)</a>
  <ul class="collapse">
  <li><a href="#macierz-korelacji" id="toc-macierz-korelacji" class="nav-link" data-scroll-target="#macierz-korelacji"><span class="header-section-number">16.5.1</span> Macierz Korelacji</a></li>
  <li><a href="#wizualizacja-związków-wielowymiarowych" id="toc-wizualizacja-związków-wielowymiarowych" class="nav-link" data-scroll-target="#wizualizacja-związków-wielowymiarowych"><span class="header-section-number">16.5.2</span> Wizualizacja Związków Wielowymiarowych</a></li>
  <li><a href="#korelacja-cząstkowa" id="toc-korelacja-cząstkowa" class="nav-link" data-scroll-target="#korelacja-cząstkowa"><span class="header-section-number">16.5.3</span> Korelacja Cząstkowa</a></li>
  <li><a href="#korelacja-wielokrotna" id="toc-korelacja-wielokrotna" class="nav-link" data-scroll-target="#korelacja-wielokrotna"><span class="header-section-number">16.5.4</span> Korelacja Wielokrotna</a></li>
  </ul></li>
  <li><a href="#wprowadzenie-do-analizy-regresji" id="toc-wprowadzenie-do-analizy-regresji" class="nav-link" data-scroll-target="#wprowadzenie-do-analizy-regresji"><span class="header-section-number">16.6</span> Wprowadzenie do Analizy Regresji</a>
  <ul class="collapse">
  <li><a href="#regresja-jako-model-stochastyczny" id="toc-regresja-jako-model-stochastyczny" class="nav-link" data-scroll-target="#regresja-jako-model-stochastyczny"><span class="header-section-number">16.6.1</span> Regresja jako Model Stochastyczny</a></li>
  <li><a href="#podstawowe-pojęcia-i-terminologia" id="toc-podstawowe-pojęcia-i-terminologia" class="nav-link" data-scroll-target="#podstawowe-pojęcia-i-terminologia"><span class="header-section-number">16.6.7</span> Podstawowe Pojęcia i Terminologia</a></li>
  <li><a href="#główna-idea" id="toc-główna-idea" class="nav-link" data-scroll-target="#główna-idea"><span class="header-section-number">16.6.8</span> Główna Idea</a></li>
  </ul></li>
  <li><a href="#model-regresji-liniowej" id="toc-model-regresji-liniowej" class="nav-link" data-scroll-target="#model-regresji-liniowej"><span class="header-section-number">16.7</span> Model Regresji Liniowej</a>
  <ul class="collapse">
  <li><a href="#model-populacyjny-vs.-oszacowania-z-próby" id="toc-model-populacyjny-vs.-oszacowania-z-próby" class="nav-link" data-scroll-target="#model-populacyjny-vs.-oszacowania-z-próby"><span class="header-section-number">16.7.1</span> Model Populacyjny vs.&nbsp;Oszacowania z Próby</a></li>
  </ul></li>
  <li><a href="#kluczowe-założenia-regresji-liniowej" id="toc-kluczowe-założenia-regresji-liniowej" class="nav-link" data-scroll-target="#kluczowe-założenia-regresji-liniowej"><span class="header-section-number">16.8</span> Kluczowe Założenia Regresji Liniowej</a>
  <ul class="collapse">
  <li><a href="#ścisła-egzogeniczność-podstawowe-założenie" id="toc-ścisła-egzogeniczność-podstawowe-założenie" class="nav-link" data-scroll-target="#ścisła-egzogeniczność-podstawowe-założenie"><span class="header-section-number">16.8.1</span> Ścisła Egzogeniczność: Podstawowe Założenie</a></li>
  <li><a href="#liniowość-założenie-o-formie" id="toc-liniowość-założenie-o-formie" class="nav-link" data-scroll-target="#liniowość-założenie-o-formie"><span class="header-section-number">16.8.2</span> Liniowość: Założenie o Formie</a></li>
  <li><a href="#zrozumienie-naruszeń-i-rozwiązania" id="toc-zrozumienie-naruszeń-i-rozwiązania" class="nav-link" data-scroll-target="#zrozumienie-naruszeń-i-rozwiązania"><span class="header-section-number">16.8.3</span> Zrozumienie Naruszeń i Rozwiązania</a></li>
  </ul></li>
  <li><a href="#ocena-dopasowania-modelu" id="toc-ocena-dopasowania-modelu" class="nav-link" data-scroll-target="#ocena-dopasowania-modelu"><span class="header-section-number">16.9</span> Ocena Dopasowania Modelu</a>
  <ul class="collapse">
  <li><a href="#dekompozycja-wariancji" id="toc-dekompozycja-wariancji" class="nav-link" data-scroll-target="#dekompozycja-wariancji"><span class="header-section-number">16.9.1</span> Dekompozycja Wariancji</a></li>
  <li><a href="#trzy-komponenty-wariancji" id="toc-trzy-komponenty-wariancji" class="nav-link" data-scroll-target="#trzy-komponenty-wariancji"><span class="header-section-number">16.9.2</span> Trzy Komponenty Wariancji</a></li>
  <li><a href="#współczynnik-r²---wyjaśnienie" id="toc-współczynnik-r²---wyjaśnienie" class="nav-link" data-scroll-target="#współczynnik-r²---wyjaśnienie"><span class="header-section-number">16.9.3</span> Współczynnik R² - Wyjaśnienie</a></li>
  <li><a href="#kiedy-zachować-ostrożność" id="toc-kiedy-zachować-ostrożność" class="nav-link" data-scroll-target="#kiedy-zachować-ostrożność"><span class="header-section-number">16.9.4</span> Kiedy Zachować Ostrożność</a></li>
  <li><a href="#praktyczne-wskazówki-do-analizy" id="toc-praktyczne-wskazówki-do-analizy" class="nav-link" data-scroll-target="#praktyczne-wskazówki-do-analizy"><span class="header-section-number">16.9.5</span> Praktyczne Wskazówki do Analizy</a></li>
  <li><a href="#kluczowe-wnioski-1" id="toc-kluczowe-wnioski-1" class="nav-link" data-scroll-target="#kluczowe-wnioski-1"><span class="header-section-number">16.9.6</span> Kluczowe Wnioski</a></li>
  <li><a href="#miary-dopasowania" id="toc-miary-dopasowania" class="nav-link" data-scroll-target="#miary-dopasowania"><span class="header-section-number">16.9.7</span> Miary Dopasowania</a></li>
  </ul></li>
  <li><a href="#regresja-wieloraka" id="toc-regresja-wieloraka" class="nav-link" data-scroll-target="#regresja-wieloraka"><span class="header-section-number">16.10</span> Regresja Wieloraka (*)</a>
  <ul class="collapse">
  <li><a href="#rozszerzenie-do-wielu-predyktorów" id="toc-rozszerzenie-do-wielu-predyktorów" class="nav-link" data-scroll-target="#rozszerzenie-do-wielu-predyktorów"><span class="header-section-number">16.10.1</span> Rozszerzenie do Wielu Predyktorów</a></li>
  <li><a href="#interpretacja-współczynników" id="toc-interpretacja-współczynników" class="nav-link" data-scroll-target="#interpretacja-współczynników"><span class="header-section-number">16.10.2</span> Interpretacja Współczynników</a></li>
  <li><a href="#współliniowość" id="toc-współliniowość" class="nav-link" data-scroll-target="#współliniowość"><span class="header-section-number">16.10.3</span> Współliniowość</a></li>
  </ul></li>
  <li><a href="#tematy-zaawansowane" id="toc-tematy-zaawansowane" class="nav-link" data-scroll-target="#tematy-zaawansowane"><span class="header-section-number">16.11</span> Tematy Zaawansowane</a>
  <ul class="collapse">
  <li><a href="#efekty-interakcji" id="toc-efekty-interakcji" class="nav-link" data-scroll-target="#efekty-interakcji"><span class="header-section-number">16.11.1</span> Efekty Interakcji</a></li>
  <li><a href="#wyrazy-wielomianowe" id="toc-wyrazy-wielomianowe" class="nav-link" data-scroll-target="#wyrazy-wielomianowe"><span class="header-section-number">16.11.2</span> Wyrazy Wielomianowe</a></li>
  </ul></li>
  <li><a href="#praktyczne-wskazówki-do-analizy-regresji" id="toc-praktyczne-wskazówki-do-analizy-regresji" class="nav-link" data-scroll-target="#praktyczne-wskazówki-do-analizy-regresji"><span class="header-section-number">16.12</span> Praktyczne Wskazówki do Analizy Regresji</a>
  <ul class="collapse">
  <li><a href="#proces-budowy-modelu" id="toc-proces-budowy-modelu" class="nav-link" data-scroll-target="#proces-budowy-modelu"><span class="header-section-number">16.12.1</span> Proces Budowy Modelu</a></li>
  <li><a href="#typowe-pułapki-i-rozwiązania" id="toc-typowe-pułapki-i-rozwiązania" class="nav-link" data-scroll-target="#typowe-pułapki-i-rozwiązania"><span class="header-section-number">16.12.2</span> Typowe Pułapki i Rozwiązania</a></li>
  </ul></li>
  <li><a href="#najlepsze-praktyki" id="toc-najlepsze-praktyki" class="nav-link" data-scroll-target="#najlepsze-praktyki"><span class="header-section-number">16.13</span> Najlepsze Praktyki</a>
  <ul class="collapse">
  <li><a href="#walidacja-modelu" id="toc-walidacja-modelu" class="nav-link" data-scroll-target="#walidacja-modelu"><span class="header-section-number">16.13.1</span> Walidacja Modelu</a></li>
  <li><a href="#prezentacja-wyników" id="toc-prezentacja-wyników" class="nav-link" data-scroll-target="#prezentacja-wyników"><span class="header-section-number">16.13.2</span> Prezentacja Wyników</a></li>
  </ul></li>
  <li><a href="#podsumowanie" id="toc-podsumowanie" class="nav-link" data-scroll-target="#podsumowanie"><span class="header-section-number">16.14</span> Podsumowanie</a>
  <ul class="collapse">
  <li><a href="#kluczowe-wnioski-3" id="toc-kluczowe-wnioski-3" class="nav-link" data-scroll-target="#kluczowe-wnioski-3"><span class="header-section-number">16.14.1</span> Kluczowe Wnioski</a></li>
  <li><a href="#literatura-uzupełniająca" id="toc-literatura-uzupełniająca" class="nav-link" data-scroll-target="#literatura-uzupełniająca">Literatura Uzupełniająca</a></li>
  </ul></li>
  <li><a href="#appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" id="toc-appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" class="nav-link" data-scroll-target="#appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami"><span class="header-section-number">16.15</span> Appendix A.1: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład z obliczeniami</a>
  <ul class="collapse">
  <li><a href="#krok-1-obliczanie-podstawowych-statystyk" id="toc-krok-1-obliczanie-podstawowych-statystyk" class="nav-link" data-scroll-target="#krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.15.1</span> Krok 1: Obliczanie Podstawowych Statystyk</a></li>
  <li><a href="#krok-2-szczegółowe-obliczenia-kowariancji" id="toc-krok-2-szczegółowe-obliczenia-kowariancji" class="nav-link" data-scroll-target="#krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.15.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</a></li>
  <li><a href="#krok-3-obliczanie-odchylenia-standardowego" id="toc-krok-3-obliczanie-odchylenia-standardowego" class="nav-link" data-scroll-target="#krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.15.3</span> Krok 3: Obliczanie Odchylenia Standardowego</a></li>
  <li><a href="#krok-4-obliczanie-korelacji-pearsona" id="toc-krok-4-obliczanie-korelacji-pearsona" class="nav-link" data-scroll-target="#krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.15.4</span> Krok 4: Obliczanie Korelacji Pearsona</a></li>
  <li><a href="#krok-5-obliczanie-korelacji-rangowej-spearmana" id="toc-krok-5-obliczanie-korelacji-rangowej-spearmana" class="nav-link" data-scroll-target="#krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.15.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</a></li>
  <li><a href="#krok-6-weryfikacja-w-r" id="toc-krok-6-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-6-weryfikacja-w-r"><span class="header-section-number">16.15.6</span> Krok 6: Weryfikacja w R</a></li>
  <li><a href="#krok-7-podstawowa-wizualizacja" id="toc-krok-7-podstawowa-wizualizacja" class="nav-link" data-scroll-target="#krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.15.7</span> Krok 7: Podstawowa Wizualizacja</a></li>
  <li><a href="#estymacja-ols-i-miary-dopasowania-modelu" id="toc-estymacja-ols-i-miary-dopasowania-modelu" class="nav-link" data-scroll-target="#estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.15.8</span> Estymacja OLS i Miary Dopasowania Modelu</a></li>
  <li><a href="#krok-1-obliczanie-estymatorów-ols" id="toc-krok-1-obliczanie-estymatorów-ols" class="nav-link" data-scroll-target="#krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.15.9</span> Krok 1: Obliczanie Estymatorów OLS</a></li>
  <li><a href="#krok-2-obliczanie-wartości-dopasowanych-i-reszt" id="toc-krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="nav-link" data-scroll-target="#krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.15.10</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</a></li>
  <li><a href="#krok-3-obliczanie-miar-dopasowania" id="toc-krok-3-obliczanie-miar-dopasowania" class="nav-link" data-scroll-target="#krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.15.11</span> Krok 3: Obliczanie Miar Dopasowania</a></li>
  <li><a href="#krok-4-weryfikacja-w-r" id="toc-krok-4-weryfikacja-w-r" class="nav-link" data-scroll-target="#krok-4-weryfikacja-w-r"><span class="header-section-number">16.15.12</span> Krok 4: Weryfikacja w R</a></li>
  <li><a href="#krok-5-analiza-reszt" id="toc-krok-5-analiza-reszt" class="nav-link" data-scroll-target="#krok-5-analiza-reszt"><span class="header-section-number">16.15.13</span> Krok 5: Analiza Reszt</a></li>
  <li><a href="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" id="toc-krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="nav-link" data-scroll-target="#krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.15.14</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</a></li>
  <li><a href="#modele-z-transformacją-logarytmiczną" id="toc-modele-z-transformacją-logarytmiczną" class="nav-link" data-scroll-target="#modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.15.15</span> Modele z Transformacją Logarytmiczną</a></li>
  <li><a href="#krok-1-transformacja-danych" id="toc-krok-1-transformacja-danych" class="nav-link" data-scroll-target="#krok-1-transformacja-danych"><span class="header-section-number">16.15.16</span> Krok 1: Transformacja Danych</a></li>
  <li><a href="#krok-2-porównanie-różnych-specyfikacji-modelu" id="toc-krok-2-porównanie-różnych-specyfikacji-modelu" class="nav-link" data-scroll-target="#krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.15.17</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</a></li>
  <li><a href="#krok-3-porównanie-wizualne" id="toc-krok-3-porównanie-wizualne" class="nav-link" data-scroll-target="#krok-3-porównanie-wizualne"><span class="header-section-number">16.15.18</span> Krok 3: Porównanie Wizualne</a></li>
  <li><a href="#krok-4-analiza-reszt-dla-najlepszego-modelu" id="toc-krok-4-analiza-reszt-dla-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.15.19</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</a></li>
  <li><a href="#krok-5-interpretacja-najlepszego-modelu" id="toc-krok-5-interpretacja-najlepszego-modelu" class="nav-link" data-scroll-target="#krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.15.20</span> Krok 5: Interpretacja Najlepszego Modelu</a></li>
  <li><a href="#krok-6-predykcje-modelu" id="toc-krok-6-predykcje-modelu" class="nav-link" data-scroll-target="#krok-6-predykcje-modelu"><span class="header-section-number">16.15.21</span> Krok 6: Predykcje Modelu</a></li>
  <li><a href="#krok-7-analiza-elastyczności" id="toc-krok-7-analiza-elastyczności" class="nav-link" data-scroll-target="#krok-7-analiza-elastyczności"><span class="header-section-number">16.15.22</span> Krok 7: Analiza Elastyczności</a></li>
  </ul></li>
  <li><a href="#appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" id="toc-appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="nav-link" data-scroll-target="#appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.16</span> Appendix A.2: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</a>
  <ul class="collapse">
  <li><a href="#zbiór-danych" id="toc-zbiór-danych" class="nav-link" data-scroll-target="#zbiór-danych"><span class="header-section-number">16.16.1</span> Zbiór Danych</a></li>
  <li><a href="#korelacja-pearsona-1" id="toc-korelacja-pearsona-1" class="nav-link" data-scroll-target="#korelacja-pearsona-1"><span class="header-section-number">16.16.2</span> Korelacja Pearsona</a></li>
  <li><a href="#korelacja-spearmana-1" id="toc-korelacja-spearmana-1" class="nav-link" data-scroll-target="#korelacja-spearmana-1"><span class="header-section-number">16.16.3</span> Korelacja Spearmana</a></li>
  <li><a href="#tau-kendalla" id="toc-tau-kendalla" class="nav-link" data-scroll-target="#tau-kendalla"><span class="header-section-number">16.16.4</span> Tau Kendalla</a></li>
  <li><a href="#weryfikacja-w-r" id="toc-weryfikacja-w-r" class="nav-link" data-scroll-target="#weryfikacja-w-r"><span class="header-section-number">16.16.5</span> Weryfikacja w R</a></li>
  <li><a href="#interpretacja-wyników" id="toc-interpretacja-wyników" class="nav-link" data-scroll-target="#interpretacja-wyników"><span class="header-section-number">16.16.6</span> Interpretacja Wyników</a></li>
  <li><a href="#porównanie-miar" id="toc-porównanie-miar" class="nav-link" data-scroll-target="#porównanie-miar"><span class="header-section-number">16.16.7</span> Porównanie Miar</a></li>
  </ul></li>
  <li><a href="#appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady" id="toc-appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady" class="nav-link" data-scroll-target="#appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady"><span class="header-section-number">16.17</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - podstawowe przykłady</a></li>
  <li><a href="#przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" id="toc-przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="nav-link" data-scroll-target="#przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">16.18</span> Przykład 1. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</a>
  <ul class="collapse">
  <li><a href="#dane" id="toc-dane" class="nav-link" data-scroll-target="#dane"><span class="header-section-number">16.18.1</span> Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh"><span class="header-section-number">16.18.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych"><span class="header-section-number">16.18.3</span> Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh"><span class="header-section-number">16.18.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</a></li>
  <li><a href="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.18.5</span> Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout" id="toc-example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout" class="nav-link" data-scroll-target="#example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">16.19</span> Example 2. Descriptive Statistics and OLS Example - Income and Voter Turnout</a>
  <ul class="collapse">
  <li><a href="#initial-r-output-for-reference" id="toc-initial-r-output-for-reference" class="nav-link" data-scroll-target="#initial-r-output-for-reference"><span class="header-section-number">16.19.1</span> Initial R Output for Reference</a></li>
  <li><a href="#dispersion-measures" id="toc-dispersion-measures" class="nav-link" data-scroll-target="#dispersion-measures"><span class="header-section-number">16.19.2</span> Dispersion Measures</a></li>
  <li><a href="#covariance-and-correlation" id="toc-covariance-and-correlation" class="nav-link" data-scroll-target="#covariance-and-correlation"><span class="header-section-number">16.19.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">16.19.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#detailed-decomposition-of-variance-and-r-squared" id="toc-detailed-decomposition-of-variance-and-r-squared" class="nav-link" data-scroll-target="#detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">16.19.5</span> Detailed Decomposition of Variance and R-squared</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">16.19.6</span> Visualization</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">16.19.7</span> Interpretation</a></li>
  </ul></li>
  <li><a href="#example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" id="toc-example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="nav-link" data-scroll-target="#example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">16.20</span> Example 3. Anxiety Levels and Cognitive Performance: A Laboratory Study</a>
  <ul class="collapse">
  <li><a href="#data-and-context" id="toc-data-and-context" class="nav-link" data-scroll-target="#data-and-context"><span class="header-section-number">16.20.1</span> Data and Context</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">16.20.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-1" id="toc-covariance-and-correlation-1" class="nav-link" data-scroll-target="#covariance-and-correlation-1"><span class="header-section-number">16.20.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-1" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">16.20.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation" id="toc-r-squared-calculation" class="nav-link" data-scroll-target="#r-squared-calculation"><span class="header-section-number">16.20.5</span> 4. R-squared Calculation</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1"><span class="header-section-number">16.20.6</span> Visualization</a></li>
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1"><span class="header-section-number">16.20.7</span> Interpretation</a></li>
  <li><a href="#study-limitations" id="toc-study-limitations" class="nav-link" data-scroll-target="#study-limitations"><span class="header-section-number">16.20.8</span> Study Limitations</a></li>
  </ul></li>
  <li><a href="#przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" id="toc-przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="nav-link" data-scroll-target="#przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">16.21</span> Przykład 4. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</a>
  <ul class="collapse">
  <li><a href="#dane-1" id="toc-dane-1" class="nav-link" data-scroll-target="#dane-1"><span class="header-section-number">16.21.1</span> Dane</a></li>
  <li><a href="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" id="toc-krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="nav-link" data-scroll-target="#krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1"><span class="header-section-number">16.21.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</a></li>
  <li><a href="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" id="toc-krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="nav-link" data-scroll-target="#krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych"><span class="header-section-number">16.21.3</span> Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</a></li>
  <li><a href="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" id="toc-krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="nav-link" data-scroll-target="#krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh"><span class="header-section-number">16.21.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</a></li>
  <li><a href="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" id="toc-krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="nav-link" data-scroll-target="#krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.21.5</span> Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</a></li>
  </ul></li>
  <li><a href="#example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" id="toc-example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="nav-link" data-scroll-target="#example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">16.22</span> Example 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*)</a>
  <ul class="collapse">
  <li><a href="#data-generating-process" id="toc-data-generating-process" class="nav-link" data-scroll-target="#data-generating-process"><span class="header-section-number">16.22.1</span> Data Generating Process</a></li>
  <li><a href="#descriptive-statistics-1" id="toc-descriptive-statistics-1" class="nav-link" data-scroll-target="#descriptive-statistics-1"><span class="header-section-number">16.22.2</span> Descriptive Statistics</a></li>
  <li><a href="#covariance-and-correlation-2" id="toc-covariance-and-correlation-2" class="nav-link" data-scroll-target="#covariance-and-correlation-2"><span class="header-section-number">16.22.3</span> Covariance and Correlation</a></li>
  <li><a href="#ols-regression-haty-hatbeta_0-hatbeta_1x-2" id="toc-ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="nav-link" data-scroll-target="#ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">16.22.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></a></li>
  <li><a href="#r-squared-calculation-1" id="toc-r-squared-calculation-1" class="nav-link" data-scroll-target="#r-squared-calculation-1"><span class="header-section-number">16.22.5</span> R-squared Calculation</a></li>
  <li><a href="#visualization---true-vs.-estimated-parameters" id="toc-visualization---true-vs.-estimated-parameters" class="nav-link" data-scroll-target="#visualization---true-vs.-estimated-parameters"><span class="header-section-number">16.22.6</span> Visualization - True vs.&nbsp;Estimated Parameters</a></li>
  <li><a href="#observations-about-model-fit" id="toc-observations-about-model-fit" class="nav-link" data-scroll-target="#observations-about-model-fit"><span class="header-section-number">16.22.7</span> Observations about Model Fit</a></li>
  <li><a href="#interpretation-2" id="toc-interpretation-2" class="nav-link" data-scroll-target="#interpretation-2"><span class="header-section-number">16.22.8</span> Interpretation</a></li>
  <li><a href="#study-context" id="toc-study-context" class="nav-link" data-scroll-target="#study-context"><span class="header-section-number">16.22.9</span> Study Context</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">16.22.10</span> Limitations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="statystyka-dwuwymiarowa---wprowadzenie" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="statystyka-dwuwymiarowa---wprowadzenie"><span class="header-section-number">16.1</span> Statystyka dwuwymiarowa - wprowadzenie</h2>
<p>Statystyka dwuwymiarowa pozwala na badanie związków między dwiema zmiennymi, umożliwiając ilościowe określenie i wizualizację, jak zmiany jednej zmiennej wiążą się ze zmianami drugiej. Metody te stanowią fundament wielu zaawansowanych technik statystycznych i zastosowań w praktyce badawczej.</p>
<p>Omówimy kilka kluczowych miar, zaczynając od kowariancji - podstawowej miary współzmienności dwóch zmiennych - przechodząc do bardziej interpretowalnych miar, takich jak współczynniki korelacji i analiza regresji.</p>
</section>
<section id="badanie-zależności-między-zmiennymi-w-naukach-społecznych" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="badanie-zależności-między-zmiennymi-w-naukach-społecznych"><span class="header-section-number">16.2</span> Badanie zależności między zmiennymi w naukach społecznych</h2>
<p>W tej części omówimy cztery podstawowe typy zależności między zmiennymi, często spotykane w badaniach społecznych. Każdy typ zilustrowany jest przykładem empirycznym, pokazującym, jak identyfikować, analizować i interpretować te wzorce.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="analiza-zależności-między-zmiennymi" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="analiza-zależności-między-zmiennymi"><span class="header-section-number">16.2.1</span> Analiza zależności między zmiennymi</h3>
<section id="korelacja-dodatnia-wykształcenie-a-dochód" class="level4" data-number="16.2.1.1">
<h4 data-number="16.2.1.1" class="anchored" data-anchor-id="korelacja-dodatnia-wykształcenie-a-dochód"><span class="header-section-number">16.2.1.1</span> Korelacja dodatnia: Wykształcenie a dochód</h4>
<p>Ta zależność przedstawia dodatnią korelację liniową (r ≈ 0,70, p &lt; 0,001), gdzie zmienne rosną razem w stały sposób. Współczynnik regresji wskazuje, że każdy dodatkowy rok edukacji odpowiada wzrostowi rocznego dochodu o około 3 500 zł (β = 3500).</p>
<p><strong>Kluczowe cechy:</strong></p>
<ul>
<li>Kierunek: Dodatni (wraz ze wzrostem wykształcenia rośnie dochód)</li>
<li>Forma: Liniowa (stała szybkość zmian)</li>
<li>Siła: Silna (r &gt; 0,7)</li>
<li>Istotność statystyczna: p &lt; 0,001</li>
</ul>
</section>
<section id="korelacja-ujemna-izolacja-społeczna-a-dobrostan-psychiczny" class="level4" data-number="16.2.1.2">
<h4 data-number="16.2.1.2" class="anchored" data-anchor-id="korelacja-ujemna-izolacja-społeczna-a-dobrostan-psychiczny"><span class="header-section-number">16.2.1.2</span> Korelacja ujemna: Izolacja społeczna a dobrostan psychiczny</h4>
<p>Ten przykład ilustruje ujemną korelację liniową (r ≈ -0,75, p &lt; 0,001), gdzie wzrost jednej zmiennej wiąże się ze spadkiem drugiej. Model regresji pokazuje, że każdy punkt wzrostu w skali izolacji społecznej wiąże się ze spadkiem dobrostanu psychicznego o 4 punkty (β = -4).</p>
<p><strong>Kluczowe cechy:</strong></p>
<ul>
<li>Kierunek: Ujemny (wraz ze wzrostem izolacji spada dobrostan)</li>
<li>Forma: Liniowa (stała szybkość zmian)</li>
<li>Siła: Silna (|r| &gt; 0,7)</li>
<li>Istotność statystyczna: p &lt; 0,001</li>
</ul>
</section>
<section id="brak-korelacji-polaryzacja-polityczna-a-mobilność-ekonomiczna" class="level4" data-number="16.2.1.3">
<h4 data-number="16.2.1.3" class="anchored" data-anchor-id="brak-korelacji-polaryzacja-polityczna-a-mobilność-ekonomiczna"><span class="header-section-number">16.2.1.3</span> Brak korelacji: Polaryzacja polityczna a mobilność ekonomiczna</h4>
<p>Ten zbiór danych pokazuje zmienne bez znaczącego związku (r ≈ 0,05, p &gt; 0,5). Wykres rozrzutu przedstawia punkty rozmieszczone losowo, a linia regresji jest prawie pozioma, co wskazuje na brak związku predykcyjnego między polaryzacją polityczną regionu a jego mobilnością ekonomiczną.</p>
<p><strong>Kluczowe cechy:</strong></p>
<ul>
<li>Kierunek: Brak wyraźnego kierunku</li>
<li>Forma: Brak wzorca</li>
<li>Siła: Znikoma (|r| &lt; 0,1)</li>
<li>Istotność statystyczna: Nieistotna (p &gt; 0,05)</li>
</ul>
</section>
<section id="zależność-nieliniowa-korzystanie-z-mediów-społecznościowych-a-satysfakcja-z-życia" class="level4" data-number="16.2.1.4">
<h4 data-number="16.2.1.4" class="anchored" data-anchor-id="zależność-nieliniowa-korzystanie-z-mediów-społecznościowych-a-satysfakcja-z-życia"><span class="header-section-number">16.2.1.4</span> Zależność nieliniowa: Korzystanie z mediów społecznościowych a satysfakcja z życia</h4>
<p>Ten przykład przedstawia zależność krzywoliniową (kwadratową), gdzie satysfakcja z życia początkowo rośnie przy umiarkowanym korzystaniu z mediów społecznościowych, osiąga maksimum przy około 2-3 godzinach dziennie, a następnie spada przy nadmiernym korzystaniu. Współczynnik korelacji liniowej (r ≈ -0,60) zniekształca ten związek, podczas gdy model kwadratowy zapewnia znacznie lepsze dopasowanie (R² ≈ 0,75).</p>
<p><strong>Kluczowe cechy:</strong> - Kierunek: Zmienny (najpierw dodatni, potem ujemny) - Forma: Nieliniowa (zmienna szybkość zmian) - Korelacja liniowa: Nieodpowiednia miara - Model kwadratowy: Statystycznie istotny (p &lt; 0,001)</p>
</section>
</section>
<section id="aspekty-metodologiczne-analizy-korelacji" class="level3" data-number="16.2.2">
<h3 data-number="16.2.2" class="anchored" data-anchor-id="aspekty-metodologiczne-analizy-korelacji"><span class="header-section-number">16.2.2</span> Aspekty metodologiczne analizy korelacji</h3>
<ol type="1">
<li><strong>Interpretacja korelacji</strong>
<ul>
<li>Współczynniki korelacji (r) przyjmują wartości od -1 do +1</li>
<li>|r| &lt; 0,3: Słaba zależność</li>
<li>0,3 ≤ |r| &lt; 0,7: Umiarkowana zależność</li>
<li>|r| ≥ 0,7: Silna zależność</li>
<li>Zawsze należy oceniać istotność statystyczną (zwykle za pomocą wartości p)</li>
</ul></li>
<li><strong>Niezależność statystyczna</strong>
<ul>
<li>Obserwacje powinny być niezależne od siebie</li>
<li>Należy zachować ostrożność w przypadku powtarzanych pomiarów, szeregów czasowych lub danych zagnieżdżonych</li>
<li>Niezależność wpływa na wiarygodność testów istotności statystycznej</li>
</ul></li>
<li><strong>Zmienne zakłócające</strong>
<ul>
<li>Kontrola potencjalnych zmiennych zakłócających poprzez:
<ul>
<li>Analiza regresji wielorakiej</li>
<li>Współczynniki korelacji cząstkowej</li>
<li>Dopasowanie wyników metodą propensity score</li>
<li>Analiza warstwowa</li>
</ul></li>
</ul></li>
<li><strong>Ocena przyczynowości</strong>
<ul>
<li>Korelacja nie implikuje przyczynowości</li>
<li>Wzmocnienie wnioskowania przyczynowego poprzez:
<ul>
<li>Plany eksperymentalne z losowym przydziałem</li>
<li>Badania podłużne z pierwszeństwem czasowym</li>
<li>Modelowanie równań strukturalnych</li>
<li>Eksperymenty naturalne i zmienne instrumentalne</li>
</ul></li>
</ul></li>
</ol>
</section>
</section>
<section id="rozróżnienie-między-korelacją-a-przyczynowością-zob.-np.-httpswww.tylervigen.comspurious-correlations" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="rozróżnienie-między-korelacją-a-przyczynowością-zob.-np.-httpswww.tylervigen.comspurious-correlations"><span class="header-section-number">16.3</span> Rozróżnienie między Korelacją a Przyczynowością [Zob. np. https://www.tylervigen.com/spurious-correlations]</h2>
<p>Zależności statystyczne między zmiennymi stanowią jeden z najczęściej błędnie interpretowanych aspektów analizy danych. Mimo że korelacje mogą ujawniać wzorce w danych, wymagają starannej interpretacji, aby uniknąć wyciągania nieprawidłowych wniosków przyczynowych. Przeanalizujmy to zagadnienie na przykładach.</p>
</section>
<section id="od-korelacji-do-przyczynowości" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="od-korelacji-do-przyczynowości"><span class="header-section-number">16.4</span> Od korelacji do przyczynowości</h2>
<p>Jednym z najważniejszych rozróżnień w analizie statystycznej jest różnica między korelacją a przyczynowością. O ile identyfikacja korelacji jest stosunkowo prosta, ustalenie związków przyczynowych wymaga bardziej zaawansowanych metod. Ta część materiału omawia, jak badacze mogą przejść od obserwacji statystycznych zależności do formułowania uzasadnionych twierdzeń o charakterze przyczynowym.</p>
<section id="kluczowe-zjawiska-w-problematyce-pozornych-korelacji" class="level3" data-number="16.4.1">
<h3 data-number="16.4.1" class="anchored" data-anchor-id="kluczowe-zjawiska-w-problematyce-pozornych-korelacji"><span class="header-section-number">16.4.1</span> Kluczowe zjawiska w problematyce pozornych korelacji</h3>
<p>Analizując dane pod kątem zależności przyczynowych, badacze społeczni powinni być świadomi trzech szczególnie istotnych zjawisk prowadzących do błędnych wniosków:</p>
<section id="koincydencja-losowa" class="level4" data-number="16.4.1.1">
<h4 data-number="16.4.1.1" class="anchored" data-anchor-id="koincydencja-losowa"><span class="header-section-number">16.4.1.1</span> Koincydencja losowa</h4>
<p>Koincydencja losowa występuje, gdy dwie zmienne wykazują statystycznie istotną korelację wyłącznie przez przypadek, bez jakiegokolwiek związku przyczynowego czy wspólnej przyczyny.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Badacze odkryli silną korelację (r = 0,93) między liczbą bocianów w regionach Polski a liczbą urodzeń. Ta korelacja wynika z faktu, że obie zmienne są związane z obszarami wiejskimi, a nie z bezpośredniego związku przyczynowego.</p>
</blockquote>
<p><strong>Jak rozpoznać:</strong></p>
<ul>
<li>Brak wiarygodnego mechanizmu łączącego zmienne</li>
<li>Korelacja nie utrzymuje się przy ponownych pomiarach lub w innych próbach</li>
<li>Zależność znika po uwzględnieniu innych zmiennych</li>
</ul>
<p><strong>Rozwiązanie:</strong> Stosowanie korekty na wielokrotne porównania (np. poprawka Bonferroniego), replikacja badań na nowych próbach, ocena wiarygodności teoretycznej.</p>
</section>
<section id="odwrócona-przyczynowość" class="level4" data-number="16.4.1.2">
<h4 data-number="16.4.1.2" class="anchored" data-anchor-id="odwrócona-przyczynowość"><span class="header-section-number">16.4.1.2</span> Odwrócona przyczynowość</h4>
<p>Odwrócona przyczynowość pojawia się, gdy badacz prawidłowo identyfikuje istnienie związku przyczynowego między zmiennymi, ale błędnie określa kierunek tej relacji.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Badania wykazują, że osoby z wyższym poziomem lęku częściej stosują techniki relaksacyjne. Błędny wniosek: techniki relaksacyjne powodują lęk. Prawidłowy wniosek: osoby z wyższym poziomem lęku częściej sięgają po techniki relaksacyjne jako metodę radzenia sobie.</p>
</blockquote>
<p><strong>Jak rozpoznać:</strong></p>
<ul>
<li>Brak logicznego mechanizmu dla zaproponowanego kierunku</li>
<li>Trudności w ustaleniu sekwencji czasowej</li>
<li>Wyniki sprzeczne z dotychczasową wiedzą teoretyczną</li>
</ul>
<p><strong>Rozwiązanie:</strong> Projektowanie badań podłużnych, analiza chronologiczna (sekwencji zdarzeń), eksperymenty z manipulacją zmienną niezależną.</p>
</section>
<section id="zmienne-zakłócające" class="level4" data-number="16.4.1.3">
<h4 data-number="16.4.1.3" class="anchored" data-anchor-id="zmienne-zakłócające"><span class="header-section-number">16.4.1.3</span> Zmienne zakłócające</h4>
<p>Zmienne zakłócające (ang. confounding variables) tworzą pozorne zależności lub maskują rzeczywiste związki poprzez jednoczesny wpływ na zmienną niezależną i zależną. To zjawisko zostało już częściowo omówione wcześniej, ale warto podkreślić jego różne przejawy.</p>
<p><strong>Typy efektów zmiennych zakłócających:</strong></p>
<ol type="a">
<li><p><strong>Efekt maskujący</strong> – zmienna zakłócająca ukrywa rzeczywisty związek &gt; <strong>Przykład:</strong> Brak korelacji między aktywnością fizyczną a zdrowiem w badaniu osób starszych, ponieważ osoby z wcześniejszymi problemami zdrowotnymi (zmienna zakłócająca) jednocześnie ćwiczą więcej (dla zdrowia) i mają gorsze wyniki zdrowotne.</p></li>
<li><p><strong>Efekt pozorny</strong> – zmienna zakłócająca tworzy nieistniejący związek &gt; <strong>Przykład:</strong> Pozorna korelacja między spożyciem lodów a liczbą utonięć. Rzeczywistym czynnikiem jest temperatura powietrza, która zwiększa zarówno konsumpcję lodów, jak i aktywność nad wodą.</p></li>
<li><p><strong>Efekt wzmacniający/osłabiający</strong> – zmienna zakłócająca zmienia siłę rzeczywistej relacji &gt; <strong>Przykład:</strong> Związek między wykształceniem a dochodami jest silniejszy w miastach niż na wsi (lokalizacja jako zmienna zakłócająca).</p></li>
</ol>
<p><strong>Rozwiązanie:</strong> Randomizacja w badaniach eksperymentalnych, stratyfikacja, metody statystyczne (np. regresja wieloraka, analiza ścieżek, propensity score matching), kontrola zmiennych zakłócających już na etapie projektowania badania.</p>
</section>
<section id="błąd-kolidera-collider-bias" class="level4" data-number="16.4.1.4">
<h4 data-number="16.4.1.4" class="anchored"><span class="header-section-number">16.4.1.4</span> Błąd kolidera (Collider Bias)</h4>
<p>Błąd kolidera to specyficzne zjawisko występujące, gdy kontrolujemy zmienną będącą wspólnym skutkiem (tzw. “koliderem”) dwóch innych zmiennych. Paradoksalnie, takie działanie może wprowadzić sztuczną korelację między zmiennymi, które w rzeczywistości są od siebie niezależne.</p>
<p><strong>Schemat zależności:</strong></p>
<pre><code>Inteligencja → → → → → → → → → → → → → → → → → → → →
                                                      ↘
                                                        Przyjęcie na studia
                                                      ↗
Zamożność rodziny → → → → → → → → → → → → → → → → → →</code></pre>
<p>W populacji ogólnej inteligencja i zamożność rodziny mogą być nieskorelowane. Jednak gdy badamy tylko studentów przyjętych na uczelnię (kolider), może pojawić się negatywna korelacja: wśród przyjętych, osoby mniej zamożne często mają wyższą inteligencję, a osoby zamożniejsze mogą mieć niższą inteligencję, ponieważ obie cechy “rekompensują się” w procesie selekcji.</p>
<blockquote class="blockquote">
<p><strong>Przykład z polskich badań społecznych:</strong> Badając ludzi hospitalizowanych z powodu COVID-19, zauważono ujemną korelację między wiekiem a ciężkością chorób współistniejących. Wydawało się to przeczyć wiedzy medycznej (starszy wiek zwykle wiąże się z większą liczbą chorób). Wyjaśnienie: hospitalizacja była “koliderem” – młodsze osoby trafiały do szpitala tylko w przypadku ciężkich chorób współistniejących, podczas gdy osoby starsze hospitalizowano z powodu COVID-19 nawet przy mniejszej liczbie chorób towarzyszących.</p>
</blockquote>
<p><strong>Jak rozpoznać:</strong></p>
<ul>
<li>Analiza dotyczy wyselekcjonowanej podgrupy populacji</li>
<li>Zmienna, według której dokonano selekcji, jest potencjalnie zależna od innych badanych zmiennych</li>
<li>Obserwowane korelacje są nieoczekiwane lub sprzeczne z ustaloną wiedzą</li>
</ul>
<p><strong>Rozwiązanie:</strong> Modelowanie przyczynowe (np. grafy skierowane acykliczne), unikanie kontrolowania zmiennych będących skutkami, badanie pełnej populacji zamiast wyselekcjonowanych grup, gdy to możliwe.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mechanizmy pozornych korelacji
</div>
</div>
<div class="callout-body-container callout-body">
<p>Korelacje mogą wydawać się znaczące, podczas gdy w rzeczywistości wynikają z artefaktów statystycznych lub ukrytych czynników. Rozpoznanie tych wzorców pomaga badaczom uniknąć wyciągania fałszywych wniosków. Poniżej przedstawiono główne mechanizmy tworzące mylące korelacje:</p>
<section id="zmienne-zakłócające-1" class="level4" data-number="16.4.1.5">
<h4 data-number="16.4.1.5" class="anchored" data-anchor-id="zmienne-zakłócające-1"><span class="header-section-number">16.4.1.5</span> Zmienne zakłócające</h4>
<p>Zmienna zakłócająca wpływa zarówno na zmienną niezależną, jak i zależną, tworząc pozorną relację, która znika po kontroli czynnika zakłócającego.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Badanie wykazuje, że spożycie kawy koreluje ze zwiększonym ryzykiem raka płuc. Jednak ta zależność znika po uwzględnieniu palenia tytoniu—osoby palące często piją więcej kawy, a palenie powoduje raka płuc.</p>
</blockquote>
<p><strong>Schemat zależności:</strong></p>
<pre><code>    Palenie tytoniu
   ↗            ↘
Kawa → → → → Rak płuc</code></pre>
<p>W tej relacji palenie wpływa zarówno na spożycie kawy, jak i ryzyko raka płuc, tworząc pozorną korelację między kawą a rakiem.</p>
<p><strong>Strategia rozwiązania:</strong> Zastosowanie analizy wielozmiennowej do kontroli potencjalnych zmiennych zakłócających lub implementacja stratyfikacji w celu wyizolowania badanej relacji.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/EmIodcqXEAMRW83.jpeg" class="img-fluid figure-img"></p>
<figcaption>https://x.com/EUFIC/status/1324667630238814209?prefetchTimestamp=1732463940216</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4580.png" class="img-fluid figure-img"></p>
<figcaption>https://sitn.hms.harvard.edu/flash/2021/when-correlation-does-not-imply-causation-why-your-gut-microbes-may-not-yet-be-a-silver-bullet-to-all-your-problems/</figcaption>
</figure>
</div>
</section>
<section id="autokorelacja-czasowa" class="level4" data-number="16.4.1.6">
<h4 data-number="16.4.1.6" class="anchored" data-anchor-id="autokorelacja-czasowa"><span class="header-section-number">16.4.1.6</span> Autokorelacja czasowa</h4>
<p>Zmienne, które wykazują trendy w czasie, często silnie korelują, nawet gdy nie istnieje między nimi związek przyczynowy. To zjawisko może tworzyć liczne fałszywe korelacje.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Wyniki czytelnicze uczniów w województwie łódzkim i małopolskim poprawiły się w ciągu ostatniej dekady. Istnieje silna korelacja między tymi trendami, ale nie oznacza to, że programy alfabetyzacji w Łodzi wpływają na dzieci w Krakowie—oba wskaźniki po prostu niezależnie poprawiały się w czasie.</p>
</blockquote>
<p><strong>Strategia rozwiązania:</strong> Usunięcie trendu z szeregów czasowych poprzez analizę zmian, a nie wartości bezwzględnych, lub uwzględnienie czasu jako zmiennej kontrolnej w modelach regresji.</p>
</section>
<section id="błąd-jednoczesnej-przyczynowości" class="level4" data-number="16.4.1.7">
<h4 data-number="16.4.1.7" class="anchored" data-anchor-id="błąd-jednoczesnej-przyczynowości"><span class="header-section-number">16.4.1.7</span> Błąd jednoczesnej przyczynowości</h4>
<p>Gdy zmienne wpływają na siebie nawzajem, standardowa analiza korelacji nie identyfikuje kierunku ani siły poszczególnych ścieżek przyczynowych.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Korzystanie z mediów społecznościowych i depresja wykazują korelację, ale przyczynowość jest dwukierunkowa—depresja może prowadzić do zwiększonego korzystania z mediów społecznościowych, podczas gdy nadmierne korzystanie z mediów społecznościowych może przyczyniać się do depresji.</p>
</blockquote>
<p><strong>Strategia rozwiązania:</strong> Wdrożenie badań podłużnych z wieloma punktami pomiarowymi lub wykorzystanie zmiennych instrumentalnych do wyizolowania efektów kierunkowych.</p>
</section>
<section id="metody-statystyczne-wnioskowania-przyczynowego" class="level3" data-number="16.4.2">
<h3 data-number="16.4.2" class="anchored" data-anchor-id="metody-statystyczne-wnioskowania-przyczynowego"><span class="header-section-number">16.4.2</span> Metody statystyczne wnioskowania przyczynowego</h3>
<p>O ile analiza korelacji identyfikuje wzorce, ustalenie przyczynowości wymaga specjalistycznych metod, które kontrolują czynniki zakłócające i izolują konkretne relacje. Oto niektóre istotne podejścia stosowane przez badaczy społecznych:</p>
<section id="plan-eksperymentalny-złoty-standard" class="level4" data-number="16.4.2.1">
<h4 data-number="16.4.2.1" class="anchored" data-anchor-id="plan-eksperymentalny-złoty-standard"><span class="header-section-number">16.4.2.1</span> Plan eksperymentalny: Złoty standard</h4>
<p>Randomizowane badania kontrolowane (RCT) dostarczają najsilniejszych dowodów na przyczynowość poprzez losowe przydzielanie uczestników do grup eksperymentalnych i kontrolnych, zapewniając, że wszelkie systematyczne różnice w wynikach można przypisać interwencji.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Aby przetestować, czy nowa metoda nauczania poprawia wyniki w nauce, badacze losowo przydzielają uczniów do grupy z nową metodą lub z tradycyjnym nauczaniem, a następnie porównują wyniki testów, kontrolując początkowy poziom umiejętności.</p>
</blockquote>
<p><strong>Główne zalety:</strong></p>
<ul>
<li>Eliminuje błąd selekcji</li>
<li>Kontroluje znane i nieznane czynniki zakłócające</li>
<li>Pozwala na precyzyjne oszacowanie efektów interwencji</li>
</ul>
<p><strong>Ograniczenia:</strong></p>
<ul>
<li>Nie zawsze etyczne lub wykonalne w badaniach społecznych</li>
<li>Może mieć ograniczoną trafność zewnętrzną</li>
<li>Może być kosztowne i czasochłonne</li>
</ul>
</section>
<section id="zmienne-instrumentalne-poszukiwanie-naturalnych-eksperymentów" class="level4" data-number="16.4.2.2">
<h4 data-number="16.4.2.2" class="anchored" data-anchor-id="zmienne-instrumentalne-poszukiwanie-naturalnych-eksperymentów"><span class="header-section-number">16.4.2.2</span> Zmienne instrumentalne: Poszukiwanie naturalnych eksperymentów</h4>
<p>Ta metoda wykorzystuje zmienną (tzw. “instrument”), która wpływa na zmienną niezależną, ale oddziałuje na wynik tylko poprzez swój wpływ na zmienną niezależną, tworząc naturalny eksperyment.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Aby zbadać wpływ edukacji na dochody, badacze mogą wykorzystać odległość do najbliższej uczelni wyższej jako zmienną instrumentalną, ponieważ wpływa ona na poziom wykształcenia, ale prawdopodobnie wpływa na dochody tylko poprzez swój wpływ na edukację.</p>
</blockquote>
<p><strong>Implementacja:</strong></p>
<ul>
<li>Identyfikacja zmiennej, która silnie koreluje ze zmienną niezależną</li>
<li>Upewnienie się, że instrument wpływa na wynik tylko poprzez zmienną niezależną</li>
<li>Zastosowanie dwustopniowej metody najmniejszych kwadratów do oszacowania efektów przyczynowych</li>
</ul>
</section>
<section id="regresja-nieciągła-wykorzystanie-progów" class="level4" data-number="16.4.2.3">
<h4 data-number="16.4.2.3" class="anchored" data-anchor-id="regresja-nieciągła-wykorzystanie-progów"><span class="header-section-number">16.4.2.3</span> Regresja nieciągła: Wykorzystanie progów</h4>
<p>Ten plan badawczy wykorzystuje sytuacje, w których przypisanie do interwencji zmienia się gwałtownie przy określonym progu, tworząc porównywalne grupy po obu stronach punktu odcięcia.</p>
<blockquote class="blockquote">
<p><strong>Przykład:</strong> Badanie wpływu programów stypendialnych poprzez porównanie studentów z wynikami tuż powyżej i tuż poniżej progu średniej ocen wymaganej do uzyskania stypendium.</p>
</blockquote>
<p><strong>Kiedy stosować:</strong></p>
<ul>
<li>Gdy kwalifikowalność do polityki lub programu zależy od wyraźnej wartości progowej</li>
<li>Gdy uczestnicy nie mogą precyzyjnie manipulować swoją pozycją względem progu</li>
<li>Gdy istnieją wystarczające dane wokół punktu odcięcia</li>
</ul>
</section>
</section>
<section id="krytyczna-analiza-korelacji" class="level3" data-number="16.4.3">
<h3 data-number="16.4.3" class="anchored" data-anchor-id="krytyczna-analiza-korelacji"><span class="header-section-number">16.4.3</span> Krytyczna analiza korelacji</h3>
<p>Oceniając wyniki korelacyjne, warto zastosować systematyczne podejście do oceny potencjalnych związków przyczynowych:</p>
<section id="teoretyczna-wiarygodność" class="level4" data-number="16.4.3.1">
<h4 data-number="16.4.3.1" class="anchored" data-anchor-id="teoretyczna-wiarygodność"><span class="header-section-number">16.4.3.1</span> Teoretyczna wiarygodność</h4>
<p>Zbadaj, czy istnieje logiczny mechanizm wyjaśniający, w jaki sposób jedna zmienna wpływa na drugą.</p>
<blockquote class="blockquote">
<p><strong>Pytanie, które warto zadać:</strong> “Czy istnieje wiarygodny model teoretyczny wyjaśniający, jak X może powodować Y?”</p>
<p><strong>Przykład:</strong> Korelacja między poziomem wykształcenia a stanem zdrowia jest teoretycznie wiarygodna, ponieważ edukacja może dostarczać wiedzy o zdrowych zachowaniach, wyższych dochodach na lepszą opiekę zdrowotną oraz sieci społecznych, które promują dobrostan.</p>
</blockquote>
</section>
<section id="pierwszeństwo-czasowe" class="level4" data-number="16.4.3.2">
<h4 data-number="16.4.3.2" class="anchored" data-anchor-id="pierwszeństwo-czasowe"><span class="header-section-number">16.4.3.2</span> Pierwszeństwo czasowe</h4>
<p>Sprawdź, czy proponowana przyczyna występuje przed skutkiem w czasie—fundamentalny wymóg przyczynowości.</p>
<blockquote class="blockquote">
<p><strong>Pytanie, które warto zadać:</strong> “Czy X konsekwentnie poprzedza Y w czasie?”</p>
<p><strong>Przykład:</strong> W badaniach podłużnych dotyczących palenia i raka płuc, zachowanie związane z paleniem poprzedza diagnozę raka, co wspiera interpretację przyczynową.</p>
</blockquote>
</section>
<section id="zależność-dawka-reakcja" class="level4" data-number="16.4.3.3">
<h4 data-number="16.4.3.3" class="anchored" data-anchor-id="zależność-dawka-reakcja"><span class="header-section-number">16.4.3.3</span> Zależność dawka-reakcja</h4>
<p>Oceń, czy zmiany w natężeniu proponowanej przyczyny odpowiadają proporcjonalnym zmianom w efekcie.</p>
<blockquote class="blockquote">
<p><strong>Pytanie, które warto zadać:</strong> “Czy więcej X prowadzi do większego Y w spójnym wzorcu?”</p>
<p><strong>Przykład:</strong> Badania pokazują, że wraz ze wzrostem poziomów zanieczyszczenia powietrza, problemy oddechowe wzrastają proporcjonalnie, wzmacniając argument za przyczynowością.</p>
</blockquote>
</section>
<section id="spójność-w-różnych-kontekstach" class="level4" data-number="16.4.3.4">
<h4 data-number="16.4.3.4" class="anchored" data-anchor-id="spójność-w-różnych-kontekstach"><span class="header-section-number">16.4.3.4</span> Spójność w różnych kontekstach</h4>
<p>Oceń, czy relacja utrzymuje się w różnych populacjach, środowiskach i podejściach pomiarowych.</p>
<blockquote class="blockquote">
<p><strong>Pytanie, które warto zadać:</strong> “Czy zależność jest konsekwentnie obserwowana w różnych badaniach, populacjach i metodologiach?”</p>
<p><strong>Przykład:</strong> Związek między bezrobociem a problemami zdrowia psychicznego pojawia się konsekwentnie w różnych kulturach, systemach ekonomicznych i podejściach pomiarowych.</p>
</blockquote>
</section>
<section id="alternatywne-wyjaśnienia" class="level4" data-number="16.4.3.5">
<h4 data-number="16.4.3.5" class="anchored" data-anchor-id="alternatywne-wyjaśnienia"><span class="header-section-number">16.4.3.5</span> Alternatywne wyjaśnienia</h4>
<p>Systematycznie rozważ i przetestuj alternatywne wyjaśnienia zaobserwowanej korelacji.</p>
<blockquote class="blockquote">
<p><strong>Pytanie, które warto zadać:</strong> “Jakie inne czynniki mogłyby wyjaśnić zaobserwowaną relację i jak możemy przetestować te alternatywy?”</p>
<p><strong>Przykład:</strong> Zanim wyciągniemy wniosek, że cechy sąsiedztwa powodują wskaźniki przestępczości, badacze muszą rozważyć i kontrolować takie czynniki jak ubóstwo, możliwości edukacyjne i historyczne wzorce.</p>
</blockquote>
</section>
</section>
<section id="od-asocjacji-do-przyczynowości" class="level3" data-number="16.4.4">
<h3 data-number="16.4.4" class="anchored" data-anchor-id="od-asocjacji-do-przyczynowości"><span class="header-section-number">16.4.4</span> Od asocjacji do przyczynowości</h3>
<p>Pamiętaj o tych kluczowych zasadach podczas analizy danych korelacyjnych:</p>
<ol type="1">
<li><strong>Korelacja jest konieczna, ale niewystarczająca</strong> do ustalenia przyczynowości</li>
<li><strong>Wiele uzupełniających się metod</strong> wzmacnia wnioskowanie przyczynowe</li>
<li><strong>Triangulacja z różnych źródeł danych</strong> zwiększa pewność co do twierdzeń przyczynowych</li>
<li><strong>Przejrzystość dotycząca ograniczeń</strong> jest niezbędna dla rzetelności naukowej</li>
</ol>
<p>Najbardziej solidne badania łączą silne podstawy teoretyczne z wieloma podejściami metodologicznymi, aby budować przekonujące dowody na istnienie związków przyczynowych, nawet gdy prawdziwe eksperymenty nie są możliwe.</p>
<section id="wzorce-sezonowe-i-pozorne-korelacje" class="level4" data-number="16.4.4.1">
<h4 data-number="16.4.4.1" class="anchored" data-anchor-id="wzorce-sezonowe-i-pozorne-korelacje"><span class="header-section-number">16.4.4.1</span> Wzorce Sezonowe i Pozorne Korelacje</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ta wizualizacja przedstawia klasyczny przykład zmiennej zakłócającej w analizie statystycznej. Pozorna korelacja między sprzedażą lodów a wskaźnikiem przestępczości (r = 0,85, p &lt; 0,001) pokazuje, jak wahania sezonowe mogą tworzyć mylące zależności statystyczne. Korelacja wynika ze wspólnego czynnika przyczynowego: sezonowych zmian temperatury, które niezależnie wpływają na obie zmienne poprzez odrębne mechanizmy.</p>
</section>
<section id="trendy-czasowe-i-pozorne-związki" class="level4" data-number="16.4.4.2">
<h4 data-number="16.4.4.2" class="anchored" data-anchor-id="trendy-czasowe-i-pozorne-związki"><span class="header-section-number">16.4.4.2</span> Trendy Czasowe i Pozorne Związki</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ta druga analiza ilustruje błąd korelacji czasowej, gdzie dwa niezależnie malejące trendy tworzą sztuczny związek statystyczny. Pomimo silnego współczynnika korelacji (r = 0,91, p &lt; 0,001), nie istnieje żaden wiarygodny mechanizm przyczynowy łączący te zmienne.</p>
</section>
</section>
</div>
</div>
</section>
</section>
<section id="kowariancja" class="level3" data-number="16.4.5">
<h3 data-number="16.4.5" class="anchored" data-anchor-id="kowariancja"><span class="header-section-number">16.4.5</span> Kowariancja</h3>
<p>Kowariancja mierzy, jak dwie zmienne są powiązane (zmieniają się razem).</p>
<p><strong>Wzór:</strong> <span class="math inline">cov(X,Y) = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{n - 1}</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Od Kowariancji do Różnych Miar Korelacji
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie różnych typów zależności</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność liniowa</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">*</span>x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x1, <span class="at">y=</span>y1, <span class="at">type=</span><span class="st">"Zależność Liniowa"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność monotoniczna nieliniowa</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">sign</span>(x2)<span class="sc">*</span>(x2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x2, <span class="at">y=</span>y2, <span class="at">type=</span><span class="st">"Monotoniczna Nieliniowa"</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Zależność niemonotoniczna</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out=</span>n)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> x3<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x3, <span class="at">y=</span>y3, <span class="at">type=</span><span class="st">"Niemonotoniczna"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Łączenie danych</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data1, data2, data3)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Różne Typy Zależności Między Zmiennymi"</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna X"</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Y"</span>) <span class="sc">+</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="pojęcie-korelacji" class="level3" data-number="16.4.6">
<h3 data-number="16.4.6" class="anchored" data-anchor-id="pojęcie-korelacji"><span class="header-section-number">16.4.6</span> Pojęcie Korelacji</h3>
<p>Korelacja to szerokie pojęcie opisujące, jak zmienne są ze sobą powiązane. Jak widać na wykresach, zależności te mogą przybierać różne formy.</p>
</section>
<section id="rozpoczynając-od-kowariancji" class="level3" data-number="16.4.7">
<h3 data-number="16.4.7" class="anchored" data-anchor-id="rozpoczynając-od-kowariancji"><span class="header-section-number">16.4.7</span> Rozpoczynając od Kowariancji</h3>
<p>Kowariancja jest podstawową miarą wspólnej zmienności zmiennych:</p>
<p><span class="math display">Cov(X,Y) = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{n-1}</span></p>
<p>Informuje nas o tym:</p>
<ul>
<li>Czy zmienne zmieniają się w tym samym kierunku (kowariancja dodatnia)</li>
<li>Czy zmieniają się w przeciwnych kierunkach (kowariancja ujemna)</li>
<li>Czy brak wyraźnego wzorca liniowego (kowariancja bliska zeru)</li>
</ul>
<p>Jednak kowariancja ma ograniczenie: jej wartość zależy od jednostek pomiaru. Na przykład:</p>
<ul>
<li>Wzrost w metrach vs waga w kg daje jedną wartość kowariancji</li>
<li>Wzrost w centymetrach vs waga w kg daje inną wartość</li>
<li>Ta sama zależność, różne skale!</li>
</ul>
</section>
<section id="standaryzacja-i-miary-korelacji" class="level3" data-number="16.4.8">
<h3 data-number="16.4.8" class="anchored" data-anchor-id="standaryzacja-i-miary-korelacji"><span class="header-section-number">16.4.8</span> Standaryzacja i Miary Korelacji</h3>
<ol type="1">
<li>Współczynnik korelacji Pearsona standaryzuje kowariancję: <span class="math display">r = \frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}}</span></li>
</ol>
<ul>
<li>Eliminuje zależność od jednostek</li>
<li>Zawsze między -1 a 1</li>
<li>Mierzy zależności liniowe</li>
</ul>
<ol start="2" type="1">
<li>Współczynnik korelacji rangowej Spearmana:</li>
</ol>
<ul>
<li>Bazuje na rangach zamiast surowych wartości</li>
<li>Wychwytuje zależności monotoniczne (także nieliniowe)</li>
<li>Również przyjmuje wartości od -1 do 1</li>
</ul>
</section>
<section id="kluczowe-wnioski" class="level3" data-number="16.4.9">
<h3 data-number="16.4.9" class="anchored" data-anchor-id="kluczowe-wnioski"><span class="header-section-number">16.4.9</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Kowariancja pokazuje wspólną zmienność</li>
<li>Miary korelacji dają standaryzowane wartości</li>
<li>Wybór miary korelacji zależy od:
<ul>
<li>Spodziewanego typu zależności</li>
<li>Charakteru danych</li>
<li>Pytania badawczego</li>
</ul></li>
<li>Zawsze wizualizuj dane</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rangi: Pozycje w Uporządkowanym Ciągu
</div>
</div>
<div class="callout-body-container callout-body">
<p>Rangi to po prostu numery pozycji w uporządkowanym zbiorze danych:</p>
<section id="jak-wyznaczyć-rangi" class="level3" data-number="16.4.10">
<h3 data-number="16.4.10" class="anchored" data-anchor-id="jak-wyznaczyć-rangi"><span class="header-section-number">16.4.10</span> Jak Wyznaczyć Rangi?</h3>
<ol type="1">
<li><p>Porządkujemy dane od najmniejszej do największej wartości</p></li>
<li><p>Przypisujemy kolejne liczby naturalne:</p>
<ul>
<li>Najmniejsza wartość → ranga 1</li>
<li>Kolejne wartości → kolejne rangi</li>
<li>Największa wartość → ranga n (liczba obserwacji)</li>
<li>Dla remisów → średnia rang</li>
</ul></li>
</ol>
</section>
<section id="przykład" class="level3" data-number="16.4.11">
<h3 data-number="16.4.11" class="anchored" data-anchor-id="przykład"><span class="header-section-number">16.4.11</span> Przykład</h3>
<p>Mamy 5 studentów o wzroście:</p>
<pre><code>Wzrost:   165, 182, 170, 168, 175
Rangi:     1,   5,   3,   2,   4</code></pre>
<p>Dla danych z remisami (np. oceny):</p>
<pre><code>Oceny:     2,   3,   3,   4,   5
Rangi:     1,  2.5, 2.5,  4,   5</code></pre>
</section>
</div>
</div>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Obliczmy kowariancję dla dwóch zmiennych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 2, 4, 5, 4, 5</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz średnie</td>
<td><span class="math inline">\bar{x} = 3, \bar{y} = 4</span></td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz <span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span> dla każdej pary</td>
<td><span class="math inline">(-2)(-2) = 4</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(-1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(0)(1) = 0</span></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">(1)(0) = 0</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td><span class="math inline">(2)(1) = 2</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Zsumuj wyniki</td>
<td><span class="math inline">4 + 0 + 0 + 0 + 2 = 6</span></td>
</tr>
<tr class="even">
<td>4</td>
<td>Podziel przez (n-1)</td>
<td><span class="math inline">6 / 4 = 1,5</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Dodatnia kowariancja (1,5) wskazuje, że x i y mają tendencję do wzrostu razem.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Dostarcza informacji o kierunku związku (dodatni lub ujemny)</li>
<li>Przydatna w obliczaniu innych miar, takich jak korelacja</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Zależna od skali, co utrudnia porównywanie między różnymi parami zmiennych</li>
<li>Nie dostarcza informacji o sile związku</li>
</ul>
</section>
<section id="korelacja-pearsona" class="level3" data-number="16.4.12">
<h3 data-number="16.4.12" class="anchored" data-anchor-id="korelacja-pearsona"><span class="header-section-number">16.4.12</span> Korelacja Pearsona</h3>
<p>Korelacja Pearsona mierzy siłę i kierunek liniowego związku między dwiema zmiennymi ciągłymi.</p>
<p><strong>Wzór:</strong> <span class="math inline">r = \frac{cov(X,Y)}{s_X s_Y} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}</span></p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Używając tych samych danych co wyżej:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Oblicz kowariancję</td>
<td>(Z poprzedniego obliczenia) 1,5</td>
</tr>
<tr class="even">
<td>2</td>
<td>Oblicz odchylenia standardowe</td>
<td><span class="math inline">s_X = \sqrt{\frac{10}{4}} = 1,58, s_Y = \sqrt{\frac{6}{4}} = 1,22</span></td>
</tr>
<tr class="odd">
<td>3</td>
<td>Podziel kowariancję przez iloczyn odchyleń standardowych</td>
<td><span class="math inline">1,5 / (1,58 * 1,22) = 0,7746</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7745967</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Współczynnik korelacji 0,7746 wskazuje na silny dodatni związek liniowy między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Niezależna od skali, zawsze między -1 a 1</li>
<li>Szeroko rozumiana i stosowana</li>
<li>Testuje związki liniowe</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Wrażliwa na wartości odstające</li>
<li>Mierzy tylko związki liniowe</li>
<li>Zakłada normalnie rozłożone zmienne</li>
</ul>
</section>
<section id="korelacja-spearmana" class="level3" data-number="16.4.13">
<h3 data-number="16.4.13" class="anchored" data-anchor-id="korelacja-spearmana"><span class="header-section-number">16.4.13</span> Korelacja Spearmana</h3>
<p>Korelacja Spearmana mierzy siłę i kierunek monotonicznego związku między dwiema zmiennymi, które mogą być ciągłe lub porządkowe.</p>
<p><strong>Wzór:</strong> <span class="math inline">\rho = 1 - \frac{6 \sum d_i^2}{n(n^2 - 1)}</span>, gdzie <span class="math inline">d_i</span> to różnica między rangami.</p>
<p><strong>Przykład Ręcznego Obliczenia:</strong></p>
<p>Użyjmy nieco innych danych:</p>
<ul>
<li>x: 1, 2, 3, 4, 5</li>
<li>y: 1, 3, 2, 5, 4</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Krok</th>
<th>Opis</th>
<th>Obliczenie</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Przypisz rangi obu zmiennym</td>
<td>x_ranga: 1, 2, 3, 4, 5</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>y_ranga: 1, 3, 2, 5, 4</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Oblicz różnice w rangach (d)</td>
<td>0, -1, 1, -1, 1</td>
</tr>
<tr class="even">
<td>3</td>
<td>Podnieś różnice do kwadratu</td>
<td>0, 1, 1, 1, 1</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Zsumuj kwadraty różnic</td>
<td><span class="math inline">\sum d_i^2 = 4</span></td>
</tr>
<tr class="even">
<td>5</td>
<td>Zastosuj wzór</td>
<td><span class="math inline">\rho = 1 - \frac{6(4)}{5(5^2 - 1)} = 0,8</span></td>
</tr>
</tbody>
</table>
<p><strong>Obliczenie w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Korelacja Spearmana 0,8 wskazuje na silny dodatni związek monotoniczny między x i y.</p>
<p><strong>Zalety:</strong></p>
<ul>
<li>Odporna na wartości odstające</li>
<li>Może wykrywać nieliniowe związki monotoniczne</li>
<li>Odpowiednia dla danych porządkowych</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Mniej odporna niż korelacja Pearsona do wykrywania związków liniowych w normalnie rozłożonych danych</li>
<li>Nie dostarcza informacji o kształcie związku poza monotonicznością</li>
</ul>
</section>
<section id="tabela-krzyżowa" class="level3" data-number="16.4.14">
<h3 data-number="16.4.14" class="anchored" data-anchor-id="tabela-krzyżowa"><span class="header-section-number">16.4.14</span> Tabela Krzyżowa</h3>
<p>Tabela krzyżowa (tabela kontyngencji) pokazuje związek między dwiema zmiennymi kategorycznymi.</p>
<p><strong>Przykład:</strong></p>
<p>Stwórzmy tabelę krzyżową dla dwóch zmiennych: - Poziom wykształcenia: Średnie, Wyższe, Podyplomowe - Status zatrudnienia: Zatrudniony, Bezrobotny</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>wyksztalcenie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>, <span class="st">"Średnie"</span>, <span class="st">"Wyższe"</span>, <span class="st">"Podyplomowe"</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>zatrudnienie <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Zatrudniony"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Bezrobotny"</span>, <span class="st">"Zatrudniony"</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(wyksztalcenie, zatrudnienie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             zatrudnienie
wyksztalcenie Bezrobotny Zatrudniony
  Podyplomowe          0           3
  Średnie              2           1
  Wyższe               1           2</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Ta tabela pokazuje liczbę osób w każdej kombinacji poziomu wykształcenia i statusu zatrudnienia.</li>
<li>Na przykład, możemy zobaczyć, ilu absolwentów szkół średnich jest zatrudnionych, a ilu bezrobotnych.</li>
</ul>
<p><strong>Zalety:</strong></p>
<ul>
<li>Zapewnia jasną wizualną reprezentację związku między zmiennymi kategorycznymi</li>
<li>Łatwa do zrozumienia i interpretacji</li>
<li>Podstawa dla wielu testów statystycznych (np. test chi-kwadrat niezależności)</li>
</ul>
<p><strong>Wady:</strong></p>
<ul>
<li>Ograniczona do danych kategorycznych</li>
<li>Może stać się nieporęczna przy wielu kategoriach</li>
<li>Nie dostarcza pojedynczej statystyki podsumowującej siłę związku</li>
</ul>
</section>
<section id="wybór-odpowiedniej-miary" class="level3" data-number="16.4.15">
<h3 data-number="16.4.15" class="anchored" data-anchor-id="wybór-odpowiedniej-miary"><span class="header-section-number">16.4.15</span> Wybór Odpowiedniej Miary</h3>
<p>Przy wyborze statystyki dwuwymiarowej należy wziąć pod uwagę:</p>
<ol type="1">
<li><p>Typ danych:</p>
<ul>
<li>Dane ciągłe: Kowariancja, korelacja Pearsona</li>
<li>Dane porządkowe: Korelacja Spearmana</li>
<li>Dane kategoryczne: Tabela krzyżowa</li>
</ul></li>
<li><p>Typ związku:</p>
<ul>
<li>Liniowy: Korelacja Pearsona</li>
<li>Monotoniczny, ale potencjalnie nieliniowy: Korelacja Spearmana</li>
</ul></li>
<li><p>Obecność wartości odstających:</p>
<ul>
<li>Jeśli wartości odstające są problemem, korelacja Spearmana jest bardziej odporna</li>
</ul></li>
<li><p>Rozkład:</p>
<ul>
<li>Dla normalnie rozłożonych danych korelacja Pearsona jest najbardziej odporna (robust)</li>
<li>Dla rozkładów “nienormalnych” rozważ korelację Spearmana</li>
</ul></li>
<li><p>Wielkość próby:</p>
<ul>
<li>Dla bardzo małych prób metody nieparametryczne, takie jak korelacja Spearmana, mogą być preferowane</li>
</ul></li>
</ol>
<p>Pamiętaj, że często wartościowe jest użycie wielu miar i wizualizacji (takich jak wykresy rozrzutu), aby uzyskać kompleksowe zrozumienie związku między zmiennymi.</p>
</section>
</section>
<section id="wprowadzenie-do-podstawowej-statystyki-wielowymiarowej" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="wprowadzenie-do-podstawowej-statystyki-wielowymiarowej"><span class="header-section-number">16.5</span> Wprowadzenie do Podstawowej Statystyki Wielowymiarowej (*)</h2>
<p>Statystyki wielowymiarowe obejmują analizę związków między trzema lub więcej zmiennymi jednocześnie. Ta sekcja wprowadzi niektóre podstawowe koncepcje i techniki analizy wielowymiarowej, koncentrując się na metodach opartych na korelacji.</p>
<section id="macierz-korelacji" class="level3" data-number="16.5.1">
<h3 data-number="16.5.1" class="anchored" data-anchor-id="macierz-korelacji"><span class="header-section-number">16.5.1</span> Macierz Korelacji</h3>
<p>Macierz korelacji to tabela pokazująca korelacje parami dla kilku zmiennych. Jest to podstawowe narzędzie w analizie wielowymiarowej.</p>
<p><strong>Przykład:</strong> Stwórzmy macierz korelacji dla czterech zmiennych: wzrost, waga, wiek i dochód.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Dla powtarzalności</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>wzrost <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">170</span>, <span class="dv">10</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>waga <span class="ot">&lt;-</span> wzrost <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>wiek <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">40</span>, <span class="dv">10</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dochod <span class="ot">&lt;-</span> wiek <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">10000</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(wzrost, waga, wiek, dochod)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>macierz_kor <span class="ot">&lt;-</span> <span class="fu">cor</span>(dane)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(macierz_kor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           wzrost        waga        wiek      dochod
wzrost  1.0000000  0.66712996 -0.12917601 -0.12246786
waga    0.6671300  1.00000000 -0.06814187 -0.04579492
wiek   -0.1291760 -0.06814187  1.00000000  0.65654902
dochod -0.1224679 -0.04579492  0.65654902  1.00000000</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong> - Każda komórka pokazuje korelację między dwiema zmiennymi. - Przekątna zawsze wynosi 1 (korelacja zmiennej z samą sobą). - Szukaj silnych korelacji (bliskich 1 lub -1), aby zidentyfikować potencjalne związki.</p>
</section>
<section id="wizualizacja-związków-wielowymiarowych" class="level3" data-number="16.5.2">
<h3 data-number="16.5.2" class="anchored" data-anchor-id="wizualizacja-związków-wielowymiarowych"><span class="header-section-number">16.5.2</span> Wizualizacja Związków Wielowymiarowych</h3>
<section id="macierz-wykresów-rozrzutu" class="level4" data-number="16.5.2.1">
<h4 data-number="16.5.2.1" class="anchored" data-anchor-id="macierz-wykresów-rozrzutu"><span class="header-section-number">16.5.2.1</span> Macierz Wykresów Rozrzutu</h4>
<p>Macierz wykresów rozrzutu pokazuje parami związki między wieloma zmiennymi.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(dane)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Każdy wykres pokazuje związek między dwiema zmiennymi.</li>
<li>Elementy na przekątnej pokazują rozkład każdej zmiennej.</li>
<li>Szukaj wzorców, skupisk lub trendów na wykresach.</li>
</ul>
</section>
<section id="wykres-korelacji" class="level4" data-number="16.5.2.2">
<h4 data-number="16.5.2.2" class="anchored" data-anchor-id="wykres-korelacji"><span class="header-section-number">16.5.2.2</span> Wykres Korelacji</h4>
<p>Wykres korelacji zapewnia wizualną reprezentację macierzy korelacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(macierz_kor, <span class="at">method =</span> <span class="st">"color"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Intensywność koloru i rozmiar kół wskazują na siłę korelacji.</li>
<li>Niebieskie kolory zazwyczaj wskazują na dodatnie korelacje, czerwone na ujemne.</li>
</ul>
</section>
</section>
<section id="korelacja-cząstkowa" class="level3" data-number="16.5.3">
<h3 data-number="16.5.3" class="anchored" data-anchor-id="korelacja-cząstkowa"><span class="header-section-number">16.5.3</span> Korelacja Cząstkowa</h3>
<p>Korelacja cząstkowa mierzy związek między dwiema zmiennymi przy kontrolowaniu jednej lub więcej innych zmiennych.</p>
<p><strong>Przykład:</strong> Obliczmy korelację cząstkową między wzrostem a wagą, kontrolując wiek.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pcor.test</span>(dane<span class="sc">$</span>wzrost, dane<span class="sc">$</span>waga, dane<span class="sc">$</span>wiek)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   estimate      p.value statistic   n gp  Method
1 0.6654367 5.758157e-14  8.779896 100  1 pearson</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>Porównaj to z prostą korelacją między wzrostem a wagą.</li>
<li>Znacząca zmiana może wskazywać, że wiek odgrywa rolę w związku między wzrostem a wagą.</li>
</ul>
</section>
<section id="korelacja-wielokrotna" class="level3" data-number="16.5.4">
<h3 data-number="16.5.4" class="anchored" data-anchor-id="korelacja-wielokrotna"><span class="header-section-number">16.5.4</span> Korelacja Wielokrotna</h3>
<p>Korelacja wielokrotna mierzy siłę związku między zmienną zależną a wieloma zmiennymi niezależnymi.</p>
<p><strong>Przykład:</strong> Przewidźmy wagę na podstawie wzrostu i wieku.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(waga <span class="sc">~</span> wzrost <span class="sc">+</span> wiek, <span class="at">data =</span> dane)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Współczynnik korelacji wielokrotnej:"</span>, R))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Współczynnik korelacji wielokrotnej: 0.667377840470434"</code></pre>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li>R waha się od 0 do 1, przy czym wyższe wartości wskazują na silniejsze związki.</li>
<li>R² (R-kwadrat) reprezentuje proporcję wariancji w zmiennej zależnej wyjaśnioną przez zmienne niezależne.</li>
</ul>
</section>
</section>
<section id="wprowadzenie-do-analizy-regresji" class="level2" data-number="16.6">
<h2 data-number="16.6" class="anchored" data-anchor-id="wprowadzenie-do-analizy-regresji"><span class="header-section-number">16.6</span> Wprowadzenie do Analizy Regresji</h2>
<p>Analiza regresji to metoda statystyczna, która bada i modeluje zależności między zmiennymi w celu zrozumienia, jak zmiany w jednej lub kilku zmiennych niezależnych wpływają na zmienną zależną.</p>
<p>W swojej istocie analiza regresji pomaga odpowiedzieć na pytania dotyczące przyczyny i skutku, przewidywania oraz prognozowania. Na przykład, przedsiębiorstwo może wykorzystać analizę regresji do zrozumienia, jak wydatki na reklamę wpływają na sprzedaż lub jak liczba godzin szkoleń pracowników przekłada się na produktywność.</p>
<p>Proces rozpoczyna się od zbierania danych o interesujących nas zmiennych. Następnie analiza dopasowuje model matematyczny - zazwyczaj linię lub krzywą - który najlepiej reprezentuje zależność między tymi zmiennymi. Model ten pozwala:</p>
<ul>
<li>Określić siłę i kierunek zależności między zmiennymi</li>
<li>Dokonywać przewidywań dotyczących przyszłych wyników</li>
<li>Zrozumieć, które czynniki mają największy wpływ na nasze rezultaty</li>
</ul>
<section id="regresja-jako-model-stochastyczny" class="level3" data-number="16.6.1">
<h3 data-number="16.6.1" class="anchored" data-anchor-id="regresja-jako-model-stochastyczny"><span class="header-section-number">16.6.1</span> Regresja jako Model Stochastyczny</h3>
<p>W modelowaniu matematycznym spotykamy dwa podstawowe podejścia do opisywania relacji między zmiennymi:</p>
<ul>
<li>modele deterministyczne,</li>
<li>modele stochastyczne.</li>
</ul>
<section id="modele-deterministyczne-a-stochastyczne" class="level4" data-number="16.6.1.1">
<h4 data-number="16.6.1.1" class="anchored" data-anchor-id="modele-deterministyczne-a-stochastyczne"><span class="header-section-number">16.6.1.1</span> Modele Deterministyczne a Stochastyczne</h4>
<p>Model deterministyczny zakłada precyzyjną, ustaloną relację między danymi wejściowymi a wyjściowymi. W takich modelach, znając dane wejściowe, możemy z całkowitą pewnością obliczyć dokładny wynik. Weźmy pod uwagę klasyczne równanie fizyczne dotyczące drogi:</p>
<p><span class="math display">\text{Droga} = \text{Prędkość} × \text{Czas}</span></p>
<p>Przy określonych wartościach prędkości i czasu, równanie to zawsze da tę samą drogę. Nie ma tu miejsca na jakąkolwiek zmienność wyniku.</p>
<p>W przeciwieństwie do tego, analiza regresji uwzględnia naturalną zmienność danych. Podstawowa struktura modelu regresji to:</p>
<p><span class="math display">Y = f(X) + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y</span> reprezentuje wynik, który chcemy przewidzieć</li>
<li><span class="math inline">f(X)</span> reprezentuje systematyczną relację między naszymi predyktorami (X) a wynikiem</li>
<li><span class="math inline">\epsilon</span> reprezentuje losową zmienność naturalnie występującą w rzeczywistych danych</li>
</ul>
</section>
<section id="natura-modeli-stochastycznych-w-regresji" class="level4" data-number="16.6.1.2">
<h4 data-number="16.6.1.2" class="anchored" data-anchor-id="natura-modeli-stochastycznych-w-regresji"><span class="header-section-number">16.6.1.2</span> Natura Modeli Stochastycznych w Regresji</h4>
<p>Włączenie składnika błędu <span class="math inline">\epsilon</span> uznaje, że rzeczywiste relacje między zmiennymi rzadko są idealne. Na przykład, badając wpływ czasu nauki na wyniki testów, wiele czynników przyczynia się do końcowego rezultatu:</p>
<p>Część systematyczna <span class="math inline">f(X)</span> wychwytuje ogólną tendencję: więcej czasu nauki zazwyczaj prowadzi do wyższych wyników.</p>
<p>Składnik błędu <span class="math inline">\epsilon</span> uwzględnia wszystkie inne czynniki:</p>
<ul>
<li>Różne style uczenia się</li>
<li>Środowisko nauki</li>
<li>Stan fizyczny i psychiczny podczas testu</li>
<li>Jakość materiałów dydaktycznych</li>
</ul>
</section>
<section id="struktura-matematyczna" class="level4" data-number="16.6.1.3">
<h4 data-number="16.6.1.3" class="anchored" data-anchor-id="struktura-matematyczna"><span class="header-section-number">16.6.1.3</span> Struktura Matematyczna</h4>
<p>W swojej najprostszej formie regresja liniowa może być wyrażona jako:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> reprezentuje wartość bazową (gdy X = 0)</li>
<li><span class="math inline">\beta_1</span> reprezentuje zmianę Y dla każdej jednostkowej zmiany X</li>
<li><span class="math inline">\epsilon</span> reprezentuje naturalną zmienność wokół tej relacji</li>
</ul>
</section>
<section id="implikacje-praktyczne" class="level4" data-number="16.6.1.4">
<h4 data-number="16.6.1.4" class="anchored"><span class="header-section-number">16.6.1.4</span> Implikacje Praktyczne</h4>
<p>Zrozumienie regresji jako modelu stochastycznego ma istotne implikacje praktyczne:</p>
<ol type="1">
<li><p>Przewidywania: Uznajemy, że nasze przewidywania będą charakteryzować się pewną naturalną zmiennością. Zamiast twierdzić, że wynik będzie dokładny, uznajemy zakres prawdopodobnych wartości.</p></li>
<li><p>Ocena Modelu: Oceniamy modele na podstawie tego, jak dobrze ujmują zarówno ogólną tendencję, jak i typową wielkość zmienności w danych.</p></li>
<li><p>Podejmowanie Decyzji: Zrozumienie naturalnej zmienności w naszych przewidywaniach pomaga nam podejmować bardziej realistyczne plany i decyzje.</p></li>
</ol>
<p><strong>Zastosowania w Rzeczywistości</strong></p>
<p>Rozważmy przewidywanie cen domów na podstawie metrażu. Model deterministyczny mógłby stwierdzić: “Dom o powierzchni 186 metrów kwadratowych będzie kosztować dokładnie 1 200 000 złotych”</p>
<p>Model regresji natomiast uznaje, że:</p>
<ul>
<li>Istnieje ogólna relacja między wielkością a ceną</li>
<li>Ale wiele innych czynników wpływa na końcową cenę</li>
<li>Podobne domy mogą być sprzedawane po nieco różnych cenach</li>
<li>Nasze przewidywania powinny odzwierciedlać tę naturalną zmienność</li>
</ul>
<p><strong>Podsumowanie</strong></p>
<p>Stochastyczna natura analizy regresji zapewnia bardziej realistyczne ramy do zrozumienia rzeczywistych relacji między zmiennymi.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Model Regresji Liniowej (MNK): Szybki Start
</div>
</div>
<div class="callout-body-container callout-body">
<section id="koncepcja-modelu" class="level3" data-number="16.6.2">
<h3 data-number="16.6.2" class="anchored" data-anchor-id="koncepcja-modelu"><span class="header-section-number">16.6.2</span> Koncepcja Modelu</h3>
<p>Regresja MNK (Metoda Najmniejszych Kwadratów) to model statystyczny opisujący związek między zmiennymi. Dwa kluczowe założenia definiują ten model:</p>
<ol type="1">
<li>Związek można opisać linią prostą (liniowość)</li>
<li>Błędy w naszych przewidywaniach nie są systematycznie powiązane ze zmienną x (ścisła egzogeniczność)</li>
</ol>
</section>
<section id="przykład-edukacja-i-wynagrodzenia" class="level3" data-number="16.6.3">
<h3 data-number="16.6.3" class="anchored" data-anchor-id="przykład-edukacja-i-wynagrodzenia"><span class="header-section-number">16.6.3</span> Przykład: Edukacja i Wynagrodzenia</h3>
<p>Rozważmy badanie wpływu edukacji (x) na wynagrodzenia (y). Powiedzmy, że szacujemy:</p>
<p><span class="math display">wynagrodzenia = \beta_0 + \beta_1 \cdot edukacja + \epsilon</span></p>
<p>Składnik błędu <span class="math inline">\epsilon</span> zawiera wszystkie inne czynniki wpływające na wynagrodzenia. Ścisła egzogeniczność jest naruszona, jeśli pominiemy ważną zmienną, jak “zdolności”, która wpływa zarówno na edukację, jak i wynagrodzenia. Dlaczego? Ponieważ bardziej zdolni ludzie mają tendencję do zdobywania lepszego wykształcenia I wyższych wynagrodzeń, co powoduje zawyżenie szacowanego efektu edukacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate OLS parameters</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(x, y) <span class="sc">/</span> <span class="fu">var</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y) <span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(x)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create alternative lines</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>lines_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">intercept =</span> <span class="fu">c</span>(beta0, beta0 <span class="sc">+</span> <span class="dv">1</span>, beta0 <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">slope =</span> <span class="fu">c</span>(beta1, beta1 <span class="sc">+</span> <span class="fl">0.3</span>, beta1 <span class="sc">-</span> <span class="fl">0.3</span>),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">line_type =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span>, <span class="st">"Suboptimal 1"</span>, <span class="st">"Suboptimal 2"</span>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> lines_data,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> slope,</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> line_type,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">linetype =</span> line_type),</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Best fit (OLS)"</span> <span class="ot">=</span> <span class="st">"#FF4500"</span>,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 1"</span> <span class="ot">=</span> <span class="st">"#4169E1"</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Suboptimal 2"</span> <span class="ot">=</span> <span class="st">"#228B22"</span>)) <span class="sc">+</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Finding the Best-Fitting Line"</span>,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Orange line minimizes the sum of squared errors"</span>,</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X Variable"</span>,</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Y Variable"</span>,</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Line Type"</span>,</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Line Type"</span>) <span class="sc">+</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="problem-optymalizacji-metoda-najmniejszych-kwadratów-ols" class="level3" data-number="16.6.4">
<h3 data-number="16.6.4" class="anchored" data-anchor-id="problem-optymalizacji-metoda-najmniejszych-kwadratów-ols"><span class="header-section-number">16.6.4</span> Problem Optymalizacji: Metoda Najmniejszych Kwadratów (OLS)</h3>
<p>Kiedy analizujemy zależności między zmiennymi, takimi jak poziom wykształcenia a wynagrodzenie, potrzebujemy systematycznej metody znalezienia linii, która najlepiej odzwierciedla tę relację w naszych danych. Metoda Najmniejszych Kwadratów (OLS - Ordinary Least Squares) dostarcza nam takiego rozwiązania poprzez precyzyjne podejście matematyczne.</p>
<p>Spójrzmy na nasz wykres poziomów wykształcenia i wynagrodzeń. Każdy punkt reprezentuje rzeczywiste dane - poziom wykształcenia danej osoby i odpowiadające mu wynagrodzenie. Naszym celem jest znalezienie pojedynczej linii, która najdokładniej uchwyci podstawową zależność między tymi zmiennymi.</p>
<p>Dla każdej obserwacji <span class="math inline">i</span> możemy wyrazić tę relację jako:</p>
<p><span class="math display">y_i = \beta_0 + \beta_1x_i + \epsilon_i</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">y_i</span> to rzeczywiste zaobserwowane wynagrodzenie</li>
<li><span class="math inline">\hat{y_i} = \beta_0 + \beta_1x_i</span> to przewidywane wynagrodzenie</li>
<li><span class="math inline">\epsilon_i = y_i - \hat{y_i}</span> to składnik błędu (reszta)</li>
</ul>
<p>Metoda OLS znajduje optymalne wartości dla <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> poprzez minimalizację sumy kwadratów błędów:</p>
<p><span class="math display">\min_{\beta_0, \beta_1} \sum \epsilon_i^2 = \min_{\beta_0, \beta_1} \sum(y_i - \hat{y_i})^2 = \min_{\beta_0, \beta_1} \sum(y_i - (\beta_0 + \beta_1x_i))^2</span></p>
<p>Analizując naszą wizualizację:</p>
<ul>
<li>Rozproszone punkty pokazują rzeczywiste obserwacje <span class="math inline">(x_i, y_i)</span></li>
<li>Czerwona linia reprezentuje dopasowane wartości <span class="math inline">\hat{y_i}</span>, które minimalizują <span class="math inline">\sum \epsilon_i^2</span></li>
<li>Niebieska i zielona linia przedstawiają alternatywne dopasowania o większych sumach kwadratów błędów</li>
<li>Pionowe odległości od każdego punktu do tych linii reprezentują błędy <span class="math inline">\epsilon_i</span></li>
</ul>
<p>Rozwiązanie OLS dostarcza nam estymatorów <span class="math inline">\hat{\beta_0}</span> i <span class="math inline">\hat{\beta_1}</span> nieznanych parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>, które minimalizują całkowity błąd kwadratowy, dając nam najdokładniejszą liniową reprezentację zależności między poziomem wykształcenia a wynagrodzeniem na podstawie dostępnych danych.</p>
</section>
<section id="znalezienie-najlepszej-linii" class="level3" data-number="16.6.5">
<h3 data-number="16.6.5" class="anchored" data-anchor-id="znalezienie-najlepszej-linii"><span class="header-section-number">16.6.5</span> Znalezienie Najlepszej Linii</h3>
<p>Rozwiązanie tego problemu minimalizacji daje nam:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sum(x_i - \bar{x})^2} = \frac{cov(X, Y)}{var(X)}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
</section>
<section id="kluczowe-punkty" class="level3" data-number="16.6.6">
<h3 data-number="16.6.6" class="anchored" data-anchor-id="kluczowe-punkty"><span class="header-section-number">16.6.6</span> Kluczowe Punkty</h3>
<ol type="1">
<li>MNK znajduje linię, która minimalizuje kwadraty błędów predykcji</li>
<li>Ta linia jest “najlepsza” pod względem dopasowania, ale może nie ujmować prawdziwych relacji, jeśli pominięto ważne zmienne</li>
<li>W przykładzie edukacja-wynagrodzenia, pominięcie zdolności oznacza, że przypisujemy cały wzrost wynagrodzeń samej edukacji</li>
</ol>
</section>
</div>
</div>
</section>
</section>
<section id="podstawowe-pojęcia-i-terminologia" class="level3" data-number="16.6.7">
<h3 data-number="16.6.7" class="anchored" data-anchor-id="podstawowe-pojęcia-i-terminologia"><span class="header-section-number">16.6.7</span> Podstawowe Pojęcia i Terminologia</h3>
<p>Ustalmy kluczowe terminy:</p>
<ul>
<li><strong>Zmienna Zależna (Y)</strong>:
<ul>
<li>Wynik, który chcemy zrozumieć lub przewidzieć</li>
<li>Nazywana również: zmienna odpowiedzi, zmienna docelowa</li>
<li>Przykłady: wynagrodzenie, sprzedaż, wyniki egzaminów</li>
</ul></li>
<li><strong>Zmienna Niezależna (X)</strong>:
<ul>
<li>Zmienna, która naszym zdaniem wpływa na Y</li>
<li>Nazywana również: predyktor, zmienna objaśniająca, regresor</li>
<li>Przykłady: lata edukacji, budżet reklamowy, godziny nauki</li>
</ul></li>
<li><strong>Parametry Populacji (</strong><span class="math inline">\beta</span>):
<ul>
<li>Prawdziwe podstawowe zależności, które chcemy zrozumieć</li>
<li>Zazwyczaj nieznane w praktyce</li>
<li>Przykłady: <span class="math inline">\beta_0</span> (prawdziwy wyraz wolny), <span class="math inline">\beta_1</span> (prawdziwe nachylenie)</li>
</ul></li>
<li><strong>Oszacowania Parametrów (</strong><span class="math inline">\hat{\beta}</span>):
<ul>
<li>Nasze najlepsze przypuszczenia dotyczące prawdziwych parametrów na podstawie danych</li>
<li>Obliczane na podstawie danych próby</li>
<li>Przykłady: <span class="math inline">\hat{\beta}_0</span> (oszacowany wyraz wolny), <span class="math inline">\hat{\beta}_1</span> (oszacowane nachylenie)</li>
</ul></li>
</ul>
</section>
<section id="główna-idea" class="level3" data-number="16.6.8">
<h3 data-number="16.6.8" class="anchored" data-anchor-id="główna-idea"><span class="header-section-number">16.6.8</span> Główna Idea</h3>
<p>Zobaczmy na przykładzie, co robi regresja:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate some example data</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Przykład Prostej Regresji Liniowej"</span>,</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Punkty reprezentują dane, czerwona linia pokazuje dopasowanie regresji"</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Zmienna Niezależna (X)"</span>,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Zmienna Zależna (Y)"</span>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-basic-idea" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-basic-idea-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-basic-idea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Podstawowa Idea Regresji: Dopasowanie Linii do Danych
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ten wykres pokazuje istotę regresji:</p>
<ul>
<li>Każdy punkt reprezentuje obserwację (X, Y)</li>
<li>Linia reprezentuje nasze najlepsze przypuszczenie dotyczące zależności</li>
<li>Rozproszenie punktów wokół linii pokazuje niepewność</li>
</ul>
</section>
</section>
<section id="model-regresji-liniowej" class="level2" data-number="16.7">
<h2 data-number="16.7" class="anchored" data-anchor-id="model-regresji-liniowej"><span class="header-section-number">16.7</span> Model Regresji Liniowej</h2>
<section id="model-populacyjny-vs.-oszacowania-z-próby" class="level3" data-number="16.7.1">
<h3 data-number="16.7.1" class="anchored" data-anchor-id="model-populacyjny-vs.-oszacowania-z-próby"><span class="header-section-number">16.7.1</span> Model Populacyjny vs.&nbsp;Oszacowania z Próby</h3>
<p>W teorii istnieje prawdziwa zależność populacyjna:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \varepsilon</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to prawdziwy wyraz wolny populacji</li>
<li><span class="math inline">\beta_1</span> to prawdziwe nachylenie populacji</li>
<li><span class="math inline">\varepsilon</span> to składnik losowy błędu</li>
</ul>
<p>W praktyce pracujemy z danymi próby, aby oszacować tę zależność:</p>
<p><span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X</span></p>
<p>Zobaczmy wizualizację różnicy między zależnościami populacyjnymi a próbkowymi:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate population data</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>x_pop <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>true_relationship <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_pop  <span class="co"># True β₀=2, β₁=3</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>y_pop <span class="ot">&lt;-</span> true_relationship <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x_pop), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create several samples</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">sample</span>(x_pop, sample_size), <span class="dv">3</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> sample_size)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>samples<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>samples<span class="sc">$</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(samples), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models to each sample</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> samples <span class="sc">%&gt;%</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">1</span>],</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x))[<span class="dv">2</span>]</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> samples, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="fu">factor</span>(sample)), </span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> models, </span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope, </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="fu">factor</span>(sample)),</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x_pop, <span class="at">y =</span> true_relationship), </span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linie Regresji: Populacyjna vs. Próbkowe"</span>,</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Czarna linia: prawdziwa zależność populacyjna</span><span class="sc">\n</span><span class="st">Linie przerywane: oszacowania próbkowe"</span>,</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Y"</span>,</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Próba"</span>) <span class="sc">+</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pop-vs-sample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-pop-vs-sample-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pop-vs-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.2: Linie Regresji: Populacyjna vs.&nbsp;Próbkowe
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ta wizualizacja pokazuje:</p>
<ul>
<li>Prawdziwą linię populacyjną (czarną), którą próbujemy odkryć</li>
<li>Różne oszacowania próbkowe (linie przerywane) oparte na różnych próbach</li>
<li>Jak oszacowania próbkowe różnią się wokół prawdziwej zależności</li>
</ul>
</section>
</section>
<section id="kluczowe-założenia-regresji-liniowej" class="level2" data-number="16.8">
<h2 data-number="16.8" class="anchored" data-anchor-id="kluczowe-założenia-regresji-liniowej"><span class="header-section-number">16.8</span> Kluczowe Założenia Regresji Liniowej</h2>
<section id="ścisła-egzogeniczność-podstawowe-założenie" class="level3" data-number="16.8.1">
<h3 data-number="16.8.1" class="anchored" data-anchor-id="ścisła-egzogeniczność-podstawowe-założenie"><span class="header-section-number">16.8.1</span> Ścisła Egzogeniczność: Podstawowe Założenie</h3>
<p>Najważniejszym założeniem w regresji jest ścisła egzogeniczność:</p>
<p><span class="math display">E[\varepsilon|X] = 0</span></p>
<p>Oznacza to:</p>
<ol type="1">
<li>Wartość oczekiwana składnika błędu warunkowego względem X wynosi zero</li>
<li>X nie zawiera informacji o przeciętnym błędzie</li>
<li>Nie ma systematycznych wzorców w tym, jak nasze przewidywania są błędne</li>
</ol>
<p>Zobaczmy wizualizację sytuacji, gdy to założenie jest spełnione i gdy nie jest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 1: Exogenous errors</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>y_exog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Case 2: Non-exogenous errors (error variance increases with x)</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>y_nonexog <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>data_exog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_exog,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Błędy Egzogeniczne</span><span class="sc">\n</span><span class="st">(Założenie Spełnione)"</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>data_nonexog <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y_nonexog,</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"Błędy Nieegzogeniczne</span><span class="sc">\n</span><span class="st">(Założenie Niespełnione)"</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_exog, data_nonexog)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plots with residuals</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>plot_residuals <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Reszty"</span>)</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(p1, p2)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate plots</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>plots_exog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_exog, <span class="st">"Błędy Egzogeniczne"</span>)</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>plots_nonexog <span class="ot">&lt;-</span> <span class="fu">plot_residuals</span>(data_nonexog, <span class="st">"Błędy Nieegzogeniczne"</span>)</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots</span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>  plots_exog[[<span class="dv">1</span>]], plots_exog[[<span class="dv">2</span>]],</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>  plots_nonexog[[<span class="dv">1</span>]], plots_nonexog[[<span class="dv">2</span>]],</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-exogeneity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-exogeneity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-exogeneity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.3: Przykłady Egzogeniczności vs.&nbsp;Nieegzogeniczności
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="liniowość-założenie-o-formie" class="level3" data-number="16.8.2">
<h3 data-number="16.8.2" class="anchored" data-anchor-id="liniowość-założenie-o-formie"><span class="header-section-number">16.8.2</span> Liniowość: Założenie o Formie</h3>
<p>Zależność między X a Y powinna być liniowa w parametrach:</p>
<p><span class="math display">E[Y|X] = \beta_0 + \beta_1X</span></p>
<p>Zauważ, że nie oznacza to, że X i Y muszą mieć zależność w postaci linii prostej - możemy transformować zmienne. Zobaczmy różne rodzaje zależności:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Different relationships</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>data_relationships <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x, <span class="dv">3</span>),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Linear</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Quadratic</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Exponential</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Liniowa"</span>, <span class="st">"Kwadratowa"</span>, <span class="st">"Wykładnicza"</span>), <span class="at">each =</span> <span class="fu">length</span>(x))</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_relationships, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>type, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Czerwona: dopasowanie liniowe, Niebieska: prawdziwa zależność"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-linearity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-linearity-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-linearity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.4: Zależności Liniowe i Nieliniowe
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zrozumienie-naruszeń-i-rozwiązania" class="level3" data-number="16.8.3">
<h3 data-number="16.8.3" class="anchored" data-anchor-id="zrozumienie-naruszeń-i-rozwiązania"><span class="header-section-number">16.8.3</span> Zrozumienie Naruszeń i Rozwiązania</h3>
<p>Gdy założenie liniowości jest naruszone:</p>
<ol type="1">
<li>Transformacja zmiennych:
<ul>
<li>Transformacja logarytmiczna: dla zależności wykładniczych</li>
<li>Pierwiastek kwadratowy: dla umiarkowanej nieliniowości</li>
<li>Transformacje potęgowe: dla bardziej złożonych zależności</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate exponential data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">102</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.3</span><span class="sc">*</span>x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create datasets</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>data_trans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">log_y =</span> <span class="fu">log</span>(y)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in log(y): NaNs produced</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original scale plot</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Skala Oryginalna"</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Log scale plot</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_trans, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> log_y)) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y po Transformacji Logarytmicznej"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-transformations" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correg_pl_files/figure-html/fig-transformations-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transformations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.5: Efekt Transformacji Zmiennych
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Intuicyjne zrozumienie Metody Najmniejszych Kwadratów (MNK)
</div>
</div>
<div class="callout-body-container callout-body">
<section id="podstawowy-problem" class="level3" data-number="16.8.4">
<h3 data-number="16.8.4" class="anchored" data-anchor-id="podstawowy-problem"><span class="header-section-number">16.8.4</span> Podstawowy Problem</h3>
<p>Zacznijmy od rzeczywistego scenariusza: chcemy zrozumieć, jak czas nauki wpływa na wyniki egzaminu. Zbieramy dane z Twojej klasy, gdzie:</p>
<ul>
<li>Każdy student zapisuje swoje godziny nauki (<span class="math inline">x</span>), oraz swój końcowy wynik egzaminu (<span class="math inline">y</span>)</li>
<li>Więc student 1 mógł się uczyć <span class="math inline">x_1 = 3</span> godziny i uzyskać <span class="math inline">y_1 = 75</span> punktów</li>
<li>Student 2 mógł się uczyć <span class="math inline">x_2 = 5</span> godzin i uzyskać <span class="math inline">y_2 = 82</span> punkty</li>
<li>I tak dalej dla wszystkich <span class="math inline">n</span> studentów w klasie</li>
</ul>
<p>Naszym celem jest znalezienie prostej, która najlepiej opisuje tę zależność. Próbujemy oszacować prawdziwą zależność (której nigdy nie znamy dokładnie) używając naszej próby danych. Przeanalizujmy to krok po kroku.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>godziny_nauki <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>wyniki_egzaminu <span class="ot">&lt;-</span> <span class="dv">60</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> godziny_nauki <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(godziny_nauki, wyniki_egzaminu)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Podstawowy wykres punktowy</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Dane z Twojej klasy: Godziny nauki vs. Wyniki egzaminu"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="co-sprawia-że-prosta-jest-dobra" class="level3" data-number="16.8.5">
<h3 data-number="16.8.5" class="anchored" data-anchor-id="co-sprawia-że-prosta-jest-dobra"><span class="header-section-number">16.8.5</span> Co sprawia, że prosta jest “dobra”?</h3>
<p>Każdą prostą można zapisać w postaci:</p>
<p><span class="math inline">y = \hat{\beta}_0 + \hat{\beta}_1x</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\hat{\beta}_0</span> to nasza estymata wyrazu wolnego (przewidywany wynik dla zero godzin nauki)</li>
<li><span class="math inline">\hat{\beta}_1</span> to nasza estymata nachylenia (ile punktów zyskujemy za każdą dodatkową godzinę nauki)</li>
<li>Daszki (^) wskazują, że są to nasze estymaty prawdziwych (nieznanych) parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span></li>
</ul>
<p>Spójrzmy na trzy możliwe proste przechodzące przez nasze dane:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">50</span>, <span class="at">slope =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Trzy różne proste: Która jest najlepsza?"</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">label =</span> <span class="st">"Prosta A: Za stroma"</span>) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">85</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">label =</span> <span class="st">"Prosta B: Za płaska"</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">7.5</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">label =</span> <span class="st">"Prosta C: W sam raz"</span>) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="zrozumienie-błędów-przewidywania-reszt" class="level3" data-number="16.8.6">
<h3 data-number="16.8.6" class="anchored" data-anchor-id="zrozumienie-błędów-przewidywania-reszt"><span class="header-section-number">16.8.6</span> Zrozumienie błędów przewidywania (reszt)</h3>
<p>Dla każdego studenta w naszych danych:</p>
<ol type="1">
<li>Patrzymy na jego rzeczywisty wynik egzaminu (<span class="math inline">y_i</span>)</li>
<li>Obliczamy przewidywany wynik używając naszej prostej (<span class="math inline">\hat{y}_i = \hat{\beta}_0 + \hat{\beta}_1x_i</span>)</li>
<li>Różnica między nimi nazywana jest resztą:</li>
</ol>
<p><span class="math inline">\text{reszta}_i = y_i - \hat{y}_i = y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)</span></p>
<p>Zobaczmy wizualizację tych reszt dla jednej prostej:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu i pokazanie reszt</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(wyniki_egzaminu <span class="sc">~</span> godziny_nauki, <span class="at">data =</span> dane)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> godziny_nauki, </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">yend =</span> <span class="fu">predict</span>(model, dane)),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Zrozumienie reszt: Różnice między przewidywaniami a rzeczywistością"</span>) <span class="sc">+</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pomarańczowe pionowe linie pokazują, jak bardzo nasze przewidywania odbiegają od rzeczywistości dla każdego studenta. Niektóre przewidywania są za wysokie (dodatnie reszty), inne za niskie (ujemne reszty).</p>
</section>
<section id="dlaczego-podnosimy-reszty-do-kwadratu" class="level3" data-number="16.8.7">
<h3 data-number="16.8.7" class="anchored" data-anchor-id="dlaczego-podnosimy-reszty-do-kwadratu"><span class="header-section-number">16.8.7</span> Dlaczego podnosimy reszty do kwadratu?</h3>
<p>To kluczowa koncepcja! Przeanalizujmy to na prostym przykładzie:</p>
<p>Wyobraź sobie, że mamy tylko dwoje studentów:</p>
<ol type="1">
<li>Ala: Przewidywane 80, rzeczywisty wynik 85 (reszta = +5)</li>
<li>Bob: Przewidywane 90, rzeczywisty wynik 85 (reszta = -5)</li>
</ol>
<p>Jeśli po prostu dodamy te reszty: <span class="math inline">(+5) + (-5) = 0</span></p>
<p>To sugerowałoby, że nasza prosta jest idealna (całkowity błąd = 0), ale wiemy, że tak nie jest! Oba przewidywania były nietrafne o 5 punktów.</p>
<p>Rozwiązanie: Podnosimy reszty do kwadratu przed dodaniem:</p>
<ul>
<li>Kwadrat reszty Ali: <span class="math inline">(+5)^2 = 25</span></li>
<li>Kwadrat reszty Boba: <span class="math inline">(-5)^2 = 25</span></li>
<li>Całkowity błąd kwadratowy: <span class="math inline">25 + 25 = 50</span></li>
</ul>
<p>To daje nam znacznie lepszą miarę tego, jak bardzo nasze przewidywania są błędne!</p>
</section>
<section id="suma-kwadratów-reszt-sse" class="level3" data-number="16.8.8">
<h3 data-number="16.8.8" class="anchored" data-anchor-id="suma-kwadratów-reszt-sse"><span class="header-section-number">16.8.8</span> Suma kwadratów reszt (SSE)</h3>
<p>Suma kwadratów reszt (SSE - Sum of Squared Errors) jest fundamentalną miarą dopasowania modelu regresji liniowej. Możemy ją wyrazić matematycznie jako:</p>
<p><span class="math display">SSE = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p>
<p>gdzie:</p>
<ul>
<li><span class="math inline">y_i</span> to rzeczywista wartość zmiennej zależnej dla i-tej obserwacji</li>
<li><span class="math inline">\hat{\beta}_0</span> to oszacowany wyraz wolny (punkt przecięcia z osią Y)</li>
<li><span class="math inline">\hat{\beta}_1</span> to oszacowany współczynnik nachylenia prostej</li>
<li><span class="math inline">x_i</span> to wartość zmiennej niezależnej dla i-tej obserwacji</li>
</ul>
<p>Proces obliczania SSE można przedstawić w następujących krokach:</p>
<ol type="1">
<li><p>Dla każdej obserwacji obliczamy różnicę między wartością rzeczywistą (<span class="math inline">y_i</span>) a wartością przewidywaną przez model (<span class="math inline">\hat{\beta}_0 + \hat{\beta}_1x_i</span>). Ta różnica nazywana jest resztą.</p></li>
<li><p>Każdą resztę podnosimy do kwadratu, co powoduje, że:</p>
<ul>
<li>wszystkie wartości stają się dodatnie</li>
<li>większe błędy są silniej “karane” niż małe</li>
<li>jednostki miary są podnoszone do kwadratu</li>
</ul></li>
<li><p>Sumujemy wszystkie kwadraty reszt, otrzymując jedną liczbę reprezentującą całkowity błąd modelu.</p></li>
</ol>
<p><strong>Im mniejsza wartość SSE, tym lepsze dopasowanie modelu do danych empirycznych</strong>.</p>
<p>Wartość SSE = 0 oznaczałaby idealne dopasowanie, gdzie wszystkie punkty leżą dokładnie na prostej regresji. W praktyce tak doskonałe dopasowanie występuje niezwykle rzadko i może sugerować problem przeuczenia modelu.</p>
<p>SSE stanowi podstawę do obliczania innych ważnych miar jakości dopasowania modelu, takich jak współczynnik determinacji R² czy błąd standardowy estymacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie dobrego i złego dopasowania</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>zle_przewidywania <span class="ot">&lt;-</span> <span class="dv">70</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> dane<span class="sc">$</span>godziny_nauki</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>dobre_przewidywania <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, dane)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>zle_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((dane<span class="sc">$</span>wyniki_egzaminu <span class="sc">-</span> zle_przewidywania)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>dobre_sse <span class="ot">&lt;-</span> <span class="fu">sum</span>((dane<span class="sc">$</span>wyniki_egzaminu <span class="sc">-</span> dobre_przewidywania)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> godziny_nauki, <span class="at">y =</span> wyniki_egzaminu)) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">70</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>, </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">95</span>, </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Czerwona prosta: Błąd ="</span>, <span class="fu">round</span>(zle_sse)), </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">90</span>, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Fioletowa prosta: Błąd ="</span>, <span class="fu">round</span>(dobre_sse)), </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Godziny nauki"</span>, <span class="at">y =</span> <span class="st">"Wyniki egzaminu"</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Porównanie całkowitych błędów przewidywania"</span>) <span class="sc">+</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dlaczego-nazywamy-to-metodą-najmniejszych-kwadratów" class="level3" data-number="16.8.9">
<h3 data-number="16.8.9" class="anchored" data-anchor-id="dlaczego-nazywamy-to-metodą-najmniejszych-kwadratów"><span class="header-section-number">16.8.9</span> Dlaczego nazywamy to “Metodą Najmniejszych Kwadratów”?</h3>
<p>Przeanalizujmy nazwę:</p>
<ul>
<li>“Kwadratów”: Podnosimy reszty do kwadratu</li>
<li>“Najmniejszych”: Chcemy najmniejszej możliwej sumy</li>
<li>“Zwykłych” (w angielskim “Ordinary”): To podstawowa wersja (istnieją bardziej zaawansowane warianty!)</li>
</ul>
<p>Prosta MNK ma kilka ciekawych właściwości:</p>
<ol type="1">
<li>Średnia wszystkich reszt równa się zero</li>
<li>Prosta zawsze przechodzi przez punkt (<span class="math inline">\bar{x}</span>, <span class="math inline">\bar{y}</span>) - średnie godziny nauki i średni wynik</li>
<li>Małe zmiany w danych prowadzą do małych zmian w prostej (jest “stabilna”)</li>
<li>Nasze estymaty <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> są najlepszymi możliwymi estymatorami prawdziwych parametrów <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span></li>
</ol>
</section>
<section id="ważne-uwagi" class="level3" data-number="16.8.10">
<h3 data-number="16.8.10" class="anchored" data-anchor-id="ważne-uwagi"><span class="header-section-number">16.8.10</span> Ważne uwagi</h3>
<ol type="1">
<li><p>Oznaczenie z daszkiem (<span class="math inline">\hat{\beta}_0</span>, <span class="math inline">\hat{\beta}_1</span>) przypomina nam, że estymujemy prawdziwą zależność z naszej próby. Nigdy nie znamy prawdziwych <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> - możemy je tylko oszacować z naszych danych.</p></li>
<li><p>MNK daje nam najlepsze możliwe estymaty, gdy spełnione są pewne warunki (jak losowo pobrana próba i rzeczywiście liniowa zależność).</p></li>
</ol>
</section>
</div>
</div>
</section>
</section>
<section id="ocena-dopasowania-modelu" class="level2" data-number="16.9">
<h2 data-number="16.9" class="anchored" data-anchor-id="ocena-dopasowania-modelu"><span class="header-section-number">16.9</span> Ocena Dopasowania Modelu</h2>
<section id="dekompozycja-wariancji" class="level3" data-number="16.9.1">
<h3 data-number="16.9.1" class="anchored" data-anchor-id="dekompozycja-wariancji"><span class="header-section-number">16.9.1</span> Dekompozycja Wariancji</h3>
<p>Całkowita zmienność Y może być rozłożona na komponenty wyjaśnione i niewyjaśnione:</p>
<p><span class="math display">\underbrace{\sum_{i=1}^n (Y_i - \bar{Y})^2}_{SST} = \underbrace{\sum_{i=1}^n (\hat{Y}_i - \bar{Y})^2}_{SSR} + \underbrace{\sum_{i=1}^n (Y_i - \hat{Y}_i)^2}_{SSE}</span></p>
<p>gdzie:</p>
<ul>
<li>SST (Całkowita Suma Kwadratów): Całkowita zmienność Y</li>
<li>SSR (Regresyjna Suma Kwadratów): Zmienność wyjaśniona przez regresję</li>
<li>SSE (Suma Kwadratów Błędów): Zmienność niewyjaśniona</li>
</ul>
</section>
<section id="trzy-komponenty-wariancji" class="level3" data-number="16.9.2">
<h3 data-number="16.9.2" class="anchored" data-anchor-id="trzy-komponenty-wariancji"><span class="header-section-number">16.9.2</span> Trzy Komponenty Wariancji</h3>
<ol type="1">
<li><strong>Wariancja Całkowita (SST - Suma Kwadratów Całkowita)</strong>
<ul>
<li>Pytanie: “Jak bardzo obserwacje różnią się od średniej?”</li>
<li>Wzór: <span class="math inline">SST = \sum(y_i - \bar{y})^2</span></li>
<li>Intuicja: “Rozrzut” naszych danych wokół ich średniej</li>
</ul></li>
<li><strong>Wariancja Wyjaśniona (SSR - Suma Kwadratów Regresji)</strong>
<ul>
<li>Pytanie: “Ile wariancji wyjaśnił nasz model?”</li>
<li>Wzór: <span class="math inline">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li>Intuicja: Poprawa, którą uzyskaliśmy dzięki użyciu X</li>
</ul></li>
<li><strong>Wariancja Niewyjaśniona (SSE - Suma Kwadratów Błędów)</strong>
<ul>
<li>Pytanie: “Jaka wariancja pozostaje niewyjaśniona?”</li>
<li>Wzór: <span class="math inline">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li>Intuicja: Błędy, które pozostają po użyciu X</li>
</ul></li>
</ol>
</section>
<section id="współczynnik-r²---wyjaśnienie" class="level3" data-number="16.9.3">
<h3 data-number="16.9.3" class="anchored" data-anchor-id="współczynnik-r²---wyjaśnienie"><span class="header-section-number">16.9.3</span> Współczynnik R² - Wyjaśnienie</h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span> Współczynnik R² odpowiada na pytanie: “Jaki procent pierwotnej zmienności Y możemy wyjaśnić za pomocą X?”</p>
<section id="intuicyjne-przykłady" class="level4" data-number="16.9.3.1">
<h4 data-number="16.9.3.1" class="anchored" data-anchor-id="intuicyjne-przykłady"><span class="header-section-number">16.9.3.1</span> Intuicyjne Przykłady:</h4>
<ul>
<li>R² = 0,80: Wykorzystanie X wyeliminowało 80% błędów predykcji</li>
<li>R² = 0,25: Wykorzystanie X wyeliminowało 25% błędów predykcji</li>
<li>R² = 0,00: Wykorzystanie X nie przyniosło żadnej poprawy</li>
</ul>
</section>
</section>
<section id="kiedy-zachować-ostrożność" class="level3" data-number="16.9.4">
<h3 data-number="16.9.4" class="anchored" data-anchor-id="kiedy-zachować-ostrożność"><span class="header-section-number">16.9.4</span> Kiedy Zachować Ostrożność</h3>
<ol type="1">
<li><strong>Wysoki R² Nie Jest Wszystkim</strong>
<ul>
<li>Wysoki R² może wskazywać na przeuczenie modelu</li>
<li>Zawsze sprawdzaj, czy model ma sens praktyczny</li>
<li>Weź pod uwagę kontekst swojej dziedziny</li>
</ul></li>
<li><strong>Niski R² Nie Zawsze Jest Zły</strong>
<ul>
<li>W niektórych dziedzinach R² = 0,30 może być imponujący</li>
<li>Nauki społeczne często mają niższe wartości R²</li>
<li>Skup się na znaczeniu praktycznym</li>
</ul></li>
</ol>
</section>
<section id="praktyczne-wskazówki-do-analizy" class="level3" data-number="16.9.5">
<h3 data-number="16.9.5" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy"><span class="header-section-number">16.9.5</span> Praktyczne Wskazówki do Analizy</h3>
<ol type="1">
<li><strong>Inspekcja Wizualna</strong>
<ul>
<li>Zawsze wizualizuj swoje dane</li>
<li>Szukaj wzorców w resztach</li>
<li>Sprawdzaj punkty wpływowe</li>
</ul></li>
<li><strong>Uwzględnienie Kontekstu</strong>
<ul>
<li>Co jest “dobrym” R² w twojej dziedzinie?</li>
<li>Jaki jest praktyczny wpływ twoich błędów?</li>
<li>Czy twoje predyktory są znaczące?</li>
</ul></li>
<li><strong>Diagnostyka Modelu</strong>
<ul>
<li>Sprawdź normalność reszt</li>
<li>Szukaj heteroskedastyczności</li>
<li>Badaj punkty wpływowe</li>
</ul></li>
</ol>
</section>
<section id="kluczowe-wnioski-1" class="level3" data-number="16.9.6">
<h3 data-number="16.9.6" class="anchored" data-anchor-id="kluczowe-wnioski-1"><span class="header-section-number">16.9.6</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Dekompozycja wariancji pomaga zrozumieć poprawę predykcji</li>
<li>R² określa proporcję wyjaśnionej wariancji</li>
<li>Zrozumienie wizualne jest kluczowe dla interpretacji</li>
<li>Kontekst jest ważniejszy niż bezwzględne wartości R²</li>
<li>Zawsze łącz R² z innymi narzędziami diagnostycznymi</li>
</ol>
</section>
<section id="miary-dopasowania" class="level3" data-number="16.9.7">
<h3 data-number="16.9.7" class="anchored" data-anchor-id="miary-dopasowania"><span class="header-section-number">16.9.7</span> Miary Dopasowania</h3>
<ol type="1">
<li><p><strong>R-kwadrat (</strong><span class="math inline">R^2</span>): <span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p></li>
<li><p><strong>Pierwiastek Błędu Średniokwadratowego (RMSE)</strong>: <span class="math display">RMSE = \sqrt{\frac{SSE}{n}}</span></p></li>
<li><p><strong>Średni Błąd Bezwzględny (MAE)</strong>: <span class="math display">MAE = \frac{1}{n}\sum_{i=1}^n |Y_i - \hat{Y}_i|</span></p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dekompozycja Wariancji w Regresji Liniowej
</div>
</div>
<div class="callout-body-container callout-body">
<section id="dlaczego-to-jest-ważne-zrozumienie-poprawy-prognoz-poprzez-dodatkowe-informacje" class="level3" data-number="16.9.8">
<h3 data-number="16.9.8" class="anchored" data-anchor-id="dlaczego-to-jest-ważne-zrozumienie-poprawy-prognoz-poprzez-dodatkowe-informacje"><span class="header-section-number">16.9.8</span> Dlaczego To Jest Ważne: Zrozumienie Poprawy Prognoz Poprzez Dodatkowe Informacje</h3>
<p>Rozważmy prbem zwizany z przewidywaniem cen nieruchomości na rynku mieszkaniowym. Na najbardziej podstawowym poziomie można oszacować cenę dowolnego domu, używając średniej ceny rynkowej. Jednakże takie podejście pomija potencjalnie wartościowe informacje. Gdy uwzględnimy dodatkowe zmienne, takie jak powierzchnia użytkowa, lokalizacja czy liczba sypialni, nasze prognozy zazwyczaj stają się bardziej precyzyjne.</p>
<p><strong>Dekompozycja wariancji</strong> dostarcza matematycznych ram do dokładnego określenia, o ile poprawia się trafność prognoz, gdy włączamy takie dodatkowe informacje.</p>
</section>
<section id="udoskonalenie-estymacji" class="level3" data-number="16.9.9">
<h3 data-number="16.9.9" class="anchored" data-anchor-id="udoskonalenie-estymacji"><span class="header-section-number">16.9.9</span> Udoskonalenie Estymacji</h3>
<section id="podejście-początkowe-uniwersalna-średnia" class="level4" data-number="16.9.9.1">
<h4 data-number="16.9.9.1" class="anchored" data-anchor-id="podejście-początkowe-uniwersalna-średnia"><span class="header-section-number">16.9.9.1</span> Podejście Początkowe: Uniwersalna Średnia</h4>
<p>Zaczynamy od najprostszej możliwej prognozy: średniej wszystkich cen domów (<span class="math inline">\bar{y}</span>). Stanowi to nasz punkt wyjścia – prognozę dokonaną bez żadnych szczególnych informacji o poszczególnych nieruchomościach. Choć podejście to zapewnia rozsądny punkt odniesienia, traktuje każdy dom identycznie, prowadząc do tzw. <strong>błędów bazowych</strong>. Błędy te powstają właśnie dlatego, że ignorujemy unikalne cechy każdej nieruchomości.</p>
</section>
<section id="podejście-zaawansowane-włączenie-informacji-szczegółowych" class="level4" data-number="16.9.9.2">
<h4 data-number="16.9.9.2" class="anchored" data-anchor-id="podejście-zaawansowane-włączenie-informacji-szczegółowych"><span class="header-section-number">16.9.9.2</span> Podejście Zaawansowane: Włączenie Informacji Szczegółowych</h4>
<p>Gdy wprowadzamy charakterystyki specyficzne dla nieruchomości (oznaczone jako <span class="math inline">X</span>), takie jak powierzchnia użytkowa, możemy udoskonalić nasze prognozy. To udoskonalenie pozwala nam różnicować między nieruchomościami, tworząc spersonalizowane prognozy odzwierciedlające indywidualne cechy domów. Wynikające z tego błędy prognoz zazwyczaj maleją, demonstrując wartość włączenia dodatkowych informacji.</p>
</section>
</section>
<section id="zrozumienie-komponentów-wariancji" class="level3" data-number="16.9.10">
<h3 data-number="16.9.10" class="anchored" data-anchor-id="zrozumienie-komponentów-wariancji"><span class="header-section-number">16.9.10</span> Zrozumienie Komponentów Wariancji</h3>
<ol type="1">
<li><strong>Wariancja Całkowita (SST)</strong> Wariancja całkowita określa ogólną zmienność cen domów wokół średniej rynkowej.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SST = \sum(y_i - \bar{y})^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Zobrazowana przez fioletowe pionowe linie na wykresie, pokazujące odległość każdej rzeczywistej ceny domu od średniej ogólnej</li>
<li><strong>Ramy Koncepcyjne:</strong> Można to rozumieć jako pomiar tego, jak bardzo ceny domów różnią się od siebie na rynku</li>
<li><strong>Interpretacja Praktyczna:</strong> Większe SST wskazuje na bardziej zróżnicowany rynek mieszkaniowy z większą zmiennością cen</li>
</ul></li>
<li><strong>Wariancja Wyjaśniona (SSR)</strong> Ten komponent reprezentuje część zmienności cen, którą nasz model skutecznie wychwytuje poprzez uwzględnione zmienne.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SSR = \sum(\hat{y}_i - \bar{y})^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Pokazana przez zielone przerywane linie, reprezentujące jak bardzo prognozy naszego modelu odbiegają od średniej</li>
<li><strong>Ramy Koncepcyjne:</strong> Mierzy to, o ile lepsze stają się nasze prognozy, gdy uwzględniamy szczególne cechy domów</li>
<li><strong>Interpretacja Praktyczna:</strong> Większe SSR w stosunku do SST wskazuje, że wybrane przez nas zmienne (jak powierzchnia użytkowa) silnie wpływają na ceny domów</li>
</ul></li>
<li><strong>Wariancja Niewyjaśniona (SSE)</strong> Reprezentuje pozostałą zmienność cen, której nasz model nie może wyjaśnić przy użyciu uwzględnionych zmiennych.
<ul>
<li><strong>Wyrażenie Matematyczne:</strong> <span class="math inline">SSE = \sum(y_i - \hat{y}_i)^2</span></li>
<li><strong>Reprezentacja Wizualna:</strong> Zobrazowana przez pomarańczowe przerywane linie, pokazujące pozostałe błędy między naszymi prognozami a rzeczywistymi cenami</li>
<li><strong>Ramy Koncepcyjne:</strong> Są to błędy prognoz, które utrzymują się nawet po uwzględnieniu wszystkich wybranych zmiennych</li>
<li><strong>Interpretacja Praktyczna:</strong> Mniejsze SSE sugeruje, że nasz model wychwytuje większość głównych czynników wpływających na cenę</li>
</ul></li>
</ol>
<p>SST = SSR + SSE. Ta zależność mówi nam, że cała zmienność cen musi być albo wyjaśniona przez nasz model (SSR), albo pozostać niewyjaśniona (SSE), dostarczając kompleksowych ram do zrozumienia poprawy prognoz. Kolorowe linie na wykresie stanowią wizualne potwierdzenie tej zależności, pomagając zrozumieć, jak te komponenty współdziałają w praktyce.</p>
<section id="wizualizacja-dekompozycji-wariancji" class="level4" data-number="16.9.10.1">
<h4 data-number="16.9.10.1" class="anchored" data-anchor-id="wizualizacja-dekompozycji-wariancji"><span class="header-section-number">16.9.10.1</span> Wizualizacja Dekompozycji Wariancji</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'patchwork'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    area</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with clearer pattern</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">sd =</span> <span class="fl">0.8</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model and calculations</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, data)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific points for demonstration that are well-spaced</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>demonstration_points <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">25</span>, <span class="dv">42</span>)  <span class="co"># Changed points for better spacing</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create main plot with improved aesthetics</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add background grid for better readability</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">linewidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add regression line and mean line</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> mean_y, <span class="at">linetype =</span> <span class="st">"longdash"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add data points</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"#4A4A4A"</span>) <span class="sc">+</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add decomposition segments with improved colors and positioning</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total deviation (purple)</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> y, <span class="at">yend =</span> mean_y),</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#984EA3"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Explained component (green)</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> mean_y, <span class="at">yend =</span> predicted),</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#4DAF4A"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unexplained component (orange)</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> data[demonstration_points,],</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> predicted, <span class="at">yend =</span> y),</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"#FF7F00"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add annotations for better understanding</span></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], <span class="at">y =</span> mean_y <span class="sc">-</span> <span class="fl">0.2</span>,</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Mean"</span>, <span class="at">color =</span> <span class="st">"#377EB8"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> data<span class="sc">$</span>x[demonstration_points[<span class="dv">2</span>]], </span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> data<span class="sc">$</span>predicted[demonstration_points[<span class="dv">2</span>]] <span class="sc">+</span> <span class="fl">0.2</span>,</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"Regression Line"</span>, <span class="at">color =</span> <span class="st">"#E41A1C"</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Improve theme and labels</span></span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Variance Decomposition in Linear Regression"</span>,</span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Decomposing total variance into explained and unexplained components"</span>,</span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Predictor (X)"</span>,</span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Response (Y)"</span></span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Create error distribution plot with improved aesthetics</span></span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>mean_error <span class="ot">&lt;-</span> y <span class="sc">-</span> mean_y</span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>regression_error <span class="ot">&lt;-</span> y <span class="sc">-</span> data<span class="sc">$</span>predicted</span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_error, <span class="at">fill =</span> <span class="st">"Deviation from Mean"</span>), </span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> regression_error, <span class="at">fill =</span> <span class="st">"Regression Residuals"</span>), </span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Error Distribution Comparison"</span>,</span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Error Magnitude"</span>,</span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#377EB8"</span>, <span class="st">"#E41A1C"</span>)</span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend explaining the decomposition components</span></span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a>legend_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"horizontal"</span></span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Variance Components"</span>,</span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#984EA3"</span>, <span class="st">"#4DAF4A"</span>, <span class="st">"#FF7F00"</span>),</span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Total Deviation"</span>, <span class="st">"Explained Variance"</span>, <span class="st">"Unexplained Variance"</span>)</span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots with adjusted heights</span></span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> (p1 <span class="sc">/</span> p2) <span class="sc">+</span></span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="r²-wyjaśnione" class="level3" data-number="16.9.11">
<h3 data-number="16.9.11" class="anchored" data-anchor-id="r²-wyjaśnione"><span class="header-section-number">16.9.11</span> R² Wyjaśnione</h3>
<p><span class="math display">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<p>Myśl o R² jako o odpowiedzi na pytanie: “Jaki procent pierwotnej wariancji Y możemy wyjaśnić używając X?”</p>
<section id="intuicyjne-przykłady-1" class="level4" data-number="16.9.11.1">
<h4 data-number="16.9.11.1" class="anchored" data-anchor-id="intuicyjne-przykłady-1"><span class="header-section-number">16.9.11.1</span> Intuicyjne Przykłady:</h4>
<ul>
<li>R² = 0,80: Użycie X wyeliminowało 80% naszych błędów predykcji</li>
<li>R² = 0,25: Użycie X wyeliminowało 25% naszych błędów predykcji</li>
<li>R² = 0,00: Użycie X wcale nie pomogło</li>
</ul>
</section>
</section>
<section id="kiedy-zachować-ostrożność-1" class="level3" data-number="16.9.12">
<h3 data-number="16.9.12" class="anchored" data-anchor-id="kiedy-zachować-ostrożność-1"><span class="header-section-number">16.9.12</span> Kiedy Zachować Ostrożność</h3>
<ol type="1">
<li><strong>Wysoki R² To Nie Wszystko</strong>
<ul>
<li>Wysoki R² może wskazywać na przeuczenie</li>
<li>Zawsze sprawdzaj, czy twój model ma praktyczny sens</li>
<li>Weź pod uwagę kontekst swojej dziedziny</li>
</ul></li>
<li><strong>Niski R² Nie Zawsze Jest Zły</strong>
<ul>
<li>W niektórych dziedzinach R² = 0,30 może być imponujący</li>
<li>Nauki społeczne często mają niższe wartości R²</li>
<li>Skup się na znaczeniu praktycznym</li>
</ul></li>
<li><strong>Wielkość Próby Ma Znaczenie</strong>
<ul>
<li>Używaj skorygowanego R² dla regresji wielorakiej: <span class="math inline">R^2_{adj} = 1 - \frac{SSE/(n-p)}{SST/(n-1)}</span></li>
<li>Penalizuje dodawanie niepotrzebnych predyktorów</li>
</ul></li>
</ol>
</section>
<section id="praktyczne-wskazówki-do-analizy-1" class="level3" data-number="16.9.13">
<h3 data-number="16.9.13" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy-1"><span class="header-section-number">16.9.13</span> Praktyczne Wskazówki do Analizy</h3>
<ol type="1">
<li><strong>Inspekcja Wizualna</strong>
<ul>
<li>Zawsze wizualizuj swoje dane</li>
<li>Szukaj wzorców w resztach</li>
<li>Sprawdzaj punkty wpływowe</li>
</ul></li>
<li><strong>Uwzględnienie Kontekstu</strong>
<ul>
<li>Co jest “dobrym” R² w twojej dziedzinie?</li>
<li>Jaki jest praktyczny wpływ twoich błędów?</li>
<li>Czy twoje predyktory są znaczące?</li>
</ul></li>
<li><strong>Diagnostyka Modelu</strong>
<ul>
<li>Sprawdź normalność reszt</li>
<li>Szukaj heteroskedastyczności</li>
<li>Badaj punkty wpływowe</li>
</ul></li>
</ol>
</section>
<section id="kluczowe-wnioski-2" class="level3" data-number="16.9.14">
<h3 data-number="16.9.14" class="anchored" data-anchor-id="kluczowe-wnioski-2"><span class="header-section-number">16.9.14</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Dekompozycja wariancji pomaga zrozumieć poprawę predykcji</li>
<li>R² określa ilościowo proporcję wyjaśnionej wariancji</li>
<li>Zrozumienie wizualne jest kluczowe dla interpretacji</li>
<li>Kontekst jest ważniejszy niż bezwzględne wartości R²</li>
<li>Zawsze łącz R² z innymi narzędziami diagnostycznymi</li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Formalne wyprowadzenie estymatorów MNK
</div>
</div>
<div class="callout-body-container callout-body">
<section id="założenia-wstępne" class="level3" data-number="16.9.15">
<h3 data-number="16.9.15" class="anchored" data-anchor-id="założenia-wstępne"><span class="header-section-number">16.9.15</span> Założenia wstępne</h3>
<p>Chcemy znaleźć prostą <span class="math inline">y = \hat{\beta}_0 + \hat{\beta}_1x</span>, która minimalizuje sumę kwadratów reszt. Wyprowadźmy to krok po kroku:</p>
<ol type="1">
<li><p>Najpierw zapisujemy funkcję, którą chcemy zminimalizować:</p>
<p><span class="math inline">SSE = \sum_{i=1}^n (y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i))^2</span></p></li>
<li><p>Aby znaleźć minimum, musimy obliczyć pochodne cząstkowe względem <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> oraz przyrównać je do zera:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = 0</span> oraz <span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = 0</span></p></li>
</ol>
</section>
<section id="krok-1-znalezienie-hatbeta_0" class="level3" data-number="16.9.16">
<h3 data-number="16.9.16" class="anchored" data-anchor-id="krok-1-znalezienie-hatbeta_0"><span class="header-section-number">16.9.16</span> Krok 1: Znalezienie <span class="math inline">\hat{\beta}_0</span></h3>
<p>Obliczmy pochodną cząstkową względem <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = \frac{\partial}{\partial \hat{\beta}_0} \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)^2</span></p>
<p>Korzystając z reguły łańcuchowej:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_0} = \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)(-1) = 0</span></p>
<p>Upraszczając:</p>
<p><span class="math inline">-2\sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p>
<p><span class="math inline">\sum_{i=1}^n y_i - n\hat{\beta}_0 - \hat{\beta}_1\sum_{i=1}^n x_i = 0</span></p>
<p>Rozwiązując względem <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">\hat{\beta}_0 = \frac{\sum_{i=1}^n y_i}{n} - \hat{\beta}_1\frac{\sum_{i=1}^n x_i}{n} = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Gdzie <span class="math inline">\bar{y}</span> i <span class="math inline">\bar{x}</span> to średnie z próby.</p>
</section>
<section id="krok-2-znalezienie-hatbeta_1" class="level3" data-number="16.9.17">
<h3 data-number="16.9.17" class="anchored" data-anchor-id="krok-2-znalezienie-hatbeta_1"><span class="header-section-number">16.9.17</span> Krok 2: Znalezienie <span class="math inline">\hat{\beta}_1</span></h3>
<p>Teraz obliczamy pochodną cząstkową względem <span class="math inline">\hat{\beta}_1</span>:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = \frac{\partial}{\partial \hat{\beta}_1} \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)^2</span></p>
<p>Korzystając z reguły łańcuchowej:</p>
<p><span class="math inline">\frac{\partial SSE}{\partial \hat{\beta}_1} = \sum_{i=1}^n 2(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i)(-x_i) = 0</span></p>
<p>Upraszczając:</p>
<p><span class="math inline">-2\sum_{i=1}^n x_i(y_i - \hat{\beta}_0 - \hat{\beta}_1x_i) = 0</span></p>
<p>Podstawiając nasze wyrażenie na <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math inline">-2\sum_{i=1}^n x_i(y_i - (\bar{y} - \hat{\beta}_1\bar{x}) - \hat{\beta}_1x_i) = 0</span></p>
<p><span class="math inline">\sum_{i=1}^n x_i(y_i - \bar{y} + \hat{\beta}_1\bar{x} - \hat{\beta}_1x_i) = 0</span></p>
<p>Po przekształceniach algebraicznych (rozwinięciu i zgrupowaniu wyrazów):</p>
<p><span class="math inline">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}</span></p>
</section>
<section id="wyniki-końcowe" class="level3" data-number="16.9.18">
<h3 data-number="16.9.18" class="anchored" data-anchor-id="wyniki-końcowe"><span class="header-section-number">16.9.18</span> Wyniki końcowe</h3>
<p>Wyprowadziliśmy estymatory MNK:</p>
<p><span class="math inline">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}</span></p>
<p><span class="math inline">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Zrozummy, co oznaczają te wzory:</p>
<ol type="1">
<li><p>Estymator nachylenia <span class="math inline">\hat{\beta}_1</span>:</p>
<ul>
<li>Licznik: Mierzy, jak <span class="math inline">x</span> i <span class="math inline">y</span> zmieniają się razem (kowariancja)</li>
<li>Mianownik: Mierzy, jak bardzo zmienia się <span class="math inline">x</span> (wariancja)</li>
<li>Więc <span class="math inline">\hat{\beta}_1</span> jest zasadniczo stosunkiem kowariancji do wariancji</li>
</ul></li>
<li><p>Estymator wyrazu wolnego <span class="math inline">\hat{\beta}_0</span>:</p>
<ul>
<li>Zapewnia, że prosta przechodzi przez punkt <span class="math inline">(\bar{x}, \bar{y})</span></li>
<li>Dostosowuje wysokość prostej na podstawie nachylenia</li>
</ul></li>
</ol>
</section>
<section id="weryfikacja-drugie-pochodne" class="level3" data-number="16.9.19">
<h3 data-number="16.9.19" class="anchored" data-anchor-id="weryfikacja-drugie-pochodne"><span class="header-section-number">16.9.19</span> Weryfikacja: Drugie pochodne</h3>
<p>Aby potwierdzić, że znaleźliśmy minimum (a nie maksimum), sprawdzamy drugie pochodne:</p>
<p><span class="math inline">\frac{\partial^2 SSE}{\partial \hat{\beta}_0^2} = 2n &gt; 0</span></p>
<p><span class="math inline">\frac{\partial^2 SSE}{\partial \hat{\beta}_1^2} = 2\sum_{i=1}^n x_i^2 &gt; 0</span></p>
<p>Ponieważ obie drugie pochodne są dodatnie, rzeczywiście znaleźliśmy minimum.</p>
</section>
<section id="postać-macierzowa-temat-zaawansowany-opcjonalny" class="level3" data-number="16.9.20">
<h3 data-number="16.9.20" class="anchored" data-anchor-id="postać-macierzowa-temat-zaawansowany-opcjonalny"><span class="header-section-number">16.9.20</span> Postać macierzowa (Temat zaawansowany, opcjonalny)</h3>
<p>Dla osób znających algebrę liniową, możemy zapisać to zwięźlej:</p>
<p><span class="math inline">\mathbf{X} = \begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ \vdots &amp; \vdots \\ 1 &amp; x_n \end{bmatrix}</span></p>
<p><span class="math inline">\mathbf{y} = \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix}</span></p>
<p>Wtedy estymator MNK w postaci macierzowej to:</p>
<p><span class="math inline">\hat{\boldsymbol{\beta}} = (\mathbf{X}'\mathbf{X})^{-1}\mathbf{X}'\mathbf{y}</span></p>
<p>To daje nam zarówno <span class="math inline">\hat{\beta}_0</span> jak i <span class="math inline">\hat{\beta}_1</span> w jednym eleganckim wyrażeniu.</p>
</section>
<section id="wizualizacja-wyprowadzenia" class="level3" data-number="16.9.21">
<h3 data-number="16.9.21" class="anchored" data-anchor-id="wizualizacja-wyprowadzenia"><span class="header-section-number">16.9.21</span> Wizualizacja wyprowadzenia</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie przykładowych danych</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie średnich</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>x_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>y_srednia <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wizualizacji odchyleń</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dane, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> y_srednia, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x_srednia, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> y_srednia), <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">yend =</span> y, <span class="at">xend =</span> x_srednia), <span class="at">color =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wizualizacja odchyleń od średnich"</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Zielone: Odchylenia w y, Fioletowe: Odchylenia w x"</span>,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Powyższy wykres pokazuje, jak działają estymatory MNK z odchyleniami od średnich. Iloczyn tych odchyleń (zielone × fioletowe) dla każdego punktu, zsumowany i znormalizowany, daje nam nasz estymator nachylenia <span class="math inline">\hat{\beta}_1</span>.</p>
</section>
<section id="ważne-uwagi-1" class="level3" data-number="16.9.22">
<h3 data-number="16.9.22" class="anchored" data-anchor-id="ważne-uwagi-1"><span class="header-section-number">16.9.22</span> Ważne uwagi</h3>
<ol type="1">
<li><p>Wyprowadzone estymatory są BLUE (Best Linear Unbiased Estimators - Najlepsze Liniowe Nieobciążone Estymatory) przy spełnieniu założeń Gaussa-Markowa.</p></li>
<li><p>Założenia te obejmują:</p>
<ul>
<li>Liniowość zależności</li>
<li>Losowość próby</li>
<li>Brak współliniowości idealnej</li>
<li>Homoskedastyczność (stała wariancja reszt)</li>
<li>Niezależność obserwacji</li>
</ul></li>
<li><p>Metoda ta minimalizuje sumę kwadratów reszt w kierunku pionowym (odchylenia w <span class="math inline">y</span>), a nie prostopadłym do prostej.</p></li>
</ol>
</section>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Endogeniczność w Regresji
</div>
</div>
<div class="callout-body-container callout-body">
<p>Endogeniczność to kluczowe pojęcie w analizie statystycznej, występujące gdy zmienna objaśniająca w modelu regresji jest skorelowana ze składnikiem resztowym. Stwarza to wyzwania w dokładnym zrozumieniu związków przyczynowo-skutkowych w badaniach. Przyjrzyjmy się trzem głównym typom endogeniczności i ich wpływowi na wyniki badań.</p>
<section id="obciążenie-zmiennej-pominiętej-ovb" class="level3" data-number="16.9.23">
<h3 data-number="16.9.23" class="anchored" data-anchor-id="obciążenie-zmiennej-pominiętej-ovb"><span class="header-section-number">16.9.23</span> 1. Obciążenie Zmiennej Pominiętej (OVB)</h3>
<p>Obciążenie zmiennej pominiętej występuje, gdy ważna zmienna wpływająca zarówno na zmienną zależną, jak i niezależną, zostaje pominięta w analizie. To pominięcie prowadzi do błędnych wniosków o relacji między badanymi zmiennymi.</p>
<p>Rozważmy badanie związku między wykształceniem a dochodami:</p>
<p><strong>Przykład: Wykształcenie i Dochody</strong> Obserwowana relacja pokazuje, że wyższe wykształcenie koreluje z wyższymi dochodami. Jednak naturalne zdolności jednostki wpływają zarówno na poziom wykształcenia, jak i na potencjał zarobkowy. Bez uwzględnienia zdolności możemy przeszacować bezpośredni wpływ edukacji na dochody.</p>
<p>Reprezentacja statystyczna pokazuje, dlaczego to jest istotne:</p>
<p><span class="math inline">y_i = \beta_0 + \beta_1x_i + \beta_2z_i + \epsilon_i</span> (Model pełny)</p>
<p><span class="math inline">y_i = \beta_0 + \beta_1x_i + u_i</span> (Model niepełny)</p>
<p>Gdy pomijamy istotną zmienną, nasze oszacowania pozostałych relacji stają się obciążone i niewiarygodne.</p>
</section>
<section id="jednoczesność" class="level3" data-number="16.9.24">
<h3 data-number="16.9.24" class="anchored" data-anchor-id="jednoczesność"><span class="header-section-number">16.9.24</span> 2. Jednoczesność</h3>
<p>Jednoczesność występuje, gdy dwie zmienne wzajemnie na siebie wpływają, co utrudnia określenie kierunku przyczynowości. Tworzy to pętlę sprzężenia zwrotnego komplikującą analizę statystyczną.</p>
<p><strong>Typowe Przykłady Jednoczesności:</strong></p>
<p>Wyniki w nauce i nawyki uczenia się stanowią wyraźny przypadek jednoczesności. Wyniki akademickie wpływają na ilość czasu, który studenci poświęcają na naukę, podczas gdy czas nauki wpływa na wyniki akademickie. Ta dwukierunkowa relacja utrudnia pomiar izolowanego wpływu każdej zmiennej.</p>
<p>Dynamika rynkowa dostarcza kolejnego przykładu. Ceny wpływają na popyt, podczas gdy popyt wpływa na ceny. Ta równoczesna relacja wymaga specjalnych podejść analitycznych.</p>
</section>
<section id="błąd-pomiaru" class="level3" data-number="16.9.25">
<h3 data-number="16.9.25" class="anchored" data-anchor-id="błąd-pomiaru"><span class="header-section-number">16.9.25</span> 3. Błąd Pomiaru</h3>
<p>Błąd pomiaru występuje, gdy nie możemy dokładnie zmierzyć naszych zmiennych. Ta niedokładność może znacząco wpłynąć na naszą analizę i wnioski.</p>
<p><strong>Typowe Źródła Błędu Pomiaru:</strong></p>
<p>Dane samodzielnie raportowane stanowią znaczące wyzwanie. Gdy uczestnicy raportują własne zachowania lub cechy, na przykład czas nauki, zgłaszane wartości często różnią się od rzeczywistych. Ta rozbieżność wpływa na naszą zdolność do pomiaru prawdziwych relacji.</p>
<p>Ograniczenia techniczne również przyczyniają się do błędu pomiaru poprzez niedokładne narzędzia pomiarowe, niespójne warunki pomiaru oraz błędy zapisu lub wprowadzania danych.</p>
</section>
<section id="rozwiązywanie-problemu-endogeniczności-w-badaniach" class="level3" data-number="16.9.26">
<h3 data-number="16.9.26" class="anchored" data-anchor-id="rozwiązywanie-problemu-endogeniczności-w-badaniach"><span class="header-section-number">16.9.26</span> Rozwiązywanie Problemu Endogeniczności w Badaniach</h3>
<section id="strategie-identyfikacji" class="level4" data-number="16.9.26.1">
<h4 data-number="16.9.26.1" class="anchored" data-anchor-id="strategie-identyfikacji"><span class="header-section-number">16.9.26.1</span> Strategie Identyfikacji</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykład kontrolowania zmiennych pominiętych</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>model_prosty <span class="ot">&lt;-</span> <span class="fu">lm</span>(dochod <span class="sc">~</span> wyksztalcenie, <span class="at">data =</span> df)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>model_pelny <span class="ot">&lt;-</span> <span class="fu">lm</span>(dochod <span class="sc">~</span> wyksztalcenie <span class="sc">+</span> zdolnosci <span class="sc">+</span> doswiadczenie <span class="sc">+</span> region, <span class="at">data =</span> df)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie współczynników</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_prosty)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_pelny)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><p>Włączenie Dodatkowych Zmiennych: Zbieranie danych o potencjalnie ważnych pominiętych zmiennych i uwzględnianie odpowiednich zmiennych kontrolnych w analizie. Na przykład, uwzględnienie miar zdolności przy badaniu wpływu edukacji na dochody.</p></li>
<li><p>Wykorzystanie Danych Panelowych: Zbieranie danych w wielu okresach czasu w celu kontrolowania nieobserwowanych stałych charakterystyk i analizy zmian w czasie.</p></li>
<li><p>Zmienne Instrumentalne: Znalezienie zmiennych, które wpływają na zmienną niezależną, ale nie na zależną, aby wyizolować badaną relację.</p></li>
</ol>
</section>
<section id="poprawa-pomiaru" class="level4" data-number="16.9.26.2">
<h4 data-number="16.9.26.2" class="anchored" data-anchor-id="poprawa-pomiaru"><span class="header-section-number">16.9.26.2</span> Poprawa Pomiaru</h4>
<ol type="1">
<li><p>Wielokrotne Pomiary: Wykonywanie kilku pomiarów kluczowych zmiennych, używanie uśredniania do redukcji błędu losowego i porównywanie różnych metod pomiaru.</p></li>
<li><p>Lepsza Metoda Zbierania Danych: Używanie zwalidowanych instrumentów pomiarowych, wdrażanie procedur kontroli jakości i dokumentowanie potencjalnych źródeł błędu.</p></li>
</ol>
</section>
</section>
<section id="najlepsze-praktyki-dla-badaczy" class="level3" data-number="16.9.27">
<h3 data-number="16.9.27" class="anchored" data-anchor-id="najlepsze-praktyki-dla-badaczy"><span class="header-section-number">16.9.27</span> Najlepsze Praktyki dla Badaczy</h3>
<p>Projekt badania fundamentalnie kształtuje możliwość rozwiązania problemu endogeniczności. Należy planować potencjalne problemy endogeniczności przed zbieraniem danych, uwzględniać miary potencjalnie ważnych zmiennych kontrolnych i rozważać wykorzystanie wielu podejść pomiarowych.</p>
<p>Analiza powinna obejmować testowanie endogeniczności gdy to możliwe, stosowanie odpowiednich metod statystycznych dla konkretnej sytuacji i dokumentowanie założeń oraz ograniczeń.</p>
<p>Raportowanie musi jasno opisywać potencjalne problemy endogeniczności, wyjaśniać jak zostały one rozwiązane i omawiać implikacje dla wniosków.</p>
</section>
</div>
</div>
</section>
</section>
<section id="regresja-wieloraka" class="level2" data-number="16.10">
<h2 data-number="16.10" class="anchored" data-anchor-id="regresja-wieloraka"><span class="header-section-number">16.10</span> Regresja Wieloraka (*)</h2>
<section id="rozszerzenie-do-wielu-predyktorów" class="level3" data-number="16.10.1">
<h3 data-number="16.10.1" class="anchored" data-anchor-id="rozszerzenie-do-wielu-predyktorów"><span class="header-section-number">16.10.1</span> Rozszerzenie do Wielu Predyktorów</h3>
<p>Model regresji wielorakiej rozszerza nasz prosty model o kilka predyktorów:</p>
<p>Model Populacyjny: <span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + ... + \beta_kX_k + \varepsilon</span></p>
<p>Oszacowanie Próbkowe: <span class="math display">\hat{Y} = \hat{\beta}_0 + \hat{\beta}_1X_1 + \hat{\beta}_2X_2 + ... + \hat{\beta}_kX_k</span></p>
<p>Stwórzmy przykład z wieloma predyktorami:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data with two predictors</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">105</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>data_multiple <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit multiple regression model</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>model_multiple <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_multiple)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 3D visualization using scatter plots</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X1"</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Y vs X2"</span>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/multiple-regression-example-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Regresji Wielorakiej</figcaption>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_multiple)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X1 + X2, data = data_multiple)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.8598  -3.6005   0.1166   3.0892  14.6102 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.77567    4.01351   2.934  0.00418 ** 
X1           0.45849    0.05992   7.651 1.47e-11 ***
X2           0.81639    0.11370   7.180 1.42e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.122 on 97 degrees of freedom
Multiple R-squared:  0.5062,    Adjusted R-squared:  0.4961 
F-statistic: 49.72 on 2 and 97 DF,  p-value: 1.367e-15</code></pre>
</div>
</div>
</section>
<section id="interpretacja-współczynników" class="level3" data-number="16.10.2">
<h3 data-number="16.10.2" class="anchored" data-anchor-id="interpretacja-współczynników"><span class="header-section-number">16.10.2</span> Interpretacja Współczynników</h3>
<p>W regresji wielorakiej, każdy <span class="math inline">\hat{\beta}_k</span> reprezentuje oczekiwaną zmianę w Y przy jednostkowym wzroście <span class="math inline">X_k</span>, przy utrzymaniu wszystkich innych zmiennych na stałym poziomie.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X1 (holding X2 at its mean)</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>X1_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X1), <span class="fu">max</span>(X1), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>pred_data_X1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_grid,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">mean</span>(X2)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>pred_data_X1<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X1)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create prediction grid for X2 (holding X1 at its mean)</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>X2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2), <span class="fu">max</span>(X2), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>pred_data_X2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> <span class="fu">mean</span>(X1),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_grid</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>pred_data_X2<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_multiple, <span class="at">newdata =</span> pred_data_X2)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot partial effects</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X1, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> Y_pred), </span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Cząstkowy X1"</span>,</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X2 utrzymane na średniej ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X2), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_multiple, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> pred_data_X2, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred), </span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Cząstkowy X2"</span>,</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"(X1 utrzymane na średniej ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(X1), <span class="dv">2</span>), <span class="st">")"</span>))</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/coefficient-interpretation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efekty Cząstkowe w Regresji Wielorakiej</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="współliniowość" class="level3" data-number="16.10.3">
<h3 data-number="16.10.3" class="anchored" data-anchor-id="współliniowość"><span class="header-section-number">16.10.3</span> Współliniowość</h3>
<p>Współliniowość występuje, gdy predyktory są silnie skorelowane. Zobaczmy jej efekty:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with multicollinearity</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">106</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>X1_new <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>X2_new <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)  <span class="co"># X2 silnie skorelowane z X1</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>Y_new <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>X1_new <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>X2_new <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>data_collinear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y =</span> Y_new, <span class="at">X1 =</span> X1_new, <span class="at">X2 =</span> X2_new)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with multicollinearity</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>model_collinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> data_collinear)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate VIF</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>vif_results <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_collinear)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot correlation</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_collinear, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2)) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Korelacja między Predyktorami"</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Korelacja ="</span>, </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">round</span>(<span class="fu">cor</span>(X1_new, X2_new), <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/multicollinearity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Efekty Współliniowości</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="tematy-zaawansowane" class="level2" data-number="16.11">
<h2 data-number="16.11" class="anchored" data-anchor-id="tematy-zaawansowane"><span class="header-section-number">16.11</span> Tematy Zaawansowane</h2>
<section id="efekty-interakcji" class="level3" data-number="16.11.1">
<h3 data-number="16.11.1" class="anchored" data-anchor-id="efekty-interakcji"><span class="header-section-number">16.11.1</span> Efekty Interakcji</h3>
<p>Efekty interakcji pozwalają na to, by wpływ jednego predyktora zależał od innego:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \beta_3(X_1 \times X_2) + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with interaction</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">107</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>X1_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>X2_int <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>Y_int <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X1_int <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X2_int <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>X1_int<span class="sc">*</span>X2_int <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>data_int <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X1 =</span> X1_int, <span class="at">X2 =</span> X2_int, <span class="at">Y =</span> Y_int)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>model_int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">*</span> X2, <span class="at">data =</span> data_int)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create interaction plot</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>X1_levels <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X1_int, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>X2_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(X2_int), <span class="fu">max</span>(X2_int), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">X1 =</span> X1_levels,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">X2 =</span> X2_seq</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>Y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_int, <span class="at">newdata =</span> pred_data)</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>pred_data<span class="sc">$</span>X1_level <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_data<span class="sc">$</span>X1, </span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Niskie X1"</span>, <span class="st">"Wysokie X1"</span>))</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> X2, <span class="at">y =</span> Y_pred, <span class="at">color =</span> X1_level)) <span class="sc">+</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Efekt Interakcji"</span>,</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Wpływ X2 zależy od poziomu X1"</span>,</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Poziom X1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/interactions-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wizualizacja Efektów Interakcji</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="wyrazy-wielomianowe" class="level3" data-number="16.11.2">
<h3 data-number="16.11.2" class="anchored" data-anchor-id="wyrazy-wielomianowe"><span class="header-section-number">16.11.2</span> Wyrazy Wielomianowe</h3>
<p>Gdy zależności są nieliniowe, możemy dodać wyrazy wielomianowe:</p>
<p><span class="math display">Y = \beta_0 + \beta_1X + \beta_2X^2 + \varepsilon</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data with quadratic relationship</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">108</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>X_poly <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>Y_poly <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>X_poly <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X_poly<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(X_poly), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>data_poly <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X_poly, <span class="at">Y =</span> Y_poly)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit linear and quadratic models</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> data_poly)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>model_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> data_poly)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add predictions</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_linear <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_linear)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>data_poly<span class="sc">$</span>pred_quad <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_quad)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_poly, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_linear, <span class="at">color =</span> <span class="st">"Liniowy"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred_quad, <span class="at">color =</span> <span class="st">"Kwadratowy"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dopasowanie Liniowe vs Kwadratowe"</span>,</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Typ Modelu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/polynomial-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Regresji Wielomianowej</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="praktyczne-wskazówki-do-analizy-regresji" class="level2" data-number="16.12">
<h2 data-number="16.12" class="anchored" data-anchor-id="praktyczne-wskazówki-do-analizy-regresji"><span class="header-section-number">16.12</span> Praktyczne Wskazówki do Analizy Regresji</h2>
<section id="proces-budowy-modelu" class="level3" data-number="16.12.1">
<h3 data-number="16.12.1" class="anchored" data-anchor-id="proces-budowy-modelu"><span class="header-section-number">16.12.1</span> Proces Budowy Modelu</h3>
<ol type="1">
<li><strong>Eksploracja Danych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example dataset</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>data_example <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x3 =</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>data_example<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>data_example<span class="sc">$</span>x1 <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span>data_example<span class="sc">$</span>x2 <span class="sc">-</span> </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fl">0.3</span><span class="sc">*</span>data_example<span class="sc">$</span>x3 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix plot</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(data_example) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Analiza Eksploracyjna Danych"</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Macierz korelacji i rozkłady"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/data-exploration-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Eksploracji Danych</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Wybór Zmiennych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models with different variables</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> data_example)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> data_example)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare models</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"y ~ x1"</span>, <span class="st">"y ~ x1 + x2"</span>, <span class="st">"y ~ x1 + x2 + x3"</span>),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>r.squared,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model2)<span class="sc">$</span>r.squared,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">summary</span>(model3)<span class="sc">$</span>r.squared),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Skorygowany_R_kwadrat =</span> <span class="fu">c</span>(<span class="fu">summary</span>(model1)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model2)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">summary</span>(model3)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(models_comparison, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Podsumowanie Porównania Modeli"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Podsumowanie Porównania Modeli</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">R_kwadrat</th>
<th style="text-align: right;">Skorygowany_R_kwadrat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">y ~ x1</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.316</td>
</tr>
<tr class="even">
<td style="text-align: left;">y ~ x1 + x2</td>
<td style="text-align: right;">0.433</td>
<td style="text-align: right;">0.421</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y ~ x1 + x2 + x3</td>
<td style="text-align: right;">0.893</td>
<td style="text-align: right;">0.890</td>
</tr>
</tbody>
</table>
<p>Proces Wyboru Zmiennych</p>
</div>
</div>
</section>
<section id="typowe-pułapki-i-rozwiązania" class="level3" data-number="16.12.2">
<h3 data-number="16.12.2" class="anchored" data-anchor-id="typowe-pułapki-i-rozwiązania"><span class="header-section-number">16.12.2</span> Typowe Pułapki i Rozwiązania</h3>
<ol type="1">
<li><strong>Wartości Odstające i Punkty Wpływowe</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with outlier</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">110</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>x_clean <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>y_clean <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x_clean <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_clean, <span class="at">y =</span> y_clean)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add outlier</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>data_outlier <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data_clean,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">10</span>))</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>model_clean <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_clean)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>model_outlier <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_outlier)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_clean, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data_outlier[<span class="dv">51</span>,], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_clean, </span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_clean), </span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Bez Wartości Odstającej"</span>)) <span class="sc">+</span></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> data_outlier, </span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">predict</span>(model_outlier), </span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"Z Wartością Odstającą"</span>)) <span class="sc">+</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wpływ Wartości Odstających na Regresję"</span>,</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/outliers-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Identyfikacja i Obsługa Wartości Odstających</figcaption>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Wzorce Brakujących Danych</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data with missing values</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>data_missing <span class="ot">&lt;-</span> data_example</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x1[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x2[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">15</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>data_missing<span class="sc">$</span>x3[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">20</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize missing patterns</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(data_missing) <span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wzorce Brakujących Danych"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/missing-data-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wzorce Brakujących Danych</figcaption>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li><strong>Heteroskedastyczność</strong></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate heteroscedastic data</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">112</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>x_hetero <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>y_hetero <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span>x_hetero <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fu">abs</span>(x_hetero)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>data_hetero <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_hetero, <span class="at">y =</span> y_hetero)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>model_hetero <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_hetero)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dane Heteroskedastyczne"</span>)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_hetero, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fitted</span>(model_hetero), </span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="fu">residuals</span>(model_hetero))) <span class="sc">+</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Wykres Reszt"</span>,</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Wartości dopasowane"</span>,</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Reszty"</span>)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/heteroscedasticity-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Wykrywanie i Wizualizacja Heteroskedastyczności</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="najlepsze-praktyki" class="level2" data-number="16.13">
<h2 data-number="16.13" class="anchored" data-anchor-id="najlepsze-praktyki"><span class="header-section-number">16.13</span> Najlepsze Praktyki</h2>
<section id="walidacja-modelu" class="level3" data-number="16.13.1">
<h3 data-number="16.13.1" class="anchored" data-anchor-id="walidacja-modelu"><span class="header-section-number">16.13.1</span> Walidacja Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple cross-validation example</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">113</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create training and test sets</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data_example), <span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(data_example))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_example[train_index, ]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_example[<span class="sc">-</span>train_index, ]</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model on training data</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>model_train <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> train_data)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_train, <span class="at">newdata =</span> test_data)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> test_data<span class="sc">$</span>y</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate performance metrics</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> actual)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> actual))</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(predictions, actual)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot predictions vs actual</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>data_validation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> predictions,</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> actual</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_validation, <span class="fu">aes</span>(<span class="at">x =</span> Rzeczywiste, <span class="at">y =</span> Przewidywane)) <span class="sc">+</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Walidacja Modelu: Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">"RMSE = %.2f, MAE = %.2f, R² = %.2f"</span>, </span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>                         rmse, mae, r2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correg_pl_files/figure-html/model-validation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Przykład Walidacji Krzyżowej</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="prezentacja-wyników" class="level3" data-number="16.13.2">
<h3 data-number="16.13.2" class="anchored" data-anchor-id="prezentacja-wyników"><span class="header-section-number">16.13.2</span> Prezentacja Wyników</h3>
<p>Przykład profesjonalnej tabeli wyników regresji:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create regression results table</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>model_final <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3, <span class="at">data =</span> data_example)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model_final, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(results, <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Podsumowanie Wyników Regresji"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Podsumowanie Wyników Regresji</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">term</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p.value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.low</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">9.116</td>
<td style="text-align: right;">2.835</td>
<td style="text-align: right;">3.216</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">3.489</td>
<td style="text-align: right;">14.743</td>
</tr>
<tr class="even">
<td style="text-align: left;">x1</td>
<td style="text-align: right;">0.497</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: right;">12.756</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.574</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x2</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">10.468</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.734</td>
<td style="text-align: right;">1.077</td>
</tr>
<tr class="even">
<td style="text-align: left;">x3</td>
<td style="text-align: right;">-0.324</td>
<td style="text-align: right;">0.016</td>
<td style="text-align: right;">-20.322</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.356</td>
<td style="text-align: right;">-0.292</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="podsumowanie" class="level2" data-number="16.14">
<h2 data-number="16.14" class="anchored" data-anchor-id="podsumowanie"><span class="header-section-number">16.14</span> Podsumowanie</h2>
<section id="kluczowe-wnioski-3" class="level3" data-number="16.14.1">
<h3 data-number="16.14.1" class="anchored" data-anchor-id="kluczowe-wnioski-3"><span class="header-section-number">16.14.1</span> Kluczowe Wnioski</h3>
<ol type="1">
<li>Zawsze zaczynaj od eksploracyjnej analizy danych</li>
<li>Sprawdzaj założenia przed interpretacją wyników</li>
<li>Bądź świadomy typowych pułapek:
<ul>
<li>Wartości odstające</li>
<li>Brakujące dane</li>
<li>Współliniowość</li>
<li>Heteroskedastyczność</li>
</ul></li>
<li>Waliduj swój model używając:
<ul>
<li>Wykresów diagnostycznych</li>
<li>Walidacji krzyżowej</li>
<li>Analizy reszt</li>
</ul></li>
<li>Prezentuj wyniki jasno i kompletnie</li>
</ol>
</section>
<section id="literatura-uzupełniająca" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="literatura-uzupełniająca">Literatura Uzupełniająca</h3>
<p>Dla głębszego zrozumienia:</p>
<ul>
<li>Wooldridge, J.M. “Wprowadzenie do Ekonometrii: Współczesne Ujęcie”</li>
<li>Fox, J. “Analiza Regresji Stosowana i Uogólnione Modele Liniowe”</li>
<li>Angrist, J.D. i Pischke, J.S. “W Większości Nieszkodliwa Ekonometria”</li>
<li>Stock &amp; Watson “Wprowadzenie do Ekonometrii”</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zrozumienie Regresji Metodą Najmniejszych Kwadratów (OLS): Podsumowanie dla Studentów
</div>
</div>
<div class="callout-body-container callout-body">
<p>Analiza regresji to podstawowa metoda statystyczna, która bada i modeluje zależności między zmiennymi w celu zrozumienia, jak zmiany w jednej lub kilku zmiennych niezależnych wpływają na zmienną zależną.</p>
<p>W swojej istocie analiza regresji pomaga odpowiedzieć na pytania dotyczące przyczyny i skutku, przewidywania oraz prognozowania. Na przykład, przedsiębiorstwo może wykorzystać analizę regresji do zrozumienia, jak wydatki na reklamę wpływają na sprzedaż lub jak liczba godzin szkoleń pracowników przekłada się na produktywność.</p>
<section id="regresja-jako-model-stochastyczny-1" class="level3" data-number="16.14.2">
<h3 data-number="16.14.2" class="anchored" data-anchor-id="regresja-jako-model-stochastyczny-1"><span class="header-section-number">16.14.2</span> Regresja jako Model Stochastyczny</h3>
<p>W modelowaniu matematycznym spotykamy dwa podstawowe podejścia do opisywania relacji między zmiennymi:</p>
<ul>
<li>modele deterministyczne,</li>
<li>modele stochastyczne.</li>
</ul>
<section id="modele-deterministyczne-a-stochastyczne-1" class="level4" data-number="16.14.2.1">
<h4 data-number="16.14.2.1" class="anchored" data-anchor-id="modele-deterministyczne-a-stochastyczne-1"><span class="header-section-number">16.14.2.1</span> Modele Deterministyczne a Stochastyczne</h4>
<p>Model deterministyczny zakłada precyzyjną, ustaloną relację między danymi wejściowymi a wyjściowymi. W takich modelach, znając dane wejściowe, możemy z całkowitą pewnością obliczyć dokładny wynik. Weźmy pod uwagę klasyczne równanie fizyczne dotyczące drogi:</p>
<p><span class="math display">\text{Droga} = \text{Prędkość} × \text{Czas}</span></p>
<p>Przy określonych wartościach prędkości i czasu, równanie to zawsze da tę samą drogę. Nie ma tu miejsca na jakąkolwiek zmienność wyniku.</p>
<p>W przeciwieństwie do tego, analiza regresji uwzględnia naturalną zmienność danych. Podstawowa struktura modelu regresji to:</p>
<p><span class="math display">Y = f(X) + \epsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">Y</span> reprezentuje wynik, który chcemy przewidzieć</li>
<li><span class="math inline">f(X)</span> reprezentuje systematyczną relację między naszymi predyktorami (X) a wynikiem</li>
<li><span class="math inline">\epsilon</span> reprezentuje losową zmienność naturalnie występującą w rzeczywistych danych</li>
</ul>
</section>
</section>
<section id="czym-jest-prosta-regresja-liniowa" class="level3" data-number="16.14.3">
<h3 data-number="16.14.3" class="anchored" data-anchor-id="czym-jest-prosta-regresja-liniowa"><span class="header-section-number">16.14.3</span> Czym jest Prosta Regresja Liniowa?</h3>
<p>Rozważmy związek między <strong>czasem poświęconym na naukę</strong> (predyktor, zmienna niezależna) a <strong>wynikami egzaminów</strong> (zmienna objaśniana, outcome/response variable). Prosta regresja liniowa tworzy optymalną linię prostą przechodzącą przez punkty danych, modelującą tę relację. Linia ta służy dwóm celom: prognozowaniu oraz kwantyfikacji związku między zmiennymi.</p>
<p>Zależność matematyczna jest wyrażona jako:</p>
<p><span class="math display"> Y_i = \beta_0 + \beta_1X_i + \epsilon_i </span></p>
<p>Używając naszego przykładu z czasem nauki do zilustrowania każdego składnika:</p>
<ul>
<li><span class="math inline">Y_i</span> reprezentuje zmienną zależną (wyniki egzaminów)</li>
<li><span class="math inline">X_i</span> reprezentuje zmienną niezależną (godziny nauki)</li>
<li><span class="math inline">\beta_0</span> reprezentuje wyraz wolny - oczekiwany wynik egzaminu przy zerowym czasie nauki</li>
<li><span class="math inline">\beta_1</span> reprezentuje nachylenie - zmianę wyniku egzaminu na każdą dodatkową godzinę nauki</li>
<li><span class="math inline">\epsilon_i</span> reprezentuje składnik błędu, uwzględniający nieobserwowane czynniki</li>
</ul>
<p>Naszym celem jest znalezienie oszacowań <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span>, które najlepiej przybliżają prawdziwe parametry <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span>. Dopasowana linia regresji jest wtedy wyrażona jako:</p>
<p><span class="math display"> \hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1X_i </span></p>
</section>
<section id="metoda-najmniejszych-kwadratów-mnkols" class="level3" data-number="16.14.4">
<h3 data-number="16.14.4" class="anchored" data-anchor-id="metoda-najmniejszych-kwadratów-mnkols"><span class="header-section-number">16.14.4</span> Metoda Najmniejszych Kwadratów (MNK/OLS)</h3>
<p>Metoda “Najmniejszych Kwadratów” określa optymalne wartości dla <span class="math inline">\hat{\beta}_0</span> i <span class="math inline">\hat{\beta}_1</span> poprzez metodyczny proces. Choć współczesne oprogramowanie statystyczne wykonuje te obliczenia automatycznie, zrozumienie podstawowego procesu jest kluczowe:</p>
<ol type="1">
<li>Rozpocznij od wstępnego oszacowania linii regresji
<ul>
<li>Zazwyczaj zaczynamy od linii poziomej na poziomie <span class="math inline">\bar{Y}</span> (średnia Y)</li>
<li>Służy to jako punkt odniesienia, reprezentujący brak związku między X a Y</li>
</ul></li>
<li>Oblicz odległości pionowe (reszty) od każdego obserwowanego punktu do tej linii
<ul>
<li>Te reszty <span class="math inline">\hat{\epsilon}_i = e_i = Y_i - \hat{Y}_i</span> reprezentują nasze błędy predykcji</li>
<li>Dodatnia reszta oznacza, że nasza linia niedoszacowuje prawdziwej wartości</li>
<li>Ujemna reszta oznacza, że nasza linia przeszacowuje prawdziwą wartość</li>
</ul></li>
<li>Podnieś te odległości do kwadratu, aby:
<ul>
<li>Zapewnić, że dodatnie i ujemne odchylenia się nie znoszą</li>
<li>Przypisać większą wagę większym odchyleniom</li>
</ul></li>
<li>Zsumuj wszystkie kwadraty odległości, aby otrzymać Sumę Kwadratów Błędów (SSE)
<ul>
<li><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2</span></li>
<li>Reprezentuje to całkowite kwadratowe odchylenie obserwowanych wartości od naszych przewidywanych wartości</li>
</ul></li>
<li>Systematycznie dostosowuj nachylenie i wyraz wolny linii, aby zminimalizować SSE:</li>
</ol>
<ul>
<li>Proces polega na stopniowym modyfikowaniu nachylenia i położenia linii, obserwując jak zmienia się suma kwadratów odchyłek (SSE) [formalnie wymaga to zastosowania pojęć z rachunku różniczkowego]</li>
<li>Gdy SSE przestaje się zmniejszać przy kolejnych niewielkich zmianach parametrów linii, oznacza to znalezienie optymalnego dopasowania</li>
<li>To miejsce odpowiada najmniejszej możliwej wartości SSE, czyli najlepszemu dopasowaniu linii do danych</li>
</ul>
<p>Bardziej formalnie, MNK (Metoda Najmniejszych Kwadratów) znajduje optymalne wartości dla <span class="math inline">\beta_0</span> i <span class="math inline">\beta_1</span> poprzez minimalizację sumy kwadratów błędów:</p>
<p><span class="math display">\min_{\beta_0, \beta_1} \sum \epsilon_i^2 = \min_{\beta_0, \beta_1} \sum(y_i - \hat{y_i})^2 = \min_{\beta_0, \beta_1} \sum(y_i - (\beta_0 + \beta_1x_i))^2</span></p>
<p>Rozwiązanie tego problemu minimalizacji daje nam:</p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sum(x_i - \bar{x})^2} = \frac{cov(X, Y)}{var(X)}</span> <span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}</span></p>
<p>Warto zauważyć, że w powyższych wzorach <span class="math inline">\hat{\beta}_1</span> reprezentuje nachylenie linii regresji i jest wyrażone jako stosunek kowariancji zmiennych X i Y do wariancji zmiennej X. Natomiast <span class="math inline">\hat{\beta}_0</span> to wyraz wolny (punkt przecięcia z osią Y), który możemy obliczyć używając średnich wartości zmiennych X i Y oraz już oszacowanego nachylenia. Symbol <span class="math inline">\bar{x}</span> oznacza średnią wartość zmiennej X, a <span class="math inline">\bar{y}</span> średnią wartość zmiennej Y.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estymacja-parametrów" class="level3" data-number="16.14.5">
<h3 data-number="16.14.5" class="anchored" data-anchor-id="estymacja-parametrów"><span class="header-section-number">16.14.5</span> Estymacja Parametrów</h3>
<p>Formuły do oszacowania parametrów wykorzystują podstawowe miary statystyczne:</p>
<p><span class="math display"> \hat{\beta}_1 = \frac{Cov(X,Y)}{Var(X)} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2} </span></p>
<p>Ta formuła zawiera dwa istotne pojęcia statystyczne:</p>
<ul>
<li>Kowariancja (<span class="math inline">Cov</span>) kwantyfikuje wspólny ruch X i Y</li>
<li>Wariancja (<span class="math inline">Var</span>) mierzy rozproszenie wartości X wokół ich średniej</li>
<li><span class="math inline">\bar{X}</span> i <span class="math inline">\bar{Y}</span> reprezentują odpowiednio średnie X i Y</li>
</ul>
<p>Po obliczeniu <span class="math inline">\hat{\beta}_1</span> określamy <span class="math inline">\hat{\beta}_0</span>:</p>
<p><span class="math display"> \hat{\beta}_0 = \bar{Y} - \hat{\beta}_1\bar{X} </span></p>
<p>Zapewnia to, że linia regresji przechodzi przez punkt średnich (<span class="math inline">\bar{X}</span>, <span class="math inline">\bar{Y}</span>).</p>
</section>
<section id="dekompozycja-wariancji-w-regresji" class="level3" data-number="16.14.6">
<h3 data-number="16.14.6" class="anchored" data-anchor-id="dekompozycja-wariancji-w-regresji"><span class="header-section-number">16.14.6</span> Dekompozycja Wariancji w Regresji</h3>
<p>W analizie regresji rozkładamy wariancję w naszych danych na odrębne składniki, aby zrozumieć, jak dobrze nasz model wyjaśnia zmienną zależną. Przyjrzyjmy się każdemu składnikowi wariancji szczegółowo.</p>
<section id="przegląd-składników-wariancji" class="level4" data-number="16.14.6.1">
<h4 data-number="16.14.6.1" class="anchored" data-anchor-id="przegląd-składników-wariancji"><span class="header-section-number">16.14.6.1</span> Przegląd Składników Wariancji</h4>
<p>Całkowita Suma Kwadratów (SST, z ang. Total Sum of Squares) reprezentuje całkowitą zmienność obecną w naszej zmiennej zależnej. Regresyjna Suma Kwadratów (SSR, z ang. Regression Sum of Squares) obejmuje zmienność wyjaśnioną przez nasz model. Resztowa Suma Kwadratów (SSE, z ang. Error Sum of Squares) przedstawia pozostałą, niewyjaśnioną zmienność. Przeanalizujmy każdy z tych elementów.</p>
</section>
<section id="całkowita-suma-kwadratów-sst" class="level4" data-number="16.14.6.2">
<h4 data-number="16.14.6.2" class="anchored" data-anchor-id="całkowita-suma-kwadratów-sst"><span class="header-section-number">16.14.6.2</span> Całkowita Suma Kwadratów (SST)</h4>
<p>SST mierzy całkowitą zmienność w zmiennej zależnej, obliczając, jak bardzo każda obserwacja odbiega od średniej ogólnej:</p>
<p><span class="math display"> SST = \sum(y_i - \bar{y})^2 </span></p>
<p>W tym wzorze <span class="math inline">y_i</span> reprezentuje każdą pojedynczą obserwację, a <span class="math inline">\bar{y}</span> reprezentuje średnią wszystkich obserwacji. Kwadraty różnic ujmują całkowitą rozpiętość naszych danych wokół ich wartości średniej.</p>
</section>
<section id="regresyjna-suma-kwadratów-ssr" class="level4" data-number="16.14.6.3">
<h4 data-number="16.14.6.3" class="anchored" data-anchor-id="regresyjna-suma-kwadratów-ssr"><span class="header-section-number">16.14.6.3</span> Regresyjna Suma Kwadratów (SSR)</h4>
<p>SSR określa ilościowo zmienność, którą nasz model wyjaśnia poprzez zmienne objaśniające:</p>
<p><span class="math display"> SSR = \sum(\hat{y}_i - \bar{y})^2 </span></p>
<p>Tutaj <span class="math inline">\hat{y}_i</span> reprezentuje wartości przewidywane przez nasz model. Ten wzór mierzy, jak daleko nasze przewidywania odbiegają od średniej, reprezentując zmienność uchwyconą przez nasz model.</p>
</section>
<section id="resztowa-suma-kwadratów-sse" class="level4" data-number="16.14.6.4">
<h4 data-number="16.14.6.4" class="anchored" data-anchor-id="resztowa-suma-kwadratów-sse"><span class="header-section-number">16.14.6.4</span> Resztowa Suma Kwadratów (SSE)</h4>
<p>SSE mierzy zmienność, która pozostaje niewyjaśniona przez nasz model:</p>
<p><span class="math display"> SSE = \sum(y_i - \hat{y}_i)^2 </span></p>
<p>Ten wzór oblicza różnice między wartościami rzeczywistymi (<span class="math inline">y_i</span>) a wartościami przewidywanymi (<span class="math inline">\hat{y}_i</span>), pokazując nam, ile zmienności nasz model nie zdołał wyjaśnić.</p>
</section>
<section id="podstawowa-zależność" class="level4" data-number="16.14.6.5">
<h4 data-number="16.14.6.5" class="anchored" data-anchor-id="podstawowa-zależność"><span class="header-section-number">16.14.6.5</span> Podstawowa Zależność</h4>
<p>Te trzy składniki są powiązane poprzez kluczowe równanie:</p>
<p><span class="math display"> SST = SSR + SSE </span></p>
<p>To równanie pokazuje, że całkowita zmienność (SST) równa się sumie zmienności wyjaśnionej (SSR) i niewyjaśnionej (SSE). Ta zależność stanowi podstawę do pomiaru wydajności modelu.</p>
</section>
<section id="współczynnik-determinacji-r²" class="level4" data-number="16.14.6.6">
<h4 data-number="16.14.6.6" class="anchored" data-anchor-id="współczynnik-determinacji-r²"><span class="header-section-number">16.14.6.6</span> Współczynnik Determinacji (R²)</h4>
<p>Statystyka R², wyprowadzona z tych składników, mówi nam, jaką proporcję zmienności wyjaśnia nasz model:</p>
<p><span class="math display"> R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST} </span></p>
<p>Gdy R² równa się 0,75, oznacza to, że nasz model wyjaśnia 75% zmienności w zmiennej zależnej. Pozostałe 25% reprezentuje zmienność niewyjaśnioną.</p>
</section>
<section id="istotne-aspekty" class="level4" data-number="16.14.6.7">
<h4 data-number="16.14.6.7" class="anchored" data-anchor-id="istotne-aspekty"><span class="header-section-number">16.14.6.7</span> Istotne Aspekty</h4>
<p>Zrozumienie tych składników pomaga nam:</p>
<ol type="1">
<li>Ocenić wydajność modelu poprzez proporcję wyjaśnionej zmienności</li>
<li>Zidentyfikować, ile zmienności pozostaje niewyjaśnione</li>
<li>Podejmować decyzje dotyczące ulepszania modelu</li>
<li>Porównywać moc wyjaśniającą różnych modeli</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="współczynnik-determinacji-r2" class="level3" data-number="16.14.7">
<h3 data-number="16.14.7" class="anchored" data-anchor-id="współczynnik-determinacji-r2"><span class="header-section-number">16.14.7</span> Współczynnik Determinacji (<span class="math inline">R^2</span>)</h3>
<p><span class="math inline">R^2</span> służy jako miara dopasowania modelu, reprezentująca proporcję wariancji wyjaśnionej przez naszą regresję:</p>
<p><span class="math display"> R^2 = \frac{SSR}{SST} = \frac{SSR}{SSR + SSE} = 1 - \frac{SSE}{SST} </span></p>
<p>Aby zinterpretować <span class="math inline">R^2</span>:</p>
<ul>
<li><span class="math inline">R^2</span> równe 0,75 wskazuje, że model wyjaśnia 75% wariancji (np. wyników egzaminów)</li>
<li><span class="math inline">R^2</span> równe 0,20 sugeruje, że predyktory (np. godziny nauki) odpowiadają za 20% zmienności wyników</li>
<li><span class="math inline">R^2</span> równe 1,00 reprezentuje doskonałą predykcję (rzadko obserwowane w praktyce)</li>
<li><span class="math inline">R^2</span> równe 0,00 wskazuje na brak mocy wyjaśniającej</li>
</ul>
<p>Uwaga: Niższa wartość <span class="math inline">R^2</span> niekoniecznie oznacza gorszy model - może po prostu odzwierciedlać złożoność badanej relacji.</p>
</section>
<section id="kluczowy-wniosek" class="level3" data-number="16.14.8">
<h3 data-number="16.14.8" class="anchored" data-anchor-id="kluczowy-wniosek"><span class="header-section-number">16.14.8</span> Kluczowy Wniosek</h3>
<p>Regresja liniowa ustala relacje między zmiennymi poprzez identyfikację optymalnego dopasowania liniowego przez punkty danych. Ta optymalizacja zachodzi poprzez minimalizację kwadratów reszt. Współczynnik determinacji (<span class="math inline">R^2</span>) kwantyfikuje następnie moc wyjaśniającą modelu poprzez porównanie wyjaśnionej zmienności z całkowitą zmiennością w naszych danych.</p>
</section>
</div>
</div>
</section>
</section>
<section id="appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami" class="level2" data-number="16.15">
<h2 data-number="16.15" class="anchored" data-anchor-id="appendix-a.1-obliczanie-kowariancji-korelacji-pearsona-i-spearmana-oraz-modelowanie-ols---przykład-z-obliczeniami"><span class="header-section-number">16.15</span> Appendix A.1: Obliczanie Kowariancji, Korelacji Pearsona i Spearmana, oraz modelowanie OLS - przykład z obliczeniami</h2>
<p>Studentka politologii bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Gallaghera (GH) w wyborach parlamentarnych w 10 losowo wybranych demokracjach.</p>
<p>Dane dotyczące wielkości okręgu wyborczego (<span class="math inline">\text{DM}</span>) i indeksu Gallaghera:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\text{DM}</span> (<span class="math inline">X</span>)</th>
<th>Gallagher (<span class="math inline">Y</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>18,2</td>
</tr>
<tr class="even">
<td>3</td>
<td>16,7</td>
</tr>
<tr class="odd">
<td>4</td>
<td>15,8</td>
</tr>
<tr class="even">
<td>5</td>
<td>15,3</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15,0</td>
</tr>
<tr class="even">
<td>7</td>
<td>14,8</td>
</tr>
<tr class="odd">
<td>8</td>
<td>14,7</td>
</tr>
<tr class="even">
<td>9</td>
<td>14,6</td>
</tr>
<tr class="odd">
<td>10</td>
<td>14,55</td>
</tr>
<tr class="even">
<td>11</td>
<td>14,52</td>
</tr>
</tbody>
</table>
<section id="krok-1-obliczanie-podstawowych-statystyk" class="level3" data-number="16.15.1">
<h3 data-number="16.15.1" class="anchored" data-anchor-id="krok-1-obliczanie-podstawowych-statystyk"><span class="header-section-number">16.15.1</span> Krok 1: Obliczanie Podstawowych Statystyk</h3>
<p>Obliczanie średnich:</p>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">2 + 3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 + 11 = 65</span> <span class="math display">\bar{x} = \frac{65}{10} = 6,5</span></p>
<p>Dla indeksu Gallaghera (<span class="math inline">Y</span>): <span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n}</span></p>
<p>Szczegółowe obliczenia:</p>
<p><span class="math display">18,2 + 16,7 + 15,8 + 15,3 + 15,0 + 14,8 + 14,7 + 14,6 + 14,55 + 14,52 = 154,17</span> <span class="math display">\bar{y} = \frac{154,17}{10} = 15,417</span></p>
</section>
<section id="krok-2-szczegółowe-obliczenia-kowariancji" class="level3" data-number="16.15.2">
<h3 data-number="16.15.2" class="anchored" data-anchor-id="krok-2-szczegółowe-obliczenia-kowariancji"><span class="header-section-number">16.15.2</span> Krok 2: Szczegółowe Obliczenia Kowariancji</h3>
<p>Pełna tabela robocza ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">(X_i - \bar{X})</span></th>
<th><span class="math inline">(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})(Y_i - \bar{Y})</span></th>
<th><span class="math inline">(X_i - \bar{X})^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td><span class="math inline">-4,5</span></td>
<td>2,783</td>
<td><span class="math inline">-12,5235</span></td>
<td>20,25</td>
<td>7,7451</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td><span class="math inline">-3,5</span></td>
<td>1,283</td>
<td><span class="math inline">-4,4905</span></td>
<td>12,25</td>
<td>1,6461</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td><span class="math inline">-2,5</span></td>
<td>0,383</td>
<td><span class="math inline">-0,9575</span></td>
<td>6,25</td>
<td>0,1467</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td><span class="math inline">-1,5</span></td>
<td><span class="math inline">-0,117</span></td>
<td>0,1755</td>
<td>2,25</td>
<td>0,0137</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td><span class="math inline">-0,5</span></td>
<td><span class="math inline">-0,417</span></td>
<td>0,2085</td>
<td>0,25</td>
<td>0,1739</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>0,5</td>
<td><span class="math inline">-0,617</span></td>
<td><span class="math inline">-0,3085</span></td>
<td>0,25</td>
<td>0,3807</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>1,5</td>
<td><span class="math inline">-0,717</span></td>
<td><span class="math inline">-1,0755</span></td>
<td>2,25</td>
<td>0,5141</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,5</td>
<td><span class="math inline">-0,817</span></td>
<td><span class="math inline">-2,0425</span></td>
<td>6,25</td>
<td>0,6675</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>3,5</td>
<td><span class="math inline">-0,867</span></td>
<td><span class="math inline">-3,0345</span></td>
<td>12,25</td>
<td>0,7517</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>4,5</td>
<td><span class="math inline">-0,897</span></td>
<td><span class="math inline">-4,0365</span></td>
<td>20,25</td>
<td>0,8047</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>0</td>
<td>0</td>
<td><span class="math inline">-28,085</span></td>
<td>82,5</td>
<td>12,8442</td>
</tr>
</tbody>
</table>
<p>Obliczanie kowariancji: <span class="math display">\text{Cov}(X,Y) = \frac{\sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p><span class="math display">\text{Cov}(X,Y) = \frac{-28,085}{9} = -3,120556</span></p>
</section>
<section id="krok-3-obliczanie-odchylenia-standardowego" class="level3" data-number="16.15.3">
<h3 data-number="16.15.3" class="anchored" data-anchor-id="krok-3-obliczanie-odchylenia-standardowego"><span class="header-section-number">16.15.3</span> Krok 3: Obliczanie Odchylenia Standardowego</h3>
<p>Dla <span class="math inline">\text{DM}</span> (<span class="math inline">X</span>): <span class="math display">\sigma_X = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_x = \sqrt{\frac{82,5}{9}} = \sqrt{9,1667} = 3,026582</span></p>
<p>Dla Gallaghera (<span class="math inline">Y</span>): <span class="math display">\sigma_Y = \sqrt{\frac{\sum_{i=1}^n (Y_i - \bar{Y})^2}{n-1}}</span></p>
<p><span class="math display">\sigma_y = \sqrt{\frac{12,8442}{9}} = \sqrt{1,4271} = 1,194612</span></p>
</section>
<section id="krok-4-obliczanie-korelacji-pearsona" class="level3" data-number="16.15.4">
<h3 data-number="16.15.4" class="anchored" data-anchor-id="krok-4-obliczanie-korelacji-pearsona"><span class="header-section-number">16.15.4</span> Krok 4: Obliczanie Korelacji Pearsona</h3>
<p><span class="math display">r = \frac{\text{Cov}(X,Y)}{\sigma_X \sigma_Y}</span></p>
<p><span class="math display">r = \frac{-3,120556}{3,026582 \times 1,194612} = \frac{-3,120556}{3,615752} = -0,863044</span></p>
</section>
<section id="krok-5-obliczanie-korelacji-rangowej-spearmana" class="level3" data-number="16.15.5">
<h3 data-number="16.15.5" class="anchored" data-anchor-id="krok-5-obliczanie-korelacji-rangowej-spearmana"><span class="header-section-number">16.15.5</span> Krok 5: Obliczanie Korelacji Rangowej Spearmana</h3>
<p>Pełna tabela rangowa ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th>Ranga <span class="math inline">X_i</span></th>
<th>Ranga <span class="math inline">Y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>1</td>
<td>10</td>
<td><span class="math inline">-9</span></td>
<td>81</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>2</td>
<td>9</td>
<td><span class="math inline">-7</span></td>
<td>49</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>3</td>
<td>8</td>
<td><span class="math inline">-5</span></td>
<td>25</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>4</td>
<td>7</td>
<td><span class="math inline">-3</span></td>
<td>9</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>5</td>
<td>6</td>
<td><span class="math inline">-1</span></td>
<td>1</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>6</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>7</td>
<td>4</td>
<td>3</td>
<td>9</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>8</td>
<td>3</td>
<td>5</td>
<td>25</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>9</td>
<td>2</td>
<td>7</td>
<td>49</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>10</td>
<td>1</td>
<td>9</td>
<td>81</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>330</td>
</tr>
</tbody>
</table>
<p>Obliczanie korelacji Spearmana: <span class="math display">\rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)}</span></p>
<p><span class="math display">\rho = 1 - \frac{6 \times 330}{10(100 - 1)} = 1 - \frac{1980}{990} = 1 - 2 = -1</span></p>
</section>
<section id="krok-6-weryfikacja-w-r" class="level3" data-number="16.15.6">
<h3 data-number="16.15.6" class="anchored" data-anchor-id="krok-6-weryfikacja-w-r"><span class="header-section-number">16.15.6</span> Krok 6: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wektorów</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>DM <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>GH <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">18.2</span>, <span class="fl">16.7</span>, <span class="fl">15.8</span>, <span class="fl">15.3</span>, <span class="fl">15.0</span>, <span class="fl">14.8</span>, <span class="fl">14.7</span>, <span class="fl">14.6</span>, <span class="fl">14.55</span>, <span class="fl">14.52</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie kowariancji</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(DM, GH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.120556</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie korelacji</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8627742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(DM, GH, <span class="at">method =</span> <span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
</section>
<section id="krok-7-podstawowa-wizualizacja" class="level3" data-number="16.15.7">
<h3 data-number="16.15.7" class="anchored" data-anchor-id="krok-7-podstawowa-wizualizacja"><span class="header-section-number">16.15.7</span> Krok 7: Podstawowa Wizualizacja</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DM =</span> DM, <span class="at">GH =</span> GH)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu rozrzutu</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wielkość Okręgu vs Indeks Gallaghera"</span>,</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Wielkość Okręgu (DM)"</span>,</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera (GH)"</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estymacja-ols-i-miary-dopasowania-modelu" class="level3" data-number="16.15.8">
<h3 data-number="16.15.8" class="anchored" data-anchor-id="estymacja-ols-i-miary-dopasowania-modelu"><span class="header-section-number">16.15.8</span> Estymacja OLS i Miary Dopasowania Modelu</h3>
</section>
<section id="krok-1-obliczanie-estymatorów-ols" class="level3" data-number="16.15.9">
<h3 data-number="16.15.9" class="anchored" data-anchor-id="krok-1-obliczanie-estymatorów-ols"><span class="header-section-number">16.15.9</span> Krok 1: Obliczanie Estymatorów OLS</h3>
<p>Korzystając z wcześniej obliczonych wartości:</p>
<ul>
<li><span class="math inline">\sum(X_i - \bar{X})(Y_i - \bar{Y}) = -28,085</span></li>
<li><span class="math inline">\sum(X_i - \bar{X})^2 = 82,5</span></li>
<li><span class="math inline">\bar{X} = 6,5</span></li>
<li><span class="math inline">\bar{Y} = 15,417</span></li>
</ul>
<p>Obliczanie nachylenia (<span class="math inline">\hat{\beta_1}</span>):</p>
<p><span class="math inline">\hat{\beta_1} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}</span></p>
<p><span class="math display">\hat{\beta_1} = -28,085 ÷ 82,5 = -0,3404</span></p>
<p>Obliczanie wyrazu wolnego (<span class="math inline">\hat{\beta_0}</span>): <span class="math inline">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p><span class="math display">\hat{\beta_0} = 15,417 - (-0,3404 × 6,5)
   = 15,417 + 2,2126
   = 17,6296</span></p>
<p>Zatem równanie regresji OLS ma postać: <span class="math inline">\hat{Y} = 17,6296 - 0,3404X</span></p>
</section>
<section id="krok-2-obliczanie-wartości-dopasowanych-i-reszt" class="level3" data-number="16.15.10">
<h3 data-number="16.15.10" class="anchored" data-anchor-id="krok-2-obliczanie-wartości-dopasowanych-i-reszt"><span class="header-section-number">16.15.10</span> Krok 2: Obliczanie Wartości Dopasowanych i Reszt</h3>
<p>Pełna tabela ze wszystkimi obliczeniami:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\hat{Y}_i</span></th>
<th><span class="math inline">e_i = Y_i - \hat{Y}_i</span></th>
<th><span class="math inline">e_i^2</span></th>
<th><span class="math inline">(Y_i - \bar{Y})^2</span></th>
<th><span class="math inline">(\hat{Y}_i - \bar{Y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>16,9488</td>
<td>1,2512</td>
<td>1,5655</td>
<td>7,7451</td>
<td>2,3404</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>16,6084</td>
<td>0,0916</td>
<td>0,0084</td>
<td>1,6461</td>
<td>1,4241</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>16,2680</td>
<td>-0,4680</td>
<td>0,2190</td>
<td>0,1467</td>
<td>0,7225</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>15,9276</td>
<td>-0,6276</td>
<td>0,3939</td>
<td>0,0137</td>
<td>0,2601</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>15,5872</td>
<td>-0,5872</td>
<td>0,3448</td>
<td>0,1739</td>
<td>0,0289</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>15,2468</td>
<td>-0,4468</td>
<td>0,1996</td>
<td>0,3807</td>
<td>0,0290</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>14,9064</td>
<td>-0,2064</td>
<td>0,0426</td>
<td>0,5141</td>
<td>0,2610</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>14,5660</td>
<td>0,0340</td>
<td>0,0012</td>
<td>0,6675</td>
<td>0,7241</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>14,2256</td>
<td>0,3244</td>
<td>0,1052</td>
<td>0,7517</td>
<td>1,4184</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>13,8852</td>
<td>0,6348</td>
<td>0,4030</td>
<td>0,8047</td>
<td>2,3439</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>65</td>
<td>154,17</td>
<td>154,17</td>
<td>0</td>
<td>3,2832</td>
<td>12,8442</td>
<td>9,5524</td>
</tr>
</tbody>
</table>
<p>Obliczenia dla wartości dopasowanych:</p>
<pre><code>Dla X = 2:
Ŷ = 17,6296 + (-0,3404 × 2) = 16,9488

Dla X = 3:
Ŷ = 17,6296 + (-0,3404 × 3) = 16,6084

[... kontynuacja dla wszystkich wartości]</code></pre>
</section>
<section id="krok-3-obliczanie-miar-dopasowania" class="level3" data-number="16.15.11">
<h3 data-number="16.15.11" class="anchored" data-anchor-id="krok-3-obliczanie-miar-dopasowania"><span class="header-section-number">16.15.11</span> Krok 3: Obliczanie Miar Dopasowania</h3>
<p>Suma kwadratów reszt (SSE): <span class="math inline">SSE = \sum e_i^2</span></p>
<pre><code>SSE = 3,2832</code></pre>
<p>Całkowita suma kwadratów (SST): <span class="math inline">SST = \sum(Y_i - \bar{Y})^2</span></p>
<pre><code>SST = 12,8442</code></pre>
<p>Suma kwadratów regresji (SSR): <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<pre><code>SSR = 9,5524</code></pre>
<p>Weryfikacja dekompozycji: <span class="math inline">SST = SSR + SSE</span></p>
<pre><code>12,8442 = 9,5524 + 3,2832 (w granicach błędu zaokrąglenia)</code></pre>
<p>Obliczanie współczynnika determinacji R-kwadrat: <span class="math inline">R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}</span></p>
<pre><code>R² = 9,5524 ÷ 12,8442
   = 0,7438</code></pre>
</section>
<section id="krok-4-weryfikacja-w-r" class="level3" data-number="16.15.12">
<h3 data-number="16.15.12" class="anchored" data-anchor-id="krok-4-weryfikacja-w-r"><span class="header-section-number">16.15.12</span> Krok 4: Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modelu liniowego</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Podsumowanie statystyk</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62764 -0.46274 -0.08615  0.26624  1.25109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 17.62976    0.50121  35.174 4.67e-10 ***
DM          -0.34042    0.07053  -4.827  0.00131 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6406 on 8 degrees of freedom
Multiple R-squared:  0.7444,    Adjusted R-squared:  0.7124 
F-statistic:  23.3 on 1 and 8 DF,  p-value: 0.00131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ręczne obliczenie R-kwadrat</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((GH <span class="sc">-</span> <span class="fu">mean</span>(GH))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(model)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>R2_manual <span class="ot">&lt;-</span> SSR<span class="sc">/</span>SST</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>R2_manual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7443793</code></pre>
</div>
</div>
</section>
<section id="krok-5-analiza-reszt" class="level3" data-number="16.15.13">
<h3 data-number="16.15.13" class="anchored" data-anchor-id="krok-5-analiza-reszt"><span class="header-section-number">16.15.13</span> Krok 5: Analiza Reszt</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów reszt</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych" class="level3" data-number="16.15.14">
<h3 data-number="16.15.14" class="anchored" data-anchor-id="krok-6-wykres-wartości-przewidywanych-vs-rzeczywistych"><span class="header-section-number">16.15.14</span> Krok 6: Wykres Wartości Przewidywanych vs Rzeczywistych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu wartości przewidywanych vs rzeczywistych</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rzeczywiste =</span> GH,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Przewidywane =</span> <span class="fu">fitted</span>(model)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>), <span class="fu">aes</span>(<span class="at">x =</span> Przewidywane, <span class="at">y =</span> Rzeczywiste)) <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Wartości Przewidywane vs Rzeczywiste"</span>,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Przewidywany Indeks Gallaghera"</span>,</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Rzeczywisty Indeks Gallaghera"</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modele-z-transformacją-logarytmiczną" class="level3" data-number="16.15.15">
<h3 data-number="16.15.15" class="anchored" data-anchor-id="modele-z-transformacją-logarytmiczną"><span class="header-section-number">16.15.15</span> Modele z Transformacją Logarytmiczną</h3>
</section>
<section id="krok-1-transformacja-danych" class="level3" data-number="16.15.16">
<h3 data-number="16.15.16" class="anchored" data-anchor-id="krok-1-transformacja-danych"><span class="header-section-number">16.15.16</span> Krok 1: Transformacja Danych</h3>
<p>Najpierw obliczamy logarytmy naturalne zmiennych:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">i</span></th>
<th><span class="math inline">X_i</span></th>
<th><span class="math inline">Y_i</span></th>
<th><span class="math inline">\ln(X_i)</span></th>
<th><span class="math inline">\ln(Y_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>18,2</td>
<td>0,6931</td>
<td>2,9014</td>
</tr>
<tr class="even">
<td>2</td>
<td>3</td>
<td>16,7</td>
<td>1,0986</td>
<td>2,8154</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4</td>
<td>15,8</td>
<td>1,3863</td>
<td>2,7600</td>
</tr>
<tr class="even">
<td>4</td>
<td>5</td>
<td>15,3</td>
<td>1,6094</td>
<td>2,7278</td>
</tr>
<tr class="odd">
<td>5</td>
<td>6</td>
<td>15,0</td>
<td>1,7918</td>
<td>2,7081</td>
</tr>
<tr class="even">
<td>6</td>
<td>7</td>
<td>14,8</td>
<td>1,9459</td>
<td>2,6946</td>
</tr>
<tr class="odd">
<td>7</td>
<td>8</td>
<td>14,7</td>
<td>2,0794</td>
<td>2,6878</td>
</tr>
<tr class="even">
<td>8</td>
<td>9</td>
<td>14,6</td>
<td>2,1972</td>
<td>2,6810</td>
</tr>
<tr class="odd">
<td>9</td>
<td>10</td>
<td>14,55</td>
<td>2,3026</td>
<td>2,6777</td>
</tr>
<tr class="even">
<td>10</td>
<td>11</td>
<td>14,52</td>
<td>2,3979</td>
<td>2,6757</td>
</tr>
</tbody>
</table>
</section>
<section id="krok-2-porównanie-różnych-specyfikacji-modelu" class="level3" data-number="16.15.17">
<h3 data-number="16.15.17" class="anchored" data-anchor-id="krok-2-porównanie-różnych-specyfikacji-modelu"><span class="header-section-number">16.15.17</span> Krok 2: Porównanie Różnych Specyfikacji Modelu</h3>
<p>Szacujemy trzy alternatywne specyfikacje:</p>
<ol type="1">
<li>Model log-liniowy: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1 X_i + \epsilon_i</span></li>
<li>Model liniowo-logarytmiczny: <span class="math inline">Y_i = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
<li>Model log-log: <span class="math inline">\ln(Y_i) = \beta_0 + \beta_1\ln(X_i) + \epsilon_i</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie zmiennych transformowanych</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_DM <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>DM)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log_GH <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>GH)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dopasowanie modeli</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>model_loglinear <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> DM, <span class="at">data =</span> data)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>model_linearlog <span class="ot">&lt;-</span> <span class="fu">lm</span>(GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>model_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_GH <span class="sc">~</span> log_DM, <span class="at">data =</span> data)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Porównanie wartości R-kwadrat</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>models_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Liniowy"</span>, <span class="st">"Log-liniowy"</span>, <span class="st">"Liniowo-logarytmiczny"</span>, <span class="st">"Log-log"</span>),</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">R_kwadrat =</span> <span class="fu">c</span>(</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglinear)<span class="sc">$</span>r.squared,</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_linearlog)<span class="sc">$</span>r.squared,</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model_loglog)<span class="sc">$</span>r.squared</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Wyświetlenie porównania</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>models_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Model R_kwadrat
1               Liniowy 0.7443793
2           Log-liniowy 0.7670346
3 Liniowo-logarytmiczny 0.9141560
4               Log-log 0.9288088</code></pre>
</div>
</div>
</section>
<section id="krok-3-porównanie-wizualne" class="level3" data-number="16.15.18">
<h3 data-number="16.15.18" class="anchored" data-anchor-id="krok-3-porównanie-wizualne"><span class="header-section-number">16.15.18</span> Krok 3: Porównanie Wizualne</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresów dla każdego modelu</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowy"</span>) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-liniowy"</span>) <span class="sc">+</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny"</span>) <span class="sc">+</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> log_GH)) <span class="sc">+</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Model Log-log"</span>) <span class="sc">+</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Układanie wykresów w siatkę</span></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-4-analiza-reszt-dla-najlepszego-modelu" class="level3" data-number="16.15.19">
<h3 data-number="16.15.19" class="anchored" data-anchor-id="krok-4-analiza-reszt-dla-najlepszego-modelu"><span class="header-section-number">16.15.19</span> Krok 4: Analiza Reszt dla Najlepszego Modelu</h3>
<p>Na podstawie wartości R-kwadrat, analiza reszt dla najlepiej dopasowanego modelu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wykresy reszt dla najlepszego modelu</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-5-interpretacja-najlepszego-modelu" class="level3" data-number="16.15.20">
<h3 data-number="16.15.20" class="anchored" data-anchor-id="krok-5-interpretacja-najlepszego-modelu"><span class="header-section-number">16.15.20</span> Krok 5: Interpretacja Najlepszego Modelu</h3>
<p>Współczynniki modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_linearlog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = GH ~ log_DM, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40702 -0.30207 -0.04907  0.22905  0.60549 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.0223     0.4079   46.64 4.94e-11 ***
log_DM       -2.0599     0.2232   -9.23 1.54e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3712 on 8 degrees of freedom
Multiple R-squared:  0.9142,    Adjusted R-squared:  0.9034 
F-statistic: 85.19 on 1 and 8 DF,  p-value: 1.539e-05</code></pre>
</div>
</div>
<p>Interpretacja:</p>
<ul>
<li><span class="math inline">\hat{\beta_0}</span> reprezentuje oczekiwany Indeks Gallaghera, gdy ln(DM) = 0 (czyli gdy DM = 1)</li>
<li><span class="math inline">\hat{\beta_1}</span> reprezentuje zmianę Indeksu Gallaghera związaną z jednostkowym wzrostem ln(DM)</li>
</ul>
</section>
<section id="krok-6-predykcje-modelu" class="level3" data-number="16.15.21">
<h3 data-number="16.15.21" class="anchored" data-anchor-id="krok-6-predykcje-modelu"><span class="header-section-number">16.15.21</span> Krok 6: Predykcje Modelu</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu predykcji dla najlepszego modelu</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> log_DM, <span class="at">y =</span> GH)) <span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Model Liniowo-logarytmiczny: Indeks Gallaghera vs ln(Wielkość Okręgu)"</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"ln(Wielkość Okręgu)"</span>,</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Indeks Gallaghera"</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="krok-7-analiza-elastyczności" class="level3" data-number="16.15.22">
<h3 data-number="16.15.22" class="anchored" data-anchor-id="krok-7-analiza-elastyczności"><span class="header-section-number">16.15.22</span> Krok 7: Analiza Elastyczności</h3>
<p>Dla modelu log-log współczynniki bezpośrednio reprezentują elastyczności. Obliczenie średniej elastyczności dla modelu liniowo-logarytmicznego:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczenie elastyczności przy wartościach średnich</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>mean_DM <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>DM)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>mean_GH <span class="ot">&lt;-</span> <span class="fu">mean</span>(data<span class="sc">$</span>GH)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(model_linearlog)[<span class="dv">2</span>]</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>elastycznosc <span class="ot">&lt;-</span> beta1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>mean_GH)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>elastycznosc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    log_DM 
-0.1336136 </code></pre>
</div>
</div>
<p>Wartość ta reprezentuje procentową zmianę Indeksu Gallaghera przy jednoprocentowej zmianie Wielkości Okręgu.</p>
</section>
</section>
<section id="appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall" class="level2" data-number="16.16">
<h2 data-number="16.16" class="anchored" data-anchor-id="appendix-a.2-porównanie-popularnych-miar-korelacji-pearson-spearman-i-kendall"><span class="header-section-number">16.16</span> Appendix A.2: Porównanie Popularnych Miar Korelacji: Pearson, Spearman i Kendall</h2>
<section id="zbiór-danych" class="level3" data-number="16.16.1">
<h3 data-number="16.16.1" class="anchored" data-anchor-id="zbiór-danych"><span class="header-section-number">16.16.1</span> Zbiór Danych</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>dane <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>),</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">7</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="korelacja-pearsona-1" class="level3" data-number="16.16.2">
<h3 data-number="16.16.2" class="anchored" data-anchor-id="korelacja-pearsona-1"><span class="header-section-number">16.16.2</span> Korelacja Pearsona</h3>
<p><span class="math display"> r = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}} </span></p>
<section id="obliczenia-krok-po-kroku" class="level4" data-number="16.16.2.1">
<h4 data-number="16.16.2.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku"><span class="header-section-number">16.16.2.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>-2,4</td>
<td>-1,6</td>
<td>3,84</td>
<td>5,76</td>
<td>2,56</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>-0,4</td>
<td>0,4</td>
<td>-0,16</td>
<td>0,16</td>
<td>0,16</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>0,6</td>
<td>-0,6</td>
<td>-0,36</td>
<td>0,36</td>
<td>0,36</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>-1,4</td>
<td>-0,6</td>
<td>0,84</td>
<td>1,96</td>
<td>0,36</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>3,6</td>
<td>2,4</td>
<td>8,64</td>
<td>12,96</td>
<td>5,76</td>
</tr>
<tr class="even">
<td>Suma</td>
<td>22</td>
<td>23</td>
<td>0</td>
<td>0</td>
<td>12,8</td>
<td>21,2</td>
<td>9,2</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\bar{x} = 4,4</span> <span class="math inline">\bar{y} = 4,6</span></p>
<p><span class="math display"> r = \frac{12,8}{\sqrt{21,2 \times 9,2}} = \frac{12,8}{\sqrt{195,04}} = \frac{12,8}{13,97} = 0,92 </span></p>
</section>
</section>
<section id="korelacja-spearmana-1" class="level3" data-number="16.16.3">
<h3 data-number="16.16.3" class="anchored" data-anchor-id="korelacja-spearmana-1"><span class="header-section-number">16.16.3</span> Korelacja Spearmana</h3>
<p><span class="math display"> \rho = 1 - \frac{6\sum d_i^2}{n(n^2-1)} </span></p>
<section id="obliczenia-krok-po-kroku-1" class="level4" data-number="16.16.3.1">
<h4 data-number="16.16.3.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-1"><span class="header-section-number">16.16.3.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>i</th>
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">y_i</span></th>
<th>Ranga <span class="math inline">x_i</span></th>
<th>Ranga <span class="math inline">y_i</span></th>
<th><span class="math inline">d_i</span></th>
<th><span class="math inline">d_i^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>2,5</td>
<td>1,5</td>
<td>2,25</td>
</tr>
<tr class="even">
<td>4</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>2,5</td>
<td>-0,5</td>
<td>0,25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>8</td>
<td>7</td>
<td>5</td>
<td>4</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>Suma</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>7,5</td>
</tr>
</tbody>
</table>
<p><span class="math display"> \rho = 1 - \frac{6(7,5)}{5(25-1)} = 1 - \frac{45}{120} = 0,82 </span></p>
</section>
</section>
<section id="tau-kendalla" class="level3" data-number="16.16.4">
<h3 data-number="16.16.4" class="anchored" data-anchor-id="tau-kendalla"><span class="header-section-number">16.16.4</span> Tau Kendalla</h3>
<p><span class="math display"> \tau = \frac{\text{liczba par zgodnych} - \text{liczba par niezgodnych}}{\frac{1}{2}n(n-1)} </span></p>
<section id="obliczenia-krok-po-kroku-2" class="level4" data-number="16.16.4.1">
<h4 data-number="16.16.4.1" class="anchored" data-anchor-id="obliczenia-krok-po-kroku-2"><span class="header-section-number">16.16.4.1</span> Obliczenia krok po kroku:</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Para (i,j)</th>
<th><span class="math inline">x_i,x_j</span></th>
<th><span class="math inline">y_i,y_j</span></th>
<th><span class="math inline">x_j-x_i</span></th>
<th><span class="math inline">y_j-y_i</span></th>
<th>Wynik</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(1,2)</td>
<td>2,4</td>
<td>3,5</td>
<td>+2</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,3)</td>
<td>2,5</td>
<td>3,4</td>
<td>+3</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(1,4)</td>
<td>2,3</td>
<td>3,4</td>
<td>+1</td>
<td>+1</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(1,5)</td>
<td>2,8</td>
<td>3,7</td>
<td>+6</td>
<td>+4</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,3)</td>
<td>4,5</td>
<td>5,4</td>
<td>+1</td>
<td>-1</td>
<td>N</td>
</tr>
<tr class="even">
<td>(2,4)</td>
<td>4,3</td>
<td>5,4</td>
<td>-1</td>
<td>-1</td>
<td>Z</td>
</tr>
<tr class="odd">
<td>(2,5)</td>
<td>4,8</td>
<td>5,7</td>
<td>+4</td>
<td>+2</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(3,4)</td>
<td>5,3</td>
<td>4,4</td>
<td>-2</td>
<td>0</td>
<td>N</td>
</tr>
<tr class="odd">
<td>(3,5)</td>
<td>5,8</td>
<td>4,7</td>
<td>+3</td>
<td>+3</td>
<td>Z</td>
</tr>
<tr class="even">
<td>(4,5)</td>
<td>3,8</td>
<td>4,7</td>
<td>+5</td>
<td>+3</td>
<td>Z</td>
</tr>
</tbody>
</table>
<p>Liczba par zgodnych = 8 Liczba par niezgodnych = 2 <span class="math display"> \tau = \frac{8-2}{10} = 0,74 </span></p>
</section>
</section>
<section id="weryfikacja-w-r" class="level3" data-number="16.16.5">
<h3 data-number="16.16.5" class="anchored" data-anchor-id="weryfikacja-w-r"><span class="header-section-number">16.16.5</span> Weryfikacja w R</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pearson:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"pearson"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson: 0.92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Spearman:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"spearman"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spearman: 0.82 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Kendall:"</span>, <span class="fu">round</span>(<span class="fu">cor</span>(dane<span class="sc">$</span>x, dane<span class="sc">$</span>y, <span class="at">method=</span><span class="st">"kendall"</span>), <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall: 0.74 </code></pre>
</div>
</div>
</section>
<section id="interpretacja-wyników" class="level3" data-number="16.16.6">
<h3 data-number="16.16.6" class="anchored" data-anchor-id="interpretacja-wyników"><span class="header-section-number">16.16.6</span> Interpretacja Wyników</h3>
<ol type="1">
<li><strong>Korelacja Pearsona (r = 0,92)</strong>
<ul>
<li>Silna dodatnia korelacja liniowa</li>
<li>Wskazuje na bardzo silny liniowy związek między zmiennymi</li>
</ul></li>
<li><strong>Korelacja Spearmana (ρ = 0,82)</strong>
<ul>
<li>Również silna dodatnia korelacja</li>
<li>Nieco niższa niż Pearsona, co sugeruje pewne odchylenia od monotoniczności</li>
</ul></li>
<li><strong>Tau Kendalla (τ = 0,74)</strong>
<ul>
<li>Najniższa z trzech wartości, ale wciąż wskazuje na silną zależność</li>
<li>Bardziej odporna na wartości odstające</li>
</ul></li>
</ol>
</section>
<section id="porównanie-miar" class="level3" data-number="16.16.7">
<h3 data-number="16.16.7" class="anchored" data-anchor-id="porównanie-miar"><span class="header-section-number">16.16.7</span> Porównanie Miar</h3>
<ol type="1">
<li><strong>Różnice w wartościach:</strong>
<ul>
<li>Pearson (0,92) - najwyższa wartość, silna liniowość</li>
<li>Spearman (0,82) - uwzględnia tylko uporządkowanie</li>
<li>Kendall (0,74) - najbardziej konserwatywna miara</li>
</ul></li>
<li><strong>Praktyczne zastosowanie:</strong>
<ul>
<li>Wszystkie miary potwierdzają silną dodatnią zależność</li>
<li>Różnice między miarami wskazują na nieznaczne odchylenia od idealnej liniowości</li>
<li>Kendall daje najbardziej ostrożną ocenę siły związku</li>
</ul></li>
</ol>
</section>
</section>
<section id="appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady" class="level2" data-number="16.17">
<h2 data-number="16.17" class="anchored" data-anchor-id="appendix-b.-prosty-model-regresji-liniowej-mnkols---podstawowe-przykłady"><span class="header-section-number">16.17</span> Appendix B. Prosty Model Regresji Liniowej (MNK/OLS) - podstawowe przykłady</h2>
</section>
<section id="przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1" class="level2" data-number="16.18">
<h2 data-number="16.18" class="anchored" data-anchor-id="przykład-1.-związek-między-wielkością-okręgu-a-dysproporcjonalnością-wyborczą-1"><span class="header-section-number">16.18</span> Przykład 1. Związek Między Wielkością Okręgu a Dysproporcjonalnością Wyborczą (1)</h2>
<p>Ta analiza bada związek między wielkością okręgu wyborczego (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Indeks Loosemore-Hanby mierzy dysproporcjonalność wyborczą, gdzie wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane" class="level3" data-number="16.18.1">
<h3 data-number="16.18.1" class="anchored" data-anchor-id="dane"><span class="header-section-number">16.18.1</span> Dane</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość Okręgu i Indeks LH według Kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Country</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">14.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">13.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">13.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">12.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh" class="level3" data-number="16.18.2">
<h3 data-number="16.18.2" class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh"><span class="header-section-number">16.18.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm" class="level4" data-number="16.18.2.1">
<h4 data-number="16.18.2.1" class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm"><span class="header-section-number">16.18.2.1</span> Obliczenia dla Wielkości Okręgu (DM)</h4>
<p>Najpierw obliczam średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{3 + 4 + 5 + 6 + 7 + 8}{6} = \frac{33}{6} = 5.5</span></p>
<p>Następnie obliczam wariancję używając formuły z korektą Bessela:</p>
<p><span class="math display">\sigma^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td><span class="math inline">3 - 5.5 = -2.5</span></td>
<td><span class="math inline">(-2.5)^2 = 6.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td><span class="math inline">4 - 5.5 = -1.5</span></td>
<td><span class="math inline">(-1.5)^2 = 2.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td><span class="math inline">5 - 5.5 = -0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td><span class="math inline">6 - 5.5 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 5.5 = 1.5</span></td>
<td><span class="math inline">(1.5)^2 = 2.25</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td><span class="math inline">8 - 5.5 = 2.5</span></td>
<td><span class="math inline">(2.5)^2 = 6.25</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>17.5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{DM} = \frac{17.5}{6-1} = \frac{17.5}{5} = 3.5</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">\sigma_{DM} = \sqrt{\sigma^2_{DM}} = \sqrt{3.5} = 1.871</span></p>
</section>
<section id="obliczenia-dla-indeksu-lh" class="level4" data-number="16.18.2.2">
<h4 data-number="16.18.2.2" class="anchored" data-anchor-id="obliczenia-dla-indeksu-lh"><span class="header-section-number">16.18.2.2</span> Obliczenia dla Indeksu LH</h4>
<p>Najpierw obliczam średnią wartości LH:</p>
<p><span class="math display">\bar{x}_{LH} = \frac{15.5 + 14.25 + 13.5 + 13.5 + 13 + 12.75}{6} = \frac{82.5}{6} = 13.75</span></p>
<p>Następnie obliczam wariancję:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td><span class="math inline">15.5 - 13.75 = 1.75</span></td>
<td><span class="math inline">(1.75)^2 = 3.0625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td><span class="math inline">14.25 - 13.75 = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td><span class="math inline">12.75 - 13.75 = -1</span></td>
<td><span class="math inline">(-1)^2 = 1</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">\sigma^2_{LH} = \frac{5}{6-1} = \frac{5}{5} = 1</span></p>
<p>Odchylenie standardowe wynosi:</p>
<p><span class="math display">\sigma_{LH} = \sqrt{\sigma^2_{LH}} = \sqrt{1} = 1</span></p>
<p><strong>Podsumowanie Zadania 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 3.5</li>
<li>Odchylenie Standardowe DM: 1.871</li>
<li>Wariancja LH (z korektą Bessela): 1</li>
<li>Odchylenie Standardowe LH: 1</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych" class="level3" data-number="16.18.3">
<h3 data-number="16.18.3" class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-i-lh-dla-tej-próby-danych"><span class="header-section-number">16.18.3</span> Krok 2: Obliczenie kowariancji między DM i LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu formuły z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td>-2.5</td>
<td>1.75</td>
<td><span class="math inline">(-2.5)(1.75) = -4.375</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td>-1.5</td>
<td>0.5</td>
<td><span class="math inline">(-1.5)(0.5) = -0.75</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td>-0.5</td>
<td>-0.25</td>
<td><span class="math inline">(-0.5)(-0.25) = 0.125</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td>0.5</td>
<td>-0.25</td>
<td><span class="math inline">(0.5)(-0.25) = -0.125</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td>1.5</td>
<td>-0.75</td>
<td><span class="math inline">(1.5)(-0.75) = -1.125</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td>2.5</td>
<td>-1</td>
<td><span class="math inline">(2.5)(-1) = -2.5</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-8.75</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-8.75}{5} = -1.75</span></p>
<p><strong>Kowariancja między DM i LH: -1.75</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: gdy wielkość okręgu wzrasta, indeks dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh" class="level3" data-number="16.18.4">
<h3 data-number="16.18.4" class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-i-lh"><span class="header-section-number">16.18.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM i LH</h3>
<p>Współczynnik korelacji Pearsona obliczany jest przy użyciu formuły:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{\sigma_{DM} \cdot \sigma_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -1.75</span></li>
<li><span class="math inline">\sigma_{DM} = 1.871</span></li>
<li><span class="math inline">\sigma_{LH} = 1</span></li>
</ul>
<p><span class="math display">r = \frac{-1.75}{1.871 \cdot 1} = \frac{-1.75}{1.871} = -0.935</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.935</strong></p>
<section id="interpretacja" class="level4" data-number="16.18.4.1">
<h4 data-number="16.18.4.1" class="anchored" data-anchor-id="interpretacja"><span class="header-section-number">16.18.4.1</span> Interpretacja:</h4>
<p>Współczynnik korelacji -0.935 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Znak ujemny pokazuje odwrotną zależność między wielkością okręgu a indeksem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.935 wskazuje na bardzo silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości indeksu LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że gdy wielkość okręgu wzrasta, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami (więcej przedstawicieli wybieranych z jednego okręgu) zwykle dają bardziej proporcjonalne wyniki (niższa dysproporcjonalność).</p></li>
</ol>
<p>Odkrycie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi zapewniają więcej możliwości mniejszym partiom, aby uzyskać reprezentację, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat" class="level3" data-number="16.18.5">
<h3 data-number="16.18.5" class="anchored" data-anchor-id="krok-4-skonstruowanie-modelu-regresji-liniowej-prostej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.18.5</span> Krok 4: Skonstruowanie modelu regresji liniowej prostej i obliczenie R-kwadrat</h3>
<p>Formuła dla regresji liniowej prostej:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny (przecięcie)</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Formuła do obliczenia <span class="math inline">\beta_1</span> to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{\sigma^2_{DM}} = \frac{-1.75}{3.5} = -0.5</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, używam:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 13.75 - (-0.5) \cdot 5.5 = 13.75 + 2.75 = 16.5</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.5 - 0.5 \cdot DM</span></p>
<section id="obliczanie-wartości-przewidywanych-i-błędów" class="level4" data-number="16.18.5.1">
<h4 data-number="16.18.5.1" class="anchored" data-anchor-id="obliczanie-wartości-przewidywanych-i-błędów"><span class="header-section-number">16.18.5.1</span> Obliczanie wartości przewidywanych i błędów</h4>
<p>Używając naszego równania regresji, obliczam przewidywane wartości LH:</p>
<p><span class="math inline">\hat{LH} = 16.5 - 0.5 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 24%">
<col style="width: 14%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.5 - 0.5x_i</span>)</th>
<th>Błąd (<span class="math inline">y_i - \hat{y}_i</span>)</th>
<th>Błąd bezwzględny (<span class="math inline">|y_i - \hat{y}_i|</span>)</th>
<th>Błąd kwadratowy (<span class="math inline">[y_i - \hat{y}_i]^2</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>3</td>
<td>15.5</td>
<td><span class="math inline">16.5 - 0.5(3) = 16.5 - 1.5 = 15</span></td>
<td><span class="math inline">15.5 - 15 = 0.5</span></td>
<td><span class="math inline">|0.5| = 0.5</span></td>
<td><span class="math inline">(0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>4</td>
<td>14.25</td>
<td><span class="math inline">16.5 - 0.5(4) = 16.5 - 2 = 14.5</span></td>
<td><span class="math inline">14.25 - 14.5 = -0.25</span></td>
<td><span class="math inline">|-0.25| = 0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>5</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(5) = 16.5 - 2.5 = 14</span></td>
<td><span class="math inline">13.5 - 14 = -0.5</span></td>
<td><span class="math inline">|-0.5| = 0.5</span></td>
<td><span class="math inline">(-0.5)^2 = 0.25</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>6</td>
<td>13.5</td>
<td><span class="math inline">16.5 - 0.5(6) = 16.5 - 3 = 13.5</span></td>
<td><span class="math inline">13.5 - 13.5 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>13</td>
<td><span class="math inline">16.5 - 0.5(7) = 16.5 - 3.5 = 13</span></td>
<td><span class="math inline">13 - 13 = 0</span></td>
<td><span class="math inline">|0| = 0</span></td>
<td><span class="math inline">(0)^2 = 0</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>8</td>
<td>12.75</td>
<td><span class="math inline">16.5 - 0.5(8) = 16.5 - 4 = 12.5</span></td>
<td><span class="math inline">12.75 - 12.5 = 0.25</span></td>
<td><span class="math inline">|0.25| = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>1.5</strong></td>
<td><strong>0.625</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="obliczanie-r-kwadrat" class="level4" data-number="16.18.5.2">
<h4 data-number="16.18.5.2" class="anchored" data-anchor-id="obliczanie-r-kwadrat"><span class="header-section-number">16.18.5.2</span> Obliczanie R-kwadrat</h4>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Obliczyliśmy już te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15.5</td>
<td>1.75</td>
<td>3.0625</td>
</tr>
<tr class="even">
<td>B</td>
<td>14.25</td>
<td>0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td>-0.25</td>
<td>0.0625</td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td>-0.75</td>
<td>0.5625</td>
</tr>
<tr class="even">
<td>F</td>
<td>12.75</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>5</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SST = 5</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math inline">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 32%">
<col style="width: 28%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>15</td>
<td><span class="math inline">15 - 13.75 = 1.25</span></td>
<td><span class="math inline">(1.25)^2 = 1.5625</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>14.5</td>
<td><span class="math inline">14.5 - 13.75 = 0.75</span></td>
<td><span class="math inline">(0.75)^2 = 0.5625</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>14</td>
<td><span class="math inline">14 - 13.75 = 0.25</span></td>
<td><span class="math inline">(0.25)^2 = 0.0625</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>13.5</td>
<td><span class="math inline">13.5 - 13.75 = -0.25</span></td>
<td><span class="math inline">(-0.25)^2 = 0.0625</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>13</td>
<td><span class="math inline">13 - 13.75 = -0.75</span></td>
<td><span class="math inline">(-0.75)^2 = 0.5625</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.5</td>
<td><span class="math inline">12.5 - 13.75 = -1.25</span></td>
<td><span class="math inline">(-1.25)^2 = 1.5625</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>4.375</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">SSR = 4.375</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math inline">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<p>Z tabeli powyżej, suma kwadratów błędów wynosi:</p>
<p><span class="math inline">SSE = 0.625</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia sprawdzając, czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math inline">5 = 4.375 + 0.625 = 5 \checkmark</span></p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math inline">R^2 = \frac{SSR}{SST} = \frac{4.375}{5} = 0.875</span></p>
</section>
<section id="obliczanie-rmse-root-mean-square-error" class="level4" data-number="16.18.5.3">
<h4 data-number="16.18.5.3" class="anchored" data-anchor-id="obliczanie-rmse-root-mean-square-error"><span class="header-section-number">16.18.5.3</span> Obliczanie RMSE (Root Mean Square Error)</h4>
<p>RMSE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Używając naszego obliczonego SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{0.625}{6}} = \sqrt{0.104} \approx 0.323</span></p>
</section>
<section id="obliczanie-mae-mean-absolute-error" class="level4" data-number="16.18.5.4">
<h4 data-number="16.18.5.4" class="anchored" data-anchor-id="obliczanie-mae-mean-absolute-error"><span class="header-section-number">16.18.5.4</span> Obliczanie MAE (Mean Absolute Error)</h4>
<p>MAE jest obliczane przy użyciu formuły:</p>
<p><span class="math inline">MAE = \frac{\sum_{i=1}^{n}|y_i - \hat{y}_i|}{n}</span></p>
<p>Używając sum z tabeli:</p>
<p><span class="math inline">MAE = \frac{1.5}{6} = 0.25</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.5 - 0.5 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.875</p>
<p><strong>RMSE</strong>: 0.323</p>
<p><strong>MAE</strong>: 0.25</p>
</section>
<section id="interpretacja-1" class="level4" data-number="16.18.5.5">
<h4 data-number="16.18.5.5" class="anchored" data-anchor-id="interpretacja-1"><span class="header-section-number">16.18.5.5</span> Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego wzrostu jednostkowego wielkości okręgu, indeks dysproporcjonalności LH jest oczekiwany spadek o 0.5 jednostki. Wyraz wolny (16.5) reprezentuje oczekiwany indeks LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.875 wskazuje, że około 87.5% wariancji w dysproporcjonalności wyborczej (indeks LH) może być wyjaśnione przez wielkość okręgu. Jest to wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej.</p></li>
<li><p><strong>RMSE i MAE</strong>: Niskie wartości RMSE (0.323) i MAE (0.25) wskazują, że model dobrze dopasowuje się do danych, z małymi błędami predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Odkrycia sugerują, że zwiększanie wielkości okręgu mogłoby być skuteczną strategią reformy wyborczej dla krajów dążących do zmniejszenia dysproporcjonalności między głosami a mandatami. Jednak korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać w wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout" class="level2" data-number="16.19">
<h2 data-number="16.19" class="anchored" data-anchor-id="example-2.-descriptive-statistics-and-ols-example---income-and-voter-turnout"><span class="header-section-number">16.19</span> Example 2. Descriptive Statistics and OLS Example - Income and Voter Turnout</h2>
<p><strong>Background</strong></p>
<p>In preparation for the 2024 municipal elections, the Amsterdam Electoral Commission conducted research on voter participation patterns across different city neighborhoods. A key question emerged:</p>
<p>Does economic prosperity of a neighborhood correlate with civic engagement, specifically voter turnout?</p>
<p><strong>Data Collection</strong></p>
<p>Sample: 5 representative neighborhoods in Amsterdam</p>
<p>Time Period: Data from the 2022 municipal elections</p>
<p>Variables:</p>
<ul>
<li>Income: Average annual household income per capita (thousands €)</li>
<li>Turnout: Percentage of registered voters who voted in the election</li>
</ul>
<section id="initial-r-output-for-reference" class="level3" data-number="16.19.1">
<h3 data-number="16.19.1" class="anchored" data-anchor-id="initial-r-output-for-reference"><span class="header-section-number">16.19.1</span> Initial R Output for Reference</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">40</span>, <span class="dv">60</span>)  <span class="co"># thousands €</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>turnout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">56</span>, <span class="dv">70</span>, <span class="dv">50</span>, <span class="dv">75</span>) <span class="co"># %</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model check</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(turnout <span class="sc">~</span> income)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = turnout ~ income)

Residuals:
      1       2       3       4       5 
-1.9486  0.3359  0.5100  0.6204  0.4824 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.89647    3.96731  -0.226 0.835748    
income       1.25690    0.07822  16.068 0.000524 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.263 on 3 degrees of freedom
Multiple R-squared:  0.9885,    Adjusted R-squared:  0.9847 
F-statistic: 258.2 on 1 and 3 DF,  p-value: 0.0005243</code></pre>
</div>
</div>
</section>
<section id="dispersion-measures" class="level3" data-number="16.19.2">
<h3 data-number="16.19.2" class="anchored" data-anchor-id="dispersion-measures"><span class="header-section-number">16.19.2</span> Dispersion Measures</h3>
<p><strong>Means:</strong></p>
<p><span class="math display">\bar{X} = \frac{\sum_{i=1}^n X_i}{n} = \frac{50 + 45 + 56 + 40 + 60}{5} = \frac{251}{5} = 50.2</span></p>
<p><span class="math display">\bar{Y} = \frac{\sum_{i=1}^n Y_i}{n} = \frac{60 + 56 + 70 + 50 + 75}{5} = \frac{311}{5} = 62.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(income)  <span class="co"># 50.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(turnout) <span class="co"># 62.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.2</code></pre>
</div>
</div>
<p><strong>Variances:</strong></p>
<p><span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X: <span class="math inline">(-0.2, -5.2, 5.8, -10.2, 9.8)</span></p>
<p><span class="math display">s^2_X = \frac{0.04 + 27.04 + 33.64 + 104.04 + 96.04}{4} = \frac{260.8}{4} = 65.2</span></p>
<p>Deviations for Y: <span class="math inline">(-2.2, -6.2, 7.8, -12.2, 12.8)</span></p>
<p><span class="math display">s^2_Y = \frac{4.84 + 38.44 + 60.84 + 148.84 + 163.84}{4} = \frac{416.8}{4} = 104.2</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(income)  <span class="co"># 65.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(turnout) <span class="co"># 104.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 104.2</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation" class="level3" data-number="16.19.3">
<h3 data-number="16.19.3" class="anchored" data-anchor-id="covariance-and-correlation"><span class="header-section-number">16.19.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong></p>
<p><span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-0.2 \times -2.2) = 0.44</span> <span class="math display">(-5.2 \times -6.2) = 32.24</span> <span class="math display">(5.8 \times 7.8) = 45.24</span> <span class="math display">(-10.2 \times -12.2) = 124.44</span> <span class="math display">(9.8 \times 12.8) = 125.44</span></p>
<p><span class="math display">s_{XY} = \frac{327.8}{4} = 81.95</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(income, turnout) <span class="co"># 81.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81.95</code></pre>
</div>
</div>
<p><strong>Correlation:</strong></p>
<p><span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{81.95}{\sqrt{65.2}\sqrt{104.2}} = 0.994</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(income, turnout) <span class="co"># 0.994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9942402</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x" class="level3" data-number="16.19.4">
<h3 data-number="16.19.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x"><span class="header-section-number">16.19.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong></p>
<p><span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{81.95}{65.2} = 1.2571429</span></p>
<p><strong>Intercept:</strong></p>
<p><span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span></p>
<p>Step by step:</p>
<ol type="1">
<li><span class="math display">1.2571429 \times 50.2 = 63.1085714</span></li>
<li><span class="math display">\hat{\beta_0} = 62.2 - 63.1085714 = -0.9085714</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)  <span class="co"># Exact coefficients from R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      income 
 -0.8964724   1.2569018 </code></pre>
</div>
</div>
</section>
<section id="detailed-decomposition-of-variance-and-r-squared" class="level3" data-number="16.19.5">
<h3 data-number="16.19.5" class="anchored" data-anchor-id="detailed-decomposition-of-variance-and-r-squared"><span class="header-section-number">16.19.5</span> Detailed Decomposition of Variance and R-squared</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span></p>
<p>The predicted values <span class="math inline">\hat{Y}</span> for each <span class="math inline">X</span> value:</p>
<p>For <span class="math inline">X = 50</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (50)
</span> <span class="math display">\hat{Y} = -0.9085714 + 62.857145</span> <span class="math display">\hat{Y} = 61.9485736</span></p>
<p>For <span class="math inline">X = 45</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (45)
</span> <span class="math display">\hat{Y} = -0.9085714 + 56.5714305</span> <span class="math display">\hat{Y} = 55.6535591</span></p>
<p>For <span class="math inline">X = 56</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (56)
</span> <span class="math display">\hat{Y} = -0.9085714 + 70.4200024</span> <span class="math display">\hat{Y} = 69.5114310</span></p>
<p>For <span class="math inline">X = 40</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (40)
</span> <span class="math display">\hat{Y} = -0.9085714 + 50.2657160</span> <span class="math display">\hat{Y} = 49.3571446</span></p>
<p>For <span class="math inline">X = 60</span>:</p>
<p><span class="math display">
\hat{Y} = -0.9085714 + 1.2571429 \times (60)
</span> <span class="math display">\hat{Y} = -0.9085714 + 75.4285740</span> <span class="math display">\hat{Y} = 74.5200026</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification of predicted values</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.9085714</span> <span class="sc">+</span> <span class="fl">1.2571429</span> <span class="sc">*</span> income</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> income,</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> turnout,</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y_hat =</span> y_hat,</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X  Y    Y_hat
1 50 60 61.94857
2 45 56 55.66286
3 56 70 69.49143
4 40 50 49.37714
5 60 75 74.52000</code></pre>
</div>
</div>
<p><strong>Step 2: Calculate SST (Total Sum of Squares)</strong></p>
<p><span class="math display">SST = \sum(Y_i - \bar{Y})^2 \text{ where } \bar{Y} = 62.2</span></p>
<p><span class="math display">(60 - 62.2)^2 = (-2.2)^2 = 4.84</span> <span class="math display">(56 - 62.2)^2 = (-6.2)^2 = 38.44</span> <span class="math display">(70 - 62.2)^2 = (7.8)^2 = 60.84</span> <span class="math display">(50 - 62.2)^2 = (-12.2)^2 = 148.84</span> <span class="math display">(75 - 62.2)^2 = (12.8)^2 = 163.84</span></p>
<p><span class="math display">SST = 4.84 + 38.44 + 60.84 + 148.84 + 163.84 = 416.8</span></p>
<p><strong>Step 3: Calculate SSR (Regression Sum of Squares)</strong></p>
<p><span class="math display">SSR = \sum(\hat{Y}_i - \bar{Y})^2</span></p>
<p><span class="math display">(61.9485736 - 62.2)^2 = (-0.2514264)^2 = 0.0632151</span> <span class="math display">(55.6535591 - 62.2)^2 = (-6.5464409)^2 = 42.8558689</span> <span class="math display">(69.5114310 - 62.2)^2 = (7.3114310)^2 = 53.4570178</span> <span class="math display">(49.3571446 - 62.2)^2 = (-12.8428554)^2 = 164.9389370</span> <span class="math display">(74.5200026 - 62.2)^2 = (12.3200026)^2 = 151.7824640</span></p>
<p><span class="math display">SSR = 413.0975028</span></p>
<p><strong>Step 4: Calculate SSE (Error Sum of Squares)</strong></p>
<p><span class="math display">SSE = \sum(Y_i - \hat{Y}_i)^2</span></p>
<p><span class="math display">(60 - 61.9485736)^2 = (-1.9485736)^2 = 3.7969384</span> <span class="math display">(56 - 55.6535591)^2 = (0.3464409)^2 = 0.1200212</span> <span class="math display">(70 - 69.5114310)^2 = (0.4885690)^2 = 0.2387198</span> <span class="math display">(50 - 49.3571446)^2 = (0.6428554)^2 = 0.4132631</span> <span class="math display">(75 - 74.5200026)^2 = (0.4799974)^2 = 0.2303975</span></p>
<p><span class="math display">SSE = 4.7024972</span></p>
<p><strong>Step 5: Verify decomposition</strong></p>
<p><span class="math display">SST = SSR + SSE</span> <span class="math display">416.8 = 413.0975028 + 4.7024972</span></p>
<p><strong>Step 6: Calculate R-squared</strong></p>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{413.0975028}{416.8} = 0.9916</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared  <span class="co"># Should match our calculation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9885135</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3" data-number="16.19.6">
<h3 data-number="16.19.6" class="anchored" data-anchor-id="visualization"><span class="header-section-number">16.19.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">income =</span> income, <span class="at">turnout =</span> turnout)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> turnout)) <span class="sc">+</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Voter Turnout vs Income per Capita"</span>,</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Income per Capita (thousands €)"</span>,</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Voter Turnout (%)"</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation" class="level3" data-number="16.19.7">
<h3 data-number="16.19.7" class="anchored" data-anchor-id="interpretation"><span class="header-section-number">16.19.7</span> Interpretation</h3>
<p>The analysis shows:</p>
<ol type="1">
<li><p>A very strong positive correlation (<span class="math inline">r = 0.994</span>) between income and voter turnout</p></li>
<li><p>The regression equation <span class="math display">\hat{Y} = -0.9085714 + 1.2571429X</span> indicates that:</p>
<ul>
<li>For each €1,000 increase in income, turnout increases by about 1.26 percentage points</li>
<li>The intercept (<span class="math inline">-0.9086</span>) has little practical meaning as income is never zero</li>
</ul></li>
<li><p>The R-squared of 0.9916 indicates that 99.16% of the variance in turnout is explained by income</p></li>
</ol>
</section>
</section>
<section id="example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study" class="level2" data-number="16.20">
<h2 data-number="16.20" class="anchored" data-anchor-id="example-3.-anxiety-levels-and-cognitive-performance-a-laboratory-study"><span class="header-section-number">16.20</span> Example 3. Anxiety Levels and Cognitive Performance: A Laboratory Study</h2>
<section id="data-and-context" class="level3" data-number="16.20.1">
<h3 data-number="16.20.1" class="anchored" data-anchor-id="data-and-context"><span class="header-section-number">16.20.1</span> Data and Context</h3>
<p>In a psychology experiment, researchers measured the relationship between anxiety levels (measured by galvanic skin response, GSR) and cognitive performance (score on a working memory task).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>anxiety <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.4</span>, <span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>, <span class="fl">6.4</span>, <span class="fl">7.2</span>, <span class="fl">8.0</span>)  <span class="co"># GSR readings</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>performance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">78</span>, <span class="dv">74</span>, <span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">62</span>)      <span class="co"># Working memory scores</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(performance <span class="sc">~</span> anxiety)</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = performance ~ anxiety)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8993 -0.6660  0.2162  0.6106  1.5262 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 105.3248     1.3189   79.86 2.60e-10 ***
anxiety      -5.4407     0.2359  -23.06 4.35e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.236 on 6 degrees of freedom
Multiple R-squared:  0.9888,    Adjusted R-squared:  0.987 
F-statistic: 531.9 on 1 and 6 DF,  p-value: 4.355e-07</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3" data-number="16.20.2">
<h3 data-number="16.20.2" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">16.20.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{2.1 + 3.4 + 4.2 + 5.1 + 5.8 + 6.4 + 7.2 + 8.0}{8} = \frac{42.2}{8} = 5.275</span></p>
<p><span class="math display">\bar{Y} = \frac{92 + 88 + 84 + 78 + 74 + 70 + 65 + 62}{8} = \frac{613}{8} = 76.625</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76.625</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li><span class="math inline">(2.1 - 5.275) = -3.175</span></li>
<li><span class="math inline">(3.4 - 5.275) = -1.875</span></li>
<li><span class="math inline">(4.2 - 5.275) = -1.075</span></li>
<li><span class="math inline">(5.1 - 5.275) = -0.175</span></li>
<li><span class="math inline">(5.8 - 5.275) = 0.525</span></li>
<li><span class="math inline">(6.4 - 5.275) = 1.125</span></li>
<li><span class="math inline">(7.2 - 5.275) = 1.925</span></li>
<li><span class="math inline">(8.0 - 5.275) = 2.725</span></li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">10.08063 + 3.51563 + 1.15563 + 0.03063 + 0.27563 + 1.26563 + 3.70563 +
7.42563 = 27.45500</span></p>
<p><span class="math display">s^2_X = \frac{27.45500}{7} = 3.922143</span></p>
<p>Similarly for Y: Deviations:</p>
<p><span class="math display">15.375, 11.375, 7.375, 1.375, -2.625, -6.625, -11.625, -14.625</span></p>
<p><span class="math display">s^2_Y = \frac{236.875 + 129.391 + 54.391 + 1.891 + 6.891 + 43.891 + 135.141 + 213.891}{7} = \frac{822.362}{7} = 117.4803</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(anxiety)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.922143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 117.4107</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-1" class="level3" data-number="16.20.3">
<h3 data-number="16.20.3" class="anchored" data-anchor-id="covariance-and-correlation-1"><span class="header-section-number">16.20.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<p><span class="math display">(-3.175 × 15.375) = -48.815625</span></p>
<p><span class="math display">(-1.875 × 11.375) = -21.328125</span></p>
<p><span class="math display">(-1.075 × 7.375) = -7.928125</span></p>
<p><span class="math display">(-0.175 × 1.375) = -0.240625</span></p>
<p><span class="math display">(0.525 × -2.625) = -1.378125</span></p>
<p><span class="math display">(1.125 × -6.625) = -7.453125</span></p>
<p><span class="math display">(1.925 × -11.625) = -22.378125</span></p>
<p><span class="math display">(2.725 × -14.625) = -39.853125</span></p>
<p>Sum <span class="math inline">= -149.375</span></p>
<p><span class="math display">s_{XY} = \frac{-149.375}{7} = -21.33929</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -21.33929</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-21.33929}{\sqrt{3.922143}\sqrt{117.4803}} = -0.9932</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(anxiety, performance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9944073</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-1" class="level3" data-number="16.20.4">
<h3 data-number="16.20.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-1"><span class="header-section-number">16.20.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-21.33929}{3.922143} = -5.4407</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-5.4407 × 5.275 = -28.6997</span></li>
<li><span class="math inline">\hat{\beta_0} = 76.625 - (-28.6997) = 105.3247</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     anxiety 
 105.324804   -5.440721 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation" class="level3" data-number="16.20.5">
<h3 data-number="16.20.5" class="anchored" data-anchor-id="r-squared-calculation"><span class="header-section-number">16.20.5</span> 4. R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>: <span class="math display">\hat{Y} = 105.3247 - 5.4407X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">105.3247</span> <span class="sc">-</span> <span class="fl">5.4407</span> <span class="sc">*</span> anxiety</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> anxiety,</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Performance =</span> performance,</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Anxiety Performance Predicted
1     2.1          92  93.89923
2     3.4          88  86.82632
3     4.2          84  82.47376
4     5.1          78  77.57713
5     5.8          74  73.76864
6     6.4          70  70.50422
7     7.2          65  66.15166
8     8.0          62  61.79910</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong></p>
<p><span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 822.362</span></p>
<p><span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 816.3094</span></p>
<p><span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 6.0526</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{816.3094}{822.362} = 0.9926</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9888459</code></pre>
</div>
</div>
</section>
<section id="visualization-1" class="level3" data-number="16.20.6">
<h3 data-number="16.20.6" class="anchored" data-anchor-id="visualization-1"><span class="header-section-number">16.20.6</span> Visualization</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(anxiety, performance), <span class="fu">aes</span>(<span class="at">x =</span> anxiety, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cognitive Performance vs. Anxiety Levels"</span>,</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Anxiety (GSR)"</span>,</span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Performance Score"</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-1" class="level3" data-number="16.20.7">
<h3 data-number="16.20.7" class="anchored" data-anchor-id="interpretation-1"><span class="header-section-number">16.20.7</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.993) between anxiety and cognitive performance</li>
<li>For each unit increase in GSR (anxiety), performance decreases by approximately 5.44 points</li>
<li>The model explains 99.26% of the variance in performance scores</li>
<li>The relationship appears to be strongly linear, suggesting a reliable anxiety-performance relationship</li>
<li>The high intercept (105.32) represents the theoretical maximum performance at zero anxiety</li>
</ol>
</section>
<section id="study-limitations" class="level3" data-number="16.20.8">
<h3 data-number="16.20.8" class="anchored" data-anchor-id="study-limitations"><span class="header-section-number">16.20.8</span> Study Limitations</h3>
<ol type="1">
<li>Small sample size (n=8)</li>
<li>Possible other confounding variables</li>
<li>Limited range of anxiety levels</li>
<li>Cross-sectional rather than longitudinal data</li>
</ol>
</section>
</section>
<section id="przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2" class="level2" data-number="16.21">
<h2 data-number="16.21" class="anchored" data-anchor-id="przykład-4.-analiza-związku-między-wielkością-okręgu-a-wskaźnikiem-dysproporcjonalności-wyborczej-2"><span class="header-section-number">16.21</span> Przykład 4. Analiza związku między wielkością okręgu a wskaźnikiem dysproporcjonalności wyborczej (2)</h2>
<p>Ta analiza bada związek między wielkością okręgu (DM) a wskaźnikiem dysproporcjonalności Loosemore-Hanby (LH) w wyborach parlamentarnych w 6 krajach. Wskaźnik Loosemore-Hanby mierzy dysproporcjonalność wyborczą, przy czym wyższe wartości wskazują na większą dysproporcjonalność między głosami a mandatami.</p>
<section id="dane-1" class="level3" data-number="16.21.1">
<h3 data-number="16.21.1" class="anchored" data-anchor-id="dane-1"><span class="header-section-number">16.21.1</span> Dane</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Wielkość okręgu i wskaźnik LH według kraju</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Kraj</th>
<th style="text-align: right;">DM</th>
<th style="text-align: right;">LH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">13</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1" class="level3" data-number="16.21.2">
<h3 data-number="16.21.2" class="anchored" data-anchor-id="krok-1-obliczenie-wariancji-i-odchylenia-standardowego-dla-dm-i-lh-1"><span class="header-section-number">16.21.2</span> Krok 1: Obliczenie wariancji i odchylenia standardowego dla DM i LH</h3>
<section id="obliczenia-dla-wielkości-okręgu-dm-1" class="level4" data-number="16.21.2.1">
<h4 data-number="16.21.2.1" class="anchored" data-anchor-id="obliczenia-dla-wielkości-okręgu-dm-1"><span class="header-section-number">16.21.2.1</span> Obliczenia dla wielkości okręgu (DM)</h4>
<p>Najpierw obliczę średnią wartości DM:</p>
<p><span class="math display">\bar{x}_{DM} = \frac{1}{n}\sum_{i=1}^{n}x_i = \frac{4 + 10 + 3 + 8 + 7 + 4}{6} = \frac{36}{6} = 6</span></p>
<p>Następnie obliczę wariancję z korektą Bessela, korzystając z wzoru:</p>
<p><span class="math display">s^2_{DM} = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td><span class="math inline">10 - 6 = 4</span></td>
<td><span class="math inline">(4)^2 = 16</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td><span class="math inline">3 - 6 = -3</span></td>
<td><span class="math inline">(-3)^2 = 9</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td><span class="math inline">8 - 6 = 2</span></td>
<td><span class="math inline">(2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td><span class="math inline">7 - 6 = 1</span></td>
<td><span class="math inline">(1)^2 = 1</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td><span class="math inline">4 - 6 = -2</span></td>
<td><span class="math inline">(-2)^2 = 4</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>38</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{DM} = \frac{38}{6-1} = \frac{38}{5} = 7.6</span></p>
<p>Odchylenie standardowe to pierwiastek kwadratowy z wariancji:</p>
<p><span class="math display">s_{DM} = \sqrt{s^2_{DM}} = \sqrt{7.6} = 2.757</span></p>
</section>
<section id="obliczenia-dla-wskaźnika-lh" class="level4" data-number="16.21.2.2">
<h4 data-number="16.21.2.2" class="anchored" data-anchor-id="obliczenia-dla-wskaźnika-lh"><span class="header-section-number">16.21.2.2</span> Obliczenia dla wskaźnika LH</h4>
<p>Najpierw obliczę średnią wartości LH:</p>
<p><span class="math display">\bar{y}_{LH} = \frac{12 + 8 + 15 + 10 + 6 + 13}{6} = \frac{64}{6} = 10.667</span></p>
<p>Następnie obliczę wariancję z korektą Bessela:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 28%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td><span class="math inline">12 - 10.667 = 1.333</span></td>
<td><span class="math inline">(1.333)^2 = 1.777</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td><span class="math inline">8 - 10.667 = -2.667</span></td>
<td><span class="math inline">(-2.667)^2 = 7.113</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td><span class="math inline">15 - 10.667 = 4.333</span></td>
<td><span class="math inline">(4.333)^2 = 18.775</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td><span class="math inline">10 - 10.667 = -0.667</span></td>
<td><span class="math inline">(-0.667)^2 = 0.445</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td><span class="math inline">6 - 10.667 = -4.667</span></td>
<td><span class="math inline">(-4.667)^2 = 21.781</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td><span class="math inline">13 - 10.667 = 2.333</span></td>
<td><span class="math inline">(2.333)^2 = 5.443</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">s^2_{LH} = \frac{55.334}{6-1} = \frac{55.334}{5} = 11.067</span></p>
<p>Odchylenie standardowe to:</p>
<p><span class="math display">s_{LH} = \sqrt{s^2_{LH}} = \sqrt{11.067} = 3.327</span></p>
<p><strong>Podsumowanie kroku 1:</strong></p>
<ul>
<li>Wariancja DM (z korektą Bessela): 7.6</li>
<li>Odchylenie standardowe DM: 2.757</li>
<li>Wariancja LH (z korektą Bessela): 11.067</li>
<li>Odchylenie standardowe LH: 3.327</li>
</ul>
</section>
</section>
<section id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych" class="level3" data-number="16.21.3">
<h3 data-number="16.21.3" class="anchored" data-anchor-id="krok-2-obliczenie-kowariancji-między-dm-a-lh-dla-tej-próby-danych"><span class="header-section-number">16.21.3</span> Krok 2: Obliczenie kowariancji między DM a LH dla tej próby danych</h3>
<p>Kowariancja jest obliczana przy użyciu wzoru z korektą Bessela:</p>
<p><span class="math display">Cov(DM, LH) = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})(y_i - \bar{y})</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(x_i - \bar{x})(y_i - \bar{y})</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td>-2</td>
<td>1.333</td>
<td><span class="math inline">(-2)(1.333) = -2.666</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td>4</td>
<td>-2.667</td>
<td><span class="math inline">(4)(-2.667) = -10.668</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td>-3</td>
<td>4.333</td>
<td><span class="math inline">(-3)(4.333) = -12.999</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td>2</td>
<td>-0.667</td>
<td><span class="math inline">(2)(-0.667) = -1.334</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td>1</td>
<td>-4.667</td>
<td><span class="math inline">(1)(-4.667) = -4.667</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td>-2</td>
<td>2.333</td>
<td><span class="math inline">(-2)(2.333) = -4.666</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>-37</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">Cov(DM, LH) = \frac{-37}{6-1} = \frac{-37}{5} = -7.4</span></p>
<p><strong>Kowariancja między DM a LH: -7.4</strong></p>
<p>Ujemna kowariancja wskazuje na odwrotną zależność: wraz ze wzrostem wielkości okręgu wskaźnik dysproporcjonalności LH ma tendencję do spadku.</p>
</section>
<section id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh" class="level3" data-number="16.21.4">
<h3 data-number="16.21.4" class="anchored" data-anchor-id="krok-3-obliczenie-współczynnika-korelacji-liniowej-pearsona-między-dm-a-lh"><span class="header-section-number">16.21.4</span> Krok 3: Obliczenie współczynnika korelacji liniowej Pearsona między DM a LH</h3>
<p>Współczynnik korelacji Pearsona oblicza się przy użyciu wzoru:</p>
<p><span class="math display">r = \frac{Cov(DM, LH)}{s_{DM} \cdot s_{LH}}</span></p>
<p>Mamy już obliczone:</p>
<ul>
<li><span class="math inline">Cov(DM, LH) = -7.4</span></li>
<li><span class="math inline">s_{DM} = 2.757</span></li>
<li><span class="math inline">s_{LH} = 3.327</span></li>
</ul>
<p><span class="math display">r = \frac{-7.4}{2.757 \cdot 3.327} = \frac{-7.4}{9.172} = -0.807</span></p>
<p><strong>Współczynnik korelacji Pearsona: -0.807</strong></p>
<section id="interpretacja-2" class="level4" data-number="16.21.4.1">
<h4 data-number="16.21.4.1" class="anchored" data-anchor-id="interpretacja-2"><span class="header-section-number">16.21.4.1</span> Interpretacja:</h4>
<p>Współczynnik korelacji -0.807 wskazuje:</p>
<ol type="1">
<li><p><strong>Kierunek</strong>: Ujemny znak pokazuje odwrotną zależność między wielkością okręgu a wskaźnikiem LH.</p></li>
<li><p><strong>Siła</strong>: Wartość bezwzględna 0.807 wskazuje na silną korelację (blisko -1).</p></li>
<li><p><strong>Interpretacja praktyczna</strong>: Ponieważ wyższe wartości wskaźnika LH wskazują na większą dysproporcjonalność, ta silna ujemna korelacja sugeruje, że wraz ze wzrostem wielkości okręgu, dysproporcjonalność wyborcza ma tendencję do znacznego spadku. Innymi słowy, systemy wyborcze z większymi okręgami wyborczymi (więcej przedstawicieli wybieranych w okręgu) mają tendencję do generowania bardziej proporcjonalnych wyników (mniejsza dysproporcjonalność).</p></li>
</ol>
<p>Ustalenie to jest zgodne z teorią nauk politycznych, która sugeruje, że większe okręgi wyborcze zapewniają mniejszym partiom więcej możliwości uzyskania reprezentacji, co prowadzi do wyników wyborczych, które lepiej odzwierciedlają rozkład głosów między partiami.</p>
</section>
</section>
<section id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat" class="level3" data-number="16.21.5">
<h3 data-number="16.21.5" class="anchored" data-anchor-id="krok-4-skonstruowanie-prostego-modelu-regresji-liniowej-i-obliczenie-r-kwadrat"><span class="header-section-number">16.21.5</span> Krok 4: Skonstruowanie prostego modelu regresji liniowej i obliczenie R-kwadrat</h3>
<p>Użyję wzoru na prostą regresję liniową:</p>
<p><span class="math display">LH = \beta_0 + \beta_1 \cdot DM + \varepsilon</span></p>
<p>Gdzie:</p>
<ul>
<li><span class="math inline">\beta_0</span> to wyraz wolny</li>
<li><span class="math inline">\beta_1</span> to współczynnik nachylenia dla DM</li>
</ul>
<p>Wzór na obliczenie <span class="math inline">\beta_1</span> z korektą Bessela to:</p>
<p><span class="math display">\beta_1 = \frac{Cov(DM, LH)}{s^2_{DM}} = \frac{-7.4}{7.6} = -0.974</span></p>
<p>Aby obliczyć <span class="math inline">\beta_0</span>, użyję:</p>
<p><span class="math display">\beta_0 = \bar{y} - \beta_1 \cdot \bar{x} = 10.667 - (-0.974) \cdot 6 = 10.667 + 5.844 = 16.511</span></p>
<p>Zatem równanie regresji to:</p>
<p><span class="math display">LH = 16.511 - 0.974 \cdot DM</span></p>
<section id="obliczanie-r-kwadrat-1" class="level4" data-number="16.21.5.1">
<h4 data-number="16.21.5.1" class="anchored" data-anchor-id="obliczanie-r-kwadrat-1"><span class="header-section-number">16.21.5.1</span> Obliczanie R-kwadrat</h4>
<p>Aby właściwie obliczyć R-kwadrat, muszę obliczyć następujące sumy kwadratów:</p>
<ul>
<li>SST (Całkowita suma kwadratów): Mierzy całkowitą zmienność zmiennej zależnej (LH)</li>
<li>SSR (Suma kwadratów regresji): Mierzy zmienność wyjaśnioną przez model regresji</li>
<li>SSE (Suma kwadratów błędów): Mierzy niewyjaśnioną zmienność modelu</li>
</ul>
<p>Najpierw obliczę przewidywane wartości LH, używając naszego równania regresji:</p>
<p><span class="math display">\hat{LH} = 16.511 - 0.974 \cdot DM</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>DM (<span class="math inline">x_i</span>)</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i = 16.511 - 0.974x_i</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>4</td>
<td>12</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>10</td>
<td>8</td>
<td><span class="math inline">16.511 - 0.974(10) = 16.511 - 9.74 = 6.771</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>15</td>
<td><span class="math inline">16.511 - 0.974(3) = 16.511 - 2.922 = 13.589</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8</td>
<td>10</td>
<td><span class="math inline">16.511 - 0.974(8) = 16.511 - 7.792 = 8.719</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>7</td>
<td>6</td>
<td><span class="math inline">16.511 - 0.974(7) = 16.511 - 6.818 = 9.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>4</td>
<td>13</td>
<td><span class="math inline">16.511 - 0.974(4) = 16.511 - 3.896 = 12.615</span></td>
</tr>
</tbody>
</table>
<p>Teraz, obliczę każdą sumę kwadratów:</p>
<ol type="1">
<li>SST (Całkowita suma kwadratów)</li>
</ol>
<p><span class="math inline">SST = \sum_{i=1}^{n}(y_i - \bar{y})^2</span></p>
<p>Już obliczyliśmy te odchylenia w Kroku 1:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th><span class="math inline">y_i - \bar{y}</span></th>
<th><span class="math inline">(y_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>1.333</td>
<td>1.777</td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>-2.667</td>
<td>7.113</td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>4.333</td>
<td>18.775</td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>-0.667</td>
<td>0.445</td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>-4.667</td>
<td>21.781</td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>2.333</td>
<td>5.443</td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>55.334</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SST = 55.334</span></p>
<ol start="2" type="1">
<li>SSR (Suma kwadratów regresji)</li>
</ol>
<p><span class="math display">SSR = \sum_{i=1}^{n}(\hat{y}_i - \bar{y})^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 31%">
<col style="width: 27%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">\hat{y}_i - \bar{y}</span></th>
<th><span class="math inline">(\hat{y}_i - \bar{y})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>6.771</td>
<td><span class="math inline">6.771 - 10.667 = -3.896</span></td>
<td><span class="math inline">(-3.896)^2 = 15.178</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>13.589</td>
<td><span class="math inline">13.589 - 10.667 = 2.922</span></td>
<td><span class="math inline">(2.922)^2 = 8.538</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>8.719</td>
<td><span class="math inline">8.719 - 10.667 = -1.948</span></td>
<td><span class="math inline">(-1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>9.693</td>
<td><span class="math inline">9.693 - 10.667 = -0.974</span></td>
<td><span class="math inline">(-0.974)^2 = 0.949</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>12.615</td>
<td><span class="math inline">12.615 - 10.667 = 1.948</span></td>
<td><span class="math inline">(1.948)^2 = 3.795</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>36.05</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSR = 36.05</span></p>
<ol start="3" type="1">
<li>SSE (Suma kwadratów błędów)</li>
</ol>
<p><span class="math display">SSE = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 20%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">y_i - \hat{y}_i</span></th>
<th><span class="math inline">(y_i - \hat{y}_i)^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">12 - 12.615 = -0.615</span></td>
<td><span class="math inline">(-0.615)^2 = 0.378</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">8 - 6.771 = 1.229</span></td>
<td><span class="math inline">(1.229)^2 = 1.510</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">15 - 13.589 = 1.411</span></td>
<td><span class="math inline">(1.411)^2 = 1.991</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">10 - 8.719 = 1.281</span></td>
<td><span class="math inline">(1.281)^2 = 1.641</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">6 - 9.693 = -3.693</span></td>
<td><span class="math inline">(-3.693)^2 = 13.638</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">13 - 12.615 = 0.385</span></td>
<td><span class="math inline">(0.385)^2 = 0.148</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>19.306</strong></td>
</tr>
</tbody>
</table>
<p><span class="math display">SSE = 19.306</span></p>
<ol start="4" type="1">
<li>Weryfikacja</li>
</ol>
<p>Możemy zweryfikować nasze obliczenia, sprawdzając czy <span class="math inline">SST = SSR + SSE</span>:</p>
<p><span class="math display">55.334 \approx 36.05 + 19.306 = 55.356</span></p>
<p>Niewielka różnica (0.022) wynika z zaokrągleń w obliczeniach.</p>
<ol start="5" type="1">
<li>Obliczanie R-kwadrat</li>
</ol>
<p><span class="math display">R^2 = \frac{SSR}{SST} = \frac{36.05}{55.334} = 0.652</span></p>
<p>Alternatywnie, możemy też obliczyć:</p>
<p><span class="math display">R^2 = 1 - \frac{SSE}{SST} = 1 - \frac{19.306}{55.334} = 1 - 0.349 = 0.651</span></p>
<p>Drobna różnica wynika z zaokrągleń.</p>
</section>
<section id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego" class="level4" data-number="16.21.5.2">
<h4 data-number="16.21.5.2" class="anchored" data-anchor-id="obliczanie-rmse-pierwiastek-średniego-błędu-kwadratowego"><span class="header-section-number">16.21.5.2</span> Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</h4>
<p>Obliczanie RMSE (Pierwiastek średniego błędu kwadratowego)</p>
<p>RMSE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{SSE}{n}} = \sqrt{\frac{\sum_{i=1}^{n}(y_i - \hat{y}_i)^2}{n}}</span></p>
<p>Korzystając z naszej obliczonej SSE:</p>
<p><span class="math inline">RMSE = \sqrt{\frac{19.306}{6}} = \sqrt{3.218} = 1.794</span></p>
<p>Korekta Bessela (dzielenie przez n-1 zamiast n) stosuje się do estymacji wariancji próby, ale nie jest standardowo stosowana przy obliczaniu RMSE, gdyż RMSE jest miarą błędu predykcji, a nie estymatorem parametru populacji.</p>
</section>
<section id="obliczanie-mae-średni-błąd-bezwzględny" class="level4" data-number="16.21.5.3">
<h4 data-number="16.21.5.3" class="anchored" data-anchor-id="obliczanie-mae-średni-błąd-bezwzględny"><span class="header-section-number">16.21.5.3</span> Obliczanie MAE (Średni błąd bezwzględny)</h4>
<p>MAE oblicza się przy użyciu wzoru:</p>
<p><span class="math inline">MAE = \frac{1}{n}\sum_{i=1}^{n}|y_i - \hat{y}_i|</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 17%">
<col style="width: 41%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Kraj</th>
<th>LH (<span class="math inline">y_i</span>)</th>
<th>Przewidywane LH (<span class="math inline">\hat{y}_i</span>)</th>
<th><span class="math inline">|y_i - \hat{y}_i|</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>12</td>
<td>12.615</td>
<td><span class="math inline">|12 - 12.615| = 0.615</span></td>
</tr>
<tr class="even">
<td>B</td>
<td>8</td>
<td>6.771</td>
<td><span class="math inline">|8 - 6.771| = 1.229</span></td>
</tr>
<tr class="odd">
<td>C</td>
<td>15</td>
<td>13.589</td>
<td><span class="math inline">|15 - 13.589| = 1.411</span></td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>8.719</td>
<td><span class="math inline">|10 - 8.719| = 1.281</span></td>
</tr>
<tr class="odd">
<td>E</td>
<td>6</td>
<td>9.693</td>
<td><span class="math inline">|6 - 9.693| = 3.693</span></td>
</tr>
<tr class="even">
<td>F</td>
<td>13</td>
<td>12.615</td>
<td><span class="math inline">|13 - 12.615| = 0.385</span></td>
</tr>
<tr class="odd">
<td><strong>Suma</strong></td>
<td></td>
<td></td>
<td><strong>8.614</strong></td>
</tr>
</tbody>
</table>
<p><span class="math inline">MAE = \frac{8.614}{6} = 1.436</span></p>
<p><strong>Model regresji</strong>: <span class="math inline">LH = 16.511 - 0.974 \cdot DM</span></p>
<p><strong>R-kwadrat</strong>: 0.651</p>
<p><strong>RMSE</strong>: 1.794</p>
<p><strong>MAE</strong>: 1.436</p>
</section>
<section id="interpretacja-3" class="level4" data-number="16.21.5.4">
<h4 data-number="16.21.5.4" class="anchored" data-anchor-id="interpretacja-3"><span class="header-section-number">16.21.5.4</span> Interpretacja:</h4>
<ol type="1">
<li><p><strong>Równanie regresji</strong>: Dla każdego jednostkowego wzrostu wielkości okręgu, wskaźnik dysproporcjonalności LH zmniejsza się o 0.974 jednostki. Wyraz wolny (16.511) reprezentuje oczekiwany wskaźnik LH, gdy wielkość okręgu wynosi zero (choć nie ma to praktycznego znaczenia, ponieważ wielkość okręgu nie może wynosić zero).</p></li>
<li><p><strong>R-kwadrat</strong>: 0.651 wskazuje, że około 65.1% wariancji dysproporcjonalności wyborczej (wskaźnik LH) może być wyjaśnione przez wielkość okręgu. Jest to dość wysoka wartość, sugerująca, że wielkość okręgu jest rzeczywiście silnym predyktorem dysproporcjonalności wyborczej, choć mniejszym niż w poprzednim zestawie danych.</p></li>
<li><p><strong>RMSE</strong>: Wartość 1.794 informuje nas o przeciętnym błędzie prognozy modelu. Jest to miara dokładności przewidywań modelu wyrażona w jednostkach zmiennej zależnej (LH).</p></li>
<li><p><strong>MAE</strong>: Wartość 1.436 informuje nas o przeciętnym bezwzględnym błędzie prognozy modelu. W porównaniu z RMSE, MAE jest mniej czuły na wartości odstające, co potwierdza, że niektóre obserwacje (np. dla kraju E) mają stosunkowo duży błąd predykcji.</p></li>
<li><p><strong>Implikacje polityczne</strong>: Wyniki sugerują, że zwiększenie wielkości okręgu mogłoby być skuteczną strategią reform wyborczych dla krajów starających się zmniejszyć dysproporcjonalność między głosami a mandatami. Jednakże, korzyści marginalne wydają się zmniejszać wraz ze wzrostem wielkości okręgu, jak widać we wzorcu danych.</p></li>
</ol>
</section>
</section>
</section>
<section id="example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis" class="level2" data-number="16.22">
<h2 data-number="16.22" class="anchored" data-anchor-id="example-5.-district-magnitude-and-electoral-disproportionality-a-comparative-analysis"><span class="header-section-number">16.22</span> Example 5. District Magnitude and Electoral Disproportionality: A Comparative Analysis (*)</h2>
<section id="data-generating-process" class="level3" data-number="16.22.1">
<h3 data-number="16.22.1" class="anchored" data-anchor-id="data-generating-process"><span class="header-section-number">16.22.1</span> Data Generating Process</h3>
<p>Let’s set up a DGP where:</p>
<p><span class="math display">\begin{aligned}
&amp; Y_{\text{Gallagher}} = 12 - 0.8X_{\text{DM}} + \varepsilon \\
&amp; \varepsilon \sim \mathcal{N}(0, 1) \\
&amp; X_{\text{DM}} \in \{3, 5, 7, 10, 12, 15\}
\end{aligned}</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DGP</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>magnitude <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">15</span>)</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> magnitude <span class="sc">+</span> epsilon</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Round (sampled from the DGP) Gallagher indices to one decimal place</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>gallagher <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fl">9.0</span>, <span class="fl">7.8</span>, <span class="fl">9.2</span>, <span class="fl">4.1</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>), <span class="dv">1</span>)</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show data</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">District_Magnitude =</span> magnitude,</span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher_Index =</span> gallagher</span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  District_Magnitude Gallagher_Index
1                  3             9.0
2                  5             7.8
3                  7             9.2
4                 10             4.1
5                 12             2.5
6                 15             1.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial model check</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(gallagher <span class="sc">~</span> magnitude)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = gallagher ~ magnitude)

Residuals:
      1       2       3       4       5       6 
-0.6516 -0.4628  2.3260 -0.6908 -0.9020  0.3813 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  11.7349     1.3034   9.003 0.000843 ***
magnitude    -0.6944     0.1359  -5.110 0.006934 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.368 on 4 degrees of freedom
Multiple R-squared:  0.8672,    Adjusted R-squared:  0.834 
F-statistic: 26.11 on 1 and 4 DF,  p-value: 0.006934</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-1" class="level3" data-number="16.22.2">
<h3 data-number="16.22.2" class="anchored" data-anchor-id="descriptive-statistics-1"><span class="header-section-number">16.22.2</span> Descriptive Statistics</h3>
<p><strong>Means:</strong> <span class="math display">\bar{X} = \frac{3 + 5 + 7 + 10 + 12 + 15}{6} = \frac{52}{6} = 8.6667</span></p>
<p><span class="math display">\bar{Y} = \frac{9.0 + 7.8 + 9.2 + 4.1 + 2.5 + 1.7}{6} = \frac{34.3}{6} = 5.7167</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.716667</code></pre>
</div>
</div>
<p><strong>Variances:</strong> <span class="math display">s^2_X = \frac{\sum(X_i - \bar{X})^2}{n-1}</span></p>
<p>Deviations for X:</p>
<ul>
<li>(3 - 8.6667) = -5.6667</li>
<li>(5 - 8.6667) = -3.6667</li>
<li>(7 - 8.6667) = -1.6667</li>
<li>(10 - 8.6667) = 1.3333</li>
<li>(12 - 8.6667) = 3.3333</li>
<li>(15 - 8.6667) = 6.3333</li>
</ul>
<p>Squared deviations:</p>
<p><span class="math display">
32.1115 + 13.4445 + 2.7779 + 1.7777 + 11.1109 + 40.1107 = 101.3332
</span></p>
<p><span class="math display">s^2_X = \frac{101.3332}{5} = 20.2666</span></p>
<p>For Y: Deviations: 3.2833, 2.0833, 3.4833, -1.6167, -3.2167, -4.0167</p>
<p><span class="math display">s^2_Y = \frac{56.3483}{5} = 11.2697</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(magnitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.26667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.26967</code></pre>
</div>
</div>
</section>
<section id="covariance-and-correlation-2" class="level3" data-number="16.22.3">
<h3 data-number="16.22.3" class="anchored" data-anchor-id="covariance-and-correlation-2"><span class="header-section-number">16.22.3</span> Covariance and Correlation</h3>
<p><strong>Covariance:</strong> <span class="math display">s_{XY} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{n-1}</span></p>
<p>Products of deviations:</p>
<ul>
<li>(-5.6667 × 3.2833) = -18.6057</li>
<li>(-3.6667 × 2.0833) = -7.6387</li>
<li>(-1.6667 × 3.4833) = -5.8056</li>
<li>(1.3333 × -1.6167) = -2.1556</li>
<li>(3.3333 × -3.2167) = -10.7223</li>
<li>(6.3333 × -4.0167) = -25.4391</li>
</ul>
<p>Sum = -70.3670</p>
<p><span class="math display">s_{XY} = \frac{-70.3670}{5} = -14.0734</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.07333</code></pre>
</div>
</div>
<p><strong>Correlation:</strong> <span class="math display">r_{XY} = \frac{s_{XY}}{\sqrt{s^2_X}\sqrt{s^2_Y}} = \frac{-14.0734}{\sqrt{20.2666}\sqrt{11.2697}} = -0.9279</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(magnitude, gallagher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9312157</code></pre>
</div>
</div>
</section>
<section id="ols-regression-haty-hatbeta_0-hatbeta_1x-2" class="level3" data-number="16.22.4">
<h3 data-number="16.22.4" class="anchored" data-anchor-id="ols-regression-haty-hatbeta_0-hatbeta_1x-2"><span class="header-section-number">16.22.4</span> OLS Regression <span class="math inline">(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X)</span></h3>
<p><strong>Slope coefficient:</strong> <span class="math display">\hat{\beta_1} = \frac{s_{XY}}{s^2_X} = \frac{-14.0734}{20.2666} = -0.6944</span></p>
<p><strong>Intercept:</strong> <span class="math display">\hat{\beta_0} = \bar{Y} - \hat{\beta_1}\bar{X}</span> Steps:</p>
<ol type="1">
<li><span class="math inline">-0.6944 × 8.6667 = -6.0181</span></li>
<li><span class="math inline">\hat{\beta_0} = 5.7167 - (-6.0181) = 11.7348</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)   magnitude 
 11.7348684  -0.6944079 </code></pre>
</div>
</div>
</section>
<section id="r-squared-calculation-1" class="level3" data-number="16.22.5">
<h3 data-number="16.22.5" class="anchored" data-anchor-id="r-squared-calculation-1"><span class="header-section-number">16.22.5</span> R-squared Calculation</h3>
<p><strong>Step 1: Calculate predicted values</strong> <span class="math inline">(\hat{Y})</span>:</p>
<p><span class="math display">\hat{Y} = 11.7348 - 0.6944X</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted values</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> magnitude</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Magnitude =</span> magnitude,</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gallagher =</span> gallagher,</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Predicted =</span> y_hat,</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Magnitude Gallagher Predicted
1         3       9.0    9.6516
2         5       7.8    8.2628
3         7       9.2    6.8740
4        10       4.1    4.7908
5        12       2.5    3.4020
6        15       1.7    1.3188</code></pre>
</div>
</div>
<p><strong>Step 2: Sum of Squares</strong> <span class="math inline">SST = \sum(Y_i - \bar{Y})^2 = 56.3483</span> <span class="math inline">SSR = \sum(\hat{Y}_i - \bar{Y})^2 = 48.5271</span> <span class="math inline">SSE = \sum(Y_i - \hat{Y}_i)^2 = 7.8212</span></p>
<p><strong>R-squared:</strong> <span class="math display">R^2 = \frac{SSR}{SST} = \frac{48.5271}{56.3483} = 0.8612</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verification</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8671626</code></pre>
</div>
</div>
</section>
<section id="visualization---true-vs.-estimated-parameters" class="level3" data-number="16.22.6">
<h3 data-number="16.22.6" class="anchored" data-anchor-id="visualization---true-vs.-estimated-parameters"><span class="header-section-number">16.22.6</span> Visualization - True vs.&nbsp;Estimated Parameters</h3>
<ul>
<li>True DGP: Y = 12 - 0.8X + ε</li>
<li>Estimated Model: Y = 11.7348 - 0.6944X</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with original data</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> magnitude,</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">gallagher =</span> gallagher</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sequence for smooth lines</span></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(magnitude), <span class="fu">max</span>(magnitude), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate predicted values for both lines</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>true_dgp <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> x_seq</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>estimated <span class="ot">&lt;-</span> <span class="fl">11.7348</span> <span class="sc">-</span> <span class="fl">0.6944</span> <span class="sc">*</span> x_seq</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame for plotting</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>lines_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">magnitude =</span> <span class="fu">rep</span>(x_seq, <span class="dv">2</span>),</span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(true_dgp, estimated),</span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"True DGP"</span>, <span class="st">"Estimated"</span>), <span class="at">each =</span> <span class="fu">length</span>(x_seq))</span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lines_df, </span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> value, <span class="at">color =</span> Model, <span class="at">linetype =</span> Model),</span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df, </span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> magnitude, <span class="at">y =</span> gallagher),</span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb182-33"><a href="#cb182-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dashed"</span>, <span class="st">"solid"</span>)) <span class="sc">+</span></span>
<span id="cb182-34"><a href="#cb182-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb182-35"><a href="#cb182-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"True DGP vs. Estimated Regression Line"</span>,</span>
<span id="cb182-36"><a href="#cb182-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Black points show observed data with random noise"</span>,</span>
<span id="cb182-37"><a href="#cb182-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"District Magnitude"</span>,</span>
<span id="cb182-38"><a href="#cb182-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Gallagher Index"</span>,</span>
<span id="cb182-39"><a href="#cb182-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"True DGP: Y = 12 - 0.8X + ε</span><span class="sc">\n</span><span class="st">Estimated: Y = 11.73 - 0.69X"</span></span>
<span id="cb182-40"><a href="#cb182-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb182-41"><a href="#cb182-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb182-42"><a href="#cb182-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb182-43"><a href="#cb182-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb182-44"><a href="#cb182-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb182-45"><a href="#cb182-45" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="correg_pl_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-about-model-fit" class="level3" data-number="16.22.7">
<h3 data-number="16.22.7" class="anchored" data-anchor-id="observations-about-model-fit"><span class="header-section-number">16.22.7</span> Observations about Model Fit</h3>
<ol type="1">
<li><strong>Slope Comparison</strong>
<ul>
<li>True slope: -0.8</li>
<li>Estimated slope: -0.69</li>
<li>The estimated slope is reasonably close to the true parameter</li>
</ul></li>
<li><strong>Intercept Comparison</strong>
<ul>
<li>True intercept: 12</li>
<li>Estimated intercept: 11.73</li>
<li>The estimated intercept very closely approximates the true value</li>
</ul></li>
<li><strong>Visual Patterns</strong>
<ul>
<li>The lines are nearly parallel, showing good slope recovery</li>
<li>Points scatter around both lines due to the random error term (ε)</li>
<li>The small sample size (n=6) leads to some imprecision in estimation</li>
<li>The estimated line (blue) provides a good approximation of the true DGP (red dashed)</li>
</ul></li>
<li><strong>Impact of Random Error</strong>
<ul>
<li>The scatter of points around the true DGP line reflects the N(0,1) error term</li>
<li>This noise leads to the slight differences in estimated parameters</li>
<li>With a larger sample, we would expect even closer convergence to true parameters</li>
</ul></li>
</ol>
</section>
<section id="interpretation-2" class="level3" data-number="16.22.8">
<h3 data-number="16.22.8" class="anchored" data-anchor-id="interpretation-2"><span class="header-section-number">16.22.8</span> Interpretation</h3>
<ol type="1">
<li>Strong negative correlation (r = -0.93) between district magnitude and electoral disproportionality</li>
<li>For each unit increase in district magnitude, the Gallagher index decreases by approximately 0.69 points</li>
<li>The model explains 86.12% of the variance in disproportionality</li>
<li>The relationship appears strongly linear with moderate scatter</li>
<li>The intercept (11.73) represents the expected disproportionality in a hypothetical single-member district system</li>
</ol>
</section>
<section id="study-context" class="level3" data-number="16.22.9">
<h3 data-number="16.22.9" class="anchored" data-anchor-id="study-context"><span class="header-section-number">16.22.9</span> Study Context</h3>
<ul>
<li>Data represents simulated observations from a DGP with moderate noise</li>
<li>Sample shows how increasing district magnitude tends to reduce disproportionality</li>
<li>Random component reflects other institutional and political factors affecting disproportionality</li>
</ul>
</section>
<section id="limitations" class="level3" data-number="16.22.10">
<h3 data-number="16.22.10" class="anchored" data-anchor-id="limitations"><span class="header-section-number">16.22.10</span> Limitations</h3>
<ol type="1">
<li>Small sample size (n=6)</li>
<li>Simulated rather than real-world data</li>
<li>Assumes linear relationship</li>
<li>Does not account for other institutional features</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./correg_en.html" class="pagination-link" aria-label="Introduction to Correlation and Regression Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./probability_en.html" class="pagination-link" aria-label="Introduction to (Discrete) Probability">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Introduction to (Discrete) Probability</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>