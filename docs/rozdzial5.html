<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Podstawy statystyki opisowej jednej zmiennej – Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter6.html" rel="next">
<link href="./chapter5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ffd282cb318059e0bcb130885a47f5dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./rozdzial5.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy statystyki opisowej jednej zmiennej</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations of Statistics and Demography</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Podstawy Statystyki i Demografii</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy statystyki opisowej jednej zmiennej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference: The Logic of Statistical Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#wprowadzenie" id="toc-wprowadzenie" class="nav-link active" data-scroll-target="#wprowadzenie"><span class="header-section-number">6.1</span> Wprowadzenie</a></li>
  <li><a href="#przegląd-cztery-typy-miar-opisowych" id="toc-przegląd-cztery-typy-miar-opisowych" class="nav-link" data-scroll-target="#przegląd-cztery-typy-miar-opisowych"><span class="header-section-number">6.2</span> Przegląd: cztery typy miar opisowych</a>
  <ul class="collapse">
  <li><a href="#miary-tendencji-centralnej-measures-of-central-tendency" id="toc-miary-tendencji-centralnej-measures-of-central-tendency" class="nav-link" data-scroll-target="#miary-tendencji-centralnej-measures-of-central-tendency">1. Miary tendencji centralnej (<em>Measures of Central Tendency</em>)</a></li>
  <li><a href="#miary-zmienności-rozproszenia-measures-of-variabilitydispersion" id="toc-miary-zmienności-rozproszenia-measures-of-variabilitydispersion" class="nav-link" data-scroll-target="#miary-zmienności-rozproszenia-measures-of-variabilitydispersion">2. Miary zmienności (rozproszenia) (<em>Measures of Variability/Dispersion</em>)</a></li>
  <li><a href="#miary-pozycji-względnej-measures-of-relative-positionstanding" id="toc-miary-pozycji-względnej-measures-of-relative-positionstanding" class="nav-link" data-scroll-target="#miary-pozycji-względnej-measures-of-relative-positionstanding">3. Miary pozycji względnej (<em>Measures of Relative Position/Standing</em>)</a></li>
  <li><a href="#miary-kształtu-rozkładu-measures-of-shape" id="toc-miary-kształtu-rozkładu-measures-of-shape" class="nav-link" data-scroll-target="#miary-kształtu-rozkładu-measures-of-shape">4. Miary kształtu rozkładu (<em>Measures of Shape</em>)</a></li>
  </ul></li>
  <li><a href="#skale-pomiarowe-i-odpowiednie-statystyki" id="toc-skale-pomiarowe-i-odpowiednie-statystyki" class="nav-link" data-scroll-target="#skale-pomiarowe-i-odpowiednie-statystyki"><span class="header-section-number">6.3</span> Skale pomiarowe i odpowiednie statystyki</a>
  <ul class="collapse">
  <li><a href="#cztery-skale-pomiarowe" id="toc-cztery-skale-pomiarowe" class="nav-link" data-scroll-target="#cztery-skale-pomiarowe">Cztery skale pomiarowe</a></li>
  <li><a href="#które-statystyki-dla-których-skal" id="toc-które-statystyki-dla-których-skal" class="nav-link" data-scroll-target="#które-statystyki-dla-których-skal">Które statystyki dla których skal?</a></li>
  </ul></li>
  <li><a href="#notacja-sigma" id="toc-notacja-sigma" class="nav-link" data-scroll-target="#notacja-sigma"><span class="header-section-number">6.4</span> Notacja sigma</a></li>
  <li><a href="#rozkład-danych-i-rozkład-częstości" id="toc-rozkład-danych-i-rozkład-częstości" class="nav-link" data-scroll-target="#rozkład-danych-i-rozkład-częstości"><span class="header-section-number">6.5</span> Rozkład danych i rozkład częstości</a>
  <ul class="collapse">
  <li><a href="#czym-jest-rozkład-danych" id="toc-czym-jest-rozkład-danych" class="nav-link" data-scroll-target="#czym-jest-rozkład-danych">Czym jest rozkład danych?</a></li>
  <li><a href="#rozkład-częstości" id="toc-rozkład-częstości" class="nav-link" data-scroll-target="#rozkład-częstości">Rozkład częstości</a></li>
  </ul></li>
  <li><a href="#miary-tendencji-centralnej" id="toc-miary-tendencji-centralnej" class="nav-link" data-scroll-target="#miary-tendencji-centralnej"><span class="header-section-number">6.6</span> Miary tendencji centralnej</a>
  <ul class="collapse">
  <li><a href="#średnia-średnia-arytmetyczna" id="toc-średnia-średnia-arytmetyczna" class="nav-link" data-scroll-target="#średnia-średnia-arytmetyczna">Średnia (średnia arytmetyczna)</a></li>
  <li><a href="#mediana" id="toc-mediana" class="nav-link" data-scroll-target="#mediana">Mediana</a></li>
  <li><a href="#moda" id="toc-moda" class="nav-link" data-scroll-target="#moda">Moda</a></li>
  <li><a href="#porównanie-średniej-mediany-i-modalnej" id="toc-porównanie-średniej-mediany-i-modalnej" class="nav-link" data-scroll-target="#porównanie-średniej-mediany-i-modalnej">Porównanie średniej, mediany i modalnej</a></li>
  </ul></li>
  <li><a href="#miary-zmienności-rozproszenia-measures-of-dispersion-variability" id="toc-miary-zmienności-rozproszenia-measures-of-dispersion-variability" class="nav-link" data-scroll-target="#miary-zmienności-rozproszenia-measures-of-dispersion-variability"><span class="header-section-number">6.7</span> Miary Zmienności (Rozproszenia) / Measures of Dispersion (Variability)</a>
  <ul class="collapse">
  <li><a href="#rozstęp-range" id="toc-rozstęp-range" class="nav-link" data-scroll-target="#rozstęp-range">Rozstęp / Range</a></li>
  <li><a href="#wariancja-i-odchylenie-standardowe" id="toc-wariancja-i-odchylenie-standardowe" class="nav-link" data-scroll-target="#wariancja-i-odchylenie-standardowe">Wariancja i odchylenie standardowe</a></li>
  <li><a href="#rozstęp-międzykwartylowy-iqr" id="toc-rozstęp-międzykwartylowy-iqr" class="nav-link" data-scroll-target="#rozstęp-międzykwartylowy-iqr">Rozstęp międzykwartylowy (IQR)</a></li>
  </ul></li>
  <li><a href="#miary-pozycji-względnej" id="toc-miary-pozycji-względnej" class="nav-link" data-scroll-target="#miary-pozycji-względnej"><span class="header-section-number">6.8</span> Miary pozycji względnej</a>
  <ul class="collapse">
  <li><a href="#kwantyle" id="toc-kwantyle" class="nav-link" data-scroll-target="#kwantyle">Kwantyle</a></li>
  <li><a href="#percentyle" id="toc-percentyle" class="nav-link" data-scroll-target="#percentyle">Percentyle</a></li>
  <li><a href="#kwartyle" id="toc-kwartyle" class="nav-link" data-scroll-target="#kwartyle">Kwartyle</a></li>
  <li><a href="#obliczanie-kwartyli-metoda-tukeya" id="toc-obliczanie-kwartyli-metoda-tukeya" class="nav-link" data-scroll-target="#obliczanie-kwartyli-metoda-tukeya">Obliczanie kwartyli: metoda Tukeya</a></li>
  </ul></li>
  <li><a href="#miary-kształtu" id="toc-miary-kształtu" class="nav-link" data-scroll-target="#miary-kształtu"><span class="header-section-number">6.9</span> Miary kształtu</a>
  <ul class="collapse">
  <li><a href="#skośność-asymetria" id="toc-skośność-asymetria" class="nav-link" data-scroll-target="#skośność-asymetria">Skośność (asymetria)</a></li>
  <li><a href="#kurtoza-grubość-ogonów-rozkładu" id="toc-kurtoza-grubość-ogonów-rozkładu" class="nav-link" data-scroll-target="#kurtoza-grubość-ogonów-rozkładu">Kurtoza (grubość “ogonów” rozkładu)</a></li>
  <li><a href="#modalność-liczba-dominant" id="toc-modalność-liczba-dominant" class="nav-link" data-scroll-target="#modalność-liczba-dominant">Modalność (liczba dominant)</a></li>
  </ul></li>
  <li><a href="#wizualizacja-histogramy-visualization-histograms" id="toc-wizualizacja-histogramy-visualization-histograms" class="nav-link" data-scroll-target="#wizualizacja-histogramy-visualization-histograms"><span class="header-section-number">6.10</span> Wizualizacja: Histogramy / Visualization: Histograms</a>
  <ul class="collapse">
  <li><a href="#konstrukcja-histogramu" id="toc-konstrukcja-histogramu" class="nav-link" data-scroll-target="#konstrukcja-histogramu">Konstrukcja Histogramu</a></li>
  <li><a href="#wybór-optymalnej-liczby-przedziałów" id="toc-wybór-optymalnej-liczby-przedziałów" class="nav-link" data-scroll-target="#wybór-optymalnej-liczby-przedziałów">Wybór Optymalnej Liczby Przedziałów</a></li>
  <li><a href="#typy-histogramów-skale-osi-y" id="toc-typy-histogramów-skale-osi-y" class="nav-link" data-scroll-target="#typy-histogramów-skale-osi-y">Typy Histogramów: Skale Osi Y</a></li>
  <li><a href="#przedziały-otwarte-vs.-zamknięte" id="toc-przedziały-otwarte-vs.-zamknięte" class="nav-link" data-scroll-target="#przedziały-otwarte-vs.-zamknięte">Przedziały Otwarte vs.&nbsp;Zamknięte</a></li>
  <li><a href="#wpływ-liczby-przedziałów" id="toc-wpływ-liczby-przedziałów" class="nav-link" data-scroll-target="#wpływ-liczby-przedziałów">Wpływ Liczby Przedziałów</a></li>
  </ul></li>
  <li><a href="#wizualizacja-wykresy-pudełkowe-tukeya" id="toc-wizualizacja-wykresy-pudełkowe-tukeya" class="nav-link" data-scroll-target="#wizualizacja-wykresy-pudełkowe-tukeya"><span class="header-section-number">6.11</span> Wizualizacja: wykresy pudełkowe Tukeya</a>
  <ul class="collapse">
  <li><a href="#konstrukcja-wykresu-pudełkowego" id="toc-konstrukcja-wykresu-pudełkowego" class="nav-link" data-scroll-target="#konstrukcja-wykresu-pudełkowego">Konstrukcja wykresu pudełkowego</a></li>
  <li><a href="#porównywanie-wielu-grup-wykresami-pudełkowymi" id="toc-porównywanie-wielu-grup-wykresami-pudełkowymi" class="nav-link" data-scroll-target="#porównywanie-wielu-grup-wykresami-pudełkowymi">Porównywanie wielu grup wykresami pudełkowymi</a></li>
  </ul></li>
  <li><a href="#podsumowanie-wybór-odpowiedniej-miary" id="toc-podsumowanie-wybór-odpowiedniej-miary" class="nav-link" data-scroll-target="#podsumowanie-wybór-odpowiedniej-miary"><span class="header-section-number">6.12</span> Podsumowanie: wybór odpowiedniej miary</a></li>
  <li><a href="#appendix-a-measures-of-relative-position-standing" id="toc-appendix-a-measures-of-relative-position-standing" class="nav-link" data-scroll-target="#appendix-a-measures-of-relative-position-standing"><span class="header-section-number">6.13</span> Appendix A: Measures of Relative Position (Standing)</a>
  <ul class="collapse">
  <li><a href="#quartiles-q-the-basics" id="toc-quartiles-q-the-basics" class="nav-link" data-scroll-target="#quartiles-q-the-basics">Quartiles (Q): The Basics</a></li>
  </ul></li>
  <li><a href="#appendix-b-manual-construction-of-tukey-boxplot" id="toc-appendix-b-manual-construction-of-tukey-boxplot" class="nav-link" data-scroll-target="#appendix-b-manual-construction-of-tukey-boxplot"><span class="header-section-number">6.14</span> Appendix B: Manual Construction of Tukey Boxplot</a></li>
  <li><a href="#appendix-c-comparative-analysis-using-tukey-boxplots" id="toc-appendix-c-comparative-analysis-using-tukey-boxplots" class="nav-link" data-scroll-target="#appendix-c-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">6.15</span> Appendix C: Comparative Analysis Using Tukey Boxplots</a></li>
  <li><a href="#understanding-tukey-boxplots" id="toc-understanding-tukey-boxplots" class="nav-link" data-scroll-target="#understanding-tukey-boxplots"><span class="header-section-number">6.16</span> Understanding Tukey Boxplots</a></li>
  <li><a href="#part-a-basic-comparisons" id="toc-part-a-basic-comparisons" class="nav-link" data-scroll-target="#part-a-basic-comparisons"><span class="header-section-number">6.17</span> Part A: Basic Comparisons</a>
  <ul class="collapse">
  <li><a href="#true-or-false" id="toc-true-or-false" class="nav-link" data-scroll-target="#true-or-false">True or False:</a></li>
  </ul></li>
  <li><a href="#part-b-changes-over-time" id="toc-part-b-changes-over-time" class="nav-link" data-scroll-target="#part-b-changes-over-time"><span class="header-section-number">6.18</span> Part B: Changes Over Time</a>
  <ul class="collapse">
  <li><a href="#true-or-false-1" id="toc-true-or-false-1" class="nav-link" data-scroll-target="#true-or-false-1">True or False:</a></li>
  </ul></li>
  <li><a href="#part-c-summary-statistics" id="toc-part-c-summary-statistics" class="nav-link" data-scroll-target="#part-c-summary-statistics"><span class="header-section-number">6.19</span> Part C: Summary Statistics</a></li>
  <li><a href="#thinking-questions" id="toc-thinking-questions" class="nav-link" data-scroll-target="#thinking-questions"><span class="header-section-number">6.20</span> Thinking Questions</a></li>
  <li><a href="#solutions-1" id="toc-solutions-1" class="nav-link" data-scroll-target="#solutions-1"><span class="header-section-number">6.21</span> Solutions</a>
  <ul class="collapse">
  <li><a href="#part-a-basic-comparisons-1" id="toc-part-a-basic-comparisons-1" class="nav-link" data-scroll-target="#part-a-basic-comparisons-1">Part A: Basic Comparisons</a></li>
  <li><a href="#part-b-changes-over-time-1" id="toc-part-b-changes-over-time-1" class="nav-link" data-scroll-target="#part-b-changes-over-time-1">Part B: Changes Over Time</a></li>
  <li><a href="#thinking-questions-sample-answers" id="toc-thinking-questions-sample-answers" class="nav-link" data-scroll-target="#thinking-questions-sample-answers">Thinking Questions: Sample Answers</a></li>
  </ul></li>
  <li><a href="#appendix-d-comparative-analysis-using-tukey-boxplots" id="toc-appendix-d-comparative-analysis-using-tukey-boxplots" class="nav-link" data-scroll-target="#appendix-d-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">6.22</span> Appendix D: Comparative Analysis Using Tukey Boxplots</a>
  <ul class="collapse">
  <li><a href="#understanding-tukey-boxplots-1" id="toc-understanding-tukey-boxplots-1" class="nav-link" data-scroll-target="#understanding-tukey-boxplots-1">Understanding Tukey Boxplots</a></li>
  <li><a href="#temporal-comparison-1960-vs-2015" id="toc-temporal-comparison-1960-vs-2015" class="nav-link" data-scroll-target="#temporal-comparison-1960-vs-2015">Temporal Comparison: 1960 vs 2015</a></li>
  <li><a href="#distribution-of-fertility-rate-changes-1960-2015" id="toc-distribution-of-fertility-rate-changes-1960-2015" class="nav-link" data-scroll-target="#distribution-of-fertility-rate-changes-1960-2015">Distribution of Fertility Rate Changes (1960-2015)</a></li>
  <li><a href="#exercise-questions-1" id="toc-exercise-questions-1" class="nav-link" data-scroll-target="#exercise-questions-1">Exercise Questions</a></li>
  <li><a href="#answers-with-statistical-calculations" id="toc-answers-with-statistical-calculations" class="nav-link" data-scroll-target="#answers-with-statistical-calculations">Answers with Statistical Calculations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy statystyki opisowej jednej zmiennej</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="wprowadzenie" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="wprowadzenie"><span class="header-section-number">6.1</span> Wprowadzenie</h2>
<p><strong>Statystyka opisowa jednej zmiennej</strong> (<em>univariate descriptive statistics</em>) pomaga nam podsumować i zrozumieć cechy pojedynczej zmiennej. Gdy zbieramy dane, często mamy wiele obserwacji, które są trudne do interpretacji bez jakiejś formy podsumowania. Statystyka opisowa pozwala nam:</p>
<ul>
<li>Zidentyfikować “typową” lub “centralną” wartość w naszych danych</li>
<li>Zrozumieć, jak bardzo rozproszone lub zróżnicowane są dane</li>
<li>Wykryć nietypowe obserwacje (<em>outliers</em>)</li>
<li>Skutecznie komunikować wyniki innym</li>
</ul>
<p>W tym rozdziale zbadamy fundamentalne narzędzia do opisywania danych numerycznych, zaczynając od podstawowej notacji i przechodząc przez miary tendencji centralnej, rozproszenia oraz techniki wizualizacji.</p>
</section>
<section id="przegląd-cztery-typy-miar-opisowych" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="przegląd-cztery-typy-miar-opisowych"><span class="header-section-number">6.2</span> Przegląd: cztery typy miar opisowych</h2>
<p>Statystykę opisową jednej zmiennej można podzielić na cztery główne kategorie, z których każda odpowiada na inne pytanie dotyczące naszych danych:</p>
<section id="miary-tendencji-centralnej-measures-of-central-tendency" class="level3">
<h3 class="anchored" data-anchor-id="miary-tendencji-centralnej-measures-of-central-tendency">1. Miary tendencji centralnej (<em>Measures of Central Tendency</em>)</h3>
<p><strong>Pytanie:</strong> Jaka jest “typowa” lub “przeciętna” wartość?</p>
<p><strong>Powszechne miary:</strong></p>
<ul>
<li>Średnia (<em>mean</em>) - średnia arytmetyczna</li>
<li>Mediana (<em>median</em>) - wartość środkowa</li>
<li>Moda (<em>mode</em>) - wartość najczęstsza</li>
</ul>
<p><strong>Cel:</strong> Te miary pomagają nam zidentyfikować, gdzie znajduje się “centrum” danych. Dostarczają pojedynczej wartości reprezentującej cały zbiór danych.</p>
</section>
<section id="miary-zmienności-rozproszenia-measures-of-variabilitydispersion" class="level3">
<h3 class="anchored" data-anchor-id="miary-zmienności-rozproszenia-measures-of-variabilitydispersion">2. Miary zmienności (rozproszenia) (<em>Measures of Variability/Dispersion</em>)</h3>
<p><strong>Pytanie:</strong> Jak bardzo rozproszone są dane? Jak bardzo obserwacje różnią się od siebie?</p>
<p><strong>Powszechne miary:</strong></p>
<ul>
<li>Rozstęp (<em>range</em>) - różnica między maksimum a minimum</li>
<li>Wariancja (<em>variance</em>) - średnie kwadratowe odchylenie od średniej</li>
<li>Odchylenie standardowe (<em>standard deviation</em>) - pierwiastek kwadratowy z wariancji</li>
<li>Rozstęp międzykwartylowy (<em>interquartile range, IQR</em>) - rozrzut środkowych 50%</li>
</ul>
<p><strong>Cel:</strong> Te miary informują nas, czy obserwacje skupiają się blisko centrum, czy są szeroko rozproszone. Dwa zbiory danych mogą mieć tę samą średnią, ale bardzo różną zmienność.</p>
</section>
<section id="miary-pozycji-względnej-measures-of-relative-positionstanding" class="level3">
<h3 class="anchored" data-anchor-id="miary-pozycji-względnej-measures-of-relative-positionstanding">3. Miary pozycji względnej (<em>Measures of Relative Position/Standing</em>)</h3>
<p><strong>Pytanie:</strong> Gdzie dana obserwacja znajduje się względem innych? Jaka proporcja danych znajduje się poniżej danej wartości?</p>
<p><strong>Powszechne miary:</strong></p>
<ul>
<li>Kwantyle (<em>quantiles</em>) - pojęcie ogólne</li>
<li>Percentyle (<em>percentiles</em>) - dzielą dane na 100 części</li>
<li>Kwartyle (<em>quartiles</em>) - dzielą dane na 4 części</li>
<li>Wyniki znormalizowane (<em>standardized scores, z-scores</em>)</li>
</ul>
<p><strong>Cel:</strong> Te miary pomagają nam zrozumieć pozycję poszczególnych obserwacji w całym rozkładzie. Odpowiadają na pytania typu “Jak wynik tego studenta wypada w porównaniu z innymi?”</p>
</section>
<section id="miary-kształtu-rozkładu-measures-of-shape" class="level3">
<h3 class="anchored" data-anchor-id="miary-kształtu-rozkładu-measures-of-shape">4. Miary kształtu rozkładu (<em>Measures of Shape</em>)</h3>
<p><strong>Pytanie:</strong> Jaka jest ogólna forma lub wzorzec rozkładu?</p>
<p><strong>Powszechne miary:</strong></p>
<ul>
<li>Skośność (<em>skewness</em>) - asymetria, czy jest długi ogon po jednej stronie?</li>
<li>Kurtoza (<em>kurtosis</em>) - “ciężkość” ogonów, czy jest wiele wartości ekstremalnych?</li>
<li>Modalność (<em>modality</em>) - liczba szczytów (jednomodalny, dwumodalny, wielomodalny)</li>
</ul>
<p><strong>Cel:</strong> Te miary opisują ogólny wzorzec rozkładu. Choć nie będziemy ich obliczać numerycznie w tym kursie, będziemy identyfikować cechy kształtu wizualnie, używając histogramów i wykresów pudełkowych.</p>
<p><strong>Związek między kategoriami:</strong></p>
<p>Te cztery typy miar uzupełniają się wzajemnie. Kompletny opis danych jednej zmiennej zazwyczaj obejmuje:</p>
<ul>
<li>Co najmniej jedną miarę tendencji centralnej (średnią lub medianę)</li>
<li>Co najmniej jedną miarę zmienności (odchylenie standardowe lub IQR)</li>
<li>Wizualizacje (histogram, wykres pudełkowy) pokazujące kształt</li>
<li>Informacje o pozycji względnej przy porównywaniu konkretnych obserwacji</li>
</ul>
<p>W kolejnych sekcjach zbadamy każdą z tych kategorii szczegółowo, zaczynając od notacji matematycznej potrzebnej do precyzyjnego wyrażania tych pojęć.</p>
</section>
</section>
<section id="skale-pomiarowe-i-odpowiednie-statystyki" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="skale-pomiarowe-i-odpowiednie-statystyki"><span class="header-section-number">6.3</span> Skale pomiarowe i odpowiednie statystyki</h2>
<p>Zanim zagłębimy się w konkretne miary statystyczne, ważne jest zrozumienie, że <strong>nie wszystkie statystyki są odpowiednie dla wszystkich typów danych</strong>. Typ skali pomiarowej określa, które miary statystyczne możemy sensownie stosować.</p>
<section id="cztery-skale-pomiarowe" class="level3">
<h3 class="anchored" data-anchor-id="cztery-skale-pomiarowe">Cztery skale pomiarowe</h3>
<p><strong>1. Skala nominalna (<em>Nominal Scale</em>)</strong></p>
<p>Kategorie bez inherentnej kolejności (np. płeć, kraj, przynależność partyjna, kolor oczu).</p>
<p><strong>Właściwości:</strong> Kategorie są różne, ale nie możemy powiedzieć, że jedna jest “większa” od drugiej.</p>
<p><strong>2. Skala porządkowa (<em>Ordinal Scale</em>)</strong></p>
<p>Kategorie z sensowną kolejnością, ale odstępy między kategoriami niekoniecznie są równe (np. poziom wykształcenia: podstawowe/średnie/licencjat/magisterium/doktorat; odpowiedzi w ankiecie: zdecydowanie się nie zgadzam/nie zgadzam/neutralny/zgadzam się/zdecydowanie się zgadzam).</p>
<p><strong>Właściwości:</strong> Możemy uszeregować obserwacje, ale nie możemy skwantyfikować różnicy między rangami.</p>
<p><strong>3. Skala interwałowa (<em>Interval Scale</em>)</strong></p>
<p>Skala numeryczna z równymi odstępami, ale bez prawdziwego zera (np. temperatura w Celsjuszu lub Fahrenheita, lata kalendarzowe).</p>
<p><strong>Właściwości:</strong> Różnice są znaczące (20°C do 30°C to taka sama zmiana jak 30°C do 40°C), ale stosunki nie (20°C nie jest “dwa razy cieplejsze” niż 10°C).</p>
<p><strong>4. Skala ilorazowa (<em>Ratio Scale</em>)</strong></p>
<p>Skala numeryczna z równymi odstępami I prawdziwym zerem (np. wzrost, waga, dochód, wiek, dystans).</p>
<p><strong>Właściwości:</strong> Zarówno różnice, jak i stosunki są znaczące (20 kg jest dwa razy cięższe niż 10 kg).</p>
</section>
<section id="które-statystyki-dla-których-skal" class="level3">
<h3 class="anchored" data-anchor-id="które-statystyki-dla-których-skal">Które statystyki dla których skal?</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Miara</th>
<th>Nominalna</th>
<th>Porządkowa</th>
<th>Interwałowa</th>
<th>Ilorazowa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Moda</strong></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><strong>Mediana</strong></td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><strong>Średnia</strong></td>
<td>✗</td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><strong>Rozstęp</strong></td>
<td>✗</td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><strong>Wariancja/Odch. stand.</strong></td>
<td>✗</td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><strong>IQR</strong></td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><strong>Kwantyle/Percentyle</strong></td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
</tbody>
</table>
<p><strong>Kluczowe spostrzeżenia:</strong></p>
<ul>
<li><strong>Dane nominalne:</strong> Tylko moda ma sens. Możemy liczyć częstości, ale nie możemy obliczać średnich czy median.</li>
<li><strong>Dane porządkowe:</strong> Mediana i IQR są odpowiednie, ponieważ wymagają tylko uporządkowania. Średnia nie jest odpowiednia, bo zakłada równe odstępy.</li>
<li><strong>Dane interwałowe/ilorazowe:</strong> Wszystkie miary są odpowiednie. To najbardziej elastyczne skale pomiarowe.</li>
</ul>
<p><strong>Przykład ilustrujący, dlaczego skala ma znaczenie:</strong></p>
<p>Rozważmy poziomy wykształcenia: podstawowe (1), średnie (2), licencjat (3), magisterium (4), doktorat (5).</p>
<ul>
<li><strong>Moda:</strong> Poprawna - “Większość respondentów ma licencjat”</li>
<li><strong>Mediana:</strong> Poprawna - “Mediana poziomu wykształcenia to licencjat”</li>
<li><strong>Średnia:</strong> Problematyczna - “Średni poziom wykształcenia to 3,2” jest trudna do interpretacji, ponieważ odstępy między poziomami nie są równe (różnica między podstawowym a średnim nie jest taka sama jak różnica między magisterium a doktoratem)</li>
</ul>
<p>W tym rozdziale skupimy się głównie na danych interwałowych i ilorazowych, gdzie wszystkie miary statystyczne są odpowiednie. Należy jednak pamiętać o tych rozróżnieniach podczas pracy z różnymi typami danych w praktyce.</p>
</section>
</section>
<section id="notacja-sigma" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="notacja-sigma"><span class="header-section-number">6.4</span> Notacja sigma</h2>
<p>Zanim zagłębimy się w miary statystyczne, musimy zrozumieć <strong>notację sigma</strong> (<em>sigma notation</em>), która dostarcza zwartego sposobu wyrażania sumy wielu wartości.</p>
<p>Grecka litera <span class="math inline">\Sigma</span> (duża sigma) oznacza “suma”. Gdy piszemy:</p>
<p><span class="math display">\sum_{i=1}^{n} x_i</span></p>
<p>Oznacza to: “Zsumuj wszystkie wartości <span class="math inline">x</span> od pierwszej obserwacji (<span class="math inline">i=1</span>) do ostatniej obserwacji (<span class="math inline">i=n</span>).”</p>
<p><strong>Rozbicie notacji:</strong></p>
<ul>
<li><span class="math inline">\Sigma</span> = operator sumowania (“zsumuj to”)</li>
<li><span class="math inline">i=1</span> (poniżej <span class="math inline">\Sigma</span>) = zacznij od pierwszej obserwacji</li>
<li><span class="math inline">n</span> (powyżej <span class="math inline">\Sigma</span>) = kontynuuj do <span class="math inline">n</span>-tej obserwacji</li>
<li><span class="math inline">x_i</span> = wartość zmiennej <span class="math inline">x</span> dla obserwacji <span class="math inline">i</span></li>
</ul>
<p><strong>Przykład:</strong></p>
<p>Załóżmy, że mamy pięć obserwacji: <span class="math inline">x_1 = 2</span>, <span class="math inline">x_2 = 5</span>, <span class="math inline">x_3 = 3</span>, <span class="math inline">x_4 = 8</span>, <span class="math inline">x_5 = 7</span></p>
<p>Wtedy:</p>
<p><span class="math display">\sum_{i=1}^{5} x_i = x_1 + x_2 + x_3 + x_4 + x_5 = 2 + 5 + 3 + 8 + 7 = 25</span></p>
<p><strong>Przydatne właściwości notacji sigma:</strong></p>
<p><span class="math display">\sum_{i=1}^{n} (x_i + y_i) = \sum_{i=1}^{n} x_i + \sum_{i=1}^{n} y_i</span></p>
<p><span class="math display">\sum_{i=1}^{n} c \cdot x_i = c \sum_{i=1}^{n} x_i \text{ (gdzie } c \text{ jest stałą)}</span></p>
</section>
<section id="rozkład-danych-i-rozkład-częstości" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="rozkład-danych-i-rozkład-częstości"><span class="header-section-number">6.5</span> Rozkład danych i rozkład częstości</h2>
<section id="czym-jest-rozkład-danych" class="level3">
<h3 class="anchored" data-anchor-id="czym-jest-rozkład-danych">Czym jest rozkład danych?</h3>
<p><strong>Rozkład danych</strong> (<em>data distribution</em>) odnosi się do tego, jak wartości w zbiorze danych rozkładają się w możliwym zakresie wartości. Zrozumienie rozkładu pomaga nam zobaczyć wzorce, zidentyfikować typowe wartości i wykryć nietypowe obserwacje.</p>
<p>Gdy mówimy o rozkładzie, pytamy: “Jakie wartości występują w naszych danych i jak często pojawia się każda wartość (lub zakres wartości)?”</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/bellcurvece.svg" class="img-fluid figure-img"></p>
<figcaption>Normal (Bell Curve) shape: https://mathspace.co/textbooks/syllabuses/Syllabus-786/topics/Topic-12842/subtopics/Subtopic-171745/?activeTab=theory</figcaption>
</figure>
</div>
</section>
<section id="rozkład-częstości" class="level3">
<h3 class="anchored" data-anchor-id="rozkład-częstości">Rozkład częstości</h3>
<p><strong>Rozkład częstości</strong> (<em>frequency distribution</em>) organizuje dane, pokazując, ile razy występuje każda wartość (lub zakres wartości). Może być przedstawiony jako:</p>
<ul>
<li>Tabela pokazująca wartości i ich liczności</li>
<li>Rozkład częstości względnych (pokazujący proporcje lub procenty)</li>
<li>Rozkład częstości skumulowanych (pokazujący sumy narastające)</li>
</ul>
<p><strong>Przykład:</strong></p>
<p>Załóżmy, że zapytaliśmy 20 studentów, ile książek przeczytali w zeszłym miesiącu:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>books <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Utwórz tabelę częstości</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(books))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Przeczytane_ksiazki"</span>, <span class="st">"Czestość"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>freq_table<span class="sc">$</span>Czestość_wzgledna <span class="ot">&lt;-</span> freq_table<span class="sc">$</span>Czestość <span class="sc">/</span> <span class="fu">sum</span>(freq_table<span class="sc">$</span>Czestość)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>freq_table<span class="sc">$</span>Czestość_skumulowana <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(freq_table<span class="sc">$</span>Czestość)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(freq_table, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Przeczytane książki"</span>, <span class="st">"Częstość"</span>, <span class="st">"Częstość względna"</span>, <span class="st">"Częstość skumulowana"</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Rozkład częstości przeczytanych książek"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Rozkład częstości przeczytanych książek</caption>
<colgroup>
<col style="width: 29%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Przeczytane książki</th>
<th style="text-align: right;">Częstość</th>
<th style="text-align: right;">Częstość względna</th>
<th style="text-align: right;">Częstość skumulowana</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li><strong>Częstość:</strong> Liczba studentów, którzy przeczytali daną liczbę książek</li>
<li><strong>Częstość względna:</strong> Proporcja wszystkich studentów (np. 0,20 = 20% przeczytało 5 książek)</li>
<li><strong>Częstość skumulowana:</strong> Suma narastająca (np. 10 studentów przeczytało 5 lub mniej książek)</li>
</ul>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. UNIFORM DISTRIBUTION</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>uniform_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(uniform_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Uniform Distribution"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Lottery numbers, random assignment"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. NORMAL DISTRIBUTION</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>normal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(normal_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal Distribution"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: IQ scores (mean=100, sd=15)"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"IQ Score"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. LOG-NORMAL DISTRIBUTION</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>lognormal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rlnorm</span>(<span class="dv">10000</span>, <span class="at">meanlog =</span> <span class="fl">10.5</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lognormal_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Normal Distribution"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Income distribution"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Income (PLN)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. EXPONENTIAL DISTRIBUTION</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>exponential_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rexp</span>(<span class="dv">10000</span>, <span class="at">rate =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(exponential_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Exponential Distribution"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Time between votes being cast at a polling station"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time (minutes)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. BIMODAL DISTRIBUTION</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>bimodal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">3000</span>, <span class="at">mean =</span> <span class="dv">45</span>, <span class="at">sd =</span> <span class="dv">8</span>),   <span class="co"># students who didn't study well</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rnorm</span>(<span class="dv">7000</span>, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">7</span>))    <span class="co"># students who studied well</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bimodal_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bimodal Distribution"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Exam scores (two groups of students)"</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Score (0-100)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. BETA DISTRIBUTION</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>beta_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rbeta</span>(<span class="dv">10000</span>, <span class="at">shape1 =</span> <span class="dv">5</span>, <span class="at">shape2 =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beta_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"navy"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Beta Distribution (Negatively Skewed)"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Exam scores (easier test)"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Score (0-100)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4) <span class="sc">/</span> (p5 <span class="sc">|</span> p6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-distributions" class="quarto-float quarto-figure quarto-figure-center anchored" width="3600">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="rozdzial5_files/figure-html/fig-distributions-1.png" id="fig-distributions" class="img-fluid figure-img" width="3600">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="miary-tendencji-centralnej" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="miary-tendencji-centralnej"><span class="header-section-number">6.6</span> Miary tendencji centralnej</h2>
<p>Miary tendencji centralnej informują nas o “typowej” lub “centralnej” wartości w zbiorze danych. Trzy najpowszechniejsze miary to średnia, mediana i moda.</p>
<p><strong>Stosowne skale pomiarowe:</strong></p>
<ul>
<li><strong>Moda:</strong> Nominalna, Porządkowa, Interwałowa, Ilorazowa</li>
<li><strong>Mediana:</strong> Porządkowa, Interwałowa, Ilorazowa (wymaga uporządkowania)</li>
<li><strong>Średnia:</strong> Interwałowa, Ilorazowa (wymaga równych odstępów i operacji arytmetycznych)</li>
</ul>
<section id="średnia-średnia-arytmetyczna" class="level3">
<h3 class="anchored" data-anchor-id="średnia-średnia-arytmetyczna">Średnia (średnia arytmetyczna)</h3>
<p><strong>Średnia</strong> (<em>mean</em>) to suma wszystkich wartości podzielona przez liczbę obserwacji. Reprezentuje średnią arytmetyczną.</p>
<p><strong>Stosowna dla:</strong> Tylko danych interwałowych i ilorazowych</p>
<p><strong>Wzór:</strong></p>
<p><span class="math display">\bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i = \frac{x_1 + x_2 + \cdots + x_n}{n}</span></p>
<p>gdzie <span class="math inline">\bar{x}</span> (czytane “x z kreską”) jest średnią z próby, a <span class="math inline">n</span> jest liczbą obserwacji.</p>
<p><strong>Przykład:</strong></p>
<p>Jeśli mamy wyniki testów: 75, 82, 88, 90, 95</p>
<p><span class="math display">\bar{x} = \frac{75 + 82 + 88 + 90 + 95}{5} = \frac{430}{5} = 86</span></p>
<p><strong>Prostym językiem:</strong> Średnia to wartość, którą otrzymalibyśmy, gdybyśmy mogli redystrybuować wszystkie wartości równo między wszystkie obserwacje. Jeśli pięciu studentów uzyskało łącznie 430 punktów, każdy otrzymałby 86 punktów, gdybyśmy podzielili sumę równo.</p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Średnia jako Punkt Równowagi
</div>
</div>
<div class="callout-body-container callout-body">
<p>Jednym z najważniejszych sposobów pojęciowego zrozumienia średniej jest traktowanie jej jako <strong>punktu równowagi</strong> (<em>balancing point</em>) lub <strong>środka ciężkości</strong> (<em>center of gravity</em>) danych.</p>
<p>Wyobraźmy sobie umieszczenie ciężarków na huśtawce w pozycjach odpowiadających naszym wartościom danych. Średnia to punkt, w którym huśtawka byłaby idealnie wyważona.</p>
<p><strong>Matematyczny wgląd:</strong></p>
<p>Suma odchyleń od średniej zawsze równa się zeru:</p>
<p><span class="math display">\sum_{i=1}^{n} (x_i - \bar{x}) = 0</span></p>
<p>Oznacza to, że odchylenia dodatnie (wartości powyżej średniej) dokładnie znoszą odchylenia ujemne (wartości poniżej średniej).</p>
<p>Rozważmy zbiór danych <span class="math inline">X = \{1, 2, 6, 7, 9\}</span> na osi liczbowej, wyobrażając sobie go jako huśtawkę:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4336.jpg" class="img-fluid figure-img"></p>
<figcaption>https://www.gastonsanchez.com/matrix4sl/mean-as-a-balancing-point.html</figcaption>
</figure>
</div>
<p>Średnia (<span class="math inline">\mu</span>) działa jako idealny <strong>punkt równowagi</strong> tej huśtawki. Dla naszych danych:</p>
<p><span class="math inline">\mu = \frac{1 + 2 + 6 + 7 + 9}{5} = 5</span></p>
<section id="co-dzieje-się-przy-różnych-punktach-podparcia" class="level3">
<h3 class="anchored" data-anchor-id="co-dzieje-się-przy-różnych-punktach-podparcia">Co dzieje się przy różnych punktach podparcia? 🤔</h3>
<p>Przetestujmy trzy różne pozycje dla punktu oparcia (fulcrum), aby zrozumieć, dlaczego średnia jest wyjątkowa:</p>
<ol type="1">
<li><strong>Punkt podparcia w 6</strong> (za wysoko):
<ul>
<li>Wartości poniżej 6: 1, 2</li>
<li>Wartości powyżej 6: 7, 9</li>
<li><span class="math inline">\sum</span> odległości od wartości poniżej = <span class="math inline">(6-1) + (6-2) = 9</span></li>
<li><span class="math inline">\sum</span> odległości od wartości powyżej = <span class="math inline">(7-6) + (9-6) = 4</span></li>
<li>Huśtawka przechyla się w lewo! ⬅️ ponieważ <span class="math inline">9 &gt; 4</span></li>
</ul></li>
<li><strong>Punkt podparcia w 4</strong> (za nisko):
<ul>
<li>Wartości poniżej 4: 1, 2</li>
<li>Wartości powyżej 4: 6, 7, 9</li>
<li><span class="math inline">\sum</span> odległości od wartości poniżej = <span class="math inline">(4-1) + (4-2) = 5</span></li>
<li><span class="math inline">\sum</span> odległości od wartości powyżej = <span class="math inline">(6-4) + (7-4) + (9-4) = 10</span></li>
<li>Huśtawka przechyla się w prawo! ➡️ ponieważ <span class="math inline">5 &lt; 10</span></li>
</ul></li>
<li><strong>Punkt podparcia w średniej (5)</strong> (idealna równowaga):
<ul>
<li>Wartości poniżej 5: 1, 2</li>
<li>Wartości powyżej 5: 6, 7, 9</li>
<li><span class="math inline">\sum</span> odległości poniżej = <span class="math inline">(5-1) + (5-2) = 7</span></li>
<li><span class="math inline">\sum</span> odległości powyżej = <span class="math inline">(6-5) + (7-5) + (9-5) = 7</span></li>
<li><span class="math inline">7 = 7</span> ✨ Idealna równowaga!</li>
</ul></li>
</ol>
<p>To pokazuje, dlaczego średnia jest unikalnym punktem równowagi, gdzie:</p>
<p><span class="math display">\sum_{i=1}^n (x_i - \mu) = 0</span></p>
<p>Huśtawka zawsze będzie się przechylać, chyba że punkt podparcia zostanie umieszczony dokładnie w średniej! 🎪</p>
<hr>
<p>Ta wizualizacja pokazuje, jak średnia arytmetyczna (5) działa jako punkt równowagi dla naszego zbioru danych {1, 2, 6, 7, 9}:</p>
<p><strong>Lewa strona średniej:</strong></p>
<ul>
<li>Punkty o wartościach 1 i 2</li>
<li>Blisko siebie (różnica 1 jednostki)</li>
<li>Odległości od średniej: 4 i 3 jednostki</li>
<li>Suma “siły ciągnięcia” = 7 jednostek</li>
</ul>
<p><strong>Prawa strona średniej:</strong></p>
<ul>
<li>Punkty o wartościach 6, 7 i 9</li>
<li>Bardziej rozproszone (różnice 1 i 2 jednostek)</li>
<li>Odległości od średniej: 1, 2 i 4 jednostki</li>
<li>Suma “siły ciągnięcia” = 7 jednostek</li>
</ul>
<p><strong>Kluczowe obserwacje:</strong></p>
<ol type="1">
<li>Średnia (5) jest punktem równowagi, mimo że:
<ul>
<li>Po lewej stronie są tylko 2 punkty (1, 2)</li>
<li>Po prawej stronie są 3 punkty (6, 7, 9)</li>
<li>Zielone strzałki pokazują odległości od średniej</li>
</ul></li>
<li>Równowaga jest zachowana, ponieważ:
<ul>
<li>Suma odległości się równoważy: <span class="math inline">(5-1) + (5-2) = (6-5) + (7-5) + (9-5)</span></li>
<li>Całkowita suma odległości = 7 jednostek po każdej stronie</li>
<li>Liczba punktów nie ma znaczenia—liczy się tylko całkowita odległość!</li>
</ul></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Średnia Arytmetyczna Ważona
</div>
</div>
<div class="callout-body-container callout-body">
<p>W wielu sytuacjach pracujemy z <strong>rozkładami częstości</strong>, w których wartości występują wielokrotnie. Zamiast wypisywać każdą wartość osobno, możemy użyć <strong>średniej ważonej</strong>, która uwzględnia, jak często każda wartość występuje.</p>
<p><strong>Dla Częstości Bezwzględnych:</strong></p>
<p>Gdy mamy rozkład częstości z wartościami <span class="math inline">x_1, x_2, \ldots, x_k</span> występującymi odpowiednio <span class="math inline">f_1, f_2, \ldots, f_k</span> razy (gdzie <span class="math inline">n = \sum_{i=1}^{k} f_i</span>), średnia ważona wynosi:</p>
<p><span class="math display">\bar{x}_w = \frac{\sum_{i=1}^{k} f_i \cdot x_i}{\sum_{i=1}^{k} f_i} = \frac{f_1 x_1 + f_2 x_2 + \cdots + f_k x_k}{f_1 + f_2 + \cdots + f_k}</span></p>
<p>Ponieważ <span class="math inline">\sum_{i=1}^{k} f_i = n</span>, możemy to uprościć do:</p>
<p><span class="math display">\bar{x}_w = \frac{\sum_{i=1}^{k} f_i \cdot x_i}{n} = \frac{1}{n}\sum_{i=1}^{k} f_i \cdot x_i</span></p>
<p><strong>Dla Częstości Względnych (Znormalizowanych):</strong></p>
<p>Gdy częstości wyrażone są jako proporcje <span class="math inline">p_i = \frac{f_i}{n}</span> (gdzie <span class="math inline">\sum_{i=1}^{k} p_i = 1</span>), wzór upraszcza się do:</p>
<p><span class="math display">\bar{x}_w = \sum_{i=1}^{k} p_i \cdot x_i = p_1 x_1 + p_2 x_2 + \cdots + p_k x_k</span></p>
<p><strong>Przykład (Obliczenia Ręczne):</strong></p>
<p>Załóżmy, że przeprowadziliśmy ankietę wśród studentów o liczbę godzin nauki tygodniowo:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Godziny <span class="math inline">(x_i)</span></th>
<th>Częstość <span class="math inline">(f_i)</span></th>
<th>Częst. względna <span class="math inline">(p_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>3</td>
<td>0,15</td>
</tr>
<tr class="even">
<td>10</td>
<td>8</td>
<td>0,40</td>
</tr>
<tr class="odd">
<td>15</td>
<td>7</td>
<td>0,35</td>
</tr>
<tr class="even">
<td>20</td>
<td>2</td>
<td>0,10</td>
</tr>
<tr class="odd">
<td><strong>Razem</strong></td>
<td><span class="math inline">n = 20</span></td>
<td>1,00</td>
</tr>
</tbody>
</table>
<p><strong>Używając częstości bezwzględnych:</strong></p>
<p><span class="math display">\bar{x}_w = \frac{(3 \times 5) + (8 \times 10) + (7 \times 15) + (2 \times 20)}{20} = \frac{15 + 80 + 105 + 40}{20} = \frac{240}{20} = 12</span></p>
<p><strong>Używając częstości względnych:</strong></p>
<p><span class="math display">\bar{x}_w = (0,15 \times 5) + (0,40 \times 10) + (0,35 \times 15) + (0,10 \times 20)</span></p>
<p><span class="math display">= 0,75 + 4,00 + 5,25 + 2,00 = 12</span></p>
<p>Obie metody dają ten sam wynik: studenci uczą się średnio 12 godzin tygodniowo.</p>
<p><strong>Prościej mówiąc:</strong> Gdy niektóre wartości występują częściej niż inne, “ważymy” je według tego, jak często się pojawiają. Wartość, która występuje 8 razy, wnosi do średniej 8 razy więcej niż wartość, która występuje raz.</p>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Inne Rodzaje Średnich: Geometryczna i Harmoniczna
</div>
</div>
<div class="callout-body-container callout-body">
<p>Choć <strong>średnia arytmetyczna</strong> jest zdecydowanie najczęściej używaną miarą tendencji centralnej w naukach społecznych, istnieją dwa inne rodzaje średnich do specjalnych zastosowań:</p>
<p><strong>Średnia Geometryczna:</strong></p>
<p><span class="math display">\bar{x}_G = \sqrt[n]{x_1 \cdot x_2 \cdot \ldots \cdot x_n} = (x_1 \cdot x_2 \cdot \ldots \cdot x_n)^{1/n}</span></p>
<ul>
<li>Stosowana do: Stóp wzrostu, stóp zmian, uśredniania wskaźników</li>
<li>Przykład: Średnia roczna stopa wzrostu PKB w ciągu kilku lat</li>
<li>Ważne: Wszystkie wartości muszą być dodatnie</li>
</ul>
<p><strong>Średnia Harmoniczna:</strong></p>
<p><span class="math display">\bar{x}_H = \frac{n}{\frac{1}{x_1} + \frac{1}{x_2} + \cdots + \frac{1}{x_n}} = \frac{n}{\sum_{i=1}^{n} \frac{1}{x_i}}</span></p>
<ul>
<li>Stosowana do: Uśredniania wskaźników i prędkości</li>
<li>Przykład: Średnia prędkość, gdy odległości są równe, ale czasy różne</li>
<li>Ważne: Wszystkie wartości muszą być różne od zera</li>
</ul>
<p><strong>Ważna zależność:</strong> Dla dowolnego zbioru danych z wartościami dodatnimi: <span class="math inline">\bar{x}_H \leq \bar{x}_G \leq \bar{x}</span> (harmoniczna ≤ geometryczna ≤ arytmetyczna)</p>
<p>W większości zastosowań w naukach społecznych te alternatywne średnie są rzadko potrzebne. Trzymaj się średniej arytmetycznej, chyba że masz konkretny powód teoretyczny, by użyć innego rodzaju.</p>
</div>
</div>
<hr>
</section>
<section id="mediana" class="level3">
<h3 class="anchored" data-anchor-id="mediana">Mediana</h3>
<p><strong>Mediana</strong> (<em>median</em>) to wartość środkowa, gdy dane są uporządkowane. Mediana jest wartością środkową, która dzieli uporządkowane dane na dwie grupy o równej liczebności, przy czym sama mediana nie jest wliczana do żadnej z grup, gdy n jest nieparzyste.</p>
<p><strong>Stosowna dla:</strong> Danych porządkowych, interwałowych i ilorazowych (wymaga uporządkowania)</p>
<p><strong>Jak znaleźć medianę:</strong></p>
<ol type="1">
<li>Uporządkuj dane od najmniejszej do największej</li>
<li>Jeśli <span class="math inline">n</span> jest nieparzyste: mediana to wartość środkowa na pozycji <span class="math inline">\frac{n+1}{2}</span></li>
<li>Jeśli <span class="math inline">n</span> jest parzyste: mediana to średnia z dwóch wartości środkowych na pozycjach <span class="math inline">\frac{n}{2}</span> i <span class="math inline">\frac{n}{2} + 1</span></li>
</ol>
<p><strong>Przykład z nieparzystym <span class="math inline">n</span>:</strong></p>
<p>Dane: 3, 7, 8, 12, 15 (już uporządkowane, <span class="math inline">n = 5</span>)</p>
<p>Pozycja mediany: <span class="math inline">\frac{5+1}{2} = 3</span></p>
<p>Mediana = 8 (trzecia wartość)</p>
<p><strong>Przykład z parzystym <span class="math inline">n</span>:</strong></p>
<p>Dane: 3, 7, 8, 12, 15, 20 (już uporządkowane, <span class="math inline">n = 6</span>)</p>
<p>Dwie wartości środkowe są na pozycjach 3 i 4: 8 i 12</p>
<p><span class="math display">\text{Mediana} = \frac{8 + 12}{2} = 10</span></p>
<p><strong>Prostym językiem:</strong> Mediana to wartość, która znajduje się pośrodku, gdy ustawimy wszystkie obserwacje od najmniejszej do największej. Połowa obserwacji jest mniejsza od mediany, a połowa większa.</p>
<p><strong>Kluczowa zaleta:</strong> Mediana jest <strong>odporna na wartości odstające</strong> (<em>resistant to outliers</em>). Wartości ekstremalne nie wpływają na nią znacząco, co czyni ją użyteczną, gdy dane zawierają wartości odstające.</p>
</section>
<section id="moda" class="level3">
<h3 class="anchored" data-anchor-id="moda">Moda</h3>
<p><strong>Moda</strong> (<em>mode</em>) to wartość, która pojawia się najczęściej w zbiorze danych.</p>
<p><strong>Stosowna dla:</strong> Danych nominalnych, porządkowych, interwałowych i ilorazowych (wszystkie skale)</p>
<p><strong>Właściwości:</strong></p>
<ul>
<li>Zbiór danych może nie mieć mody (wszystkie wartości występują równie często)</li>
<li>Zbiór danych może mieć jedną modę (jednomodalny)</li>
<li>Zbiór danych może mieć wiele mod (dwumodalny, wielomodalny)</li>
</ul>
<p><strong>Przykład:</strong></p>
<p>Dane: 2, 3, 3, 5, 5, 5, 7, 8, 8</p>
<p>Moda = 5 (występuje trzy razy, więcej niż jakakolwiek inna wartość)</p>
<p><strong>Prostym językiem:</strong> Moda informuje nas, która wartość jest najczęstsza lub najbardziej typowa w zbiorze danych. Jest szczególnie użyteczna dla danych kategorycznych (np. “niebieski” to najczęstszy kolor oczu w próbie).</p>
</section>
<section id="porównanie-średniej-mediany-i-modalnej" class="level3">
<h3 class="anchored" data-anchor-id="porównanie-średniej-mediany-i-modalnej">Porównanie średniej, mediany i modalnej</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie rozkładów</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>left_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">2000</span>, <span class="dv">8</span>, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>symmetric <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>, <span class="dv">55</span>, <span class="dv">8</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>right_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">2000</span>, <span class="dv">2</span>, <span class="dv">8</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Funkcja do estymacji modalnej przy użyciu gęstości</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>get_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">density</span>(x)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>x[<span class="fu">which.max</span>(d<span class="sc">$</span>y)]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Układ pionowy</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Skośność lewostronna</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(left_skew, <span class="at">main =</span> <span class="st">"Rozkład lewostronnie skośny"</span>, </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">breaks =</span> <span class="dv">30</span>, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">85</span>))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(left_skew), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(left_skew), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">get_mode</span>(left_skew), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">"Średnia (%.1f)"</span>, <span class="fu">mean</span>(left_skew)),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Mediana (%.1f)"</span>, <span class="fu">median</span>(left_skew)),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Modalna (%.1f)"</span>, <span class="fu">get_mode</span>(left_skew))),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Rozkład symetryczny</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(symmetric, <span class="at">main =</span> <span class="st">"Rozkład symetryczny"</span>, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">85</span>))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(symmetric), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(symmetric), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">get_mode</span>(symmetric), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">"Średnia (%.1f)"</span>, <span class="fu">mean</span>(symmetric)),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Mediana (%.1f)"</span>, <span class="fu">median</span>(symmetric)),</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Modalna (%.1f)"</span>, <span class="fu">get_mode</span>(symmetric))),</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Skośność prawostronna</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(right_skew, <span class="at">main =</span> <span class="st">"Rozkład prawostronnie skośny"</span>, </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">85</span>))</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(right_skew), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(right_skew), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">get_mode</span>(right_skew), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">"Średnia (%.1f)"</span>, <span class="fu">mean</span>(right_skew)),</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Mediana (%.1f)"</span>, <span class="fu">median</span>(right_skew)),</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Modalna (%.1f)"</span>, <span class="fu">get_mode</span>(right_skew))),</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), </span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Kluczowe wnioski:</strong></p>
<ul>
<li>W rozkładach <strong>symetrycznych</strong> średnia ≈ mediana ≈ modalna</li>
<li>W rozkładach <strong>prawostronnie skośnych</strong> (długi ogon po prawej), średnia &gt; mediana &gt; modalna</li>
<li>W rozkładach <strong>lewostronnie skośnych</strong> (długi ogon po lewej), średnia &lt; mediana &lt; modalna</li>
</ul>
<p>Średnia jest przesuwana w kierunku ogona, mediana pozostaje w środku, a modalna znajduje się w szczycie rozkładu.</p>
</section>
</section>
<section id="miary-zmienności-rozproszenia-measures-of-dispersion-variability" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="miary-zmienności-rozproszenia-measures-of-dispersion-variability"><span class="header-section-number">6.7</span> Miary Zmienności (Rozproszenia) / Measures of Dispersion (Variability)</h2>
<p>Podczas gdy miary tendencji centralnej (<em>measures of central tendency</em>) informują nas o typowych wartościach, <strong>miary zmienności</strong> (<em>measures of dispersion/variability</em>) pokazują, jak bardzo dane są rozproszone. Dwa zbiory danych mogą mieć tę samą średnią, ale bardzo różne rozproszenie.</p>
<p><strong>Skale pomiarowe, do których stosujemy:</strong></p>
<ul>
<li><strong>Rozstęp</strong> (<em>Range</em>): Przedziałowa, Ilorazowa</li>
<li><strong>Wariancja/Odchylenie standardowe</strong> (<em>Variance/Standard Deviation</em>): Przedziałowa, Ilorazowa</li>
<li><strong>IQR</strong>: Porządkowa, Przedziałowa, Ilorazowa (wymaga uporządkowania)</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Comparison_standard_deviations.svg" class="img-fluid figure-img"></p>
<figcaption>https://commons.wikimedia.org/wiki/File:Comparison_standard_deviations.svg</figcaption>
</figure>
</div>
<section id="rozstęp-range" class="level3">
<h3 class="anchored" data-anchor-id="rozstęp-range">Rozstęp / Range</h3>
<p><strong>Rozstęp</strong> (<em>range</em>) to najprostsza miara zmienności: różnica między wartością maksymalną i minimalną.</p>
<p><strong>Stosuje się do:</strong> Danych przedziałowych i ilorazowych</p>
<p><span class="math display">\text{Rozstęp} = \max(x) - \min(x)</span></p>
<p><strong>Przykład:</strong></p>
<p>Zbiór A: 10, 12, 15, 18, 20 → Rozstęp = 20 - 10 = 10</p>
<p>Zbiór B: 10, 15, 15, 15, 20 → Rozstęp = 20 - 10 = 10</p>
<p><strong>Prostym językiem:</strong> Rozstęp mówi nam o zakresie od najmniejszej do największej obserwacji. Daje szybkie wyobrażenie o rozproszeniu, ale jest bardzo wrażliwy na wartości odstające (<em>outliers</em>) (ponieważ wykorzystuje tylko dwie wartości).</p>
<hr>
</section>
<section id="wariancja-i-odchylenie-standardowe" class="level3">
<h3 class="anchored" data-anchor-id="wariancja-i-odchylenie-standardowe">Wariancja i odchylenie standardowe</h3>
<section id="wizualizacja-zmienności-przykład-roboczy" class="level4">
<h4 class="anchored" data-anchor-id="wizualizacja-zmienności-przykład-roboczy">Wizualizacja zmienności: przykład roboczy</h4>
<p>Aby zrozumieć wariancję i odchylenie standardowe, przeanalizujmy kompletny przykład z danymi <span class="math inline">X = (2, 2, 3, 4, 5, 5)</span>. Potraktujemy je jako sekwencyjne obserwacje (np. pomiary w czasie), aby zwizualizować, jak poszczególne wartości odchylają się od swojej średniej.</p>
<section id="krok-1-oblicz-średnią" class="level5">
<h5 class="anchored" data-anchor-id="krok-1-oblicz-średnią">Krok 1: Oblicz średnią</h5>
<p><span class="math display">\bar{x} = \frac{2 + 2 + 3 + 4 + 5 + 5}{6} = \frac{21}{6} = 3.5</span></p>
</section>
<section id="krok-2-wizualizacja-odchyleń-od-średniej" class="level5">
<h5 class="anchored" data-anchor-id="krok-2-wizualizacja-odchyleń-od-średniej">Krok 2: Wizualizacja odchyleń od średniej</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mean_X <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Obserwacja"</span>, <span class="at">ylab =</span> <span class="st">"Wartość"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Odchylenia od średniej"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> mean_X, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, mean_X <span class="sc">+</span> <span class="fl">0.3</span>, <span class="fu">paste</span>(<span class="st">"Średnia ="</span>, mean_X), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodaj linie odchyleń</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)) {</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(i, mean_X, i, X[i], <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>Szare przerywane linie pokazują <strong>odchylenia</strong> od średniej. Wariancja będzie kwantyfikować średnią kwadratową długość tych odchyleń.</p>
</section>
</section>
<section id="dlaczego-podnosimy-odchylenia-do-kwadratu" class="level4">
<h4 class="anchored" data-anchor-id="dlaczego-podnosimy-odchylenia-do-kwadratu">Dlaczego podnosimy odchylenia do kwadratu?</h4>
<p>Dlaczego nie uśrednić po prostu odchyleń <span class="math inline">(x_i - \bar{x})</span> bezpośrednio?</p>
<p><strong>Problem:</strong> Jeśli po prostu uśrednimy odchylenia, zawsze będą one sumować się do zera (jak widzieliśmy przy właściwości punktu równowagi). Sprawdźmy to na naszym przykładzie:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>-1.5</td>
</tr>
<tr class="even">
<td>2</td>
<td>-1.5</td>
</tr>
<tr class="odd">
<td>3</td>
<td>-0.5</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.5</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1.5</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>Dzieje się tak, ponieważ odchylenia dodatnie (powyżej średniej) dokładnie znoszą odchylenia ujemne (poniżej średniej):</p>
<p><span class="math display">\sum_{i=1}^{n}(x_i - \bar{x}) = 0</span></p>
<p><strong>Rozwiązania tego problemu:</strong></p>
<ol type="1">
<li><strong>Podnieść odchylenia do kwadratu</strong> (podejście wariancji): <span class="math inline">(x_i - \bar{x})^2</span> sprawia, że wszystkie wartości są dodatnie</li>
<li><strong>Wziąć wartości bezwzględne</strong> (alternatywne podejście): <span class="math inline">|x_i - \bar{x}|</span> również sprawia, że wszystkie wartości są dodatnie</li>
</ol>
<p><strong>Dlaczego podnoszenie do kwadratu jest preferowane:</strong></p>
<ul>
<li><strong>Wygoda matematyczna:</strong> Podnoszenie do kwadratu ma lepsze właściwości matematyczne dla teorii statystyki</li>
<li><strong>Podkreśla większe odchylenia:</strong> Podnoszenie do kwadratu nadaje większą wagę ekstremalnym odchyleniom (punkt oddalony o 10 jednostek wnosi 100 do wariancji, podczas gdy punkt oddalony o 5 jednostek wnosi tylko 25)</li>
</ul>
<p><strong>Problem jednostek:</strong> Ponieważ podnieśliśmy odchylenia do kwadratu, wariancja jest w <strong>jednostkach kwadratowych</strong>. Jeśli nasze dane są w centymetrach, wariancja jest w centymetrach kwadratowych. Dlatego często wolimy odchylenie standardowe.</p>
</section>
<section id="wariancja" class="level4">
<h4 class="anchored" data-anchor-id="wariancja">Wariancja</h4>
<p><strong>Wariancja</strong> mierzy średnie kwadratowe odchylenie od średniej. Kwantyfikuje, jak daleko przeciętnie każda obserwacja znajduje się od średniej.</p>
<p><strong>Zastosowanie:</strong> Dane interwałowe i ilorazowe</p>
<section id="obliczenia-ręczne-wariancja-populacji-vs.-wariancja-próby" class="level5">
<h5 class="anchored" data-anchor-id="obliczenia-ręczne-wariancja-populacji-vs.-wariancja-próby">Obliczenia ręczne: wariancja populacji vs.&nbsp;wariancja próby</h5>
<p>Kontynuujmy nasz przykład <span class="math inline">X = (2, 2, 3, 4, 5, 5)</span> i obliczmy odchylenia kwadratowe:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>-1.5</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>2</td>
<td>-1.5</td>
<td>2.25</td>
</tr>
<tr class="odd">
<td>3</td>
<td>-0.5</td>
<td>0.25</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1.5</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.5</td>
<td>2.25</td>
</tr>
<tr class="odd">
<td>Suma</td>
<td></td>
<td>9.5</td>
</tr>
</tbody>
</table>
<p><strong>Wariancja populacji</strong> (gdyby to była cała populacja):</p>
<p><span class="math display">\sigma^2 = \frac{\sum_{i=1}^{n}(x_i - \bar{x})^2}{n} = \frac{9.5}{6} \approx 1.583</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wariancja populacji (bez korekty Bessela)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>var_pop <span class="ot">&lt;-</span> <span class="fu">sum</span>((X <span class="sc">-</span> mean_X)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(X)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja populacji:"</span>, var_pop, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja populacji: 1.583 </code></pre>
</div>
</div>
</section>
<section id="korekta-bessela-dlaczego-n-1" class="level5">
<h5 class="anchored" data-anchor-id="korekta-bessela-dlaczego-n-1">Korekta Bessela: Dlaczego <span class="math inline">n-1</span>?</h5>
<p><strong>Problem:</strong> Kiedy używamy danych z próby do oszacowania wariancji populacji, wzór <span class="math inline">\frac{\sum(x_i - \bar{x})^2}{n}</span> ma tendencję do <strong>niedoszacowywania</strong> prawdziwej wariancji populacji. Dzieje się tak, ponieważ <span class="math inline">\bar{x}</span> jest obliczane z tych samych danych, przez co odchylenia są sztucznie mniejsze (mierzymy odchylenia od średniej próby, a nie od prawdziwej średniej populacji).</p>
<p><strong>Rozwiązanie:</strong> Korekta Bessela koryguje to obciążenie poprzez dzielenie przez <span class="math inline">n-1</span> zamiast przez <span class="math inline">n</span>. Daje to nieobciążony estymator wariancji populacji.</p>
<p><strong>Wzór na wariancję próby:</strong></p>
<p><span class="math display">s^2 = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<p><strong>Dla naszego przykładu:</strong></p>
<p><span class="math display">s^2 = \frac{9.5}{5} = 1.9</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wariancja próby (z korektą Bessela)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uwaga: funkcja var() w R używa n-1 domyślnie</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>var_sample <span class="ot">&lt;-</span> <span class="fu">var</span>(X)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja próby:"</span>, var_sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja próby: 1.9 </code></pre>
</div>
</div>
<p><strong>Kluczowa różnica:</strong> Wariancja próby (1.9) jest większa niż wariancja populacji (1.583), zapewniając nieobciążony estymator przy pracy z danymi z próby.</p>
<p><strong>Prościej mówiąc:</strong> Wariancja mówi nam, jak daleko przeciętnie (w sensie kwadratowym) każda obserwacja znajduje się od średniej. Większa wariancja oznacza bardziej rozproszone dane; mniejsza wariancja oznacza, że dane skupiają się bardziej wokół średniej.</p>
<p><strong>Uwaga:</strong> We wszystkich dalszych przykładach będziemy używać korekty Bessela (dzielenie przez <span class="math inline">n-1</span>) do obliczania wariancji próby, ponieważ jest to standardowe podejście w statystyce inferencyjnej i odpowiada domyślnemu zachowaniu funkcji <code>var()</code> i <code>sd()</code> w R.</p>
</section>
</section>
<section id="odchylenie-standardowe" class="level4">
<h4 class="anchored" data-anchor-id="odchylenie-standardowe">Odchylenie standardowe</h4>
<p><strong>Odchylenie standardowe</strong> to po prostu pierwiastek kwadratowy z wariancji. Zwraca nas do oryginalnych jednostek pomiaru.</p>
<p><strong>Zastosowanie:</strong> Dane interwałowe i ilorazowe</p>
<section id="wzór" class="level5">
<h5 class="anchored" data-anchor-id="wzór">Wzór</h5>
<p><span class="math display">s = \sqrt{s^2} = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2}</span></p>
</section>
<section id="obliczenia-dla-naszego-przykładu" class="level5">
<h5 class="anchored" data-anchor-id="obliczenia-dla-naszego-przykładu">Obliczenia dla naszego przykładu</h5>
<p><strong>Dla naszego przykładu</strong> <span class="math inline">X = (2, 2, 3, 4, 5, 5)</span>:</p>
<p><span class="math display">s = \sqrt{1.9} \approx 1.378</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Odchylenie standardowe</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Uwaga: funkcja sd() w R używa n-1 domyślnie</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sd_sample <span class="ot">&lt;-</span> <span class="fu">sd</span>(X)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odchylenie standardowe próby:"</span>, sd_sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odchylenie standardowe próby: 1.378 </code></pre>
</div>
</div>
<p><strong>Prościej mówiąc:</strong> Odchylenie standardowe mówi nam o typowej odległości obserwacji od średniej, w oryginalnych jednostkach pomiaru. Jest bardziej interpretowalny niż wariancja, ponieważ jest w tych samych jednostkach co dane.</p>
<p><strong>Uwaga</strong> W wielu rozkładach (szczególnie symetrycznych, dzwonowatych rozkładach takich jak rozkład normalny), około 68% obserwacji mieści się w obrębie jednego odchylenia standardowego od średniej, a około 95% w obrębie dwóch odchyleń standardowych.</p>
<p>Dla naszego przykładu z <span class="math inline">\bar{x} = 3.5</span> i <span class="math inline">s \approx 1.378</span>:</p>
<ul>
<li>Jedno OS poniżej średniej: <span class="math inline">3.5 - 1.378 = 2.122</span></li>
<li>Jedno OS powyżej średniej: <span class="math inline">3.5 + 1.378 = 4.878</span></li>
<li>Wartości w tym zakresie: 2, 2, 3, 4 (4 z 6 = 67%)</li>
</ul>
</section>
</section>
<section id="przykład-do-ćwiczenia" class="level4">
<h4 class="anchored" data-anchor-id="przykład-do-ćwiczenia">Przykład do ćwiczenia</h4>
<p>Przeanalizujmy kolejny kompletny przykład, aby utrwalić te koncepcje.</p>
<p><strong>Dane:</strong> 2, 4, 6, 8, 10</p>
<p><strong>Krok 1:</strong> Oblicz średnią:</p>
<p><span class="math display">\bar{x} = \frac{2+4+6+8+10}{5} = \frac{30}{5} = 6</span></p>
<p><strong>Krok 2:</strong> Oblicz odchylenia i odchylenia kwadratowe:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>-4</td>
<td>16</td>
</tr>
<tr class="even">
<td>4</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>8</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>10</td>
<td>4</td>
<td>16</td>
</tr>
<tr class="even">
<td>Suma</td>
<td>0</td>
<td>40</td>
</tr>
</tbody>
</table>
<p><strong>Krok 3:</strong> Oblicz wariancję z próby:</p>
<p><span class="math display">s^2 = \frac{40}{5-1} = \frac{40}{4} = 10</span></p>
<p><strong>Krok 4:</strong> Oblicz odchylenie standardowe:</p>
<p><span class="math display">s = \sqrt{10} \approx 3.162</span></p>
<p><strong>Weryfikacja w R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Średnia:"</span>, <span class="fu">mean</span>(X2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Średnia: 6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Wariancja próby:"</span>, <span class="fu">var</span>(X2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wariancja próby: 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Odchylenie standardowe próby:"</span>, <span class="fu">sd</span>(X2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Odchylenie standardowe próby: 3.162 </code></pre>
</div>
</div>
<p><strong>Zauważ:</strong> Ten zbiór danych ma większą wariancję (10 vs.&nbsp;1.9) i odchylenie standardowe (3.16 vs.&nbsp;1.38) niż nasz pierwszy przykład, co odzwierciedla fakt, że wartości są bardziej rozproszone wokół swojej średniej.</p>
<hr>
</section>
</section>
<section id="rozstęp-międzykwartylowy-iqr" class="level3">
<h3 class="anchored" data-anchor-id="rozstęp-międzykwartylowy-iqr">Rozstęp międzykwartylowy (IQR)</h3>
<p><strong>Rozstęp międzykwartylowy</strong> (<em>interquartile range, IQR</em>) mierzy rozrzut środkowych 50% danych. Oblicza się go jako:</p>
<p><strong>Stosowny dla:</strong> Danych porządkowych, interwałowych i ilorazowych (wymaga uporządkowania)</p>
<p><span class="math display">\text{IQR} = Q_3 - Q_1</span></p>
<p>gdzie <span class="math inline">Q_1</span> to pierwszy kwartyl (25. percentyl), a <span class="math inline">Q_3</span> to trzeci kwartyl (75. percentyl).</p>
<p><strong>Prostym językiem:</strong> IQR informuje nas o zakresie, który zawiera środkową połowę naszych danych. Jest odporny na wartości odstające, co czyni go użytecznym, gdy obecne są wartości ekstremalne.</p>
<p><strong>Przykład:</strong></p>
<p>Dane: 2, 4, 5, 7, 8, 11, 12, 15, 18, 20</p>
<ul>
<li><span class="math inline">Q_1 = 5</span> (25% danych znajduje się poniżej 5)</li>
<li><span class="math inline">Q_3 = 15</span> (75% danych znajduje się poniżej 15)</li>
<li><span class="math inline">\text{IQR} = 15 - 5 = 10</span></li>
</ul>
<p>Środkowe 50% obserwacji rozciąga się na 10 jednostek.</p>
</section>
</section>
<section id="miary-pozycji-względnej" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="miary-pozycji-względnej"><span class="header-section-number">6.8</span> Miary pozycji względnej</h2>
<p>Miary pozycji względnej pomagają nam zrozumieć, gdzie dana obserwacja znajduje się w całym rozkładzie. Te miary odpowiadają na pytania typu “Jak ta wartość wypada w porównaniu z innymi w zbiorze danych?”</p>
<p><strong>Stosowne skale pomiarowe:</strong></p>
<ul>
<li><strong>Kwantyle/Percentyle/Kwartyle:</strong> Porządkowa, Interwałowa, Ilorazowa (wymaga uporządkowania)</li>
</ul>
<section id="kwantyle" class="level3">
<h3 class="anchored" data-anchor-id="kwantyle">Kwantyle</h3>
<p><strong>Kwantyl</strong> (<em>quantile</em>) to wartość, która dzieli zbiór danych na grupy równej wielkości. Bardziej formalnie, <span class="math inline">p</span>-ty kwantyl to wartość, poniżej której znajduje się proporcja <span class="math inline">p</span> danych.</p>
<p><strong>Stosowny dla:</strong> Danych porządkowych, interwałowych i ilorazowych</p>
<p><strong>Definicja:</strong></p>
<p>Dla proporcji <span class="math inline">p</span> (gdzie <span class="math inline">0 &lt; p &lt; 1</span>), <span class="math inline">p</span>-ty kwantyl <span class="math inline">q_p</span> spełnia:</p>
<ul>
<li>Co najmniej proporcja <span class="math inline">p</span> obserwacji jest mniejsza lub równa <span class="math inline">q_p</span></li>
<li>Co najmniej proporcja <span class="math inline">(1-p)</span> obserwacji jest większa lub równa <span class="math inline">q_p</span></li>
</ul>
<p><strong>Prostym językiem:</strong> Kwantyle to “punkty odcięcia”, które dzielą nasze uporządkowane dane na segmenty. Informują nas o wartości, poniżej której znajduje się określona proporcja naszych danych.</p>
<p><strong>Ważna uwaga:</strong> Kwantyle to <strong>pojęcie ogólne</strong>. Percentyle, kwartyle i mediana to wszystko konkretne typy kwantyli.</p>
<p><strong>Przykłady kwantyli:</strong></p>
<ul>
<li>0,5 kwantyl (50. percentyl) to <strong>mediana</strong> - połowa danych znajduje się poniżej niej</li>
<li>0,25 kwantyl (25. percentyl) to <strong>pierwszy kwartyl</strong> (<span class="math inline">Q_1</span>)</li>
<li>0,75 kwantyl (75. percentyl) to <strong>trzeci kwartyl</strong> (<span class="math inline">Q_3</span>)</li>
<li>0,90 kwantyl (90. percentyl) oznacza, że 90% danych znajduje się poniżej tej wartości</li>
</ul>
</section>
<section id="percentyle" class="level3">
<h3 class="anchored" data-anchor-id="percentyle">Percentyle</h3>
<p><strong>Percentyl</strong> (<em>percentile</em>) to konkretny typ kwantyla, który dzieli dane na 100 równych części. <span class="math inline">k</span>-ty percentyl to wartość, poniżej której znajduje się <span class="math inline">k</span> procent obserwacji.</p>
<p><strong>Stosowny dla:</strong> Danych porządkowych, interwałowych i ilorazowych</p>
<p><strong>Związek z kwantylami:</strong></p>
<p><span class="math inline">k</span>-ty percentyl odpowiada <span class="math inline">\frac{k}{100}</span> kwantylowi. Na przykład:</p>
<ul>
<li><ol start="25" type="1">
<li>percentyl = 0,25 kwantyl</li>
</ol></li>
<li><ol start="50" type="1">
<li>percentyl = 0,50 kwantyl = mediana</li>
</ol></li>
<li><ol start="90" type="1">
<li>percentyl = 0,90 kwantyl</li>
</ol></li>
</ul>
<p><strong>Przykłady:</strong></p>
<ul>
<li><strong>50. percentyl</strong> to mediana (50% danych znajduje się poniżej niej)</li>
<li><strong>90. percentyl</strong> oznacza, że 90% obserwacji znajduje się poniżej tej wartości</li>
<li><strong>10. percentyl</strong> oznacza, że tylko 10% obserwacji znajduje się poniżej tej wartości</li>
</ul>
<p><strong>Interpretacja:</strong> Jeśli zdobyłeś 85. percentyl w teście, poradziłeś sobie lepiej niż 85% zdających.</p>
</section>
<section id="kwartyle" class="level3">
<h3 class="anchored" data-anchor-id="kwartyle">Kwartyle</h3>
<p><strong>Kwartyle</strong> (<em>quartiles</em>) to konkretne kwantyle, które dzielą dane na cztery równe części. Są to 25., 50. i 75. percentyle:</p>
<p><strong>Stosowne dla:</strong> Danych porządkowych, interwałowych i ilorazowych</p>
<ul>
<li><span class="math inline">Q_1</span> (Pierwszy kwartyl lub 25. percentyl): 25% danych znajduje się poniżej tej wartości</li>
<li><span class="math inline">Q_2</span> (Drugi kwartyl lub 50. percentyl): Mediana - 50% znajduje się poniżej</li>
<li><span class="math inline">Q_3</span> (Trzeci kwartyl lub 75. percentyl): 75% danych znajduje się poniżej tej wartości</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4327.jpg" class="img-fluid figure-img"></p>
<figcaption>Doane, D. P., &amp; Seward, L. W. (2016). Applied statistics in business and economics. Mcgraw-Hill.</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizacja kwartyli</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>example_data <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">10</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, example_data, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"gray40"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Obserwacja (uporządkowana)"</span>, <span class="at">ylab =</span> <span class="st">"Wartość"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Kwartyle dzielą dane na cztery równe części"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodaj linie kwartyli</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Dodaj zacienione regiony</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">min</span>(example_data), <span class="dv">101</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), <span class="dv">101</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), <span class="dv">101</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), <span class="dv">101</span>, <span class="fu">max</span>(example_data), </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Etykiety</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">95</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), <span class="st">"Q1 (25%)"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">95</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), <span class="st">"Q2 (50%)"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">95</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), <span class="st">"Q3 (75%)"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Każdy region zawiera 25% obserwacji"</span>),</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">1.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="obliczanie-kwartyli-metoda-tukeya" class="level3">
<h3 class="anchored" data-anchor-id="obliczanie-kwartyli-metoda-tukeya">Obliczanie kwartyli: metoda Tukeya</h3>
<p>Istnieje kilka metod obliczania kwartyli. W tym kursie używamy <strong>metody Tukeya</strong> (<em>Tukey method</em>, zwanej również metodą zawiasów, <em>hinges method</em>):</p>
<p><strong>Kroki:</strong></p>
<ol type="1">
<li>Znajdź medianę całego zbioru danych</li>
<li><strong>Wyklucz medianę</strong>, jeśli <span class="math inline">n</span> jest nieparzyste</li>
<li><span class="math inline">Q_1</span> = mediana dolnej połowy</li>
<li><span class="math inline">Q_3</span> = mediana górnej połowy</li>
</ol>
<p><strong>Przykład z parzystym <span class="math inline">n</span>:</strong></p>
<p>Dane: 2, 4, 5, 7, 8, 10, 12, 15 (<span class="math inline">n = 8</span>)</p>
<p>Pozycja mediany: między pozycjami 4 i 5 → Mediana = <span class="math inline">\frac{7+8}{2} = 7.5</span></p>
<p>Dolna połowa: 2, 4, 5, 7 → <span class="math inline">Q_1 = \frac{4+5}{2} = 4.5</span></p>
<p>Górna połowa: 8, 10, 12, 15 → <span class="math inline">Q_3 = \frac{10+12}{2} = 11</span></p>
<p><strong>Przykład z nieparzystym <span class="math inline">n</span>:</strong></p>
<p>Dane: 2, 4, 5, 7, 8, 10, 12, 15, 18 (<span class="math inline">n = 9</span>)</p>
<p>Mediana: 8 (pozycja 5)</p>
<p>Dolna połowa (z wyłączeniem mediany): 2, 4, 5, 7 → <span class="math inline">Q_1 = \frac{4+5}{2} = 4.5</span></p>
<p>Górna połowa (z wyłączeniem mediany): 10, 12, 15, 18 → <span class="math inline">Q_3 = \frac{12+15}{2} = 13.5</span></p>
<p><strong>Uwaga:</strong> Funkcja R <code>quantile()</code> ma wiele metod. Metoda Tukeya odpowiada <code>type = 2</code>, podczas gdy domyślną w R jest <code>type = 7</code>.</p>
<hr>
</section>
</section>
<section id="miary-kształtu" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="miary-kształtu"><span class="header-section-number">6.9</span> Miary kształtu</h2>
<p>Miary kształtu opisują ogólną formę lub wzorzec rozkładu. Chociaż zazwyczaj oceniamy kształt wizualnie za pomocą histogramów i wykresów pudełkowych, ważne jest zrozumienie kluczowych koncepcji.</p>
<section id="skośność-asymetria" class="level3">
<h3 class="anchored" data-anchor-id="skośność-asymetria">Skośność (asymetria)</h3>
<p><strong>Skośność</strong> odnosi się do asymetrii rozkładu. Informuje nas, czy rozkład ma dłuższy ogon po jednej stronie.</p>
<p><strong>Rodzaje skośności:</strong></p>
<ul>
<li><strong>Symetryczny (brak skośności):</strong> Rozkład wygląda tak samo po obu stronach centrum. Średnia ≈ Mediana.</li>
<li><strong>Prawostronnie skośny (skośność dodatnia):</strong> Długi ogon rozciąga się w prawo. Średnia &gt; Mediana. Większość wartości skupia się po lewej stronie, a kilka dużych wartości rozciąga ogon.</li>
<li><strong>Lewostronnie skośny (skośność ujemna):</strong> Długi ogon rozciąga się w lewo. Średnia &lt; Mediana. Większość wartości skupia się po prawej stronie, a kilka małych wartości rozciąga ogon.</li>
</ul>
<p><strong>Prostym językiem:</strong> Skośność mówi nam, w którą stronę “wskazuje” ogon. Rozkłady dochodów są zazwyczaj prawostronnie skośne (większość ludzi zarabia umiarkowane dochody, ale kilka osób zarabia ekstremalnie wysokie dochody). Wyniki testów z łatwego egzaminu mogą być lewostronnie skośne (większość studentów osiąga wysokie wyniki, ale kilku osiąga bardzo niskie).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie rozkładów</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>left_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">8000</span>, <span class="dv">8</span>, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>symmetric <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">8000</span>, <span class="dv">55</span>, <span class="dv">8</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>right_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">8000</span>, <span class="dv">2</span>, <span class="dv">8</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>df_skew <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(left_skew, symmetric, right_skew),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Lewostronnie skośny"</span>, <span class="st">"Symetryczny"</span>, <span class="st">"Prawostronnie skośny"</span>), <span class="at">each =</span> <span class="dv">8000</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Obliczanie statystyk dla każdego rozkładu</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>stats_skew <span class="ot">&lt;-</span> df_skew <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_val =</span> <span class="fu">mean</span>(value),</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_val =</span> <span class="fu">median</span>(value),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode_val =</span> {</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>      d <span class="ot">&lt;-</span> <span class="fu">density</span>(value)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>      d<span class="sc">$</span>x[<span class="fu">which.max</span>(d<span class="sc">$</span>y)]</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Zmiana kolejności poziomów czynnika dla właściwego wyświetlania</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>df_skew<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_skew<span class="sc">$</span>type, </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Lewostronnie skośny"</span>, <span class="st">"Symetryczny"</span>, <span class="st">"Prawostronnie skośny"</span>))</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>stats_skew<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(stats_skew<span class="sc">$</span>type, </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Lewostronnie skośny"</span>, <span class="st">"Symetryczny"</span>, <span class="st">"Prawostronnie skośny"</span>))</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_skew, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> type), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> stats_skew, <span class="fu">aes</span>(<span class="at">xintercept =</span> mean_val), </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> stats_skew, <span class="fu">aes</span>(<span class="at">xintercept =</span> median_val), </span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> stats_skew, <span class="fu">aes</span>(<span class="at">xintercept =</span> mode_val), </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Lewostronnie skośny"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, </span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Symetryczny"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, </span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Prawostronnie skośny"</span> <span class="ot">=</span> <span class="st">"#FFFFE0"</span>)) <span class="sc">+</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>, </span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Porównanie skośności: Średnia, mediana i modalna"</span>) <span class="sc">+</span></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> stats_skew, </span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">75</span>, <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Średnia: %.1f</span><span class="sc">\n</span><span class="st">Mediana: %.1f</span><span class="sc">\n</span><span class="st">Modalna: %.1f"</span>, </span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>                               mean_val, median_val, mode_val)),</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.5</span>, </span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Kluczowe wnioski:</strong></p>
<ul>
<li>W rozkładach <strong>symetrycznych</strong> średnia ≈ mediana ≈ modalna</li>
<li>W rozkładach <strong>prawostronnie skośnych</strong> (długi ogon po prawej), średnia &gt; mediana &gt; modalna</li>
<li>W rozkładach <strong>lewostronnie skośnych</strong> (długi ogon po lewej), średnia &lt; mediana &lt; modalna</li>
</ul>
<p>Średnia jest przesuwana w kierunku ogona, mediana pozostaje w środku, a modalna znajduje się w szczycie rozkładu.</p>
</section>
<section id="kurtoza-grubość-ogonów-rozkładu" class="level3">
<h3 class="anchored" data-anchor-id="kurtoza-grubość-ogonów-rozkładu">Kurtoza (grubość “ogonów” rozkładu)</h3>
<p><strong>Kurtoza</strong> odnosi się do tego, czy rozkład ma ciężkie ogony (wiele wartości ekstremalnych) czy lekkie ogony (niewiele wartości ekstremalnych) w porównaniu z rozkładem normalnym.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/kurtosis-1.svg" class="img-fluid figure-img"></p>
<figcaption>https://learningstatisticswithcogstat.com/exploringavariable.html</figcaption>
</figure>
</div>
<p><strong>Rodzaje:</strong></p>
<ul>
<li><strong>Wysoka kurtoza:</strong> Ciężkie ogony z wieloma wartościami odstającymi; ostry szczyt w centrum</li>
<li><strong>Niska kurtoza:</strong> Lekkie ogony z niewieloma wartościami odstającymi; bardziej spłaszczony szczyt</li>
</ul>
<p><strong>Prostym językiem:</strong> Kurtoza mówi nam, czy wartości ekstremalne są częste czy rzadkie w naszych danych. Zwroty finansowe często mają wysoką kurtozę - większość dni przynosi małe zmiany, ale okazjonalnie występują bardzo duże ruchy (krachy lub wzrosty na rynku).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generowanie rozkładów o różnej kurtozie</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Niska kurtoza (podobny do jednostajnego)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>low_kurt <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2000</span>, <span class="dv">40</span>, <span class="dv">70</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalna kurtoza</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>normal_kurt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>, <span class="dv">55</span>, <span class="dv">8</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Wysoka kurtoza (ciężkie ogony)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>high_kurt <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">2000</span>, <span class="at">df =</span> <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">8</span> <span class="sc">+</span> <span class="dv">55</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie ramki danych</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>df_kurt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(low_kurt, normal_kurt, high_kurt),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Niska kurtoza</span><span class="sc">\n</span><span class="st">(Lekkie ogony)"</span>, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Normalna kurtoza"</span>, </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Wysoka kurtoza</span><span class="sc">\n</span><span class="st">(Ciężkie ogony)"</span>), <span class="at">each =</span> <span class="dv">2000</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Zmiana kolejności poziomów czynnika</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>df_kurt<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_kurt<span class="sc">$</span>type, </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Niska kurtoza</span><span class="sc">\n</span><span class="st">(Lekkie ogony)"</span>, </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Normalna kurtoza"</span>, </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Wysoka kurtoza</span><span class="sc">\n</span><span class="st">(Ciężkie ogony)"</span>))</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Tworzenie wykresu</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_kurt, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> type), <span class="at">bins =</span> <span class="dv">40</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Niska kurtoza</span><span class="sc">\n</span><span class="st">(Lekkie ogony)"</span> <span class="ot">=</span> <span class="st">"#FFB6C1"</span>, </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Normalna kurtoza"</span> <span class="ot">=</span> <span class="st">"#98FB98"</span>, </span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Wysoka kurtoza</span><span class="sc">\n</span><span class="st">(Ciężkie ogony)"</span> <span class="ot">=</span> <span class="st">"#FFD700"</span>)) <span class="sc">+</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wartość"</span>, <span class="at">y =</span> <span class="st">"Liczebność"</span>, </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Porównanie kurtozy: Zachowanie ogonów"</span>) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Kluczowe wnioski:</strong></p>
<ul>
<li>Rozkłady o <strong>niskiej kurtozie</strong> mają mniej wartości ekstremalnych i bardziej spłaszczony szczyt</li>
<li>Rozkłady o <strong>wysokiej kurtozie</strong> mają więcej wartości ekstremalnych (ciężkie ogony) i ostrzejszy szczyt</li>
<li>Rozkład normalny służy jako punkt odniesienia dla porównań kurtozy</li>
</ul>
<hr>
</section>
<section id="modalność-liczba-dominant" class="level3">
<h3 class="anchored" data-anchor-id="modalność-liczba-dominant">Modalność (liczba dominant)</h3>
<p><strong>Modalność</strong> (<em>modality</em>) odnosi się do liczby wyraźnych szczytów lub “mod” w rozkładzie.</p>
<p><strong>Typy:</strong></p>
<ul>
<li><strong>Jednomodalny</strong> (<em>unimodal</em>): Jeden wyraźny szczyt</li>
<li><strong>Dwumodalny</strong> (<em>bimodal</em>): Dwa wyraźne szczyty</li>
<li><strong>Wielomodalny</strong> (<em>multimodal</em>): Trzy lub więcej szczytów</li>
<li><strong>Jednostajny</strong> (<em>uniform</em>): Brak szczytów; wszystkie wartości mniej więcej równie powszechne</li>
</ul>
<p><strong>Prostym językiem:</strong> Liczba szczytów może ujawnić ważne cechy danych. Rozkład dwumodalny może wskazywać dwie odrębne podgrupy (np. wzrost dorosłych może pokazywać szczyty dla mężczyzn i kobiet).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wizualizuj różne kształty</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Jednomodalny symetryczny</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>symmetric_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(symmetric_data, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Jednomodalny symetryczny"</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(symmetric_data), <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Skośny w prawo</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>skewed_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>) <span class="sc">+</span> <span class="dv">20</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(skewed_data, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Skośny w prawo (jednomodalny)"</span>, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(skewed_data), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Dwumodalny</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>bimodal_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">30</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">60</span>, <span class="dv">5</span>))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bimodal_data, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Dwumodalny"</span>, </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(bimodal_data), <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Ocena wizualna:</strong> Cechy kształtu identyfikujemy głównie przez:</p>
<ul>
<li><strong>Histogramy:</strong> Pokazują ogólną formę, liczbę szczytów i kierunek skośności</li>
<li><strong>Wykresy pudełkowe:</strong> Ujawniają skośność przez długość wąsów i pozycję mediany</li>
<li><strong>Wykresy gęstości:</strong> Gładkie krzywe, które podkreślają ogólny wzorzec</li>
</ul>
<hr>
</section>
</section>
<section id="wizualizacja-histogramy-visualization-histograms" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="wizualizacja-histogramy-visualization-histograms"><span class="header-section-number">6.10</span> Wizualizacja: Histogramy / Visualization: Histograms</h2>
<p><strong>Histogram</strong> wyświetla rozkład częstości (<em>frequency distribution</em>) danych liczbowych poprzez podzielenie zakresu na przedziały (<em>bins</em>) i pokazanie liczby lub proporcji obserwacji w każdym przedziale.</p>
<section id="konstrukcja-histogramu" class="level3">
<h3 class="anchored" data-anchor-id="konstrukcja-histogramu">Konstrukcja Histogramu</h3>
<p><strong>Kluczowe decyzje:</strong></p>
<ol type="1">
<li><strong>Liczba przedziałów:</strong> Zbyt mało przedziałów traci szczegóły; zbyt wiele przedziałów tworzy szum</li>
<li><strong>Granice przedziałów:</strong> Czy przedziały powinny być <span class="math inline">[a, b)</span> (zamknięte z lewej, otwarte z prawej) czy <span class="math inline">(a, b]</span> (otwarte z lewej, zamknięte z prawej)?</li>
<li><strong>Skala osi Y:</strong> Częstości (<em>frequency</em>), częstości względne (<em>relative frequency</em>) czy gęstość (<em>density</em>)?</li>
</ol>
</section>
<section id="wybór-optymalnej-liczby-przedziałów" class="level3">
<h3 class="anchored" data-anchor-id="wybór-optymalnej-liczby-przedziałów">Wybór Optymalnej Liczby Przedziałów</h3>
<p>Kilka reguł pomaga określić odpowiednią liczbę przedziałów:</p>
<p><strong>1. Reguła Sturgesa</strong> (<em>Sturges’ Rule</em>) <strong>(domyślna w R):</strong></p>
<p><span class="math display">k = \lceil \log_2(n) + 1 \rceil</span></p>
<p>gdzie <span class="math inline">n</span> to liczebność próby. Działa dobrze dla rozkładów symetrycznych i jednomodalnych.</p>
<p><strong>2. Reguła Scotta</strong> (<em>Scott’s Rule</em>)<strong>:</strong></p>
<p><span class="math display">\text{Szerokość przedziału} = \frac{3.5 \cdot s}{n^{1/3}}</span></p>
<p>gdzie <span class="math inline">s</span> to odchylenie standardowe próby. Bardziej odporna na wartości odstające (<em>outliers</em>) niż reguła Sturgesa.</p>
<p><strong>3. Reguła Freedmana-Diaconisa</strong> (<em>Freedman-Diaconis Rule</em>)<strong>:</strong></p>
<p><span class="math display">\text{Szerokość przedziału} = \frac{2 \cdot IQR}{n^{1/3}}</span></p>
<p>gdzie IQR to rozstęp międzykwartylowy (<em>interquartile range</em>). Najbardziej odporna na wartości odstające; zalecana dla rozkładów skośnych (<em>skewed distributions</em>).</p>
<p><strong>4. Reguła Pierwiastka Kwadratowego</strong> (<em>Square Root Rule</em>)<strong>:</strong></p>
<p><span class="math display">k = \lceil \sqrt{n} \rceil</span></p>
<p>Prosta, ale często produkuje zbyt mało przedziałów dla dużych zbiorów danych.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Przykład: Różne metody wyboru przedziałów</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">50</span>, <span class="dv">10</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">8</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_data)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sturges</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>sturges_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">log2</span>(n) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scott</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>scott_width <span class="ot">&lt;-</span> <span class="fl">3.5</span> <span class="sc">*</span> <span class="fu">sd</span>(sample_data) <span class="sc">/</span> (n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>scott_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">diff</span>(<span class="fu">range</span>(sample_data)) <span class="sc">/</span> scott_width)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Freedman-Diaconis</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>fd_width <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">IQR</span>(sample_data) <span class="sc">/</span> (n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>fd_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">diff</span>(<span class="fu">range</span>(sample_data)) <span class="sc">/</span> fd_width)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Pierwiastek kwadratowy</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>sqrt_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(n))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sturges:"</span>, sturges_bins, <span class="st">"przedziałów</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sturges: 9 przedziałów</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Scott:"</span>, scott_bins, <span class="st">"przedziałów</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scott: 10 przedziałów</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Freedman-Diaconis:"</span>, fd_bins, <span class="st">"przedziałów</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Freedman-Diaconis: 14 przedziałów</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pierwiastek kwadratowy:"</span>, sqrt_bins, <span class="st">"przedziałów</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pierwiastek kwadratowy: 16 przedziałów</code></pre>
</div>
</div>
</section>
<section id="typy-histogramów-skale-osi-y" class="level3">
<h3 class="anchored" data-anchor-id="typy-histogramów-skale-osi-y">Typy Histogramów: Skale Osi Y</h3>
<section id="histogram-częstości-frequency-histogram" class="level4">
<h4 class="anchored" data-anchor-id="histogram-częstości-frequency-histogram">1. Histogram Częstości / Frequency Histogram</h4>
<p><strong>Histogram częstości</strong> (<em>frequency histogram</em>) pokazuje <strong>liczbę</strong> obserwacji w każdym przedziale. Oś Y reprezentuje liczbę obserwacji.</p>
<ul>
<li><strong>Oś Y:</strong> Liczba bezwzględna (częstość)</li>
<li><strong>Stosujemy gdy:</strong> Chcemy zobaczyć surowe liczby</li>
<li><strong>Ograniczenie:</strong> Trudno porównywać rozkłady o różnych liczebnościach próby</li>
</ul>
</section>
<section id="histogram-częstości-względnych-relative-frequency-histogram" class="level4">
<h4 class="anchored" data-anchor-id="histogram-częstości-względnych-relative-frequency-histogram">2. Histogram Częstości Względnych / Relative Frequency Histogram</h4>
<p><strong>Histogram częstości względnych</strong> (<em>relative frequency histogram</em>) pokazuje <strong>proporcję</strong> obserwacji w każdym przedziale. Wysokość każdego słupka reprezentuje ułamek całości.</p>
<ul>
<li><strong>Oś Y:</strong> Częstość względna (proporcja) = <span class="math inline">\frac{\text{liczba w przedziale}}{n}</span></li>
<li><strong>Stosujemy gdy:</strong> Porównujemy rozkłady o różnych liczebnościach próby</li>
<li><strong>Właściwość:</strong> Wszystkie wysokości słupków sumują się do 1.0</li>
</ul>
</section>
<section id="histogram-gęstości-density-histogram" class="level4">
<h4 class="anchored" data-anchor-id="histogram-gęstości-density-histogram">3. Histogram Gęstości / Density Histogram</h4>
<p><strong>Histogram gęstości</strong> (<em>density histogram</em>) dostosowuje się do szerokości przedziałów tak, że <strong>pole powierzchni</strong> (nie wysokość) każdego słupka reprezentuje proporcję obserwacji.</p>
<ul>
<li><strong>Oś Y:</strong> Gęstość (<em>density</em>) = <span class="math inline">\frac{\text{częstość względna}}{\text{szerokość przedziału}}</span></li>
<li><strong>Stosujemy gdy:</strong> Przedziały mają różne szerokości lub gdy łączymy z funkcjami gęstości prawdopodobieństwa</li>
<li><strong>Właściwość:</strong> Całkowite pole powierzchni pod wszystkimi słupkami równa się 1.0</li>
</ul>
<p><strong>Kluczowa różnica:</strong> W histogramie gęstości <strong>pole powierzchni</strong> każdego słupka równa się częstości względnej, podczas gdy <strong>wysokość</strong> to gęstość.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wygeneruj przykładowe dane</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">50</span>, <span class="dv">10</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">8</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Histogram częstości</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Histogram Częstości"</span>, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">ylab =</span> <span class="st">"Częstość (Liczba)"</span>, </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">freq =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Histogram częstości względnych - manualne skalowanie</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>h<span class="sc">$</span>counts <span class="ot">&lt;-</span> h<span class="sc">$</span>counts <span class="sc">/</span> <span class="fu">sum</span>(h<span class="sc">$</span>counts)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h, <span class="at">main =</span> <span class="st">"Histogram Częstości Względnych"</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">ylab =</span> <span class="st">"Częstość Względna (Proporcja)"</span>,</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">freq =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Histogram gęstości</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Histogram Gęstości"</span>, </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">ylab =</span> <span class="st">"Gęstość"</span>, </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Związek matematyczny:</strong></p>
<p>Dla przedziału o granicach <span class="math inline">[a, b)</span>:</p>
<ul>
<li><strong>Częstość:</strong> <span class="math inline">f = \text{liczba obserwacji w } [a, b)</span></li>
<li><strong>Częstość względna:</strong> <span class="math inline">\frac{f}{n}</span></li>
<li><strong>Gęstość:</strong> <span class="math inline">\frac{f/n}{b-a}</span></li>
<li><strong>Pole powierzchni słupka:</strong> <span class="math inline">(b-a) \times \frac{f/n}{b-a} = \frac{f}{n}</span> (równa się częstości względnej)</li>
</ul>
</section>
</section>
<section id="przedziały-otwarte-vs.-zamknięte" class="level3">
<h3 class="anchored" data-anchor-id="przedziały-otwarte-vs.-zamknięte">Przedziały Otwarte vs.&nbsp;Zamknięte</h3>
<p><strong>Przedziały prawostronne otwarte: <span class="math inline">[a, b)</span></strong></p>
<p>Przedział zawiera wartości <span class="math inline">\geq a</span> i <span class="math inline">&lt; b</span>. Sama wartość <span class="math inline">b</span> trafia do następnego przedziału.</p>
<p><strong>Przedziały prawostronne zamknięte: <span class="math inline">(a, b]</span></strong></p>
<p>Przedział zawiera wartości <span class="math inline">&gt; a</span> i <span class="math inline">\leq b</span>. Wartość <span class="math inline">a</span> trafia do poprzedniego przedziału.</p>
<p><strong>Przykład:</strong></p>
<p>Rozważmy dane: 1, 2, 3, 4, 5, 6, 7, 8 z przedziałami [1,3), [3,5), [5,7), [7,9)</p>
<p><strong>Przedziały prawostronne otwarte <span class="math inline">[a, b)</span>:</strong></p>
<ul>
<li>Przedział [1, 3): zawiera 1, 2 (liczba = 2)</li>
<li>Przedział [3, 5): zawiera 3, 4 (liczba = 2)</li>
<li>Przedział [5, 7): zawiera 5, 6 (liczba = 2)</li>
<li>Przedział [7, 9): zawiera 7, 8 (liczba = 2)</li>
</ul>
<p><strong>Przedziały prawostronne zamknięte <span class="math inline">(a, b]</span>:</strong></p>
<ul>
<li>Przedział (1, 3]: zawiera 2, 3 (liczba = 2)</li>
<li>Przedział (3, 5]: zawiera 4, 5 (liczba = 2)</li>
<li>Przedział (5, 7]: zawiera 6, 7 (liczba = 2)</li>
<li>Przedział (7, 9]: zawiera 8 (liczba = 1, ponieważ 9 nie ma w danych)</li>
</ul>
<p><strong>Konwencja R:</strong> Funkcja <code>hist()</code> w R domyślnie używa <strong>przedziałów prawostronnych zamkniętych</strong> (tj. <span class="math inline">(a, b]</span>). Można to zmienić argumentem <code>right = FALSE</code>, aby uzyskać przedziały prawostronne otwarte <span class="math inline">[a, b)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prawostronne zamknięte (domyślne)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Przedziały Prawostronne Zamknięte (a, b]"</span>, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">right =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prawostronne otwarte</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Przedziały Prawostronne Otwarte [a, b)"</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightcoral"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">right =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="wpływ-liczby-przedziałów" class="level3">
<h3 class="anchored" data-anchor-id="wpływ-liczby-przedziałów">Wpływ Liczby Przedziałów</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Różne liczby przedziałów</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="st">"10 Przedziałów (Za mało?)"</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"20 Przedziałów (Zrównoważone)"</span>, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">main =</span> <span class="st">"40 Przedziałów (Za dużo?)"</span>, </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Wartość"</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li><strong>10 przedziałów:</strong> Pokazuje ogólny kształt, ale może przegapić szczegóły (potencjalna bimodalność nie jest widoczna)</li>
<li><strong>20 przedziałów:</strong> Równoważy szczegóły i przejrzystość; ujawnia strukturę bimodalną (<em>bimodal</em>)</li>
<li><strong>40 przedziałów:</strong> Pokazuje więcej szczegółów, ale może uwypuklać losowy szum, utrudniając dostrzeżenie wzorców</li>
</ul>
<p><strong>Co ujawniają histogramy:</strong></p>
<ul>
<li><strong>Kształt:</strong> Symetryczny, skośny lewo, skośny prawo, bimodalny, multimodalny (<em>symmetric, left-skewed, right-skewed, bimodal, multimodal</em>)</li>
<li><strong>Centrum:</strong> Gdzie znajduje się większość danych</li>
<li><strong>Rozproszenie:</strong> Jak szeroki jest rozkład</li>
<li><strong>Wartości odstające:</strong> Niezwykłe wartości oddzielone od głównego zbioru</li>
<li><strong>Luki:</strong> Zakresy, gdzie nie ma żadnych danych</li>
</ul>
<p><strong>Ogólna rekomendacja:</strong> Zacznij od reguły Sturgesa lub Freedmana-Diaconisa, a następnie dostosuj w zależności od tego, jakie wzorce chcesz uwypuklić. Dla analizy eksploracyjnej wypróbuj kilka różnych liczb przedziałów.</p>
<hr>
</section>
</section>
<section id="wizualizacja-wykresy-pudełkowe-tukeya" class="level2" data-number="6.11">
<h2 data-number="6.11" class="anchored" data-anchor-id="wizualizacja-wykresy-pudełkowe-tukeya"><span class="header-section-number">6.11</span> Wizualizacja: wykresy pudełkowe Tukeya</h2>
<p><strong>Wykres pudełkowy Tukeya</strong> (<em>Tukey boxplot</em>, lub <em>box-and-whisker plot</em>) dostarcza wizualnego podsumowania rozkładu opartego na pięciu kluczowych wartościach: minimum, <span class="math inline">Q_1</span>, mediana, <span class="math inline">Q_3</span> i maksimum. Identyfikuje również wartości odstające.</p>
<section id="konstrukcja-wykresu-pudełkowego" class="level3">
<h3 class="anchored" data-anchor-id="konstrukcja-wykresu-pudełkowego">Konstrukcja wykresu pudełkowego</h3>
<p><strong>Krok 1: Oblicz podsumowanie pięcioliczbowe</strong> (<em>five-number summary</em>)</p>
<ol type="1">
<li>Minimum (z wyłączeniem wartości odstających)</li>
<li>Pierwszy kwartyl (<span class="math inline">Q_1</span>)</li>
<li>Mediana (<span class="math inline">Q_2</span>)</li>
<li>Trzeci kwartyl (<span class="math inline">Q_3</span>)</li>
<li>Maksimum (z wyłączeniem wartości odstających)</li>
</ol>
<p><strong>Krok 2: Oblicz płoty dla wykrywania wartości odstających</strong> (<em>fences</em>)</p>
<p><span class="math display">\text{Płot dolny} = Q_1 - 1.5 \times \text{IQR}</span> <span class="math display">\text{Płot górny} = Q_3 + 1.5 \times \text{IQR}</span></p>
<p><strong>Krok 3: Zidentyfikuj wartości odstające</strong></p>
<p>Każda obserwacja poniżej płotu dolnego lub powyżej płotu górnego jest klasyfikowana jako wartość odstająca (<em>outlier</em>).</p>
<p><strong>Krok 4: Narysuj wykres pudełkowy</strong></p>
<ul>
<li><strong>Pudełko</strong> (<em>box</em>): Rozciąga się od <span class="math inline">Q_1</span> do <span class="math inline">Q_3</span> (zawiera środkowe 50% danych)</li>
<li><strong>Linia wewnątrz pudełka:</strong> Pokazuje medianę</li>
<li><strong>Wąsy</strong> (<em>whiskers</em>): Rozciągają się do najbardziej ekstremalnych obserwacji niebędących wartościami odstającymi</li>
<li><strong>Pojedyncze punkty:</strong> Zaznaczone dla każdej wartości odstającej</li>
</ul>
<p><strong>KRYTYCZNE ROZRÓŻNIENIE: Płoty vs.&nbsp;Wąsy</strong></p>
<ul>
<li><strong>Płoty</strong> (<em>fences</em>): Teoretyczne granice używane do identyfikacji wartości odstających (niekoniecznie rysowane)</li>
<li><strong>Wąsy</strong> (<em>whiskers</em>): Rozciągają się do rzeczywistych punktów danych w obrębie płotów</li>
</ul>
<p><strong>Powszechny błąd:</strong> Studenci często myślą, że wąsy rozciągają się do płotów. To niepoprawne! Wąsy rozciągają się tylko do najbardziej ekstremalnych <strong>rzeczywistych wartości danych</strong>, które znajdują się w granicach płotów.</p>
<hr>
<p><strong>Kluczowe spostrzeżenia z wykresów pudełkowych:</strong></p>
<ul>
<li><strong>Symetria:</strong> Jeśli mediana jest wycentrowana w pudełku, a wąsy mają równą długość, rozkład jest w przybliżeniu symetryczny</li>
<li><strong>Skośność:</strong> Jeśli mediana jest bliżej <span class="math inline">Q_1</span>, a górny wąs jest dłuższy, rozkład jest skośny w prawo</li>
<li><strong>Wartości odstające:</strong> Pojedyncze punkty poza wąsami wskazują nietypowe obserwacje</li>
<li><strong>Porównanie:</strong> Wykresy pudełkowe obok siebie ułatwiają porównywanie rozkładów między grupami</li>
</ul>
</section>
<section id="porównywanie-wielu-grup-wykresami-pudełkowymi" class="level3">
<h3 class="anchored" data-anchor-id="porównywanie-wielu-grup-wykresami-pudełkowymi">Porównywanie wielu grup wykresami pudełkowymi</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generuj dane dla trzech grup</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>group_a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>group_b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">8</span>), <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">95</span>))  <span class="co"># Z wartościami odstającymi</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>group_c <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">50</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>) <span class="sc">+</span> <span class="dv">30</span>  <span class="co"># Skośny w prawo</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Połącz w ramkę danych</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>data_compare <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(group_a, group_b, group_c),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Grupa A</span><span class="sc">\n</span><span class="st">(Symetryczny)"</span>, </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Grupa B</span><span class="sc">\n</span><span class="st">(Z wartościami odstającymi)"</span>, </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Grupa C</span><span class="sc">\n</span><span class="st">(Skośny w prawo)"</span>), </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">each =</span> <span class="dv">50</span>))</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(value <span class="sc">~</span> group, <span class="at">data =</span> data_compare,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Porównanie rozkładów między grupami"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Wartość"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#66C2A5"</span>, <span class="st">"#FC8D62"</span>, <span class="st">"#8DA0CB"</span>),</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NA</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretacja:</strong></p>
<ul>
<li><strong>Grupa A:</strong> Rozkład symetryczny z medianą blisko centrum pudełka</li>
<li><strong>Grupa B:</strong> Wyższe centrum z kilkoma wartościami odstającymi po obu końcach</li>
<li><strong>Grupa C:</strong> Rozkład skośny w prawo (dłuższy górny wąs, mediana bliżej <span class="math inline">Q_1</span>)</li>
</ul>
</section>
</section>
<section id="podsumowanie-wybór-odpowiedniej-miary" class="level2" data-number="6.12">
<h2 data-number="6.12" class="anchored" data-anchor-id="podsumowanie-wybór-odpowiedniej-miary"><span class="header-section-number">6.12</span> Podsumowanie: wybór odpowiedniej miary</h2>
<p>Wybór odpowiednich statystyk opisowych zależy od cech danych:</p>
<p><strong>Dla tendencji centralnej:</strong></p>
<ul>
<li><strong>Średnia:</strong> Stosuj, gdy dane są symetryczne i bez ekstremalnych wartości odstających. Dostarcza najwięcej informacji, ale wrażliwa na ekstrema. <em>Wymaga skali interwałowej lub ilorazowej.</em></li>
<li><strong>Mediana:</strong> Stosuj, gdy dane są skośne lub zawierają wartości odstające. Bardziej odporna, ale odrzuca część informacji. <em>Wymaga co najmniej skali porządkowej.</em></li>
<li><strong>Moda:</strong> Stosuj dla danych kategorycznych lub gdy identyfikujesz najczęstszą wartość. <em>Można używać z każdą skalą pomiarową.</em></li>
</ul>
<p><strong>Dla rozproszenia:</strong></p>
<ul>
<li><strong>Odchylenie standardowe:</strong> Stosuj ze średnią dla symetrycznych danych bez wartości odstających. Najczęstsza i interpretatywna. <em>Wymaga skali interwałowej lub ilorazowej.</em></li>
<li><strong>IQR:</strong> Stosuj z medianą dla skośnych danych lub danych z wartościami odstającymi. Odporny na ekstrema. <em>Wymaga co najmniej skali porządkowej.</em></li>
<li><strong>Rozstęp:</strong> Szybka ocena, ale bardzo wrażliwy na wartości odstające. Stosuj ostrożnie. <em>Wymaga skali interwałowej lub ilorazowej.</em></li>
</ul>
<p><strong>Dla pozycji względnej:</strong></p>
<ul>
<li><strong>Kwantyle/Percentyle:</strong> Pomagają porównać poszczególne obserwacje z całym rozkładem. <em>Wymaga co najmniej skali porządkowej.</em></li>
<li><strong>Kwartyle:</strong> Dostarczają standardowych punktów odcięcia dzielących dane na cztery równe części. <em>Wymaga co najmniej skali porządkowej.</em></li>
</ul>
<p><strong>Dla kształtu:</strong></p>
<ul>
<li><strong>Inspekcja wizualna:</strong> Używaj histogramów do oceny symetrii, skośności i modalności</li>
<li><strong>Wykresy pudełkowe:</strong> Skutecznie ujawniają skośność i identyfikują wartości odstające</li>
</ul>
<p><strong>Dla wizualizacji:</strong></p>
<ul>
<li><strong>Histogramy:</strong> Pokazują pełny kształt rozkładu. Dobre do zrozumienia ogólnych wzorców.</li>
<li><strong>Wykresy pudełkowe:</strong> Efektywne podsumowania do porównywania grup. Wyraźnie podkreślają wartości odstające i kwartyle.</li>
</ul>
<p><strong>Ogólna zasada:</strong> Zawsze raportuj wiele miar. Średnia i odchylenie standardowe opowiadają jedną historię; mediana i IQR opowiadają inną. Razem z wizualizacjami dostarczają pełnego obrazu danych. Zawsze rozważ skalę pomiarową danych przy wyborze statystyk do obliczenia.</p>
<hr>
</section>
<section id="appendix-a-measures-of-relative-position-standing" class="level2" data-number="6.13">
<h2 data-number="6.13" class="anchored" data-anchor-id="appendix-a-measures-of-relative-position-standing"><span class="header-section-number">6.13</span> Appendix A: Measures of Relative Position (Standing)</h2>
<p>Understanding where values sit within a dataset is crucial for data analysis. Let’s explore these concepts step by step.</p>
<section id="quartiles-q-the-basics" class="level3">
<h3 class="anchored" data-anchor-id="quartiles-q-the-basics">Quartiles (Q): The Basics</h3>
<p>Think of quartiles as special numbers that split your ordered data into four equal parts.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4327.jpg" class="img-fluid figure-img"></p>
<figcaption>Doane, D. P., &amp; Seward, L. W. (2016). Applied statistics in business and economics. Mcgraw-Hill.</figcaption>
</figure>
</div>
<section id="what-are-quartiles" class="level4">
<h4 class="anchored" data-anchor-id="what-are-quartiles">What Are Quartiles?</h4>
<p>First Quartile (Q1):</p>
<ul>
<li>Separates the lowest 25% of data from the rest</li>
<li>Also called the 25th percentile</li>
<li>Example: If Q1 = 50 in a test score dataset, 25% of students scored below 50</li>
</ul>
<p>Second Quartile (Q2):</p>
<ul>
<li>The median - splits data in half</li>
<li>Also called the 50th percentile</li>
<li>Example: If Q2 = 70, half the students scored below 70</li>
</ul>
<p>Third Quartile (Q3):</p>
<ul>
<li>Separates the highest 25% of data from the rest</li>
<li>Also called the 75th percentile</li>
<li>Example: If Q3 = 85, 75% of students scored below 85</li>
</ul>
</section>
<section id="how-to-calculate-quartiles-step-by-step---two-methods" class="level4">
<h4 class="anchored" data-anchor-id="how-to-calculate-quartiles-step-by-step---two-methods">How to Calculate Quartiles (Step by Step) - Two Methods</h4>
<p>Let’s examine student test scores using both common quartile calculation methods:</p>
<p><strong>Example 1: Odd Number Case (11 scores)</strong><br>
60, 65, 70, 72, 75, 78, 80, 82, 85, 88, 90</p>
<p>Step 1: Find Q2 (median) - Same for both methods</p>
<ul>
<li>With n = 11 values (odd)</li>
<li>Median position = (n + 1)/2 = 6</li>
<li>Q2 = 78</li>
</ul>
<p>Step 2: Find Q1</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at lower half: 60, 65, 70, 72, 75</li>
<li>Q1 = median of lower half = 70</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = (n + 1)/4 = (11 + 1)/4 = 3</li>
<li>Q1 = 70 (3rd value)</li>
</ul></li>
</ul>
<p>Step 3: Find Q3</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at upper half: 80, 82, 85, 88, 90</li>
<li>Q3 = median of upper half = 85</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = 3(n + 1)/4 = 3(12)/4 = 9</li>
<li>Q3 = 85 (9th value)</li>
</ul></li>
</ul>
<p><strong>Example 2: Even Number Case (10 scores)</strong><br>
60, 65, 70, 72, 75, 78, 80, 82, 85, 90</p>
<p>Step 1: Find Q2 (median) - Same for both methods</p>
<ul>
<li>With n = 10 values (even)</li>
<li>Median positions = 5 and 6</li>
<li>Q2 = (75 + 78)/2 = 76.5</li>
</ul>
<p>Step 2: Find Q1</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at lower half: 60, 65, 70, 72, 75</li>
<li>Q1 = median of lower half = 70</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = (10 + 1)/4 = 2.75</li>
<li>Q1 = 65 + 0.75(70 - 65) = 68.75</li>
</ul></li>
</ul>
<p>Step 3: Find Q3</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at upper half: 78, 80, 82, 85, 90</li>
<li>Q3 = median of upper half = 82</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = 3(10 + 1)/4 = 8.25</li>
<li>Q3 = 82 + 0.25(85 - 82) = 82.75</li>
</ul></li>
</ul>
<p>Important Notes:</p>
<ol type="1">
<li><p>Tukey’s Method:</p>
<ul>
<li>First find the median (Q2)</li>
<li>Split the data into lower and upper halves</li>
<li>Find Q1 as the median of the lower half</li>
<li>Find Q3 as the median of the upper half</li>
<li>When n is odd, the median is not included in either half</li>
</ul></li>
<li><p>Interpolation Method:</p>
<ul>
<li>Uses positions (n+1)/4 for Q1 and 3(n+1)/4 for Q3</li>
<li>When position falls between values, uses linear interpolation</li>
<li>Doesn’t require splitting data into halves</li>
</ul></li>
</ol>
<p>Both methods give the same results for simple positions (Example 1) but can differ when interpolation is needed (Example 2).</p>
</section>
</section>
</section>
<section id="appendix-b-manual-construction-of-tukey-boxplot" class="level2" data-number="6.14">
<h2 data-number="6.14" class="anchored" data-anchor-id="appendix-b-manual-construction-of-tukey-boxplot"><span class="header-section-number">6.14</span> Appendix B: Manual Construction of Tukey Boxplot</h2>
<p><strong>Step 1: Calculate Key Components</strong></p>
<ol type="1">
<li>Find quartiles: <span class="math inline">Q_1</span>, <span class="math inline">Q_2</span> (median), <span class="math inline">Q_3</span></li>
<li>Calculate Interquartile Range: <span class="math inline">IQR = Q_3 - Q_1</span></li>
</ol>
<p><strong>Step 2: Determine Whisker Boundaries</strong></p>
<ul>
<li>Lower fence: <span class="math inline">Q_1 - 1.5 \times IQR</span></li>
<li>Upper fence: <span class="math inline">Q_3 + 1.5 \times IQR</span></li>
</ul>
<p><strong>Step 3: Identify Outliers</strong> Data points are outliers if they are:</p>
<ul>
<li>Below lower fence: <span class="math inline">x &lt; Q_1 - 1.5 \times IQR</span></li>
<li>Above upper fence: <span class="math inline">x &gt; Q_3 + 1.5 \times IQR</span></li>
</ul>
<p><strong>Example:</strong> Given data: 2, 4, 6, 8, 9, 10, 11, 12, 14, 16, 50</p>
<ol type="1">
<li><p>Find quartiles:</p>
<ul>
<li><span class="math inline">Q_1 = 6</span></li>
<li><span class="math inline">Q_2 = 10</span></li>
<li><span class="math inline">Q_3 = 14</span></li>
</ul></li>
<li><p>Calculate <span class="math inline">IQR</span>:</p>
<ul>
<li><span class="math inline">IQR = 14 - 6 = 8</span></li>
</ul></li>
<li><p>Calculate fences:</p>
<ul>
<li>Lower: <span class="math inline">6 - (1.5 \times 8) = -6</span></li>
<li>Upper: <span class="math inline">14 + (1.5 \times 8) = 26</span></li>
</ul></li>
<li><p>Identify outliers:</p>
<ul>
<li>50 &gt; 26, therefore 50 is an outlier</li>
</ul></li>
</ol>
<p><strong>Graphical Elements:</strong></p>
<ol type="1">
<li>Box: Draw from <span class="math inline">Q_1</span> to <span class="math inline">Q_3</span></li>
<li>Line inside box: Draw at <span class="math inline">Q_2</span></li>
<li>Whiskers: Extend to most extreme non-outlier points</li>
<li>Points: Plot outliers individually beyond whiskers</li>
</ol>
<hr>
<section id="sec-height-comparison" class="level4">
<h4 class="anchored" data-anchor-id="sec-height-comparison">Case Study: Comparing Heights Between Groups</h4>
<p>Let’s apply our understanding of box plots to a real dataset. We have height measurements (in centimeters) from two groups of 25 students each.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the dataset</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_height <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_1 =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">165</span>, <span class="dv">168</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">186</span>, <span class="dv">188</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">200</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_2 =</span> <span class="fu">c</span>(<span class="dv">138</span>, <span class="dv">140</span>, <span class="dv">148</span>, <span class="dv">152</span>, <span class="dv">164</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">166</span>, <span class="dv">170</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">188</span>, <span class="dv">210</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform dataset from wide to long format</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>data_height_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(<span class="at">data =</span> data_height, <span class="at">key =</span> <span class="st">"Group_number"</span>, <span class="at">value =</span> <span class="st">"height"</span>, group_1<span class="sc">:</span>group_2)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_height_l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Group_number height
1      group_1    150
2      group_1    160
3      group_1    165
4      group_1    168
5      group_1    172
6      group_1    173</code></pre>
</div>
</div>
<p>Let’s calculate some summary statistics for each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each group</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>group1_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>group2_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IQR</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>group1_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>group2_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comparison table</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>stats_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  group1_stats,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  group2_stats</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(stats_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group 1"</span>, <span class="st">"Group 2"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>stats_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Min. 1st Qu. Median  Mean 3rd Qu. Max.
Group 1  150     175    180 178.6     183  200
Group 2  138     165    175 172.1     182  210</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display IQR values</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR for Group 1:"</span>, group1_iqr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR for Group 1: 8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR for Group 2:"</span>, group2_iqr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR for Group 2: 17 </code></pre>
</div>
</div>
</section>
<section id="sec-visualizing-heights" class="level4">
<h4 class="anchored" data-anchor-id="sec-visualizing-heights">Visualizing the Height Data</h4>
<p>Now, let’s visualize the data using box plots and density plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create horizontal boxplots</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Group_number, <span class="at">y =</span> height, <span class="at">colour =</span> Group_number), <span class="at">notch =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Distribution by Group"</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Group"</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.
ℹ The deprecated feature was likely used in the ggpubr package.
  Please report the issue at &lt;https://github.com/kassambara/ggpubr/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.
ℹ The deprecated feature was likely used in the ggpubr package.
  Please report the issue at &lt;https://github.com/kassambara/ggpubr/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-boxplots" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="rozdzial5_files/figure-html/fig-boxplots-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Box plots comparing height distributions between groups.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To complement our box plots, let’s also look at the density distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plots</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Group_number), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Group_number) <span class="sc">+</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Density by Group"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (cm)"</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-density" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="rozdzial5_files/figure-html/fig-density-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: Density plots showing the height distributions for each group.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-boxplot-exercise" class="level4">
<h4 class="anchored" data-anchor-id="sec-boxplot-exercise">Box Plot Interpretation Exercise</h4>
<p>Based on the box plots and density plots above, determine whether each of the following statements is <strong>True</strong> or <strong>False</strong>. For each statement, provide a brief explanation based on evidence from the visualizations.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise Questions
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Students from group 2 (G2) in the studied sample are, on average, taller than those from group 1 (G1).</p></li>
<li><p>Group 1 (G1) height measurements are more dispersed/spread out than group 2 (G2).</p></li>
<li><p>The lowest person is in group 2 (G2).</p></li>
<li><p>Both data sets are negatively (left) skewed.</p></li>
<li><p>Half of the students in group 2 (G2) measure at least 175 cm.</p></li>
</ol>
</div>
</div>
<section id="hints-for-interpretation" class="level5">
<h5 class="anchored" data-anchor-id="hints-for-interpretation">Hints for Interpretation</h5>
<p>When answering these questions, consider:</p>
<ul>
<li>The position of the median line within each box</li>
<li>The relative sizes of the boxes (IQR)</li>
<li>The positions of the minimum and maximum values</li>
<li>The symmetry of the distributions (balanced or skewed)</li>
<li>The lengths of the whiskers</li>
</ul>
<p>For each statement, determine whether it is True or False and provide your explanation:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer Template
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Students from G2 are, on average, taller than G1: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>G1 height is more dispersed/spread out: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>The lowest person is in G2: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>Both data sets are negatively (left) skewed: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>Half of G2 measure at least 175 cm: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
</ol>
</div>
</div>
</div>
<p>Let’s review the answers to our box plot interpretation questions:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Students from G2 are, on average, taller than G1: <strong>False</strong>
<ul>
<li>Explanation: The median height (middle line in the boxplot) for G1 is higher than G2.</li>
</ul></li>
<li>G1 height is more dispersed/spread out: <strong>False</strong>
<ul>
<li>Explanation: G2 shows greater dispersion. This is visible in the boxplot where G2 has a larger interquartile range (IQR) of 17.5 cm compared to G1’s 9.5 cm. G2 also has a wider range from minimum to maximum values.</li>
</ul></li>
<li>The lowest person is in G2: <strong>True</strong>
<ul>
<li>Explanation: The minimum value in G2 is 138 cm, which is lower than the minimum value in G1 (150 cm).</li>
</ul></li>
<li>Both data sets are negatively (left) skewed: <strong>True</strong>
<ul>
<li>Explanation: In both groups, the median line is positioned toward the upper part of the box, and the lower whisker is longer than the upper whisker. This indicates that there’s a longer tail on the left side of the distribution, which means negative skewness.</li>
</ul></li>
<li>Half of G2 measure at least 175 cm: <strong>True</strong>
<ul>
<li>Explanation: The median (middle line in the boxplot) for G2 is 175 cm, which means that 50% of the values are greater than or equal to 175 cm.</li>
</ul></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-boxplot-code" class="level4">
<h4 class="anchored" data-anchor-id="sec-boxplot-code">R Code Reference</h4>
<p>Here’s the complete R code used in this section:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set display options</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the dataset</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>data_height <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_1 =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">165</span>, <span class="dv">168</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">186</span>, <span class="dv">188</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">200</span>),</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_2 =</span> <span class="fu">c</span>(<span class="dv">138</span>, <span class="dv">140</span>, <span class="dv">148</span>, <span class="dv">152</span>, <span class="dv">164</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">166</span>, <span class="dv">170</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">188</span>, <span class="dv">210</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform dataset from wide to long format</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>data_height_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(<span class="at">data =</span> data_height, <span class="at">key =</span> <span class="st">"Group_number"</span>, <span class="at">value =</span> <span class="st">"height"</span>, group_1<span class="sc">:</span>group_2)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_height_l)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each group</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>group1_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>group2_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IQR</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>group1_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>group2_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create horizontal boxplots</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Group_number, <span class="at">y =</span> height, <span class="at">colour =</span> Group_number), <span class="at">notch =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span> </span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Distribution by Group"</span>,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Group"</span>,</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plots</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Group_number), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Group_number) <span class="sc">+</span> </span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Density by Group"</span>,</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (cm)"</span>,</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="appendix-c-comparative-analysis-using-tukey-boxplots" class="level2" data-number="6.15">
<h2 data-number="6.15" class="anchored" data-anchor-id="appendix-c-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">6.15</span> Appendix C: Comparative Analysis Using Tukey Boxplots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data - exclude Oceania due to insufficient data (only 2 countries)</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>data_2007 <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, continent <span class="sc">!=</span> <span class="st">"Oceania"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understanding-tukey-boxplots" class="level2" data-number="6.16">
<h2 data-number="6.16" class="anchored" data-anchor-id="understanding-tukey-boxplots"><span class="header-section-number">6.16</span> Understanding Tukey Boxplots</h2>
<p>A <strong>Tukey boxplot</strong> displays five key statistics and identifies outliers:</p>
<ul>
<li><strong>Median (Q2)</strong>: The middle line in the box (50th percentile)</li>
<li><strong>First quartile (Q1)</strong>: Bottom of the box (25th percentile)<br>
</li>
<li><strong>Third quartile (Q3)</strong>: Top of the box (75th percentile)</li>
<li><strong>Interquartile Range (IQR)</strong>: The height of the box = <span class="math inline">Q3 - Q1</span></li>
<li><strong>Whiskers</strong>: Extend to the most extreme values within <span class="math inline">Q1 - 1.5 \times IQR</span> (lower) and <span class="math inline">Q3 + 1.5 \times IQR</span> (upper)</li>
<li><strong>Outliers</strong>: Points beyond the whiskers (Tukey’s rule)</li>
</ul>
<p><strong>Key interpretation points:</strong></p>
<ul>
<li>The median shows central tendency (not the mean!)</li>
<li>The IQR shows the middle 50% of data</li>
<li>Longer boxes indicate more spread</li>
<li>Asymmetric boxes or whiskers indicate skewness</li>
<li>The whiskers show the range of “typical” values</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_2007, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, lifeExp, <span class="at">FUN =</span> median), <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="dv">21</span>, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.fill =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy by Continent (2007)"</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Boxplots show distribution; red circles indicate outliers by Tukey's rule</span><span class="sc">\n</span><span class="st">Note: Oceania excluded due to insufficient data (only 2 countries)"</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent (ordered by median)"</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy (years)"</span>) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">85</span>, <span class="at">by =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-a-basic-comparisons" class="level2" data-number="6.17">
<h2 data-number="6.17" class="anchored" data-anchor-id="part-a-basic-comparisons"><span class="header-section-number">6.17</span> Part A: Basic Comparisons</h2>
<p>Answer the following questions by examining the boxplot above.</p>
<section id="true-or-false" class="level3">
<h3 class="anchored" data-anchor-id="true-or-false">True or False:</h3>
<ol type="1">
<li><p>Europe has a higher median life expectancy than Africa.</p></li>
<li><p>Life expectancy is more dispersed in Africa than in Europe (compare the box heights).</p></li>
<li><p>Africa’s distribution is positively (right) skewed—the upper whisker is longer than the lower whisker.</p></li>
<li><p>Asia has outliers on both the low and high ends of the distribution.</p></li>
<li><p>The median life expectancy in Asia is lower than in the Americas.</p></li>
<li><p>Africa shows the largest interquartile range (IQR) among all continents.</p></li>
</ol>
</section>
</section>
<section id="part-b-changes-over-time" class="level2" data-number="6.18">
<h2 data-number="6.18" class="anchored" data-anchor-id="part-b-changes-over-time"><span class="header-section-number">6.18</span> Part B: Changes Over Time</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>time_comparison <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1957</span>, <span class="dv">2007</span>), continent <span class="sc">!=</span> <span class="st">"Oceania"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">factor</span>(year))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_comparison, <span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> lifeExp, <span class="at">fill =</span> year)) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>), </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="dv">21</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy: 1957 vs 2007"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"50-year comparison of distributions (Oceania excluded due to insufficient data)"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy (years)"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1957"</span> <span class="ot">=</span> <span class="st">"#E78AC3"</span>, <span class="st">"2007"</span> <span class="ot">=</span> <span class="st">"#8DA0CB"</span>)) <span class="sc">+</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">85</span>, <span class="at">by =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<section id="true-or-false-1" class="level3">
<h3 class="anchored" data-anchor-id="true-or-false-1">True or False:</h3>
<ol type="1">
<li><p>The median life expectancy increased in all continents between 1957 and 2007.</p></li>
<li><p>In 1957, Asia had a larger IQR than in 2007, indicating convergence (compare box heights).</p></li>
<li><p>The entire distribution of life expectancy in Europe in 2007 is higher than Africa’s entire distribution in 1957 (check if the boxes overlap at all).</p></li>
<li><p>Asia showed a larger increase in median life expectancy than the Americas between 1957 and 2007.</p></li>
</ol>
</section>
</section>
<section id="part-c-summary-statistics" class="level2" data-number="6.19">
<h2 data-number="6.19" class="anchored" data-anchor-id="part-c-summary-statistics"><span class="header-section-number">6.19</span> Part C: Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for verification</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data_2007 <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(lifeExp),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">q1 =</span> <span class="fu">quantile</span>(lifeExp, <span class="fl">0.25</span>),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">q3 =</span> <span class="fu">quantile</span>(lifeExp, <span class="fl">0.75</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(lifeExp),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(lifeExp),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(lifeExp),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_fence =</span> q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_fence =</span> q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_outliers =</span> <span class="fu">sum</span>(lifeExp <span class="sc">&lt;</span> lower_fence <span class="sc">|</span> lifeExp <span class="sc">&gt;</span> upper_fence)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(median))</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats, <span class="at">digits =</span> <span class="dv">1</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics for Life Expectancy by Continent (2007)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Summary Statistics for Life Expectancy by Continent (2007)</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">continent</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">q1</th>
<th style="text-align: right;">q3</th>
<th style="text-align: right;">iqr</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">lower_fence</th>
<th style="text-align: right;">upper_fence</th>
<th style="text-align: right;">n_outliers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Europe</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">78.6</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">79.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">81.8</td>
<td style="text-align: right;">67.9</td>
<td style="text-align: right;">87.0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Americas</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">72.9</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">76.4</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">60.9</td>
<td style="text-align: right;">80.7</td>
<td style="text-align: right;">64.8</td>
<td style="text-align: right;">83.3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asia</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">72.4</td>
<td style="text-align: right;">65.5</td>
<td style="text-align: right;">75.6</td>
<td style="text-align: right;">10.2</td>
<td style="text-align: right;">43.8</td>
<td style="text-align: right;">82.6</td>
<td style="text-align: right;">50.3</td>
<td style="text-align: right;">90.9</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Africa</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">52.9</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">59.4</td>
<td style="text-align: right;">11.6</td>
<td style="text-align: right;">39.6</td>
<td style="text-align: right;">76.4</td>
<td style="text-align: right;">30.4</td>
<td style="text-align: right;">76.9</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Note</strong>: The lower and upper fences show the boundaries for Tukey’s outlier rule. Values beyond these fences are marked as outliers. Oceania is excluded from this analysis because it contains only 2 countries in the dataset, which is insufficient for meaningful distributional analysis using boxplots.</p>
</section>
<section id="thinking-questions" class="level2" data-number="6.20">
<h2 data-number="6.20" class="anchored" data-anchor-id="thinking-questions"><span class="header-section-number">6.20</span> Thinking Questions</h2>
<ol type="1">
<li><p>Why might Africa show more outliers than other continents? What could this tell us about within-continent variation?</p></li>
<li><p>If we wanted to compare “average” life expectancy between continents, should we use the mean or median? Why might these differ, especially for Africa?</p></li>
<li><p>Looking at the 1957 vs 2007 comparison, which continent showed the most dramatic transformation? Consider both the change in median and the change in spread (IQR).</p></li>
</ol>
<hr>
</section>
<section id="solutions-1" class="level2" data-number="6.21">
<h2 data-number="6.21" class="anchored" data-anchor-id="solutions-1"><span class="header-section-number">6.21</span> Solutions</h2>
<section id="part-a-basic-comparisons-1" class="level3">
<h3 class="anchored" data-anchor-id="part-a-basic-comparisons-1">Part A: Basic Comparisons</h3>
<p><strong>1. TRUE</strong> - Europe’s median (the line in the middle of the box) is clearly much higher (~78 years) than Africa’s median (~53 years).</p>
<p><strong>2. TRUE</strong> - Africa’s box is much taller than Europe’s box, indicating greater IQR and thus more dispersion in life expectancy values.</p>
<p><strong>3. TRUE</strong> - Africa’s upper whisker is visibly longer than the lower whisker, indicating positive (right) skewness. This means there are some African countries with notably higher life expectancy than the median, creating a tail toward higher values.</p>
<p><strong>4. TRUE</strong> - Asia shows red circles (outliers) both below the lower whisker (countries with unusually low life expectancy) and above the upper whisker (countries with unusually high life expectancy).</p>
<p><strong>5. TRUE</strong> - The median line in Asia’s box is slightly lower (~71 years) than the median line in the Americas’ box (~73 years).</p>
<p><strong>6. TRUE</strong> - Africa has the tallest box among all continents, indicating the largest IQR and thus the greatest variability in life expectancy across African countries.</p>
</section>
<section id="part-b-changes-over-time-1" class="level3">
<h3 class="anchored" data-anchor-id="part-b-changes-over-time-1">Part B: Changes Over Time</h3>
<p><strong>1. TRUE</strong> - For every continent, the blue box (2007) has a higher median line than the pink box (1957), showing universal improvement in life expectancy over the 50-year period.</p>
<p><strong>2. TRUE</strong> - Asia’s pink box (1957) is noticeably taller than its blue box (2007), showing that Asian countries converged (became more similar) over time. Countries that were far apart in development in 1957 have moved closer together by 2007.</p>
<p><strong>3. TRUE</strong> - Europe’s entire blue box (2007) sits above Africa’s entire pink box (1957)—there is no overlap between the distributions. Even the country with the lowest life expectancy in Europe in 2007 has higher life expectancy than the country with the highest life expectancy in Africa in 1957.</p>
<p><strong>4. TRUE</strong> - The vertical distance between Asia’s pink and blue median lines is visibly larger (~30 years: from ~41 to ~71) than the distance between the Americas’ pink and blue median lines (~21 years: from ~52 to ~73), indicating Asia had a greater absolute improvement in median life expectancy.</p>
</section>
<section id="thinking-questions-sample-answers" class="level3">
<h3 class="anchored" data-anchor-id="thinking-questions-sample-answers">Thinking Questions: Sample Answers</h3>
<p><strong>1. Why might Africa show more outliers?</strong></p>
<p>Africa’s outliers reflect extreme within-continent heterogeneity. Countries like Swaziland and Lesotho face severe HIV/AIDS epidemics that dramatically reduce life expectancy, while other factors like conflict, governance quality, and economic development vary widely across the continent. The presence of outliers suggests that treating “Africa” as a homogeneous category obscures important variation, and country-specific factors matter greatly.</p>
<p><strong>2. Mean or median for comparison?</strong></p>
<p>The median is more appropriate for comparing continents, especially Africa. The presence of outliers and the right-skewed distribution in Africa would pull the mean lower than what represents the typical country experience. The median better represents the “typical” or “central” country on each continent and is resistant to extreme values, making it a more robust measure of central tendency for this comparison.</p>
<p><strong>3. Most dramatic transformation:</strong></p>
<p>Asia showed the most dramatic transformation. First, it achieved the largest absolute increase in median life expectancy (approximately 30 years, compared to roughly 10-21 years for other continents). Second, it showed notable convergence—the 2007 box is much shorter than the 1957 box—meaning that Asian countries which were at vastly different development stages in 1957 have largely caught up with each other by 2007. This reflects the rapid economic development and healthcare improvements across much of Asia during this period, particularly in East and Southeast Asia.</p>
<hr>
</section>
</section>
<section id="appendix-d-comparative-analysis-using-tukey-boxplots" class="level2" data-number="6.22">
<h2 data-number="6.22" class="anchored" data-anchor-id="appendix-d-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">6.22</span> Appendix D: Comparative Analysis Using Tukey Boxplots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)  <span class="co"># Contains gapminder data with fertility rates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dslabs' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for two time points</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data_1960 <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1960</span>, <span class="sc">!</span><span class="fu">is.na</span>(fertility))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>data_2015 <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>, <span class="sc">!</span><span class="fu">is.na</span>(fertility))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine for comparison</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>data_comparison <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">2015</span>), <span class="sc">!</span><span class="fu">is.na</span>(fertility))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="understanding-tukey-boxplots-1" class="level3">
<h3 class="anchored" data-anchor-id="understanding-tukey-boxplots-1">Understanding Tukey Boxplots</h3>
<p>A <strong>Tukey boxplot</strong> displays five key statistics and identifies outliers:</p>
<ul>
<li><strong>Median (Q2)</strong>: The middle line in the box (50th percentile)</li>
<li><strong>First quartile (Q1)</strong>: Bottom of the box (25th percentile)<br>
</li>
<li><strong>Third quartile (Q3)</strong>: Top of the box (75th percentile)</li>
<li><strong>Interquartile Range (IQR)</strong>: The height of the box = <span class="math inline">Q3 - Q1</span></li>
<li><strong>Whiskers</strong>: Extend to the most extreme values within <span class="math inline">Q1 - 1.5 \times IQR</span> (lower) and <span class="math inline">Q3 + 1.5 \times IQR</span> (upper)</li>
<li><strong>Outliers</strong>: Points beyond the whiskers (Tukey’s rule)</li>
</ul>
<p><strong>Key interpretation points:</strong></p>
<ul>
<li>The median shows central tendency (not the mean!)</li>
<li>The IQR shows the middle 50% of data</li>
<li>Longer boxes indicate more spread</li>
<li>Asymmetric boxes or whiskers indicate skewness</li>
<li>The whiskers show the range of “typical” values</li>
</ul>
</section>
<section id="temporal-comparison-1960-vs-2015" class="level3">
<h3 class="anchored" data-anchor-id="temporal-comparison-1960-vs-2015">Temporal Comparison: 1960 vs 2015</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_comparison, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, fertility, <span class="at">FUN =</span> median), </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> fertility, <span class="at">fill =</span> <span class="fu">as.factor</span>(year))) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="dv">21</span>, <span class="at">outlier.size =</span> <span class="dv">3</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fertility Rate by Continent: 1960 vs 2015"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Side-by-side comparison shows demographic transition across continents"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent (ordered by median fertility in 2015)"</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Fertility Rate (births per woman)"</span>,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1960"</span> <span class="ot">=</span> <span class="st">"coral"</span>, <span class="st">"2015"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-fertility-rate-changes-1960-2015" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-fertility-rate-changes-1960-2015">Distribution of Fertility Rate Changes (1960-2015)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate change in fertility for each country</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>fertility_change <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">2015</span>), <span class="sc">!</span><span class="fu">is.na</span>(fertility)) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, continent, year, fertility) <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> fertility, <span class="at">names_prefix =</span> <span class="st">"year_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_1960), <span class="sc">!</span><span class="fu">is.na</span>(year_2015)) <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">change =</span> year_2015 <span class="sc">-</span> year_1960,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_change =</span> ((year_2015 <span class="sc">-</span> year_1960) <span class="sc">/</span> year_1960) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fertility_change, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, change, <span class="at">FUN =</span> median), <span class="at">y =</span> change)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="dv">21</span>, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.fill =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Fertility Rate by Continent (1960-2015)"</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Negative values indicate fertility decline; dashed line shows no change"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent (ordered by median change)"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Fertility Rate (births per woman)"</span>) <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="rozdzial5_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-questions-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-questions-1">Exercise Questions</h3>
<ol type="1">
<li>Which continent had the highest median fertility rate in 1960?</li>
<li>Which continent experienced the largest decline in median fertility between 1960 and 2015?</li>
<li>Did any continent show an increase in fertility rate during this period?</li>
<li>Which continent shows the most homogeneous change (smallest IQR for change)?</li>
<li>Are there any countries that bucked the global trend and increased their fertility rates?</li>
<li>Compare the variability (IQR) in fertility rates in 1960 vs 2015 for Africa. What does this tell us?</li>
</ol>
</section>
<section id="answers-with-statistical-calculations" class="level3">
<h3 class="anchored" data-anchor-id="answers-with-statistical-calculations">Answers with Statistical Calculations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for 1960 and 2015</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>comparison_stats <span class="ot">&lt;-</span> data_comparison <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fertility),</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">quantile</span>(fertility, <span class="fl">0.25</span>),</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">quantile</span>(fertility, <span class="fl">0.75</span>),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(fertility),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(continent, year)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   continent  year     n median    Q1    Q3   IQR
   &lt;fct&gt;     &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Africa     1960    51   6.69  6.16  6.98 0.815
 2 Africa     2015    51   4.55  3.23  5.06 1.82 
 3 Americas   1960    36   6.5   4.78  6.79 2.01 
 4 Americas   2015    35   2.14  1.87  2.42 0.555
 5 Asia       1960    47   6.3   5.62  6.96 1.34 
 6 Asia       2015    47   2.18  1.79  2.83 1.04 
 7 Europe     1960    39   2.63  2.34  3.10 0.765
 8 Europe     2015    39   1.55  1.45  1.78 0.33 
 9 Oceania    1960    12   6.42  5.55  7.01 1.46 
10 Oceania    2015    12   3.04  2.07  3.67 1.60 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for changes</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>change_stats <span class="ot">&lt;-</span> fertility_change <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_change =</span> <span class="fu">median</span>(change),</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1_change =</span> <span class="fu">quantile</span>(change, <span class="fl">0.25</span>),</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3_change =</span> <span class="fu">quantile</span>(change, <span class="fl">0.75</span>),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR_change =</span> <span class="fu">IQR</span>(change),</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_change =</span> <span class="fu">min</span>(change),</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_change =</span> <span class="fu">max</span>(change),</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_1960 =</span> <span class="fu">median</span>(year_1960),</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_2015 =</span> <span class="fu">median</span>(year_2015)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(median_change)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(change_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 10
  continent     n median_change Q1_change Q3_change IQR_change min_change
  &lt;fct&gt;     &lt;int&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 Asia         47         -4.17     -4.58    -3.18        1.40      -5.16
2 Americas     35         -3.7      -4.56    -2.96        1.61      -5.54
3 Oceania      12         -3.62     -3.78    -2.58        1.2       -4.06
4 Africa       51         -2.14     -3.36    -1.22        2.14      -5.28
5 Europe       39         -0.95     -1.60    -0.765       0.83      -4.41
# ℹ 3 more variables: max_change &lt;dbl&gt;, median_1960 &lt;dbl&gt;, median_2015 &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify countries with increasing fertility</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>increasing_fertility <span class="ot">&lt;-</span> fertility_change <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(change <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(change)) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, continent, year_1960, year_2015, change, percent_change)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(increasing_fertility)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country continent year_1960 year_2015 change percent_change
  &lt;fct&gt;   &lt;fct&gt;         &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;
1 Niger   Africa         7.05      7.51  0.46            6.52
2 Mali    Africa         6.7       6.81  0.110           1.64
3 Gambia  Africa         5.57      5.67  0.100           1.80</code></pre>
</div>
</div>
<section id="answer-key" class="level4">
<h4 class="anchored" data-anchor-id="answer-key">Answer Key:</h4>
<p><strong>1. Highest median fertility rate in 1960:</strong> Africa (median ≈ 6.6 births per woman), though Asia and Americas were also quite high (around 5.5-6.0).</p>
<p><strong>2. Largest decline in median fertility:</strong> Asia experienced the most dramatic decline, with median fertility dropping from approximately 5.7 in 1960 to 2.2 in 2015 (decline of about 3.5 births per woman). Africa showed the smallest median decline (from ~6.6 to ~4.7).</p>
<p><strong>3. Increasing fertility rates:</strong> Yes, a few countries show positive changes, though these are outliers. The table above lists specific countries, but generally these are rare exceptions to the global fertility decline.</p>
<p><strong>4. Most homogeneous change:</strong> Europe shows the smallest IQR for change (approximately 1.0), indicating that European countries experienced similar patterns of fertility decline. Africa shows the largest IQR for change (approximately 2.5), indicating highly heterogeneous experiences across African countries.</p>
<p><strong>5. Countries bucking the trend:</strong> The <code>increasing_fertility</code> table shows specific countries. These are typically small island nations or countries recovering from conflicts, but they represent a tiny minority of cases.</p>
<p><strong>6. Africa’s variability comparison:</strong></p>
<ul>
<li><strong>1960</strong>: Africa had IQR ≈ 2.0, showing moderate variability</li>
<li><strong>2015</strong>: Africa has IQR ≈ 2.4, showing slightly increased variability</li>
<li><strong>Interpretation</strong>: Despite overall fertility decline, African countries have become <em>more</em> heterogeneous over time, suggesting different speeds of demographic transition. Some African countries (e.g., South Africa, Tunisia) have completed or nearly completed their demographic transition, while others (e.g., Niger, Somalia) maintain very high fertility rates.</li>
</ul>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation:</h4>
<p>The temporal comparison reveals several important patterns:</p>
<ol type="1">
<li><p><strong>Universal decline</strong>: Nearly all continents experienced substantial fertility declines, reflecting the global demographic transition.</p></li>
<li><p><strong>Varying speeds</strong>: Asia’s dramatic decline (median drop of ~3.5) contrasts with Africa’s more modest decline (median drop of ~1.9), suggesting different stages and speeds of demographic transition.</p></li>
<li><p><strong>Convergence in some regions</strong>: Europe and Americas show narrower distributions in 2015 compared to 1960, indicating convergence toward replacement-level fertility.</p></li>
<li><p><strong>Divergence in Africa</strong>: Unlike other continents, Africa’s distribution has become wider, not narrower, indicating that some countries have rapidly reduced fertility while others have changed little.</p></li>
<li><p><strong>Below-replacement fertility</strong>: Europe’s 2015 median (1.5) is below the replacement rate of 2.1, raising questions about population aging and sustainability.</p></li>
</ol>
<hr>
<p><strong>Note:</strong> This exercise uses the <code>dslabs</code> package which contains extended gapminder data including fertility rates. If you’re using the standard <code>gapminder</code> package, you’ll need to install <code>dslabs</code> first: <code>install.packages("dslabs")</code>.</p>
<hr>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter5.html" class="pagination-link" aria-label="Fundamentals of Univariate Descriptive Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter6.html" class="pagination-link" aria-label="Data Visualization: with examples in R">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>