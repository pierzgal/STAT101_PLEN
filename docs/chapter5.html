<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Fundamentals of Univariate Descriptive Statistics – Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rozdzial5.html" rel="next">
<link href="./rozdzial2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ffd282cb318059e0bcb130885a47f5dc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter5.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics: An Introduction (PL: Wprowadzenie do Statystyki)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Foundations of Statistics and Demography</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Podstawy Statystyki i Demografii</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Types in Social Sciences</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy statystyki opisowej jednej zmiennej</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Visualization: with examples in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rozdzial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Wizualizacja Danych: z przykładami w R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Correlation and Regression Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correg_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Wprowadzenie do Analizy Korelacji i Regresji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Wprowadzenie do Prawdopodobieństwa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_en.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference: The Logic of Statistical Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_pl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Wprowadzenie do Wnioskowania Statystycznego: Logika Testowania Hipotez Statystycznych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">5.1</span> Introduction</a></li>
  <li><a href="#overview-four-types-of-descriptive-measures" id="toc-overview-four-types-of-descriptive-measures" class="nav-link" data-scroll-target="#overview-four-types-of-descriptive-measures"><span class="header-section-number">5.2</span> Overview: Four Types of Descriptive Measures</a>
  <ul class="collapse">
  <li><a href="#measures-of-central-tendency" id="toc-measures-of-central-tendency" class="nav-link" data-scroll-target="#measures-of-central-tendency">1. Measures of Central Tendency</a></li>
  <li><a href="#measures-of-variability-dispersion" id="toc-measures-of-variability-dispersion" class="nav-link" data-scroll-target="#measures-of-variability-dispersion">2. Measures of Variability (Dispersion)</a></li>
  <li><a href="#measures-of-relative-position-standing" id="toc-measures-of-relative-position-standing" class="nav-link" data-scroll-target="#measures-of-relative-position-standing">3. Measures of Relative Position (Standing)</a></li>
  <li><a href="#measures-of-shape" id="toc-measures-of-shape" class="nav-link" data-scroll-target="#measures-of-shape">4. Measures of Shape</a></li>
  </ul></li>
  <li><a href="#measurement-scales-and-appropriate-statistics" id="toc-measurement-scales-and-appropriate-statistics" class="nav-link" data-scroll-target="#measurement-scales-and-appropriate-statistics"><span class="header-section-number">5.3</span> Measurement Scales and Appropriate Statistics</a>
  <ul class="collapse">
  <li><a href="#the-four-measurement-scales" id="toc-the-four-measurement-scales" class="nav-link" data-scroll-target="#the-four-measurement-scales">The Four Measurement Scales</a></li>
  <li><a href="#which-statistics-for-which-scales" id="toc-which-statistics-for-which-scales" class="nav-link" data-scroll-target="#which-statistics-for-which-scales">Which Statistics for Which Scales?</a></li>
  </ul></li>
  <li><a href="#sigma-notation" id="toc-sigma-notation" class="nav-link" data-scroll-target="#sigma-notation"><span class="header-section-number">5.4</span> Sigma Notation</a></li>
  <li><a href="#data-distribution-and-frequency-distribution" id="toc-data-distribution-and-frequency-distribution" class="nav-link" data-scroll-target="#data-distribution-and-frequency-distribution"><span class="header-section-number">5.5</span> Data Distribution and Frequency Distribution</a>
  <ul class="collapse">
  <li><a href="#what-is-a-data-distribution" id="toc-what-is-a-data-distribution" class="nav-link" data-scroll-target="#what-is-a-data-distribution">What is a Data Distribution?</a></li>
  <li><a href="#frequency-distribution" id="toc-frequency-distribution" class="nav-link" data-scroll-target="#frequency-distribution">Frequency Distribution</a></li>
  </ul></li>
  <li><a href="#measures-of-central-tendency-1" id="toc-measures-of-central-tendency-1" class="nav-link" data-scroll-target="#measures-of-central-tendency-1"><span class="header-section-number">5.6</span> Measures of Central Tendency</a>
  <ul class="collapse">
  <li><a href="#mean-arithmetic-average" id="toc-mean-arithmetic-average" class="nav-link" data-scroll-target="#mean-arithmetic-average">Mean (Arithmetic Average)</a></li>
  <li><a href="#median" id="toc-median" class="nav-link" data-scroll-target="#median">Median</a></li>
  <li><a href="#mode" id="toc-mode" class="nav-link" data-scroll-target="#mode">Mode</a></li>
  <li><a href="#comparing-mean-median-and-mode" id="toc-comparing-mean-median-and-mode" class="nav-link" data-scroll-target="#comparing-mean-median-and-mode">Comparing Mean, Median, and Mode</a></li>
  </ul></li>
  <li><a href="#measures-of-dispersion-variability" id="toc-measures-of-dispersion-variability" class="nav-link" data-scroll-target="#measures-of-dispersion-variability"><span class="header-section-number">5.7</span> Measures of Dispersion (Variability)</a>
  <ul class="collapse">
  <li><a href="#range" id="toc-range" class="nav-link" data-scroll-target="#range">Range</a></li>
  <li><a href="#variance-and-standard-deviation" id="toc-variance-and-standard-deviation" class="nav-link" data-scroll-target="#variance-and-standard-deviation">Variance and Standard Deviation</a></li>
  <li><a href="#interquartile-range-iqr" id="toc-interquartile-range-iqr" class="nav-link" data-scroll-target="#interquartile-range-iqr">Interquartile Range (IQR)</a></li>
  </ul></li>
  <li><a href="#measures-of-relative-position" id="toc-measures-of-relative-position" class="nav-link" data-scroll-target="#measures-of-relative-position"><span class="header-section-number">5.8</span> Measures of Relative Position</a>
  <ul class="collapse">
  <li><a href="#quantiles" id="toc-quantiles" class="nav-link" data-scroll-target="#quantiles">Quantiles</a></li>
  <li><a href="#percentiles" id="toc-percentiles" class="nav-link" data-scroll-target="#percentiles">Percentiles</a></li>
  <li><a href="#quartiles" id="toc-quartiles" class="nav-link" data-scroll-target="#quartiles">Quartiles</a></li>
  <li><a href="#computing-quartiles-the-tukey-method" id="toc-computing-quartiles-the-tukey-method" class="nav-link" data-scroll-target="#computing-quartiles-the-tukey-method">Computing Quartiles: The Tukey Method</a></li>
  </ul></li>
  <li><a href="#measures-of-shape-1" id="toc-measures-of-shape-1" class="nav-link" data-scroll-target="#measures-of-shape-1"><span class="header-section-number">5.9</span> Measures of Shape</a>
  <ul class="collapse">
  <li><a href="#skewness-asymmetry" id="toc-skewness-asymmetry" class="nav-link" data-scroll-target="#skewness-asymmetry">Skewness (Asymmetry)</a></li>
  <li><a href="#kurtosis-tailedness" id="toc-kurtosis-tailedness" class="nav-link" data-scroll-target="#kurtosis-tailedness">Kurtosis (Tailedness)</a></li>
  <li><a href="#modality-number-of-peaks" id="toc-modality-number-of-peaks" class="nav-link" data-scroll-target="#modality-number-of-peaks">Modality (Number of Peaks)</a></li>
  </ul></li>
  <li><a href="#visualization-histograms" id="toc-visualization-histograms" class="nav-link" data-scroll-target="#visualization-histograms"><span class="header-section-number">5.10</span> Visualization: Histograms</a>
  <ul class="collapse">
  <li><a href="#histogram-construction" id="toc-histogram-construction" class="nav-link" data-scroll-target="#histogram-construction">Histogram Construction</a></li>
  <li><a href="#choosing-the-optimal-number-of-bins" id="toc-choosing-the-optimal-number-of-bins" class="nav-link" data-scroll-target="#choosing-the-optimal-number-of-bins">Choosing the Optimal Number of Bins</a></li>
  <li><a href="#types-of-histograms-y-axis-scales" id="toc-types-of-histograms-y-axis-scales" class="nav-link" data-scroll-target="#types-of-histograms-y-axis-scales">Types of Histograms: Y-Axis Scales</a></li>
  <li><a href="#open-vs.-closed-bins" id="toc-open-vs.-closed-bins" class="nav-link" data-scroll-target="#open-vs.-closed-bins">Open vs.&nbsp;Closed Bins</a></li>
  <li><a href="#effect-of-number-of-bins" id="toc-effect-of-number-of-bins" class="nav-link" data-scroll-target="#effect-of-number-of-bins">Effect of Number of Bins</a></li>
  </ul></li>
  <li><a href="#visualization-tukey-boxplots" id="toc-visualization-tukey-boxplots" class="nav-link" data-scroll-target="#visualization-tukey-boxplots"><span class="header-section-number">5.11</span> Visualization: Tukey Boxplots</a>
  <ul class="collapse">
  <li><a href="#boxplot-construction" id="toc-boxplot-construction" class="nav-link" data-scroll-target="#boxplot-construction">Boxplot Construction</a></li>
  <li><a href="#comparing-multiple-groups-with-boxplots" id="toc-comparing-multiple-groups-with-boxplots" class="nav-link" data-scroll-target="#comparing-multiple-groups-with-boxplots">Comparing Multiple Groups with Boxplots</a></li>
  </ul></li>
  <li><a href="#summary-choosing-the-right-measure" id="toc-summary-choosing-the-right-measure" class="nav-link" data-scroll-target="#summary-choosing-the-right-measure"><span class="header-section-number">5.12</span> Summary: Choosing the Right Measure</a></li>
  <li><a href="#appendix-a-measures-of-relative-position-standing" id="toc-appendix-a-measures-of-relative-position-standing" class="nav-link" data-scroll-target="#appendix-a-measures-of-relative-position-standing"><span class="header-section-number">5.13</span> Appendix A: Measures of Relative Position (Standing)</a>
  <ul class="collapse">
  <li><a href="#quartiles-q-the-basics" id="toc-quartiles-q-the-basics" class="nav-link" data-scroll-target="#quartiles-q-the-basics">Quartiles (Q): The Basics</a></li>
  </ul></li>
  <li><a href="#appendix-b-manual-construction-of-tukey-boxplot" id="toc-appendix-b-manual-construction-of-tukey-boxplot" class="nav-link" data-scroll-target="#appendix-b-manual-construction-of-tukey-boxplot"><span class="header-section-number">5.14</span> Appendix B: Manual Construction of Tukey Boxplot</a></li>
  <li><a href="#appendix-c-comparative-analysis-using-tukey-boxplots" id="toc-appendix-c-comparative-analysis-using-tukey-boxplots" class="nav-link" data-scroll-target="#appendix-c-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">5.15</span> Appendix C: Comparative Analysis Using Tukey Boxplots</a></li>
  <li><a href="#understanding-tukey-boxplots" id="toc-understanding-tukey-boxplots" class="nav-link" data-scroll-target="#understanding-tukey-boxplots"><span class="header-section-number">5.16</span> Understanding Tukey Boxplots</a></li>
  <li><a href="#part-a-basic-comparisons" id="toc-part-a-basic-comparisons" class="nav-link" data-scroll-target="#part-a-basic-comparisons"><span class="header-section-number">5.17</span> Part A: Basic Comparisons</a>
  <ul class="collapse">
  <li><a href="#true-or-false" id="toc-true-or-false" class="nav-link" data-scroll-target="#true-or-false">True or False:</a></li>
  </ul></li>
  <li><a href="#part-b-changes-over-time" id="toc-part-b-changes-over-time" class="nav-link" data-scroll-target="#part-b-changes-over-time"><span class="header-section-number">5.18</span> Part B: Changes Over Time</a>
  <ul class="collapse">
  <li><a href="#true-or-false-1" id="toc-true-or-false-1" class="nav-link" data-scroll-target="#true-or-false-1">True or False:</a></li>
  </ul></li>
  <li><a href="#part-c-summary-statistics" id="toc-part-c-summary-statistics" class="nav-link" data-scroll-target="#part-c-summary-statistics"><span class="header-section-number">5.19</span> Part C: Summary Statistics</a></li>
  <li><a href="#thinking-questions" id="toc-thinking-questions" class="nav-link" data-scroll-target="#thinking-questions"><span class="header-section-number">5.20</span> Thinking Questions</a></li>
  <li><a href="#solutions-1" id="toc-solutions-1" class="nav-link" data-scroll-target="#solutions-1"><span class="header-section-number">5.21</span> Solutions</a>
  <ul class="collapse">
  <li><a href="#part-a-basic-comparisons-1" id="toc-part-a-basic-comparisons-1" class="nav-link" data-scroll-target="#part-a-basic-comparisons-1">Part A: Basic Comparisons</a></li>
  <li><a href="#part-b-changes-over-time-1" id="toc-part-b-changes-over-time-1" class="nav-link" data-scroll-target="#part-b-changes-over-time-1">Part B: Changes Over Time</a></li>
  <li><a href="#thinking-questions-sample-answers" id="toc-thinking-questions-sample-answers" class="nav-link" data-scroll-target="#thinking-questions-sample-answers">Thinking Questions: Sample Answers</a></li>
  </ul></li>
  <li><a href="#appendix-d-comparative-analysis-using-tukey-boxplots" id="toc-appendix-d-comparative-analysis-using-tukey-boxplots" class="nav-link" data-scroll-target="#appendix-d-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">5.22</span> Appendix D: Comparative Analysis Using Tukey Boxplots</a>
  <ul class="collapse">
  <li><a href="#understanding-tukey-boxplots-1" id="toc-understanding-tukey-boxplots-1" class="nav-link" data-scroll-target="#understanding-tukey-boxplots-1">Understanding Tukey Boxplots</a></li>
  <li><a href="#temporal-comparison-1960-vs-2015" id="toc-temporal-comparison-1960-vs-2015" class="nav-link" data-scroll-target="#temporal-comparison-1960-vs-2015">Temporal Comparison: 1960 vs 2015</a></li>
  <li><a href="#distribution-of-fertility-rate-changes-1960-2015" id="toc-distribution-of-fertility-rate-changes-1960-2015" class="nav-link" data-scroll-target="#distribution-of-fertility-rate-changes-1960-2015">Distribution of Fertility Rate Changes (1960-2015)</a></li>
  <li><a href="#exercise-questions-1" id="toc-exercise-questions-1" class="nav-link" data-scroll-target="#exercise-questions-1">Exercise Questions</a></li>
  <li><a href="#answers-with-statistical-calculations" id="toc-answers-with-statistical-calculations" class="nav-link" data-scroll-target="#answers-with-statistical-calculations">Answers with Statistical Calculations</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Fundamentals of Univariate Descriptive Statistics</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">5.1</span> Introduction</h2>
<p><strong>Univariate descriptive statistics</strong> help us summarize and understand the characteristics of a single variable. When we collect data, we often have many observations that are difficult to interpret without some form of summary. Descriptive statistics allow us to:</p>
<ul>
<li>Identify the “typical” or “central” value in our data</li>
<li>Understand how spread out or variable the data are</li>
<li>Detect unusual observations (outliers)</li>
<li>Communicate findings efficiently to others</li>
</ul>
<p>In this chapter, we will explore the fundamental tools for describing numerical data, starting with basic notation and progressing through measures of central tendency, dispersion, and visualization techniques.</p>
</section>
<section id="overview-four-types-of-descriptive-measures" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="overview-four-types-of-descriptive-measures"><span class="header-section-number">5.2</span> Overview: Four Types of Descriptive Measures</h2>
<p>Univariate descriptive statistics can be organized into four main categories, each addressing a different question about our data:</p>
<section id="measures-of-central-tendency" class="level3">
<h3 class="anchored" data-anchor-id="measures-of-central-tendency">1. Measures of Central Tendency</h3>
<p><strong>Question:</strong> What is the “typical” or “average” value?</p>
<p><strong>Common measures:</strong></p>
<ul>
<li>Mean (arithmetic average)</li>
<li>Median (middle value)</li>
<li>Mode (most frequent value)</li>
</ul>
<p><strong>Purpose:</strong> These measures help us identify where the “center” of the data is located. They provide a single value that represents the entire dataset.</p>
</section>
<section id="measures-of-variability-dispersion" class="level3">
<h3 class="anchored" data-anchor-id="measures-of-variability-dispersion">2. Measures of Variability (Dispersion)</h3>
<p><strong>Question:</strong> How spread out are the data? How much do observations differ from each other?</p>
<p><strong>Common measures:</strong></p>
<ul>
<li>Range (max - min)</li>
<li>Variance (average squared deviation from mean)</li>
<li>Standard deviation (square root of variance)</li>
<li>Interquartile range (IQR - spread of middle 50%)</li>
</ul>
<p><strong>Purpose:</strong> These measures tell us whether observations cluster tightly around the center or are widely dispersed. Two datasets can have the same mean but very different variability.</p>
</section>
<section id="measures-of-relative-position-standing" class="level3">
<h3 class="anchored" data-anchor-id="measures-of-relative-position-standing">3. Measures of Relative Position (Standing)</h3>
<p><strong>Question:</strong> Where does a particular observation stand relative to others? What proportion of data falls below a given value?</p>
<p><strong>Common measures:</strong></p>
<ul>
<li>Quantiles (values that divide a dataset into equal-sized subgroups, where each subgroup has an equal probability of containing an observation)</li>
<li>Percentiles (divide data into 100 parts)</li>
<li>Quartiles (divide data into 4 parts)</li>
<li>Standardized scores (z-scores)</li>
</ul>
<p><strong>Purpose:</strong> These measures help us understand the position of individual observations within the overall distribution. They answer questions like “How does this student’s score compare to others?”</p>
</section>
<section id="measures-of-shape" class="level3">
<h3 class="anchored" data-anchor-id="measures-of-shape">4. Measures of Shape</h3>
<p><strong>Question:</strong> What is the overall form or pattern of the distribution?</p>
<p><strong>Common measures:</strong></p>
<ul>
<li>Skewness (asymmetry - is there a long tail on one side?)</li>
<li>Kurtosis (tailedness - are there many extreme values?)</li>
<li>Modality (number of peaks - unimodal, bimodal, multimodal)</li>
</ul>
<p><strong>Purpose:</strong> These measures describe the overall pattern of the distribution. While we won’t calculate these numerically in this course, we will identify shape characteristics visually using histograms and boxplots.</p>
<p><strong>Relationship between categories:</strong></p>
<p>These four types of measures complement each other. A complete description of univariate data typically includes:</p>
<ul>
<li>At least one measure of central tendency (mean or median)</li>
<li>At least one measure of variability (standard deviation or IQR)</li>
<li>Visual displays (histogram, boxplot) that reveal shape</li>
<li>Information about relative position when comparing specific observations</li>
</ul>
<p>In the sections that follow, we will explore each of these categories in detail, starting with the mathematical notation needed to express these concepts precisely.</p>
</section>
</section>
<section id="measurement-scales-and-appropriate-statistics" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="measurement-scales-and-appropriate-statistics"><span class="header-section-number">5.3</span> Measurement Scales and Appropriate Statistics</h2>
<p>Before diving into specific statistical measures, it’s important to understand that <strong>not all statistics are appropriate for all types of data</strong>. The type of measurement scale determines which statistical measures we can meaningfully use.</p>
<section id="the-four-measurement-scales" class="level3">
<h3 class="anchored" data-anchor-id="the-four-measurement-scales">The Four Measurement Scales</h3>
<p><strong>1. Nominal Scale</strong></p>
<p>Categories with no inherent order (e.g., gender, country, political party affiliation, eye color).</p>
<p><strong>Properties:</strong> Categories are different, but we cannot say one is “greater than” another.</p>
<p><strong>2. Ordinal Scale</strong></p>
<p>Categories with a meaningful order, but intervals between categories are not necessarily equal (e.g., education level: elementary/high school/bachelor’s/master’s/PhD; survey responses: strongly disagree/disagree/neutral/agree/strongly agree).</p>
<p><strong>Properties:</strong> We can rank observations, but we cannot quantify the difference between ranks.</p>
<p><strong>3. Interval Scale</strong></p>
<p>Numeric scale with equal intervals, but no true zero point (e.g., temperature in Celsius or Fahrenheit, calendar years).</p>
<p><strong>Properties:</strong> Differences are meaningful (20°C to 30°C is the same change as 30°C to 40°C), but ratios are not (20°C is not “twice as hot” as 10°C).</p>
<p><strong>4. Ratio Scale</strong></p>
<p>Numeric scale with equal intervals AND a true zero point (e.g., height, weight, income, age, distance).</p>
<p><strong>Properties:</strong> Both differences and ratios are meaningful (20 kg is twice as heavy as 10 kg).</p>
</section>
<section id="which-statistics-for-which-scales" class="level3">
<h3 class="anchored" data-anchor-id="which-statistics-for-which-scales">Which Statistics for Which Scales?</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Measure</th>
<th>Nominal</th>
<th>Ordinal</th>
<th>Interval</th>
<th>Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Mode</strong></td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><strong>Median</strong></td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><strong>Mean</strong></td>
<td>✗</td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><strong>Range</strong></td>
<td>✗</td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><strong>Variance/Std. Dev.</strong></td>
<td>✗</td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="even">
<td><strong>IQR</strong></td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr class="odd">
<td><strong>Quantiles/Percentiles</strong></td>
<td>✗</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
</tbody>
</table>
<p><strong>Key insights:</strong></p>
<ul>
<li><strong>Nominal data:</strong> Only the mode makes sense. We can count frequencies, but we cannot calculate means or medians.</li>
<li><strong>Ordinal data:</strong> The median and IQR are appropriate because they only require ordering. The mean is not appropriate because it assumes equal intervals.</li>
<li><strong>Interval/Ratio data:</strong> All measures are appropriate. These are the most flexible measurement scales.</li>
</ul>
<p><strong>Example illustrating why scale matters:</strong></p>
<p>Consider education levels: elementary (1), high school (2), bachelor’s (3), master’s (4), PhD (5).</p>
<ul>
<li><strong>Mode:</strong> Valid - “Most respondents have a bachelor’s degree”</li>
<li><strong>Median:</strong> Valid - “The median education level is bachelor’s degree”</li>
<li><strong>Mean:</strong> Problematic - “The mean education level is 3.2” is hard to interpret because the intervals between levels are not equal (the difference between elementary and high school is not the same as the difference between master’s and PhD)</li>
</ul>
<p>Throughout this chapter, we will focus primarily on interval and ratio data, where all statistical measures are appropriate. However, keep these distinctions in mind when working with different types of data in practice.</p>
</section>
</section>
<section id="sigma-notation" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sigma-notation"><span class="header-section-number">5.4</span> Sigma Notation</h2>
<p>Before we dive into statistical measures, we need to understand <strong>sigma notation</strong>, which provides a compact way to express the sum of many values.</p>
<p>The Greek letter <span class="math inline">\Sigma</span> (capital sigma) means “sum.” When we write:</p>
<p><span class="math display">\sum_{i=1}^{n} x_i</span></p>
<p>This means: “Add up all values of <span class="math inline">x</span> from the first observation (<span class="math inline">i=1</span>) to the last observation (<span class="math inline">i=n</span>).”</p>
<p><strong>Breaking down the notation:</strong></p>
<ul>
<li><span class="math inline">\Sigma</span> = the summation operator (“add these up”)</li>
<li><span class="math inline">i=1</span> (below <span class="math inline">\Sigma</span>) = start with the first observation</li>
<li><span class="math inline">n</span> (above <span class="math inline">\Sigma</span>) = continue until the <span class="math inline">n</span>-th observation</li>
<li><span class="math inline">x_i</span> = the value of variable <span class="math inline">x</span> for observation <span class="math inline">i</span></li>
</ul>
<p><strong>Example:</strong></p>
<p>Suppose we have five observations: <span class="math inline">x_1 = 2</span>, <span class="math inline">x_2 = 5</span>, <span class="math inline">x_3 = 3</span>, <span class="math inline">x_4 = 8</span>, <span class="math inline">x_5 = 7</span></p>
<p>Then:</p>
<p><span class="math display">\sum_{i=1}^{5} x_i = x_1 + x_2 + x_3 + x_4 + x_5 = 2 + 5 + 3 + 8 + 7 = 25</span></p>
<p><strong>Useful sigma notation properties:</strong></p>
<p><span class="math display">\sum_{i=1}^{n} (x_i + y_i) = \sum_{i=1}^{n} x_i + \sum_{i=1}^{n} y_i</span></p>
<p><span class="math display">\sum_{i=1}^{n} c \cdot x_i = c \sum_{i=1}^{n} x_i \text{ (where } c \text{ is a constant)}</span></p>
</section>
<section id="data-distribution-and-frequency-distribution" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="data-distribution-and-frequency-distribution"><span class="header-section-number">5.5</span> Data Distribution and Frequency Distribution</h2>
<section id="what-is-a-data-distribution" class="level3">
<h3 class="anchored" data-anchor-id="what-is-a-data-distribution">What is a Data Distribution?</h3>
<p>A <strong>data distribution</strong> refers to how values in a dataset are spread across the possible range of values. Understanding the distribution helps us see patterns, identify typical values, and detect unusual observations.</p>
<p>When we talk about a distribution, we are asking: “What values occur in our data, and how often does each value (or range of values) appear?”</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/bellcurvece.svg" class="img-fluid figure-img"></p>
<figcaption>Normal (Bell Curve) shape: https://mathspace.co/textbooks/syllabuses/Syllabus-786/topics/Topic-12842/subtopics/Subtopic-171745/?activeTab=theory</figcaption>
</figure>
</div>
</section>
<section id="frequency-distribution" class="level3">
<h3 class="anchored" data-anchor-id="frequency-distribution">Frequency Distribution</h3>
<p>A <strong>frequency distribution</strong> organizes data by showing how many times each value (or range of values) occurs. This can be presented as:</p>
<ul>
<li>A table showing values and their counts</li>
<li>A relative frequency distribution (showing proportions or percentages)</li>
<li>A cumulative frequency distribution (showing running totals)</li>
</ul>
<p><strong>Example:</strong></p>
<p>Suppose we surveyed 20 students about how many books they read last month:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>books <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create frequency table</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(books))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(freq_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Books_Read"</span>, <span class="st">"Frequency"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>freq_table<span class="sc">$</span>Relative_Frequency <span class="ot">&lt;-</span> freq_table<span class="sc">$</span>Frequency <span class="sc">/</span> <span class="fu">sum</span>(freq_table<span class="sc">$</span>Frequency)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>freq_table<span class="sc">$</span>Cumulative_Frequency <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(freq_table<span class="sc">$</span>Frequency)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(freq_table, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Books Read"</span>, <span class="st">"Frequency"</span>, <span class="st">"Relative Frequency"</span>, <span class="st">"Cumulative Frequency"</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"Frequency Distribution of Books Read"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Frequency Distribution of Books Read</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Books Read</th>
<th style="text-align: right;">Frequency</th>
<th style="text-align: right;">Relative Frequency</th>
<th style="text-align: right;">Cumulative Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">8</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Frequency:</strong> The count of students who read that number of books</li>
<li><strong>Relative Frequency:</strong> The proportion of all students (e.g., 0.20 = 20% read 5 books)</li>
<li><strong>Cumulative Frequency:</strong> The running total (e.g., 10 students read 5 or fewer books)</li>
</ul>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. UNIFORM DISTRIBUTION</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>uniform_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">100</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(uniform_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Uniform Distribution"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Lottery numbers, random assignment"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. NORMAL DISTRIBUTION</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>normal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(normal_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normal Distribution"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: IQ scores (mean=100, sd=15)"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"IQ Score"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. LOG-NORMAL DISTRIBUTION</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>lognormal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rlnorm</span>(<span class="dv">10000</span>, <span class="at">meanlog =</span> <span class="fl">10.5</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(lognormal_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"darkred"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Normal Distribution"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Income distribution"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Income (PLN)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. EXPONENTIAL DISTRIBUTION</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>exponential_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rexp</span>(<span class="dv">10000</span>, <span class="at">rate =</span> <span class="fl">0.5</span>))</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(exponential_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"purple"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Exponential Distribution"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Time between votes being cast at a polling station"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Time (minutes)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. BIMODAL DISTRIBUTION</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>bimodal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">3000</span>, <span class="at">mean =</span> <span class="dv">45</span>, <span class="at">sd =</span> <span class="dv">8</span>),   <span class="co"># students who didn't study well</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rnorm</span>(<span class="dv">7000</span>, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">7</span>))    <span class="co"># students who studied well</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(bimodal_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bimodal Distribution"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Exam scores (two groups of students)"</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Score (0-100)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. BETA DISTRIBUTION</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>beta_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rbeta</span>(<span class="dv">10000</span>, <span class="at">shape1 =</span> <span class="dv">5</span>, <span class="at">shape2 =</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(beta_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">"navy"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Beta Distribution (Negatively Skewed)"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Example: Exam scores (easier test)"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Score (0-100)"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4) <span class="sc">/</span> (p5 <span class="sc">|</span> p6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-distributions" class="quarto-float quarto-figure quarto-figure-center anchored" width="3600">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter5_files/figure-html/fig-distributions-1.png" id="fig-distributions" class="img-fluid figure-img" width="3600">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="measures-of-central-tendency-1" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="measures-of-central-tendency-1"><span class="header-section-number">5.6</span> Measures of Central Tendency</h2>
<p>Measures of central tendency tell us about the “typical” or “central” value in a dataset. The three most common measures are the mean, median, and mode.</p>
<p><strong>Applicable measurement scales:</strong></p>
<ul>
<li><strong>Mode:</strong> Nominal, Ordinal, Interval, Ratio</li>
<li><strong>Median:</strong> Ordinal, Interval, Ratio (requires ordering)</li>
<li><strong>Mean:</strong> Interval, Ratio (requires equal intervals and arithmetic operations)</li>
</ul>
<section id="mean-arithmetic-average" class="level3">
<h3 class="anchored" data-anchor-id="mean-arithmetic-average">Mean (Arithmetic Average)</h3>
<p>The <strong>mean</strong> is the sum of all values divided by the number of observations. It represents the arithmetic average.</p>
<p><strong>Applicable to:</strong> Interval and Ratio data only</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i = \frac{x_1 + x_2 + \cdots + x_n}{n}</span></p>
<p>where <span class="math inline">\bar{x}</span> (pronounced “x-bar”) is the sample mean and <span class="math inline">n</span> is the number of observations.</p>
<p><strong>Example:</strong></p>
<p>If we have test scores: 75, 82, 88, 90, 95</p>
<p><span class="math display">\bar{x} = \frac{75 + 82 + 88 + 90 + 95}{5} = \frac{430}{5} = 86</span></p>
<p><strong>Plain English:</strong> The mean is what we get if we could redistribute all the values equally among all observations. If five students scored a total of 430 points, they would each get 86 points if we divided the total evenly.</p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Mean as a Balancing Point
</div>
</div>
<div class="callout-body-container callout-body">
<p>One of the most important conceptual ways to understand the mean is to think of it as a <strong>balancing point</strong> or <strong>center of gravity</strong> of the data.</p>
<p>Imagine placing weights on a seesaw at positions corresponding to your data values. The mean is the point where the seesaw would be perfectly balanced.</p>
<p><strong>Mathematical insight:</strong></p>
<p>The sum of deviations from the mean always equals zero:</p>
<p><span class="math display">\sum_{i=1}^{n} (x_i - \bar{x}) = 0</span></p>
<p>This means that positive deviations (values above the mean) exactly cancel out negative deviations (values below the mean).</p>
<p>Let’s consider a dataset <span class="math inline">X = \{1, 2, 6, 7, 9\}</span> on a number line, imagining it as a seesaw:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4336.jpg" class="img-fluid figure-img"></p>
<figcaption>https://www.gastonsanchez.com/matrix4sl/mean-as-a-balancing-point.html</figcaption>
</figure>
</div>
<p>The mean (<span class="math inline">\mu</span>) acts as the perfect <strong>balance point</strong> of this seesaw. For our data:</p>
<p><span class="math inline">\mu = \frac{1 + 2 + 6 + 7 + 9}{5} = 5</span></p>
<section id="what-happens-at-different-support-points" class="level3">
<h3 class="anchored" data-anchor-id="what-happens-at-different-support-points">What happens at different support points? 🤔</h3>
<p>Let’s test three different positions for the fulcrum (support point) to understand why the mean is special:</p>
<ol type="1">
<li><strong>Support point at 6</strong> (too high):
<ul>
<li>Values below 6: 1, 2</li>
<li>Values above 6: 7, 9</li>
<li><span class="math inline">\sum</span> distances from values below = <span class="math inline">(6-1) + (6-2) = 9</span></li>
<li><span class="math inline">\sum</span> distances from values above = <span class="math inline">(7-6) + (9-6) = 4</span></li>
<li>The seesaw tilts left! ⬅️ because <span class="math inline">9 &gt; 4</span></li>
</ul></li>
<li><strong>Support point at 4</strong> (too low):
<ul>
<li>Values below 4: 1, 2</li>
<li>Values above 4: 6, 7, 9</li>
<li><span class="math inline">\sum</span> distances from values below = <span class="math inline">(4-1) + (4-2) = 5</span></li>
<li><span class="math inline">\sum</span> distances from values above = <span class="math inline">(6-4) + (7-4) + (9-4) = 10</span></li>
<li>The seesaw tilts right! ➡️ because <span class="math inline">5 &lt; 10</span></li>
</ul></li>
<li><strong>Support point at mean (5)</strong> (perfect balance):
<ul>
<li>Values below 5: 1, 2</li>
<li>Values above 5: 6, 7, 9</li>
<li><span class="math inline">\sum</span> distances below = <span class="math inline">(5-1) + (5-2) = 7</span></li>
<li><span class="math inline">\sum</span> distances above = <span class="math inline">(6-5) + (7-5) + (9-5) = 7</span></li>
<li><span class="math inline">7 = 7</span> ✨ Perfect balance!</li>
</ul></li>
</ol>
<p>This shows why the mean is the unique balance point, where:</p>
<p><span class="math display">\sum_{i=1}^n (x_i - \mu) = 0</span></p>
<p>The seesaw will always tilt unless the support point is placed exactly at the mean! 🎪</p>
<hr>
<p>This visualization shows how the arithmetic mean (5) acts as a balance point for our dataset {1, 2, 6, 7, 9}:</p>
<p><strong>Left side of the mean:</strong></p>
<ul>
<li>Points with values 1 and 2</li>
<li>Close together (difference of 1 unit)</li>
<li>Distances from mean: 4 and 3 units</li>
<li>Sum of “pull” = 7 units</li>
</ul>
<p><strong>Right side of the mean:</strong></p>
<ul>
<li>Points with values 6, 7, and 9</li>
<li>More spread out (differences of 1 and 2 units)</li>
<li>Distances from mean: 1, 2, and 4 units</li>
<li>Sum of “pull” = 7 units</li>
</ul>
<p><strong>Key observations:</strong></p>
<ol type="1">
<li>The mean (5) is a balance point, even though:
<ul>
<li>There are only 2 points on the left (1, 2)</li>
<li>There are 3 points on the right (6, 7, 9)</li>
<li>Green arrows show distances from the mean</li>
</ul></li>
<li>Balance is maintained because:
<ul>
<li>Sum of distances balances out: <span class="math inline">(5-1) + (5-2) = (6-5) + (7-5) + (9-5)</span></li>
<li>Total sum of distances = 7 units on each side</li>
<li>The number of points doesn’t matter—only the total distance!</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 12</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 7</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.align: 'center'</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data - using the consistent dataset</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>mean_val <span class="ot">&lt;-</span> <span class="fu">mean</span>(values)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe for plotting</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> values,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(values)),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">arrow_height =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.15</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>, <span class="fl">0.35</span>),  <span class="co"># Separated heights for arrows</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">value_label_height =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.05</span>, <span class="fl">0.25</span>)  <span class="co"># Labels between arrows</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the visualization</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the fulcrum triangle</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">c</span>(mean_val <span class="sc">-</span> <span class="fl">0.3</span>, mean_val <span class="sc">+</span> <span class="fl">0.3</span>, mean_val),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="dv">0</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  ), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">"darkgray"</span>) <span class="sc">+</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the lever/beam</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">min</span>(values) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="fu">max</span>(values) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>),</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"brown"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add points with different colors for left and right side</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">side =</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> mean_val, <span class="st">"left"</span>, <span class="st">"right"</span>)), </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> side), </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"left"</span> <span class="ot">=</span> <span class="st">"royalblue"</span>, <span class="st">"right"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>)) <span class="sc">+</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add mean point</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_val, <span class="at">y =</span> <span class="dv">0</span>), </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First set of arrows (upper)</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, arrow_height <span class="sc">&gt;</span> <span class="fl">0.3</span>), </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> mean_val,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> arrow_height, <span class="at">yend =</span> arrow_height),</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>              <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>), </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ends =</span> <span class="st">"both"</span>),</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Second set of arrows (lower)</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, arrow_height <span class="sc">&lt;</span> <span class="fl">0.3</span>), </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> mean_val,</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> arrow_height, <span class="at">yend =</span> arrow_height),</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>              <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>), </span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ends =</span> <span class="st">"both"</span>),</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add value labels between arrows</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> data, </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value_label_height, <span class="at">label =</span> x),</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.5</span>,</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">"white"</span>,</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"lines"</span>)) <span class="sc">+</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add mean label</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_val, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.4</span>, </span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Mean ="</span>, <span class="fu">round</span>(mean_val, <span class="dv">2</span>))),</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">4.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add distance labels</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> data, </span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> (x <span class="sc">+</span> mean_val)<span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> arrow_height <span class="sc">+</span> <span class="fl">0.08</span>,</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">abs</span>(x <span class="sc">-</span> mean_val), <span class="dv">2</span>)),</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Customize the theme</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Understanding Arithmetic Mean as a Balance Point"</span>,</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Dataset: {1, 2, 6, 7, 9} | Mean ="</span>, <span class="fu">round</span>(mean_val, <span class="dv">2</span>), <span class="st">"balances uneven distances on both sides"</span>),</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Values"</span>,</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">0.8</span>), </span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>                 <span class="at">expand =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weighted Arithmetic Mean
</div>
</div>
<div class="callout-body-container callout-body">
<p>In many situations, we work with <strong>frequency distributions</strong> where values occur multiple times. Instead of writing out each value repeatedly, we can use a <strong>weighted mean</strong> that accounts for how often each value appears.</p>
<p><strong>For Absolute Frequencies:</strong></p>
<p>When we have a frequency distribution with values <span class="math inline">x_1, x_2, \ldots, x_k</span> occurring <span class="math inline">f_1, f_2, \ldots, f_k</span> times respectively (where <span class="math inline">n = \sum_{i=1}^{k} f_i</span>), the weighted mean is:</p>
<p><span class="math display">\bar{x}_w = \frac{\sum_{i=1}^{k} f_i \cdot x_i}{\sum_{i=1}^{k} f_i} = \frac{f_1 x_1 + f_2 x_2 + \cdots + f_k x_k}{f_1 + f_2 + \cdots + f_k}</span></p>
<p>Since <span class="math inline">\sum_{i=1}^{k} f_i = n</span>, we can simplify this to:</p>
<p><span class="math display">\bar{x}_w = \frac{\sum_{i=1}^{k} f_i \cdot x_i}{n} = \frac{1}{n}\sum_{i=1}^{k} f_i \cdot x_i</span></p>
<p><strong>For Relative Frequencies (Normalized):</strong></p>
<p>When frequencies are expressed as proportions <span class="math inline">p_i = \frac{f_i}{n}</span> (where <span class="math inline">\sum_{i=1}^{k} p_i = 1</span>), the formula simplifies to:</p>
<p><span class="math display">\bar{x}_w = \sum_{i=1}^{k} p_i \cdot x_i = p_1 x_1 + p_2 x_2 + \cdots + p_k x_k</span></p>
<p><strong>Example (Manual Calculation):</strong></p>
<p>Suppose we survey students about hours spent studying per week:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Hours <span class="math inline">(x_i)</span></th>
<th>Frequency <span class="math inline">(f_i)</span></th>
<th>Relative Freq. <span class="math inline">(p_i)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>3</td>
<td>0.15</td>
</tr>
<tr class="even">
<td>10</td>
<td>8</td>
<td>0.40</td>
</tr>
<tr class="odd">
<td>15</td>
<td>7</td>
<td>0.35</td>
</tr>
<tr class="even">
<td>20</td>
<td>2</td>
<td>0.10</td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><span class="math inline">n = 20</span></td>
<td>1.00</td>
</tr>
</tbody>
</table>
<p><strong>Using absolute frequencies:</strong></p>
<p><span class="math display">\bar{x}_w = \frac{(3 \times 5) + (8 \times 10) + (7 \times 15) + (2 \times 20)}{20} = \frac{15 + 80 + 105 + 40}{20} = \frac{240}{20} = 12</span></p>
<p><strong>Using relative frequencies:</strong></p>
<p><span class="math display">\bar{x}_w = (0.15 \times 5) + (0.40 \times 10) + (0.35 \times 15) + (0.10 \times 20)</span></p>
<p><span class="math display">= 0.75 + 4.00 + 5.25 + 2.00 = 12</span></p>
<p>Both methods give the same result: students study an average of 12 hours per week.</p>
<p><strong>Plain English:</strong> When some values appear more frequently than others, we “weight” them by how often they occur. A value that appears 8 times contributes 8 times more to the average than a value that appears once.</p>
</div>
</div>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Other Types of Means: Geometric and Harmonic
</div>
</div>
<div class="callout-body-container callout-body">
<p>While the <strong>arithmetic mean</strong> is by far the most commonly used measure of central tendency in social sciences, two other types of means exist for special purposes:</p>
<p><strong>Geometric Mean:</strong></p>
<p><span class="math display">\bar{x}_G = \sqrt[n]{x_1 \cdot x_2 \cdot \ldots \cdot x_n} = (x_1 \cdot x_2 \cdot \ldots \cdot x_n)^{1/n}</span></p>
<ul>
<li>Used for: Growth rates, rates of change, averaging ratios</li>
<li>Example: Average annual GDP growth over multiple years</li>
<li>Important: All values must be positive</li>
</ul>
<p><strong>Harmonic Mean:</strong></p>
<p><span class="math display">\bar{x}_H = \frac{n}{\frac{1}{x_1} + \frac{1}{x_2} + \cdots + \frac{1}{x_n}} = \frac{n}{\sum_{i=1}^{n} \frac{1}{x_i}}</span></p>
<ul>
<li>Used for: Averaging rates and speeds</li>
<li>Example: Average speed when distances are equal but times differ</li>
<li>Important: All values must be non-zero</li>
</ul>
<p><strong>Important relationship:</strong> For any positive dataset: <span class="math inline">\bar{x}_H \leq \bar{x}_G \leq \bar{x}</span> (harmonic ≤ geometric ≤ arithmetic)</p>
<p>In most social science applications, these alternative means are rarely needed. Stick with the arithmetic mean unless you have a specific theoretical reason to use another type.</p>
</div>
</div>
<hr>
</section>
<section id="median" class="level3">
<h3 class="anchored" data-anchor-id="median">Median</h3>
<p>The <strong>median</strong> is the middle value when data are arranged in order. It divides the dataset into two equal halves. The median is the middle value that separates the ordered data into two equal-sized groups, where the median itself is not included in either group when n is odd.</p>
<p><strong>Applicable to:</strong> Ordinal, Interval, and Ratio data (requires ordering)</p>
<p><strong>How to find the median:</strong></p>
<ol type="1">
<li>Sort the data from smallest to largest</li>
<li>If <span class="math inline">n</span> is odd: the median is the middle value at position <span class="math inline">\frac{n+1}{2}</span></li>
<li>If <span class="math inline">n</span> is even: the median is the average of the two middle values at positions <span class="math inline">\frac{n}{2}</span> and <span class="math inline">\frac{n}{2} + 1</span></li>
</ol>
<p><strong>Example with odd <span class="math inline">n</span>:</strong></p>
<p>Data: 3, 7, 8, 12, 15 (already sorted, <span class="math inline">n = 5</span>)</p>
<p>Position of median: <span class="math inline">\frac{5+1}{2} = 3</span></p>
<p>Median = 8 (the third value)</p>
<p><strong>Example with even <span class="math inline">n</span>:</strong></p>
<p>Data: 3, 7, 8, 12, 15, 20 (already sorted, <span class="math inline">n = 6</span>)</p>
<p>The two middle values are at positions 3 and 4: 8 and 12</p>
<p><span class="math display">\text{Median} = \frac{8 + 12}{2} = 10</span></p>
<p><strong>Plain English:</strong> The median is the value that sits in the middle when we line up all observations from smallest to largest.</p>
<p><strong>Key advantage:</strong> The median is <strong>resistant to outliers</strong>. Extreme values don’t affect it much, making it useful when data contain outliers.</p>
</section>
<section id="mode" class="level3">
<h3 class="anchored" data-anchor-id="mode">Mode</h3>
<p>The <strong>mode</strong> is the value that appears most frequently in the dataset.</p>
<p><strong>Applicable to:</strong> Nominal, Ordinal, Interval, and Ratio data (all scales)</p>
<p><strong>Properties:</strong></p>
<ul>
<li>A dataset can have no mode (all values appear equally often)</li>
<li>A dataset can have one mode (unimodal)</li>
<li>A dataset can have multiple modes (bimodal, multimodal)</li>
</ul>
<p><strong>Example:</strong></p>
<p>Data: 2, 3, 3, 5, 5, 5, 7, 8, 8</p>
<p>Mode = 5 (appears three times, more than any other value)</p>
<p><strong>Plain English:</strong> The mode tells us which value is most common or typical in the dataset. It’s particularly useful for categorical data (e.g., “blue” is the most common eye color in the sample).</p>
</section>
<section id="comparing-mean-median-and-mode" class="level3">
<h3 class="anchored" data-anchor-id="comparing-mean-median-and-mode">Comparing Mean, Median, and Mode</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate distributions</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>left_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">2000</span>, <span class="dv">8</span>, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>symmetric <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>, <span class="dv">55</span>, <span class="dv">8</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>right_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">2000</span>, <span class="dv">2</span>, <span class="dv">8</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to estimate mode using density</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>get_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">density</span>(x)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  d<span class="sc">$</span>x[<span class="fu">which.max</span>(d<span class="sc">$</span>y)]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Vertical layout</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Left-skewed</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(left_skew, <span class="at">main =</span> <span class="st">"Left-Skewed Distribution"</span>, </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">breaks =</span> <span class="dv">30</span>, </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">85</span>))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(left_skew), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(left_skew), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">get_mode</span>(left_skew), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">"Mean (%.1f)"</span>, <span class="fu">mean</span>(left_skew)),</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Median (%.1f)"</span>, <span class="fu">median</span>(left_skew)),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Mode (%.1f)"</span>, <span class="fu">get_mode</span>(left_skew))),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Symmetric</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(symmetric, <span class="at">main =</span> <span class="st">"Symmetric Distribution"</span>, </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">85</span>))</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(symmetric), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(symmetric), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">get_mode</span>(symmetric), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">"Mean (%.1f)"</span>, <span class="fu">mean</span>(symmetric)),</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Median (%.1f)"</span>, <span class="fu">median</span>(symmetric)),</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Mode (%.1f)"</span>, <span class="fu">get_mode</span>(symmetric))),</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-skewed</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(right_skew, <span class="at">main =</span> <span class="st">"Right-Skewed Distribution"</span>, </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">85</span>))</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(right_skew), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">median</span>(right_skew), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">get_mode</span>(right_skew), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">sprintf</span>(<span class="st">"Mean (%.1f)"</span>, <span class="fu">mean</span>(right_skew)),</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Median (%.1f)"</span>, <span class="fu">median</span>(right_skew)),</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">sprintf</span>(<span class="st">"Mode (%.1f)"</span>, <span class="fu">get_mode</span>(right_skew))),</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>), </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key insights:</strong></p>
<ul>
<li>In <strong>symmetric</strong> distributions, mean ≈ median ≈ mode</li>
<li>In <strong>right-skewed</strong> distributions (long tail to the right), mean &gt; median &gt; mode</li>
<li>In <strong>left-skewed</strong> distributions (long tail to the left), mean &lt; median &lt; mode</li>
</ul>
<p>The mean is pulled toward the tail, the median stays in the middle, and the mode remains at the peak.</p>
</section>
</section>
<section id="measures-of-dispersion-variability" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="measures-of-dispersion-variability"><span class="header-section-number">5.7</span> Measures of Dispersion (Variability)</h2>
<p>While measures of central tendency tell us about typical values, <strong>measures of dispersion</strong> tell us how spread out the data are. Two datasets can have the same mean but very different spreads.</p>
<p><strong>Applicable measurement scales:</strong></p>
<ul>
<li><strong>Range:</strong> Interval, Ratio</li>
<li><strong>Variance/Standard Deviation:</strong> Interval, Ratio</li>
<li><strong>IQR:</strong> Ordinal, Interval, Ratio (requires ordering)</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/Comparison_standard_deviations.svg" class="img-fluid figure-img"></p>
<figcaption>https://commons.wikimedia.org/wiki/File:Comparison_standard_deviations.svg</figcaption>
</figure>
</div>
<section id="range" class="level3">
<h3 class="anchored" data-anchor-id="range">Range</h3>
<p>The <strong>range</strong> is the simplest measure of dispersion: the difference between the maximum and minimum values.</p>
<p><strong>Applicable to:</strong> Interval and Ratio data</p>
<p><span class="math display">\text{Range} = \max(x) - \min(x)</span></p>
<p><strong>Example:</strong></p>
<p>Dataset A: 10, 12, 15, 18, 20 → Range = 20 - 10 = 10</p>
<p>Dataset B: 10, 15, 15, 15, 20 → Range = 20 - 10 = 10</p>
<p><strong>Plain English:</strong> The range tells us the span from the smallest to the largest observation. It gives a quick sense of spread but is highly sensitive to outliers (since it only uses two values).</p>
<hr>
</section>
<section id="variance-and-standard-deviation" class="level3">
<h3 class="anchored" data-anchor-id="variance-and-standard-deviation">Variance and Standard Deviation</h3>
<section id="visualizing-variability-a-working-example" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-variability-a-working-example">Visualizing Variability: A Working Example</h4>
<p>To understand variance and standard deviation, let’s work through a complete example with data <span class="math inline">X = (2, 2, 3, 4, 5, 5)</span>. We’ll treat these as sequential observations (like measurements over time [t]) to visualize how individual values deviate from their mean.</p>
<section id="step-1-calculate-the-mean" class="level5">
<h5 class="anchored" data-anchor-id="step-1-calculate-the-mean">Step 1: Calculate the Mean</h5>
<p><span class="math display">\bar{x} = \frac{2 + 2 + 3 + 4 + 5 + 5}{6} = \frac{21}{6} = 3.5</span></p>
</section>
<section id="step-2-visualize-deviations-from-the-mean" class="level5">
<h5 class="anchored" data-anchor-id="step-2-visualize-deviations-from-the-mean">Step 2: Visualize Deviations from the Mean</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mean_X <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"darkblue"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation"</span>, <span class="at">ylab =</span> <span class="st">"Value"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Deviations from the Mean"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> mean_X, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, mean_X <span class="sc">+</span> <span class="fl">0.3</span>, <span class="fu">paste</span>(<span class="st">"Mean ="</span>, mean_X), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add deviation lines</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X)) {</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(i, mean_X, i, X[i], <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>The gray dashed lines show the <strong>deviations</strong> from the mean. Variance will quantify the average squared length of these deviations.</p>
</section>
</section>
<section id="why-do-we-square-deviations" class="level4">
<h4 class="anchored" data-anchor-id="why-do-we-square-deviations">Why Do We Square Deviations?</h4>
<p>Why not just average the deviations <span class="math inline">(x_i - \bar{x})</span> directly?</p>
<p><strong>Problem:</strong> If we simply averaged the deviations, they would always sum to zero (as we saw with the balancing point property). Let’s verify this with our example:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>-1.5</td>
</tr>
<tr class="even">
<td>2</td>
<td>-1.5</td>
</tr>
<tr class="odd">
<td>3</td>
<td>-0.5</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.5</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1.5</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>This happens because positive deviations (above the mean) exactly cancel negative deviations (below the mean):</p>
<p><span class="math display">\sum_{i=1}^{n}(x_i - \bar{x}) = 0</span></p>
<p><strong>Solutions to this problem:</strong></p>
<ol type="1">
<li><strong>Square the deviations</strong> (variance approach): <span class="math inline">(x_i - \bar{x})^2</span> makes all values positive</li>
<li><strong>Take absolute values</strong> (alternative approach): <span class="math inline">|x_i - \bar{x}|</span> also makes all values positive</li>
</ol>
<p><strong>Why squaring is preferred:</strong></p>
<ul>
<li><strong>Mathematical convenience:</strong> Squaring has better mathematical properties for statistical theory</li>
<li><strong>Emphasizes larger deviations:</strong> Squaring gives more weight to extreme deviations (a point 10 units away contributes 100 to variance, while a point 5 units away contributes only 25)</li>
</ul>
<p><strong>The units problem:</strong> Because we squared the deviations, variance is in <strong>squared units</strong>. If our data are in centimeters, variance is in square centimeters. This is why we often prefer the standard deviation.</p>
</section>
<section id="variance" class="level4">
<h4 class="anchored" data-anchor-id="variance">Variance</h4>
<p>The <strong>variance</strong> measures the average squared deviation from the mean. It quantifies how far, on average, each observation is from the mean.</p>
<p><strong>Applicable to:</strong> Interval and Ratio data</p>
<section id="manual-calculation-population-vs.-sample-variance" class="level5">
<h5 class="anchored" data-anchor-id="manual-calculation-population-vs.-sample-variance">Manual Calculation: Population vs.&nbsp;Sample Variance</h5>
<p>Let’s continue with our example <span class="math inline">X = (2, 2, 3, 4, 5, 5)</span> and calculate the squared deviations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>-1.5</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>2</td>
<td>-1.5</td>
<td>2.25</td>
</tr>
<tr class="odd">
<td>3</td>
<td>-0.5</td>
<td>0.25</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.5</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1.5</td>
<td>2.25</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.5</td>
<td>2.25</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td></td>
<td>9.5</td>
</tr>
</tbody>
</table>
<p><strong>Population variance</strong> (if this were the entire population):</p>
<p><span class="math display">\sigma^2 = \frac{\sum_{i=1}^{n}(x_i - \bar{x})^2}{n} = \frac{9.5}{6} \approx 1.583</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Population variance (no Bessel correction)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>var_pop <span class="ot">&lt;-</span> <span class="fu">sum</span>((X <span class="sc">-</span> mean_X)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">length</span>(X)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Population variance:"</span>, var_pop, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Population variance: 1.583 </code></pre>
</div>
</div>
</section>
<section id="bessels-correction-why-n-1" class="level5">
<h5 class="anchored" data-anchor-id="bessels-correction-why-n-1">Bessel’s Correction: Why <span class="math inline">n-1</span>?</h5>
<p><strong>The Problem:</strong> When we use sample data to estimate population variance, the formula <span class="math inline">\frac{\sum(x_i - \bar{x})^2}{n}</span> tends to <strong>underestimate</strong> the true population variance (we’re measuring deviations from the sample mean, not the true population mean).</p>
<p><strong>The Solution:</strong> Bessel’s correction adjusts for this bias by dividing by <span class="math inline">n-1</span> instead of <span class="math inline">n</span>. This produces an unbiased estimate of the population variance.</p>
<p><strong>Sample variance formula:</strong></p>
<p><span class="math display">s^2 = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2</span></p>
<p><strong>For our example:</strong></p>
<p><span class="math display">s^2 = \frac{9.5}{5} = 1.9</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample variance (with Bessel correction)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: R's var() function uses n-1 by default</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>var_sample <span class="ot">&lt;-</span> <span class="fu">var</span>(X)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample variance:"</span>, var_sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample variance: 1.9 </code></pre>
</div>
</div>
<p><strong>Key difference:</strong> The sample variance (1.9) is larger than the population variance (1.583), providing an unbiased estimate when working with sample data.</p>
<p><strong>Plain English:</strong> The variance tells us, on average, how far squared each observation is from the mean. A larger variance means more spread-out data; a smaller variance means data cluster more tightly around the mean.</p>
<p><strong>Note:</strong> In all further examples, we will use Bessel’s correction (dividing by <span class="math inline">n-1</span>) to calculate sample variance, as this is the standard approach in inferential statistics and matches R’s default behavior in the <code>var()</code> and <code>sd()</code> functions.</p>
</section>
</section>
<section id="standard-deviation" class="level4">
<h4 class="anchored" data-anchor-id="standard-deviation">Standard Deviation</h4>
<p>The <strong>standard deviation</strong> is simply the square root of the variance. It returns us to the original units of measurement.</p>
<p><strong>Applicable to:</strong> Interval and Ratio data</p>
<section id="formula" class="level5">
<h5 class="anchored" data-anchor-id="formula">Formula</h5>
<p><span class="math display">s = \sqrt{s^2} = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2}</span></p>
</section>
<section id="calculation-for-our-example" class="level5">
<h5 class="anchored" data-anchor-id="calculation-for-our-example">Calculation for Our Example</h5>
<p><strong>For our example</strong> <span class="math inline">X = (2, 2, 3, 4, 5, 5)</span>:</p>
<p><span class="math display">s = \sqrt{1.9} \approx 1.378</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Standard deviation</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: R's sd() function uses n-1 by default</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sd_sample <span class="ot">&lt;-</span> <span class="fu">sd</span>(X)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample SD:"</span>, sd_sample, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample SD: 1.378 </code></pre>
</div>
</div>
<p><strong>Plain English:</strong> The standard deviation tells us the typical distance of observations from the mean, in the original units of measurement. It’s more interpretable than variance because it’s in the same units as the data.</p>
<p><strong>Note</strong>: In many distributions (especially symmetric, bell-shaped distributions like the normal distribution), about 68% of observations fall within one standard deviation of the mean, and about 95% fall within two standard deviations.</p>
<p>For our example with <span class="math inline">\bar{x} = 3.5</span> and <span class="math inline">s \approx 1.378</span>:</p>
<ul>
<li>One SD below mean: <span class="math inline">3.5 - 1.378 = 2.122</span></li>
<li>One SD above mean: <span class="math inline">3.5 + 1.378 = 4.878</span></li>
<li>Values within this range: 2, 2, 3, 4 (4 out of 6 = 67%)</li>
</ul>
</section>
</section>
<section id="practice-example" class="level4">
<h4 class="anchored" data-anchor-id="practice-example">Practice Example</h4>
<p>Let’s work through another complete example to solidify these concepts.</p>
<p><strong>Data:</strong> 2, 4, 6, 8, 10</p>
<p><strong>Step 1:</strong> Calculate the mean:</p>
<p><span class="math display">\bar{x} = \frac{2+4+6+8+10}{5} = \frac{30}{5} = 6</span></p>
<p><strong>Step 2:</strong> Calculate deviations and squared deviations:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">x_i</span></th>
<th><span class="math inline">x_i - \bar{x}</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>-4</td>
<td>16</td>
</tr>
<tr class="even">
<td>4</td>
<td>-2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>6</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>8</td>
<td>2</td>
<td>4</td>
</tr>
<tr class="odd">
<td>10</td>
<td>4</td>
<td>16</td>
</tr>
<tr class="even">
<td>Sum</td>
<td>0</td>
<td>40</td>
</tr>
</tbody>
</table>
<p><strong>Step 3:</strong> Calculate sample variance:</p>
<p><span class="math display">s^2 = \frac{40}{5-1} = \frac{40}{4} = 10</span></p>
<p><strong>Step 4:</strong> Calculate standard deviation:</p>
<p><span class="math display">s = \sqrt{10} \approx 3.162</span></p>
<p><strong>Verification in R:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean:"</span>, <span class="fu">mean</span>(X2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean: 6 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample variance:"</span>, <span class="fu">var</span>(X2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample variance: 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample SD:"</span>, <span class="fu">sd</span>(X2), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample SD: 3.162 </code></pre>
</div>
</div>
<p><strong>Notice:</strong> This dataset has a larger variance (10 vs.&nbsp;1.9) and standard deviation (3.16 vs.&nbsp;1.38) than our first example, reflecting the fact that the values are more spread out from their mean.</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weighted Variance and Standard Deviation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Just as we can calculate a weighted mean for frequency distributions, we can also calculate <strong>weighted variance</strong> and <strong>weighted standard deviation</strong>.</p>
<p><strong>For Absolute Frequencies (Population):</strong></p>
<p><span class="math display">\sigma^2_w = \frac{\sum_{i=1}^{k} f_i (x_i - \bar{x}_w)^2}{n}</span></p>
<p><span class="math display">\sigma_w = \sqrt{\frac{\sum_{i=1}^{k} f_i (x_i - \bar{x}_w)^2}{n}}</span></p>
<p><strong>For Absolute Frequencies (Sample - with Bessel’s Correction):</strong></p>
<p>When working with sample data, we use <span class="math inline">n-1</span> instead of <span class="math inline">n</span> in the denominator:</p>
<p><span class="math display">s^2_w = \frac{\sum_{i=1}^{k} f_i (x_i - \bar{x}_w)^2}{n-1}</span></p>
<p><span class="math display">s_w = \sqrt{\frac{\sum_{i=1}^{k} f_i (x_i - \bar{x}_w)^2}{n-1}}</span></p>
<p><strong>For Relative Frequencies (Proportions):</strong></p>
<p>With proportions <span class="math inline">p_i = \frac{f_i}{n}</span>:</p>
<p><strong>Population:</strong></p>
<p><span class="math display">\sigma^2_w = \sum_{i=1}^{k} p_i (x_i - \bar{x}_w)^2</span></p>
<p><strong>Sample (with Bessel’s Correction):</strong></p>
<p><span class="math display">s^2_w = \frac{n}{n-1} \sum_{i=1}^{k} p_i (x_i - \bar{x}_w)^2</span></p>
<p>The factor <span class="math inline">\frac{n}{n-1}</span> is Bessel’s correction applied to the proportion-based formula.</p>
<p><strong>Example (Manual Calculation):</strong></p>
<p>Using our previous study hours data where <span class="math inline">\bar{x}_w = 12</span> and <span class="math inline">n = 20</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Hours <span class="math inline">(x_i)</span></th>
<th>Freq. <span class="math inline">(f_i)</span></th>
<th><span class="math inline">(x_i - \bar{x})</span></th>
<th><span class="math inline">(x_i - \bar{x})^2</span></th>
<th><span class="math inline">f_i(x_i - \bar{x})^2</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5</td>
<td>3</td>
<td>-7</td>
<td>49</td>
<td>147</td>
</tr>
<tr class="even">
<td>10</td>
<td>8</td>
<td>-2</td>
<td>4</td>
<td>32</td>
</tr>
<tr class="odd">
<td>15</td>
<td>7</td>
<td>3</td>
<td>9</td>
<td>63</td>
</tr>
<tr class="even">
<td>20</td>
<td>2</td>
<td>8</td>
<td>64</td>
<td>128</td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><span class="math inline">n=20</span></td>
<td></td>
<td></td>
<td>370</td>
</tr>
</tbody>
</table>
<p><strong>Sample variance:</strong></p>
<p><span class="math display">s^2_w = \frac{370}{20-1} = \frac{370}{19} = 19.47</span></p>
<p><strong>Sample standard deviation:</strong></p>
<p><span class="math display">s_w = \sqrt{19.47} = 4.41</span></p>
<p><strong>Using proportions with Bessel’s correction:</strong></p>
<p><span class="math display">s^2_w = \frac{20}{19} \times [(0.15 \times 49) + (0.40 \times 4) + (0.35 \times 9) + (0.10 \times 64)]</span></p>
<p><span class="math display">= \frac{20}{19} \times [7.35 + 1.60 + 3.15 + 6.40] = \frac{20}{19} \times 18.50 = 19.47</span></p>
<p><strong>Plain English:</strong> Bessel’s correction (using <span class="math inline">n-1</span>) makes the sample variance an unbiased estimator of the population variance. Without it, we would systematically underestimate the true population variance.</p>
</div>
</div>
<hr>
</section>
</section>
<section id="interquartile-range-iqr" class="level3">
<h3 class="anchored" data-anchor-id="interquartile-range-iqr">Interquartile Range (IQR)</h3>
<p>The <strong>interquartile range</strong> measures the spread of the middle 50% of the data. It’s calculated as:</p>
<p><strong>Applicable to:</strong> Ordinal, Interval, and Ratio data (requires ordering)</p>
<p><span class="math display">\text{IQR} = Q_3 - Q_1</span></p>
<p>where <span class="math inline">Q_1</span> is the first quartile (25th percentile) and <span class="math inline">Q_3</span> is the third quartile (75th percentile).</p>
<p><strong>Plain English:</strong> The IQR tells us the range that contains the middle half of our data. It’s resistant to outliers, making it useful when extreme values are present.</p>
<p><strong>Example:</strong></p>
<p>Data: 2, 4, 5, 7, 8, 11, 12, 15, 18, 20</p>
<ul>
<li><span class="math inline">Q_1 = 5</span> (25% of data fall below 5)</li>
<li><span class="math inline">Q_3 = 15</span> (75% of data fall below 15)</li>
<li><span class="math inline">\text{IQR} = 15 - 5 = 10</span></li>
</ul>
<p>The middle 50% of observations span 10 units.</p>
<hr>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Measures of Center and Dispersion: Summary Table
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 35%">
<col style="width: 24%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Measure</th>
<th>Formula/Description</th>
<th>When to Use</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>MEASURES OF CENTER</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Mean (<span class="math inline">\bar{x}</span>)</td>
<td><span class="math inline">\bar{x} = \frac{\sum x_i}{n}</span></td>
<td>Symmetric distributions, interval/ratio data</td>
<td>Uses all data points; algebraically defined; basis for advanced statistics</td>
<td>Sensitive to outliers; can be non-representative with skewed data; requires interval/ratio data</td>
</tr>
<tr class="odd">
<td>Median (<span class="math inline">Me</span>)</td>
<td>Middle value when ordered</td>
<td>Skewed distributions, ordinal data, presence of outliers</td>
<td>Resistant to outliers; works with ordinal data</td>
<td>Ignores magnitude of extreme values; less efficient than mean for symmetric data; limited algebraic properties</td>
</tr>
<tr class="even">
<td>Mode (<span class="math inline">Mo</span>)</td>
<td>Most frequent value</td>
<td>Categorical data, bimodal distributions</td>
<td>Only measure for nominal data; identifies most typical case; not affected by outliers</td>
<td>May not exist or be non-unique; ignores most of the data; unstable with small samples</td>
</tr>
<tr class="odd">
<td><strong>MEASURES OF DISPERSION</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Range</td>
<td><span class="math inline">R = x_{max} - x_{min}</span></td>
<td>Quick assessment, small datasets</td>
<td>Simple to calculate; intuitive interpretation; uses natural scale of data</td>
<td>Uses only 2 data points; extremely sensitive to outliers; increases with sample size</td>
</tr>
<tr class="odd">
<td>Interquartile Range (IQR)</td>
<td><span class="math inline">IQR = Q_3 - Q_1</span></td>
<td>Skewed data, presence of outliers</td>
<td>Resistant to outliers; describes middle 50% of data; works with ordinal data</td>
<td>Ignores tails of distribution; less efficient for symmetric data; limited algebraic properties</td>
</tr>
<tr class="even">
<td>Variance (<span class="math inline">s^2</span>)</td>
<td><span class="math inline">s^2 = \frac{\sum(x_i - \bar{x})^2}{n-1}</span></td>
<td>Theoretical work</td>
<td>Uses all data points; algebraically tractable; additive for independent variables</td>
<td>Units are squared (hard to interpret); sensitive to outliers; requires interval/ratio data</td>
</tr>
<tr class="odd">
<td>Standard Deviation (<span class="math inline">s</span>)</td>
<td><span class="math inline">s = \sqrt{s^2}</span></td>
<td>Describing spread in practice</td>
<td>Same units as original data; uses all data points; interpretable with empirical rule</td>
<td>Sensitive to outliers; requires interval/ratio data; cannot be negative</td>
</tr>
<tr class="even">
<td>Mean Absolute Deviation (MAD)</td>
<td><span class="math inline">MAD = \frac{\sum |x_i - \bar{x}|}{n}</span></td>
<td>Robust alternative to SD</td>
<td>More resistant to outliers than SD; same units as data; intuitive interpretation</td>
<td>Less commonly used; lacks some algebraic properties; not standard in statistical software</td>
</tr>
</tbody>
</table>
<p><strong>Key Principles:</strong></p>
<ul>
<li>Symmetric data: use mean and standard deviation</li>
<li>Skewed data or outliers present: use median and IQR<br>
</li>
<li>Categorical data: use mode only</li>
<li>Reporting: always report a measure of center with a measure of dispersion</li>
</ul>
</div>
</div>
<hr>
</section>
</section>
<section id="measures-of-relative-position" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="measures-of-relative-position"><span class="header-section-number">5.8</span> Measures of Relative Position</h2>
<p>Measures of relative position help us understand where a particular observation stands within the overall distribution. These measures answer questions like “How does this value compare to others in the dataset?”</p>
<p><strong>Applicable measurement scales:</strong></p>
<ul>
<li><strong>Quantiles/Percentiles/Quartiles:</strong> Ordinal, Interval, Ratio (requires ordering)</li>
</ul>
<section id="quantiles" class="level3">
<h3 class="anchored" data-anchor-id="quantiles">Quantiles</h3>
<p>A <strong>quantile</strong> is a value that divides a dataset into equal-sized groups. More formally, the <span class="math inline">p</span>-th quantile is a value below which a proportion <span class="math inline">p</span> of the data falls.</p>
<p><strong>Applicable to:</strong> Ordinal, Interval, and Ratio data</p>
<p><strong>Definition:</strong></p>
<p>For a proportion <span class="math inline">p</span> (where <span class="math inline">0 &lt; p &lt; 1</span>), the <span class="math inline">p</span>-th quantile <span class="math inline">q_p</span> satisfies:</p>
<ul>
<li>At least proportion <span class="math inline">p</span> of observations are less than or equal to <span class="math inline">q_p</span></li>
<li>At least proportion <span class="math inline">(1-p)</span> of observations are greater than or equal to <span class="math inline">q_p</span></li>
</ul>
<p><strong>Plain English:</strong> Quantiles are “cut points” that divide our sorted data into segments. They tell us the value below which a certain proportion of our data falls.</p>
<p><strong>Important note:</strong> Quantiles are a <strong>general concept</strong>. Percentiles, quartiles, and the median are all specific types of quantiles.</p>
<p><strong>Examples of quantiles:</strong></p>
<ul>
<li>The 0.5 quantile (50th percentile) is the <strong>median</strong> - half the data fall below it</li>
<li>The 0.25 quantile (25th percentile) is the <strong>first quartile</strong> (<span class="math inline">Q_1</span>)</li>
<li>The 0.75 quantile (75th percentile) is the <strong>third quartile</strong> (<span class="math inline">Q_3</span>)</li>
<li>The 0.90 quantile (90th percentile) means 90% of data fall below this value</li>
</ul>
</section>
<section id="percentiles" class="level3">
<h3 class="anchored" data-anchor-id="percentiles">Percentiles</h3>
<p>A <strong>percentile</strong> is a specific type of quantile that divides the data into 100 equal parts. The <span class="math inline">k</span>-th percentile is the value below which <span class="math inline">k</span> percent of observations fall.</p>
<p><strong>Applicable to:</strong> Ordinal, Interval, and Ratio data</p>
<p><strong>Relationship to quantiles:</strong></p>
<p>The <span class="math inline">k</span>-th percentile corresponds to the <span class="math inline">\frac{k}{100}</span> quantile. For example:</p>
<ul>
<li>25th percentile = 0.25 quantile</li>
<li>50th percentile = 0.50 quantile = median</li>
<li>90th percentile = 0.90 quantile</li>
</ul>
<p><strong>Examples:</strong></p>
<ul>
<li>The <strong>50th percentile</strong> is the median (50% of data fall below it)</li>
<li>The <strong>90th percentile</strong> means 90% of observations fall below this value</li>
<li>The <strong>10th percentile</strong> means only 10% of observations fall below this value</li>
</ul>
<p><strong>Interpretation:</strong> If you score at the 85th percentile on a test, you performed better than 85% of test-takers.</p>
</section>
<section id="quartiles" class="level3">
<h3 class="anchored" data-anchor-id="quartiles">Quartiles</h3>
<p><strong>Quartiles</strong> are specific quantiles that divide the data into four equal parts. They are the 25th, 50th, and 75th percentiles:</p>
<p><strong>Applicable to:</strong> Ordinal, Interval, and Ratio data</p>
<ul>
<li><span class="math inline">Q_1</span> (First quartile or 25th percentile): 25% of data fall below this value</li>
<li><span class="math inline">Q_2</span> (Second quartile or 50th percentile): The median - 50% fall below</li>
<li><span class="math inline">Q_3</span> (Third quartile or 75th percentile): 75% of data fall below this value</li>
</ul>
<p>Think of quartiles as special numbers that split your ordered data into four equal parts.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4327.jpg" class="img-fluid figure-img"></p>
<figcaption>Doane, D. P., &amp; Seward, L. W. (2016). Applied statistics in business and economics. Mcgraw-Hill.</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization of quartiles</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>example_data <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">10</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, example_data, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">"gray40"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation (sorted)"</span>, <span class="at">ylab =</span> <span class="st">"Value"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Quartiles Divide Data into Four Equal Parts"</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add quartile lines</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add shaded regions</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">min</span>(example_data), <span class="dv">101</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), <span class="dv">101</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), <span class="dv">101</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">rect</span>(<span class="dv">0</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), <span class="dv">101</span>, <span class="fu">max</span>(example_data), </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">border =</span> <span class="cn">NA</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Labels</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">95</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.25</span>), <span class="st">"Q1 (25%)"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">95</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.50</span>), <span class="st">"Q2 (50%)"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">95</span>, <span class="fu">quantile</span>(example_data, <span class="fl">0.75</span>), <span class="st">"Q3 (75%)"</span>, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">font =</span> <span class="dv">2</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Each region contains 25% of observations"</span>),</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">1.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="computing-quartiles-the-tukey-method" class="level3">
<h3 class="anchored" data-anchor-id="computing-quartiles-the-tukey-method">Computing Quartiles: The Tukey Method</h3>
<p>There are several methods for computing quartiles. In this course, we use the <strong>Tukey method</strong> (also called the hinges method):</p>
<p><strong>Steps:</strong></p>
<ol type="1">
<li>Find the median of the entire dataset</li>
<li><strong>Exclude the median</strong> if <span class="math inline">n</span> is odd</li>
<li><span class="math inline">Q_1</span> = median of the lower half</li>
<li><span class="math inline">Q_3</span> = median of the upper half</li>
</ol>
<p><strong>Example with even <span class="math inline">n</span>:</strong></p>
<p>Data: 2, 4, 5, 7, 8, 10, 12, 15 (<span class="math inline">n = 8</span>)</p>
<p>Median position: between positions 4 and 5 → Median = <span class="math inline">\frac{7+8}{2} = 7.5</span></p>
<p>Lower half: 2, 4, 5, 7 → <span class="math inline">Q_1 = \frac{4+5}{2} = 4.5</span></p>
<p>Upper half: 8, 10, 12, 15 → <span class="math inline">Q_3 = \frac{10+12}{2} = 11</span></p>
<p><strong>Example with odd <span class="math inline">n</span>:</strong></p>
<p>Data: 2, 4, 5, 7, 8, 10, 12, 15, 18 (<span class="math inline">n = 9</span>)</p>
<p>Median: 8 (position 5)</p>
<p>Lower half (excluding median): 2, 4, 5, 7 → <span class="math inline">Q_1 = \frac{4+5}{2} = 4.5</span></p>
<p>Upper half (excluding median): 10, 12, 15, 18 → <span class="math inline">Q_3 = \frac{12+15}{2} = 13.5</span></p>
<p><strong>Note:</strong> R’s <code>quantile()</code> function has multiple methods. The Tukey method corresponds to <code>type = 2</code>, while R’s default is <code>type = 7</code>.</p>
<hr>
</section>
</section>
<section id="measures-of-shape-1" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="measures-of-shape-1"><span class="header-section-number">5.9</span> Measures of Shape</h2>
<p>Measures of shape describe the overall form or pattern of the distribution. While we typically assess shape visually using histograms and boxplots, it’s important to understand the key concepts.</p>
<section id="skewness-asymmetry" class="level3">
<h3 class="anchored" data-anchor-id="skewness-asymmetry">Skewness (Asymmetry)</h3>
<p><strong>Skewness</strong> refers to the asymmetry of a distribution. It tells us whether the distribution has a longer tail on one side.</p>
<p><strong>Types of skewness:</strong></p>
<ul>
<li><strong>Symmetric (no skew):</strong> The distribution looks the same on both sides of the center. Mean ≈ Median.</li>
<li><strong>Right-skewed (positive skew):</strong> Long tail extends to the right. Mean &gt; Median. Most values cluster on the left, with a few large values pulling the tail.</li>
<li><strong>Left-skewed (negative skew):</strong> Long tail extends to the left. Mean &lt; Median. Most values cluster on the right, with a few small values pulling the tail.</li>
</ul>
<p><strong>Plain English:</strong> Skewness tells us which direction the “tail” points. Income distributions are typically right-skewed (most people earn moderate incomes, but a few earn extremely high incomes). Test scores on an easy exam might be left-skewed (most students score high, but a few score very low).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate distributions</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>left_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">8000</span>, <span class="dv">8</span>, <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>symmetric <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">8000</span>, <span class="dv">55</span>, <span class="dv">8</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>right_skew <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">8000</span>, <span class="dv">2</span>, <span class="dv">8</span>) <span class="sc">*</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">30</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>df_skew <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(left_skew, symmetric, right_skew),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Left-Skewed"</span>, <span class="st">"Symmetric"</span>, <span class="st">"Right-Skewed"</span>), <span class="at">each =</span> <span class="dv">8000</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics for each distribution</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>stats_skew <span class="ot">&lt;-</span> df_skew <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_val =</span> <span class="fu">mean</span>(value),</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_val =</span> <span class="fu">median</span>(value),</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">mode_val =</span> {</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>      d <span class="ot">&lt;-</span> <span class="fu">density</span>(value)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>      d<span class="sc">$</span>x[<span class="fu">which.max</span>(d<span class="sc">$</span>y)]</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor levels for proper display</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>df_skew<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_skew<span class="sc">$</span>type, </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Left-Skewed"</span>, <span class="st">"Symmetric"</span>, <span class="st">"Right-Skewed"</span>))</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>stats_skew<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(stats_skew<span class="sc">$</span>type, </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Left-Skewed"</span>, <span class="st">"Symmetric"</span>, <span class="st">"Right-Skewed"</span>))</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_skew, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> type), <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> stats_skew, <span class="fu">aes</span>(<span class="at">xintercept =</span> mean_val), </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>) <span class="sc">+</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> stats_skew, <span class="fu">aes</span>(<span class="at">xintercept =</span> median_val), </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> stats_skew, <span class="fu">aes</span>(<span class="at">xintercept =</span> mode_val), </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Left-Skewed"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, </span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Symmetric"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>, </span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Right-Skewed"</span> <span class="ot">=</span> <span class="st">"#FFFFE0"</span>)) <span class="sc">+</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, </span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Comparing Skewness: Mean, Median, and Mode"</span>) <span class="sc">+</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> stats_skew, </span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">75</span>, <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Mean: %.1f</span><span class="sc">\n</span><span class="st">Median: %.1f</span><span class="sc">\n</span><span class="st">Mode: %.1f"</span>, </span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>                               mean_val, median_val, mode_val)),</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.5</span>, </span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key insights:</strong></p>
<ul>
<li>In <strong>symmetric</strong> distributions, mean ≈ median ≈ mode</li>
<li>In <strong>right-skewed</strong> distributions (long tail to the right), mean &gt; median &gt; mode</li>
<li>In <strong>left-skewed</strong> distributions (long tail to the left), mean &lt; median &lt; mode</li>
</ul>
<p>The mean is pulled toward the tail, the median stays in the middle, and the mode remains at the peak.</p>
</section>
<section id="kurtosis-tailedness" class="level3">
<h3 class="anchored" data-anchor-id="kurtosis-tailedness">Kurtosis (Tailedness)</h3>
<p><strong>Kurtosis</strong> refers to whether a distribution has heavy tails (many extreme values) or light tails (few extreme values) compared to a normal distribution.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/kurtosis-1.svg" class="img-fluid figure-img"></p>
<figcaption>https://learningstatisticswithcogstat.com/exploringavariable.html</figcaption>
</figure>
</div>
<p><strong>Types:</strong></p>
<ul>
<li><strong>High kurtosis:</strong> Heavy tails with many outliers; sharp peak in center</li>
<li><strong>Low kurtosis:</strong> Light tails with few outliers; flatter peak</li>
</ul>
<p><strong>Plain English:</strong> Kurtosis tells us whether extreme values are common or rare in our data. Financial returns often have high kurtosis - most days see small changes, but occasionally there are very large movements (market crashes or rallies).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate distributions with different kurtosis</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Low kurtosis (uniform-like)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>low_kurt <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2000</span>, <span class="dv">40</span>, <span class="dv">70</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal kurtosis</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>normal_kurt <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2000</span>, <span class="dv">55</span>, <span class="dv">8</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># High kurtosis (heavy tails)</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>high_kurt <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">2000</span>, <span class="at">df =</span> <span class="dv">3</span>) <span class="sc">*</span> <span class="dv">8</span> <span class="sc">+</span> <span class="dv">55</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>df_kurt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(low_kurt, normal_kurt, high_kurt),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Low Kurtosis</span><span class="sc">\n</span><span class="st">(Light tails)"</span>, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Normal Kurtosis"</span>, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">"High Kurtosis</span><span class="sc">\n</span><span class="st">(Heavy tails)"</span>), <span class="at">each =</span> <span class="dv">2000</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor levels</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>df_kurt<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_kurt<span class="sc">$</span>type, </span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low Kurtosis</span><span class="sc">\n</span><span class="st">(Light tails)"</span>, </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Normal Kurtosis"</span>, </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"High Kurtosis</span><span class="sc">\n</span><span class="st">(Heavy tails)"</span>))</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_kurt, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> type), <span class="at">bins =</span> <span class="dv">40</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Low Kurtosis</span><span class="sc">\n</span><span class="st">(Light tails)"</span> <span class="ot">=</span> <span class="st">"#FFB6C1"</span>, </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Normal Kurtosis"</span> <span class="ot">=</span> <span class="st">"#98FB98"</span>, </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"High Kurtosis</span><span class="sc">\n</span><span class="st">(Heavy tails)"</span> <span class="ot">=</span> <span class="st">"#FFD700"</span>)) <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Value"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Comparing Kurtosis: Tail Behavior"</span>) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key insights:</strong></p>
<ul>
<li><strong>Low kurtosis</strong> distributions have fewer extreme values and a flatter peak</li>
<li><strong>High kurtosis</strong> distributions have more extreme values (heavy tails) and a sharper peak</li>
<li>Normal distribution serves as the reference point for kurtosis comparisons</li>
</ul>
<hr>
</section>
<section id="modality-number-of-peaks" class="level3">
<h3 class="anchored" data-anchor-id="modality-number-of-peaks">Modality (Number of Peaks)</h3>
<p><strong>Modality</strong> refers to the number of distinct peaks or “modes” in the distribution.</p>
<p><strong>Types:</strong></p>
<ul>
<li><strong>Unimodal:</strong> One clear peak</li>
<li><strong>Bimodal:</strong> Two distinct peaks</li>
<li><strong>Multimodal:</strong> Three or more peaks</li>
<li><strong>Uniform:</strong> No peaks; all values roughly equally common</li>
</ul>
<p><strong>Plain English:</strong> The number of peaks can reveal important features of your data. A bimodal distribution might indicate two distinct subgroups (e.g., heights of adults might show peaks for men and women).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize different shapes</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Unimodal symmetric</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>symmetric_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(symmetric_data, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Unimodal Symmetric"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(symmetric_data), <span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-skewed</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>skewed_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>) <span class="sc">+</span> <span class="dv">20</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(skewed_data, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Right-Skewed (Unimodal)"</span>, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(skewed_data), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Bimodal</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>bimodal_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">30</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="dv">60</span>, <span class="dv">5</span>))</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bimodal_data, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">"Bimodal"</span>, </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(bimodal_data), <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Visual assessment:</strong> We primarily identify shape characteristics through:</p>
<ul>
<li><strong>Histograms:</strong> Show the overall form, number of peaks, and direction of skew</li>
<li><strong>Boxplots:</strong> Reveal skewness through whisker lengths and median position</li>
<li><strong>Density plots:</strong> Smooth curves that highlight the overall pattern</li>
</ul>
<hr>
</section>
</section>
<section id="visualization-histograms" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="visualization-histograms"><span class="header-section-number">5.10</span> Visualization: Histograms</h2>
<p>A <strong>histogram</strong> displays the frequency distribution of numerical data by dividing the range into bins (intervals) and showing the count or proportion of observations in each bin.</p>
<section id="histogram-construction" class="level3">
<h3 class="anchored" data-anchor-id="histogram-construction">Histogram Construction</h3>
<p><strong>Key decisions:</strong></p>
<ol type="1">
<li><strong>Number of bins:</strong> Too few bins lose detail; too many bins create noise</li>
<li><strong>Bin boundaries:</strong> Should bins be <span class="math inline">[a, b)</span> (closed on left, open on right) or <span class="math inline">(a, b]</span> (open on left, closed on right)?</li>
<li><strong>Y-axis scale:</strong> Frequency counts, relative frequencies, or density?</li>
</ol>
</section>
<section id="choosing-the-optimal-number-of-bins" class="level3">
<h3 class="anchored" data-anchor-id="choosing-the-optimal-number-of-bins">Choosing the Optimal Number of Bins</h3>
<p>Several rules help determine an appropriate number of bins:</p>
<p><strong>1. Sturges’ Rule (default in R):</strong></p>
<p><span class="math display">k = \lceil \log_2(n) + 1 \rceil</span></p>
<p>where <span class="math inline">n</span> is the sample size. Works well for symmetric, unimodal distributions.</p>
<p><strong>2. Scott’s Rule:</strong></p>
<p><span class="math display">\text{Bin width} = \frac{3.5 \cdot s}{n^{1/3}}</span></p>
<p>where <span class="math inline">s</span> is the sample standard deviation. More robust to outliers than Sturges’ rule.</p>
<p><strong>3. Freedman-Diaconis Rule:</strong></p>
<p><span class="math display">\text{Bin width} = \frac{2 \cdot IQR}{n^{1/3}}</span></p>
<p>where IQR is the interquartile range. Most robust to outliers; recommended for skewed distributions.</p>
<p><strong>4. Square Root Rule:</strong></p>
<p><span class="math display">k = \lceil \sqrt{n} \rceil</span></p>
<p>Simple but often produces too few bins for large datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Different bin selection methods</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">50</span>, <span class="dv">10</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">8</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_data)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sturges</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sturges_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">log2</span>(n) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scott</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>scott_width <span class="ot">&lt;-</span> <span class="fl">3.5</span> <span class="sc">*</span> <span class="fu">sd</span>(sample_data) <span class="sc">/</span> (n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>scott_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">diff</span>(<span class="fu">range</span>(sample_data)) <span class="sc">/</span> scott_width)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Freedman-Diaconis</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>fd_width <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">IQR</span>(sample_data) <span class="sc">/</span> (n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>fd_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">diff</span>(<span class="fu">range</span>(sample_data)) <span class="sc">/</span> fd_width)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Square root</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>sqrt_bins <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(n))</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sturges:"</span>, sturges_bins, <span class="st">"bins</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sturges: 9 bins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Scott:"</span>, scott_bins, <span class="st">"bins</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scott: 10 bins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Freedman-Diaconis:"</span>, fd_bins, <span class="st">"bins</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Freedman-Diaconis: 14 bins</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Square root:"</span>, sqrt_bins, <span class="st">"bins</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Square root: 16 bins</code></pre>
</div>
</div>
</section>
<section id="types-of-histograms-y-axis-scales" class="level3">
<h3 class="anchored" data-anchor-id="types-of-histograms-y-axis-scales">Types of Histograms: Y-Axis Scales</h3>
<section id="frequency-histogram" class="level4">
<h4 class="anchored" data-anchor-id="frequency-histogram">1. Frequency Histogram</h4>
<p>The <strong>frequency histogram</strong> shows the <strong>count</strong> of observations in each bin. The y-axis represents the number of observations.</p>
<ul>
<li><strong>Y-axis:</strong> Absolute count (frequency)</li>
<li><strong>Use when:</strong> You want to see raw counts</li>
<li><strong>Limitation:</strong> Hard to compare distributions with different sample sizes</li>
</ul>
</section>
<section id="relative-frequency-histogram" class="level4">
<h4 class="anchored" data-anchor-id="relative-frequency-histogram">2. Relative Frequency Histogram</h4>
<p>The <strong>relative frequency histogram</strong> shows the <strong>proportion</strong> of observations in each bin. Each bar height represents the fraction of the total.</p>
<ul>
<li><strong>Y-axis:</strong> Relative frequency (proportion) = <span class="math inline">\frac{\text{count in bin}}{n}</span></li>
<li><strong>Use when:</strong> Comparing distributions with different sample sizes</li>
<li><strong>Property:</strong> All bar heights sum to 1.0</li>
</ul>
</section>
<section id="density-histogram" class="level4">
<h4 class="anchored" data-anchor-id="density-histogram">3. Density Histogram</h4>
<p>The <strong>density histogram</strong> adjusts for bin width so that the <strong>area</strong> (not height) of each bar represents the proportion of observations.</p>
<ul>
<li><strong>Y-axis:</strong> Density = <span class="math inline">\frac{\text{relative frequency}}{\text{bin width}}</span></li>
<li><strong>Use when:</strong> Bins have different widths, or when connecting to probability density functions</li>
<li><strong>Property:</strong> Total area under all bars equals 1.0</li>
</ul>
<p><strong>Key difference:</strong> In a density histogram, the <strong>area</strong> of each bar equals the relative frequency, while the <strong>height</strong> is density.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate example data</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">50</span>, <span class="dv">10</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">8</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Frequency histogram</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Frequency Histogram"</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">ylab =</span> <span class="st">"Frequency (Count)"</span>, </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">freq =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Relative frequency histogram - manual scaling</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>h<span class="sc">$</span>counts <span class="ot">&lt;-</span> h<span class="sc">$</span>counts <span class="sc">/</span> <span class="fu">sum</span>(h<span class="sc">$</span>counts)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(h, <span class="at">main =</span> <span class="st">"Relative Frequency Histogram"</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">ylab =</span> <span class="st">"Relative Frequency (Proportion)"</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">freq =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Density histogram</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Density Histogram"</span>, </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">ylab =</span> <span class="st">"Density"</span>, </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Mathematical relationship:</strong></p>
<p>For a bin with boundaries <span class="math inline">[a, b)</span>:</p>
<ul>
<li><strong>Frequency:</strong> <span class="math inline">f = \text{count of observations in } [a, b)</span></li>
<li><strong>Relative frequency:</strong> <span class="math inline">\frac{f}{n}</span></li>
<li><strong>Density:</strong> <span class="math inline">\frac{f/n}{b-a}</span></li>
<li><strong>Area of bar:</strong> <span class="math inline">(b-a) \times \frac{f/n}{b-a} = \frac{f}{n}</span> (equals relative frequency)</li>
</ul>
</section>
</section>
<section id="open-vs.-closed-bins" class="level3">
<h3 class="anchored" data-anchor-id="open-vs.-closed-bins">Open vs.&nbsp;Closed Bins</h3>
<p><strong>Right-open bins: <span class="math inline">[a, b)</span></strong></p>
<p>The bin includes values <span class="math inline">\geq a</span> and <span class="math inline">&lt; b</span>. The value <span class="math inline">b</span> itself goes into the next bin.</p>
<p><strong>Right-closed bins: <span class="math inline">(a, b]</span></strong></p>
<p>The bin includes values <span class="math inline">&gt; a</span> and <span class="math inline">\leq b</span>. The value <span class="math inline">a</span> goes into the previous bin.</p>
<p><strong>Example:</strong></p>
<p>Consider data: 1, 2, 3, 4, 5, 6, 7, 8 with bins [1,3), [3,5), [5,7), [7,9)</p>
<p><strong>Right-open bins <span class="math inline">[a, b)</span>:</strong></p>
<ul>
<li>Bin [1, 3): contains 1, 2 (count = 2)</li>
<li>Bin [3, 5): contains 3, 4 (count = 2)</li>
<li>Bin [5, 7): contains 5, 6 (count = 2)</li>
<li>Bin [7, 9): contains 7, 8 (count = 2)</li>
</ul>
<p><strong>Right-closed bins <span class="math inline">(a, b]</span>:</strong></p>
<ul>
<li>Bin (1, 3]: contains 2, 3 (count = 2)</li>
<li>Bin (3, 5]: contains 4, 5 (count = 2)</li>
<li>Bin (5, 7]: contains 6, 7 (count = 2)</li>
<li>Bin (7, 9]: contains 8 (count = 1, since 9 is not in data)</li>
</ul>
<p><strong>R convention:</strong> R’s <code>hist()</code> function uses <strong>right-closed</strong> bins by default (i.e., <span class="math inline">(a, b]</span>). You can change this with the <code>right = FALSE</code> argument to get right-open bins <span class="math inline">[a, b)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-closed (default)</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Right-Closed Bins (a, b]"</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">right =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-open</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"Right-Open Bins [a, b)"</span>, </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightcoral"</span>, <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">right =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="effect-of-number-of-bins" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-number-of-bins">Effect of Number of Bins</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Different numbers of bins</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="st">"10 Bins (Too Few?)"</span>, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"20 Bins (Balanced)"</span>, </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightgreen"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_data, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">main =</span> <span class="st">"40 Bins (Too Many?)"</span>, </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"lightyellow"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>10 bins:</strong> Shows general shape but may miss details (potential bimodality not visible)</li>
<li><strong>20 bins:</strong> Balances detail and clarity; reveals bimodal structure</li>
<li><strong>40 bins:</strong> Shows more detail but may emphasize random noise, making patterns harder to see</li>
</ul>
<p><strong>What histograms reveal:</strong></p>
<ul>
<li><strong>Shape:</strong> Symmetric, skewed left, skewed right, bimodal, multimodal</li>
<li><strong>Center:</strong> Where most data are located</li>
<li><strong>Spread:</strong> How wide the distribution is</li>
<li><strong>Outliers:</strong> Unusual values separated from the main body</li>
<li><strong>Gaps:</strong> Ranges where no data exist</li>
</ul>
<p><strong>General recommendation:</strong> Start with Sturges’ or Freedman-Diaconis rule, then adjust based on what patterns you want to emphasize. For exploratory analysis, try several different bin numbers.</p>
<hr>
</section>
</section>
<section id="visualization-tukey-boxplots" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="visualization-tukey-boxplots"><span class="header-section-number">5.11</span> Visualization: Tukey Boxplots</h2>
<p>The <strong>Tukey boxplot</strong> (or box-and-whisker plot) provides a visual summary of the distribution based on five key values: minimum, <span class="math inline">Q_1</span>, median, <span class="math inline">Q_3</span>, and maximum. It also identifies outliers.</p>
<blockquote class="blockquote">
<p>John Wilder Tukey was an American mathematician and statistician, best known for the development of the fast Fourier Transform algorithm and the box plot.</p>
</blockquote>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Tight dataset with extreme outliers</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">42</span>, <span class="dv">44</span>, <span class="dv">46</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">54</span>, <span class="dv">56</span>, <span class="dv">66</span>, <span class="dv">70</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>          <span class="dv">12</span>, <span class="dv">8</span>, <span class="dv">85</span>, <span class="dv">98</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data, <span class="fl">0.25</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(data, <span class="fl">0.75</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>IQR <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>median_val <span class="ot">&lt;-</span> <span class="fu">median</span>(data)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>lower_fence <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>upper_fence <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> IQR</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>lower_whisker <span class="ot">&lt;-</span> <span class="fu">min</span>(data[data <span class="sc">&gt;=</span> lower_fence])</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>upper_whisker <span class="ot">&lt;-</span> <span class="fu">max</span>(data[data <span class="sc">&lt;=</span> upper_fence])</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> data[data <span class="sc">&lt;</span> lower_fence <span class="sc">|</span> data <span class="sc">&gt;</span> upper_fence]</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> data)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Box</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.9</span>, <span class="at">xmax =</span> <span class="fl">1.1</span>, <span class="at">ymin =</span> Q1, <span class="at">ymax =</span> Q3,</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Median</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.9</span>, <span class="at">xend =</span> <span class="fl">1.1</span>, <span class="at">y =</span> median_val, <span class="at">yend =</span> median_val,</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Whiskers</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">y =</span> Q1, <span class="at">yend =</span> lower_whisker,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">y =</span> Q3, <span class="at">yend =</span> upper_whisker,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.95</span>, <span class="at">xend =</span> <span class="fl">1.05</span>, <span class="at">y =</span> lower_whisker, <span class="at">yend =</span> lower_whisker,</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.95</span>, <span class="at">xend =</span> <span class="fl">1.05</span>, <span class="at">y =</span> upper_whisker, <span class="at">yend =</span> upper_whisker,</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fences (dotted lines)</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.85</span>, <span class="at">xend =</span> <span class="fl">1.15</span>, <span class="at">y =</span> lower_fence, <span class="at">yend =</span> lower_fence,</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x =</span> <span class="fl">0.85</span>, <span class="at">xend =</span> <span class="fl">1.15</span>, <span class="at">y =</span> upper_fence, <span class="at">yend =</span> upper_fence,</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Outliers</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> outliers), </span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Labels</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.15</span>, <span class="at">y =</span> Q1, <span class="at">label =</span> <span class="st">"Q[1]"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>, </span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.15</span>, <span class="at">y =</span> Q3, <span class="at">label =</span> <span class="st">"Q[3]"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.15</span>, <span class="at">y =</span> median_val, <span class="at">label =</span> <span class="st">"Median"</span>,</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> lower_fence, <span class="at">label =</span> <span class="st">"Q[1] - 1.5 %*% IQR"</span>, </span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.8</span>, <span class="at">y =</span> upper_fence, <span class="at">label =</span> <span class="st">"Q[3] + 1.5 %*% IQR"</span>,</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">parse =</span> <span class="cn">TRUE</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.85</span>, <span class="at">y =</span> outliers, <span class="at">label =</span> <span class="st">"outlier"</span>,</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Styling</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.4</span>)) <span class="sc">+</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">105</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tukey's Boxplot Construction"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistics</span></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Boxplot Statistics ===</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Boxplot Statistics ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Q1:"</span>, <span class="fu">round</span>(Q1, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q1: 43 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median:"</span>, <span class="fu">round</span>(median_val, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median: 50 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Q3:"</span>, <span class="fu">round</span>(Q3, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q3: 61 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR:"</span>, <span class="fu">round</span>(IQR, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR: 18 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lower fence:"</span>, <span class="fu">round</span>(lower_fence, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lower fence: 16 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Upper fence:"</span>, <span class="fu">round</span>(upper_fence, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Upper fence: 88 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Outliers:"</span>, <span class="fu">sort</span>(outliers), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Outliers: 8 12 98 </code></pre>
</div>
<div class="cell-output-display">
<div id="fig-boxplot-ggplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter5_files/figure-html/fig-boxplot-ggplot-1.png" class="img-fluid figure-img" width="1536">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Construction of Tukey’s boxplot using ggplot2
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
<section id="boxplot-construction" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-construction">Boxplot Construction</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/boxplots-chunk-28-1.svg" class="img-fluid figure-img"></p>
<figcaption>https://bookdown.org/a_shaker/STM1001_Topic_2/5.2-boxplots.html</figcaption>
</figure>
</div>
<p><strong>Step 1: Calculate the five-number summary</strong></p>
<ol type="1">
<li>Minimum (excluding outliers)</li>
<li>First quartile (<span class="math inline">Q_1</span>)</li>
<li>Median (<span class="math inline">Q_2</span>)</li>
<li>Third quartile (<span class="math inline">Q_3</span>)</li>
<li>Maximum (excluding outliers)</li>
</ol>
<p><strong>Step 2: Calculate fences for outlier detection</strong></p>
<p><span class="math display">\text{Lower fence} = Q_1 - 1.5 \times \text{IQR}</span> <span class="math display">\text{Upper fence} = Q_3 + 1.5 \times \text{IQR}</span></p>
<p><strong>Step 3: Identify outliers</strong></p>
<p>Any observation below the lower fence or above the upper fence is classified as an outlier.</p>
<p><strong>Step 4: Draw the boxplot</strong></p>
<ul>
<li><strong>Box:</strong> Extends from <span class="math inline">Q_1</span> to <span class="math inline">Q_3</span> (contains the middle 50% of data)</li>
<li><strong>Line inside box:</strong> Shows the median</li>
<li><strong>Whiskers:</strong> Extend to the most extreme non-outlier observations</li>
<li><strong>Individual points:</strong> Plotted for each outlier</li>
</ul>
<p><strong>CRITICAL DISTINCTION: Fences vs.&nbsp;Whiskers</strong></p>
<ul>
<li><strong>Fences:</strong> Theoretical boundaries used to identify outliers (not necessarily drawn)</li>
<li><strong>Whiskers:</strong> Extend to actual data points within the fences</li>
</ul>
<p><strong>Common mistake:</strong> Students often think whiskers extend to the fences. This is incorrect! Whiskers extend only to the most extreme <strong>actual data values</strong> that fall within the fence boundaries.</p>
<hr>
<p><strong>Key insights from boxplots:</strong></p>
<ul>
<li><strong>Symmetry:</strong> If the median is centered in the box and whiskers are equal length, the distribution is roughly symmetric</li>
<li><strong>Skewness:</strong> If the median is closer to <span class="math inline">Q_1</span> and the upper whisker is longer, the distribution is right-skewed</li>
<li><strong>Outliers:</strong> Individual points beyond the whiskers indicate unusual observations</li>
<li><strong>Comparison:</strong> Side-by-side boxplots make it easy to compare distributions across groups</li>
</ul>
</section>
<section id="comparing-multiple-groups-with-boxplots" class="level3">
<h3 class="anchored" data-anchor-id="comparing-multiple-groups-with-boxplots">Comparing Multiple Groups with Boxplots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate data for three groups</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>group_a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>group_b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">45</span>, <span class="dv">60</span>, <span class="dv">8</span>), <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">95</span>))  <span class="co"># With outliers</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>group_c <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">50</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>) <span class="sc">+</span> <span class="dv">30</span>  <span class="co"># Right-skewed</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into a data frame</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>data_compare <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(group_a, group_b, group_c),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Group A</span><span class="sc">\n</span><span class="st">(Symmetric)"</span>, </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Group B</span><span class="sc">\n</span><span class="st">(With outliers)"</span>, </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Group C</span><span class="sc">\n</span><span class="st">(Right-skewed)"</span>), </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">each =</span> <span class="dv">50</span>))</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(value <span class="sc">~</span> group, <span class="at">data =</span> data_compare,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Comparing Distributions Across Groups"</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Value"</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#66C2A5"</span>, <span class="st">"#FC8D62"</span>, <span class="st">"#8DA0CB"</span>),</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="cn">NA</span>, <span class="at">ny =</span> <span class="cn">NULL</span>, <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Group A:</strong> Symmetric distribution with median near the center of the box</li>
<li><strong>Group B:</strong> Higher center with several outliers on both ends</li>
<li><strong>Group C:</strong> Right-skewed distribution (longer upper whisker, median closer to <span class="math inline">Q_1</span>)</li>
</ul>
</section>
</section>
<section id="summary-choosing-the-right-measure" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="summary-choosing-the-right-measure"><span class="header-section-number">5.12</span> Summary: Choosing the Right Measure</h2>
<p>Selecting appropriate descriptive statistics depends on the characteristics of your data:</p>
<p><strong>For central tendency:</strong></p>
<ul>
<li><strong>Mean:</strong> Use when data are symmetric and without extreme outliers. Provides the most information but sensitive to extremes. <em>Requires interval or ratio scale.</em></li>
<li><strong>Median:</strong> Use when data are skewed or contain outliers. More robust but discards some information. <em>Requires at least ordinal scale.</em></li>
<li><strong>Mode:</strong> Use for categorical data or when identifying the most common value. <em>Can be used with any measurement scale.</em></li>
</ul>
<p><strong>For dispersion:</strong></p>
<ul>
<li><strong>Standard deviation:</strong> Use with the mean for symmetric data without outliers. Most common and interpretable. <em>Requires interval or ratio scale.</em></li>
<li><strong>IQR:</strong> Use with the median for skewed data or data with outliers. Resistant to extremes. <em>Requires at least ordinal scale.</em></li>
<li><strong>Range:</strong> Quick assessment but highly sensitive to outliers. Use cautiously. <em>Requires interval or ratio scale.</em></li>
</ul>
<p><strong>For relative position:</strong></p>
<ul>
<li><strong>Quantiles/Percentiles:</strong> Help compare individual observations to the overall distribution. <em>Requires at least ordinal scale.</em></li>
<li><strong>Quartiles:</strong> Provide standard cut points that divide data into four equal parts. <em>Requires at least ordinal scale.</em></li>
</ul>
<p><strong>For shape:</strong></p>
<ul>
<li><strong>Visual inspection:</strong> Use histograms to assess symmetry, skewness, and modality</li>
<li><strong>Boxplots:</strong> Reveal skewness and identify outliers effectively</li>
</ul>
<p><strong>For visualization:</strong></p>
<ul>
<li><strong>Histograms:</strong> Show the full shape of the distribution. Good for understanding overall patterns.</li>
<li><strong>Boxplots:</strong> Efficient summaries for comparing groups. Highlight outliers and quartiles clearly.</li>
</ul>
<p><strong>General principle:</strong> Always report multiple measures. The mean and standard deviation tell one story; the median and IQR tell another. Together with visual displays, they provide a complete picture of your data. Always consider the measurement scale of your data when choosing which statistics to calculate.</p>
<hr>
</section>
<section id="appendix-a-measures-of-relative-position-standing" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="appendix-a-measures-of-relative-position-standing"><span class="header-section-number">5.13</span> Appendix A: Measures of Relative Position (Standing)</h2>
<p>Understanding where values sit within a dataset is crucial for data analysis. Let’s explore these concepts step by step.</p>
<section id="quartiles-q-the-basics" class="level3">
<h3 class="anchored" data-anchor-id="quartiles-q-the-basics">Quartiles (Q): The Basics</h3>
<p>Think of quartiles as special numbers that split your ordered data into four equal parts.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="stat_imgs/IMG_4327.jpg" class="img-fluid figure-img"></p>
<figcaption>Doane, D. P., &amp; Seward, L. W. (2016). Applied statistics in business and economics. Mcgraw-Hill.</figcaption>
</figure>
</div>
<section id="what-are-quartiles" class="level4">
<h4 class="anchored" data-anchor-id="what-are-quartiles">What Are Quartiles?</h4>
<p>First Quartile (Q1):</p>
<ul>
<li>Separates the lowest 25% of data from the rest</li>
<li>Also called the 25th percentile</li>
<li>Example: If Q1 = 50 in a test score dataset, 25% of students scored below 50</li>
</ul>
<p>Second Quartile (Q2):</p>
<ul>
<li>The median - splits data in half</li>
<li>Also called the 50th percentile</li>
<li>Example: If Q2 = 70, half the students scored below 70</li>
</ul>
<p>Third Quartile (Q3):</p>
<ul>
<li>Separates the highest 25% of data from the rest</li>
<li>Also called the 75th percentile</li>
<li>Example: If Q3 = 85, 75% of students scored below 85</li>
</ul>
</section>
<section id="how-to-calculate-quartiles-step-by-step---two-methods" class="level4">
<h4 class="anchored" data-anchor-id="how-to-calculate-quartiles-step-by-step---two-methods">How to Calculate Quartiles (Step by Step) - Two Methods</h4>
<p>Let’s examine student test scores using both common quartile calculation methods:</p>
<p><strong>Example 1: Odd Number Case (11 scores)</strong><br>
60, 65, 70, 72, 75, 78, 80, 82, 85, 88, 90</p>
<p>Step 1: Find Q2 (median) - Same for both methods</p>
<ul>
<li>With n = 11 values (odd)</li>
<li>Median position = (n + 1)/2 = 6</li>
<li>Q2 = 78</li>
</ul>
<p>Step 2: Find Q1</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at lower half: 60, 65, 70, 72, 75</li>
<li>Q1 = median of lower half = 70</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = (n + 1)/4 = (11 + 1)/4 = 3</li>
<li>Q1 = 70 (3rd value)</li>
</ul></li>
</ul>
<p>Step 3: Find Q3</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at upper half: 80, 82, 85, 88, 90</li>
<li>Q3 = median of upper half = 85</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = 3(n + 1)/4 = 3(12)/4 = 9</li>
<li>Q3 = 85 (9th value)</li>
</ul></li>
</ul>
<p><strong>Example 2: Even Number Case (10 scores)</strong><br>
60, 65, 70, 72, 75, 78, 80, 82, 85, 90</p>
<p>Step 1: Find Q2 (median) - Same for both methods</p>
<ul>
<li>With n = 10 values (even)</li>
<li>Median positions = 5 and 6</li>
<li>Q2 = (75 + 78)/2 = 76.5</li>
</ul>
<p>Step 2: Find Q1</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at lower half: 60, 65, 70, 72, 75</li>
<li>Q1 = median of lower half = 70</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = (10 + 1)/4 = 2.75</li>
<li>Q1 = 65 + 0.75(70 - 65) = 68.75</li>
</ul></li>
</ul>
<p>Step 3: Find Q3</p>
<ul>
<li>Tukey’s Method:
<ul>
<li>Look at upper half: 78, 80, 82, 85, 90</li>
<li>Q3 = median of upper half = 82</li>
</ul></li>
<li>Interpolation Method:
<ul>
<li>Position = 3(10 + 1)/4 = 8.25</li>
<li>Q3 = 82 + 0.25(85 - 82) = 82.75</li>
</ul></li>
</ul>
<p>Important Notes:</p>
<ol type="1">
<li><p>Tukey’s Method:</p>
<ul>
<li>First find the median (Q2)</li>
<li>Split the data into lower and upper halves</li>
<li>Find Q1 as the median of the lower half</li>
<li>Find Q3 as the median of the upper half</li>
<li>When n is odd, the median is not included in either half</li>
</ul></li>
<li><p>Interpolation Method:</p>
<ul>
<li>Uses positions (n+1)/4 for Q1 and 3(n+1)/4 for Q3</li>
<li>When position falls between values, uses linear interpolation</li>
<li>Doesn’t require splitting data into halves</li>
</ul></li>
</ol>
<p>Both methods give the same results for simple positions (Example 1) but can differ when interpolation is needed (Example 2).</p>
<hr>
</section>
</section>
</section>
<section id="appendix-b-manual-construction-of-tukey-boxplot" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="appendix-b-manual-construction-of-tukey-boxplot"><span class="header-section-number">5.14</span> Appendix B: Manual Construction of Tukey Boxplot</h2>
<p><strong>Step 1: Calculate Key Components</strong></p>
<ol type="1">
<li>Find quartiles: <span class="math inline">Q_1</span>, <span class="math inline">Q_2</span> (median), <span class="math inline">Q_3</span></li>
<li>Calculate Interquartile Range: <span class="math inline">IQR = Q_3 - Q_1</span></li>
</ol>
<p><strong>Step 2: Determine Whisker Boundaries</strong></p>
<ul>
<li>Lower fence: <span class="math inline">Q_1 - 1.5 \times IQR</span></li>
<li>Upper fence: <span class="math inline">Q_3 + 1.5 \times IQR</span></li>
</ul>
<p><strong>Step 3: Identify Outliers</strong> Data points are outliers if they are:</p>
<ul>
<li>Below lower fence: <span class="math inline">x &lt; Q_1 - 1.5 \times IQR</span></li>
<li>Above upper fence: <span class="math inline">x &gt; Q_3 + 1.5 \times IQR</span></li>
</ul>
<p><strong>Example:</strong> Given data: 2, 4, 6, 8, 9, 10, 11, 12, 14, 16, 50</p>
<ol type="1">
<li><p>Find quartiles:</p>
<ul>
<li><span class="math inline">Q_1 = 6</span></li>
<li><span class="math inline">Q_2 = 10</span></li>
<li><span class="math inline">Q_3 = 14</span></li>
</ul></li>
<li><p>Calculate <span class="math inline">IQR</span>:</p>
<ul>
<li><span class="math inline">IQR = 14 - 6 = 8</span></li>
</ul></li>
<li><p>Calculate fences:</p>
<ul>
<li>Lower: <span class="math inline">6 - (1.5 \times 8) = -6</span></li>
<li>Upper: <span class="math inline">14 + (1.5 \times 8) = 26</span></li>
</ul></li>
<li><p>Identify outliers:</p>
<ul>
<li>50 &gt; 26, therefore 50 is an outlier</li>
</ul></li>
</ol>
<p><strong>Graphical Elements:</strong></p>
<ol type="1">
<li>Box: Draw from <span class="math inline">Q_1</span> to <span class="math inline">Q_3</span></li>
<li>Line inside box: Draw at <span class="math inline">Q_2</span></li>
<li>Whiskers: Extend to most extreme non-outlier points</li>
<li>Points: Plot outliers individually beyond whiskers</li>
</ol>
<hr>
<section id="sec-height-comparison" class="level4">
<h4 class="anchored" data-anchor-id="sec-height-comparison">Case Study: Comparing Heights Between Groups</h4>
<p>Let’s apply our understanding of box plots to a real dataset. We have height measurements (in centimeters) from two groups of 25 students each.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the dataset</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>data_height <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_1 =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">165</span>, <span class="dv">168</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">186</span>, <span class="dv">188</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">200</span>),</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_2 =</span> <span class="fu">c</span>(<span class="dv">138</span>, <span class="dv">140</span>, <span class="dv">148</span>, <span class="dv">152</span>, <span class="dv">164</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">166</span>, <span class="dv">170</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">188</span>, <span class="dv">210</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform dataset from wide to long format</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>data_height_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(<span class="at">data =</span> data_height, <span class="at">key =</span> <span class="st">"Group_number"</span>, <span class="at">value =</span> <span class="st">"height"</span>, group_1<span class="sc">:</span>group_2)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_height_l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Group_number height
1      group_1    150
2      group_1    160
3      group_1    165
4      group_1    168
5      group_1    172
6      group_1    173</code></pre>
</div>
</div>
<p>Let’s calculate some summary statistics for each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each group</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>group1_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>group2_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IQR</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>group1_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>group2_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a comparison table</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>stats_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  group1_stats,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  group2_stats</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(stats_table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Group 1"</span>, <span class="st">"Group 2"</span>)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>stats_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Min. 1st Qu. Median  Mean 3rd Qu. Max.
Group 1  150     175    180 178.6     183  200
Group 2  138     165    175 172.1     182  210</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display IQR values</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR for Group 1:"</span>, group1_iqr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR for Group 1: 8 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR for Group 2:"</span>, group2_iqr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR for Group 2: 17 </code></pre>
</div>
</div>
</section>
<section id="sec-visualizing-heights" class="level4">
<h4 class="anchored" data-anchor-id="sec-visualizing-heights">Visualizing the Height Data</h4>
<p>Now, let’s visualize the data using box plots and density plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create horizontal boxplots</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Group_number, <span class="at">y =</span> height, <span class="at">colour =</span> Group_number), <span class="at">notch =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Distribution by Group"</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Group"</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.
ℹ The deprecated feature was likely used in the ggpubr package.
  Please report the issue at &lt;https://github.com/kassambara/ggpubr/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.
ℹ The deprecated feature was likely used in the ggpubr package.
  Please report the issue at &lt;https://github.com/kassambara/ggpubr/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-boxplots" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter5_files/figure-html/fig-boxplots-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Box plots comparing height distributions between groups.
</figcaption>
</figure>
</div>
</div>
</div>
<p>To complement our box plots, let’s also look at the density distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plots</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Group_number), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Group_number) <span class="sc">+</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Density by Group"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (cm)"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-density" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter5_files/figure-html/fig-density-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: Density plots showing the height distributions for each group.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-boxplot-exercise" class="level4">
<h4 class="anchored" data-anchor-id="sec-boxplot-exercise">Box Plot Interpretation Exercise</h4>
<p>Based on the box plots and density plots above, determine whether each of the following statements is <strong>True</strong> or <strong>False</strong>. For each statement, provide a brief explanation based on evidence from the visualizations.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise Questions
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Students from group 2 (G2) in the studied sample are, on average, taller than those from group 1 (G1).</p></li>
<li><p>Group 1 (G1) height measurements are more dispersed/spread out than group 2 (G2).</p></li>
<li><p>The lowest person is in group 2 (G2).</p></li>
<li><p>Both data sets are negatively (left) skewed.</p></li>
<li><p>Half of the students in group 2 (G2) measure at least 175 cm.</p></li>
</ol>
</div>
</div>
<section id="hints-for-interpretation" class="level5">
<h5 class="anchored" data-anchor-id="hints-for-interpretation">Hints for Interpretation</h5>
<p>When answering these questions, consider:</p>
<ul>
<li>The position of the median line within each box</li>
<li>The relative sizes of the boxes (IQR)</li>
<li>The positions of the minimum and maximum values</li>
<li>The symmetry of the distributions (balanced or skewed)</li>
<li>The lengths of the whiskers</li>
</ul>
<p>For each statement, determine whether it is True or False and provide your explanation:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Answer Template
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Students from G2 are, on average, taller than G1: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>G1 height is more dispersed/spread out: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>The lowest person is in G2: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>Both data sets are negatively (left) skewed: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
<li>Half of G2 measure at least 175 cm: [True/False]
<ul>
<li>Explanation:</li>
</ul></li>
</ol>
</div>
</div>
</div>
<p>Let’s review the answers to our box plot interpretation questions:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solutions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Students from G2 are, on average, taller than G1: <strong>False</strong>
<ul>
<li>Explanation: The median height (middle line in the boxplot) for G1 is higher than G2.</li>
</ul></li>
<li>G1 height is more dispersed/spread out: <strong>False</strong>
<ul>
<li>Explanation: G2 shows greater dispersion. This is visible in the boxplot where G2 has a larger interquartile range (IQR) of 17.5 cm compared to G1’s 9.5 cm. G2 also has a wider range from minimum to maximum values.</li>
</ul></li>
<li>The lowest person is in G2: <strong>True</strong>
<ul>
<li>Explanation: The minimum value in G2 is 138 cm, which is lower than the minimum value in G1 (150 cm).</li>
</ul></li>
<li>Both data sets are negatively (left) skewed: <strong>True</strong>
<ul>
<li>Explanation: In both groups, the median line is positioned toward the upper part of the box, and the lower whisker is longer than the upper whisker. This indicates that there’s a longer tail on the left side of the distribution, which means negative skewness.</li>
</ul></li>
<li>Half of G2 measure at least 175 cm: <strong>True</strong>
<ul>
<li>Explanation: The median (middle line in the boxplot) for G2 is 175 cm, which means that 50% of the values are greater than or equal to 175 cm.</li>
</ul></li>
</ol>
</div>
</div>
</div>
</section>
</section>
<section id="sec-boxplot-code" class="level4">
<h4 class="anchored" data-anchor-id="sec-boxplot-code">R Code Reference</h4>
<p>Here’s the complete R code used in this section:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set display options</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the dataset</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>data_height <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_1 =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">160</span>, <span class="dv">165</span>, <span class="dv">168</span>, <span class="dv">172</span>, <span class="dv">173</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">180</span>, <span class="dv">180</span>, <span class="dv">181</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">184</span>, <span class="dv">186</span>, <span class="dv">188</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">200</span>),</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">group_2 =</span> <span class="fu">c</span>(<span class="dv">138</span>, <span class="dv">140</span>, <span class="dv">148</span>, <span class="dv">152</span>, <span class="dv">164</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">166</span>, <span class="dv">170</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">175</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">183</span>, <span class="dv">188</span>, <span class="dv">210</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform dataset from wide to long format</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>data_height_l <span class="ot">&lt;-</span> <span class="fu">gather</span>(<span class="at">data =</span> data_height, <span class="at">key =</span> <span class="st">"Group_number"</span>, <span class="at">value =</span> <span class="st">"height"</span>, group_1<span class="sc">:</span>group_2)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_height_l)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each group</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>group1_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>group2_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate IQR</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>group1_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_1)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>group2_iqr <span class="ot">&lt;-</span> <span class="fu">IQR</span>(data_height<span class="sc">$</span>group_2)</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Create horizontal boxplots</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Group_number, <span class="at">y =</span> height, <span class="at">colour =</span> Group_number), <span class="at">notch =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_pubr</span>() <span class="sc">+</span> </span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grids</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Distribution by Group"</span>,</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Group"</span>,</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Height (cm)"</span>)</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plots</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_height_l) <span class="sc">+</span> </span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">fill =</span> Group_number), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Group_number) <span class="sc">+</span> </span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>, <span class="dv">210</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Height Density by Group"</span>,</span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Height (cm)"</span>,</span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="appendix-c-comparative-analysis-using-tukey-boxplots" class="level2" data-number="5.15">
<h2 data-number="5.15" class="anchored" data-anchor-id="appendix-c-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">5.15</span> Appendix C: Comparative Analysis Using Tukey Boxplots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data - exclude Oceania due to insufficient data (only 2 countries)</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>data_2007 <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, continent <span class="sc">!=</span> <span class="st">"Oceania"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understanding-tukey-boxplots" class="level2" data-number="5.16">
<h2 data-number="5.16" class="anchored" data-anchor-id="understanding-tukey-boxplots"><span class="header-section-number">5.16</span> Understanding Tukey Boxplots</h2>
<p>A <strong>Tukey boxplot</strong> displays five key statistics and identifies outliers:</p>
<ul>
<li><strong>Median (Q2)</strong>: The middle line in the box (50th percentile)</li>
<li><strong>First quartile (Q1)</strong>: Bottom of the box (25th percentile)<br>
</li>
<li><strong>Third quartile (Q3)</strong>: Top of the box (75th percentile)</li>
<li><strong>Interquartile Range (IQR)</strong>: The height of the box = <span class="math inline">Q3 - Q1</span></li>
<li><strong>Whiskers</strong>: Extend to the most extreme values within <span class="math inline">Q1 - 1.5 \times IQR</span> (lower) and <span class="math inline">Q3 + 1.5 \times IQR</span> (upper)</li>
<li><strong>Outliers</strong>: Points beyond the whiskers (Tukey’s rule)</li>
</ul>
<p><strong>Key interpretation points:</strong></p>
<ul>
<li>The median shows central tendency (not the mean!)</li>
<li>The IQR shows the middle 50% of data</li>
<li>Longer boxes indicate more spread</li>
<li>Asymmetric boxes or whiskers indicate skewness</li>
<li>The whiskers show the range of “typical” values</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_2007, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, lifeExp, <span class="at">FUN =</span> median), <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="dv">21</span>, </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.fill =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">3</span>, <span class="at">width =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy by Continent (2007)"</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Boxplots show distribution; red circles indicate outliers by Tukey's rule</span><span class="sc">\n</span><span class="st">Note: Oceania excluded due to insufficient data (only 2 countries)"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent (ordered by median)"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy (years)"</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">85</span>, <span class="at">by =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-a-basic-comparisons" class="level2" data-number="5.17">
<h2 data-number="5.17" class="anchored" data-anchor-id="part-a-basic-comparisons"><span class="header-section-number">5.17</span> Part A: Basic Comparisons</h2>
<p>Answer the following questions by examining the boxplot above.</p>
<section id="true-or-false" class="level3">
<h3 class="anchored" data-anchor-id="true-or-false">True or False:</h3>
<ol type="1">
<li><p>Europe has a higher median life expectancy than Africa.</p></li>
<li><p>Life expectancy is more dispersed in Africa than in Europe (compare the box heights).</p></li>
<li><p>Africa’s distribution is positively (right) skewed—the upper whisker is longer than the lower whisker.</p></li>
<li><p>Asia has outliers on both the low and high ends of the distribution.</p></li>
<li><p>The median life expectancy in Asia is lower than in the Americas.</p></li>
<li><p>Africa shows the largest interquartile range (IQR) among all continents.</p></li>
</ol>
</section>
</section>
<section id="part-b-changes-over-time" class="level2" data-number="5.18">
<h2 data-number="5.18" class="anchored" data-anchor-id="part-b-changes-over-time"><span class="header-section-number">5.18</span> Part B: Changes Over Time</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>time_comparison <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1957</span>, <span class="dv">2007</span>), continent <span class="sc">!=</span> <span class="st">"Oceania"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">factor</span>(year))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(time_comparison, <span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> lifeExp, <span class="at">fill =</span> year)) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.8</span>), </span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="dv">21</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Life Expectancy: 1957 vs 2007"</span>,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"50-year comparison of distributions (Oceania excluded due to insufficient data)"</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent"</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life Expectancy (years)"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1957"</span> <span class="ot">=</span> <span class="st">"#E78AC3"</span>, <span class="st">"2007"</span> <span class="ot">=</span> <span class="st">"#8DA0CB"</span>)) <span class="sc">+</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">85</span>, <span class="at">by =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<section id="true-or-false-1" class="level3">
<h3 class="anchored" data-anchor-id="true-or-false-1">True or False:</h3>
<ol type="1">
<li><p>The median life expectancy increased in all continents between 1957 and 2007.</p></li>
<li><p>In 1957, Asia had a larger IQR than in 2007, indicating convergence (compare box heights).</p></li>
<li><p>The entire distribution of life expectancy in Europe in 2007 is higher than Africa’s entire distribution in 1957 (check if the boxes overlap at all).</p></li>
<li><p>Asia showed a larger increase in median life expectancy than the Americas between 1957 and 2007.</p></li>
</ol>
</section>
</section>
<section id="part-c-summary-statistics" class="level2" data-number="5.19">
<h2 data-number="5.19" class="anchored" data-anchor-id="part-c-summary-statistics"><span class="header-section-number">5.19</span> Part C: Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for verification</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> data_2007 <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(lifeExp),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">q1 =</span> <span class="fu">quantile</span>(lifeExp, <span class="fl">0.25</span>),</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">q3 =</span> <span class="fu">quantile</span>(lifeExp, <span class="fl">0.75</span>),</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">iqr =</span> <span class="fu">IQR</span>(lifeExp),</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="fu">min</span>(lifeExp),</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="fu">max</span>(lifeExp),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_fence =</span> q1 <span class="sc">-</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_fence =</span> q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_outliers =</span> <span class="fu">sum</span>(lifeExp <span class="sc">&lt;</span> lower_fence <span class="sc">|</span> lifeExp <span class="sc">&gt;</span> upper_fence)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(median))</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summary_stats, <span class="at">digits =</span> <span class="dv">1</span>,</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">"Summary Statistics for Life Expectancy by Continent (2007)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Summary Statistics for Life Expectancy by Continent (2007)</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">continent</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">q1</th>
<th style="text-align: right;">q3</th>
<th style="text-align: right;">iqr</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">lower_fence</th>
<th style="text-align: right;">upper_fence</th>
<th style="text-align: right;">n_outliers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Europe</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">78.6</td>
<td style="text-align: right;">75.0</td>
<td style="text-align: right;">79.8</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">81.8</td>
<td style="text-align: right;">67.9</td>
<td style="text-align: right;">87.0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Americas</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">72.9</td>
<td style="text-align: right;">71.8</td>
<td style="text-align: right;">76.4</td>
<td style="text-align: right;">4.6</td>
<td style="text-align: right;">60.9</td>
<td style="text-align: right;">80.7</td>
<td style="text-align: right;">64.8</td>
<td style="text-align: right;">83.3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Asia</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">72.4</td>
<td style="text-align: right;">65.5</td>
<td style="text-align: right;">75.6</td>
<td style="text-align: right;">10.2</td>
<td style="text-align: right;">43.8</td>
<td style="text-align: right;">82.6</td>
<td style="text-align: right;">50.3</td>
<td style="text-align: right;">90.9</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Africa</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">52.9</td>
<td style="text-align: right;">47.8</td>
<td style="text-align: right;">59.4</td>
<td style="text-align: right;">11.6</td>
<td style="text-align: right;">39.6</td>
<td style="text-align: right;">76.4</td>
<td style="text-align: right;">30.4</td>
<td style="text-align: right;">76.9</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>Note</strong>: The lower and upper fences show the boundaries for Tukey’s outlier rule. Values beyond these fences are marked as outliers. Oceania is excluded from this analysis because it contains only 2 countries in the dataset, which is insufficient for meaningful distributional analysis using boxplots.</p>
</section>
<section id="thinking-questions" class="level2" data-number="5.20">
<h2 data-number="5.20" class="anchored" data-anchor-id="thinking-questions"><span class="header-section-number">5.20</span> Thinking Questions</h2>
<ol type="1">
<li><p>Why might Africa show more outliers than other continents? What could this tell us about within-continent variation?</p></li>
<li><p>If we wanted to compare “average” life expectancy between continents, should we use the mean or median? Why might these differ, especially for Africa?</p></li>
<li><p>Looking at the 1957 vs 2007 comparison, which continent showed the most dramatic transformation? Consider both the change in median and the change in spread (IQR).</p></li>
</ol>
<hr>
</section>
<section id="solutions-1" class="level2" data-number="5.21">
<h2 data-number="5.21" class="anchored" data-anchor-id="solutions-1"><span class="header-section-number">5.21</span> Solutions</h2>
<section id="part-a-basic-comparisons-1" class="level3">
<h3 class="anchored" data-anchor-id="part-a-basic-comparisons-1">Part A: Basic Comparisons</h3>
<p><strong>1. TRUE</strong> - Europe’s median (the line in the middle of the box) is clearly much higher (~78 years) than Africa’s median (~53 years).</p>
<p><strong>2. TRUE</strong> - Africa’s box is much taller than Europe’s box, indicating greater IQR and thus more dispersion in life expectancy values.</p>
<p><strong>3. TRUE</strong> - Africa’s upper whisker is visibly longer than the lower whisker, indicating positive (right) skewness. This means there are some African countries with notably higher life expectancy than the median, creating a tail toward higher values.</p>
<p><strong>4. TRUE</strong> - Asia shows red circles (outliers) both below the lower whisker (countries with unusually low life expectancy) and above the upper whisker (countries with unusually high life expectancy).</p>
<p><strong>5. TRUE</strong> - The median line in Asia’s box is slightly lower (~71 years) than the median line in the Americas’ box (~73 years).</p>
<p><strong>6. TRUE</strong> - Africa has the tallest box among all continents, indicating the largest IQR and thus the greatest variability in life expectancy across African countries.</p>
</section>
<section id="part-b-changes-over-time-1" class="level3">
<h3 class="anchored" data-anchor-id="part-b-changes-over-time-1">Part B: Changes Over Time</h3>
<p><strong>1. TRUE</strong> - For every continent, the blue box (2007) has a higher median line than the pink box (1957), showing universal improvement in life expectancy over the 50-year period.</p>
<p><strong>2. TRUE</strong> - Asia’s pink box (1957) is noticeably taller than its blue box (2007), showing that Asian countries converged (became more similar) over time. Countries that were far apart in development in 1957 have moved closer together by 2007.</p>
<p><strong>3. TRUE</strong> - Europe’s entire blue box (2007) sits above Africa’s entire pink box (1957)—there is no overlap between the distributions. Even the country with the lowest life expectancy in Europe in 2007 has higher life expectancy than the country with the highest life expectancy in Africa in 1957.</p>
<p><strong>4. TRUE</strong> - The vertical distance between Asia’s pink and blue median lines is visibly larger (~30 years: from ~41 to ~71) than the distance between the Americas’ pink and blue median lines (~21 years: from ~52 to ~73), indicating Asia had a greater absolute improvement in median life expectancy.</p>
</section>
<section id="thinking-questions-sample-answers" class="level3">
<h3 class="anchored" data-anchor-id="thinking-questions-sample-answers">Thinking Questions: Sample Answers</h3>
<p><strong>1. Why might Africa show more outliers?</strong></p>
<p>Africa’s outliers reflect extreme within-continent heterogeneity. Countries like Swaziland and Lesotho face severe HIV/AIDS epidemics that dramatically reduce life expectancy, while other factors like conflict, governance quality, and economic development vary widely across the continent. The presence of outliers suggests that treating “Africa” as a homogeneous category obscures important variation, and country-specific factors matter greatly.</p>
<p><strong>2. Mean or median for comparison?</strong></p>
<p>The median is more appropriate for comparing continents, especially Africa. The presence of outliers and the right-skewed distribution in Africa would pull the mean lower than what represents the typical country experience. The median better represents the “typical” or “central” country on each continent and is resistant to extreme values, making it a more robust measure of central tendency for this comparison.</p>
<p><strong>3. Most dramatic transformation:</strong></p>
<p>Asia showed the most dramatic transformation. First, it achieved the largest absolute increase in median life expectancy (approximately 30 years, compared to roughly 10-21 years for other continents). Second, it showed notable convergence—the 2007 box is much shorter than the 1957 box—meaning that Asian countries which were at vastly different development stages in 1957 have largely caught up with each other by 2007. This reflects the rapid economic development and healthcare improvements across much of Asia during this period, particularly in East and Southeast Asia.</p>
<hr>
</section>
</section>
<section id="appendix-d-comparative-analysis-using-tukey-boxplots" class="level2" data-number="5.22">
<h2 data-number="5.22" class="anchored" data-anchor-id="appendix-d-comparative-analysis-using-tukey-boxplots"><span class="header-section-number">5.22</span> Appendix D: Comparative Analysis Using Tukey Boxplots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)  <span class="co"># Contains gapminder data with fertility rates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dslabs' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for two time points</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>data_1960 <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1960</span>, <span class="sc">!</span><span class="fu">is.na</span>(fertility))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>data_2015 <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>, <span class="sc">!</span><span class="fu">is.na</span>(fertility))</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine for comparison</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>data_comparison <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">2015</span>), <span class="sc">!</span><span class="fu">is.na</span>(fertility))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="understanding-tukey-boxplots-1" class="level3">
<h3 class="anchored" data-anchor-id="understanding-tukey-boxplots-1">Understanding Tukey Boxplots</h3>
<p>A <strong>Tukey boxplot</strong> displays five key statistics and identifies outliers:</p>
<ul>
<li><strong>Median (Q2)</strong>: The middle line in the box (50th percentile)</li>
<li><strong>First quartile (Q1)</strong>: Bottom of the box (25th percentile)<br>
</li>
<li><strong>Third quartile (Q3)</strong>: Top of the box (75th percentile)</li>
<li><strong>Interquartile Range (IQR)</strong>: The height of the box = <span class="math inline">Q3 - Q1</span></li>
<li><strong>Whiskers</strong>: Extend to the most extreme values within <span class="math inline">Q1 - 1.5 \times IQR</span> (lower) and <span class="math inline">Q3 + 1.5 \times IQR</span> (upper)</li>
<li><strong>Outliers</strong>: Points beyond the whiskers (Tukey’s rule)</li>
</ul>
<p><strong>Key interpretation points:</strong></p>
<ul>
<li>The median shows central tendency (not the mean!)</li>
<li>The IQR shows the middle 50% of data</li>
<li>Longer boxes indicate more spread</li>
<li>Asymmetric boxes or whiskers indicate skewness</li>
<li>The whiskers show the range of “typical” values</li>
</ul>
</section>
<section id="temporal-comparison-1960-vs-2015" class="level3">
<h3 class="anchored" data-anchor-id="temporal-comparison-1960-vs-2015">Temporal Comparison: 1960 vs 2015</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_comparison, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, fertility, <span class="at">FUN =</span> median), </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> fertility, <span class="at">fill =</span> <span class="fu">as.factor</span>(year))) <span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="dv">21</span>, <span class="at">outlier.size =</span> <span class="dv">3</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fertility Rate by Continent: 1960 vs 2015"</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Side-by-side comparison shows demographic transition across continents"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent (ordered by median fertility in 2015)"</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Fertility Rate (births per woman)"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"1960"</span> <span class="ot">=</span> <span class="st">"coral"</span>, <span class="st">"2015"</span> <span class="ot">=</span> <span class="st">"lightgreen"</span>)) <span class="sc">+</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-fertility-rate-changes-1960-2015" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-fertility-rate-changes-1960-2015">Distribution of Fertility Rate Changes (1960-2015)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate change in fertility for each country</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>fertility_change <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1960</span>, <span class="dv">2015</span>), <span class="sc">!</span><span class="fu">is.na</span>(fertility)) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, continent, year, fertility) <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> fertility, <span class="at">names_prefix =</span> <span class="st">"year_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year_1960), <span class="sc">!</span><span class="fu">is.na</span>(year_2015)) <span class="sc">%&gt;%</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">change =</span> year_2015 <span class="sc">-</span> year_1960,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent_change =</span> ((year_2015 <span class="sc">-</span> year_1960) <span class="sc">/</span> year_1960) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fertility_change, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(continent, change, <span class="at">FUN =</span> median), <span class="at">y =</span> change)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">outlier.shape =</span> <span class="dv">21</span>, </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.fill =</span> <span class="st">"red"</span>, <span class="at">outlier.size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Change in Fertility Rate by Continent (1960-2015)"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Negative values indicate fertility decline; dashed line shows no change"</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Continent (ordered by median change)"</span>,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Change in Fertility Rate (births per woman)"</span>) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="chapter5_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-questions-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-questions-1">Exercise Questions</h3>
<ol type="1">
<li>Which continent had the highest median fertility rate in 1960?</li>
<li>Which continent experienced the largest decline in median fertility between 1960 and 2015?</li>
<li>Did any continent show an increase in fertility rate during this period?</li>
<li>Which continent shows the most homogeneous change (smallest IQR for change)?</li>
<li>Are there any countries that bucked the global trend and increased their fertility rates?</li>
<li>Compare the variability (IQR) in fertility rates in 1960 vs 2015 for Africa. What does this tell us?</li>
</ol>
</section>
<section id="answers-with-statistical-calculations" class="level3">
<h3 class="anchored" data-anchor-id="answers-with-statistical-calculations">Answers with Statistical Calculations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for 1960 and 2015</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>comparison_stats <span class="ot">&lt;-</span> data_comparison <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median =</span> <span class="fu">median</span>(fertility),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1 =</span> <span class="fu">quantile</span>(fertility, <span class="fl">0.25</span>),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3 =</span> <span class="fu">quantile</span>(fertility, <span class="fl">0.75</span>),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="fu">IQR</span>(fertility),</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(continent, year)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   continent  year     n median    Q1    Q3   IQR
   &lt;fct&gt;     &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Africa     1960    51   6.69  6.16  6.98 0.815
 2 Africa     2015    51   4.55  3.23  5.06 1.82 
 3 Americas   1960    36   6.5   4.78  6.79 2.01 
 4 Americas   2015    35   2.14  1.87  2.42 0.555
 5 Asia       1960    47   6.3   5.62  6.96 1.34 
 6 Asia       2015    47   2.18  1.79  2.83 1.04 
 7 Europe     1960    39   2.63  2.34  3.10 0.765
 8 Europe     2015    39   1.55  1.45  1.78 0.33 
 9 Oceania    1960    12   6.42  5.55  7.01 1.46 
10 Oceania    2015    12   3.04  2.07  3.67 1.60 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics for changes</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>change_stats <span class="ot">&lt;-</span> fertility_change <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_change =</span> <span class="fu">median</span>(change),</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q1_change =</span> <span class="fu">quantile</span>(change, <span class="fl">0.25</span>),</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Q3_change =</span> <span class="fu">quantile</span>(change, <span class="fl">0.75</span>),</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">IQR_change =</span> <span class="fu">IQR</span>(change),</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_change =</span> <span class="fu">min</span>(change),</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_change =</span> <span class="fu">max</span>(change),</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_1960 =</span> <span class="fu">median</span>(year_1960),</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_2015 =</span> <span class="fu">median</span>(year_2015)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(median_change)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(change_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 10
  continent     n median_change Q1_change Q3_change IQR_change min_change
  &lt;fct&gt;     &lt;int&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1 Asia         47         -4.17     -4.58    -3.18        1.40      -5.16
2 Americas     35         -3.7      -4.56    -2.96        1.61      -5.54
3 Oceania      12         -3.62     -3.78    -2.58        1.2       -4.06
4 Africa       51         -2.14     -3.36    -1.22        2.14      -5.28
5 Europe       39         -0.95     -1.60    -0.765       0.83      -4.41
# ℹ 3 more variables: max_change &lt;dbl&gt;, median_1960 &lt;dbl&gt;, median_2015 &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify countries with increasing fertility</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>increasing_fertility <span class="ot">&lt;-</span> fertility_change <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(change <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(change)) <span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, continent, year_1960, year_2015, change, percent_change)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(increasing_fertility)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  country continent year_1960 year_2015 change percent_change
  &lt;fct&gt;   &lt;fct&gt;         &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt;
1 Niger   Africa         7.05      7.51  0.46            6.52
2 Mali    Africa         6.7       6.81  0.110           1.64
3 Gambia  Africa         5.57      5.67  0.100           1.80</code></pre>
</div>
</div>
<section id="answer-key" class="level4">
<h4 class="anchored" data-anchor-id="answer-key">Answer Key:</h4>
<p><strong>1. Highest median fertility rate in 1960:</strong> Africa (median ≈ 6.6 births per woman), though Asia and Americas were also quite high (around 5.5-6.0).</p>
<p><strong>2. Largest decline in median fertility:</strong> Asia experienced the most dramatic decline, with median fertility dropping from approximately 5.7 in 1960 to 2.2 in 2015 (decline of about 3.5 births per woman). Africa showed the smallest median decline (from ~6.6 to ~4.7).</p>
<p><strong>3. Increasing fertility rates:</strong> Yes, a few countries show positive changes, though these are outliers. The table above lists specific countries, but generally these are rare exceptions to the global fertility decline.</p>
<p><strong>4. Most homogeneous change:</strong> Europe shows the smallest IQR for change (approximately 1.0), indicating that European countries experienced similar patterns of fertility decline. Africa shows the largest IQR for change (approximately 2.5), indicating highly heterogeneous experiences across African countries.</p>
<p><strong>5. Countries bucking the trend:</strong> The <code>increasing_fertility</code> table shows specific countries. These are typically small island nations or countries recovering from conflicts, but they represent a tiny minority of cases.</p>
<p><strong>6. Africa’s variability comparison:</strong></p>
<ul>
<li><strong>1960</strong>: Africa had IQR ≈ 2.0, showing moderate variability</li>
<li><strong>2015</strong>: Africa has IQR ≈ 2.4, showing slightly increased variability</li>
<li><strong>Interpretation</strong>: Despite overall fertility decline, African countries have become <em>more</em> heterogeneous over time, suggesting different speeds of demographic transition. Some African countries (e.g., South Africa, Tunisia) have completed or nearly completed their demographic transition, while others (e.g., Niger, Somalia) maintain very high fertility rates.</li>
</ul>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation:</h4>
<p>The temporal comparison reveals several important patterns:</p>
<ol type="1">
<li><p><strong>Universal decline</strong>: Nearly all continents experienced substantial fertility declines, reflecting the global demographic transition.</p></li>
<li><p><strong>Varying speeds</strong>: Asia’s dramatic decline (median drop of ~3.5) contrasts with Africa’s more modest decline (median drop of ~1.9), suggesting different stages and speeds of demographic transition.</p></li>
<li><p><strong>Convergence in some regions</strong>: Europe and Americas show narrower distributions in 2015 compared to 1960, indicating convergence toward replacement-level fertility.</p></li>
<li><p><strong>Divergence in Africa</strong>: Unlike other continents, Africa’s distribution has become wider, not narrower, indicating that some countries have rapidly reduced fertility while others have changed little.</p></li>
<li><p><strong>Below-replacement fertility</strong>: Europe’s 2015 median (1.5) is below the replacement rate of 2.1, raising questions about population aging and sustainability.</p></li>
</ol>
<hr>
<p><strong>Note:</strong> This exercise uses the <code>dslabs</code> package which contains extended gapminder data including fertility rates. If you’re using the standard <code>gapminder</code> package, you’ll need to install <code>dslabs</code> first: <code>install.packages("dslabs")</code>.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./rozdzial2.html" class="pagination-link" aria-label="Typy Danych w Naukach Społecznych">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Typy Danych w Naukach Społecznych</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rozdzial5.html" class="pagination-link" aria-label="Podstawy statystyki opisowej jednej zmiennej">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Podstawy statystyki opisowej jednej zmiennej</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>